[{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\__tests__\\patient-profile-fixes.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\app.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\config\\database.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\adminController.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[711,714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[711,714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1144,1147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1144,1147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1311,1314],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1311,1314],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1621,1624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1621,1624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2209,2212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2209,2212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2479,2482],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2479,2482],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3535,3538],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3535,3538],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4338,4341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4338,4341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6242,6245],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6242,6245],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6770,6773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6770,6773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8698,8701],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8698,8701],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":306,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":306,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9720,9723],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9720,9723],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":348,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10889,10892],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10889,10892],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":352,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":352,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11066,11069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11066,11069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":358,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":358,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11350,11353],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11350,11353],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":429,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":429,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13330,13333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13330,13333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":437,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":437,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13576,13579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13576,13579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":459,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":459,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14256,14259],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14256,14259],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":481,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":481,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14945,14948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14945,14948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":556,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":556,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16856,16859],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16856,16859],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":557,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":557,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16915,16918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16915,16918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":561,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":561,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17193,17196],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17193,17196],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":562,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":562,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17271,17274],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17271,17274],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":570,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":570,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17510,17513],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17510,17513],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":648,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":648,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19657,19660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19657,19660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":654,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":654,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19979,19982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19979,19982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":676,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":676,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20608,20611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20608,20611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":707,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":707,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21557,21560],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21557,21560],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":904,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":904,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27800,27803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27800,27803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":910,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":910,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28114,28117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28114,28117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":936,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":936,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28927,28930],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28927,28930],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":976,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":976,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30112,30115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30112,30115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":32,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Response } from 'express';\r\nimport { Clinic, User, Patient, Appointment, Billing, StaffSchedule } from '../models';\r\nimport { AuthenticatedRequest } from '../types';\r\nimport {\r\n  getPaginationParams,\r\n  createPaginatedResponse\r\n} from '../utils/helpers';\r\nimport {\r\n  catchAsync,\r\n  createNotFoundError,\r\n  createValidationError\r\n} from '../middleware/errorHandler';\r\n\r\n// Get all clinics with comprehensive data for admin dashboard\r\nexport const getAdminClinicOverview = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\r\n  const { page, limit, skip } = getPaginationParams(req);\r\n  const { search, status, sortBy = 'name' } = req.query;\r\n\r\n  // Build query for clinics\r\n  const query: any = {};\r\n  \r\n  if (search) {\r\n    query.$or = [\r\n      { name: { $regex: search, $options: 'i' } },\r\n      { 'address.city': { $regex: search, $options: 'i' } },\r\n      { 'address.state': { $regex: search, $options: 'i' } }\r\n    ];\r\n  }\r\n\r\n  if (status && status !== 'all') {\r\n    query.isActive = status === 'active';\r\n  }\r\n\r\n  // Get clinics with basic info\r\n  const [clinics, totalClinics] = await Promise.all([\r\n    (Clinic as any).find(query)\r\n      .populate('staff', 'firstName lastName role')\r\n      .sort({ [sortBy as string]: 1 })\r\n      .skip(skip)\r\n      .limit(limit),\r\n    (Clinic as any).countDocuments(query)\r\n  ]);\r\n\r\n  // Get comprehensive data for each clinic\r\n  const clinicsWithData = await Promise.all(\r\n    clinics.map(async (clinic) => {\r\n      const [patientStats, appointmentStats, billingStats, staffCount] = await Promise.all([\r\n        // Patient statistics\r\n        (Patient as any).aggregate([\r\n          { $match: { preferredClinicId: clinic._id } },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              totalPatients: { $sum: 1 },\r\n              newThisMonth: {\r\n                $sum: {\r\n                  $cond: [\r\n                    { $gte: ['$createdAt', new Date(new Date().getFullYear(), new Date().getMonth(), 1)] },\r\n                    1,\r\n                    0\r\n                  ]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ]),\r\n        \r\n        // Appointment statistics\r\n        (Appointment as any).aggregate([\r\n          { $match: { clinicId: clinic._id } },\r\n          {\r\n            $group: {\r\n              _id: '$status',\r\n              count: { $sum: 1 }\r\n            }\r\n          }\r\n        ]),\r\n        \r\n        // Billing statistics\r\n        (Billing as any).aggregate([\r\n          { $match: { clinicId: clinic._id } },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              totalRevenue: { $sum: '$amount' },\r\n              paidAmount: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'paid'] }, '$amount', 0]\r\n                }\r\n              },\r\n              pendingAmount: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'pending'] }, '$amount', 0]\r\n                }\r\n              },\r\n              overdueAmount: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'overdue'] }, '$amount', 0]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ]),\r\n        \r\n        // Staff count\r\n        User.countDocuments({ assignedClinics: clinic._id })\r\n      ]);\r\n\r\n      const patientData = patientStats[0] || { totalPatients: 0, newThisMonth: 0 };\r\n      const appointmentData = appointmentStats.reduce((acc, stat) => {\r\n        acc[stat._id] = stat.count;\r\n        return acc;\r\n      }, {} as any);\r\n      const billingData = billingStats[0] || {\r\n        totalRevenue: 0,\r\n        paidAmount: 0,\r\n        pendingAmount: 0,\r\n        overdueAmount: 0\r\n      };\r\n\r\n      return {\r\n        clinic: {\r\n          id: clinic._id,\r\n          name: clinic.name,\r\n          email: clinic.email,\r\n          phone: clinic.phone,\r\n          address: clinic.address,\r\n          isActive: clinic.isActive,\r\n          services: clinic.services,\r\n          operatingHours: clinic.operatingHours,\r\n          createdAt: clinic.createdAt\r\n        },\r\n        statistics: {\r\n          patients: {\r\n            total: patientData.totalPatients,\r\n            newThisMonth: patientData.newThisMonth\r\n          },\r\n          appointments: {\r\n            total: Object.values(appointmentData).reduce((sum: number, count: any) => sum + count, 0),\r\n            scheduled: appointmentData.scheduled || 0,\r\n            completed: appointmentData.completed || 0,\r\n            cancelled: appointmentData.cancelled || 0,\r\n            'no-show': appointmentData['no-show'] || 0\r\n          },\r\n          billing: {\r\n            totalRevenue: billingData.totalRevenue,\r\n            paidAmount: billingData.paidAmount,\r\n            pendingAmount: billingData.pendingAmount,\r\n            overdueAmount: billingData.overdueAmount,\r\n            collectionRate: billingData.totalRevenue > 0 \r\n              ? (billingData.paidAmount / billingData.totalRevenue) * 100 \r\n              : 0\r\n          },\r\n          staff: {\r\n            total: staffCount,\r\n            active: clinic.staff.length\r\n          }\r\n        }\r\n      };\r\n    })\r\n  );\r\n\r\n  // Calculate overall statistics\r\n  const overallStats = clinicsWithData.reduce(\r\n    (acc, clinicData) => ({\r\n      totalClinics: acc.totalClinics + 1,\r\n      totalPatients: acc.totalPatients + clinicData.statistics.patients.total,\r\n      totalRevenue: acc.totalRevenue + clinicData.statistics.billing.totalRevenue,\r\n      totalAppointments: acc.totalAppointments + clinicData.statistics.appointments.total,\r\n      totalStaff: acc.totalStaff + clinicData.statistics.staff.total\r\n    }),\r\n    { totalClinics: 0, totalPatients: 0, totalRevenue: 0, totalAppointments: 0, totalStaff: 0 }\r\n  );\r\n\r\n  const paginatedResponse = createPaginatedResponse(clinicsWithData, totalClinics, page, limit);\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      ...paginatedResponse,\r\n      overallStatistics: overallStats\r\n    }\r\n  });\r\n});\r\n\r\n// Get detailed data for a specific clinic\r\nexport const getClinicDetailedData = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\r\n  const { clinicId } = req.params;\r\n  const { startDate, endDate } = req.query;\r\n\r\n  const clinic = await (Clinic as any).findById(clinicId).populate('staff', 'firstName lastName role email phone');\r\n  if (!clinic) {\r\n    throw createNotFoundError('Clinic');\r\n  }\r\n\r\n  // Date range for filtering (default to last 30 days)\r\n  const end = endDate ? new Date(endDate as string) : new Date();\r\n  const start = startDate ? new Date(startDate as string) : new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\r\n\r\n  const [patientData, appointmentData, billingData, recentActivity] = await Promise.all([\r\n    // Detailed patient analytics\r\n    (Patient as any).aggregate([\r\n      { $match: { preferredClinicId: clinic._id } },\r\n      {\r\n        $facet: {\r\n          demographics: [\r\n            {\r\n              $group: {\r\n                _id: '$gender',\r\n                count: { $sum: 1 }\r\n              }\r\n            }\r\n          ],\r\n          ageGroups: [\r\n            {\r\n              $addFields: {\r\n                age: {\r\n                  $floor: {\r\n                    $divide: [\r\n                      { $subtract: [new Date(), { $dateFromString: { dateString: '$dateOfBirth' } }] },\r\n                      365.25 * 24 * 60 * 60 * 1000\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            },\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  $switch: {\r\n                    branches: [\r\n                      { case: { $lt: ['$age', 18] }, then: 'Under 18' },\r\n                      { case: { $lt: ['$age', 30] }, then: '18-29' },\r\n                      { case: { $lt: ['$age', 50] }, then: '30-49' },\r\n                      { case: { $lt: ['$age', 65] }, then: '50-64' }\r\n                    ],\r\n                    default: '65+'\r\n                  }\r\n                },\r\n                count: { $sum: 1 }\r\n              }\r\n            }\r\n          ],\r\n          registrationTrend: [\r\n            {\r\n              $match: {\r\n                createdAt: { $gte: start, $lte: end }\r\n              }\r\n            },\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  year: { $year: '$createdAt' },\r\n                  month: { $month: '$createdAt' },\r\n                  day: { $dayOfMonth: '$createdAt' }\r\n                },\r\n                count: { $sum: 1 }\r\n              }\r\n            },\r\n            { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n          ]\r\n        }\r\n      }\r\n    ]),\r\n\r\n    // Detailed appointment analytics\r\n    (Appointment as any).aggregate([\r\n      { $match: { clinicId: clinic._id, date: { $gte: start, $lte: end } } },\r\n      {\r\n        $facet: {\r\n          statusBreakdown: [\r\n            {\r\n              $group: {\r\n                _id: '$status',\r\n                count: { $sum: 1 }\r\n              }\r\n            }\r\n          ],\r\n          dailyTrend: [\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  year: { $year: '$date' },\r\n                  month: { $month: '$date' },\r\n                  day: { $dayOfMonth: '$date' }\r\n                },\r\n                count: { $sum: 1 }\r\n              }\r\n            },\r\n            { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n          ],\r\n          timeSlots: [\r\n            {\r\n              $group: {\r\n                _id: { $hour: '$time' },\r\n                count: { $sum: 1 }\r\n              }\r\n            },\r\n            { $sort: { '_id': 1 } }\r\n          ]\r\n        }\r\n      }\r\n    ]),\r\n\r\n    // Detailed billing analytics\r\n    (Billing as any).aggregate([\r\n      { $match: { clinicId: clinic._id, createdAt: { $gte: start, $lte: end } } },\r\n      {\r\n        $facet: {\r\n          revenueBreakdown: [\r\n            {\r\n              $group: {\r\n                _id: '$status',\r\n                totalAmount: { $sum: '$amount' },\r\n                count: { $sum: 1 }\r\n              }\r\n            }\r\n          ],\r\n          dailyRevenue: [\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  year: { $year: '$createdAt' },\r\n                  month: { $month: '$createdAt' },\r\n                  day: { $dayOfMonth: '$createdAt' }\r\n                },\r\n                revenue: { $sum: '$amount' },\r\n                count: { $sum: 1 }\r\n              }\r\n            },\r\n            { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n          ],\r\n          paymentMethods: [\r\n            {\r\n              $group: {\r\n                _id: '$paymentMethod',\r\n                totalAmount: { $sum: '$amount' },\r\n                count: { $sum: 1 }\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    ]),\r\n\r\n    // Recent activity\r\n    Promise.all([\r\n      (Patient as any).find({ preferredClinicId: clinic._id })\r\n        .sort({ createdAt: -1 })\r\n        .limit(5)\r\n        .select('firstName lastName email createdAt'),\r\n      (Appointment as any).find({ clinicId: clinic._id })\r\n        .sort({ createdAt: -1 })\r\n        .limit(5)\r\n        .populate('patientId', 'firstName lastName')\r\n        .populate('dentistId', 'firstName lastName')\r\n        .select('date time status patientId dentistId createdAt'),\r\n      (Billing as any).find({ clinicId: clinic._id })\r\n        .sort({ createdAt: -1 })\r\n        .limit(5)\r\n        .populate('patientId', 'firstName lastName')\r\n        .select('amount status paymentMethod patientId createdAt')\r\n    ])\r\n  ]);\r\n\r\n  const [recentPatients, recentAppointments, recentBilling] = recentActivity;\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      clinic: {\r\n        id: clinic._id,\r\n        name: clinic.name,\r\n        email: clinic.email,\r\n        phone: clinic.phone,\r\n        address: clinic.address,\r\n        isActive: clinic.isActive,\r\n        services: clinic.services,\r\n        operatingHours: clinic.operatingHours,\r\n        staff: clinic.staff,\r\n        createdAt: clinic.createdAt\r\n      },\r\n      analytics: {\r\n        patients: patientData[0],\r\n        appointments: appointmentData[0],\r\n        billing: billingData[0]\r\n      },\r\n      recentActivity: {\r\n        patients: recentPatients,\r\n        appointments: recentAppointments,\r\n        billing: recentBilling\r\n      },\r\n      dateRange: { start, end }\r\n    }\r\n  });\r\n});\r\n\r\n// Get clinic comparison data\r\nexport const getClinicComparison = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\r\n  const { clinicIds, metric = 'revenue', period = '30d' } = req.query;\r\n\r\n  if (!clinicIds) {\r\n    throw createValidationError('clinicIds', 'Clinic IDs are required for comparison');\r\n  }\r\n\r\n  const ids = Array.isArray(clinicIds) ? clinicIds : [clinicIds];\r\n  \r\n  // Calculate date range based on period\r\n  const end = new Date();\r\n  const start = new Date();\r\n  \r\n  switch (period) {\r\n    case '7d':\r\n      start.setDate(start.getDate() - 7);\r\n      break;\r\n    case '30d':\r\n      start.setDate(start.getDate() - 30);\r\n      break;\r\n    case '90d':\r\n      start.setDate(start.getDate() - 90);\r\n      break;\r\n    case '1y':\r\n      start.setFullYear(start.getFullYear() - 1);\r\n      break;\r\n    default:\r\n      start.setDate(start.getDate() - 30);\r\n  }\r\n\r\n  const clinics = await (Clinic as any).find({ _id: { $in: ids } }).select('name');\r\n  \r\n  const comparisonData = await Promise.all(\r\n    clinics.map(async (clinic) => {\r\n      let data;\r\n      \r\n      switch (metric) {\r\n        case 'revenue':\r\n          data = await (Billing as any).aggregate([\r\n            {\r\n              $match: {\r\n                clinicId: clinic._id,\r\n                createdAt: { $gte: start, $lte: end }\r\n              }\r\n            },\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  year: { $year: '$createdAt' },\r\n                  month: { $month: '$createdAt' },\r\n                  day: { $dayOfMonth: '$createdAt' }\r\n                },\r\n                value: { $sum: '$amount' }\r\n              }\r\n            },\r\n            { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n          ]);\r\n          break;\r\n          \r\n        case 'patients':\r\n          data = await (Patient as any).aggregate([\r\n            {\r\n              $match: {\r\n                preferredClinicId: clinic._id,\r\n                createdAt: { $gte: start, $lte: end }\r\n              }\r\n            },\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  year: { $year: '$createdAt' },\r\n                  month: { $month: '$createdAt' },\r\n                  day: { $dayOfMonth: '$createdAt' }\r\n                },\r\n                value: { $sum: 1 }\r\n              }\r\n            },\r\n            { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n          ]);\r\n          break;\r\n          \r\n        case 'appointments':\r\n          data = await (Appointment as any).aggregate([\r\n            {\r\n              $match: {\r\n                clinicId: clinic._id,\r\n                date: { $gte: start, $lte: end }\r\n              }\r\n            },\r\n            {\r\n              $group: {\r\n                _id: {\r\n                  year: { $year: '$date' },\r\n                  month: { $month: '$date' },\r\n                  day: { $dayOfMonth: '$date' }\r\n                },\r\n                value: { $sum: 1 }\r\n              }\r\n            },\r\n            { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n          ]);\r\n          break;\r\n          \r\n        default:\r\n          data = [];\r\n      }\r\n      \r\n      return {\r\n        clinicId: clinic._id,\r\n        clinicName: clinic.name,\r\n        data: data.map(item => ({\r\n          date: `${item._id.year}-${String(item._id.month).padStart(2, '0')}-${String(item._id.day).padStart(2, '0')}`,\r\n          value: item.value\r\n        }))\r\n      };\r\n    })\r\n  );\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      comparison: comparisonData,\r\n      metric,\r\n      period,\r\n      dateRange: { start, end }\r\n    }\r\n  });\r\n});\r\n\r\n// Get system-wide statistics for admin\r\nexport const getSystemStatistics = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\r\n  const { period = '30d' } = req.query;\r\n  \r\n  // Calculate date range\r\n  const end = new Date();\r\n  const start = new Date();\r\n  \r\n  switch (period) {\r\n    case '7d':\r\n      start.setDate(start.getDate() - 7);\r\n      break;\r\n    case '30d':\r\n      start.setDate(start.getDate() - 30);\r\n      break;\r\n    case '90d':\r\n      start.setDate(start.getDate() - 90);\r\n      break;\r\n    case '1y':\r\n      start.setFullYear(start.getFullYear() - 1);\r\n      break;\r\n    default:\r\n      start.setDate(start.getDate() - 30);\r\n  }\r\n\r\n  const [systemStats, growthStats] = await Promise.all([\r\n    // Current system statistics\r\n    Promise.all([\r\n      (Clinic as any).countDocuments({ isActive: true }),\r\n      (Clinic as any).countDocuments({ isActive: false }),\r\n      User.countDocuments({ role: 'patient', isActive: true }),\r\n      User.countDocuments({ role: { $in: ['dentist', 'staff'] }, isActive: true }),\r\n      User.countDocuments({ role: 'admin', isActive: true }),\r\n      (Appointment as any).countDocuments({ date: { $gte: start, $lte: end } }),\r\n      (Billing as any).aggregate([\r\n        { $match: { createdAt: { $gte: start, $lte: end } } },\r\n        { $group: { _id: null, totalRevenue: { $sum: '$amount' } } }\r\n      ])\r\n    ]),\r\n    \r\n    // Growth statistics\r\n    Promise.all([\r\n      (Clinic as any).countDocuments({ createdAt: { $gte: start, $lte: end } }),\r\n      User.countDocuments({ role: 'patient', createdAt: { $gte: start, $lte: end } }),\r\n      User.countDocuments({ role: { $in: ['dentist', 'staff'] }, createdAt: { $gte: start, $lte: end } })\r\n    ])\r\n  ]);\r\n\r\n  const [\r\n    activeClinics,\r\n    inactiveClinics,\r\n    totalPatients,\r\n    totalStaff,\r\n    totalAdmins,\r\n    totalAppointments,\r\n    revenueData\r\n  ] = systemStats;\r\n\r\n  const [newClinics, newPatients, newStaff] = growthStats;\r\n  const totalRevenue = revenueData[0]?.totalRevenue || 0;\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      overview: {\r\n        clinics: {\r\n          total: activeClinics + inactiveClinics,\r\n          active: activeClinics,\r\n          inactive: inactiveClinics\r\n        },\r\n        users: {\r\n          patients: totalPatients,\r\n          staff: totalStaff,\r\n          admins: totalAdmins,\r\n          total: totalPatients + totalStaff + totalAdmins\r\n        },\r\n        appointments: totalAppointments,\r\n        revenue: totalRevenue\r\n      },\r\n      growth: {\r\n        clinics: newClinics,\r\n        patients: newPatients,\r\n        staff: newStaff\r\n      },\r\n      period,\r\n      dateRange: { start, end }\r\n    }\r\n  });\r\n});\r\n\r\n// Get multi-clinic dashboard overview with staff schedules\r\nexport const getMultiClinicDashboard = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\r\n  const { period = '30d', clinicIds } = req.query;\r\n  \r\n  // Calculate date range\r\n  const end = new Date();\r\n  const start = new Date();\r\n  \r\n  switch (period) {\r\n    case '7d':\r\n      start.setDate(start.getDate() - 7);\r\n      break;\r\n    case '30d':\r\n      start.setDate(start.getDate() - 30);\r\n      break;\r\n    case '90d':\r\n      start.setDate(start.getDate() - 90);\r\n      break;\r\n    case '1y':\r\n      start.setFullYear(start.getFullYear() - 1);\r\n      break;\r\n    default:\r\n      start.setDate(start.getDate() - 30);\r\n  }\r\n\r\n  // Filter clinics if specific IDs provided\r\n  const clinicFilter = clinicIds ? \r\n    { _id: { $in: Array.isArray(clinicIds) ? clinicIds : [clinicIds] } } : \r\n    {};\r\n\r\n  const clinics = await (Clinic as any).find(clinicFilter).populate('staff', 'firstName lastName role specialization');\r\n\r\n  const dashboardData = await Promise.all(\r\n    clinics.map(async (clinic) => {\r\n      const [patientStats, appointmentStats, billingStats, staffScheduleStats] = await Promise.all([\r\n        // Patient statistics\r\n        (Patient as any).aggregate([\r\n          { $match: { preferredClinicId: clinic._id } },\r\n          {\r\n            $facet: {\r\n              total: [{ $count: 'count' }],\r\n              newPatients: [\r\n                { $match: { createdAt: { $gte: start, $lte: end } } },\r\n                { $count: 'count' }\r\n              ],\r\n              demographics: [\r\n                {\r\n                  $group: {\r\n                    _id: '$gender',\r\n                    count: { $sum: 1 }\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]),\r\n\r\n        // Appointment statistics\r\n        (Appointment as any).aggregate([\r\n          { $match: { clinicId: clinic._id, date: { $gte: start, $lte: end } } },\r\n          {\r\n            $facet: {\r\n              total: [{ $count: 'count' }],\r\n              statusBreakdown: [\r\n                {\r\n                  $group: {\r\n                    _id: '$status',\r\n                    count: { $sum: 1 }\r\n                  }\r\n                }\r\n              ],\r\n              dailyTrend: [\r\n                {\r\n                  $group: {\r\n                    _id: {\r\n                      year: { $year: '$date' },\r\n                      month: { $month: '$date' },\r\n                      day: { $dayOfMonth: '$date' }\r\n                    },\r\n                    count: { $sum: 1 }\r\n                  }\r\n                },\r\n                { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n              ]\r\n            }\r\n          }\r\n        ]),\r\n\r\n        // Billing statistics\r\n        (Billing as any).aggregate([\r\n          { $match: { clinicId: clinic._id, createdAt: { $gte: start, $lte: end } } },\r\n          {\r\n            $facet: {\r\n              totalRevenue: [\r\n                {\r\n                  $group: {\r\n                    _id: null,\r\n                    amount: { $sum: '$amount' }\r\n                  }\r\n                }\r\n              ],\r\n              revenueByStatus: [\r\n                {\r\n                  $group: {\r\n                    _id: '$status',\r\n                    amount: { $sum: '$amount' },\r\n                    count: { $sum: 1 }\r\n                  }\r\n                }\r\n              ],\r\n              dailyRevenue: [\r\n                {\r\n                  $group: {\r\n                    _id: {\r\n                      year: { $year: '$createdAt' },\r\n                      month: { $month: '$createdAt' },\r\n                      day: { $dayOfMonth: '$createdAt' }\r\n                    },\r\n                    revenue: { $sum: '$amount' }\r\n                  }\r\n                },\r\n                { $sort: { '_id.year': 1, '_id.month': 1, '_id.day': 1 } }\r\n              ]\r\n            }\r\n          }\r\n        ]),\r\n\r\n        // Staff schedule statistics\r\n        StaffSchedule.aggregate([\r\n          { $match: { clinicId: clinic._id, date: { $gte: start, $lte: end } } },\r\n          {\r\n            $facet: {\r\n              totalSchedules: [{ $count: 'count' }],\r\n              statusBreakdown: [\r\n                {\r\n                  $group: {\r\n                    _id: '$status',\r\n                    count: { $sum: 1 }\r\n                  }\r\n                }\r\n              ],\r\n              shiftTypeBreakdown: [\r\n                {\r\n                  $group: {\r\n                    _id: '$shiftType',\r\n                    count: { $sum: 1 }\r\n                  }\r\n                }\r\n              ],\r\n              staffUtilization: [\r\n                {\r\n                  $group: {\r\n                    _id: '$staffId',\r\n                    scheduledHours: {\r\n                      $sum: {\r\n                        $divide: [\r\n                          {\r\n                            $subtract: [\r\n                              { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$endTime', ':00Z'] } } },\r\n                              { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$startTime', ':00Z'] } } }\r\n                            ]\r\n                          },\r\n                          3600000\r\n                        ]\r\n                      }\r\n                    },\r\n                    scheduleCount: { $sum: 1 }\r\n                  }\r\n                },\r\n                {\r\n                  $lookup: {\r\n                    from: 'users',\r\n                    localField: '_id',\r\n                    foreignField: '_id',\r\n                    as: 'staff'\r\n                  }\r\n                },\r\n                {\r\n                  $unwind: '$staff'\r\n                },\r\n                {\r\n                  $project: {\r\n                    staffName: { $concat: ['$staff.firstName', ' ', '$staff.lastName'] },\r\n                    role: '$staff.role',\r\n                    scheduledHours: 1,\r\n                    scheduleCount: 1\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ])\r\n      ]);\r\n\r\n      return {\r\n        clinic: {\r\n          id: clinic._id,\r\n          name: clinic.name,\r\n          email: clinic.email,\r\n          phone: clinic.phone,\r\n          address: clinic.address,\r\n          isActive: clinic.isActive,\r\n          staffCount: clinic.staff.length\r\n        },\r\n        metrics: {\r\n          patients: {\r\n            total: patientStats[0]?.total[0]?.count || 0,\r\n            new: patientStats[0]?.newPatients[0]?.count || 0,\r\n            demographics: patientStats[0]?.demographics || []\r\n          },\r\n          appointments: {\r\n            total: appointmentStats[0]?.total[0]?.count || 0,\r\n            statusBreakdown: appointmentStats[0]?.statusBreakdown || [],\r\n            dailyTrend: appointmentStats[0]?.dailyTrend || []\r\n          },\r\n          billing: {\r\n            totalRevenue: billingStats[0]?.totalRevenue[0]?.amount || 0,\r\n            revenueByStatus: billingStats[0]?.revenueByStatus || [],\r\n            dailyRevenue: billingStats[0]?.dailyRevenue || []\r\n          },\r\n          staffSchedules: {\r\n            total: staffScheduleStats[0]?.totalSchedules[0]?.count || 0,\r\n            statusBreakdown: staffScheduleStats[0]?.statusBreakdown || [],\r\n            shiftTypeBreakdown: staffScheduleStats[0]?.shiftTypeBreakdown || [],\r\n            staffUtilization: staffScheduleStats[0]?.staffUtilization || []\r\n          }\r\n        }\r\n      };\r\n    })\r\n  );\r\n\r\n  // Calculate overall statistics across all clinics\r\n  const overallStats = dashboardData.reduce(\r\n    (acc, clinic) => {\r\n      acc.totalPatients += clinic.metrics.patients.total;\r\n      acc.newPatients += clinic.metrics.patients.new;\r\n      acc.totalAppointments += clinic.metrics.appointments.total;\r\n      acc.totalRevenue += clinic.metrics.billing.totalRevenue;\r\n      acc.totalSchedules += clinic.metrics.staffSchedules.total;\r\n      return acc;\r\n    },\r\n    {\r\n      totalPatients: 0,\r\n      newPatients: 0,\r\n      totalAppointments: 0,\r\n      totalRevenue: 0,\r\n      totalSchedules: 0\r\n    }\r\n  );\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      clinics: dashboardData,\r\n      overallStats,\r\n      period,\r\n      dateRange: { start, end }\r\n    }\r\n  });\r\n});\r\n\r\n// Get clinic performance metrics for comparison\r\nexport const getClinicPerformanceMetrics = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\r\n  const { period = '30d', metrics: _metrics = 'all' } = req.query;\r\n  \r\n  // Calculate date range\r\n  const end = new Date();\r\n  const start = new Date();\r\n  \r\n  switch (period) {\r\n    case '7d':\r\n      start.setDate(start.getDate() - 7);\r\n      break;\r\n    case '30d':\r\n      start.setDate(start.getDate() - 30);\r\n      break;\r\n    case '90d':\r\n      start.setDate(start.getDate() - 90);\r\n      break;\r\n    case '1y':\r\n      start.setFullYear(start.getFullYear() - 1);\r\n      break;\r\n    default:\r\n      start.setDate(start.getDate() - 30);\r\n  }\r\n\r\n  const clinics = await (Clinic as any).find({ isActive: true }).select('name');\r\n\r\n  const performanceData = await Promise.all(\r\n    clinics.map(async (clinic) => {\r\n      const [efficiency, patientSatisfaction, revenue, staffProductivity] = await Promise.all([\r\n        // Efficiency metrics (appointment completion rate)\r\n        (Appointment as any).aggregate([\r\n          { $match: { clinicId: clinic._id, date: { $gte: start, $lte: end } } },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              total: { $sum: 1 },\r\n              completed: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'completed'] }, 1, 0]\r\n                }\r\n              },\r\n              cancelled: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'cancelled'] }, 1, 0]\r\n                }\r\n              },\r\n              noShow: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'no-show'] }, 1, 0]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ]),\r\n\r\n        // Patient satisfaction (based on completed appointments vs cancellations)\r\n        (Patient as any).aggregate([\r\n          { $match: { preferredClinicId: clinic._id, createdAt: { $gte: start, $lte: end } } },\r\n          {\r\n            $lookup: {\r\n              from: 'appointments',\r\n              localField: '_id',\r\n              foreignField: 'patientId',\r\n              as: 'appointments'\r\n            }\r\n          },\r\n          {\r\n            $project: {\r\n              totalAppointments: { $size: '$appointments' },\r\n              completedAppointments: {\r\n                $size: {\r\n                  $filter: {\r\n                    input: '$appointments',\r\n                    cond: { $eq: ['$$this.status', 'completed'] }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              avgCompletionRate: {\r\n                $avg: {\r\n                  $cond: [\r\n                    { $gt: ['$totalAppointments', 0] },\r\n                    { $divide: ['$completedAppointments', '$totalAppointments'] },\r\n                    0\r\n                  ]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ]),\r\n\r\n        // Revenue metrics\r\n        (Billing as any).aggregate([\r\n          { $match: { clinicId: clinic._id, createdAt: { $gte: start, $lte: end } } },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              totalRevenue: { $sum: '$amount' },\r\n              avgTransactionValue: { $avg: '$amount' },\r\n              totalTransactions: { $sum: 1 },\r\n              paidAmount: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'paid'] }, '$amount', 0]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ]),\r\n\r\n        // Staff productivity (schedules completed vs total)\r\n        StaffSchedule.aggregate([\r\n          { $match: { clinicId: clinic._id, date: { $gte: start, $lte: end } } },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              totalSchedules: { $sum: 1 },\r\n              completedSchedules: {\r\n                $sum: {\r\n                  $cond: [{ $eq: ['$status', 'completed'] }, 1, 0]\r\n                }\r\n              },\r\n              totalHours: {\r\n                $sum: {\r\n                  $divide: [\r\n                    {\r\n                      $subtract: [\r\n                        { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$endTime', ':00Z'] } } },\r\n                        { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$startTime', ':00Z'] } } }\r\n                      ]\r\n                    },\r\n                    3600000\r\n                  ]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        ])\r\n      ]);\r\n\r\n      const efficiencyData = efficiency[0] || { total: 0, completed: 0, cancelled: 0, noShow: 0 };\r\n      const satisfactionData = patientSatisfaction[0] || { avgCompletionRate: 0 };\r\n      const revenueData = revenue[0] || { totalRevenue: 0, avgTransactionValue: 0, totalTransactions: 0, paidAmount: 0 };\r\n      const productivityData = staffProductivity[0] || { totalSchedules: 0, completedSchedules: 0, totalHours: 0 };\r\n\r\n      return {\r\n        clinicId: clinic._id,\r\n        clinicName: clinic.name,\r\n        metrics: {\r\n          efficiency: {\r\n            completionRate: efficiencyData.total > 0 ? (efficiencyData.completed / efficiencyData.total) * 100 : 0,\r\n            cancellationRate: efficiencyData.total > 0 ? (efficiencyData.cancelled / efficiencyData.total) * 100 : 0,\r\n            noShowRate: efficiencyData.total > 0 ? (efficiencyData.noShow / efficiencyData.total) * 100 : 0,\r\n            totalAppointments: efficiencyData.total\r\n          },\r\n          patientSatisfaction: {\r\n            avgCompletionRate: (satisfactionData.avgCompletionRate || 0) * 100\r\n          },\r\n          revenue: {\r\n            total: revenueData.totalRevenue,\r\n            average: revenueData.avgTransactionValue,\r\n            transactions: revenueData.totalTransactions,\r\n            collectionRate: revenueData.totalRevenue > 0 ? (revenueData.paidAmount / revenueData.totalRevenue) * 100 : 0\r\n          },\r\n          staffProductivity: {\r\n            scheduleCompletionRate: productivityData.totalSchedules > 0 ? (productivityData.completedSchedules / productivityData.totalSchedules) * 100 : 0,\r\n            totalHours: productivityData.totalHours,\r\n            avgHoursPerSchedule: productivityData.totalSchedules > 0 ? productivityData.totalHours / productivityData.totalSchedules : 0\r\n          }\r\n        }\r\n      };\r\n    })\r\n  );\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      clinics: performanceData,\r\n      period,\r\n      dateRange: { start, end }\r\n    }\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\appointmentController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatTime' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'sendAppointmentReminderSMS' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":68},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":89,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3152,3155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3152,3155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3179,3182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3179,3182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3205,3208],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3205,3208],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3584,3587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3584,3587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3703,3706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3703,3706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4709,4712],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4709,4712],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":241,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":241,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9188,9191],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9188,9191],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":283,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10826,10829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10826,10829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":302,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":302,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11239,11242],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11239,11242],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":318,"column":87,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":90,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11892,11895],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11892,11895],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":367,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":367,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14038,14041],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14038,14041],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":379,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":379,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14474,14477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14474,14477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":387,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":387,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14864,14867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14864,14867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":398,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":398,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15507,15510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15507,15510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":409,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":409,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15943,15946],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15943,15946],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":418,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":418,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16381,16384],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16381,16384],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":428,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":428,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16752,16755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16752,16755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":463,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":463,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18015,18018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18015,18018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":470,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":470,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18317,18320],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18317,18320],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":487,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":487,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18715,18718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18715,18718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":507,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":507,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19282,19285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19282,19285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":529,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":529,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20054,20057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20054,20057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":587,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":587,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21893,21896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21893,21896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":601,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":601,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22425,22428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22425,22428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":625,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":625,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23130,23133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23130,23133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":651,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":651,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23869,23872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23869,23872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":652,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":652,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23915,23918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23915,23918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":659,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":659,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24115,24118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24115,24118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":687,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":687,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25042,25045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25042,25045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":699,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":699,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25318,25321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25318,25321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":706,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":706,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25610,25613],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25610,25613],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":719,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":719,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25960,25963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25960,25963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":731,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":731,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26275,26278],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26275,26278],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":732,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":732,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26323,26326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26323,26326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":733,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":733,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26369,26372],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26369,26372],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":753,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":753,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26825,26828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26825,26828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":775,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":775,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27623,27626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27623,27626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":810,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":810,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28587,28590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28587,28590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":844,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":844,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29583,29586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29583,29586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":872,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":872,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30303,30306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30303,30306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":873,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":873,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30351,30354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30351,30354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":874,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":874,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30397,30400],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30397,30400],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":937,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":937,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32260,32263],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32260,32263],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":938,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":938,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32308,32311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32308,32311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1073,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1073,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[36471,36474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[36471,36474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1087,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1087,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37066,37069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37066,37069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1124,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1124,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38223,38226],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38223,38226],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1147,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1147,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38871,38874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38871,38874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1251,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1251,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[44010,44013],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[44010,44013],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1314,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1314,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46608,46611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46608,46611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1352,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1352,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[47770,47773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[47770,47773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1411,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1411,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[49397,49400],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[49397,49400],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1420,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1420,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[49669,49672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[49669,49672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1427,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1427,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[49928,49931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[49928,49931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1448,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1448,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[50527,50530],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[50527,50530],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1460,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1460,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[50843,50846],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[50843,50846],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1467,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1467,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[51102,51105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[51102,51105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1480,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1480,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[51467,51470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[51467,51470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1493,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1493,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[51733,51736],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[51733,51736],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1503,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1503,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[51922,51925],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[51922,51925],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1514,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1514,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[52128,52131],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[52128,52131],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1516,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1516,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[52197,52200],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[52197,52200],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1536,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1536,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[52854,52857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[52854,52857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1540,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1540,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[52982,52985],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[52982,52985],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1547,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1547,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[53295,53298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[53295,53298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1563,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1563,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[53850,53853],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[53850,53853],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1570,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1570,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[54160,54163],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[54160,54163],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1587,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1587,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[54703,54706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[54703,54706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1597,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1597,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[54990,54993],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[54990,54993],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1607,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1607,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[55265,55268],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[55265,55268],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1608,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1608,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[55317,55320],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[55317,55320],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1609,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1609,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[55367,55370],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[55367,55370],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1622,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1622,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[55685,55688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[55685,55688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1657,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1657,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[56994,56997],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[56994,56997],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1679,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1679,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[57461,57464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[57461,57464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1684,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1684,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[57639,57642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[57639,57642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1692,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1692,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[57952,57955],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[57952,57955],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1699,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1699,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[58246,58249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[58246,58249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1706,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1706,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[58532,58535],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[58532,58535],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1706,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1706,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[58542,58545],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[58542,58545],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1735,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1735,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[59348,59351],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[59348,59351],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1749,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1749,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[59885,59888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[59885,59888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1774,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1774,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[60383,60386],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[60383,60386],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1779,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1779,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[60545,60548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[60545,60548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1788,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1788,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[60924,60927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[60924,60927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1795,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1795,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[61179,61182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[61179,61182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1804,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1804,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[61479,61482],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[61479,61482],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1804,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1804,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[61489,61492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[61489,61492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1808,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1808,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[61629,61632],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[61629,61632],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1808,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1808,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[61639,61642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[61639,61642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1813,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1813,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[61825,61828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[61825,61828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1845,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1845,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[62714,62717],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[62714,62717],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1898,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1898,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[64152,64155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[64152,64155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1922,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1922,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[64992,64995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[64992,64995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'dentist' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":1978,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":1978,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2019,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2019,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[67722,67725],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[67722,67725],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2071,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2071,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[69434,69437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[69434,69437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2102,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2102,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[70428,70431],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[70428,70431],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2111,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2111,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[70744,70747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[70744,70747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2184,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2184,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[72829,72832],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[72829,72832],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'effectiveDentistId' is never reassigned. Use 'const' instead.","line":2236,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":2236,"endColumn":27,"fix":{"range":[74423,74468],"text":"const effectiveDentistId = dentistId as string;"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2241,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2241,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[74668,74671],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[74668,74671],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2274,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2274,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[75811,75814],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[75811,75814],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2292,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2292,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[76448,76451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[76448,76451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2292,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2292,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[76489,76492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[76489,76492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2303,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2303,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[76874,76877],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[76874,76877],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2312,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2312,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[77152,77155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[77152,77155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2322,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2322,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[77580,77583],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[77580,77583],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2322,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2322,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[77621,77624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[77621,77624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2329,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2329,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[77806,77809],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[77806,77809],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2362,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2362,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[78884,78887],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[78884,78887],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":109,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport mongoose from 'mongoose';\nimport { Appointment, Patient, User, Clinic, Notification, StaffSchedule } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse,\n  formatDate,\n  formatTime,\n  isValidTimeSlot\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError,\n  createConflictError\n} from '../middleware/errorHandler';\nimport { sendAppointmentConfirmationEmail, sendAppointmentReminderEmail, sendAppointmentCancellationEmail } from '../utils/email';\nimport { sendAppointmentConfirmationSMS, sendAppointmentReminderSMS, sendAppointmentCancellationSMS } from '../utils/sms';\nimport { scheduleAppointmentReminders, cancelAppointmentReminders } from '../utils/scheduler';\n\n// Create new appointment with enhanced validation and error handling\nexport const createAppointment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    patientId,\n    clinicId,\n    serviceType,\n    date,\n    timeSlot,\n    duration = 60,\n    notes,\n    emergency = false\n  } = req.body;\n  \n  let { dentistId } = req.body;\n\n  // Required fields validation - dentistId is completely optional\n  const requiredFields = ['patientId', 'serviceType', 'date', 'timeSlot'];\n  const missingFields = requiredFields.filter(field => !req.body[field]);\n  \n  if (missingFields.length > 0) {\n    throw createValidationError(\n      missingFields[0], \n      `Missing required fields: ${missingFields.join(', ')}`\n    );\n  }\n\n  // Input validation\n  const now = new Date();\n  const appointmentDate = new Date(date);\n  \n  // Date validation with emergency exception\n  const today = new Date();\n  \n  // Simple timezone-safe date comparison using date strings\n  const appointmentDateStr = appointmentDate.toISOString().split('T')[0];\n  const todayDateStr = today.toISOString().split('T')[0];\n  \n  if (!emergency && appointmentDateStr < todayDateStr) {\n    throw createValidationError('date', 'Appointment date cannot be in the past');\n  }\n  \n  // For emergency appointments, allow same day but not past time\n  if (emergency && appointmentDate.toDateString() === now.toDateString()) {\n    const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;\n    if (timeSlot < currentTime) {\n      throw createValidationError('timeSlot', 'Emergency appointment time must be in the future');\n    }\n  }\n\n  // Validate time slot format (HH:MM)\n  const timeRegex = /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/;\n  if (!timeRegex.test(timeSlot)) {\n    throw createValidationError('timeSlot', 'Invalid time slot format. Use HH:MM format');\n  }\n\n  // Validate service type\n  if (serviceType && typeof serviceType !== 'string') {\n    throw createValidationError('serviceType', 'Service type must be a string');\n  }\n\n  // Validate duration\n  if (duration && (isNaN(Number(duration)) || Number(duration) <= 0)) {\n    throw createValidationError('duration', 'Duration must be a positive number');\n  }\n\n  // Entity existence checks with detailed error messages\n  let patient: any = null;\n  let dentist: any = null;\n  let clinic: any = null;\n  \n  try {\n    // Debug logging to understand what IDs we're receiving\n    console.log('Creating appointment with IDs:', {\n      patientId,\n      dentistId,\n      clinicId,\n      patientIdType: typeof patientId,\n      dentistIdType: typeof dentistId,\n      clinicIdType: typeof clinicId\n    });\n\n    [patient, dentist, clinic] = await Promise.all([\n      (Patient as any).findById(patientId).exec(),\n      dentistId ? User.findById(dentistId).exec() : null,\n      clinicId ? (Clinic as any).findById(clinicId).exec() : null\n    ]);\n\n    console.log('Entity lookup results:', {\n      patientFound: !!patient,\n      dentistFound: !!dentist,\n      clinicFound: !!clinic,\n      patientData: patient ? { id: patient._id, name: `${patient.firstName} ${patient.lastName}` } : null\n    });\n\n    if (!patient) {\n      throw createNotFoundError(`Patient not found with ID: ${patientId}`);\n    }\n\n    // If dentistId is provided but not found\n    if (dentistId && !dentist) {\n      throw createNotFoundError('Dentist not found');\n    }\n\n    // If clinicId is provided but not found\n    if (clinicId && !clinic) {\n      throw createNotFoundError('Clinic not found');\n    }\n\n    // Business rules validation\n    if (dentist && clinicId && !dentist.assignedClinics.includes(clinicId)) {\n      throw createValidationError('dentistId', 'Dentist is not assigned to this clinic');\n    }\n\n    // Check for conflicts only if dentistId is provided\n    if (dentistId) {\n    const conflicts = await (Appointment as any).findConflicts(dentistId, appointmentDate, timeSlot, duration);\n    if (conflicts.length > 0) {\n      throw createConflictError(\n        `Time slot ${timeSlot} on ${formatDate(appointmentDate)} is already booked. Please select another time.`\n      );\n      }\n    } else {\n      console.log('Skipping conflict check - no dentist assigned to appointment');\n    }\n  } catch (error) {\n    if (error instanceof AppError) {\n      throw error;\n    }\n    console.error('Error during entity validation:', error);\n    throw createValidationError('general', 'Failed to validate appointment data');\n  }\n\n  // Auto-assign dentist if none provided (with timeout protection)\n  if (!dentistId) {\n    console.log('No dentist provided - attempting auto-assignment with timeout');\n    \n    try {\n      // Add timeout wrapper for auto-assignment\n      const autoAssignmentPromise = Promise.race([\n        (async () => {\n      // Get the day of the week for the appointment (0 = Sunday, 6 = Saturday)\n      const appointmentDayOfWeek = appointmentDate.getDay();\n      const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n      console.log(` Appointment requested for ${dayNames[appointmentDayOfWeek]} (day ${appointmentDayOfWeek})`);\n      \n      // Find all dentists in this clinic\n      const allDentists = await User.find({\n        role: 'dentist',\n        isActive: true,\n        assignedClinics: { $in: [clinicId] }\n      });\n      \n      if (allDentists.length === 0) {\n        console.log(' No dentists found in this clinic - proceeding without assignment');\n        return;\n      }\n      \n      console.log(` Found ${allDentists.length} dentists in clinic, checking schedules...`);\n      \n      // Check which dentists are scheduled to work on this day\n      const scheduledDentists = [];\n      \n      for (const dentist of allDentists) {\n        // Check if this dentist has a schedule for this specific date or recurring pattern\n        // FIXED: Use proper ObjectId conversion and simplified query structure\n        const staffObjectId = typeof dentist._id === 'string' ? new mongoose.Types.ObjectId(dentist._id) : dentist._id;\n        const clinicObjectId = typeof clinicId === 'string' ? new mongoose.Types.ObjectId(clinicId) : clinicId;\n        \n        const scheduleQuery = {\n          staffId: staffObjectId,\n          clinicId: clinicObjectId,\n          status: { $in: ['scheduled', 'completed'] },\n          $or: [\n            // Specific date schedule\n            {\n              date: {\n                $gte: new Date(appointmentDate.getFullYear(), appointmentDate.getMonth(), appointmentDate.getDate()),\n                $lt: new Date(appointmentDate.getFullYear(), appointmentDate.getMonth(), appointmentDate.getDate() + 1)\n              }\n            },\n            // Recurring schedule that includes this day of week\n            {\n              isRecurring: true,\n              'recurringPattern.daysOfWeek': { $in: [appointmentDayOfWeek] },\n              $or: [\n                { 'recurringPattern.endDate': { $exists: false } },\n                { 'recurringPattern.endDate': { $gte: appointmentDate } }\n              ]\n            }\n          ]\n        };\n        \n        // Simplified scheduling check - just look for basic availability\n        const schedules = await StaffSchedule.find(scheduleQuery).limit(1);\n        \n        console.log(`Checking Dr. ${dentist.firstName} ${dentist.lastName} - found ${schedules.length} schedules`);\n        \n        if (schedules.length > 0) {\n          console.log(` ${dentist.firstName} ${dentist.lastName} is scheduled for ${dayNames[appointmentDayOfWeek]}`);\n          scheduledDentists.push(dentist);\n        } else {\n          console.log(` ${dentist.firstName} ${dentist.lastName} is NOT scheduled for ${dayNames[appointmentDayOfWeek]}`);\n        }\n      }\n      \n      if (scheduledDentists.length === 0) {\n        console.log(' No dentists are scheduled to work on this day - proceeding without assignment');\n        return;\n      }\n      \n      // Among scheduled dentists, check for appointment conflicts (parallel processing)\n      const availableDentists = [];\n      \n      if (scheduledDentists.length > 0) {\n        console.log(`Checking conflicts for ${scheduledDentists.length} dentists...`);\n        \n        // Check conflicts in parallel for better performance\n        const conflictPromises = scheduledDentists.map(dentist => \n          (Appointment as any).findConflicts(dentist._id.toString(), appointmentDate, timeSlot, duration)\n            .then(conflicts => ({ dentist, conflicts }))\n        );\n        \n        const conflictResults = await Promise.all(conflictPromises);\n        \n        for (const { dentist, conflicts } of conflictResults) {\n          if (conflicts.length === 0) {\n            availableDentists.push(dentist);\n            console.log(` Dr. ${dentist.firstName} ${dentist.lastName} is available`);\n          }\n        }\n      }\n      \n      if (availableDentists.length > 0) {\n        // Auto-assign the first available dentist\n        const assignedDentist = availableDentists[0];\n        dentistId = assignedDentist._id.toString();\n        dentist = assignedDentist;\n        \n        console.log(` AUTO-ASSIGNED: Dr. ${assignedDentist.firstName} ${assignedDentist.lastName} for ${dayNames[appointmentDayOfWeek]} at ${timeSlot}`);\n      } else {\n        console.log(' All scheduled dentists are busy at this time - proceeding without assignment');\n      }\n      \n        })(), // End of auto-assignment async function\n        \n        // Timeout after 5 seconds\n        new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Auto-assignment timeout')), 5000)\n        )\n      ]);\n      \n      await autoAssignmentPromise;\n      \n    } catch (autoAssignError) {\n      console.error('Error during auto-assignment:', autoAssignError);\n      console.log('Proceeding without dentist assignment due to error or timeout');\n    }\n  }\n\n  // Create and save appointment with enhanced status handling for emergency appointments\n  const appointmentData: any = {\n    patientId,\n    clinicId,\n    serviceType,\n    date: appointmentDate,\n    timeSlot,\n    duration,\n    notes,\n    status: emergency ? 'urgent' : 'scheduled',\n    emergency,\n    createdBy: req.user?._id || req.user?.id,\n    createdAt: new Date()\n  };\n\n  // Only add dentistId if it's provided\n  if (dentistId) {\n    appointmentData.dentistId = dentistId;\n  }\n\n  const appointment = await (Appointment as any).create(appointmentData);\n\n  // Populate related data with more comprehensive information\n  const populatePaths = [\n    { path: 'patientId', select: 'firstName lastName email phone dateOfBirth gender' },\n    { path: 'clinicId', select: 'name address phone email operatingHours' }\n  ];\n\n  // Only populate dentistId if it exists\n  if (dentistId) {\n    populatePaths.push({ path: 'dentistId', select: 'firstName lastName email specialization phone' });\n  }\n\n  await appointment.populate(populatePaths);\n\n  // Enhanced notification system with better error handling\n  const notificationResults: { email: boolean; sms?: boolean; inApp: boolean; errors: any[] } = { email: false, sms: false, inApp: false, errors: [] };\n  \n  try {\n    const notificationPromises = [];\n    // Get notification preferences - use default if not set\n    const notificationPreferences = {\n      enabled: true,\n      channels: { email: true, sms: true, inApp: true }\n    };\n    \n    // Only proceed with notifications if they're enabled\n    if (notificationPreferences.enabled) {\n      // Send email if patient has an email address and email notifications are enabled\n      if (patient.email && notificationPreferences.channels.email) {\n        const emailPromise = sendAppointmentConfirmationEmail(\n          patient.email,\n          patient.fullName || `${patient.firstName} ${patient.lastName}`,\n          {\n            date: formatDate(appointmentDate),\n            time: timeSlot,\n            dentist: dentist ? (dentist.fullName || `${dentist.firstName} ${dentist.lastName}`) : 'To be assigned',\n            clinic: clinic ? clinic.name : 'Our clinic',\n            service: serviceType\n          }\n        ).then(() => {\n          notificationResults.email = true;\n        }).catch(err => {\n          console.error('Email notification error:', err);\n          notificationResults.errors.push({ type: 'email', message: err.message });\n          return null; // Don't fail the promise chain\n        });\n        \n        notificationPromises.push(emailPromise);\n      }\n      \n      // Send SMS if patient has a phone number and SMS notifications are enabled\n      if (patient.phone && notificationPreferences.channels.sms) {\n        const smsPromise = sendAppointmentConfirmationSMS(\n          patient.phone,\n          patient.fullName || `${patient.firstName} ${patient.lastName}`,\n          {\n            date: formatDate(appointmentDate),\n            time: timeSlot,\n            dentist: dentist ? (dentist.fullName || `${dentist.firstName} ${dentist.lastName}`) : 'To be assigned',\n            clinic: clinic ? clinic.name : 'Our clinic',\n            service: serviceType\n          }\n        ).then(() => {\n          if (notificationResults.sms !== undefined) notificationResults.sms = true;\n        }).catch((err: any) => {\n          console.error('SMS notification error:', err);\n          notificationResults.errors.push({ type: 'sms', message: err.message });\n          return null; // Don't fail the promise chain\n        });\n        \n        notificationPromises.push(smsPromise);\n      }\n      \n      // Schedule appointment reminders\n      try {\n        scheduleAppointmentReminders(appointment, patient, dentist, clinic);\n      } catch (err: any) {\n        console.error('Failed to schedule appointment reminders:', err);\n        notificationResults.errors.push({ type: 'reminder', message: err?.message || 'Unknown error' });\n      }\n    }\n    \n    // Create in-app notification if enabled or if this is an emergency\n    if (notificationPreferences.channels.inApp || emergency) {\n      const notificationPromise = (Notification as any).create({\n      userId: patientId,\n      type: emergency ? 'urgent_appointment' : 'appointment_confirmation',\n      title: emergency ? 'Urgent Appointment Scheduled' : 'Appointment Confirmed',\n      message: `Your ${emergency ? 'urgent ' : ''}appointment has been ${emergency ? 'scheduled' : 'confirmed'} for ${formatDate(appointmentDate)} at ${timeSlot}${dentist ? ` with ${dentist.firstName} ${dentist.lastName}` : ''}`,\n      appointmentId: appointment._id,\n      createdAt: new Date(),\n      status: 'unread',\n      priority: emergency ? 'high' : 'normal'\n    }).then(() => {\n      notificationResults.inApp = true;\n    }).catch((err: any) => {\n      console.error('In-app notification error:', err);\n      notificationResults.errors.push({ type: 'inApp', message: err.message });\n      return null; // Don't fail the promise chain\n    });\n    \n    notificationPromises.push(notificationPromise);\n    }\n    \n    // If this is an emergency appointment, also notify staff\n    if (emergency && dentist && dentistId) {\n      const staffNotificationPromise = (Notification as any).create({\n        userId: dentistId,\n        type: 'urgent_appointment_staff',\n        title: 'Urgent Appointment Scheduled',\n        message: `An urgent appointment has been scheduled for ${formatDate(appointmentDate)} at ${timeSlot} with patient ${patient.firstName} ${patient.lastName}`,\n        appointmentId: appointment._id,\n        createdAt: new Date(),\n        status: 'unread',\n        priority: 'high'\n      }).catch((err: any) => {\n        console.error('Staff notification error:', err);\n        notificationResults.errors.push({ type: 'staffNotification', message: err.message });\n        return null; // Don't fail the promise chain\n      });\n      \n      notificationPromises.push(staffNotificationPromise);\n    }\n    \n    await Promise.allSettled(notificationPromises);\n  } catch (error: any) {\n    console.error('Notification system error:', error);\n    notificationResults.errors.push({ type: 'system', message: error?.message || 'Unknown notification error' });\n  }\n\n  // Enhanced response with more detailed information\n  res.status(201).json({\n    success: true,\n    message: emergency ? 'Urgent appointment scheduled successfully' : 'Appointment created successfully',\n    data: { \n      appointment,\n      notifications: {\n        emailSent: notificationResults.email,\n        smsSent: notificationResults.sms || false,\n        inAppCreated: notificationResults.inApp,\n        errors: notificationResults.errors.length > 0 ? notificationResults.errors : undefined\n      }\n    }\n  });\n});\n\n// Get all appointments with filtering and pagination\nexport const getAllAppointments = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { status, date, dentistId, clinicId, patientId } = req.query;\n\n  const query = buildAppointmentQuery({ \n    status: status as string, \n    date: date as string, \n    dentistId: dentistId as string, \n    clinicId: clinicId as string, \n    patientId: patientId as string \n  });\n\n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'firstName lastName email phone')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address phone')\n      .sort({ date: -1, 'timeSlot.start': 1 })\n      .skip(skip)\n      .limit(limit),\n    (Appointment as any).countDocuments(query)\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(appointments, total, page, limit)\n  });\n});\n\n// Helper function to build appointment query\nconst buildAppointmentQuery = ({ status, date, dentistId, clinicId, patientId }: {\n  status?: string;\n  date?: string;\n  dentistId?: string;\n  clinicId?: string;\n  patientId?: string;\n}) => {\n  const query: any = {};\n\n  if (status) query.status = status;\n  if (dentistId) query.dentistId = dentistId;\n  if (clinicId) query.clinicId = clinicId;\n  if (patientId) query.patientId = patientId;\n\n  if (date) {\n    const searchDate = new Date(date as string);\n    query.date = {\n      $gte: new Date(searchDate.setHours(0, 0, 0, 0)),\n      $lte: new Date(searchDate.setHours(23, 59, 59, 999))\n    };\n  }\n\n  return query;\n};\n\n// Get appointment by ID\nexport const getAppointmentById = catchAsync(async (req: Request, res: Response) => {\n  const appointment = await (Appointment as any).findById(req.params.id)\n    .populate('patientId', 'firstName lastName email phone dateOfBirth gender address')\n    .populate('dentistId', 'firstName lastName email specialization phone')\n    .populate('clinicId', 'name address phone email operatingHours');\n\n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n\n  res.json({\n    success: true,\n    data: { appointment }\n  });\n});\n\n// Update appointment\nexport const updateAppointment = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const { date, timeSlot, duration, serviceType, notes, status } = req.body;\n\n  // console.log(' UpdateAppointment - Request details:', { appointmentId: id, requestBody: req.body });\n\n  const appointment = await (Appointment as any).findById(id)\n    .populate('patientId', 'firstName lastName email')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name');\n\n  if (!appointment) {\n    console.error(' Appointment not found:', id);\n    throw createNotFoundError('Appointment');\n  }\n\n  // Check if appointment can be modified (allow cancellation of any non-cancelled appointment)\n  if (appointment.status === 'completed' || appointment.status === 'cancelled') {\n    if (status !== 'cancelled' || appointment.status === 'cancelled') {\n      throw createValidationError('status', 'Cannot modify completed or cancelled appointments');\n    }\n  }\n\n  // Handle date/time changes (only if date or timeSlot is provided)\n  if (date || timeSlot) {\n    try {\n      await validateAndUpdateDateTime(appointment, date, timeSlot);\n    } catch (error) {\n      console.error(' Date/time validation failed:', error);\n      throw error;\n    }\n  }\n\n  // Update other fields\n  const updateData = {\n    ...(duration && { duration }),\n    ...(serviceType && { serviceType }),\n    ...(notes && { notes }),\n    ...(status && { status })\n  };\n  \n  Object.assign(appointment, updateData);\n\n  try {\n    // Skip validation when only updating status (to avoid createdBy and past date validation issues)\n    const isOnlyStatusUpdate = Object.keys(updateData).length === 1 && updateData.status;\n    if (isOnlyStatusUpdate) {\n      await appointment.save({ validateBeforeSave: false });\n    } else {\n      await appointment.save();\n    }\n  } catch (saveError) {\n    console.error(' Error saving appointment:', saveError);\n    throw saveError;\n  }\n\n  res.json({\n    success: true,\n    message: 'Appointment updated successfully',\n    data: { appointment }\n  });\n});\n\n// Helper function to validate and update date/time\nasync function validateAndUpdateDateTime(appointment: any, date: string, timeSlot: string) {\n  const newDate = date ? new Date(date) : appointment.date;\n  const newTimeSlot = timeSlot || appointment.timeSlot;\n\n  const today = new Date();\n  \n  // Simple timezone-safe date comparison using date strings\n  const newDateStr = newDate.toISOString().split('T')[0];\n  const todayDateStr = today.toISOString().split('T')[0];\n  \n  if (newDateStr < todayDateStr) {\n    throw createValidationError('date', 'Appointment date cannot be in the past');\n  }\n\n  const conflicts = await (Appointment as any).find({\n    dentistId: appointment.dentistId,\n    date: {\n      $gte: new Date(newDate.setHours(0, 0, 0, 0)),\n      $lte: new Date(newDate.setHours(23, 59, 59, 999))\n    },\n    timeSlot: newTimeSlot, // Fixed: timeSlot is a string, not an object\n    _id: { $ne: appointment._id },\n    status: { $ne: 'cancelled' }\n  });\n\n  if (conflicts.length > 0) {\n    throw createConflictError('Time slot is already booked');\n  }\n\n  appointment.date = newDate;\n  appointment.timeSlot = newTimeSlot;\n}\n\n// Cancel appointment\nexport const cancelAppointment = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const { reason } = req.body;\n\n  const appointment = await (Appointment as any).findById(id)\n    .populate('patientId', 'firstName lastName email')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name address phone');\n\n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n\n  if (!appointment.canBeCancelled()) {\n    throw createValidationError('appointment', 'Appointment cannot be cancelled');\n  }\n\n  appointment.status = 'cancelled';\n  if (reason) {\n    appointment.notes = appointment.notes ? \n      `${appointment.notes}\\n\\nCancellation reason: ${reason}` : \n      `Cancellation reason: ${reason}`;\n  }\n\n  await appointment.save();\n\n  // Send notifications\n  try {\n    await Promise.all([\n      sendAppointmentCancellationEmail(\n        (appointment.patientId as any).email,\n        (appointment.patientId as any).fullName,\n        {\n          date: formatDate(appointment.date),\n          time: appointment.timeSlot,\n          reason: reason || 'No reason provided'\n        }\n      ),\n      (Notification as any).create({\n        userId: appointment.patientId,\n        type: 'appointment_cancellation',\n        title: 'Appointment Cancelled',\n        message: `Your appointment for ${formatDate(appointment.date)} at ${appointment.timeSlot} has been cancelled${reason ? `: ${reason}` : ''}`,\n        appointmentId: appointment._id\n      })\n    ]);\n  } catch (error) {\n    console.error('Notification error:', error);\n  }\n\n  res.json({\n    success: true,\n    message: 'Appointment cancelled successfully',\n    data: { appointment }\n  });\n});\n\n// Get today's appointments\nexport const getTodayAppointments = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { dentistId, clinicId, status } = req.query;\n\n  const today = new Date();\n  const startOfDay = new Date(today.setHours(0, 0, 0, 0));\n  const endOfDay = new Date(today.setHours(23, 59, 59, 999));\n\n  const query: any = {\n    date: {\n      $gte: startOfDay,\n      $lte: endOfDay\n    }\n  };\n\n  if (dentistId) query.dentistId = dentistId;\n  if (clinicId) query.clinicId = clinicId;\n  if (status) query.status = status;\n\n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'firstName lastName email phone')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address phone')\n      .sort({ 'timeSlot.start': 1 })\n      .skip(skip)\n      .limit(limit),\n    (Appointment as any).countDocuments(query)\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(appointments, total, page, limit)\n  });\n});\n\n// Send appointment reminder\nexport const sendAppointmentReminder = catchAsync(async (req: Request, res: Response) => {\n  const { appointmentId } = req.params;\n\n  const appointment = await (Appointment as any).findById(appointmentId)\n    .populate('patientId', 'name email')\n    .populate('dentistId', 'name')\n    .populate('clinicId', 'name');\n\n  if (!appointment) {\n    return res.status(404).json({\n      status: 'error',\n      message: 'Appointment not found'\n    });\n  }\n\n  const patient = appointment.patientId as any;\n  const dentist = appointment.dentistId as any;\n  const clinic = appointment.clinicId as any;\n\n  // Send reminder email\n  try {\n    await sendAppointmentReminderEmail(\n      patient.email,\n      patient.name,\n      {\n        date: new Date(appointment.date).toLocaleDateString(),\n        time: appointment.timeSlot,\n        dentist: dentist.name,\n        clinic: clinic.name\n      }\n    );\n  } catch (emailError) {\n    console.error('Failed to send reminder email:', emailError);\n  }\n\n  // Create notification\n  try {\n    await (Notification as any).create({\n      userId: appointment.patientId,\n      type: 'appointment_reminder',\n      title: 'Appointment Reminder',\n      message: `You have an appointment scheduled for ${new Date(appointment.date).toLocaleDateString()} at ${appointment.timeSlot}`,\n      appointmentId: appointment._id\n    });\n  } catch (notificationError) {\n    console.error('Failed to create notification:', notificationError);\n  }\n\n  return res.status(200).json({\n    status: 'success',\n    message: 'Appointment reminder sent successfully'\n  });\n});\n\n// Complete appointment\nexport const completeAppointment = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const { treatmentProvided, followUpRequired, followUpDate, notes } = req.body;\n\n  const appointment = await (Appointment as any).findById(id);\n  if (!appointment) {\n    return res.status(404).json({\n      status: 'error',\n      message: 'Appointment not found'\n    });\n  }\n\n  if (appointment.status !== 'in-progress') {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Only in-progress appointments can be completed'\n    });\n  }\n\n  appointment.status = 'completed';\n  appointment.treatmentProvided = treatmentProvided;\n  appointment.followUpRequired = followUpRequired;\n  appointment.followUpDate = followUpDate;\n  if (notes) appointment.notes = notes;\n\n  await appointment.save();\n\n  return res.status(200).json({\n    status: 'success',\n    message: 'Appointment completed successfully',\n    data: { appointment }\n  });\n});\n\n// Reschedule appointment\nexport const rescheduleAppointment = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const { newDate, newTime, reason } = req.body;\n\n  const appointment = await (Appointment as any).findById(id)\n    .populate('patientId', 'name email')\n    .populate('dentistId', 'name')\n    .populate('clinicId', 'name');\n\n  if (!appointment) {\n    return res.status(404).json({\n      status: 'error',\n      message: 'Appointment not found'\n    });\n  }\n\n  if (appointment.status === 'completed' || appointment.status === 'cancelled') {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Cannot reschedule completed or cancelled appointments'\n    });\n  }\n\n  const appointmentDate = new Date(newDate);\n  const today = new Date();\n  \n  // Simple timezone-safe date comparison using date strings\n  const appointmentDateStr = appointmentDate.toISOString().split('T')[0];\n  const todayDateStr = today.toISOString().split('T')[0];\n  \n  if (appointmentDateStr < todayDateStr) {\n    return res.status(400).json({\n      status: 'error',\n      message: 'New appointment date cannot be in the past'\n    });\n  }\n\n  // Check for conflicts\n  const conflicts = await (Appointment as any).findConflicts(\n    appointment.dentistId?.toString() || '',\n    appointmentDate,\n    newTime,\n    appointment.duration,\n    id\n  );\n\n  if (conflicts.length > 0) {\n    return res.status(409).json({\n      status: 'error',\n      message: 'The new time slot conflicts with an existing appointment'\n    });\n  }\n\n  const oldDate = new Date(appointment.date).toLocaleDateString();\n  const oldTime = appointment.timeSlot;\n\n  appointment.date = appointmentDate;\n  appointment.timeSlot = newTime;\n  if (reason) {\n    appointment.notes = appointment.notes ? \n      `${appointment.notes}\\n\\nRescheduled: ${reason}` : \n      `Rescheduled: ${reason}`;\n  }\n\n  await appointment.save();\n\n  const patient = appointment.patientId as any;\n  const dentist = appointment.dentistId as any;\n  const clinic = appointment.clinicId as any;\n\n  // Send confirmation email for rescheduled appointment\n  try {\n    await sendAppointmentConfirmationEmail(\n      patient.email,\n      patient.name,\n      {\n        date: new Date(appointmentDate).toLocaleDateString(),\n        time: newTime,\n        dentist: dentist.name,\n        clinic: clinic.name,\n        service: appointment.serviceType\n      }\n    );\n  } catch (emailError) {\n    console.error('Failed to send confirmation email:', emailError);\n  }\n\n  return res.status(200).json({\n    status: 'success',\n    message: `Appointment rescheduled from ${oldDate} ${oldTime} to ${new Date(appointmentDate).toLocaleDateString()} ${newTime}`,\n    data: { appointment }\n  });\n});\n\n// Auto-book first available appointment for a given date\nexport const autoBookFirstAvailable = catchAsync(async (req: AuthenticatedRequest, res: Response): Promise<void> => {\n  const {\n    patientId,\n    clinicId,\n    serviceType,\n    date,\n    duration = 60,\n    notes,\n    emergency = false\n  } = req.body;\n  \n  // Required fields validation\n  const requiredFields = ['patientId', 'serviceType', 'date', 'clinicId'];\n  const missingFields = requiredFields.filter(field => !req.body[field]);\n  \n  if (missingFields.length > 0) {\n    throw createValidationError(\n      missingFields[0], \n      `Missing required fields: ${missingFields.join(', ')}`\n    );\n  }\n\n  // Input validation\n  const appointmentDate = new Date(date);\n  const today = new Date();\n  \n  // Date validation with emergency exception\n  const appointmentDateStr = appointmentDate.toISOString().split('T')[0];\n  const todayDateStr = today.toISOString().split('T')[0];\n  \n  if (!emergency && appointmentDateStr < todayDateStr) {\n    throw createValidationError('date', 'Appointment date cannot be in the past');\n  }\n\n  // Validate entities exist\n  const [patient, clinic] = await Promise.all([\n    (Patient as any).findById(patientId).exec(),\n    (Clinic as any).findById(clinicId).exec()\n  ]);\n\n  if (!patient) {\n    throw createNotFoundError(`Patient not found with ID: ${patientId}`);\n  }\n\n  if (!clinic) {\n    throw createNotFoundError('Clinic not found');\n  }\n\n  // Get available time slots for this date\n  const appointmentDayOfWeek = appointmentDate.getDay();\n  const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  \n  console.log(` Auto-booking: Looking for first available slot on ${dayNames[appointmentDayOfWeek]} (${appointmentDateStr})`);\n\n  // Get all dentists assigned to this clinic\n  const allDentists = await User.find({\n    role: { $in: ['dentist', 'admin'] },\n    isActive: true,\n    assignedClinics: clinicId\n  });\n\n  if (allDentists.length === 0) {\n    res.status(404).json({\n      success: false,\n      message: 'No dentists available at this clinic'\n    });\n    return;\n  }\n\n  // Filter dentists who are scheduled to work on this day\n  const scheduledDentists = [];\n  \n  for (const dentist of allDentists) {\n    const staffObjectId = typeof dentist._id === 'string' ? new mongoose.Types.ObjectId(dentist._id) : dentist._id;\n    const clinicObjectId = typeof clinicId === 'string' ? new mongoose.Types.ObjectId(clinicId) : clinicId;\n    \n    const scheduleQuery = {\n      staffId: staffObjectId,\n      clinicId: clinicObjectId,\n      status: { $in: ['scheduled', 'completed'] },\n      $or: [\n        // Specific date schedule\n        {\n          date: {\n            $gte: new Date(appointmentDate.getFullYear(), appointmentDate.getMonth(), appointmentDate.getDate()),\n            $lt: new Date(appointmentDate.getFullYear(), appointmentDate.getMonth(), appointmentDate.getDate() + 1)\n          }\n        },\n        // Recurring schedule that includes this day of week\n        {\n          isRecurring: true,\n          'recurringPattern.daysOfWeek': { $in: [appointmentDayOfWeek] },\n          $or: [\n            { 'recurringPattern.endDate': { $exists: false } },\n            { 'recurringPattern.endDate': { $gte: appointmentDate } }\n          ]\n        }\n      ]\n    };\n    \n    const schedules = await StaffSchedule.find(scheduleQuery);\n    \n    if (schedules.length > 0) {\n      scheduledDentists.push(dentist);\n    }\n  }\n\n  if (scheduledDentists.length === 0) {\n    res.status(404).json({\n      success: false,\n      message: `No dentists are scheduled to work on ${dayNames[appointmentDayOfWeek]}`\n    });\n    return;\n  }\n\n  // Get available slots for all scheduled dentists and find the first available one\n  const allSlots = [];\n  \n  for (const dentist of scheduledDentists) {\n    const slots = await Appointment.getAvailableTimeSlots(\n      dentist._id.toString(),\n      appointmentDate,\n      parseInt(duration as string)\n    );\n    \n    // Add dentist information to each slot\n    const slotsWithDentist = slots.map(slot => ({\n      ...slot,\n      dentistId: dentist._id.toString(),\n      dentistName: `${dentist.firstName} ${dentist.lastName}`,\n      dentistSpecialization: dentist.specialization\n    }));\n    \n    allSlots.push(...slotsWithDentist);\n  }\n\n  if (allSlots.length === 0) {\n    res.status(404).json({\n      success: false,\n      message: 'No available time slots found for the selected date'\n    });\n    return;\n  }\n\n  // Sort slots by time to get the earliest available slot\n  allSlots.sort((a, b) => {\n    const timeA = a.time || a.timeSlot;\n    const timeB = b.time || b.timeSlot;\n    return timeA.localeCompare(timeB);\n  });\n\n  const firstAvailableSlot = allSlots[0];\n  const selectedTimeSlot = firstAvailableSlot.time || firstAvailableSlot.timeSlot;\n\n  console.log(` Auto-booking: Found first available slot at ${selectedTimeSlot} with Dr. ${firstAvailableSlot.dentistName}`);\n\n  // Create the appointment with the first available slot\n  const appointmentData = {\n    patientId,\n    dentistId: firstAvailableSlot.dentistId,\n    clinicId,\n    serviceType,\n    date: appointmentDate,\n    timeSlot: selectedTimeSlot,\n    duration,\n    notes,\n    status: emergency ? 'urgent' : 'scheduled',\n    emergency,\n    createdBy: req.user?._id || req.user?.id,\n    createdAt: new Date()\n  };\n\n  const appointment = await (Appointment as any).create(appointmentData);\n\n  // Populate related data\n  await appointment.populate([\n    { path: 'patientId', select: 'firstName lastName email phone dateOfBirth gender' },\n    { path: 'dentistId', select: 'firstName lastName email specialization phone' },\n    { path: 'clinicId', select: 'name address phone email operatingHours' }\n  ]);\n\n  // Send notifications (reusing existing notification logic)\n  const notificationResults = { email: false, sms: false, inApp: false, errors: [] };\n  \n  try {\n    // Schedule appointment reminders\n    await scheduleAppointmentReminders(appointment as any);\n    \n    res.status(201).json({\n      success: true,\n      message: `Appointment automatically booked for ${selectedTimeSlot} with Dr. ${firstAvailableSlot.dentistName}`,\n      data: {\n        appointment,\n        bookedSlot: {\n          time: selectedTimeSlot,\n          dentistName: firstAvailableSlot.dentistName,\n          dentistSpecialization: firstAvailableSlot.dentistSpecialization\n        },\n        notifications: notificationResults\n      }\n    });\n  } catch (error) {\n    console.error('Auto-booking appointment error:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to auto-book appointment',\n      error: error instanceof Error ? error.message : 'Unknown error'\n    });\n  }\n});\n\n// Get available time slots with enhanced validation\nexport const getAvailableTimeSlots = catchAsync(async (req: Request, res: Response) => {\n  const { date, dentistId, clinicId, duration = 60 } = req.query;\n\n  if (!date || !clinicId) {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Date and clinicId are required'\n    });\n  }\n\n  // Validate clinic exists first\n  const clinic = await (Clinic as any).findById(clinicId);\n  if (!clinic) {\n    return res.status(404).json({\n      status: 'error',\n      message: 'Clinic not found',\n      data: { availableSlots: [] }\n    });\n  }\n\n  const searchDate = new Date(date as string);\n  const today = new Date();\n  \n  // Simple timezone-safe date comparison using date strings\n  const searchDateStr = searchDate.toISOString().split('T')[0]; // YYYY-MM-DD\n  const todayDateStr = today.toISOString().split('T')[0]; // YYYY-MM-DD\n  \n  if (searchDateStr < todayDateStr) {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Date cannot be in the past'\n    });\n  }\n\n  let availableSlots: any[] = [];\n\n  if (dentistId) {\n    // If dentistId is provided, get slots for that specific dentist\n    availableSlots = await Appointment.getAvailableTimeSlots(\n      dentistId as string,\n      searchDate,\n      parseInt(duration as string)\n    );\n  } else {\n    // If no dentistId provided, get slots for all dentists in the clinic\n    console.log('Searching for dentists with clinicId:', clinicId);\n    \n    try {\n      console.log('Querying for dentists with criteria:', {\n        role: 'dentist',\n        isActive: true,\n        assignedClinics: { $in: [clinicId] }\n      });\n      \n      // Get all dentists assigned to this clinic\n      const allDentists = await User.find({ \n        role: 'dentist', \n        isActive: true,  // Use isActive instead of status\n        assignedClinics: { $in: [clinicId] }\n      });\n\n      console.log(` Found ${allDentists.length} dentists for clinic ${clinicId}`);\n      allDentists.forEach(d => {\n        console.log(`   ${d.firstName} ${d.lastName} (${d._id})`);\n      });\n\n      if (allDentists.length === 0) {\n        // No dentists in clinic - this is a configuration issue\n        console.warn(` No dentists assigned to clinic ${clinicId} (${clinic.name})`);\n        return res.status(200).json({\n          status: 'success',\n          data: { availableSlots: [] },\n          message: `No dentists are assigned to clinic \"${clinic.name}\". Please contact administration to assign dentists before booking appointments.`,\n          error: 'NO_DENTISTS_ASSIGNED',\n          clinicInfo: {\n            id: clinic._id,\n            name: clinic.name\n          }\n        });\n      }\n\n      // SCHEDULE-AWARE: Only include dentists who are scheduled to work on this day\n      const appointmentDayOfWeek = searchDate.getDay();\n      const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n      console.log(` Checking available slots for ${dayNames[appointmentDayOfWeek]} (day ${appointmentDayOfWeek})`);\n      \n      // Filter dentists who are scheduled to work on this day\n      const dentists = [];\n      \n      for (const dentist of allDentists) {\n        // Check if this dentist has a schedule for this specific date or recurring pattern\n        // FIXED: Use proper ObjectId conversion and simplified query structure\n        const staffObjectId = typeof dentist._id === 'string' ? new mongoose.Types.ObjectId(dentist._id) : dentist._id;\n        const clinicObjectId = typeof clinicId === 'string' ? new mongoose.Types.ObjectId(clinicId) : clinicId;\n        \n        const scheduleQuery = {\n          staffId: staffObjectId,\n          clinicId: clinicObjectId,\n          status: { $in: ['scheduled', 'completed'] },\n          $or: [\n            // Specific date schedule\n            {\n              date: {\n                $gte: new Date(searchDate.getFullYear(), searchDate.getMonth(), searchDate.getDate()),\n                $lt: new Date(searchDate.getFullYear(), searchDate.getMonth(), searchDate.getDate() + 1)\n              }\n            },\n            // Recurring schedule that includes this day of week\n            {\n              isRecurring: true,\n              'recurringPattern.daysOfWeek': { $in: [appointmentDayOfWeek] },\n              $or: [\n                { 'recurringPattern.endDate': { $exists: false } },\n                { 'recurringPattern.endDate': { $gte: searchDate } }\n              ]\n            }\n          ]\n        };\n        \n        console.log(` Schedule query for ${dentist.firstName} ${dentist.lastName}:`, JSON.stringify(scheduleQuery, null, 2));\n        \n        const schedules = await StaffSchedule.find(scheduleQuery);\n        \n        // Also check all schedules for this dentist to debug\n        const allSchedules = await StaffSchedule.find({ staffId: dentist._id });\n        console.log(` All schedules for ${dentist.firstName} ${dentist.lastName}:`, allSchedules.length);\n        allSchedules.forEach(schedule => {\n          console.log(`   Schedule: isRecurring=${schedule.isRecurring}, daysOfWeek=${schedule.recurringPattern?.daysOfWeek}, status=${schedule.status}`);\n          // Debug: Does this schedule match our day?\n          if (schedule.isRecurring && schedule.recurringPattern?.daysOfWeek) {\n            const includesDay = schedule.recurringPattern.daysOfWeek.includes(appointmentDayOfWeek);\n            console.log(`    Does schedule include day ${appointmentDayOfWeek}? ${includesDay} (array: [${schedule.recurringPattern.daysOfWeek}])`);\n            \n            // DEBUG: Test different query approaches on this specific schedule\n            console.log(`    Testing query approaches:`);\n            console.log(`     - appointmentDayOfWeek type: ${typeof appointmentDayOfWeek} (${appointmentDayOfWeek})`);\n            console.log(`     - daysOfWeek type: ${typeof schedule.recurringPattern.daysOfWeek[0]} (${schedule.recurringPattern.daysOfWeek[0]})`);\n            console.log(`     - Array includes check: ${schedule.recurringPattern.daysOfWeek.includes(appointmentDayOfWeek)}`);\n            console.log(`     - Array includes string: ${(schedule.recurringPattern.daysOfWeek as any[]).includes(appointmentDayOfWeek.toString())}`);\n            console.log(`     - Raw array: ${JSON.stringify(schedule.recurringPattern.daysOfWeek)}`);\n          }\n        });\n        \n        console.log(` Checking ${dentist.firstName} ${dentist.lastName} for ${dayNames[appointmentDayOfWeek]} (day ${appointmentDayOfWeek})`);\n        console.log(`   Found ${schedules.length} schedule records`);\n        \n        if (schedules.length > 0) {\n          console.log(` ${dentist.firstName} ${dentist.lastName} is scheduled for ${dayNames[appointmentDayOfWeek]}`);\n          dentists.push(dentist);\n        } else {\n          console.log(` ${dentist.firstName} ${dentist.lastName} is NOT scheduled for ${dayNames[appointmentDayOfWeek]}`);\n        }\n      }\n      \n      console.log(` Found ${dentists.length} dentists scheduled for ${dayNames[appointmentDayOfWeek]}`);\n      \n      if (dentists.length === 0) {\n        console.log(' No dentists are scheduled to work on this day');\n        return res.status(200).json({\n          status: 'success',\n          data: { availableSlots: [] },\n          message: `No dentists are scheduled to work on ${dayNames[appointmentDayOfWeek]}`\n        });\n      }\n\n      // Get available slots for all dentists and combine them\n      const allSlots = await Promise.all(\n        dentists.map(async (dentist) => {\n          const slots = await Appointment.getAvailableTimeSlots(\n            dentist._id.toString(),\n            searchDate,\n            parseInt(duration as string)\n          );\n          \n          // Add dentist information to each slot\n          return slots.map(slot => ({\n            ...slot,\n            dentistId: dentist._id,\n            dentistName: `${dentist.firstName} ${dentist.lastName}`,\n            dentistSpecialization: dentist.specialization,\n            timeSlot: slot.time // Ensure consistent naming\n          }));\n        })\n      );\n\n      // Combine and deduplicate slots by time (multiple dentists can have same time slot)\n      const slotMap = new Map();\n      allSlots.flat().forEach(slot => {\n        const key = `${slot.timeSlot || slot.time}`;\n        if (!slotMap.has(key)) {\n          slotMap.set(key, []);\n        }\n        slotMap.get(key).push(slot);\n      });\n\n      // Convert to final format - one slot per time with available dentists\n      availableSlots = Array.from(slotMap.entries()).map(([timeSlot, slots]) => ({\n        timeSlot,\n        time: timeSlot, // Backward compatibility\n        isAvailable: true,\n        isPeak: slots[0]?.isPeak || false,\n        availableDentists: slots.map((slot: any) => ({\n          dentistId: slot.dentistId,\n          dentistName: slot.dentistName,\n          dentistSpecialization: slot.dentistSpecialization\n        })),\n        // For backward compatibility, include the first dentist as primary\n        dentistId: slots[0]?.dentistId,\n        dentistName: slots[0]?.dentistName\n      }));\n      \n      console.log(` Generated ${availableSlots.length} time slots with dentist info`);\n    } catch (error) {\n      console.error('Error finding dentists:', error);\n      return res.status(500).json({\n        status: 'error',\n        message: 'Error finding dentists for this clinic'\n      });\n    }\n  }\n\n  return res.status(200).json({\n    status: 'success',\n    data: { availableSlots }\n  });\n});\n\n// Get next available slot after last booked appointment\nexport const getNextSlotAfterLastBooking = catchAsync(async (req: Request, res: Response) => {\n  const { date, clinicId, duration = 60 } = req.query;\n\n  if (!date || !clinicId) {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Date and clinicId are required'\n    });\n  }\n\n  // Validate clinic exists first\n  const clinic = await (Clinic as any).findById(clinicId);\n  if (!clinic) {\n    return res.status(404).json({\n      status: 'error',\n      message: 'Clinic not found'\n    });\n  }\n\n  const searchDate = new Date(date as string);\n  const today = new Date();\n  \n  // Simple timezone-safe date comparison using date strings\n  const searchDateStr = searchDate.toISOString().split('T')[0];\n  const todayDateStr = today.toISOString().split('T')[0];\n  \n  if (searchDateStr < todayDateStr) {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Date cannot be in the past'\n    });\n  }\n\n  try {\n    const nextSlot = await Appointment.getNextSlotAfterLastBooking(\n      clinicId as string,\n      searchDate,\n      parseInt(duration as string)\n    );\n\n    if (!nextSlot) {\n      return res.status(200).json({\n        status: 'success',\n        data: { nextSlot: null },\n        message: 'No available time after last booking or clinic is closed'\n      });\n    }\n\n    return res.status(200).json({\n      status: 'success',\n      data: { nextSlot }\n    });\n  } catch (error) {\n    console.error('Error getting next slot after last booking:', error);\n    return res.status(500).json({\n      status: 'error',\n      message: 'Error finding next available slot'\n    });\n  }\n});\n\n// Get upcoming appointments\nexport const getUpcomingAppointments = catchAsync(async (req: Request, res: Response) => {\n  const { days = 7, clinicId, dentistId } = req.query;\n  const { page, limit, skip } = getPaginationParams(req);\n  \n  const startDate = new Date();\n  const endDate = new Date();\n  endDate.setDate(startDate.getDate() + parseInt(days as string));\n\n  const query: any = {\n    date: { $gte: startDate, $lte: endDate },\n    status: { $in: ['scheduled', 'confirmed'] }\n  };\n\n  if (clinicId) query.clinicId = clinicId;\n  if (dentistId) query.dentistId = dentistId;\n  \n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'name email phone')\n      .populate('dentistId', 'name specialization')\n      .populate('clinicId', 'name address')\n      .sort({ date: 1, timeSlot: 1 })\n      .skip(skip)\n      .limit(limit),\n    (Appointment as any).countDocuments(query)\n  ]);\n\n  return res.status(200).json({\n    status: 'success',\n    data: createPaginatedResponse(appointments, total, page, limit)\n  });\n});\n\n// Get appointments by date range\nexport const getAppointmentsByDateRange = catchAsync(async (req: Request, res: Response) => {\n  const { startDate, endDate, clinicId, dentistId, status } = req.query;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  if (!startDate || !endDate) {\n    return res.status(400).json({\n      status: 'error',\n      message: 'Start date and end date are required'\n    });\n  }\n\n  const query: any = {\n    date: {\n      $gte: new Date(startDate as string),\n      $lte: new Date(endDate as string)\n    }\n  };\n\n  if (clinicId) query.clinicId = clinicId;\n  if (dentistId) query.dentistId = dentistId;\n  if (status) query.status = status;\n  \n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'name email phone')\n      .populate('dentistId', 'name specialization')\n      .populate('clinicId', 'name address')\n      .sort({ date: 1, timeSlot: 1 })\n      .skip(skip)\n      .limit(limit),\n    (Appointment as any).countDocuments(query)\n  ]);\n\n  return res.status(200).json({\n    status: 'success',\n    data: createPaginatedResponse(appointments, total, page, limit)\n  });\n});\n\n// Get appointment statistics\nexport const getAppointmentStatistics = catchAsync(async (req: Request, res: Response) => {\n  const { startDate, endDate, clinicId } = req.query;\n\n  const matchQuery: any = {};\n  \n  if (startDate && endDate) {\n    matchQuery.date = {\n      $gte: new Date(startDate as string),\n      $lte: new Date(endDate as string)\n    };\n  }\n  \n  if (clinicId) {\n    matchQuery.clinicId = clinicId;\n  }\n\n  const statistics = await (Appointment as any).aggregate([\n    { $match: matchQuery },\n    {\n      $group: {\n        _id: '$status',\n        count: { $sum: 1 }\n      }\n    }\n  ]);\n\n  const totalAppointments = await (Appointment as any).countDocuments(matchQuery);\n  \n  const statusCounts = {\n    scheduled: 0,\n    confirmed: 0,\n    'in-progress': 0,\n    completed: 0,\n    cancelled: 0,\n    'no-show': 0\n  };\n\n  statistics.forEach((stat: any) => {\n    if (stat._id in statusCounts) {\n      (statusCounts as any)[stat._id] = stat.count;\n    }\n  });\n\n  res.status(200).json({\n    status: 'success',\n    data: {\n      totalAppointments,\n      statusBreakdown: statusCounts,\n      completionRate: totalAppointments > 0 ? (statusCounts.completed / totalAppointments * 100).toFixed(2) : 0,\n      cancellationRate: totalAppointments > 0 ? (statusCounts.cancelled / totalAppointments * 100).toFixed(2) : 0\n    }\n  });\n});\n\n// Get recent appointments\nexport const getRecentAppointments = catchAsync(async (req: Request, res: Response) => {\n  const { limit = 10, clinicId } = req.query;\n  const { page, limit: pageLimit, skip } = getPaginationParams(req);\n  \n  const query: any = {};\n  if (clinicId) query.clinicId = clinicId;\n  \n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'firstName lastName email phone')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address')\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(parseInt(limit as string) || pageLimit),\n    (Appointment as any).countDocuments(query)\n  ]);\n\n  res.status(200).json({\n    success: true,\n    data: createPaginatedResponse(appointments, total, page, pageLimit),\n    message: 'Recent appointments retrieved successfully'\n  });\n});\n\n// Get recent appointments across all clinics (admin only)\nexport const getRecentAppointmentsOverall = catchAsync(async (req: Request, res: Response) => {\n  const { limit = 10 } = req.query;\n  const { page, limit: pageLimit, skip } = getPaginationParams(req);\n  \n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find({})\n      .populate('patientId', 'firstName lastName email phone')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address')\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(parseInt(limit as string) || pageLimit),\n    (Appointment as any).countDocuments({})\n  ]);\n\n  res.status(200).json({\n    success: true,\n    data: createPaginatedResponse(appointments, total, page, pageLimit),\n    message: 'Overall recent appointments retrieved successfully'\n  });\n});\n\n// Send appointment reminders\nexport const sendAppointmentReminders = catchAsync(async (req: Request, res: Response) => {\n  const { date, clinicId } = req.body;\n  \n  const reminderDate = date ? new Date(date) : new Date();\n  reminderDate.setDate(reminderDate.getDate() + 1); // Tomorrow's appointments\n\n  const query: any = {\n    date: {\n      $gte: new Date(reminderDate.toDateString()),\n      $lt: new Date(reminderDate.getTime() + 24 * 60 * 60 * 1000)\n    },\n    status: { $in: ['scheduled', 'confirmed'] }\n  };\n\n  if (clinicId) query.clinicId = clinicId;\n\n  const appointments = await (Appointment as any).find(query)\n    .populate('patientId', 'name email')\n    .populate('dentistId', 'name')\n    .populate('clinicId', 'name');\n\n  let sentCount = 0;\n  let failedCount = 0;\n\n  for (const appointment of appointments) {\n    try {\n      const patient = appointment.patientId as any;\n      const dentist = appointment.dentistId as any;\n      const clinic = appointment.clinicId as any;\n\n      await sendAppointmentReminderEmail(\n        patient.email,\n        patient.name,\n        {\n          date: new Date(appointment.date).toLocaleDateString(),\n          time: appointment.timeSlot,\n          dentist: dentist.name,\n          clinic: clinic.name\n        }\n      );\n\n      await (Notification as any).create({\n        userId: appointment.patientId,\n        type: 'appointment_reminder',\n        title: 'Appointment Reminder',\n        message: `You have an appointment scheduled for ${new Date(appointment.date).toLocaleDateString()} at ${appointment.timeSlot}`,\n        appointmentId: appointment._id\n      });\n\n      sentCount++;\n    } catch (error) {\n      console.error(`Failed to send reminder for appointment ${appointment._id}:`, error);\n      failedCount++;\n    }\n  }\n\n  res.status(200).json({\n    status: 'success',\n    message: `Sent ${sentCount} reminders successfully. ${failedCount} failed.`,\n    data: {\n      totalAppointments: appointments.length,\n      sentCount,\n      failedCount\n    }\n  });\n});\n\n// Check appointment conflicts (for frontend validation)\n// ==================== UNIFIED APPOINTMENT DASHBOARD ENDPOINTS ====================\n\n// Get unified appointments for doctor across all assigned clinics\nexport const getDoctorUnifiedAppointments = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { startDate, endDate, clinicId, patientName, status, sortBy = 'date', sortOrder = 'asc' } = req.query;\n  const { page: pageNum, limit: limitNum } = getPaginationParams(req);\n  \n  // Build query for doctor's appointments across all assigned clinics\n  const query: any = {\n    dentistId: req.user._id\n  };\n  \n  // Filter by date range\n  if (startDate || endDate) {\n    query.date = {};\n    if (startDate) query.date.$gte = new Date(startDate as string);\n    if (endDate) query.date.$lte = new Date(endDate as string);\n  }\n  \n  // Filter by specific clinic (optional)\n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  // Filter by status\n  if (status) {\n    query.status = status;\n  }\n  \n  // Build sort object\n  const sort: any = {};\n  sort[sortBy as string] = sortOrder === 'desc' ? -1 : 1;\n  \n  // Execute query with pagination\n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'firstName lastName email phone dateOfBirth')\n      .populate('clinicId', 'name address phone')\n      .populate('dentistId', 'firstName lastName email')\n      .sort(sort)\n      .skip((pageNum - 1) * limitNum)\n      .limit(limitNum)\n      .lean(),\n    (Appointment as any).countDocuments(query)\n  ]);\n  \n  // Filter by patient name if provided (post-query filtering for flexibility)\n  let filteredAppointments = appointments;\n  if (patientName) {\n    const searchTerm = (patientName as string).toLowerCase();\n    filteredAppointments = appointments.filter((apt: any) => {\n      const fullName = `${apt.patientId.firstName} ${apt.patientId.lastName}`.toLowerCase();\n      return fullName.includes(searchTerm);\n    });\n  }\n  \n  // Group appointments by clinic for better visualization\n  const appointmentsByClinic = filteredAppointments.reduce((acc: any, apt: any) => {\n    const clinicName = apt.clinicId.name;\n    if (!acc[clinicName]) {\n      acc[clinicName] = {\n        clinic: apt.clinicId,\n        appointments: [],\n        count: 0\n      };\n    }\n    acc[clinicName].appointments.push(apt);\n    acc[clinicName].count++;\n    return acc;\n  }, {});\n  \n  res.json({\n    success: true,\n    message: 'Unified appointments retrieved successfully',\n    data: {\n      appointments: filteredAppointments,\n      appointmentsByClinic,\n      pagination: {\n        total,\n        page: pageNum,\n        limit: limitNum,\n        totalPages: Math.ceil(total / limitNum)\n      },\n      stats: {\n        totalAppointments: filteredAppointments.length,\n        clinicsCount: Object.keys(appointmentsByClinic).length,\n        todayAppointments: filteredAppointments.filter((apt: any) => \n          new Date(apt.date).toDateString() === new Date().toDateString()\n        ).length\n      }\n    }\n  });\n});\n\n// Get unified appointments for admin (all appointments across all clinics)\nexport const getAdminUnifiedAppointments = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { startDate, endDate, clinicId, dentistId, patientName, status, sortBy = 'date', sortOrder = 'asc' } = req.query;\n  const { page: pageNum, limit: limitNum } = getPaginationParams(req);\n  \n  // Build query\n  const query: any = {};\n  \n  // Filter by date range\n  if (startDate || endDate) {\n    query.date = {};\n    if (startDate) query.date.$gte = new Date(startDate as string);\n    if (endDate) query.date.$lte = new Date(endDate as string);\n  }\n  \n  // Filter by clinic\n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  // Filter by dentist\n  if (dentistId) {\n    query.dentistId = dentistId;\n  }\n  \n  // Filter by status\n  if (status) {\n    query.status = status;\n  }\n  \n  // Build sort object\n  const sort: any = {};\n  sort[sortBy as string] = sortOrder === 'desc' ? -1 : 1;\n  \n  // Execute query\n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('patientId', 'firstName lastName email phone dateOfBirth')\n      .populate('clinicId', 'name address phone')\n      .populate('dentistId', 'firstName lastName email specialization')\n      .populate('createdBy', 'firstName lastName')\n      .sort(sort)\n      .skip((pageNum - 1) * limitNum)\n      .limit(limitNum)\n      .lean(),\n    (Appointment as any).countDocuments(query)\n  ]);\n  \n  // Filter by patient name if provided\n  let filteredAppointments = appointments;\n  if (patientName) {\n    const searchTerm = (patientName as string).toLowerCase();\n    filteredAppointments = appointments.filter((apt: any) => {\n      const fullName = `${apt.patientId.firstName} ${apt.patientId.lastName}`.toLowerCase();\n      return fullName.includes(searchTerm);\n    });\n  }\n  \n  // Analytics data\n  const stats = {\n    totalAppointments: filteredAppointments.length,\n    byStatus: filteredAppointments.reduce((acc: any, apt: any) => {\n      acc[apt.status] = (acc[apt.status] || 0) + 1;\n      return acc;\n    }, {}),\n    byClinic: filteredAppointments.reduce((acc: any, apt: any) => {\n      const clinicName = apt.clinicId.name;\n      acc[clinicName] = (acc[clinicName] || 0) + 1;\n      return acc;\n    }, {}),\n    todayCount: filteredAppointments.filter((apt: any) => \n      new Date(apt.date).toDateString() === new Date().toDateString()\n    ).length\n  };\n  \n  res.json({\n    success: true,\n    message: 'Admin unified appointments retrieved successfully',\n    data: {\n      appointments: filteredAppointments,\n      pagination: {\n        total,\n        page: pageNum,\n        limit: limitNum,\n        totalPages: Math.ceil(total / limitNum)\n      },\n      stats\n    }\n  });\n});\n\n// Quick update appointment (time/notes only - lightweight operation)\nexport const quickUpdateAppointment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { timeSlot, notes, duration } = req.body;\n  \n  // Validate appointment ID\n  if (!mongoose.Types.ObjectId.isValid(id)) {\n    throw createValidationError('id', 'Invalid appointment ID');\n  }\n  \n  // Find appointment\n  const appointment = await (Appointment as any).findById(id);\n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n  \n  // Authorization: Doctors can only update their own appointments, admins can update all\n  if (req.user.role !== 'admin' && appointment.dentistId.toString() !== req.user._id.toString()) {\n    return res.status(403).json({\n      success: false,\n      message: 'You can only update your own appointments'\n    });\n  }\n  \n  // Store original values for audit\n  const originalTimeSlot = appointment.timeSlot;\n  const originalNotes = appointment.notes;\n  \n  // Update fields\n  if (timeSlot) {\n    // Validate time slot format\n    if (!isValidTimeSlot(timeSlot)) {\n      throw createValidationError('timeSlot', 'Invalid time slot format. Use HH:MM format');\n    }\n    appointment.timeSlot = timeSlot;\n  }\n  \n  if (notes !== undefined) {\n    appointment.notes = notes;\n  }\n  \n  if (duration) {\n    appointment.duration = duration;\n  }\n  \n  // Add modification history\n  if (!appointment.modificationHistory) {\n    appointment.modificationHistory = [];\n  }\n  \n  appointment.modificationHistory.push({\n    modifiedBy: req.user._id,\n    modifiedAt: new Date(),\n    changes: {\n      timeSlot: { from: originalTimeSlot, to: timeSlot },\n      notes: { from: originalNotes, to: notes }\n    }\n  });\n  \n  appointment.lastModifiedBy = req.user._id;\n  \n  await appointment.save();\n  \n  // Populate for response\n  const updatedAppointment = await (Appointment as any).findById(id)\n    .populate('patientId', 'firstName lastName email phone')\n    .populate('clinicId', 'name address')\n    .populate('dentistId', 'firstName lastName')\n    .populate('lastModifiedBy', 'firstName lastName');\n  \n  res.json({\n    success: true,\n    message: 'Appointment updated successfully',\n    data: { appointment: updatedAppointment }\n  });\n});\n\n// Cancel appointment with automatic notification\nexport const cancelAppointmentWithNotification = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { cancellationReason, notifyPatient = true } = req.body;\n  \n  // Validate appointment ID\n  if (!mongoose.Types.ObjectId.isValid(id)) {\n    throw createValidationError('id', 'Invalid appointment ID');\n  }\n  \n  // Find appointment\n  const appointment = await (Appointment as any).findById(id)\n    .populate('patientId', 'firstName lastName email phone userId')\n    .populate('clinicId', 'name address phone')\n    .populate('dentistId', 'firstName lastName');\n  \n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n  \n  // Authorization check\n  if (req.user.role !== 'admin' && appointment.dentistId._id.toString() !== req.user._id.toString()) {\n    return res.status(403).json({\n      success: false,\n      message: 'You can only cancel your own appointments'\n    });\n  }\n  \n  // Check if already cancelled\n  if (appointment.status === 'cancelled') {\n    return res.status(400).json({\n      success: false,\n      message: 'Appointment is already cancelled'\n    });\n  }\n  \n  // Update appointment\n  appointment.status = 'cancelled';\n  appointment.cancellationReason = cancellationReason || 'Cancelled by staff';\n  appointment.lastModifiedBy = req.user._id;\n  \n  // Add to modification history\n  if (!appointment.modificationHistory) {\n    appointment.modificationHistory = [];\n  }\n  \n  appointment.modificationHistory.push({\n    modifiedBy: req.user._id,\n    modifiedAt: new Date(),\n    changes: {\n      status: { from: appointment.status, to: 'cancelled' },\n      cancellationReason: cancellationReason\n    }\n  });\n  \n  await appointment.save();\n  \n  // Send notifications if requested\n  const notifications = {\n    email: false,\n    sms: false,\n    inApp: false\n  };\n  \n  if (notifyPatient) {\n    const patient = appointment.patientId;\n    const clinic = appointment.clinicId;\n    const dentist = appointment.dentistId;\n    \n    // Send email notification\n    if (patient.email) {\n      try {\n        await sendAppointmentCancellationEmail(\n          patient.email,\n          `${patient.firstName} ${patient.lastName}`,\n          {\n            date: new Date(appointment.date).toLocaleDateString(),\n            time: appointment.timeSlot,\n            reason: cancellationReason || 'Cancelled by clinic'\n          }\n        );\n        notifications.email = true;\n      } catch (error) {\n        console.error('Failed to send cancellation email:', error);\n      }\n    }\n    \n    // Send SMS notification\n    if (patient.phone) {\n      try {\n        await sendAppointmentCancellationSMS(\n          patient.phone,\n          `${patient.firstName} ${patient.lastName}`,\n          {\n            date: new Date(appointment.date).toLocaleDateString(),\n            time: appointment.timeSlot,\n            clinic: clinic.name\n          }\n        );\n        notifications.sms = true;\n      } catch (error) {\n        console.error('Failed to send cancellation SMS:', error);\n      }\n    }\n    \n    // Create in-app notification\n    if (patient.userId) {\n      try {\n        await (Notification as any).create({\n          userId: patient.userId,\n          type: 'appointment_cancellation',\n          title: 'Appointment Cancelled',\n          message: `Your appointment on ${new Date(appointment.date).toLocaleDateString()} at ${appointment.timeSlot} has been cancelled. Reason: ${cancellationReason || 'Cancelled by clinic'}`,\n          link: `/appointments/${appointment._id}`,\n          metadata: {\n            appointmentId: appointment._id,\n            clinicId: clinic._id,\n            reason: cancellationReason\n          }\n        });\n        notifications.inApp = true;\n      } catch (error) {\n        console.error('Failed to create in-app notification:', error);\n      }\n    }\n    \n    // Cancel any scheduled reminders\n    try {\n      await cancelAppointmentReminders(appointment);\n    } catch (error) {\n      console.error('Failed to cancel appointment reminders:', error);\n    }\n  }\n  \n  res.json({\n    success: true,\n    message: 'Appointment cancelled successfully',\n    data: {\n      appointment,\n      notificationsSent: notifications\n    }\n  });\n});\n\n// Reschedule appointment with conflict checking\nexport const rescheduleAppointmentEnhanced = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { newDate, newTimeSlot, newDuration = 60, reason } = req.body;\n  \n  // Validate appointment ID\n  if (!mongoose.Types.ObjectId.isValid(id)) {\n    throw createValidationError('id', 'Invalid appointment ID');\n  }\n  \n  // Validate required fields\n  if (!newDate || !newTimeSlot) {\n    throw createValidationError('newDate/newTimeSlot', 'New date and time slot are required');\n  }\n  \n  // Find appointment\n  const appointment = await (Appointment as any).findById(id)\n    .populate('patientId', 'firstName lastName email phone userId')\n    .populate('clinicId', 'name address phone operatingHours')\n    .populate('dentistId', 'firstName lastName');\n  \n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n  \n  // Authorization check\n  if (req.user.role !== 'admin' && appointment.dentistId._id.toString() !== req.user._id.toString()) {\n    return res.status(403).json({\n      success: false,\n      message: 'You can only reschedule your own appointments'\n    });\n  }\n  \n  // Store original values\n  const originalDate = appointment.date;\n  const originalTimeSlot = appointment.timeSlot;\n  \n  // Validate new date is not in the past\n  const appointmentDate = new Date(newDate);\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  \n  if (appointmentDate < today) {\n    throw createValidationError('newDate', 'Cannot reschedule to a past date');\n  }\n  \n  // Check for conflicts\n  const conflicts = await (Appointment as any).find({\n    _id: { $ne: id },\n    dentistId: appointment.dentistId._id,\n    clinicId: appointment.clinicId._id,\n    date: appointmentDate,\n    status: { $in: ['scheduled', 'confirmed'] }\n  });\n  \n  // Check if new time slot conflicts with existing appointments\n  const hasConflict = conflicts.some((existingApt: any) => {\n    const [existingHour, existingMin] = existingApt.timeSlot.split(':').map(Number);\n    const [newHour, newMin] = newTimeSlot.split(':').map(Number);\n    \n    const existingStart = existingHour * 60 + existingMin;\n    const existingEnd = existingStart + existingApt.duration;\n    const newStart = newHour * 60 + newMin;\n    const newEnd = newStart + newDuration;\n    \n    return (newStart < existingEnd && newEnd > existingStart);\n  });\n  \n  if (hasConflict) {\n    throw createConflictError('The new time slot conflicts with an existing appointment');\n  }\n  \n  // Update appointment\n  appointment.date = appointmentDate;\n  appointment.timeSlot = newTimeSlot;\n  appointment.duration = newDuration;\n  appointment.lastModifiedBy = req.user._id;\n  \n  // Add to modification history\n  if (!appointment.modificationHistory) {\n    appointment.modificationHistory = [];\n  }\n  \n  appointment.modificationHistory.push({\n    modifiedBy: req.user._id,\n    modifiedAt: new Date(),\n    changes: {\n      date: { from: originalDate, to: newDate },\n      timeSlot: { from: originalTimeSlot, to: newTimeSlot },\n      reason: reason || 'Rescheduled'\n    }\n  });\n  \n  await appointment.save();\n  \n  // Send notification to patient\n  const patient = appointment.patientId;\n  const clinic = appointment.clinicId;\n  const dentist = appointment.dentistId;\n  \n  const notifications = {\n    email: false,\n    sms: false,\n    inApp: false\n  };\n  \n  // Email notification\n  if (patient.email) {\n    try {\n      await sendAppointmentConfirmationEmail(\n        patient.email,\n        `${patient.firstName} ${patient.lastName}`,\n        {\n          date: appointmentDate.toLocaleDateString(),\n          time: newTimeSlot,\n          dentist: `Dr. ${dentist.firstName} ${dentist.lastName}`,\n          clinic: clinic.name,\n          service: appointment.serviceType\n        }\n      );\n      notifications.email = true;\n    } catch (error) {\n      console.error('Failed to send rescheduling email:', error);\n    }\n  }\n  \n  // In-app notification\n  if (patient.userId) {\n    try {\n      await (Notification as any).create({\n        userId: patient.userId,\n        type: 'appointment_confirmation',\n        title: 'Appointment Rescheduled',\n        message: `Your appointment has been rescheduled to ${appointmentDate.toLocaleDateString()} at ${newTimeSlot}`,\n        link: `/appointments/${appointment._id}`,\n        metadata: {\n          appointmentId: appointment._id,\n          clinicId: clinic._id,\n          oldDate: originalDate,\n          newDate: appointmentDate\n        }\n      });\n      notifications.inApp = true;\n    } catch (error) {\n      console.error('Failed to create in-app notification:', error);\n    }\n  }\n  \n  // Reschedule reminders\n  try {\n    await cancelAppointmentReminders(appointment);\n    await scheduleAppointmentReminders(appointment, patient, dentist, clinic);\n  } catch (error) {\n    console.error('Failed to reschedule appointment reminders:', error);\n  }\n  \n  res.json({\n    success: true,\n    message: 'Appointment rescheduled successfully',\n    data: {\n      appointment,\n      notificationsSent: notifications\n    }\n  });\n});\n\n// ==================== END UNIFIED DASHBOARD ENDPOINTS ====================\n\nexport const checkAppointmentConflicts = catchAsync(async (req: Request, res: Response) => {\n  const { date, timeSlot, dentistId, clinicId, excludeAppointmentId, duration = 60 } = req.query;\n\n  // Validate required parameters\n  if (!date || !timeSlot || !clinicId) {\n    return res.status(400).json({\n      success: false,\n      message: 'Date, timeSlot, and clinicId are required'\n    });\n  }\n\n  try {\n    const appointmentDate = new Date(date as string);\n    let effectiveDentistId = dentistId as string;\n\n    // If no dentistId provided, check for conflicts across all dentists in the clinic\n    if (!effectiveDentistId) {\n      // First validate the clinic exists\n      const clinic = await (Clinic as any).findById(clinicId);\n      if (!clinic) {\n        return res.status(404).json({\n          success: false,\n          message: 'Clinic not found'\n        });\n      }\n\n      const dentists = await User.find({ \n        role: 'dentist', \n        isActive: true,  // Use isActive instead of status\n        assignedClinics: { $in: [clinicId] }\n      });\n      \n      if (dentists.length === 0) {\n        // No dentists in clinic - this indicates a configuration issue\n        console.warn(` No dentists assigned to clinic ${clinicId} during conflict check`);\n        return res.status(200).json({\n          success: true,\n          hasConflict: false,\n          conflicts: [],\n          message: `No dentists are assigned to clinic \"${clinic.name}\". Please contact administration to assign dentists.`,\n          error: 'NO_DENTISTS_ASSIGNED',\n          clinicInfo: {\n            id: clinic._id,\n            name: clinic.name\n          }\n        });\n      }\n      \n      // Check conflicts for all dentists and return the most relevant ones\n      const allConflicts = await Promise.all(\n        dentists.map(dentist =>\n          (Appointment as any).findConflicts(\n            dentist._id.toString(),\n            appointmentDate,\n            timeSlot as string,\n            parseInt(duration as string) || 60,\n            excludeAppointmentId as string\n          )\n        )\n      );\n      \n      const conflicts = allConflicts.flat();\n      \n      return res.status(200).json({\n        success: true,\n        hasConflict: conflicts.length > 0,\n        conflicts: conflicts.map(conflict => ({\n          id: conflict._id,\n          patientName: conflict.patientId && typeof conflict.patientId === 'object' && 'firstName' in conflict.patientId\n            ? `${(conflict.patientId as any).firstName} ${(conflict.patientId as any).lastName}`\n            : 'Unknown Patient',\n          timeSlot: conflict.timeSlot,\n          date: conflict.date,\n          duration: conflict.duration\n        })),\n        message: conflicts.length > 0 ? 'Conflicts found across all dentists' : 'No conflicts found'\n      });\n    }\n\n    // Check for conflicts with the specific dentist\n    const conflicts = await (Appointment as any).findConflicts(\n      effectiveDentistId,\n      appointmentDate,\n      timeSlot as string,\n      parseInt(duration as string) || 60,\n      excludeAppointmentId as string\n    );\n\n    // Populate patient data for conflicts\n    const populatedConflicts = await (Appointment as any).populate(conflicts, [\n      { path: 'patientId', select: 'firstName lastName' }\n    ]);\n\n    return res.status(200).json({\n      success: true,\n      hasConflict: conflicts.length > 0,\n      conflicts: populatedConflicts.map(conflict => ({\n        id: conflict._id,\n        patientName: conflict.patientId && typeof conflict.patientId === 'object' && 'firstName' in conflict.patientId\n          ? `${(conflict.patientId as any).firstName} ${(conflict.patientId as any).lastName}`\n          : 'Unknown Patient',\n        timeSlot: conflict.timeSlot,\n        date: conflict.date,\n        duration: conflict.duration\n      }))\n    });\n  } catch (error: any) {\n    console.error('Error checking appointment conflicts:', error);\n    return res.status(500).json({\n      success: false,\n      message: 'Failed to check appointment conflicts',\n      error: error.message\n    });\n  }\n});\n\n// @desc    Get booked time slots for a specific date and clinic/doctor\n// @route   GET /api/v1/appointments/booked-slots\n// @access  Public (to allow patients to see availability)\nexport const getBookedSlots = catchAsync(async (req: Request, res: Response) => {\n  const { date, clinicId, doctorId } = req.query;\n\n  // Validate required parameters\n  if (!date || !clinicId) {\n    throw createValidationError('date/clinicId', 'Date and clinic ID are required');\n  }\n\n  // Validate date format\n  const dateRegex = /^\\d{4}-\\d{2}-\\d{2}$/;\n  if (!dateRegex.test(date as string)) {\n    throw createValidationError('date', 'Date must be in YYYY-MM-DD format');\n  }\n\n  // Validate clinic ID\n  if (!mongoose.Types.ObjectId.isValid(clinicId as string)) {\n    throw createValidationError('clinicId', 'Invalid clinic ID');\n  }\n\n  // Build query\n  const query: any = {\n    clinicId,\n    date: new Date(date as string),\n    status: { $in: ['scheduled', 'confirmed'] } // Only count scheduled/confirmed appointments\n  };\n\n  // Optionally filter by doctor\n  if (doctorId) {\n    if (!mongoose.Types.ObjectId.isValid(doctorId as string)) {\n      throw createValidationError('doctorId', 'Invalid doctor ID');\n    }\n    query.dentistId = doctorId;\n  }\n\n  // Find all booked appointments for this date/clinic/doctor\n  const bookedAppointments = await Appointment.find(query)\n    .select('timeSlot duration')\n    .lean();\n\n  // Extract booked time slots (just the start times)\n  const bookedSlots = bookedAppointments.map(apt => apt.timeSlot);\n\n  // Return unique booked slots\n  const uniqueBookedSlots = [...new Set(bookedSlots)];\n\n  res.status(200).json({\n    success: true,\n    data: {\n      date: date as string,\n      clinicId: clinicId as string,\n      doctorId: doctorId as string || null,\n      bookedSlots: uniqueBookedSlots,\n      count: uniqueBookedSlots.length\n    }\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\authController.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1571,1574],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1571,1574],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1594,1597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1594,1597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1819,1822],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1819,1822],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3317,3320],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3317,3320],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3458,3461],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3458,3461],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4292,4295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4292,4295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":179,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5323,5326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5323,5326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":214,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6683,6686],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6683,6686],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":227,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6923,6926],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6923,6926],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":347,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10393,10396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10393,10396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":353,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":353,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { User } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  generateToken,\n  generateRefreshToken,\n  hashPassword,\n  comparePassword,\n  generateResetToken,\n  hashResetToken,\n  createTokenResponse,\n  verifyRefreshToken,\n  validatePasswordStrength\n} from '../utils/auth';\nimport {\n  sendWelcomeEmail,\n  sendPasswordResetEmail\n} from '../utils/email';\nimport {\n  AppError,\n  catchAsync,\n  createValidationError,\n  createUnauthorizedError,\n  createNotFoundError\n} from '../middleware/errorHandler';\n\n// Register new user\nexport const register = catchAsync(async (req: Request, res: Response) => {\n  const {\n    firstName,\n    lastName,\n    email,\n    password,\n    phone,\n    role = 'patient',\n    dateOfBirth,\n    gender,\n    address\n  } = req.body;\n\n  // Check if user already exists\n  const existingUser = await User.findOne({ email: email.toLowerCase() });\n  if (existingUser) {\n    throw new AppError('User with this email already exists', 400);\n  }\n\n  // Validate password strength\n  const passwordValidation = validatePasswordStrength(password);\n  if (!passwordValidation.isValid) {\n    throw createValidationError('password', passwordValidation.errors.join(', '));\n  }\n\n  // Create user (password will be hashed by pre-save middleware)\n  const user = await User.create({\n    firstName,\n    lastName,\n    email: email.toLowerCase(),\n    password,\n    phone,\n    role,\n    dateOfBirth,\n    gender,\n    address\n  });\n\n  // Send welcome email\n  try {\n    await sendWelcomeEmail(user.email as any, user.firstName as any);\n  } catch (emailError) {\n    console.error('Failed to send welcome email:', emailError);\n    // Don't fail registration if email fails\n  }\n\n  // Create token response\n  const tokenResponse = createTokenResponse(user as any);\n\n  res.status(201).json({\n    success: true,\n    message: 'User registered successfully',\n    data: tokenResponse\n  });\n});\n\n// Login user\nexport const login = async (req: Request, res: Response) => {\n  const { email, password } = req.body;\n  if (!email || !password) {\n    throw createValidationError('credentials', 'Email and password are required');\n  }\n\n  // Find user and include password for comparison\n  try{\n    // console.log(email, password);\n    const user = await User.findOne({ email: email.toLowerCase() }).select('+password');\n    // console.log(user);\n    \n    if (!user) {\n      throw createUnauthorizedError('#1-Invalid email or password. Please check your credentials and try again.');\n    }\n\n    // Check if user is active\n    if (!user.isActive) {\n      throw createUnauthorizedError('#2-Your account has been deactivated. Please contact support for assistance.');\n    }\n\n    // Compare password\n    if (!user.password || typeof user.password !== 'string') {\n      throw createUnauthorizedError('#3-Invalid email or password. Please check your credentials and try again.');\n    }\n    const isPasswordValid = await comparePassword(password, user.password);\n    if (!isPasswordValid) {\n      throw createUnauthorizedError('#4-Invalid email or password. Please check your credentials and try again.');\n    }\n\n    // Update last login\n    user.lastLogin = new Date();\n    await user.save();\n\n    // Create token response\n    const tokenResponse = createTokenResponse(user as any);\n\n    res.json({\n      success: true,\n      message: 'Login successful. Welcome back!',\n      data: tokenResponse\n    });\n} catch (err: any) {\n  // Ensure we always respond on error to avoid hanging requests\n  const statusCode = typeof err?.statusCode === 'number' ? err.statusCode : 401;\n  const message = typeof err?.message === 'string' && err.message.length > 0\n    ? err.message\n    : 'Login failed. Please check your credentials and try again.';\n  return res.status(statusCode).json({ success: false, message });\n}\n};\n\n// Refresh token\nexport const refreshToken = catchAsync(async (req: Request, res: Response) => {\n  const { refreshToken } = req.body;\n\n  if (!refreshToken) {\n    throw createUnauthorizedError('Refresh token is required');\n  }\n\n  try {\n    const decoded = verifyRefreshToken(refreshToken);\n    const user = await User.findById(decoded.id)\n      .populate('assignedClinics', 'name address')\n      .populate('preferredClinicId', 'name address') as any;\n\n    if (!user || !user.isActive) {\n      throw createUnauthorizedError('Invalid or expired refresh token. Please log in again.');\n    }\n\n    // Check if the refresh token is still valid (not expired)\n    const currentTime = Math.floor(Date.now() / 1000);\n    if (decoded.exp && decoded.exp < currentTime) {\n      throw createUnauthorizedError('Refresh token has expired. Please log in again.');\n    }\n\n    // Update last login time\n    user.lastLogin = new Date();\n    await user.save();\n\n    // Generate new tokens (token rotation for security - this invalidates the old ones)\n    const newToken = generateToken(user._id.toString());\n    const newRefreshToken = generateRefreshToken(user._id.toString());\n\n    res.json({\n      success: true,\n      message: 'Authentication tokens refreshed successfully',\n      data: {\n        token: newToken,\n        refreshToken: newRefreshToken,\n        user: {\n          id: user._id,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          fullName: (user as any).fullName,\n          email: user.email,\n          phone: user.phone,\n          role: user.role,\n          profileImage: user.profileImage,\n          dateOfBirth: user.dateOfBirth,\n          gender: user.gender,\n          address: user.address,\n          assignedClinics: user.assignedClinics,\n          preferredClinicId: user.preferredClinicId,\n          specialization: user.specialization,\n          licenseNumber: user.licenseNumber,\n          bio: user.bio,\n          twoFactorEnabled: user.twoFactorEnabled,\n          lastLogin: user.lastLogin,\n          createdAt: user.createdAt,\n          updatedAt: user.updatedAt\n        }\n      }\n    });\n  } catch (error) {\n    if (error instanceof Error && error.name === 'JsonWebTokenError') {\n      throw createUnauthorizedError('Invalid refresh token. Please log in again.');\n    }\n    if (error instanceof Error && error.name === 'TokenExpiredError') {\n      throw createUnauthorizedError('Refresh token has expired. Please log in again.');\n    }\n    throw createUnauthorizedError('Authentication failed. Please log in again.');\n  }\n});\n\n// Get current user\nexport const getCurrentUser = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const user = await User.findById(req.user._id)\n    .populate('assignedClinics', 'name address')\n    .populate('preferredClinicId', 'name address') as any;\n\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  res.json({\n    success: true,\n    data: {\n      user: {\n        id: user._id,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        fullName: (user as any).fullName,\n        email: user.email,\n        phone: user.phone,\n        role: user.role,\n        profileImage: user.profileImage,\n        dateOfBirth: user.dateOfBirth,\n        gender: user.gender,\n        address: user.address,\n        assignedClinics: user.assignedClinics,\n        preferredClinicId: user.preferredClinicId,\n        specialization: user.specialization,\n        licenseNumber: user.licenseNumber,\n        bio: user.bio,\n        twoFactorEnabled: user.twoFactorEnabled,\n        createdAt: user.createdAt,\n        updatedAt: user.updatedAt\n      }\n    }\n  });\n});\n\n// Update profile\nexport const updateProfile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    firstName,\n    lastName,\n    phone,\n    dateOfBirth,\n    gender,\n    address,\n    specialization,\n    licenseNumber,\n    bio\n  } = req.body;\n\n  const user = await User.findById(req.user._id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Update allowed fields\n  if (firstName) user.firstName = firstName;\n  if (lastName) user.lastName = lastName;\n  if (phone) user.phone = phone;\n  if (dateOfBirth) user.dateOfBirth = dateOfBirth;\n  if (gender) user.gender = gender;\n  if (address) user.address = address;\n  if (specialization && user.role === 'dentist') user.specialization = specialization;\n  if (licenseNumber && user.role === 'dentist') user.licenseNumber = licenseNumber;\n  if (bio) user.bio = bio;\n\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Profile updated successfully',\n    data: { user }\n  });\n});\n\n// Change password\nexport const changePassword = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { currentPassword, newPassword } = req.body;\n\n  // Get user with password\n  const user = await User.findById(req.user._id).select('+password');\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Verify current password\n  if (!user.password || typeof user.password !== 'string') {\n    throw createUnauthorizedError('Current password is incorrect');\n  }\n  const isCurrentPasswordValid = await comparePassword(currentPassword, user.password);\n  if (!isCurrentPasswordValid) {\n    throw createUnauthorizedError('Current password is incorrect');\n  }\n\n  // Validate new password strength\n  const passwordValidation = validatePasswordStrength(newPassword);\n  if (!passwordValidation.isValid) {\n    throw createValidationError('newPassword', passwordValidation.errors.join(', '));\n  }\n\n  // Hash and save new password\n  user.password = await hashPassword(newPassword);\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Password changed successfully'\n  });\n});\n\n// Request password reset\nexport const requestPasswordReset = catchAsync(async (req: Request, res: Response) => {\n  const { email } = req.body;\n\n  const user = await User.findOne({ email: email.toLowerCase() });\n  if (!user) {\n    // Don't reveal if user exists or not\n    res.json({\n      success: true,\n      message: 'If an account with that email exists, a password reset link has been sent.'\n    });\n    return;\n  }\n\n  // Generate reset token\n  const resetToken = generateResetToken();\n  const hashedToken = hashResetToken(resetToken);\n\n  // Save reset token and expiry\n  user.passwordResetToken = hashedToken;\n  user.passwordResetExpires = new Date(Date.now() + 10 * 60 * 1000); // 10 minutes\n  await user.save();\n\n  try {\n    // Send reset email\n    await sendPasswordResetEmail(user.email as any, resetToken);\n    \n    res.json({\n      success: true,\n      message: 'Password reset link sent to your email'\n    });\n  } catch (error) {\n    // Clear reset token if email fails\n    user.passwordResetToken = undefined;\n    user.passwordResetExpires = undefined;\n    await user.save();\n\n    throw new AppError('Failed to send password reset email. Please try again.', 500);\n  }\n});\n\n// Reset password\nexport const resetPassword = catchAsync(async (req: Request, res: Response) => {\n  const { token, newPassword } = req.body;\n\n  if (!token || !newPassword) {\n    throw createValidationError('token', 'Token and new password are required');\n  }\n\n  // Hash the token to compare with stored hash\n  const hashedToken = hashResetToken(token);\n\n  // Find user with valid reset token\n  const user = await User.findOne({\n    passwordResetToken: hashedToken,\n    passwordResetExpires: { $gt: new Date() }\n  });\n\n  if (!user) {\n    throw createUnauthorizedError('Invalid or expired reset token');\n  }\n\n  // Validate new password strength\n  const passwordValidation = validatePasswordStrength(newPassword);\n  if (!passwordValidation.isValid) {\n    throw createValidationError('newPassword', passwordValidation.errors.join(', '));\n  }\n\n  // Update password and clear reset token\n  user.password = await hashPassword(newPassword);\n  user.passwordResetToken = undefined;\n  user.passwordResetExpires = undefined;\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Password reset successfully'\n  });\n});\n\n// Logout (enhanced with security logging)\nexport const logout = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  // In a stateless JWT system, logout is typically handled client-side\n  // by removing the token from storage. We log the logout event for security.\n  \n  const user = await User.findById(req.user._id);\n  if (user) {\n    // Update last activity for security monitoring\n    user.lastLogin = new Date();\n    await user.save();\n  }\n  \n  res.json({\n    success: true,\n    message: 'Logged out successfully. Please clear your tokens on the client side.'\n  });\n});\n\n// Validate token (lightweight check)\nexport const validateToken = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  // If we reach here, the token is valid (middleware already validated it)\n  res.json({\n    success: true,\n    message: 'Token is valid',\n    data: {\n      userId: req.user._id,\n      isValid: true\n    }\n  });\n});\n\n// Deactivate account\nexport const deactivateAccount = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const user = await User.findById(req.user._id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  user.isActive = false;\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Account deactivated successfully'\n  });\n});\n\n// Reactivate account (admin only)\nexport const reactivateAccount = catchAsync(async (req: Request, res: Response) => {\n  const { userId } = req.params;\n\n  const user = await User.findById(userId);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  user.isActive = true;\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Account reactivated successfully'\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\billingController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":10,"column":99,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":103},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":13,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":13,"endColumn":17,"fix":{"range":[580,616],"text":"const query: any = { isActive: true };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[591,594],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[591,594],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[974,977],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[974,977],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1354,1357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1354,1357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1897,1900],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1897,1900],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3182,3185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3182,3185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3420,3423],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3420,3423],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3629,3632],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3629,3632],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3990,3993],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3990,3993],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4070,4073],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4070,4073],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4744,4747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4744,4747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":144,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5143,5146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5143,5146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5851,5854],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5851,5854],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6853,6856],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6853,6856],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6962,6965],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6962,6965],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":221,"column":103,"nodeType":null,"messageId":"unusedVar","endLine":221,"endColumn":107},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7912,7915],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7912,7915],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":249,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":249,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8479,8482],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8479,8482],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":293,"column":96,"nodeType":null,"messageId":"unusedVar","endLine":293,"endColumn":100},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":294,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":294,"endColumn":17,"fix":{"range":[10040,10076],"text":"const query: any = { isActive: true };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":294,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10051,10054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10051,10054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":302,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":302,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10328,10331],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10328,10331],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":303,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10372,10375],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10372,10375],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":304,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":304,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10449,10452],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10449,10452],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":305,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10526,10529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10526,10529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":21,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\nimport { Billing, Patient, Appointment } from '../models';\nimport { asyncHandler } from '../utils/asyncHandler';\nimport { AppError } from '../utils/AppError';\nimport { AuthenticatedRequest } from '../types';\n\n// @desc    Get all billing records\n// @route   GET /api/billing\n// @access  Private (Dentist, Staff, Admin)\nexport const getAllBillingRecords = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { page = 1, limit = 10, status, patientId, clinicId } = req.query;\n  \n  let query: any = { isActive: true };\n  \n  // If user is a dentist, only show their billing records\n  if (req.user.role === 'dentist') {\n    query.dentistId = req.user._id;\n  }\n  \n  if (status) {\n    query.paymentStatus = status;\n  }\n  \n  if (patientId) {\n    query.patientId = patientId;\n  }\n  \n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  const billingRecords = await (Billing as any).find(query)\n    .populate('patientId', 'firstName lastName email phone')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name address')\n    .populate('appointmentId', 'appointmentDate appointmentTime')\n    .sort({ createdAt: -1 })\n    .limit(Number(limit) * 1)\n    .skip((Number(page) - 1) * Number(limit));\n    \n  const total = await (Billing as any).countDocuments(query);\n  \n  return res.status(200).json({\n    success: true,\n    data: {\n      billingRecords,\n      totalPages: Math.ceil(total / Number(limit)),\n      currentPage: Number(page),\n      totalRecords: total\n    }\n  });\n});\n\n// @desc    Get billing record by ID\n// @route   GET /api/billing/:id\n// @access  Private (Dentist, Staff, Admin, Patient - own only)\nexport const getBillingRecordById = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const billingRecord = await (Billing as any).findById(req.params.id)\n    .populate('patientId', 'firstName lastName email phone address')\n    .populate('dentistId', 'firstName lastName specialization licenseNumber')\n    .populate('clinicId', 'name address phone email')\n    .populate('appointmentId', 'appointmentDate appointmentTime procedure')\n    .populate('treatmentRecordId', 'procedure diagnosis');\n  \n  if (!billingRecord) {\n    return next(new AppError('Billing record not found', 404));\n  }\n  \n  // Check if patient is accessing their own billing record\n  if (req.user.role === 'patient' && billingRecord.patientId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  // Check if dentist is accessing their own billing record\n  if (req.user.role === 'dentist' && billingRecord.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    data: billingRecord\n  });\n});\n\n// @desc    Create new billing record\n// @route   POST /api/billing\n// @access  Private (Dentist, Staff)\nexport const createBillingRecord = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  // Verify patient exists\n  const patient = await (Patient as any).findById(req.body.patientId);\n  if (!patient) {\n    return next(new AppError('Patient not found', 404));\n  }\n  \n  // Verify appointment exists if provided\n  if (req.body.appointmentId) {\n    const appointment = await (Appointment as any).findById(req.body.appointmentId);\n    if (!appointment) {\n      return next(new AppError('Appointment not found', 404));\n    }\n  }\n  \n  // Generate invoice number\n  const invoiceCount = await (Billing as any).countDocuments();\n  const invoiceNumber = `INV-${Date.now()}-${(invoiceCount + 1).toString().padStart(4, '0')}`;\n  \n  const billingData = {\n    ...req.body,\n    dentistId: req.user._id,\n    invoiceNumber,\n    dueDate: req.body.dueDate || new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 days from now\n  };\n  \n  const billingRecord = await (Billing as any).create(billingData);\n  \n  const populatedBillingRecord = await (Billing as any).findById(billingRecord._id)\n    .populate('patientId', 'firstName lastName email')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .populate('appointmentId', 'appointmentDate appointmentTime');\n  \n  return res.status(201).json({\n    success: true,\n    data: populatedBillingRecord,\n    message: 'Billing record created successfully'\n  });\n});\n\n// @desc    Update billing record\n// @route   PUT /api/billing/:id\n// @access  Private (Dentist - own only, Staff, Admin)\nexport const updateBillingRecord = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const billingRecord = await (Billing as any).findById(req.params.id);\n  \n  if (!billingRecord) {\n    return next(new AppError('Billing record not found', 404));\n  }\n  \n  // Check if dentist is updating their own billing record\n  if (req.user.role === 'dentist' && billingRecord.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  const updatedBillingRecord = await (Billing as any).findByIdAndUpdate(\n    req.params.id,\n    req.body,\n    { new: true, runValidators: true }\n  ).populate('patientId', 'firstName lastName email')\n   .populate('dentistId', 'firstName lastName')\n   .populate('clinicId', 'name')\n   .populate('appointmentId', 'appointmentDate appointmentTime');\n  \n  return res.status(200).json({\n    success: true,\n    data: updatedBillingRecord,\n    message: 'Billing record updated successfully'\n  });\n});\n\n// @desc    Delete billing record (soft delete)\n// @route   DELETE /api/billing/:id\n// @access  Private (Admin)\nexport const deleteBillingRecord = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const billingRecord = await (Billing as any).findByIdAndUpdate(\n    req.params.id,\n    { isActive: false },\n    { new: true }\n  );\n  \n  if (!billingRecord) {\n    return next(new AppError('Billing record not found', 404));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    message: 'Billing record deleted successfully'\n  });\n});\n\n// @desc    Get billing records by patient\n// @route   GET /api/billing/patient/:patientId\n// @access  Private (Dentist, Staff, Admin, Patient - own only)\nexport const getBillingRecordsByPatient = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { patientId } = req.params;\n  const { page = 1, limit = 10, status } = req.query;\n  \n  // Check if patient is accessing their own billing records\n  if (req.user.role === 'patient' && patientId !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  const skip = (Number(page) - 1) * Number(limit);\n  \n  const [billingRecords, total] = await Promise.all([\n    (Billing as any).findByPatient(patientId, {\n      status,\n      limit: Number(limit),\n      skip\n    }),\n    (Billing as any).countDocuments({\n      patientId,\n      isActive: true,\n      ...(status && { paymentStatus: status })\n    })\n  ]);\n  \n  return res.status(200).json({\n    success: true,\n    data: {\n      billingRecords,\n      totalPages: Math.ceil(total / Number(limit)),\n      currentPage: Number(page),\n      totalRecords: total\n    }\n  });\n});\n\n// @desc    Get overdue billing records\n// @route   GET /api/billing/overdue\n// @access  Private (Dentist, Staff, Admin)\nexport const getOverdueBillingRecords = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { clinicId } = req.query;\n  \n  let filterClinicId = clinicId as string;\n  \n  // If user is a dentist, filter by their assigned clinics\n  if (req.user.role === 'dentist' && req.user.assignedClinics && req.user.assignedClinics.length > 0) {\n    filterClinicId = req.user.assignedClinics[0].toString();\n  }\n  \n  const overdueBillingRecords = await (Billing as any).findOverdue(filterClinicId);\n  \n  return res.status(200).json({\n    success: true,\n    data: overdueBillingRecords\n  });\n});\n\n// @desc    Add payment to billing record\n// @route   POST /api/billing/:id/payment\n// @access  Private (Dentist, Staff, Admin)\nexport const addPayment = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { amount, method } = req.body;\n  \n  if (!amount || amount <= 0) {\n    return next(new AppError('Valid payment amount is required', 400));\n  }\n  \n  const billingRecord = await (Billing as any).findById(req.params.id);\n  \n  if (!billingRecord) {\n    return next(new AppError('Billing record not found', 404));\n  }\n  \n  // Check if dentist is adding payment to their own billing record\n  if (req.user.role === 'dentist' && billingRecord.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  const updatedBillingRecord = await billingRecord.addPayment(amount, method);\n  \n  return res.status(200).json({\n    success: true,\n    data: updatedBillingRecord,\n    message: 'Payment added successfully'\n  });\n});\n\n// @desc    Get revenue statistics\n// @route   GET /api/billing/stats/revenue\n// @access  Private (Dentist, Staff, Admin)\nexport const getRevenueStats = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { clinicId, startDate, endDate } = req.query;\n  \n  if (!clinicId) {\n    return next(new AppError('Clinic ID is required', 400));\n  }\n  \n  const start = startDate ? new Date(startDate as string) : new Date(new Date().getFullYear(), new Date().getMonth(), 1);\n  const end = endDate ? new Date(endDate as string) : new Date();\n  \n  const revenueStats = await Billing.getRevenueStats(clinicId as string, start, end);\n  \n  return res.status(200).json({\n    success: true,\n    data: revenueStats\n  });\n});\n\n// @desc    Get billing summary\n// @route   GET /api/billing/summary\n// @access  Private (Dentist, Staff, Admin)\nexport const getBillingSummary = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  let query: any = { isActive: true };\n  \n  // If user is a dentist, only show their billing records\n  if (req.user.role === 'dentist') {\n    query.dentistId = req.user._id;\n  }\n  \n  const [totalRecords, pendingPayments, overduePayments, totalRevenue] = await Promise.all([\n    (Billing as any).countDocuments(query),\n    (Billing as any).countDocuments({ ...query, paymentStatus: 'pending' }),\n    (Billing as any).countDocuments({ ...query, paymentStatus: 'overdue' }),\n    (Billing as any).aggregate([\n      { $match: { ...query, paymentStatus: 'paid' } },\n      { $group: { _id: null, total: { $sum: '$totalAmount' } } }\n    ])\n  ]);\n  \n  return res.status(200).json({\n    success: true,\n    data: {\n      totalRecords,\n      pendingPayments,\n      overduePayments,\n      totalRevenue: totalRevenue[0]?.total || 0\n    }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\clinicController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mongoose' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[894,897],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[894,897],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1946,1949],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1946,1949],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2593,2596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2593,2596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2762,2765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2762,2765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":125,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3115,3118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3115,3118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3669,3672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3669,3672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3904,3907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3904,3907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":171,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4215,4218],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4215,4218],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":206,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5282,5285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5282,5285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":213,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5513,5516],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5513,5516],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":214,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5568,5571],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5568,5571],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":225,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5904,5907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5904,5907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'skip' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":236,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":236,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":259,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":259,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6821,6824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6821,6824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":260,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6876,6879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6876,6879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":277,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7380,7383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7380,7383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":278,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":278,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7441,7444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7441,7444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":301,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":301,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8122,8125],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8122,8125],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":315,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":315,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8461,8464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8461,8464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8897,8900],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8897,8900],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":351,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":351,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9354,9357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9354,9357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":390,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":390,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10327,10330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10327,10330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":395,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":395,"endColumn":17,"fix":{"range":[10417,10465],"text":"const query: any = { _id: { $in: clinic.staff } };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":395,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":395,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10428,10431],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10428,10431],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":418,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":418,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10984,10987],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10984,10987],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":441,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":441,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11674,11677],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11674,11677],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":447,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":447,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11870,11873],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11870,11873],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":448,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":448,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11925,11928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11925,11928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":450,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":450,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12043,12046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12043,12046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startOfLastMonth' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":476,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":476,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'endOfLastMonth' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":477,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":477,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":493,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":493,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13277,13280],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13277,13280],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":494,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":494,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13315,13318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13315,13318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":495,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":495,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13376,13379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13376,13379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":496,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":496,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13419,13422],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13419,13422],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":499,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":499,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13518,13521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13518,13521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":503,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":503,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13625,13628],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13625,13628],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":504,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":504,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13691,13694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13691,13694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":505,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":505,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13753,13756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13753,13756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":506,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":506,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13792,13795],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13792,13795],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":517,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":517,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14167,14170],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14167,14170],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":529,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":529,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14432,14435],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14432,14435],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":585,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":585,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15684,15687],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15684,15687],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":606,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":606,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16155,16158],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16155,16158],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":631,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":631,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16918,16921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16918,16921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":643,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":643,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17208,17211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17208,17211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":653,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":653,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17560,17563],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17560,17563],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":661,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":661,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17813,17816],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17813,17816],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":671,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":671,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18074,18077],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18074,18077],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":45,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport mongoose from 'mongoose';\nimport { Clinic, User, Appointment, Patient } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse,\n  createSearchRegex\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError,\n  createConflictError\n} from '../middleware/errorHandler';\nimport { uploadClinicImage as uploadClinicImageToCloud } from '../utils/upload';\n\n// Create new clinic\nexport const createClinic = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    name,\n    description,\n    address,\n    phone,\n    email,\n    website,\n    emergencyContact,\n    operatingHours,\n    services\n  } = req.body;\n\n  // Check if clinic with same name or email already exists\n  const existingClinic = await (Clinic as any).findOne({\n    $or: [\n      { name: { $regex: new RegExp(`^${name}$`, 'i') } },\n      { email: email.toLowerCase() }\n    ]\n  });\n\n  if (existingClinic) {\n    if (existingClinic.name.toLowerCase() === name.toLowerCase()) {\n      throw createConflictError('Clinic with this name already exists');\n    }\n    if (existingClinic.email === email.toLowerCase()) {\n      throw createConflictError('Clinic with this email already exists');\n    }\n  }\n\n  const clinic = new Clinic({\n    name,\n    description,\n    address,\n    phone,\n    email: email.toLowerCase(),\n    website,\n    emergencyContact,\n    operatingHours,\n    services,\n    createdBy: req.user._id\n  });\n\n  await clinic.save();\n\n  res.status(201).json({\n    success: true,\n    message: 'Clinic created successfully',\n    data: { clinic }\n  });\n});\n\n// Get all clinics\nexport const getAllClinics = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { search, city, state, service } = req.query;\n\n  // Build query\n  const query: any = {};\n\n  if (search) {\n    const searchRegex = createSearchRegex(search as string);\n    query.$or = [\n      { name: searchRegex },\n      { description: searchRegex },\n      { 'address.street': searchRegex },\n      { 'address.city': searchRegex },\n      { 'address.state': searchRegex }\n    ];\n  }\n\n  if (city) {\n    query['address.city'] = { $regex: new RegExp(city as string, 'i') };\n  }\n\n  if (state) {\n    query['address.state'] = { $regex: new RegExp(state as string, 'i') };\n  }\n\n  if (service) {\n    query.services = { $in: [service] };\n  }\n\n  // Get clinics with pagination\n  const [clinics, total] = await Promise.all([\n    (Clinic as any).find(query)\n      .populate('staff', 'firstName lastName role specialization')\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(limit),\n    (Clinic as any).countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(clinics, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get clinic by ID\nexport const getClinicById = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const clinic = await (Clinic as any).findById(id)\n    .populate('staff', 'firstName lastName role specialization phone email profileImage');\n\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  res.json({\n    success: true,\n    data: { clinic }\n  });\n});\n\n// Update clinic\nexport const updateClinic = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const {\n    name,\n    description,\n    address,\n    phone,\n    email,\n    website,\n    emergencyContact,\n    operatingHours,\n    services\n  } = req.body;\n\n  const clinic = await (Clinic as any).findById(id);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  // Check if name or email is being changed and if it's already taken\n  if (name && name !== clinic.name) {\n    const existingClinic = await (Clinic as any).findOne({\n      name: { $regex: new RegExp(`^${name}$`, 'i') },\n      _id: { $ne: id }\n    });\n    if (existingClinic) {\n      throw createConflictError('Clinic name is already taken');\n    }\n    clinic.name = name;\n  }\n\n  if (email && email !== clinic.email) {\n    const existingClinic = await (Clinic as any).findOne({\n      email: email.toLowerCase(),\n      _id: { $ne: id }\n    });\n    if (existingClinic) {\n      throw createConflictError('Email is already taken by another clinic');\n    }\n    clinic.email = email.toLowerCase();\n  }\n\n  // Update fields\n  if (description) clinic.description = description;\n  if (address) clinic.address = { ...clinic.address, ...address };\n  if (phone) clinic.phone = phone;\n  if (website) clinic.website = website;\n  if (emergencyContact) clinic.emergencyContact = emergencyContact;\n  if (operatingHours) clinic.operatingHours = { ...clinic.operatingHours, ...operatingHours };\n  if (services) clinic.services = services;\n\n  await clinic.save();\n\n  // Populate and return updated clinic\n  await clinic.populate('staff', 'firstName lastName role specialization');\n\n  res.json({\n    success: true,\n    message: 'Clinic updated successfully',\n    data: { clinic }\n  });\n});\n\n// Delete clinic\nexport const deleteClinic = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const clinic = await (Clinic as any).findById(id);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  // Check if clinic has any appointments or patients\n  const [appointmentCount, patientCount, staffCount] = await Promise.all([\n    (Appointment as any).countDocuments({ clinicId: id }),\n    (Patient as any).countDocuments({ preferredClinicId: id }),\n    User.countDocuments({ assignedClinics: id })\n  ]);\n\n  if (appointmentCount > 0 || patientCount > 0 || staffCount > 0) {\n    throw createValidationError(\n      'clinic',\n      'Cannot delete clinic with existing appointments, patients, or staff members'\n    );\n  }\n\n  await (Clinic as any).findByIdAndDelete(id);\n\n  res.json({\n    success: true,\n    message: 'Clinic deleted successfully'\n  });\n});\n\n// Search clinics\nexport const searchClinics = catchAsync(async (req: Request, res: Response) => {\n  const { q: searchTerm } = req.query;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  if (!searchTerm) {\n    throw createValidationError('q', 'Search term is required');\n  }\n\n  const clinics = await Clinic.searchClinics(searchTerm as string);\n  const total = clinics.length;\n\n  const paginatedResponse = createPaginatedResponse(clinics, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get clinics by city\nexport const getClinicsByCity = catchAsync(async (req: Request, res: Response) => {\n  const { city } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const [clinics, total] = await Promise.all([\n    (Clinic as any).findByCity(city, { skip, limit }),\n    (Clinic as any).countDocuments({ 'address.city': { $regex: new RegExp(city, 'i') } })\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(clinics, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get clinics by service\nexport const getClinicsByService = catchAsync(async (req: Request, res: Response) => {\n  const { service } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const [clinics, total] = await Promise.all([\n    (Clinic as any).findByService(service, { skip, limit }),\n    (Clinic as any).countDocuments({ services: { $in: [service] } })\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(clinics, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get nearby clinics\nexport const getNearbyClinic = catchAsync(async (req: Request, res: Response) => {\n  const { latitude, longitude, radius = 10 } = req.query;\n\n  if (!latitude || !longitude) {\n    throw createValidationError('location', 'Latitude and longitude are required');\n  }\n\n  const lat = parseFloat(latitude as string);\n  const lng = parseFloat(longitude as string);\n  const radiusInKm = parseFloat(radius as string);\n\n  const clinics = await (Clinic as any).findNearby(lat, lng, radiusInKm);\n\n  res.json({\n    success: true,\n    data: { clinics }\n  });\n});\n\n// Add staff to clinic\nexport const addStaffToClinic = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.params;\n  const { userId } = req.body;\n\n  const [clinic, user] = await Promise.all([\n    (Clinic as any).findById(clinicId),\n    User.findById(userId)\n  ]);\n\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Add user to clinic staff if not already added\n  if (!clinic.staff.includes(userId)) {\n    clinic.staff.push(userId);\n    await clinic.save();\n  }\n\n  // Add clinic to user's assigned clinics if not already assigned\n  const clinicObjectId = clinicId as any;\n  if (!user.assignedClinics.includes(clinicObjectId)) {\n    user.assignedClinics.push(clinicObjectId);\n    await user.save();\n  }\n\n  res.json({\n    success: true,\n    message: 'Staff member added to clinic successfully'\n  });\n});\n\n// Remove staff from clinic\nexport const removeStaffFromClinic = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId, userId } = req.params;\n\n  const [clinic, user] = await Promise.all([\n    (Clinic as any).findById(clinicId),\n    User.findById(userId)\n  ]);\n\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Remove user from clinic staff\n  clinic.staff = clinic.staff.filter(staff => staff.toString() !== userId);\n  await clinic.save();\n\n  // Remove clinic from user's assigned clinics\n  user.assignedClinics = user.assignedClinics.filter(\n    assignedClinicId => assignedClinicId.toString() !== clinicId\n  );\n\n  // If this was the user's preferred clinic, clear it\n  if (user.preferredClinicId?.toString() === clinicId) {\n    user.preferredClinicId = undefined;\n  }\n\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Staff member removed from clinic successfully'\n  });\n});\n\n// Get clinic staff\nexport const getClinicStaff = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.params;\n  const { role } = req.query;\n\n  const clinic = await (Clinic as any).findById(clinicId);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  let query: any = { _id: { $in: clinic.staff } };\n  if (role) {\n    query.role = role;\n  }\n\n  const staff = await User.find(query)\n    .select('firstName lastName email phone role specialization profileImage')\n    .sort({ firstName: 1 });\n\n  res.json({\n    success: true,\n    data: { staff }\n  });\n});\n\n// Upload clinic image\nexport const uploadClinicImage = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  if (!req.file) {\n    throw createValidationError('file', 'Clinic image is required');\n  }\n\n  const clinic = await (Clinic as any).findById(id);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  // Upload image to cloud storage\n  const uploadResult = await uploadClinicImageToCloud(req.file, clinic._id.toString());\n\n  // Update clinic image (assuming we add an images field to the clinic model)\n  // For now, we'll just return the uploaded image URL\n  res.json({\n    success: true,\n    message: 'Clinic image uploaded successfully',\n    data: {\n      imageUrl: uploadResult.secure_url\n    }\n  });\n});\n\n// Get clinic statistics (for specific clinic)\nexport const getClinicStatistics = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const clinic = await (Clinic as any).findById(id);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  const [appointmentCount, patientCount, staffCount, todayAppointments] = await Promise.all([\n    (Appointment as any).countDocuments({ clinicId: id }),\n    (Patient as any).countDocuments({ preferredClinicId: id }),\n    User.countDocuments({ assignedClinics: id }),\n    (Appointment as any).countDocuments({\n      clinicId: id,\n      date: {\n        $gte: new Date(new Date().setHours(0, 0, 0, 0)),\n        $lt: new Date(new Date().setHours(23, 59, 59, 999))\n      }\n    })\n  ]);\n\n  res.json({\n    success: true,\n    data: {\n      totalAppointments: appointmentCount,\n      totalPatients: patientCount,\n      totalStaff: staffCount,\n      todayAppointments\n    }\n  });\n});\n\n// Get overall statistics for all clinics (admin only)\nexport const getOverallStatistics = catchAsync(async (req: Request, res: Response) => {\n  const today = new Date();\n  const startOfDay = new Date(today.setHours(0, 0, 0, 0));\n  const endOfDay = new Date(today.setHours(23, 59, 59, 999));\n  const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);\n  const startOfLastMonth = new Date(today.getFullYear(), today.getMonth() - 1, 1);\n  const endOfLastMonth = new Date(today.getFullYear(), today.getMonth(), 0);\n\n  const [\n    totalClinics,\n    activeClinics,\n    totalAppointments,\n    todayAppointments,\n    upcomingAppointments,\n    completedAppointments,\n    cancelledAppointments,\n    totalPatients,\n    newPatientsThisMonth,\n    totalStaff,\n    thisMonthRevenue,\n    lastMonthRevenue\n  ] = await Promise.all([\n    (Clinic as any).countDocuments(),\n    (Clinic as any).countDocuments({ isActive: true }),\n    (Appointment as any).countDocuments(),\n    (Appointment as any).countDocuments({\n      date: { $gte: startOfDay, $lte: endOfDay }\n    }),\n    (Appointment as any).countDocuments({\n      date: { $gt: endOfDay },\n      status: 'scheduled'\n    }),\n    (Appointment as any).countDocuments({ status: 'completed' }),\n    (Appointment as any).countDocuments({ status: 'cancelled' }),\n    (Patient as any).countDocuments(),\n    (Patient as any).countDocuments({\n      createdAt: { $gte: startOfMonth }\n    }),\n    User.countDocuments({ role: { $in: ['dentist', 'staff'] } }),\n    // For revenue, we'll need to implement billing aggregation\n    // For now, returning 0 as placeholder\n    Promise.resolve(0),\n    Promise.resolve(0)\n  ]);\n\n  // Get clinic distribution by city\n  const clinicsByCity = await (Clinic as any).aggregate([\n    {\n      $group: {\n        _id: '$address.city',\n        count: { $sum: 1 }\n      }\n    },\n    { $sort: { count: -1 } },\n    { $limit: 10 }\n  ]);\n\n  // Get appointment trends for the last 7 days\n  const appointmentTrends = await (Appointment as any).aggregate([\n    {\n      $match: {\n        date: {\n          $gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),\n          $lte: new Date()\n        }\n      }\n    },\n    {\n      $group: {\n        _id: {\n          $dateToString: { format: '%Y-%m-%d', date: '$date' }\n        },\n        count: { $sum: 1 }\n      }\n    },\n    { $sort: { _id: 1 } }\n  ]);\n\n  res.json({\n    success: true,\n    data: {\n      clinics: {\n        total: totalClinics,\n        active: activeClinics,\n        inactive: totalClinics - activeClinics\n      },\n      appointments: {\n        total: totalAppointments,\n        today: todayAppointments,\n        upcoming: upcomingAppointments,\n        completed: completedAppointments,\n        cancelled: cancelledAppointments\n      },\n      patients: {\n        total: totalPatients,\n        newThisMonth: newPatientsThisMonth\n      },\n      staff: {\n        total: totalStaff\n      },\n      revenue: {\n        thisMonth: thisMonthRevenue,\n        lastMonth: lastMonthRevenue\n      },\n      clinicsByCity,\n      appointmentTrends\n    }\n  });\n});\n\n// Get clinic operating hours\nexport const getClinicOperatingHours = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const clinic = await (Clinic as any).findById(id).select('name operatingHours');\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  res.json({\n    success: true,\n    data: {\n      clinic: {\n        _id: clinic._id,\n        name: clinic.name,\n        operatingHours: clinic.operatingHours\n      }\n    }\n  });\n});\n\n// Check if clinic is open\nexport const checkClinicStatus = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const clinic = await (Clinic as any).findById(id);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  // Check if clinic is currently open based on operating hours\n  const now = new Date();\n  const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();\n  const todayHours = clinic.operatingHours.find(hours => hours.day === currentDay);\n  const isOpen = todayHours && !todayHours.closed;\n  \n  // You can add more sophisticated time checking logic here if needed\n\n  res.json({\n    success: true,\n    data: {\n      isOpen,\n      todayHours,\n      currentTime: new Date().toLocaleTimeString()\n    }\n  });\n});\n\n// Get all available services\nexport const getAllServices = catchAsync(async (req: Request, res: Response) => {\n  const services = await (Clinic as any).distinct('services');\n\n  res.json({\n    success: true,\n    data: { services: services.sort() }\n  });\n});\n\n// Get clinic dashboard data\nexport const getClinicDashboard = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const clinic = await (Clinic as any).findById(id);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  const today = new Date();\n  const startOfDay = new Date(today.setHours(0, 0, 0, 0));\n  const endOfDay = new Date(today.setHours(23, 59, 59, 999));\n\n  const [todayAppointments, upcomingAppointments, recentPatients, staffCount] = await Promise.all([\n    (Appointment as any).find({\n      clinicId: id,\n      date: { $gte: startOfDay, $lte: endOfDay }\n    })\n      .populate('patientId', 'firstName lastName')\n      .populate('dentistId', 'firstName lastName')\n      .sort({ 'timeSlot.start': 1 }),\n    \n    (Appointment as any).find({\n      clinicId: id,\n      date: { $gt: endOfDay },\n      status: 'scheduled'\n    })\n      .populate('patientId', 'firstName lastName')\n      .populate('dentistId', 'firstName lastName')\n      .sort({ date: 1 })\n      .limit(5),\n    \n    (Patient as any).find({ preferredClinicId: id })\n      .sort({ createdAt: -1 })\n      .limit(5)\n      .select('firstName lastName email createdAt'),\n    \n    User.countDocuments({ assignedClinics: id })\n  ]);\n\n  res.json({\n    success: true,\n    data: {\n      clinic: {\n        _id: clinic._id,\n        name: clinic.name,\n        address: clinic.address\n      },\n      todayAppointments,\n      upcomingAppointments,\n      recentPatients,\n      staffCount\n    }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\doctorScheduleController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":10,"column":92,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":96},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[576,579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[576,579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":53,"column":97,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":101},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":69,"column":97,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":101},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":318,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10645,10648],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10645,10648],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Response, NextFunction } from 'express';\nimport { AuthenticatedRequest } from '../types';\nimport DoctorSchedule from '../models/DoctorSchedule';\nimport { User, Clinic } from '../models';\nimport { AppError, catchAsync } from '../middleware/errorHandler';\n\n// @desc    Get all doctor schedules with optional filters\n// @route   GET /api/v1/schedules\n// @access  Private\nexport const getAllSchedules = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { doctorId, clinicId, dayOfWeek, isActive } = req.query;\n  \n  const query: any = {};\n  \n  if (doctorId) query.doctorId = doctorId;\n  if (clinicId) query.clinicId = clinicId;\n  if (dayOfWeek !== undefined) query.dayOfWeek = parseInt(dayOfWeek as string);\n  if (isActive !== undefined) query.isActive = isActive === 'true';\n  \n  const schedules = await DoctorSchedule.find(query)\n    .populate('doctorId', 'firstName lastName email specialization')\n    .populate('clinicId', 'name branchName address phone')\n    .sort({ dayOfWeek: 1, startTime: 1 });\n  \n  return res.status(200).json({\n    success: true,\n    count: schedules.length,\n    data: schedules\n  });\n});\n\n// @desc    Get schedule by ID\n// @route   GET /api/v1/schedules/:id\n// @access  Private\nexport const getScheduleById = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const schedule = await DoctorSchedule.findById(req.params.id)\n    .populate('doctorId', 'firstName lastName email specialization')\n    .populate('clinicId', 'name branchName address');\n  \n  if (!schedule) {\n    return next(new AppError('Schedule not found', 404));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    data: schedule\n  });\n});\n\n// @desc    Get schedules by doctor ID\n// @route   GET /api/v1/schedules/doctor/:doctorId\n// @access  Private\nexport const getSchedulesByDoctor = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { isActive } = req.query;\n  const activeFilter = isActive !== undefined ? isActive === 'true' : true;\n  \n  const schedules = await DoctorSchedule.findByDoctor(req.params.doctorId, activeFilter);\n  \n  return res.status(200).json({\n    success: true,\n    count: schedules.length,\n    data: schedules\n  });\n});\n\n// @desc    Get schedules by clinic ID\n// @route   GET /api/v1/schedules/clinic/:clinicId\n// @access  Private\nexport const getSchedulesByClinic = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { isActive } = req.query;\n  const activeFilter = isActive !== undefined ? isActive === 'true' : true;\n  \n  const schedules = await DoctorSchedule.findByClinic(req.params.clinicId, activeFilter);\n  \n  return res.status(200).json({\n    success: true,\n    count: schedules.length,\n    data: schedules\n  });\n});\n\n// @desc    Get available doctors for a specific day at a clinic\n// @route   GET /api/v1/schedules/available\n// @access  Private\nexport const getAvailableDoctors = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { clinicId, dayOfWeek, date } = req.query;\n  \n  if (!clinicId) {\n    return next(new AppError('Clinic ID is required', 400));\n  }\n  \n  let day: number;\n  \n  if (date) {\n    // Calculate day of week from date\n    day = new Date(date as string).getDay();\n  } else if (dayOfWeek !== undefined) {\n    day = parseInt(dayOfWeek as string);\n  } else {\n    return next(new AppError('Either date or dayOfWeek is required', 400));\n  }\n  \n  if (day < 0 || day > 6) {\n    return next(new AppError('Invalid day of week (must be 0-6)', 400));\n  }\n  \n  const schedules = await DoctorSchedule.getAvailableDoctorsForDay(clinicId as string, day);\n  \n  // Group by doctor to avoid duplicates\n  const doctorMap = new Map();\n  schedules.forEach(schedule => {\n    const doctorId = schedule.doctorId._id.toString();\n    if (!doctorMap.has(doctorId)) {\n      doctorMap.set(doctorId, {\n        doctor: schedule.doctorId,\n        clinic: schedule.clinicId,\n        schedules: []\n      });\n    }\n    doctorMap.get(doctorId).schedules.push({\n      id: schedule._id,\n      startTime: schedule.startTime,\n      endTime: schedule.endTime,\n      dayOfWeek: schedule.dayOfWeek,\n      notes: schedule.notes\n    });\n  });\n  \n  const availableDoctors = Array.from(doctorMap.values());\n  \n  return res.status(200).json({\n    success: true,\n    count: availableDoctors.length,\n    data: availableDoctors\n  });\n});\n\n// @desc    Create new schedule\n// @route   POST /api/v1/schedules\n// @access  Private (Admin only)\nexport const createSchedule = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { doctorId, clinicId, dayOfWeek, startTime, endTime, notes, effectiveFrom, effectiveUntil } = req.body;\n  \n  // Verify doctor exists and is a dentist\n  const doctor = await User.findById(doctorId);\n  if (!doctor) {\n    return next(new AppError('Doctor not found', 404));\n  }\n  if (doctor.role !== 'dentist' && doctor.role !== 'super_admin') {\n    return next(new AppError('User is not a dentist', 400));\n  }\n  \n  // Verify clinic exists\n  const clinic = await Clinic.findById(clinicId);\n  if (!clinic) {\n    return next(new AppError('Clinic not found', 404));\n  }\n  \n  // Check for conflicting schedules for same doctor/clinic/day\n  const existingSchedules = await DoctorSchedule.find({\n    doctorId,\n    clinicId,\n    dayOfWeek,\n    isActive: true\n  });\n  \n  // Check for time overlaps\n  const [newStartHour, newStartMin] = startTime.split(':').map(Number);\n  const [newEndHour, newEndMin] = endTime.split(':').map(Number);\n  const newStartMinutes = newStartHour * 60 + newStartMin;\n  const newEndMinutes = newEndHour * 60 + newEndMin;\n  \n  for (const existing of existingSchedules) {\n    const [existStartHour, existStartMin] = existing.startTime.split(':').map(Number);\n    const [existEndHour, existEndMin] = existing.endTime.split(':').map(Number);\n    const existStartMinutes = existStartHour * 60 + existStartMin;\n    const existEndMinutes = existEndHour * 60 + existEndMin;\n    \n    // Check for overlap\n    if (\n      (newStartMinutes >= existStartMinutes && newStartMinutes < existEndMinutes) ||\n      (newEndMinutes > existStartMinutes && newEndMinutes <= existEndMinutes) ||\n      (newStartMinutes <= existStartMinutes && newEndMinutes >= existEndMinutes)\n    ) {\n      return next(new AppError(\n        `Schedule conflicts with existing schedule from ${existing.startTime} to ${existing.endTime}`,\n        409\n      ));\n    }\n  }\n  \n  const schedule = await DoctorSchedule.create({\n    doctorId,\n    clinicId,\n    dayOfWeek,\n    startTime,\n    endTime,\n    notes,\n    effectiveFrom,\n    effectiveUntil,\n    isActive: true\n  });\n  \n  const populatedSchedule = await DoctorSchedule.findById(schedule._id)\n    .populate('doctorId', 'firstName lastName email')\n    .populate('clinicId', 'name branchName');\n  \n  return res.status(201).json({\n    success: true,\n    data: populatedSchedule,\n    message: 'Doctor schedule created successfully'\n  });\n});\n\n// @desc    Update schedule\n// @route   PUT /api/v1/schedules/:id\n// @access  Private (Admin only)\nexport const updateSchedule = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  let schedule = await DoctorSchedule.findById(req.params.id);\n  \n  if (!schedule) {\n    return next(new AppError('Schedule not found', 404));\n  }\n  \n  // If updating time, check for conflicts\n  if (req.body.startTime || req.body.endTime) {\n    const startTime = req.body.startTime || schedule.startTime;\n    const endTime = req.body.endTime || schedule.endTime;\n    \n    const [newStartHour, newStartMin] = startTime.split(':').map(Number);\n    const [newEndHour, newEndMin] = endTime.split(':').map(Number);\n    const newStartMinutes = newStartHour * 60 + newStartMin;\n    const newEndMinutes = newEndHour * 60 + newEndMin;\n    \n    // Find conflicting schedules (excluding current schedule)\n    const conflictingSchedules = await DoctorSchedule.find({\n      _id: { $ne: schedule._id },\n      doctorId: schedule.doctorId,\n      clinicId: schedule.clinicId,\n      dayOfWeek: schedule.dayOfWeek,\n      isActive: true\n    });\n    \n    for (const existing of conflictingSchedules) {\n      const [existStartHour, existStartMin] = existing.startTime.split(':').map(Number);\n      const [existEndHour, existEndMin] = existing.endTime.split(':').map(Number);\n      const existStartMinutes = existStartHour * 60 + existStartMin;\n      const existEndMinutes = existEndHour * 60 + existEndMin;\n      \n      if (\n        (newStartMinutes >= existStartMinutes && newStartMinutes < existEndMinutes) ||\n        (newEndMinutes > existStartMinutes && newEndMinutes <= existEndMinutes) ||\n        (newStartMinutes <= existStartMinutes && newEndMinutes >= existEndMinutes)\n      ) {\n        return next(new AppError(\n          `Updated schedule would conflict with existing schedule from ${existing.startTime} to ${existing.endTime}`,\n          409\n        ));\n      }\n    }\n  }\n  \n  schedule = await DoctorSchedule.findByIdAndUpdate(\n    req.params.id,\n    req.body,\n    {\n      new: true,\n      runValidators: true\n    }\n  ).populate('doctorId', 'firstName lastName email')\n   .populate('clinicId', 'name branchName');\n  \n  return res.status(200).json({\n    success: true,\n    data: schedule,\n    message: 'Schedule updated successfully'\n  });\n});\n\n// @desc    Delete schedule (soft delete - set isActive to false)\n// @route   DELETE /api/v1/schedules/:id\n// @access  Private (Admin only)\nexport const deleteSchedule = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const schedule = await DoctorSchedule.findById(req.params.id);\n  \n  if (!schedule) {\n    return next(new AppError('Schedule not found', 404));\n  }\n  \n  // Soft delete\n  schedule.isActive = false;\n  await schedule.save();\n  \n  return res.status(200).json({\n    success: true,\n    data: {},\n    message: 'Schedule deleted successfully'\n  });\n});\n\n// @desc    Bulk create schedules\n// @route   POST /api/v1/schedules/bulk\n// @access  Private (Admin only)\nexport const bulkCreateSchedules = catchAsync(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { schedules } = req.body;\n  \n  if (!Array.isArray(schedules) || schedules.length === 0) {\n    return next(new AppError('Schedules array is required and cannot be empty', 400));\n  }\n  \n  const createdSchedules = [];\n  const errors = [];\n  \n  for (let i = 0; i < schedules.length; i++) {\n    try {\n      const schedule = await DoctorSchedule.create(schedules[i]);\n      createdSchedules.push(schedule);\n    } catch (error: any) {\n      errors.push({\n        index: i,\n        schedule: schedules[i],\n        error: error.message\n      });\n    }\n  }\n  \n  return res.status(201).json({\n    success: true,\n    data: {\n      created: createdSchedules.length,\n      failed: errors.length,\n      schedules: createdSchedules,\n      errors\n    },\n    message: `${createdSchedules.length} schedules created successfully, ${errors.length} failed`\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\homepageContentController.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\insuranceClaimController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Billing' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[907,910],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[907,910],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1097,1100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1097,1100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1292,1295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1292,1295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1387,1390],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1387,1390],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2553,2556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2553,2556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3320,3323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3320,3323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3623,3626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3623,3626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3824,3827],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3824,3827],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4347,4350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4347,4350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4715,4718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4715,4718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5165,5168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5165,5168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":182,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5255,5258],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5255,5258],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6016,6019],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6016,6019],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":219,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6300,6303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6300,6303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":250,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7170,7173],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7170,7173],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":255,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7322,7325],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7322,7325],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":286,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":286,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8162,8165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8162,8165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8434,8437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8434,8437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":327,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":327,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9297,9300],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9297,9300],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":328,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":328,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9376,9379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9376,9379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":344,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":344,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9763,9766],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9763,9766],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":356,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10053,10056],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10053,10056],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":371,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":371,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10432,10435],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10432,10435],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":386,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":386,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10782,10785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10782,10785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":413,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":413,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11645,11648],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11645,11648],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":446,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":446,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12407,12410],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12407,12410],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":461,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":461,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12731,12734],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12731,12734],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":480,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":480,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13375,13378],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13375,13378],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":499,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":499,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13931,13934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13931,13934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":29,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { InsuranceClaim, Insurance, Patient, Billing } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\n\n// Create insurance claim\nexport const createClaim = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    insuranceId,\n    patientId,\n    providerId,\n    clinicId,\n    appointmentId,\n    treatmentRecordId,\n    billingId,\n    serviceDate,\n    claimType,\n    procedures,\n    priorAuthNumber,\n    priorAuthRequired,\n    priorAuthObtained\n  } = req.body;\n\n  // Verify insurance exists and is active\n  const insurance = await (Insurance as any).findById(insuranceId);\n  if (!insurance || !insurance.isActive) {\n    throw createNotFoundError('Active insurance');\n  }\n\n  // Verify patient exists\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Calculate total billed from procedures\n  const totalBilled = procedures.reduce((sum: number, proc: any) => sum + proc.totalPrice, 0);\n\n  // Create claim\n  const claim = await (InsuranceClaim as any).create({\n    insuranceId,\n    patientId,\n    providerId,\n    clinicId,\n    appointmentId,\n    treatmentRecordId,\n    billingId,\n    serviceDate,\n    claimType: claimType || 'primary',\n    procedures,\n    totalBilled,\n    priorAuthNumber,\n    priorAuthRequired: priorAuthRequired || false,\n    priorAuthObtained: priorAuthObtained || false,\n    createdBy: req.user._id\n  });\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: patientId,\n    title: 'Insurance Claim Created',\n    message: `A claim for $${totalBilled} has been submitted to your insurance`,\n    type: 'insurance_update',\n    link: `/insurance/claims/${claim._id}`,\n    metadata: {\n      claimId: claim._id,\n      claimNumber: claim.claimNumber,\n      totalBilled\n    }\n  });\n\n  res.status(201).json({\n    success: true,\n    message: 'Insurance claim created successfully',\n    data: { claim }\n  });\n});\n\n// Submit claim to insurance\nexport const submitClaim = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { submissionMethod, clearinghouse, batchNumber } = req.body;\n\n  const claim = await (InsuranceClaim as any).findById(id)\n    .populate('patientId', 'firstName lastName')\n    .populate('insuranceId', 'insuranceCompany');\n\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  if (claim.status !== 'draft') {\n    throw createValidationError('claim', 'Only draft claims can be submitted');\n  }\n\n  // Check prior authorization if required\n  if (claim.priorAuthRequired && !claim.priorAuthObtained) {\n    throw createValidationError('claim', 'Prior authorization is required but not obtained');\n  }\n\n  // Update claim with submission details\n  claim.submissionMethod = submissionMethod || 'electronic';\n  if (clearinghouse) claim.clearinghouse = clearinghouse;\n  if (batchNumber) claim.batchNumber = batchNumber;\n\n  claim.status = 'submitted';\n  (claim as any).submittedDate = new Date();\n  await claim.save();\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: claim.patientId._id.toString(),\n    title: 'Insurance Claim Submitted',\n    message: `Your claim #${claim.claimNumber} has been submitted to ${(claim.insuranceId as any).insuranceCompany || 'your insurance'}`,\n    type: 'insurance_update',\n    metadata: {\n      claimId: claim._id,\n      claimNumber: claim.claimNumber,\n      insuranceCompany: (claim.insuranceId as any).insuranceCompany\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Claim submitted successfully',\n    data: { claim }\n  });\n});\n\n// Process claim response from insurance\nexport const processClaim = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const {\n    totalAllowed,\n    totalPaid,\n    patientResponsibility,\n    deductibleApplied,\n    copayAmount,\n    coinsuranceAmount,\n    explanationOfBenefits\n  } = req.body;\n\n  const claim = await (InsuranceClaim as any).findById(id)\n    .populate('patientId', 'firstName lastName')\n    .populate('insuranceId');\n\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  if (!['submitted', 'pending'].includes(claim.status)) {\n    throw createValidationError('claim', 'Only submitted or pending claims can be processed');\n  }\n\n  // Process the claim\n  await (claim as any).markAsProcessed({\n    totalAllowed,\n    totalPaid,\n    patientResponsibility,\n    explanationOfBenefits\n  });\n\n  // Update additional amounts if provided\n  if (deductibleApplied) claim.deductibleApplied = deductibleApplied;\n  if (copayAmount) claim.copayAmount = copayAmount;\n  if (coinsuranceAmount) claim.coinsuranceAmount = coinsuranceAmount;\n  await claim.save();\n\n  // Update insurance benefit usage\n  const insurance = await (Insurance as any).findById(claim.insuranceId);\n  if (insurance && totalPaid) {\n    await (insurance as any).updateBenefitUsage(totalPaid);\n  }\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: claim.patientId._id.toString(),\n    title: 'Insurance Claim Processed',\n    message: `Your claim #${claim.claimNumber} has been processed. Insurance paid $${totalPaid || 0}`,\n    type: 'insurance_update',\n    metadata: {\n      claimId: claim._id,\n      claimNumber: claim.claimNumber,\n      totalPaid,\n      patientResponsibility\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Claim processed successfully',\n    data: { claim }\n  });\n});\n\n// Mark claim as paid\nexport const markClaimPaid = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const claim = await (InsuranceClaim as any).findById(id).populate('patientId', 'firstName lastName');\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  if (claim.status !== 'processed') {\n    throw createValidationError('claim', 'Only processed claims can be marked as paid');\n  }\n\n  await (claim as any).markAsPaid();\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: claim.patientId._id.toString(),\n    title: 'Insurance Payment Received',\n    message: `Payment of $${claim.totalPaid} has been received for claim #${claim.claimNumber}`,\n    type: 'payment_success',\n    metadata: {\n      claimId: claim._id,\n      claimNumber: claim.claimNumber,\n      totalPaid: claim.totalPaid\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Claim marked as paid successfully',\n    data: { claim }\n  });\n});\n\n// Deny claim\nexport const denyClaim = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { denialReason, denialCode } = req.body;\n\n  if (!denialReason) {\n    throw createValidationError('denialReason', 'Denial reason is required');\n  }\n\n  const claim = await (InsuranceClaim as any).findById(id).populate('patientId', 'firstName lastName');\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  await (claim as any).deny(denialReason, denialCode);\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: claim.patientId._id.toString(),\n    title: 'Insurance Claim Denied',\n    message: `Your claim #${claim.claimNumber} has been denied: ${denialReason}`,\n    type: 'insurance_update',\n    metadata: {\n      claimId: claim._id,\n      claimNumber: claim.claimNumber,\n      denialReason\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Claim denied successfully',\n    data: { claim }\n  });\n});\n\n// Appeal claim\nexport const appealClaim = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { appealReason } = req.body;\n\n  if (!appealReason) {\n    throw createValidationError('appealReason', 'Appeal reason is required');\n  }\n\n  const claim = await (InsuranceClaim as any).findById(id).populate('patientId', 'firstName lastName');\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  if (claim.status !== 'denied') {\n    throw createValidationError('claim', 'Only denied claims can be appealed');\n  }\n\n  await (claim as any).addAppeal({\n    reason: appealReason,\n    appealedBy: req.user._id\n  });\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: claim.patientId._id.toString(),\n    title: 'Insurance Claim Appealed',\n    message: `An appeal has been submitted for claim #${claim.claimNumber}`,\n    type: 'insurance_update',\n    metadata: {\n      claimId: claim._id,\n      claimNumber: claim.claimNumber,\n      appealReason\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Claim appealed successfully',\n    data: { claim }\n  });\n});\n\n// Get claims by patient\nexport const getPatientClaims = catchAsync(async (req: Request, res: Response) => {\n  const { patientId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n  const { status } = req.query;\n\n  const [claims, total] = await Promise.all([\n    (InsuranceClaim as any).findByPatient(patientId, { skip, limit, status }),\n    (InsuranceClaim as any).countDocuments({ \n      patientId, \n      ...(status && { status }) \n    })\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(claims, total, page, limit)\n  });\n});\n\n// Get claims by insurance\nexport const getInsuranceClaims = catchAsync(async (req: Request, res: Response) => {\n  const { insuranceId } = req.params;\n\n  const claims = await (InsuranceClaim as any).findByInsurance(insuranceId);\n\n  res.json({\n    success: true,\n    data: { claims }\n  });\n});\n\n// Get pending claims\nexport const getPendingClaims = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.query;\n\n  const pendingClaims = await (InsuranceClaim as any).findPendingClaims(clinicId as string);\n\n  res.json({\n    success: true,\n    data: { \n      claims: pendingClaims,\n      count: pendingClaims.length\n    }\n  });\n});\n\n// Get claims needing follow-up\nexport const getClaimsNeedingFollowUp = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.query;\n\n  const followUpClaims = await (InsuranceClaim as any).findClaimsNeedingFollowUp(clinicId as string);\n\n  res.json({\n    success: true,\n    data: { \n      claims: followUpClaims,\n      count: followUpClaims.length\n    }\n  });\n});\n\n// Get claim by ID\nexport const getClaimById = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const claim = await (InsuranceClaim as any).findById(id)\n    .populate('patientId', 'firstName lastName email dateOfBirth')\n    .populate('insuranceId')\n    .populate('providerId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .populate('appointmentId')\n    .populate('treatmentRecordId')\n    .populate('billingId')\n    .populate('createdBy', 'firstName lastName')\n    .populate('correspondenceLog.handledBy', 'firstName lastName')\n    .populate('appealHistory.appealedBy', 'firstName lastName');\n\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  res.json({\n    success: true,\n    data: { claim }\n  });\n});\n\n// Add correspondence to claim\nexport const addCorrespondence = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { type, direction, subject, notes } = req.body;\n\n  const claim = await (InsuranceClaim as any).findById(id);\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  if (!claim.correspondenceLog) {\n    claim.correspondenceLog = [];\n  }\n  claim.correspondenceLog.push({\n    type,\n    direction,\n    subject,\n    notes,\n    date: new Date(),\n    handledBy: req.user._id\n  });\n\n  res.json({\n    success: true,\n    message: 'Correspondence added successfully',\n    data: { claim }\n  });\n});\n\n// Get claim statistics\nexport const getClaimStatistics = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId, startDate, endDate } = req.query;\n\n  const dateRange = startDate && endDate ? {\n    start: new Date(startDate as string),\n    end: new Date(endDate as string)\n  } : undefined;\n\n  const stats = await (InsuranceClaim as any).getClaimStatistics(clinicId as string, dateRange);\n\n  // Calculate additional metrics\n  const totalStats = {\n    totalClaims: 0,\n    totalBilled: 0,\n    totalPaid: 0,\n    averageProcessingTime: 0,\n    paymentRate: 0,\n    denialRate: 0\n  };\n\n  let processingTimes = 0;\n  let processedClaims = 0;\n\n  stats.forEach((stat: any) => {\n    totalStats.totalClaims += stat.count;\n    totalStats.totalBilled += stat.totalBilled;\n    totalStats.totalPaid += stat.totalPaid;\n    \n    if (stat.averageProcessingTime) {\n      processingTimes += stat.averageProcessingTime * stat.count;\n      processedClaims += stat.count;\n    }\n  });\n\n  if (processedClaims > 0) {\n    totalStats.averageProcessingTime = Math.round(processingTimes / processedClaims / (1000 * 60 * 60 * 24)); // Convert to days\n  }\n\n  if (totalStats.totalBilled > 0) {\n    totalStats.paymentRate = Math.round((totalStats.totalPaid / totalStats.totalBilled) * 100);\n  }\n\n  const deniedClaims = stats.find((stat: any) => stat._id === 'denied');\n  if (deniedClaims && totalStats.totalClaims > 0) {\n    totalStats.denialRate = Math.round((deniedClaims.count / totalStats.totalClaims) * 100);\n  }\n\n  res.json({\n    success: true,\n    data: {\n      summary: totalStats,\n      breakdown: stats\n    }\n  });\n});\n\n// Update claim follow-up\nexport const updateFollowUp = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { followUpRequired, followUpDate, followUpReason } = req.body;\n\n  const claim = await (InsuranceClaim as any).findById(id);\n  if (!claim) {\n    throw createNotFoundError('Insurance claim');\n  }\n\n  claim.followUpRequired = followUpRequired;\n  if (followUpDate) claim.followUpDate = new Date(followUpDate);\n  if (followUpReason) claim.followUpReason = followUpReason;\n  claim.updatedBy = req.user._id;\n\n  await claim.save();\n\n  res.json({\n    success: true,\n    message: 'Follow-up updated successfully',\n    data: { claim }\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\insuranceController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getPaginationParams' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createPaginatedResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1189,1192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1189,1192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1386,1389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1386,1389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1685,1688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1685,1688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3116,3119],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3116,3119],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3438,3441],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3438,3441],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3819,3822],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3819,3822],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4365,4368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4365,4368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4864,4867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4864,4867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":204,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5648,5651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5648,5651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5840,5843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5840,5843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":260,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7390,7393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7390,7393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":269,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":269,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7667,7670],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7667,7670],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7987,7990],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7987,7990],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":294,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8314,8317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8314,8317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":297,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":297,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8441,8444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8441,8444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":298,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":298,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8522,8525],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8522,8525],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":298,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":298,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8533,8536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8533,8536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":322,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":322,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9131,9134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9131,9134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":356,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10152,10155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10152,10155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":383,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":383,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10849,10852],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10849,10852],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { Insurance, Patient, User } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\n\n// Create insurance record\nexport const createInsurance = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    patientId,\n    insuranceCompany,\n    policyNumber,\n    groupNumber,\n    membershipNumber,\n    policyHolderName,\n    relationshipToPolicyHolder,\n    policyHolderDateOfBirth,\n    coverageType,\n    effectiveDate,\n    expirationDate,\n    dentalCoveragePercentage,\n    annualMaxBenefit,\n    annualDeductible,\n    preventiveCoverage,\n    basicCoverage,\n    majorCoverage,\n    orthodonticCoverage,\n    orthodonticLifetimeMax,\n    insurancePhone,\n    insuranceAddress,\n    preAuthorizationRequired,\n    waitingPeriods,\n    exclusions,\n    limitations\n  } = req.body;\n\n  // Check if patient exists\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Check for existing active insurance for this patient\n  const existingInsurance = await (Insurance as any).findActiveInsurance(patientId);\n  if (existingInsurance && existingInsurance.policyNumber === policyNumber) {\n    throw createValidationError('insurance', 'Patient already has active insurance with this policy number');\n  }\n\n  // Create insurance record\n  const insurance = await (Insurance as any).create({\n    patientId,\n    insuranceCompany,\n    policyNumber,\n    groupNumber,\n    membershipNumber,\n    policyHolderName,\n    relationshipToPolicyHolder,\n    policyHolderDateOfBirth,\n    coverageType,\n    effectiveDate,\n    expirationDate,\n    dentalCoveragePercentage,\n    annualMaxBenefit,\n    annualDeductible,\n    remainingBenefits: annualMaxBenefit || 0,\n    preventiveCoverage: preventiveCoverage || 100,\n    basicCoverage: basicCoverage || 80,\n    majorCoverage: majorCoverage || 50,\n    orthodonticCoverage: orthodonticCoverage || 0,\n    orthodonticLifetimeMax,\n    insurancePhone,\n    insuranceAddress,\n    preAuthorizationRequired: preAuthorizationRequired || false,\n    waitingPeriods,\n    exclusions,\n    limitations,\n    createdBy: req.user._id\n  });\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: patientId,\n    title: 'Insurance Added',\n    message: `Your ${insuranceCompany} insurance has been added to your account`,\n    type: 'insurance_update',\n    metadata: {\n      insuranceId: insurance._id,\n      insuranceCompany\n    }\n  });\n\n  res.status(201).json({\n    success: true,\n    message: 'Insurance record created successfully',\n    data: { insurance }\n  });\n});\n\n// Get patient insurance records\nexport const getPatientInsurance = catchAsync(async (req: Request, res: Response) => {\n  const { patientId } = req.params;\n\n  const insuranceRecords = await (Insurance as any).findByPatient(patientId);\n\n  res.json({\n    success: true,\n    data: { insurance: insuranceRecords }\n  });\n});\n\n// Get active insurance for patient\nexport const getActiveInsurance = catchAsync(async (req: Request, res: Response) => {\n  const { patientId } = req.params;\n\n  const activeInsurance = await (Insurance as any).findActiveInsurance(patientId);\n\n  if (!activeInsurance) {\n    throw createNotFoundError('Active insurance');\n  }\n\n  res.json({\n    success: true,\n    data: { insurance: activeInsurance }\n  });\n});\n\n// Get insurance by ID\nexport const getInsuranceById = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const insurance = await (Insurance as any).findById(id)\n    .populate('patientId', 'firstName lastName email dateOfBirth')\n    .populate('verifiedBy', 'firstName lastName')\n    .populate('createdBy', 'firstName lastName');\n\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  res.json({\n    success: true,\n    data: { insurance }\n  });\n});\n\n// Update insurance record\nexport const updateInsurance = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const updateData = req.body;\n\n  const insurance = await (Insurance as any).findById(id);\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  // Update insurance record\n  Object.assign(insurance, {\n    ...updateData,\n    updatedBy: req.user._id\n  });\n\n  await insurance.save();\n\n  // Send notification if significant changes\n  const significantFields = ['annualMaxBenefit', 'verificationStatus', 'isActive'];\n  const changedSignificantField = significantFields.some(field => \n    updateData[field] !== undefined && updateData[field] !== (insurance as any)[field]\n  );\n\n  if (changedSignificantField) {\n    await createAndSendNotification({\n      userId: insurance.patientId.toString(),\n      title: 'Insurance Updated',\n      message: 'Your insurance information has been updated',\n      type: 'insurance_update',\n      metadata: {\n        insuranceId: insurance._id,\n        changes: Object.keys(updateData)\n      }\n    });\n  }\n\n  res.json({\n    success: true,\n    message: 'Insurance record updated successfully',\n    data: { insurance }\n  });\n});\n\n// Verify insurance\nexport const verifyInsurance = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { notes, eligibilityStatus, annualMaxBenefit, usedBenefits, coverageDetails } = req.body;\n\n  const insurance = await (Insurance as any).findById(id).populate('patientId', 'firstName lastName email');\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  // Update verification status\n  await (insurance as any).markAsVerified(req.user._id, notes);\n\n  // Update additional verification details if provided\n  if (eligibilityStatus) {\n    insurance.eligibilityStatus = eligibilityStatus;\n  }\n  if (annualMaxBenefit !== undefined) {\n    insurance.annualMaxBenefit = annualMaxBenefit;\n    insurance.remainingBenefits = Math.max(0, annualMaxBenefit - (insurance.usedBenefits || 0));\n  }\n  if (usedBenefits !== undefined) {\n    insurance.usedBenefits = usedBenefits;\n    if (insurance.annualMaxBenefit) {\n      insurance.remainingBenefits = Math.max(0, insurance.annualMaxBenefit - usedBenefits);\n    }\n  }\n  if (coverageDetails) {\n    Object.assign(insurance, coverageDetails);\n  }\n\n  await insurance.save();\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: insurance.patientId._id.toString(),\n    title: 'Insurance Verified',\n    message: `Your ${insurance.insuranceCompany} insurance has been verified and is active`,\n    type: 'insurance_update',\n    metadata: {\n      insuranceId: insurance._id,\n      verificationStatus: 'verified'\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Insurance verified successfully',\n    data: { insurance }\n  });\n});\n\n// Calculate coverage for treatment\nexport const calculateCoverage = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const { treatmentType, amount } = req.body;\n\n  if (!treatmentType || !amount) {\n    throw createValidationError('request', 'Treatment type and amount are required');\n  }\n\n  const insurance = await (Insurance as any).findById(id);\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  if (insurance.verificationStatus !== 'verified') {\n    throw createValidationError('insurance', 'Insurance must be verified to calculate coverage');\n  }\n\n  const coverage = (insurance as any).calculateCoverage(treatmentType, amount);\n\n  res.json({\n    success: true,\n    data: { coverage }\n  });\n});\n\n// Get expiring insurance policies\nexport const getExpiringInsurance = catchAsync(async (req: Request, res: Response) => {\n  const { days = 30 } = req.query;\n\n  const expiringPolicies = await (Insurance as any).findExpiring(Number(days));\n\n  res.json({\n    success: true,\n    data: { \n      expiringPolicies,\n      count: expiringPolicies.length\n    }\n  });\n});\n\n// Get insurance verification statistics\nexport const getVerificationStatistics = catchAsync(async (req: Request, res: Response) => {\n  const stats = await (Insurance as any).getVerificationStatistics();\n\n  // Calculate additional metrics\n  const totalInsurance = stats.reduce((sum: number, stat: any) => sum + stat.count, 0);\n  const verificationBreakdown = stats.reduce((acc: any, stat: any) => {\n    acc[stat._id] = {\n      count: stat.count,\n      percentage: totalInsurance ? ((stat.count / totalInsurance) * 100).toFixed(1) : 0,\n      averageUsedBenefits: Math.round(stat.averageUsedBenefits || 0)\n    };\n    return acc;\n  }, {});\n\n  res.json({\n    success: true,\n    data: {\n      totalInsurance,\n      verificationBreakdown,\n      stats\n    }\n  });\n});\n\n// Deactivate insurance\nexport const deactivateInsurance = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { reason } = req.body;\n\n  const insurance = await (Insurance as any).findById(id).populate('patientId', 'firstName lastName email');\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  insurance.isActive = false;\n  insurance.verificationStatus = 'expired';\n  insurance.verificationNotes = reason || 'Deactivated by admin';\n  insurance.updatedBy = req.user._id;\n  await insurance.save();\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: insurance.patientId._id.toString(),\n    title: 'Insurance Deactivated',\n    message: `Your ${insurance.insuranceCompany} insurance has been deactivated`,\n    type: 'insurance_update',\n    metadata: {\n      insuranceId: insurance._id,\n      reason\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Insurance deactivated successfully',\n    data: { insurance }\n  });\n});\n\n// Reset annual benefits (for new benefit year)\nexport const resetAnnualBenefits = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const insurance = await (Insurance as any).findById(id);\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  insurance.usedBenefits = 0;\n  if (insurance.annualMaxBenefit) {\n    insurance.remainingBenefits = insurance.annualMaxBenefit;\n  }\n  await insurance.save();\n\n  res.json({\n    success: true,\n    message: 'Annual benefits reset successfully',\n    data: { insurance }\n  });\n});\n\n// Update benefit usage\nexport const updateBenefitUsage = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { amount } = req.body;\n\n  if (!amount || amount <= 0) {\n    throw createValidationError('amount', 'Valid amount is required');\n  }\n\n  const insurance = await (Insurance as any).findById(id);\n  if (!insurance) {\n    throw createNotFoundError('Insurance');\n  }\n\n  insurance.usedBenefits = (insurance.usedBenefits || 0) + amount;\n  if (insurance.annualMaxBenefit) {\n    insurance.remainingBenefits = Math.max(0, insurance.annualMaxBenefit - (insurance.usedBenefits || 0));\n  }\n  await insurance.save();\n\n  // Check if approaching annual max\n  const remainingPercentage = insurance.remainingBenefits && insurance.annualMaxBenefit \n    ? (insurance.remainingBenefits / insurance.annualMaxBenefit) * 100 \n    : 0;\n\n  if (remainingPercentage <= 20 && remainingPercentage > 0) {\n    await createAndSendNotification({\n      userId: insurance.patientId.toString(),\n      title: 'Insurance Benefits Low',\n      message: `You have ${remainingPercentage.toFixed(1)}% of your annual dental benefits remaining`,\n      type: 'insurance_update',\n      metadata: {\n        insuranceId: insurance._id,\n        remainingBenefits: insurance.remainingBenefits\n      }\n    });\n  } else if (remainingPercentage <= 0) {\n    await createAndSendNotification({\n      userId: insurance.patientId.toString(),\n      title: 'Insurance Benefits Exhausted',\n      message: 'You have reached your annual dental benefit maximum',\n      type: 'insurance_update',\n      metadata: {\n        insuranceId: insurance._id,\n        benefitsExhausted: true\n      }\n    });\n  }\n\n  res.json({\n    success: true,\n    message: 'Benefit usage updated successfully',\n    data: { insurance }\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\inventoryController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Supplier' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[766,769],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[766,769],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1299,1302],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1299,1302],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1435,1438],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1435,1438],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1680,1683],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1680,1683],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2080,2083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2080,2083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2966,2969],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2966,2969],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3130,3133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3130,3133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3284,3287],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3284,3287],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4015,4018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4015,4018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4262,4265],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4262,4265],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4554,4557],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4554,4557],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5057,5060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5057,5060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":187,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5351,5354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5351,5354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5522,5525],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5522,5525],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":225,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6278,6281],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6278,6281],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":248,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6984,6987],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6984,6987],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7898,7901],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7898,7901],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":313,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":313,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8506,8509],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8506,8509],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":349,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":349,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9645,9648],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9645,9648],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":362,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":362,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9996,9999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9996,9999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":379,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":379,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10431,10434],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10431,10434],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":382,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":382,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10547,10550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10547,10550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":385,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":385,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10679,10682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10679,10682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":397,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":397,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11051,11054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11051,11054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":400,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":400,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11176,11179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11176,11179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":445,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":445,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12344,12347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12344,12347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":452,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":452,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12466,12469],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12466,12469],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":456,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":456,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12630,12633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12630,12633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":28,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { AuthenticatedRequest } from '../types';\nimport { InventoryItem, Supplier, StockMovement } from '../models';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport mongoose from 'mongoose';\n\n// Get all inventory items with filtering and pagination\nexport const getInventoryItems = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit } = getPaginationParams(req);\n  const { \n    category,\n    isLowStock,\n    isActive,\n    search,\n    clinic,\n    sortBy = 'name',\n    sortOrder = 'asc'\n  } = req.query;\n\n  // Build query\n  const query: any = {};\n  \n  if (category) query.category = category;\n  if (isLowStock !== undefined) query.isLowStock = isLowStock === 'true';\n  if (isActive !== undefined) query.isActive = isActive === 'true';\n  if (clinic) query.clinic = clinic;\n  \n  if (search) {\n    query.$or = [\n      { name: { $regex: search, $options: 'i' } },\n      { sku: { $regex: search, $options: 'i' } },\n      { description: { $regex: search, $options: 'i' } },\n      { barcode: { $regex: search, $options: 'i' } }\n    ];\n  }\n\n  // Build sort object\n  const sort: any = {};\n  sort[sortBy as string] = sortOrder === 'desc' ? -1 : 1;\n\n  const [items, total] = await Promise.all([\n    (InventoryItem as any).find(query)\n      .populate('clinic', 'name')\n      .populate('supplier', 'name contactPerson')\n      .populate('createdBy', 'firstName lastName')\n      .sort(sort)\n      .skip((page - 1) * limit)\n      .limit(limit),\n    (InventoryItem as any).countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(items, total, page, limit);\n  res.json({\n    message: 'Inventory items retrieved successfully',\n    ...paginatedResponse\n  });\n});\n\n// Get single inventory item\nexport const getInventoryItem = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const item = await (InventoryItem as any).findById(id)\n    .populate('clinic', 'name address phone')\n    .populate('supplier', 'name contactPerson email phone')\n    .populate('createdBy updatedBy', 'firstName lastName');\n\n  if (!item) {\n    throw createNotFoundError('Inventory item');\n  }\n\n  // Get recent stock movements\n  const recentMovements = await StockMovement.find({ inventoryItem: id })\n    .populate('performedBy', 'firstName lastName')\n    .sort({ createdAt: -1 })\n    .limit(10);\n\n  res.json({\n    success: true,\n    message: 'Inventory item retrieved successfully',\n    data: {\n      item,\n      recentMovements\n    }\n  });\n});\n\n// Create new inventory item\nexport const createInventoryItem = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const itemData = {\n    ...req.body,\n    createdBy: req.user!.id\n  };\n\n  // Check if SKU already exists\n  const existingSku = await (InventoryItem as any).findOne({ sku: itemData.sku });\n  if (existingSku) {\n    throw createValidationError('sku', 'SKU already exists');\n  }\n\n  const item = await (InventoryItem as any).create(itemData);\n  \n  // If initial stock is provided, record it as a stock movement\n  if (itemData.currentStock > 0) {\n    await (StockMovement as any).recordMovement({\n      inventoryItem: item._id.toString(),\n      clinic: item.clinic.toString(),\n      type: 'in',\n      quantity: item.currentStock,\n      previousStock: 0,\n      newStock: item.currentStock,\n      reason: 'adjustment',\n      description: 'Initial stock entry',\n      performedBy: req.user!.id\n    });\n  }\n\n  await item.populate('clinic supplier createdBy', 'name firstName lastName');\n\n  res.status(201).json({\n    success: true,\n    message: 'Inventory item created successfully',\n    data: { item }\n  });\n});\n\n// Update inventory item\nexport const updateInventoryItem = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  \n  const item = await (InventoryItem as any).findById(id);\n  if (!item) {\n    throw createNotFoundError('Inventory item');\n  }\n\n  // Check if SKU is being changed and if it already exists\n  if (req.body.sku && req.body.sku !== item.sku) {\n    const existingSku = await (InventoryItem as any).findOne({ \n      sku: req.body.sku, \n      _id: { $ne: id } \n    });\n    if (existingSku) {\n      throw createValidationError('sku', 'SKU already exists');\n    }\n  }\n\n  const updateData = {\n    ...req.body,\n    updatedBy: req.user!.id\n  };\n\n  const updatedItem = await (InventoryItem as any).findByIdAndUpdate(\n    id,\n    updateData,\n    { new: true, runValidators: true }\n  ).populate('clinic supplier createdBy updatedBy', 'name firstName lastName');\n\n  res.json({\n    success: true,\n    message: 'Inventory item updated successfully',\n    data: { item: updatedItem }\n  });\n});\n\n// Delete inventory item (soft delete)\nexport const deleteInventoryItem = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const item = await (InventoryItem as any).findById(id);\n  if (!item) {\n    throw createNotFoundError('Inventory item');\n  }\n\n  // Check if item has stock movements\n  const hasMovements = await StockMovement.exists({ inventoryItem: id });\n  if (hasMovements) {\n    // Soft delete - just mark as inactive\n    await (InventoryItem as any).findByIdAndUpdate(id, { \n      isActive: false,\n      updatedBy: req.user!.id\n    });\n  } else {\n    // Hard delete if no movements exist\n    await (InventoryItem as any).findByIdAndDelete(id);\n  }\n\n  res.json({\n    success: true,\n    message: 'Inventory item deleted successfully'\n  });\n});\n\n// Update stock (add or remove)\nexport const updateStock = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { \n    type, // 'in' or 'out' or 'adjustment'\n    quantity,\n    reason,\n    description,\n    reference,\n    unitCost,\n    batchNumber,\n    expiryDate,\n    notes\n  } = req.body;\n\n  if (!['in', 'out', 'adjustment'].includes(type)) {\n    throw createValidationError('type', 'Invalid stock movement type');\n  }\n\n  if (!quantity || quantity <= 0) {\n    throw createValidationError('quantity', 'Quantity must be greater than 0');\n  }\n\n  const item = await (InventoryItem as any).findById(id);\n  if (!item) {\n    throw createNotFoundError('Inventory item');\n  }\n\n  const previousStock = item.currentStock;\n  let newStock: number;\n\n  if (type === 'in') {\n    newStock = previousStock + quantity;\n  } else if (type === 'out') {\n    if (quantity > previousStock) {\n      throw createValidationError('quantity', 'Cannot remove more stock than available');\n    }\n    newStock = previousStock - quantity;\n  } else { // adjustment\n    newStock = quantity; // For adjustments, quantity is the new stock level\n  }\n\n  // Start transaction\n  const session = await mongoose.startSession();\n  await session.withTransaction(async () => {\n    // Update inventory item\n    await (InventoryItem as any).findByIdAndUpdate(\n      id,\n      {\n        currentStock: newStock,\n        isLowStock: newStock <= item.minimumStock,\n        lastRestocked: type === 'in' ? new Date() : item.lastRestocked,\n        lastUsed: type === 'out' ? new Date() : item.lastUsed,\n        updatedBy: req.user!.id\n      },\n      { session }\n    );\n\n    // Record stock movement\n    await StockMovement.create([{\n      inventoryItem: id,\n      clinic: item.clinic,\n      type,\n      quantity: type === 'adjustment' ? Math.abs(newStock - previousStock) : quantity,\n      previousStock,\n      newStock,\n      reason: reason || (type === 'in' ? 'purchase' : type === 'out' ? 'usage' : 'adjustment'),\n      description,\n      reference,\n      unitCost,\n      batchNumber,\n      expiryDate,\n      performedBy: req.user!.id,\n      notes\n    }], { session });\n  });\n\n  await session.endSession();\n\n  const updatedItem = await (InventoryItem as any).findById(id)\n    .populate('clinic supplier', 'name');\n\n  res.json({\n    success: true,\n    message: 'Stock updated successfully',\n    data: { \n      item: updatedItem,\n      movement: {\n        type,\n        quantity,\n        previousStock,\n        newStock\n      }\n    }\n  });\n});\n\n// Get stock movements history\nexport const getStockMovements = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit } = getPaginationParams(req);\n  const { \n    itemId,\n    clinic,\n    type,\n    reason,\n    startDate,\n    endDate,\n    performedBy\n  } = req.query;\n\n  // Build query\n  const query: any = {};\n  \n  if (itemId) query.inventoryItem = itemId;\n  if (clinic) query.clinic = clinic;\n  if (type) query.type = type;\n  if (reason) query.reason = reason;\n  if (performedBy) query.performedBy = performedBy;\n  \n  if (startDate || endDate) {\n    query.createdAt = {};\n    if (startDate) query.createdAt.$gte = new Date(startDate as string);\n    if (endDate) query.createdAt.$lte = new Date(endDate as string);\n  }\n\n  const [movements, total] = await Promise.all([\n    StockMovement.find(query)\n      .populate('inventoryItem', 'name sku category')\n      .populate('clinic', 'name')\n      .populate('performedBy', 'firstName lastName')\n      .sort({ createdAt: -1 })\n      .skip((page - 1) * limit)\n      .limit(limit),\n    StockMovement.countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(movements, total, page, limit);\n  res.json({\n    message: 'Stock movements retrieved successfully',\n    ...paginatedResponse\n  });\n});\n\n// Get low stock items\nexport const getLowStockItems = catchAsync(async (req: Request, res: Response) => {\n  const { clinic } = req.query;\n\n  const items = await (InventoryItem as any).findLowStockItems(clinic as string);\n\n  res.json({\n    success: true,\n    message: 'Low stock items retrieved successfully',\n    data: { items }\n  });\n});\n\n// Get expiring items\nexport const getExpiringItems = catchAsync(async (req: Request, res: Response) => {\n  const { days = 30, clinic } = req.query;\n\n  const items = await (InventoryItem as any).findExpiringItems(\n    parseInt(days as string), \n    clinic as string\n  );\n\n  res.json({\n    success: true,\n    message: 'Expiring items retrieved successfully',\n    data: { items }\n  });\n});\n\n// Get inventory dashboard data\nexport const getInventoryDashboard = catchAsync(async (req: Request, res: Response) => {\n  const { clinic } = req.query;\n\n  // Get stock summary by category\n  const stockSummary = await (InventoryItem as any).getStockSummary(clinic as string);\n  \n  // Get low stock items\n  const lowStockItems = await (InventoryItem as any).findLowStockItems(clinic as string);\n  \n  // Get expiring items (next 30 days)\n  const expiringItems = await (InventoryItem as any).findExpiringItems(30, clinic as string);\n  \n  // Get recent movements (last 10)\n  const recentMovements = await StockMovement.find(\n    clinic ? { clinic } : {}\n  )\n    .populate('inventoryItem', 'name sku')\n    .populate('performedBy', 'firstName lastName')\n    .sort({ createdAt: -1 })\n    .limit(10);\n\n  // Calculate total inventory value\n  const totalValueQuery: any = { isActive: true };\n  if (clinic) totalValueQuery.clinic = clinic;\n  \n  const inventoryValue = await (InventoryItem as any).aggregate([\n    { $match: totalValueQuery },\n    {\n      $group: {\n        _id: null,\n        totalValue: { $sum: { $multiply: ['$currentStock', '$costPrice'] } },\n        totalItems: { $sum: 1 }\n      }\n    }\n  ]);\n\n  res.json({\n    success: true,\n    message: 'Inventory dashboard data retrieved successfully',\n    data: {\n      stockSummary,\n      lowStockItems: {\n        items: lowStockItems,\n        count: lowStockItems.length\n      },\n      expiringItems: {\n        items: expiringItems,\n        count: expiringItems.length\n      },\n      recentMovements,\n      totalValue: inventoryValue[0]?.totalValue || 0,\n      totalItems: inventoryValue[0]?.totalItems || 0\n    }\n  });\n});\n\n// Generate inventory report\nexport const generateInventoryReport = catchAsync(async (req: Request, res: Response) => {\n  const { \n    startDate,\n    endDate,\n    clinic,\n    category,\n    format = 'json'\n  } = req.query;\n\n  const start = startDate ? new Date(startDate as string) : new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n  const end = endDate ? new Date(endDate as string) : new Date();\n\n  // Get movement summary\n  const movementSummary = await (StockMovement as any).getMovementSummary(\n    start,\n    end,\n    clinic as string\n  );\n\n  // Get current stock levels\n  const stockQuery: any = { isActive: true };\n  if (clinic) stockQuery.clinic = clinic;\n  if (category) stockQuery.category = category;\n\n  const currentStock = await (InventoryItem as any).find(stockQuery)\n    .populate('clinic', 'name')\n    .populate('supplier', 'name')\n    .sort({ category: 1, name: 1 });\n\n  const reportData = {\n    reportPeriod: {\n      startDate: start,\n      endDate: end\n    },\n    movementSummary,\n    currentStock,\n    generatedAt: new Date(),\n    totalItems: currentStock.length,\n    totalValue: currentStock.reduce((sum, item) => sum + (item.currentStock * item.costPrice), 0)\n  };\n\n  if (format === 'csv') {\n    // TODO: Implement CSV export\n    res.setHeader('Content-Type', 'text/csv');\n    res.setHeader('Content-Disposition', 'attachment; filename=inventory-report.csv');\n    res.send('CSV export not implemented yet');\n  } else {\n    res.json({\n      success: true,\n      message: 'Inventory report generated successfully',\n      data: reportData\n    });\n  }\n});\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\medicationController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":10,"column":96,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":100},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[558,561],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[558,561],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":67,"column":82,"nodeType":null,"messageId":"unusedVar","endLine":67,"endColumn":86},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":139,"column":90,"nodeType":null,"messageId":"unusedVar","endLine":139,"endColumn":94},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":153,"column":87,"nodeType":null,"messageId":"unusedVar","endLine":153,"endColumn":91},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4728,4731],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4728,4731],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":189,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5622,5625],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5622,5625],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":189,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5643,5646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5643,5646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5696,5699],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5696,5699],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\nimport { Medication } from '../models';\nimport { asyncHandler } from '../utils/asyncHandler';\nimport { AppError } from '../utils/AppError';\nimport { AuthenticatedRequest } from '../types';\n\n// @desc    Get all medications\n// @route   GET /api/medications\n// @access  Private (Dentist, Staff, Admin)\nexport const getAllMedications = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { page = 1, limit = 10, search, category } = req.query;\n  \n  let query: any = { isActive: true };\n  \n  if (search) {\n    query = {\n      ...query,\n      $or: [\n        { name: { $regex: search, $options: 'i' } },\n        { genericName: { $regex: search, $options: 'i' } }\n      ]\n    };\n  }\n  \n  if (category) {\n    query.category = category;\n  }\n  \n  const medications = await Medication.find(query)\n    .sort({ name: 1 })\n    .limit(Number(limit) * 1)\n    .skip((Number(page) - 1) * Number(limit));\n    \n  const total = await Medication.countDocuments(query);\n  \n  return res.status(200).json({\n    success: true,\n    data: medications,\n    pagination: {\n      page: Number(page),\n      limit: Number(limit),\n      total,\n      pages: Math.ceil(total / Number(limit))\n    }\n  });\n});\n\n// @desc    Get medication by ID\n// @route   GET /api/medications/:id\n// @access  Private (Dentist, Staff, Admin)\nexport const getMedicationById = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const medication = await Medication.findById(req.params.id);\n  \n  if (!medication) {\n    return next(new AppError('Medication not found', 404));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    data: medication\n  });\n});\n\n// @desc    Create new medication\n// @route   POST /api/medications\n// @access  Private (Admin)\nexport const createMedication = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const medication = await Medication.create(req.body);\n  \n  return res.status(201).json({\n    success: true,\n    data: medication,\n    message: 'Medication created successfully'\n  });\n});\n\n// @desc    Update medication\n// @route   PUT /api/medications/:id\n// @access  Private (Admin)\nexport const updateMedication = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const medication = await Medication.findByIdAndUpdate(\n    req.params.id,\n    req.body,\n    { new: true, runValidators: true }\n  );\n  \n  if (!medication) {\n    return next(new AppError('Medication not found', 404));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    data: medication,\n    message: 'Medication updated successfully'\n  });\n});\n\n// @desc    Delete medication (soft delete)\n// @route   DELETE /api/medications/:id\n// @access  Private (Admin)\nexport const deleteMedication = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const medication = await Medication.findByIdAndUpdate(\n    req.params.id,\n    { isActive: false },\n    { new: true }\n  );\n  \n  if (!medication) {\n    return next(new AppError('Medication not found', 404));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    message: 'Medication deleted successfully'\n  });\n});\n\n// @desc    Search medications\n// @route   GET /api/medications/search\n// @access  Private (Dentist, Staff, Admin)\nexport const searchMedications = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const { q } = req.query;\n  \n  if (!q) {\n    return next(new AppError('Search query is required', 400));\n  }\n  \n  const medications = await Medication.searchMedications(q as string);\n  \n  return res.status(200).json({\n    success: true,\n    data: medications\n  });\n});\n\n// @desc    Get medications by category\n// @route   GET /api/medications/category/:category\n// @access  Private (Dentist, Staff, Admin)\nexport const getMedicationsByCategory = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const { category } = req.params;\n  \n  const medications = await Medication.findByCategory(category);\n  \n  return res.status(200).json({\n    success: true,\n    data: medications\n  });\n});\n\n// @desc    Get patient medications (prescribed medications)\n// @route   GET /api/patients/:patientId/medications\n// @access  Private (Patient themselves, Dentist, Staff, Admin)\nexport const getPatientMedications = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const { patientId } = req.params;\n  const { page = 1, limit = 10, search, category, status = 'active' } = req.query;\n  \n  // Import Prescription model\n  const Prescription = require('../models/Prescription').default;\n  \n  // Build query for prescriptions\n  const prescriptionQuery: any = { patientId };\n  if (status && status !== 'all') {\n    prescriptionQuery.status = status;\n  }\n  \n  // Get prescriptions with populated medication data\n  const prescriptions = await Prescription.find(prescriptionQuery)\n    .populate({\n      path: 'medications.medicationId',\n      model: 'Medication',\n      match: {\n        isActive: true,\n        ...(category && category !== 'all' && { category }),\n        ...(search && {\n          $or: [\n            { name: { $regex: search, $options: 'i' } },\n            { genericName: { $regex: search, $options: 'i' } }\n          ]\n        })\n      }\n    })\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .sort({ issuedDate: -1 })\n    .limit(Number(limit))\n    .skip((Number(page) - 1) * Number(limit));\n  \n  // Transform prescriptions to medication format\n  const medications = prescriptions.reduce((acc: any[], prescription: any) => {\n    prescription.medications.forEach((med: any) => {\n      if (med.medicationId) { // Only include if medication exists and matches filters\n        acc.push({\n          _id: med.medicationId._id,\n          name: med.medicationId.name,\n          genericName: med.medicationId.genericName,\n          dosage: med.dosage,\n          frequency: med.frequency,\n          duration: med.duration,\n          instructions: med.instructions,\n          sideEffects: med.medicationId.sideEffects || [],\n          contraindications: med.medicationId.contraindications || [],\n          category: med.medicationId.category,\n          isActive: med.medicationId.isActive,\n          prescribedDate: prescription.issuedDate,\n          startDate: med.startDate,\n          endDate: med.endDate,\n          prescriptionId: prescription._id,\n          dentist: prescription.dentistId,\n          clinic: prescription.clinicId,\n          prescriptionStatus: prescription.status\n        });\n      }\n    });\n    return acc;\n  }, []);\n  \n  // Get total count for pagination\n  const totalPrescriptions = await Prescription.countDocuments(prescriptionQuery);\n  \n  return res.status(200).json({\n    success: true,\n    data: {\n      medications,\n      totalRecords: medications.length,\n      totalPages: Math.ceil(totalPrescriptions / Number(limit)),\n      currentPage: Number(page)\n    }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\messageController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[925,928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[925,928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":57,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1444,1447],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1444,1447],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":61,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1562,1565],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1562,1565],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2503,2506],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2503,2506],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3035,3038],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3035,3038],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3505,3508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3505,3508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4359,4362],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4359,4362],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4414,4417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4414,4417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4502,4505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4502,4505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":179,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5143,5146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5143,5146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5232,5235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5232,5235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5547,5550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5547,5550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5755,5758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5755,5758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":216,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6203,6206],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6203,6206],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":278,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":278,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7426,7429],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7426,7429],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7924,7927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7924,7927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":303,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8140,8143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8140,8143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":322,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":322,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8525,8528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8525,8528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":333,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":333,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8871,8874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8871,8874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":347,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9179,9182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9179,9182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":360,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9601,9604],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9601,9604],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":375,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":375,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9974,9977],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9974,9977],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":388,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":388,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10391,10394],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10391,10394],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":402,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":402,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10742,10745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10742,10745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":424,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":424,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11639,11642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11639,11642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":442,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":442,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12068,12071],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12068,12071],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":466,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":466,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12607,12610],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12607,12610],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":472,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":472,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12876,12879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12876,12879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":483,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":483,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13220,13223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13220,13223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":492,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":492,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13511,13514],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13511,13514],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":30,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { Message, User } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\n\n// Send a message\nexport const sendMessage = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    recipientId,\n    subject,\n    content,\n    messageType = 'text',\n    priority = 'normal',\n    scheduledSendTime,\n    relatedRecords\n  } = req.body;\n\n  // Verify recipient exists and is active\n  const recipient = await User.findOne({ _id: recipientId, isActive: true });\n  if (!recipient) {\n    throw createNotFoundError('Recipient user');\n  }\n\n  // Create message\n  const messageData: any = {\n    senderId: req.user._id,\n    recipientId,\n    content,\n    messageType,\n    priority,\n    relatedRecords,\n    isHipaaCompliant: true\n  };\n\n  if (subject) messageData.subject = subject;\n\n  // Handle scheduled messages\n  if (scheduledSendTime) {\n    const scheduleDate = new Date(scheduledSendTime);\n    if (scheduleDate > new Date()) {\n      messageData.scheduledSendTime = scheduleDate;\n      messageData.isScheduled = true;\n      messageData.status = 'draft';\n    }\n  }\n\n  const message = await (Message as any).create(messageData);\n\n  // Send immediately if not scheduled\n  if (!message.isScheduled) {\n    await (message as any).send();\n    \n    // Send real-time notification to recipient\n    await createAndSendNotification({\n      userId: recipientId,\n      title: 'New Message',\n      message: `You have a new message from ${req.user.firstName} ${req.user.lastName}`,\n      type: 'general',\n      link: `/messages/${message._id}`,\n      metadata: {\n        messageId: message._id,\n        senderId: req.user._id,\n        senderName: `${req.user.firstName} ${req.user.lastName}`\n      }\n    });\n  }\n\n  res.status(201).json({\n    success: true,\n    message: message.isScheduled ? 'Message scheduled successfully' : 'Message sent successfully',\n    data: { message }\n  });\n});\n\n// Reply to a message\nexport const replyToMessage = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { originalMessageId } = req.params;\n  const { content, priority = 'normal' } = req.body;\n\n  // Find original message\n  const originalMessage = await (Message as any).findById(originalMessageId)\n    .populate('senderId', 'firstName lastName')\n    .populate('recipientId', 'firstName lastName');\n\n  if (!originalMessage) {\n    throw createNotFoundError('Original message');\n  }\n\n  // Determine recipient (sender of original message if current user was recipient, or vice versa)\n  const recipientId = originalMessage.senderId._id.toString() === req.user._id.toString()\n    ? originalMessage.recipientId._id\n    : originalMessage.senderId._id;\n\n  // Create reply\n  const reply = await (Message as any).create({\n    senderId: req.user._id,\n    recipientId,\n    content,\n    messageType: originalMessage.messageType,\n    priority,\n    isReply: true,\n    originalMessageId: originalMessage._id,\n    threadId: originalMessage.threadId || originalMessage._id,\n    subject: originalMessage.subject ? `Re: ${originalMessage.subject}` : undefined,\n    relatedRecords: originalMessage.relatedRecords,\n    isHipaaCompliant: true\n  });\n\n  reply.sentAt = new Date();\n  (reply as any).messageStatus = 'sent';\n  await reply.save();\n\n  // Send notification\n  await createAndSendNotification({\n    userId: recipientId.toString(),\n    title: 'New Reply',\n    message: `${req.user.firstName} ${req.user.lastName} replied to your message`,\n    type: 'general',\n    link: `/messages/${reply._id}`,\n    metadata: {\n      messageId: reply._id,\n      threadId: reply.threadId,\n      senderId: req.user._id\n    }\n  });\n\n  res.status(201).json({\n    success: true,\n    message: 'Reply sent successfully',\n    data: { message: reply }\n  });\n});\n\n// Get user's messages\nexport const getUserMessages = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { type = 'all', status, messageType } = req.query;\n\n  const [messages, total] = await Promise.all([\n    (Message as any).findUserMessages(req.user._id.toString(), type as any, {\n      skip,\n      limit,\n      status,\n      messageType\n    }),\n    (Message as any).countDocuments({\n      $or: [\n        { senderId: req.user._id },\n        { recipientId: req.user._id }\n      ],\n      deletedAt: { $exists: false },\n      ...(status && { status }),\n      ...(messageType && { messageType })\n    })\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(messages, total, page, limit)\n  });\n});\n\n// Get conversation between two users\nexport const getConversation = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { userId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const [messages, total] = await Promise.all([\n    (Message as any).findConversation(req.user._id.toString(), userId, { skip, limit }),\n    (Message as any).countDocuments({\n      $or: [\n        { senderId: req.user._id, recipientId: userId },\n        { senderId: userId, recipientId: req.user._id }\n      ],\n      deletedAt: { $exists: false }\n    })\n  ]);\n\n  // Mark messages as read if current user is recipient\n  const unreadMessages = messages.filter(\n    (msg: any) => msg.recipientId._id.toString() === req.user._id.toString() && !msg.isRead\n  );\n  \n  if (unreadMessages.length > 0) {\n    await Message.updateMany(\n      {\n        _id: { $in: unreadMessages.map((msg: any) => msg._id) },\n        recipientId: req.user._id\n      },\n      {\n        isRead: true,\n        readAt: new Date(),\n        status: 'read'\n      }\n    );\n  }\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(messages.reverse(), total, page, limit)\n  });\n});\n\n// Get conversation list\nexport const getConversationList = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const conversations = await (Message as any).aggregate([\n    {\n      $match: {\n        $or: [\n          { senderId: req.user._id },\n          { recipientId: req.user._id }\n        ],\n        isDeleted: { $ne: true }\n      }\n    },\n    {\n      $sort: { createdAt: -1 }\n    },\n    {\n      $group: {\n        _id: {\n          $cond: [\n            { $eq: ['$senderId', req.user._id] },\n            '$recipientId',\n            '$senderId'\n          ]\n        },\n        lastMessage: { $first: '$$ROOT' },\n        unreadCount: {\n          $sum: {\n            $cond: [\n              {\n                $and: [\n                  { $eq: ['$recipientId', req.user._id] },\n                  { $eq: ['$isRead', false] }\n                ]\n              },\n              1,\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      $lookup: {\n        from: 'users',\n        localField: '_id',\n        foreignField: '_id',\n        as: 'otherUser'\n      }\n    },\n    {\n      $unwind: '$otherUser'\n    }\n  ]);\n\n  res.json({\n    success: true,\n    data: { conversations }\n  });\n});\n\n// Get message thread\nexport const getMessageThread = catchAsync(async (req: Request, res: Response) => {\n  const { threadId } = req.params;\n\n  const messages = await (Message as any).find({ threadId, isDeleted: { $ne: true } })\n    .populate('senderId', 'firstName lastName role')\n    .populate('recipientId', 'firstName lastName role')\n    .sort({ createdAt: 1 });\n\n  if (messages.length === 0) {\n    throw createNotFoundError('Message thread');\n  }\n\n  res.json({\n    success: true,\n    data: { messages }\n  });\n});\n\n// Get unread messages\nexport const getUnreadMessages = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const messages = await (Message as any).find({\n    recipientId: req.user._id,\n    isRead: false,\n    isDeleted: { $ne: true }\n  })\n    .populate('senderId', 'firstName lastName role')\n    .sort({ createdAt: -1 });\n  \n  const count = await (Message as any).countDocuments({\n    recipientId: req.user._id,\n    isRead: false,\n    isDeleted: { $ne: true }\n  });\n\n  res.json({\n    success: true,\n    data: {\n      messages,\n      count\n    }\n  });\n});\n\n// Mark message as read\nexport const markMessageAsRead = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const message = await (Message as any).findById(id);\n  if (!message) {\n    throw createNotFoundError('Message');\n  }\n\n  // Only recipient can mark message as read\n  if (message.recipientId.toString() !== req.user._id.toString()) {\n    throw createValidationError('authorization', 'You can only mark your own messages as read');\n  }\n\n  if (!message.isRead) {\n    await (message as any).markAsRead();\n  }\n\n  res.json({\n    success: true,\n    message: 'Message marked as read',\n    data: { message }\n  });\n});\n\n// Archive message\nexport const archiveMessage = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const message = await (Message as any).findById(id);\n  if (!message) {\n    throw createNotFoundError('Message');\n  }\n\n  // Only sender or recipient can archive\n  const canArchive = message.senderId.toString() === req.user._id.toString() ||\n                     message.recipientId.toString() === req.user._id.toString();\n\n  if (!canArchive) {\n    throw createValidationError('authorization', 'You can only archive your own messages');\n  }\n\n    (message as any).isArchived = true;\n  message.archivedAt = new Date();\n  await message.save();\n\n  res.json({\n    success: true,\n    message: 'Message archived successfully',\n    data: { message }\n  });\n});\n\n// Delete message\nexport const deleteMessage = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const message = await (Message as any).findById(id);\n  if (!message) {\n    throw createNotFoundError('Message');\n  }\n\n  // Only sender or recipient can delete\n  const canDelete = message.senderId.toString() === req.user._id.toString() ||\n                    message.recipientId.toString() === req.user._id.toString();\n\n  if (!canDelete) {\n    throw createValidationError('authorization', 'You can only delete your own messages');\n  }\n\n    (message as any).isDeleted = true;\n  message.deletedAt = new Date();\n  await message.save();\n\n  res.json({\n    success: true,\n    message: 'Message deleted successfully'\n  });\n});\n\n// Get message by ID\nexport const getMessageById = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const message = await (Message as any).findById(id)\n    .populate('senderId', 'firstName lastName profileImage role')\n    .populate('recipientId', 'firstName lastName profileImage role')\n    .populate('originalMessageId')\n    .populate('relatedRecords.appointmentId')\n    .populate('relatedRecords.patientId', 'firstName lastName')\n    .populate('relatedRecords.prescriptionId');\n\n  if (!message || message.deletedAt) {\n    throw createNotFoundError('Message');\n  }\n\n  // Check authorization\n  const canAccess = message.senderId._id.toString() === req.user._id.toString() ||\n                    message.recipientId._id.toString() === req.user._id.toString();\n\n  if (!canAccess) {\n    throw createValidationError('authorization', 'You can only access your own messages');\n  }\n\n  // Mark as read if recipient is viewing\n  if (message.recipientId._id.toString() === req.user._id.toString() && !message.isRead) {\n    await (message as any).markAsRead();\n  }\n\n  res.json({\n    success: true,\n    data: { message }\n  });\n});\n\n// Search messages\nexport const searchMessages = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { query, type, dateFrom, dateTo } = req.query;\n\n  if (!query) {\n    throw createValidationError('query', 'Search query is required');\n  }\n\n  const searchQuery: any = {\n    $or: [\n      { senderId: req.user._id },\n      { recipientId: req.user._id }\n    ],\n    deletedAt: { $exists: false },\n    $text: { $search: query as string }\n  };\n\n  if (type) {\n    searchQuery.messageType = type;\n  }\n\n  if (dateFrom || dateTo) {\n    searchQuery.createdAt = {};\n    if (dateFrom) {\n      searchQuery.createdAt.$gte = new Date(dateFrom as string);\n    }\n    if (dateTo) {\n      searchQuery.createdAt.$lte = new Date(dateTo as string);\n    }\n  }\n\n  const [messages, total] = await Promise.all([\n    (Message as any).find(searchQuery)\n      .populate('senderId', 'firstName lastName profileImage')\n      .populate('recipientId', 'firstName lastName profileImage')\n      .sort({ score: { $meta: 'textScore' }, createdAt: -1 })\n      .skip(skip)\n      .limit(limit),\n    (Message as any).countDocuments(searchQuery)\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(messages, total, page, limit)\n  });\n});\n\n// Process scheduled messages (to be called by a cron job)\nexport const processScheduledMessages = catchAsync(async (req: Request, res: Response) => {\n  const scheduledMessages = await (Message as any).find({\n    messageType: 'scheduled',\n    scheduledSendTime: { $lte: new Date() },\n    messageStatus: 'scheduled'\n  })\n    .populate('senderId', 'firstName lastName')\n    .populate('recipientId', 'firstName lastName');\n\n  for (const message of scheduledMessages) {\n    await (message as any).send();\n    \n    // Send notification\n    await createAndSendNotification({\n      userId: message.recipientId.toString(),\n      title: 'Scheduled Message',\n      message: 'You have received a scheduled message',\n      type: 'general',\n      link: `/messages/${message._id}`,\n      metadata: {\n        messageId: message._id,\n        scheduled: true\n      }\n    });\n  }\n\n  res.json({\n    success: true,\n    message: `${scheduledMessages.length} scheduled messages processed`,\n    data: { processedCount: scheduledMessages.length }\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\notificationController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[595,598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[595,598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[818,821],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[818,821],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[940,943],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[940,943],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1267,1270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1267,1270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1630,1633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1630,1633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1918,1921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1918,1921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2547,2550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2547,2550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":115,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3494,3497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3494,3497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4055,4058],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4055,4058],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4441,4444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4441,4444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5201,5204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5201,5204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":189,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5688,5691],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5688,5691],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5774,5777],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5774,5777],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6178,6181],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6178,6181],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6246,6249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6246,6249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":204,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6329,6332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6329,6332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":249,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":249,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7551,7554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7551,7554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":259,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":259,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7881,7884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7881,7884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":276,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8458,8461],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8458,8461],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { Notification } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\n\n// Get user notifications\nexport const getUserNotifications = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { isRead, type } = req.query;\n\n  const query: Record<string, any> = { userId: req.user._id };\n\n  if (isRead !== undefined) {\n    query.isRead = isRead === 'true';\n  }\n\n  if (type) {\n    query.type = type;\n  }\n\n  const [notifications, total] = await Promise.all([\n    (Notification as any).find(query)\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(limit)\n      .lean(),\n    (Notification as any).countDocuments(query)\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(notifications, total, page, limit)\n  });\n});\n\n// Get unread notifications count\nexport const getUnreadNotificationsCount = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const count = await (Notification as any).countDocuments({\n    userId: req.user._id,\n    isRead: false\n  });\n\n  res.json({ success: true, data: { count } });\n});\n\n// Get unread notifications\nexport const getUnreadNotifications = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const limit = parseInt(req.query.limit as string) || 10;\n  const notifications = await (Notification as any).findUnread(req.user._id.toString(), limit);\n  res.json({ success: true, data: { notifications } });\n});\n\n// Mark notification as read\nexport const markNotificationAsRead = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const notification = await (Notification as any).findById(req.params.id);\n  if (!notification) {\n    throw createNotFoundError('Notification');\n  }\n\n  if (notification.userId.toString() !== req.user._id.toString()) {\n    throw createValidationError('authorization', 'You can only access your own notifications');\n  }\n\n  notification.markAsRead();\n  await notification.save();\n\n  res.json({\n    success: true,\n    message: 'Notification marked as read',\n    data: { notification }\n  });\n});\n\n// Mark notification as unread\nexport const markNotificationAsUnread = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const notification = await (Notification as any).findById(req.params.id);\n  if (!notification) {\n    throw createNotFoundError('Notification');\n  }\n\n  if (notification.userId.toString() !== req.user._id.toString()) {\n    throw createValidationError('authorization', 'You can only access your own notifications');\n  }\n\n  notification.markAsUnread();\n  await notification.save();\n\n  res.json({\n    success: true,\n    message: 'Notification marked as unread',\n    data: { notification }\n  });\n});\n\n// Mark all notifications as read\nexport const markAllNotificationsAsRead = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const result = await Notification.markAllAsRead(req.user._id.toString());\n  res.json({\n    success: true,\n    message: `${result.modifiedCount} notifications marked as read`\n  });\n});\n\n// Delete notification\nexport const deleteNotification = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const notification = await (Notification as any).findById(req.params.id);\n  if (!notification) {\n    throw createNotFoundError('Notification');\n  }\n\n  if (notification.userId.toString() !== req.user._id.toString()) {\n    throw createValidationError('authorization', 'You can only delete your own notifications');\n  }\n\n  await notification.deleteOne();\n  res.json({ success: true, message: 'Notification deleted successfully' });\n});\n\n// Delete all notifications\nexport const deleteAllNotifications = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const result = await (Notification as any).deleteMany({ userId: req.user._id });\n  res.json({\n    success: true,\n    message: `${result.deletedCount} notifications deleted`\n  });\n});\n\n// Create notification (admin only)\nexport const createNotification = catchAsync(async (req: Request, res: Response) => {\n  const { userId, title, message, type = 'general', link } = req.body;\n\n  const notification = await (Notification as any).createNotification({\n    userId,\n    title,\n    message,\n    type,\n    link\n  });\n\n  res.status(201).json({\n    success: true,\n    message: 'Notification created successfully',\n    data: { notification }\n  });\n});\n\n// Create bulk notifications (admin only)\nexport const createBulkNotifications = catchAsync(async (req: Request, res: Response) => {\n  const { userIds, title, message, type = 'general', link } = req.body;\n\n  if (!Array.isArray(userIds) || userIds.length === 0) {\n    throw createValidationError('userIds', 'User IDs array is required');\n  }\n\n  const notifications = userIds.map(userId => ({\n    userId,\n    title,\n    message,\n    type,\n    link,\n    isRead: false,\n    createdAt: new Date()\n  }));\n\n  const result = await (Notification as any).insertMany(notifications);\n\n  res.status(201).json({\n    success: true,\n    message: `${result.length} notifications created successfully`,\n    data: { count: result.length }\n  });\n});\n\n// Get notifications by type\nexport const getNotificationsByType = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { type } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const [notifications, total] = await Promise.all([\n    (Notification as any).findByType(req.user._id.toString(), type, { skip, limit }),\n    (Notification as any).countDocuments({ userId: req.user._id, type })\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(notifications, total, page, limit)\n  });\n});\n\n// Get notification statistics\nexport const getNotificationStatistics = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const [totalNotifications, unreadCount, typeStats] = await Promise.all([\n    (Notification as any).countDocuments({ userId: req.user._id }),\n    (Notification as any).countDocuments({ userId: req.user._id, isRead: false }),\n    (Notification as any).aggregate([\n      { $match: { userId: req.user._id } },\n      {\n        $group: {\n          _id: '$type',\n          count: { $sum: 1 },\n          unreadCount: {\n            $sum: { $cond: [{ $eq: ['$isRead', false] }, 1, 0] }\n          }\n        }\n      }\n    ])\n  ]);\n\n  const typeDistribution = typeStats.reduce((acc, { _id, count, unreadCount }) => {\n    acc[_id] = { total: count, unread: unreadCount };\n    return acc;\n  }, {});\n\n  res.json({\n    success: true,\n    data: {\n      totalNotifications,\n      unreadCount,\n      readCount: totalNotifications - unreadCount,\n      typeDistribution\n    }\n  });\n});\n\n// Clean up old notifications (admin only)\nexport const cleanupOldNotifications = catchAsync(async (req: Request, res: Response) => {\n  const days = parseInt(req.query.days as string) || 30;\n  const result = await Notification.deleteOldNotifications(days);\n\n  res.json({\n    success: true,\n    message: `${result.deletedCount} old notifications deleted`\n  });\n});\n\n// Get recent notifications\nexport const getRecentNotifications = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const limit = parseInt(req.query.limit as string) || 5;\n\n  const notifications = await (Notification as any).find({ userId: req.user._id })\n    .sort({ createdAt: -1 })\n    .limit(limit)\n    .lean();\n\n  res.json({ success: true, data: { notifications } });\n});\n\n// Get notification by ID\nexport const getNotificationById = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const notification = await (Notification as any).findById(req.params.id);\n  if (!notification) {\n    throw createNotFoundError('Notification');\n  }\n\n  if (notification.userId.toString() !== req.user._id.toString()) {\n    throw createValidationError('authorization', 'You can only access your own notifications');\n  }\n\n  res.json({ success: true, data: { notification } });\n});\n\n// Update notification\nexport const updateNotification = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { title, message, link } = req.body;\n\n  const notification = await (Notification as any).findById(id);\n  if (!notification) {\n    throw createNotFoundError('Notification');\n  }\n\n  if (notification.userId.toString() !== req.user._id.toString() && req.user.role !== 'admin') {\n    throw createValidationError('authorization', 'You can only update your own notifications');\n  }\n\n  Object.assign(notification, {\n    ...(title && { title }),\n    ...(message && { message }),\n    ...(link && { link })\n  });\n\n  await notification.save();\n\n  res.json({\n    success: true,\n    message: 'Notification updated successfully',\n    data: { notification }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\patientAppointmentController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Request' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Notification' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[811,814],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[811,814],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1132,1135],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1132,1135],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1494,1497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1494,1497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":56,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1725,1728],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1725,1728],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2142,2145],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2142,2145],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3536,3539],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3536,3539],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3778,3781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3778,3781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6104,6107],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6104,6107],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":254,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":254,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8796,8799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8796,8799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":264,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":264,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9125,9128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9125,9128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":285,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":285,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9791,9794],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9791,9794],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { Appointment, Patient, Notification } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  catchAsync,\n  createNotFoundError,\n  createValidationError,\n  createConflictError\n} from '../middleware/errorHandler';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\n\n// Get patient's appointments\nexport const getPatientAppointments = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n  const { status, startDate, endDate } = req.query;\n\n  // Verify patient exists and user has access\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Check if user is the patient or has access\n  if (req.user.role === 'patient' && req.user._id.toString() !== patient.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  const query: any = { patientId };\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  if (startDate || endDate) {\n    query.date = {};\n    if (startDate) {\n      query.date.$gte = new Date(startDate as string);\n    }\n    if (endDate) {\n      query.date.$lte = new Date(endDate as string);\n    }\n  }\n\n  const [appointments, total] = await Promise.all([\n    (Appointment as any).find(query)\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address phone')\n      .sort({ date: -1, timeSlot: 1 })\n      .skip(skip)\n      .limit(limit),\n    (Appointment as any).countDocuments(query)\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(appointments, total, page, limit)\n  });\n});\n\n// Modify appointment (reschedule)\nexport const modifyAppointment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { appointmentId } = req.params;\n  const { date, timeSlot, notes, reason } = req.body;\n\n  const appointment = await (Appointment as any).findById(appointmentId)\n    .populate('patientId', 'firstName lastName userId')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name');\n\n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n\n  // Check if user is the patient or has access\n  if (req.user.role === 'patient' && req.user._id.toString() !== appointment.patientId.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  // Check if appointment can be modified\n  if (!['scheduled', 'confirmed'].includes(appointment.status)) {\n    throw createValidationError('appointment', 'Only scheduled or confirmed appointments can be modified');\n  }\n\n  // Check if appointment is not too close (e.g., not within 2 hours)\n  const now = new Date();\n  const appointmentDateTime = new Date(appointment.date);\n  const [hours, minutes] = appointment.timeSlot.split(':').map(Number);\n  appointmentDateTime.setHours(hours, minutes);\n\n  const timeDifference = appointmentDateTime.getTime() - now.getTime();\n  const hoursUntilAppointment = timeDifference / (1000 * 60 * 60);\n\n  if (hoursUntilAppointment < 2) {\n    throw createValidationError('appointment', 'Cannot modify appointment less than 2 hours before scheduled time');\n  }\n\n  // If rescheduling, check for conflicts\n  if (date && timeSlot) {\n    const newDate = new Date(date);\n    const conflictQuery: any = {\n      dentistId: appointment.dentistId,\n      date: newDate,\n      timeSlot: timeSlot,\n      status: { $in: ['scheduled', 'confirmed'] },\n      _id: { $ne: appointmentId }\n    };\n\n    const existingAppointment = await (Appointment as any).findOne(conflictQuery);\n    if (existingAppointment) {\n      throw createConflictError('Time slot is already booked');\n    }\n  }\n\n  // Store original details for notification\n  const originalDate = appointment.date;\n  const originalTimeSlot = appointment.timeSlot;\n\n  // Update appointment\n  if (date) appointment.date = new Date(date);\n  if (timeSlot) appointment.timeSlot = timeSlot;\n  if (notes) appointment.notes = notes;\n  \n  appointment.status = 'scheduled'; // Reset to scheduled for confirmation\n  appointment.updatedAt = new Date();\n\n  await appointment.save();\n\n  // Send notification to dentist about the change\n  if (appointment.dentistId) {\n    await createAndSendNotification({\n      userId: appointment.dentistId._id.toString(),\n      title: 'Appointment Modified',\n      message: `${appointment.patientId.firstName} ${appointment.patientId.lastName} has modified their appointment from ${originalDate.toDateString()} ${originalTimeSlot} to ${appointment.date.toDateString()} ${appointment.timeSlot}`,\n      type: 'general',\n      link: `/appointments/${appointment._id}`,\n      metadata: {\n        appointmentId: appointment._id,\n        patientId: appointment.patientId._id,\n        originalDate: originalDate,\n        originalTime: originalTimeSlot,\n        newDate: appointment.date,\n        newTime: appointment.timeSlot,\n        reason: reason || 'Patient requested change'\n      }\n    });\n  }\n\n  // Send confirmation to patient\n  await createAndSendNotification({\n    userId: appointment.patientId.userId.toString(),\n    title: 'Appointment Modified',\n    message: `Your appointment has been rescheduled to ${appointment.date.toDateString()} at ${appointment.timeSlot}`,\n    type: 'general',\n    link: `/appointments/${appointment._id}`,\n    metadata: {\n      appointmentId: appointment._id,\n      clinicName: appointment.clinicId.name,\n      newDate: appointment.date,\n      newTime: appointment.timeSlot\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Appointment modified successfully',\n    data: { appointment }\n  });\n});\n\n// Cancel appointment\nexport const cancelAppointment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { appointmentId } = req.params;\n  const { reason, cancelledBy = 'patient' } = req.body;\n\n  const appointment = await (Appointment as any).findById(appointmentId)\n    .populate('patientId', 'firstName lastName userId')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name phone');\n\n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n\n  // Check if user is the patient or has access\n  if (req.user.role === 'patient' && req.user._id.toString() !== appointment.patientId.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  // Check if appointment can be cancelled\n  if (!['scheduled', 'confirmed'].includes(appointment.status)) {\n    throw createValidationError('appointment', 'Only scheduled or confirmed appointments can be cancelled');\n  }\n\n  // Update appointment status\n  appointment.status = 'cancelled';\n  appointment.cancellationReason = reason || 'Patient requested cancellation';\n  appointment.cancelledBy = cancelledBy;\n  appointment.cancelledAt = new Date();\n\n  await appointment.save();\n\n  // Send notification to dentist\n  if (appointment.dentistId) {\n    await createAndSendNotification({\n      userId: appointment.dentistId._id.toString(),\n      title: 'Appointment Cancelled',\n      message: `${appointment.patientId.firstName} ${appointment.patientId.lastName} has cancelled their appointment on ${appointment.date.toDateString()} at ${appointment.timeSlot}`,\n      type: 'appointment_cancellation',\n      link: `/appointments/${appointment._id}`,\n      metadata: {\n        appointmentId: appointment._id,\n        patientName: `${appointment.patientId.firstName} ${appointment.patientId.lastName}`,\n        date: appointment.date,\n        time: appointment.timeSlot,\n        reason: appointment.cancellationReason\n      }\n    });\n  }\n\n  // Send confirmation to patient\n  await createAndSendNotification({\n    userId: appointment.patientId.userId.toString(),\n    title: 'Appointment Cancelled',\n    message: `Your appointment on ${appointment.date.toDateString()} at ${appointment.timeSlot} has been cancelled`,\n    type: 'appointment_cancellation',\n    link: `/appointments`,\n    metadata: {\n      appointmentId: appointment._id,\n      clinicName: appointment.clinicId.name,\n      date: appointment.date,\n      time: appointment.timeSlot,\n      reason: appointment.cancellationReason\n    }\n  });\n\n  res.json({\n    success: true,\n    message: 'Appointment cancelled successfully',\n    data: { appointment }\n  });\n});\n\n// Get upcoming appointments for patient\nexport const getUpcomingAppointments = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { limit = 5 } = req.query;\n\n  // Verify patient exists and user has access\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  if (req.user.role === 'patient' && req.user._id.toString() !== patient.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  const now = new Date();\n  const appointments = await (Appointment as any).find({\n    patientId,\n    date: { $gte: now },\n    status: { $in: ['scheduled', 'confirmed'] }\n  })\n    .populate('dentistId', 'firstName lastName specialization')\n    .populate('clinicId', 'name address phone')\n    .sort({ date: 1, timeSlot: 1 })\n    .limit(Number(limit));\n\n  res.json({\n    success: true,\n    data: { appointments }\n  });\n});\n\n// Request appointment reminder\nexport const requestAppointmentReminder = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { appointmentId } = req.params;\n  const { reminderTime, channels } = req.body; // reminderTime in hours before appointment\n\n  const appointment = await (Appointment as any).findById(appointmentId)\n    .populate('patientId', 'firstName lastName userId');\n\n  if (!appointment) {\n    throw createNotFoundError('Appointment');\n  }\n\n  // Check if user is the patient\n  if (req.user.role === 'patient' && req.user._id.toString() !== appointment.patientId.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  // Update reminder preferences\n  if (reminderTime) {\n    if (!appointment.notificationPreferences.reminderTimes.includes(reminderTime)) {\n      appointment.notificationPreferences.reminderTimes.push(reminderTime);\n    }\n  }\n\n  if (channels) {\n    if (channels.email !== undefined) appointment.notificationPreferences.channels.email = channels.email;\n    if (channels.sms !== undefined) appointment.notificationPreferences.channels.sms = channels.sms;\n    if (channels.inApp !== undefined) appointment.notificationPreferences.channels.inApp = channels.inApp;\n  }\n\n  await appointment.save();\n\n  res.json({\n    success: true,\n    message: 'Reminder preferences updated successfully',\n    data: { \n      reminderTimes: appointment.notificationPreferences.reminderTimes,\n      channels: appointment.notificationPreferences.channels\n    }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\patientController.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[585,588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[585,588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1189,1192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1189,1192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1327,1330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1327,1330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1755,1758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1755,1758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2378,2381],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2378,2381],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2588,2591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2588,2591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3320,3323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3320,3323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3842,3845],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3842,3845],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":167,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4020,4023],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4020,4023],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":186,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4494,4497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4494,4497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":209,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5147,5150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5147,5150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":229,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":229,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5717,5720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5717,5720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":266,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":266,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6671,6674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6671,6674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":271,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":271,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6842,6845],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6842,6845],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":294,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7561,7564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7561,7564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":299,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7692,7695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7692,7695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":315,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":315,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8142,8145],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8142,8145],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":333,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":333,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8609,8612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8609,8612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8654,8657],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8654,8657],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":338,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":338,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8781,8784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8781,8784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":359,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":359,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9272,9275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9272,9275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":373,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":373,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9574,9577],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9574,9577],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":387,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":387,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9977,9980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9977,9980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":23,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\r\nimport Patient from '../models/Patient';\r\nimport { asyncHandler } from '../utils/asyncHandler';\r\nimport { AppError } from '../utils/AppError';\r\n\r\n// Get all patients\r\nexport const getPatients = asyncHandler(async (req: Request, res: Response) => {\r\n  const { \r\n    page = 1, \r\n    limit = 10, \r\n    search, \r\n    status,\r\n    dateFrom,\r\n    dateTo \r\n  } = req.query;\r\n\r\n  const pageNum = parseInt(page as string);\r\n  const limitNum = parseInt(limit as string);\r\n  const skip = (pageNum - 1) * limitNum;\r\n\r\n  // Build query\r\n  const query: any = {};\r\n  \r\n  if (search) {\r\n    query.$or = [\r\n      { firstName: { $regex: search, $options: 'i' } },\r\n      { lastName: { $regex: search, $options: 'i' } },\r\n      { email: { $regex: search, $options: 'i' } },\r\n      { phone: { $regex: search, $options: 'i' } }\r\n    ];\r\n  }\r\n\r\n  if (status) {\r\n    query.status = status;\r\n  }\r\n\r\n  if (dateFrom || dateTo) {\r\n    query.createdAt = {};\r\n    if (dateFrom) query.createdAt.$gte = new Date(dateFrom as string);\r\n    if (dateTo) query.createdAt.$lte = new Date(dateTo as string);\r\n  }\r\n\r\n  const [patients, total] = await Promise.all([\r\n    (Patient as any).find(query)\r\n      .sort({ createdAt: -1 })\r\n      .skip(skip)\r\n      .limit(limitNum)\r\n      .select('-password'),\r\n    (Patient as any).countDocuments(query)\r\n  ]);\r\n\r\n  res.status(200).json({\r\n    success: true,\r\n    data: patients,\r\n    pagination: {\r\n      page: pageNum,\r\n      limit: limitNum,\r\n      pages: Math.ceil(total / limitNum),\r\n      total\r\n    }\r\n  });\r\n});\r\n\r\n// Get single patient by ID\r\nexport const getPatientById = asyncHandler(async (req: Request, res: Response) => {\r\n  const { id } = req.params;\r\n\r\n  const patient = await (Patient as any).findById(id).select('-password');\r\n  \r\n  if (!patient) {\r\n    throw new AppError('Patient not found', 404);\r\n  }\r\n\r\n  res.status(200).json({\r\n    success: true,\r\n    data: patient\r\n  });\r\n});\r\n\r\n// Create new patient\r\nexport const createPatient = asyncHandler(async (req: Request, res: Response) => {\r\n  const {\r\n    firstName,\r\n    lastName,\r\n    email,\r\n    phone,\r\n    dateOfBirth,\r\n    gender,\r\n    address,\r\n    emergencyContact,\r\n    medicalHistory,\r\n    allergies,\r\n    currentMedications,\r\n    insuranceInfo\r\n  } = req.body;\r\n\r\n  // Check if patient already exists\r\n  const existingPatient = await (Patient as any).findOne({ \r\n    $or: [{ email }, { phone }] \r\n  });\r\n\r\n  if (existingPatient) {\r\n    throw new AppError('Patient with this email or phone already exists', 400);\r\n  }\r\n\r\n  const patient = await (Patient as any).create({\r\n    firstName,\r\n    lastName,\r\n    email,\r\n    phone,\r\n    dateOfBirth,\r\n    gender,\r\n    address,\r\n    emergencyContact,\r\n    medicalHistory,\r\n    allergies,\r\n    currentMedications,\r\n    insuranceInfo,\r\n    status: 'active'\r\n  });\r\n\r\n  res.status(201).json({\r\n    success: true,\r\n    data: patient,\r\n    message: 'Patient created successfully'\r\n  });\r\n});\r\n\r\n// Update patient\r\nexport const updatePatient = asyncHandler(async (req: Request, res: Response) => {\r\n  console.log('REQ', req);\r\n  const { id } = req.params;\r\n  const updateData = req.body;\r\n  console.log('final', updateData);\r\n  // Remove sensitive fields\r\n  delete updateData.password;\r\n  delete updateData.role;\r\n\r\n  const patient = await (Patient as any).findByIdAndUpdate(\r\n    id,\r\n    { ...updateData, updatedAt: new Date() },\r\n    { new: true, runValidators: true }\r\n  ).select('-password');\r\n\r\n  if (!patient) {\r\n    throw new AppError('Patient not found', 404);\r\n  }\r\n\r\n  res.status(200).json({\r\n    success: true,\r\n    data: patient,\r\n    message: 'Patient updated successfully'\r\n  });\r\n});\r\n\r\n// Delete patient\r\nexport const deletePatient = asyncHandler(async (req: Request, res: Response) => {\r\n  const { id } = req.params;\r\n\r\n  const patient = await (Patient as any).findById(id);\r\n  \r\n  if (!patient) {\r\n    throw new AppError('Patient not found', 404);\r\n  }\r\n\r\n  // Soft delete - mark as inactive instead of removing\r\n  await (Patient as any).findByIdAndUpdate(id, { status: 'inactive' });\r\n\r\n  res.status(200).json({\r\n    success: true,\r\n    message: 'Patient deleted successfully'\r\n  });\r\n});\r\n\r\n// Search patients\r\nexport const searchPatients = asyncHandler(async (req: Request, res: Response) => {\r\n  const { q, limit = 10 } = req.query;\r\n\r\n  if (!q) {\r\n    return res.status(400).json({\r\n      success: false,\r\n      message: 'Search query is required'\r\n    });\r\n  }\r\n\r\n  const patients = await (Patient as any).find({\r\n    $or: [\r\n      { firstName: { $regex: q, $options: 'i' } },\r\n      { lastName: { $regex: q, $options: 'i' } },\r\n      { email: { $regex: q, $options: 'i' } },\r\n      { phone: { $regex: q, $options: 'i' } }\r\n    ],\r\n    status: 'active'\r\n  })\r\n  .limit(parseInt(limit as string))\r\n  .select('firstName lastName email phone')\r\n  .sort({ firstName: 1 });\r\n\r\n  return res.status(200).json({\r\n    success: true,\r\n    data: patients\r\n  });\r\n});\r\n\r\n// Get patient medical history\r\nexport const getPatientMedicalHistory = asyncHandler(async (req: Request, res: Response) => {\r\n  const { id } = req.params;\r\n\r\n  const patient = await (Patient as any).findById(id)\r\n    .select('medicalHistory allergies currentMedications')\r\n    .populate('appointments')\r\n    .populate('treatments');\r\n\r\n  if (!patient) {\r\n    throw new AppError('Patient not found', 404);\r\n  }\r\n\r\n  res.status(200).json({\r\n    success: true,\r\n    data: patient\r\n  });\r\n});\r\n\r\n// Update patient medical history\r\nexport const updatePatientMedicalHistory = asyncHandler(async (req: Request, res: Response) => {\r\n  const { id } = req.params;\r\n  const { medicalHistory, allergies, currentMedications } = req.body;\r\n\r\n  const patient = await (Patient as any).findByIdAndUpdate(\r\n    id,\r\n    {\r\n      medicalHistory,\r\n      allergies,\r\n      currentMedications,\r\n      updatedAt: new Date()\r\n    },\r\n    { new: true, runValidators: true }\r\n  ).select('-password');\r\n\r\n  if (!patient) {\r\n    throw new AppError('Patient not found', 404);\r\n  }\r\n\r\n  res.status(200).json({\r\n    success: true,\r\n    data: patient,\r\n    message: 'Medical history updated successfully'\r\n  });\r\n});\r\n\r\n// Get patients by user ID\r\nexport const getPatientsByUserId = asyncHandler(async (req: Request, res: Response) => {\r\n  const { userId } = req.params;\r\n  const { \r\n    page = 1, \r\n    limit = 10 \r\n  } = req.query;\r\n\r\n  const pageNum = parseInt(page as string);\r\n  const limitNum = parseInt(limit as string);\r\n  const skip = (pageNum - 1) * limitNum;\r\n\r\n  try {\r\n    console.log(`Fetching patients for userId: ${userId}, page: ${pageNum}, limit: ${limitNum}`);\r\n    const [patients, total] = await Promise.all([\r\n      (Patient as any).find({ userId })\r\n        .sort({ createdAt: -1 })\r\n        .skip(skip)\r\n        .limit(limitNum)\r\n        .populate('preferredClinicId', 'name'),\r\n      (Patient as any).countDocuments({ userId })\r\n    ]);\r\n    console.log(`Found ${patients.length} patients for userId: ${userId}`);\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      data: patients,\r\n      total,\r\n      page: pageNum,\r\n      totalPages: Math.ceil(total / limitNum),\r\n      message: `Found ${patients.length} patient(s) for user`\r\n    });\r\n  } catch (error) {\r\n    console.error('Error fetching patients:', error);\r\n    throw new AppError('Failed to fetch patients', 500);\r\n  }\r\n});\r\n\r\n// Get recent patients\r\nexport const getRecentPatients = asyncHandler(async (req: Request, res: Response) => {\r\n  const { clinicId, limit = 10 } = req.query;\r\n  const limitNum = parseInt(limit as string);\r\n\r\n  const query: any = { isActive: true };\r\n  if (clinicId) {\r\n    query.preferredClinicId = clinicId;\r\n  }\r\n\r\n  const patients = await (Patient as any).find(query)\r\n    .sort({ createdAt: -1 })\r\n    .limit(limitNum)\r\n    .select('firstName lastName email phone createdAt preferredClinicId')\r\n    .populate('preferredClinicId', 'name');\r\n\r\n  res.json({\r\n    success: true,\r\n    data: patients\r\n  });\r\n});\r\n\r\n// Get patient statistics\r\nexport const getPatientStatistics = asyncHandler(async (req: Request, res: Response) => {\r\n  const { clinicId, startDate, endDate } = req.query;\r\n\r\n  const query: any = { isActive: true };\r\n  if (clinicId) {\r\n    query.preferredClinicId = clinicId;\r\n  }\r\n\r\n  // Date range filter\r\n  if (startDate || endDate) {\r\n    query.createdAt = {};\r\n    if (startDate) query.createdAt.$gte = new Date(startDate as string);\r\n    if (endDate) query.createdAt.$lte = new Date(endDate as string);\r\n  }\r\n\r\n  const [\r\n    totalPatients,\r\n    patientsByGender,\r\n    patientsByAgeGroup,\r\n    newThisMonth\r\n  ] = await Promise.all([\r\n    (Patient as any).countDocuments(query),\r\n    (Patient as any).aggregate([\r\n      { $match: query },\r\n      { $group: { _id: '$gender', count: { $sum: 1 } } }\r\n    ]),\r\n    (Patient as any).aggregate([\r\n      { $match: query },\r\n      {\r\n        $addFields: {\r\n          age: {\r\n            $divide: [\r\n              { $subtract: [new Date(), '$dateOfBirth'] },\r\n              365.25 * 24 * 60 * 60 * 1000\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      {\r\n        $bucket: {\r\n          groupBy: '$age',\r\n          boundaries: [0, 18, 35, 50, 65, 100],\r\n          default: '65+',\r\n          output: { count: { $sum: 1 } }\r\n        }\r\n      }\r\n    ]),\r\n    (Patient as any).countDocuments({\r\n      ...query,\r\n      createdAt: {\r\n        $gte: new Date(new Date().getFullYear(), new Date().getMonth(), 1)\r\n      }\r\n    })\r\n  ]);\r\n\r\n  // Format gender statistics\r\n  const genderStats = {\r\n    male: 0,\r\n    female: 0,\r\n    other: 0\r\n  };\r\n  patientsByGender.forEach((stat: any) => {\r\n    if (stat._id === 'male') genderStats.male = stat.count;\r\n    else if (stat._id === 'female') genderStats.female = stat.count;\r\n    else if (stat._id === 'other') genderStats.other = stat.count;\r\n  });\r\n\r\n  // Format age group statistics\r\n  const ageGroupStats = {\r\n    '0-18': 0,\r\n    '19-35': 0,\r\n    '36-50': 0,\r\n    '51-65': 0,\r\n    '65+': 0\r\n  };\r\n  patientsByAgeGroup.forEach((stat: any) => {\r\n    if (stat._id === 0) ageGroupStats['0-18'] = stat.count;\r\n    else if (stat._id === 18) ageGroupStats['19-35'] = stat.count;\r\n    else if (stat._id === 35) ageGroupStats['36-50'] = stat.count;\r\n    else if (stat._id === 50) ageGroupStats['51-65'] = stat.count;\r\n    else if (stat._id === '65+') ageGroupStats['65+'] = stat.count;\r\n  });\r\n\r\n  res.json({\r\n    success: true,\r\n    data: {\r\n      total: totalPatients,\r\n      newThisMonth,\r\n      byGender: genderStats,\r\n      byAgeGroup: ageGroupStats\r\n    }\r\n  });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\patientFileController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[693,696],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[693,696],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1099,1102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1099,1102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":221,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":221,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":363,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9533,9536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9533,9536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Response } from 'express';\nimport { AuthenticatedRequest } from '../types';\nimport { catchAsync, AppError } from '../middleware/errorHandler';\nimport PatientFile from '../models/PatientFile';\nimport Patient from '../models/Patient';\nimport multer from 'multer';\nimport path from 'path';\nimport fs from 'fs/promises';\nimport crypto from 'crypto';\n\n// Configure multer for file uploads with HIPAA-compliant restrictions\nconst storage = multer.diskStorage({\n  destination: async (req, file, cb) => {\n    const uploadDir = path.join(process.cwd(), 'uploads', 'patient-files');\n    try {\n      await fs.mkdir(uploadDir, { recursive: true });\n      cb(null, uploadDir);\n    } catch (error: any) {\n      cb(error, uploadDir);\n    }\n  },\n  filename: (req, file, cb) => {\n    // Generate secure random filename\n    const uniqueSuffix = `${Date.now()}-${crypto.randomBytes(16).toString('hex')}`;\n    const ext = path.extname(file.originalname);\n    cb(null, `patient-file-${uniqueSuffix}${ext}`);\n  }\n});\n\n// File filter for security - only allow specific medical file types\nconst fileFilter = (req: any, file: Express.Multer.File, cb: multer.FileFilterCallback) => {\n  const allowedMimes = [\n    'image/jpeg',\n    'image/jpg',\n    'image/png',\n    'image/gif',\n    'image/bmp',\n    'image/tiff',\n    'application/pdf',\n    'application/dicom', // DICOM medical imaging format\n    'text/plain',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n  ];\n\n  if (allowedMimes.includes(file.mimetype)) {\n    cb(null, true);\n  } else {\n    cb(new Error(`File type ${file.mimetype} is not allowed for medical records`));\n  }\n};\n\nexport const upload = multer({\n  storage,\n  fileFilter,\n  limits: {\n    fileSize: 50 * 1024 * 1024 // 50MB max file size\n  }\n});\n\n/**\n * Upload patient file (X-ray, scan, note, etc.)\n * POST /api/patients/:patientId/files\n */\nexport const uploadPatientFile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { fileType, title, description, category, tags, captureDate, appointmentId, metadata } = req.body;\n  \n  if (!req.file) {\n    return res.status(400).json({\n      success: false,\n      message: 'No file uploaded'\n    });\n  }\n\n  // Verify patient exists\n  const patient = await Patient.findById(patientId);\n  if (!patient) {\n    // Clean up uploaded file\n    await fs.unlink(req.file.path);\n    return res.status(404).json({\n      success: false,\n      message: 'Patient not found'\n    });\n  }\n\n  // Encrypt file (basic encryption - in production use proper encryption)\n  const encryptionKey = crypto.randomBytes(32).toString('hex');\n  \n  // Create file record\n  const patientFile = await PatientFile.create({\n    patientId,\n    clinicId: req.user.clinicId || patient.preferredClinicId,\n    uploadedBy: req.user._id,\n    appointmentId: appointmentId || undefined,\n    fileType,\n    fileName: req.file.filename,\n    originalFileName: req.file.originalname,\n    fileUrl: `/uploads/patient-files/${req.file.filename}`,\n    fileSize: req.file.size,\n    mimeType: req.file.mimetype,\n    title,\n    description,\n    category,\n    tags: tags ? (Array.isArray(tags) ? tags : tags.split(',').map((t: string) => t.trim())) : [],\n    captureDate: captureDate ? new Date(captureDate) : undefined,\n    metadata: metadata ? JSON.parse(metadata) : {},\n    isEncrypted: true,\n    encryptionKey\n  });\n\n  // Log access\n  await PatientFile.logAccess(\n    patientFile._id.toString(),\n    req.user._id.toString(),\n    'view',\n    req.ip\n  );\n\n  res.status(201).json({\n    success: true,\n    message: 'File uploaded successfully',\n    data: patientFile\n  });\n});\n\n/**\n * Get all files for a patient\n * GET /api/patients/:patientId/files\n */\nexport const getPatientFiles = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { fileType, startDate, endDate, page = '1', limit = '50' } = req.query;\n\n  const pageNum = parseInt(page as string);\n  const limitNum = parseInt(limit as string);\n\n  const files = await PatientFile.findByPatient(patientId, {\n    fileType,\n    startDate,\n    endDate,\n    skip: (pageNum - 1) * limitNum,\n    limit: limitNum\n  });\n\n  const total = await PatientFile.countDocuments({\n    patientId,\n    isDeleted: false,\n    ...(fileType && { fileType })\n  });\n\n  res.json({\n    success: true,\n    message: 'Patient files retrieved successfully',\n    data: {\n      files,\n      pagination: {\n        page: pageNum,\n        limit: limitNum,\n        total,\n        totalPages: Math.ceil(total / limitNum)\n      }\n    }\n  });\n});\n\n/**\n * Get single file details\n * GET /api/patient-files/:id\n */\nexport const getPatientFile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const file = await PatientFile.findOne({ _id: id, isDeleted: false })\n    .populate('patientId', 'firstName lastName email')\n    .populate('uploadedBy', 'firstName lastName email')\n    .populate('clinicId', 'name address')\n    .populate('appointmentId', 'date timeSlot');\n\n  if (!file) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found'\n    });\n  }\n\n  // Log access\n  await PatientFile.logAccess(id, req.user._id.toString(), 'view', req.ip);\n\n  res.json({\n    success: true,\n    message: 'File details retrieved successfully',\n    data: file\n  });\n});\n\n/**\n * Download patient file\n * GET /api/patient-files/:id/download\n */\nexport const downloadPatientFile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const file = await PatientFile.findOne({ _id: id, isDeleted: false });\n\n  if (!file) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found'\n    });\n  }\n\n  // Log download access\n  await PatientFile.logAccess(id, req.user._id.toString(), 'download', req.ip);\n\n  const filePath = path.join(process.cwd(), 'uploads', 'patient-files', file.fileName);\n\n  // Check if file exists\n  try {\n    await fs.access(filePath);\n  } catch (error) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found on server'\n    });\n  }\n\n  res.download(filePath, file.originalFileName);\n});\n\n/**\n * Update file metadata\n * PATCH /api/patient-files/:id\n */\nexport const updatePatientFile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { title, description, category, tags, metadata } = req.body;\n\n  const file = await PatientFile.findOne({ _id: id, isDeleted: false });\n\n  if (!file) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found'\n    });\n  }\n\n  // Update allowed fields\n  if (title) file.title = title;\n  if (description !== undefined) file.description = description;\n  if (category) file.category = category;\n  if (tags) file.tags = Array.isArray(tags) ? tags : tags.split(',').map((t: string) => t.trim());\n  if (metadata) file.metadata = { ...file.metadata, ...metadata };\n\n  await file.save();\n\n  res.json({\n    success: true,\n    message: 'File updated successfully',\n    data: file\n  });\n});\n\n/**\n * Delete patient file (soft delete)\n * DELETE /api/patient-files/:id\n */\nexport const deletePatientFile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const file = await PatientFile.findOne({ _id: id, isDeleted: false });\n\n  if (!file) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found'\n    });\n  }\n\n  // Soft delete\n  await file.softDelete(req.user._id);\n\n  res.json({\n    success: true,\n    message: 'File deleted successfully',\n    data: { id }\n  });\n});\n\n/**\n * Share file with another user\n * POST /api/patient-files/:id/share\n */\nexport const sharePatientFile = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { userId, permissions, expiresAt } = req.body;\n\n  const file = await PatientFile.findOne({ _id: id, isDeleted: false });\n\n  if (!file) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found'\n    });\n  }\n\n  // Share with user\n  await file.shareWith(\n    userId,\n    permissions || ['view'],\n    expiresAt ? new Date(expiresAt) : undefined\n  );\n\n  // Log sharing action\n  await PatientFile.logAccess(id, req.user._id.toString(), 'share', req.ip);\n\n  res.json({\n    success: true,\n    message: 'File shared successfully',\n    data: file\n  });\n});\n\n/**\n * Get file access log\n * GET /api/patient-files/:id/access-log\n */\nexport const getFileAccessLog = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const file = await PatientFile.findOne({ _id: id, isDeleted: false })\n    .populate('accessLog.userId', 'firstName lastName email')\n    .select('+accessLog');\n\n  if (!file) {\n    return res.status(404).json({\n      success: false,\n      message: 'File not found'\n    });\n  }\n\n  res.json({\n    success: true,\n    message: 'Access log retrieved successfully',\n    data: {\n      fileId: file._id,\n      fileName: file.originalFileName,\n      accessLog: file.accessLog\n    }\n  });\n});\n\n/**\n * Search patient files\n * GET /api/patient-files/search\n */\nexport const searchPatientFiles = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { q, patientId, clinicId, fileType, page = '1', limit = '20' } = req.query;\n\n  const pageNum = parseInt(page as string);\n  const limitNum = parseInt(limit as string);\n\n  const query: any = { isDeleted: false };\n\n  // Text search\n  if (q) {\n    query.$text = { $search: q as string };\n  }\n\n  // Filters\n  if (patientId) query.patientId = patientId;\n  if (clinicId) query.clinicId = clinicId;\n  if (fileType) query.fileType = fileType;\n\n  const files = await PatientFile.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('uploadedBy', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .sort({ uploadDate: -1 })\n    .skip((pageNum - 1) * limitNum)\n    .limit(limitNum);\n\n  const total = await PatientFile.countDocuments(query);\n\n  res.json({\n    success: true,\n    message: 'Search completed successfully',\n    data: {\n      files,\n      pagination: {\n        page: pageNum,\n        limit: limitNum,\n        total,\n        totalPages: Math.ceil(total / limitNum)\n      }\n    }\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\patientMedicalController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Request' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Medication' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":14,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[474,477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[474,477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1361,1364],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1361,1364],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1705,1708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1705,1708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2211,2214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2211,2214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2541,2544],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2541,2544],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2966,2969],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2966,2969],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3368,3371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3368,3371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3782,3785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3782,3785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4087,4090],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4087,4090],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":146,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":146,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4486,4489],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4486,4489],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5440,5443],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5440,5443],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":208,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6532,6535],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6532,6535],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":220,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":220,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6954,6957],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6954,6957],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":252,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":252,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7782,7785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7782,7785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8646,8649],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8646,8649],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":294,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9109,9112],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9109,9112],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9159,9162],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9159,9162],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":299,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9268,9271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9268,9271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":300,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":300,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9331,9334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9331,9334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":318,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9875,9878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9875,9878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":319,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9928,9931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9928,9931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":21,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { Patient, Prescription, Medication } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\n\n// Get patient's medical record\nexport const getPatientMedicalRecord = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n\n  const patient = await (Patient as any).findById(patientId)\n    .populate('medicationHistory.prescribedBy', 'firstName lastName specialization')\n    .populate('medicalHistory.updatedBy', 'firstName lastName');\n\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Check if user has access to this patient's records\n  if (req.user.role === 'patient' && req.user._id.toString() !== patient.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied to medical records');\n  }\n\n  res.json({\n    success: true,\n    data: {\n      medicalHistory: patient.medicalHistory,\n      medicationHistory: patient.medicationHistory\n    }\n  });\n});\n\n// Update patient's medical record\nexport const updatePatientMedicalRecord = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const updateData = req.body;\n\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Only healthcare providers can update medical records\n  if (!['admin', 'dentist', 'staff'].includes(req.user.role)) {\n    throw createValidationError('authorization', 'Only healthcare providers can update medical records');\n  }\n\n  await (patient as any).updateMedicalRecord(updateData, req.user._id);\n\n  res.json({\n    success: true,\n    message: 'Medical record updated successfully',\n    data: {\n      medicalHistory: patient.medicalHistory\n    }\n  });\n});\n\n// Add medication to patient's history\nexport const addMedicationToHistory = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const medicationData = {\n    ...req.body,\n    prescribedBy: req.user._id\n  };\n\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Only healthcare providers can add medications\n  if (!['admin', 'dentist', 'staff'].includes(req.user.role)) {\n    throw createValidationError('authorization', 'Only healthcare providers can add medications');\n  }\n\n  await (patient as any).addMedicationToHistory(medicationData);\n\n  res.json({\n    success: true,\n    message: 'Medication added to history successfully',\n    data: {\n      medicationHistory: patient.medicationHistory\n    }\n  });\n});\n\n// Get patient's active medications\nexport const getActiveMedications = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n\n  const patient = await (Patient as any).findById(patientId)\n    .populate('medicationHistory.prescribedBy', 'firstName lastName specialization');\n\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Check access\n  if (req.user.role === 'patient' && req.user._id.toString() !== patient.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  const activeMedications = (patient as any).getActiveMedications();\n\n  res.json({\n    success: true,\n    data: { activeMedications }\n  });\n});\n\n// Get patient's prescriptions\nexport const getPatientPrescriptions = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { status, limit = 10, skip = 0 } = req.query;\n\n  // Verify patient exists and user has access\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  if (req.user.role === 'patient' && req.user._id.toString() !== patient.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  const prescriptions = await (Prescription as any).findByPatient(patientId, {\n    status,\n    limit: Number(limit),\n    skip: Number(skip)\n  });\n\n  res.json({\n    success: true,\n    data: { prescriptions }\n  });\n});\n\n// Get specific prescription details\nexport const getPrescriptionDetails = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { prescriptionId } = req.params;\n\n  const prescription = await (Prescription as any).findById(prescriptionId)\n    .populate('patientId', 'firstName lastName userId')\n    .populate('dentistId', 'firstName lastName specialization')\n    .populate('clinicId', 'name address phone')\n    .populate('medications.medicationId', 'name genericName category instructions warnings');\n\n  if (!prescription) {\n    throw createNotFoundError('Prescription');\n  }\n\n  // Check access\n  if (req.user.role === 'patient' && req.user._id.toString() !== prescription.patientId.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied to prescription details');\n  }\n\n  res.json({\n    success: true,\n    data: { prescription }\n  });\n});\n\n// Update medication status in patient's history\nexport const updateMedicationStatus = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId, medicationHistoryId } = req.params;\n  const { status, reason, notes } = req.body;\n\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Only healthcare providers can update medication status\n  if (!['admin', 'dentist', 'staff'].includes(req.user.role)) {\n    throw createValidationError('authorization', 'Only healthcare providers can update medication status');\n  }\n\n  const medication = patient.medicationHistory.id(medicationHistoryId);\n  if (!medication) {\n    throw createNotFoundError('Medication record');\n  }\n\n  medication.status = status;\n  if (reason) medication.reason = reason;\n  if (notes) medication.notes = notes;\n  if (status === 'completed' || status === 'discontinued') {\n    medication.endDate = new Date();\n  }\n\n  await patient.save();\n\n  res.json({\n    success: true,\n    message: 'Medication status updated successfully',\n    data: { medication }\n  });\n});\n\n// Add allergy to patient's record\nexport const addAllergy = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { allergen, severity, reaction } = req.body;\n\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Only healthcare providers can add allergies\n  if (!['admin', 'dentist', 'staff'].includes(req.user.role)) {\n    throw createValidationError('authorization', 'Only healthcare providers can add allergies');\n  }\n\n  // Check if allergy already exists\n  const existingAllergy = patient.medicalHistory.allergies.find(\n    (allergy: any) => allergy.allergen.toLowerCase() === allergen.toLowerCase()\n  );\n\n  if (existingAllergy) {\n    throw createValidationError('allergy', 'This allergy is already recorded');\n  }\n\n  patient.medicalHistory.allergies.push({\n    allergen,\n    severity: severity || 'moderate',\n    reaction,\n    dateIdentified: new Date()\n  });\n\n  patient.medicalHistory.lastUpdated = new Date();\n  patient.medicalHistory.updatedBy = req.user._id;\n\n  await patient.save();\n\n  res.json({\n    success: true,\n    message: 'Allergy added successfully',\n    data: {\n      allergies: patient.medicalHistory.allergies\n    }\n  });\n});\n\n// Remove allergy from patient's record\nexport const removeAllergy = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId, allergyId } = req.params;\n\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Only healthcare providers can remove allergies\n  if (!['admin', 'dentist', 'staff'].includes(req.user.role)) {\n    throw createValidationError('authorization', 'Only healthcare providers can remove allergies');\n  }\n\n  patient.medicalHistory.allergies.pull(allergyId);\n  patient.medicalHistory.lastUpdated = new Date();\n  patient.medicalHistory.updatedBy = req.user._id;\n\n  await patient.save();\n\n  res.json({\n    success: true,\n    message: 'Allergy removed successfully',\n    data: {\n      allergies: patient.medicalHistory.allergies\n    }\n  });\n});\n\n// Get medication reminders for patient\nexport const getMedicationReminders = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n\n  const patient = await (Patient as any).findById(patientId)\n    .populate('medicationHistory.prescribedBy', 'firstName lastName');\n\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  // Check access\n  if (req.user.role === 'patient' && req.user._id.toString() !== patient.userId?.toString()) {\n    throw createValidationError('authorization', 'Access denied');\n  }\n\n  // Get active prescriptions for detailed medication schedule\n  const activePrescriptions = await (Prescription as any).findActive(patientId);\n  \n  const reminders: any[] = [];\n  \n  // Process current medications from medical history\n  const activeMedications = (patient as any).getActiveMedications();\n  activeMedications.forEach((med: any) => {\n    if (med.frequency) {\n      // Parse frequency to create reminders (simple implementation)\n      const times = parseFrequencyToTimes(med.frequency);\n      times.forEach((time: string) => {\n        reminders.push({\n          medicationName: med.medicationName,\n          dosage: med.dosage,\n          time: time,\n          frequency: med.frequency,\n          notes: med.notes,\n          prescribedBy: med.prescribedBy\n        });\n      });\n    }\n  });\n\n  // Process active prescriptions\n  activePrescriptions.forEach((prescription: any) => {\n    prescription.medications.forEach((med: any) => {\n      if (med.frequency) {\n        const times = parseFrequencyToTimes(med.frequency);\n        times.forEach((time: string) => {\n          reminders.push({\n            prescriptionId: prescription._id,\n            medicationName: med.medicationId.name,\n            dosage: med.dosage,\n            time: time,\n            frequency: med.frequency,\n            instructions: med.instructions,\n            startDate: med.startDate,\n            endDate: med.endDate\n          });\n        });\n      }\n    });\n  });\n\n  res.json({\n    success: true,\n    data: { reminders: reminders.sort((a, b) => a.time.localeCompare(b.time)) }\n  });\n});\n\n// Helper function to parse medication frequency to reminder times\nfunction parseFrequencyToTimes(frequency: string): string[] {\n  const times: string[] = [];\n  \n  // Simple frequency parsing - can be enhanced\n  const freq = frequency.toLowerCase();\n  \n  if (freq.includes('once') || freq.includes('1 time') || freq.includes('daily')) {\n    times.push('08:00'); // Morning\n  } else if (freq.includes('twice') || freq.includes('2 times') || freq.includes('bid')) {\n    times.push('08:00', '20:00'); // Morning and evening\n  } else if (freq.includes('three times') || freq.includes('3 times') || freq.includes('tid')) {\n    times.push('08:00', '14:00', '20:00'); // Morning, afternoon, evening\n  } else if (freq.includes('four times') || freq.includes('4 times') || freq.includes('qid')) {\n    times.push('08:00', '12:00', '16:00', '20:00'); // Every 6 hours\n  } else if (freq.includes('every 8 hours')) {\n    times.push('08:00', '16:00', '00:00');\n  } else if (freq.includes('every 6 hours')) {\n    times.push('06:00', '12:00', '18:00', '00:00');\n  } else if (freq.includes('every 4 hours')) {\n    times.push('08:00', '12:00', '16:00', '20:00', '00:00', '04:00');\n  } else {\n    // Default to morning if frequency not recognized\n    times.push('08:00');\n  }\n  \n  return times;\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\patientReportController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Request' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":17},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":38,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":38,"endColumn":19,"fix":{"range":[1156,1187],"text":"const query: any = { patientId };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1167,1170],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1167,1170],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2032,2035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2032,2035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3756,3759],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3756,3759],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5344,5347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5344,5347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":229,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":229,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6545,6548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6545,6548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":275,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":275,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7822,7825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7822,7825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport PatientReport from '../models/PatientReport';\nimport Patient from '../models/Patient';\nimport { AuthenticatedRequest } from '../types';\nimport { ApiResponse } from '../types';\n\n// Get patient reports\nexport const getPatientReports = async (req: AuthenticatedRequest, res: Response) => {\n  try {\n    const { id: patientId } = req.params;\n    const { page = 1, limit = 10, search } = req.query;\n    \n    // Check if patient exists\n    const patient = await Patient.findById(patientId);\n    if (!patient) {\n      return res.status(404).json({\n        success: false,\n        message: 'Patient not found'\n      } as ApiResponse);\n    }\n\n    // Check access permissions\n    const user = req.user;\n    const hasAccess = \n      user.role === 'admin' || \n      user.role === 'staff' || \n      user.role === 'dentist' ||\n      (user.role === 'patient' && patient.userId?.toString() === user._id.toString());\n\n    if (!hasAccess) {\n      return res.status(403).json({\n        success: false,\n        message: 'Access denied'\n      } as ApiResponse);\n    }\n\n    const skip = (Number(page) - 1) * Number(limit);\n    let query: any = { patientId };\n\n    // Add search functionality\n    if (search) {\n      const searchRegex = new RegExp(search as string, 'i');\n      query.$or = [\n        { title: searchRegex },\n        { description: searchRegex }\n      ];\n    }\n\n    const reports = await PatientReport.find(query)\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address')\n      .sort({ date: -1 })\n      .skip(skip)\n      .limit(Number(limit));\n\n    const total = await PatientReport.countDocuments(query);\n\n    res.json({\n      success: true,\n      data: reports,\n      pagination: {\n        page: Number(page),\n        limit: Number(limit),\n        total,\n        pages: Math.ceil(total / Number(limit)),\n        hasNext: skip + Number(limit) < total,\n        hasPrev: Number(page) > 1\n      }\n    } as ApiResponse);\n  } catch (error: any) {\n    console.error('Error fetching patient reports:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to fetch patient reports',\n      error: error.message\n    } as ApiResponse);\n  }\n};\n\n// Create patient report\nexport const createPatientReport = async (req: AuthenticatedRequest, res: Response) => {\n  try {\n    const { id: patientId } = req.params;\n    const { title, description, date, attachments = [], isShared = false } = req.body;\n    \n    // Check if patient exists\n    const patient = await Patient.findById(patientId);\n    if (!patient) {\n      return res.status(404).json({\n        success: false,\n        message: 'Patient not found'\n      } as ApiResponse);\n    }\n\n    // Check permissions (only staff, dentist, or admin can create reports)\n    const user = req.user;\n    if (!['admin', 'staff', 'dentist'].includes(user.role)) {\n      return res.status(403).json({\n        success: false,\n        message: 'Access denied'\n      } as ApiResponse);\n    }\n\n    const reportData = {\n      patientId,\n      dentistId: user._id,\n      clinicId: patient.preferredClinicId,\n      title,\n      description,\n      date: date || new Date(),\n      attachments,\n      isShared\n    };\n\n    const report = new PatientReport(reportData);\n    await report.save();\n\n    // Populate the created report\n    await report.populate([\n      { path: 'patientId', select: 'firstName lastName email' },\n      { path: 'dentistId', select: 'firstName lastName specialization' },\n      { path: 'clinicId', select: 'name address' }\n    ]);\n\n    res.status(201).json({\n      success: true,\n      message: 'Patient report created successfully',\n      data: report\n    } as ApiResponse);\n  } catch (error: any) {\n    console.error('Error creating patient report:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to create patient report',\n      error: error.message\n    } as ApiResponse);\n  }\n};\n\n// Update patient report\nexport const updatePatientReport = async (req: AuthenticatedRequest, res: Response) => {\n  try {\n    const { reportId } = req.params;\n    const updateData = req.body;\n    \n    // Check if report exists\n    const report = await PatientReport.findById(reportId);\n    if (!report) {\n      return res.status(404).json({\n        success: false,\n        message: 'Report not found'\n      } as ApiResponse);\n    }\n\n    // Check permissions (only the creator, staff, or admin can update)\n    const user = req.user;\n    const hasAccess = \n      user.role === 'admin' || \n      user.role === 'staff' || \n      report.dentistId.toString() === user._id.toString();\n\n    if (!hasAccess) {\n      return res.status(403).json({\n        success: false,\n        message: 'Access denied'\n      } as ApiResponse);\n    }\n\n    // Update the report\n    const updatedReport = await PatientReport.findByIdAndUpdate(\n      reportId,\n      updateData,\n      { new: true, runValidators: true }\n    ).populate([\n      { path: 'patientId', select: 'firstName lastName email' },\n      { path: 'dentistId', select: 'firstName lastName specialization' },\n      { path: 'clinicId', select: 'name address' }\n    ]);\n\n    res.json({\n      success: true,\n      message: 'Patient report updated successfully',\n      data: updatedReport\n    } as ApiResponse);\n  } catch (error: any) {\n    console.error('Error updating patient report:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to update patient report',\n      error: error.message\n    } as ApiResponse);\n  }\n};\n\n// Delete patient report\nexport const deletePatientReport = async (req: AuthenticatedRequest, res: Response) => {\n  try {\n    const { reportId } = req.params;\n    \n    // Check if report exists\n    const report = await PatientReport.findById(reportId);\n    if (!report) {\n      return res.status(404).json({\n        success: false,\n        message: 'Report not found'\n      } as ApiResponse);\n    }\n\n    // Check permissions (only the creator, staff, or admin can delete)\n    const user = req.user;\n    const hasAccess = \n      user.role === 'admin' || \n      user.role === 'staff' || \n      report.dentistId.toString() === user._id.toString();\n\n    if (!hasAccess) {\n      return res.status(403).json({\n        success: false,\n        message: 'Access denied'\n      } as ApiResponse);\n    }\n\n    await PatientReport.findByIdAndDelete(reportId);\n\n    res.json({\n      success: true,\n      message: 'Patient report deleted successfully'\n    } as ApiResponse);\n  } catch (error: any) {\n    console.error('Error deleting patient report:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to delete patient report',\n      error: error.message\n    } as ApiResponse);\n  }\n};\n\n// Get report by ID\nexport const getPatientReportById = async (req: AuthenticatedRequest, res: Response) => {\n  try {\n    const { reportId } = req.params;\n    \n    const report = await PatientReport.findById(reportId)\n      .populate('patientId', 'firstName lastName email')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address');\n\n    if (!report) {\n      return res.status(404).json({\n        success: false,\n        message: 'Report not found'\n      } as ApiResponse);\n    }\n\n    // Check access permissions\n    const user = req.user;\n    const hasAccess = \n      user.role === 'admin' || \n      user.role === 'staff' || \n      user.role === 'dentist' ||\n      (user.role === 'patient' && report.patientId.userId?.toString() === user._id.toString());\n\n    if (!hasAccess) {\n      return res.status(403).json({\n        success: false,\n        message: 'Access denied'\n      } as ApiResponse);\n    }\n\n    res.json({\n      success: true,\n      data: report\n    } as ApiResponse);\n  } catch (error: any) {\n    console.error('Error fetching patient report:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to fetch patient report',\n      error: error.message\n    } as ApiResponse);\n  }\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\paymentController.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[800,803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[800,803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1018,1021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1018,1021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'paymentData' is never reassigned. Use 'const' instead.","line":38,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":38,"endColumn":23,"fix":{"range":[1276,1577],"text":"const paymentData: any = {\n    billingId,\n    patientId: billing.patientId._id,\n    clinicId: billing.clinicId,\n    amount: billing.totalAmount,\n    currency: 'USD',\n    paymentMethod,\n    paymentProvider,\n    description: `Payment for invoice ${billing.invoiceNumber}`,\n    createdBy: req.user._id\n  };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1293,1296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1293,1296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1600,1603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1600,1603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2708,2711],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2708,2711],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2829,2832],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2829,2832],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3072,3075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3072,3075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3405,3408],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3405,3408],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":118,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3677,3680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3677,3680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4072,4075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4072,4075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4139,4142],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4139,4142],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4290,4293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4290,4293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5543,5546],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5543,5546],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6494,6497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6494,6497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":219,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7101,7104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7101,7104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":225,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7262,7265],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7262,7265],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":271,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":271,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8598,8601],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8598,8601],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":285,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":285,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8978,8981],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8978,8981],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":286,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":286,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9042,9045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9042,9045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":301,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":301,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9473,9476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9473,9476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":318,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9841,9844],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9841,9844],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":324,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":324,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10053,10056],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10053,10056],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":337,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":337,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10363,10366],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10363,10366],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":359,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":359,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10982,10985],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10982,10985],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":400,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":400,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12245,12248],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12245,12248],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":408,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":408,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12424,12427],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12424,12427],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":409,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":409,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12489,12492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12489,12492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":410,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":410,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12535,12538],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12535,12538],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":433,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":433,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13109,13112],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13109,13112],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":442,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":442,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13396,13399],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13396,13399],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":456,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":456,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13708,13711],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13708,13711],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":31,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { Payment, Billing } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\nimport { StripeService } from '../services/StripeService';\nimport { PayPalService } from '../services/PayPalService';\n\n// Create payment intent\nexport const createPaymentIntent = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { billingId, paymentMethod, paymentProvider = 'stripe' } = req.body;\n\n  // Get billing record\n  const billing = await (Billing as any).findById(billingId).populate('patientId');\n  if (!billing) {\n    throw createNotFoundError('Billing record');\n  }\n\n  // Check if payment already exists for this billing\n  const existingPayment = await (Payment as any).findOne({ \n    billingId, \n    status: { $in: ['pending', 'processing', 'completed'] } \n  });\n  \n  if (existingPayment && existingPayment.status === 'completed') {\n    throw createValidationError('payment', 'This invoice has already been paid');\n  }\n\n  let paymentData: any = {\n    billingId,\n    patientId: billing.patientId._id,\n    clinicId: billing.clinicId,\n    amount: billing.totalAmount,\n    currency: 'USD',\n    paymentMethod,\n    paymentProvider,\n    description: `Payment for invoice ${billing.invoiceNumber}`,\n    createdBy: req.user._id\n  };\n\n  let paymentIntent: any = null;\n\n  try {\n    if (paymentProvider === 'stripe' && paymentMethod === 'card') {\n      const stripeService = new StripeService();\n      paymentIntent = await stripeService.createPaymentIntent({\n        amount: billing.totalAmount,\n        currency: 'USD',\n        metadata: {\n          billingId: billingId,\n          patientId: billing.patientId._id.toString(),\n          clinicId: billing.clinicId.toString()\n        }\n      });\n\n      paymentData.paymentIntentId = paymentIntent.id;\n      paymentData.gatewayResponse = {\n        clientSecret: paymentIntent.client_secret,\n        paymentIntentId: paymentIntent.id\n      };\n    } else if (paymentProvider === 'paypal') {\n      const paypalService = new PayPalService();\n      paymentIntent = await paypalService.createOrder({\n        amount: billing.totalAmount,\n        currency: 'USD',\n        description: `Payment for invoice ${billing.invoiceNumber}`\n      });\n\n      paymentData.paymentIntentId = paymentIntent.id;\n      paymentData.gatewayResponse = {\n        orderId: paymentIntent.id,\n        approvalUrl: paymentIntent.links?.find((link: any) => link.rel === 'approve')?.href\n      };\n    }\n\n    // Create payment record\n    const payment = await (Payment as any).create(paymentData);\n\n    res.status(201).json({\n      success: true,\n      message: 'Payment intent created successfully',\n      data: {\n        payment,\n        ...(paymentIntent && { paymentIntent })\n      }\n    });\n\n  } catch (error: any) {\n    throw new AppError(`Payment processing error: ${error.message}`, 400);\n  }\n});\n\n// Confirm payment\nexport const confirmPayment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { paymentId } = req.params;\n  const { paymentIntentId, transactionId } = req.body;\n\n  const payment = await (Payment as any).findById(paymentId);\n  if (!payment) {\n    throw createNotFoundError('Payment');\n  }\n\n  if (payment.status === 'completed') {\n    throw createValidationError('payment', 'Payment is already completed');\n  }\n\n  try {\n    let confirmed = false;\n    let gatewayResponse: any = {};\n\n    if (payment.paymentProvider === 'stripe') {\n      const stripeService = new StripeService();\n      const paymentIntent = await stripeService.retrievePaymentIntent(paymentIntentId);\n      \n      if (paymentIntent.status === 'succeeded') {\n        confirmed = true;\n        gatewayResponse = {\n          paymentIntentId: paymentIntent.id,\n          transactionId: (paymentIntent as any).charges?.data[0]?.id,\n          receiptUrl: (paymentIntent as any).charges?.data[0]?.receipt_url\n        };\n        \n        // Extract card details if available\n        const paymentMethodObj = (paymentIntent as any).charges?.data[0]?.payment_method_details?.card;\n        if (paymentMethodObj) {\n          payment.cardDetails = {\n            last4: paymentMethodObj.last4,\n            brand: paymentMethodObj.brand,\n            expiryMonth: paymentMethodObj.exp_month,\n            expiryYear: paymentMethodObj.exp_year,\n            fingerprint: paymentMethodObj.fingerprint\n          };\n        }\n      }\n    } else if (payment.paymentProvider === 'paypal') {\n      const paypalService = new PayPalService();\n      const order = await paypalService.captureOrder(paymentIntentId);\n      \n      if (order.status === 'COMPLETED') {\n        confirmed = true;\n        gatewayResponse = {\n          orderId: order.id,\n          transactionId: order.purchase_units[0]?.payments?.captures[0]?.id\n        };\n      }\n    }\n\n    if (confirmed) {\n      payment.status = 'completed';\n      payment.transactionId = gatewayResponse.transactionId || transactionId;\n      payment.gatewayResponse = { ...payment.gatewayResponse, ...gatewayResponse };\n      payment.receiptUrl = gatewayResponse.receiptUrl;\n      payment.paidAt = new Date();\n      payment.updatedBy = req.user._id;\n\n      await payment.save();\n\n      // Update billing status\n      const billing = await (Billing as any).findById(payment.billingId);\n      \n      if (billing) {\n        billing.paymentStatus = 'paid';\n        billing.paidAmount = payment.amount;\n        billing.paidDate = new Date();\n        await billing.save();\n      }\n\n      // Send notification to patient\n      await createAndSendNotification({\n        userId: payment.patientId.toString(),\n        title: 'Payment Successful',\n        message: `Your payment of $${payment.amount} has been processed successfully`,\n        type: 'payment_success',\n        link: `/billing/invoices/${billing?.invoiceNumber}`,\n        metadata: {\n          paymentId: payment._id,\n          amount: payment.amount,\n          invoiceNumber: billing?.invoiceNumber\n        }\n      });\n\n      res.json({\n        success: true,\n        message: 'Payment confirmed successfully',\n        data: { payment }\n      });\n    } else {\n      throw new AppError('Payment confirmation failed', 400);\n    }\n\n  } catch (error: any) {\n    // Mark payment as failed\n    payment.status = 'failed';\n    payment.failedAt = new Date();\n    payment.gatewayResponse = { \n      ...payment.gatewayResponse, \n      error: error.message \n    };\n    await payment.save();\n\n    throw new AppError(`Payment confirmation failed: ${error.message}`, 400);\n  }\n});\n\n// Process manual payment (cash, check, etc.)\nexport const processManualPayment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { billingId, paymentMethod, amount, notes, receiptNumber } = req.body;\n\n  // Get billing record\n  const billing = await (Billing as any).findById(billingId);\n  if (!billing) {\n    throw createNotFoundError('Billing record');\n  }\n\n  // Create manual payment\n  const payment = await (Payment as any).create({\n    billingId,\n    patientId: billing.patientId,\n    clinicId: billing.clinicId,\n    amount: amount || billing.totalAmount,\n    currency: 'USD',\n    paymentMethod,\n    paymentProvider: 'manual',\n    status: 'completed',\n    description: notes || `Manual ${paymentMethod} payment for invoice ${billing.invoiceNumber}`,\n    transactionId: receiptNumber,\n    paidAt: new Date(),\n    createdBy: req.user._id\n  });\n\n  // Update billing status\n  billing.paymentStatus = 'paid';\n  billing.paidAmount = payment.amount;\n  billing.paidDate = new Date();\n  await billing.save();\n\n  // Send notification to patient\n  await createAndSendNotification({\n    userId: billing.patientId.toString(),\n    title: 'Payment Received',\n    message: `Your ${paymentMethod} payment of $${payment.amount} has been received`,\n    type: 'payment_success',\n    link: `/billing/invoices/${billing.invoiceNumber}`,\n    metadata: {\n      paymentId: payment._id,\n      amount: payment.amount,\n      paymentMethod\n    }\n  });\n\n  res.status(201).json({\n    success: true,\n    message: 'Manual payment processed successfully',\n    data: { payment }\n  });\n});\n\n// Get payments for a billing record\nexport const getPaymentsByBilling = catchAsync(async (req: Request, res: Response) => {\n  const { billingId } = req.params;\n\n  const payments = await (Payment as any).findByBilling(billingId);\n\n  res.json({\n    success: true,\n    data: { payments }\n  });\n});\n\n// Get patient payments\nexport const getPatientPayments = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { patientId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const [payments, total] = await Promise.all([\n    (Payment as any).findByPatient(patientId, { skip, limit }),\n    (Payment as any).countDocuments({ patientId })\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(payments, total, page, limit)\n  });\n});\n\n// Get clinic payments\nexport const getClinicPayments = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { clinicId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n  const { status, startDate, endDate } = req.query;\n\n  const query: any = { clinicId };\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  if (startDate || endDate) {\n    query.createdAt = {};\n    if (startDate) {\n      query.createdAt.$gte = new Date(startDate as string);\n    }\n    if (endDate) {\n      query.createdAt.$lte = new Date(endDate as string);\n    }\n  }\n\n  const [payments, total] = await Promise.all([\n    (Payment as any).find(query)\n      .populate('patientId', 'firstName lastName')\n      .populate('billingId', 'invoiceNumber totalAmount')\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(limit),\n    (Payment as any).countDocuments(query)\n  ]);\n\n  res.json({\n    success: true,\n    data: createPaginatedResponse(payments, total, page, limit)\n  });\n});\n\n// Get payment by ID\nexport const getPaymentById = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const payment = await (Payment as any).findById(id)\n    .populate('patientId', 'firstName lastName email')\n    .populate('billingId', 'invoiceNumber totalAmount')\n    .populate('clinicId', 'name')\n    .populate('createdBy', 'firstName lastName')\n    .populate('refunds.refundedBy', 'firstName lastName');\n\n  if (!payment) {\n    throw createNotFoundError('Payment');\n  }\n\n  res.json({\n    success: true,\n    data: { payment }\n  });\n});\n\n// Refund payment\nexport const refundPayment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { amount, reason } = req.body;\n\n  const payment = await (Payment as any).findById(id).populate('billingId');\n  if (!payment) {\n    throw createNotFoundError('Payment');\n  }\n\n  if (payment.status !== 'completed') {\n    throw createValidationError('payment', 'Only completed payments can be refunded');\n  }\n\n  const currentRefunded = payment.refunds?.reduce((total, refund) => total + refund.amount, 0) || 0;\n  const refundableAmount = Math.max(0, payment.amount - currentRefunded);\n  \n  if (amount > refundableAmount) {\n    throw createValidationError('amount', 'Refund amount exceeds refundable amount');\n  }\n\n  try {\n    let refundId: string = '';\n\n    if (payment.paymentProvider === 'stripe') {\n      const stripeService = new StripeService();\n      const refund = await stripeService.createRefund({\n        paymentIntentId: payment.paymentIntentId!,\n        amount,\n        reason\n      });\n      refundId = refund.id;\n    } else if (payment.paymentProvider === 'paypal') {\n      const paypalService = new PayPalService();\n      const refund = await paypalService.refundCapture({\n        captureId: payment.transactionId!,\n        amount,\n        reason\n      });\n      refundId = refund.id;\n    } else {\n      // Manual refund\n      refundId = `manual_${Date.now()}`;\n    }\n\n    // Add refund to payment\n    await (payment as any).addRefund({\n      amount,\n      reason,\n      refundId,\n      refundedBy: req.user._id\n    });\n\n    // Update billing if fully refunded\n    const billing = await (Billing as any).findById(payment.billingId);\n    if (billing && (payment as any).refunds?.length > 0) {\n      (billing as any).paymentStatus = 'refunded';\n      await billing.save();\n    }\n\n    // Send notification to patient\n    await createAndSendNotification({\n      userId: payment.patientId.toString(),\n      title: 'Payment Refunded',\n      message: `A refund of $${amount} has been processed for your payment`,\n      type: 'payment_success',\n      metadata: {\n        paymentId: payment._id,\n        refundAmount: amount,\n        reason\n      }\n    });\n\n    res.json({\n      success: true,\n      message: 'Payment refunded successfully',\n      data: { payment }\n    });\n\n  } catch (error: any) {\n    throw new AppError(`Refund processing failed: ${error.message}`, 400);\n  }\n});\n\n// Get payment statistics\nexport const getPaymentStatistics = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { clinicId } = req.query;\n\n  const stats = await (Payment as any).getPaymentStats(clinicId as string);\n\n  // Calculate additional metrics\n  const totalStats = {\n    totalPayments: 0,\n    totalAmount: 0,\n    completedPayments: 0,\n    completedAmount: 0,\n    pendingPayments: 0,\n    pendingAmount: 0,\n    failedPayments: 0,\n    refundedAmount: 0\n  };\n\n  stats.forEach((stat: any) => {\n    totalStats.totalPayments += stat.count;\n    totalStats.totalAmount += stat.totalAmount;\n\n    switch (stat._id) {\n      case 'completed':\n        totalStats.completedPayments = stat.count;\n        totalStats.completedAmount = stat.totalAmount;\n        break;\n      case 'pending':\n      case 'processing':\n        totalStats.pendingPayments += stat.count;\n        totalStats.pendingAmount += stat.totalAmount;\n        break;\n      case 'failed':\n        totalStats.failedPayments += stat.count;\n        break;\n      case 'refunded':\n      case 'partially_refunded':\n        totalStats.refundedAmount += stat.totalAmount;\n        break;\n    }\n  });\n\n  res.json({\n    success: true,\n    data: {\n      summary: totalStats,\n      breakdown: stats\n    }\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\prescriptionController.ts","messages":[{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":13,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":13,"endColumn":17,"fix":{"range":[597,617],"text":"const query: any = {};"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[608,611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[608,611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3602,3605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3602,3605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":216,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":216,"endColumn":17,"fix":{"range":[7689,7720],"text":"const query: any = { patientId };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":216,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7700,7703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7700,7703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":247,"column":101,"nodeType":null,"messageId":"unusedVar","endLine":247,"endColumn":105},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":261,"column":90,"nodeType":null,"messageId":"unusedVar","endLine":261,"endColumn":94},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":325,"column":106,"nodeType":null,"messageId":"unusedVar","endLine":325,"endColumn":110},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":350,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":350,"endColumn":17,"fix":{"range":[12068,12088],"text":"const query: any = {};"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":350,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":350,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12079,12082],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12079,12082],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'responseData' is never reassigned. Use 'const' instead.","line":387,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":387,"endColumn":24,"fix":{"range":[13356,13471],"text":"const responseData: any = {\n    prescriptions,\n    totalPages,\n    currentPage: pageNum,\n    totalRecords: total\n  };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":387,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":387,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13374,13377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13374,13377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":426,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":426,"endColumn":17,"fix":{"range":[14481,14512],"text":"const query: any = { patientId };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":426,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":426,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14492,14495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14492,14495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":445,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":445,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15205,15208],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15205,15208],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":446,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":446,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15254,15257],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15254,15257],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'clinicId' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":447,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":447,"endColumn":19}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":5,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\nimport { Prescription, Patient, Medication } from '../models';\nimport { asyncHandler } from '../utils/asyncHandler';\nimport { AppError } from '../utils/AppError';\nimport { AuthenticatedRequest } from '../types';\n\n// @desc    Get all prescriptions\n// @route   GET /api/prescriptions\n// @access  Private (Dentist, Staff, Admin, Patient - own only)\nexport const getAllPrescriptions = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { page = 1, limit = 10, status, patientId } = req.query;\n  \n  let query: any = {};\n  \n  // If user is a patient, get their patient record and show only their prescriptions\n  if (req.user.role === 'patient') {\n    // Find patient record linked to this user\n    const patient = await Patient.findOne({ userId: req.user._id });\n    if (!patient) {\n      return next(new AppError('Patient record not found', 404));\n    }\n    query.patientId = patient._id;\n  }\n  // If user is a dentist, only show their prescriptions\n  else if (req.user.role === 'dentist') {\n    query.dentistId = req.user._id;\n  }\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  if (patientId) {\n    query.patientId = patientId;\n  }\n  \n  const prescriptions = await Prescription.find(query)\n    .populate('patientId', 'firstName lastName email phone')\n    .populate('dentistId', 'firstName lastName specialization')\n    .populate('clinicId', 'name address')\n    .populate('medications.medicationId', 'name genericName category')\n    .sort({ createdAt: -1 })\n    .limit(Number(limit) * 1)\n    .skip((Number(page) - 1) * Number(limit));\n    \n  const total = await Prescription.countDocuments(query);\n  \n  return res.status(200).json({\n    success: true,\n    data: {\n      prescriptions,\n      totalPages: Math.ceil(total / Number(limit)),\n      currentPage: Number(page),\n      totalRecords: total\n    }\n  });\n});\n\n// @desc    Get prescription by ID\n// @route   GET /api/prescriptions/:id\n// @access  Private (Dentist, Staff, Admin, Patient - own only)\nexport const getPrescriptionById = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const prescription = await Prescription.findById(req.params.id)\n    .populate('patientId', 'firstName lastName email phone dateOfBirth')\n    .populate('dentistId', 'firstName lastName specialization licenseNumber')\n    .populate('clinicId', 'name address phone')\n    .populate('medications.medicationId', 'name genericName dosage category sideEffects contraindications');\n  \n  if (!prescription) {\n    return next(new AppError('Prescription not found', 404));\n  }\n  \n  // Check if patient is accessing their own prescription\n  if (req.user.role === 'patient') {\n    // Find patient record linked to this user\n    const patient = await Patient.findOne({ userId: req.user._id });\n    if (!patient || prescription.patientId.toString() !== patient._id.toString()) {\n      return next(new AppError('Access denied', 403));\n    }\n  }\n  \n  // Check if dentist is accessing their own prescription\n  if (req.user.role === 'dentist' && prescription.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  return res.status(200).json({\n    success: true,\n    data: prescription\n  });\n});\n\n// @desc    Create new prescription\n// @route   POST /api/prescriptions\n// @access  Private (Dentist)\nexport const createPrescription = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  // Verify patient exists\n  const patient = await (Patient as any).findById(req.body.patientId);\n  if (!patient) {\n    return next(new AppError('Patient not found', 404));\n  }\n  \n  // Verify medications exist\n  for (const med of req.body.medications) {\n    const medication = await Medication.findById(med.medicationId);\n    if (!medication) {\n      return next(new AppError(`Medication with ID ${med.medicationId} not found`, 404));\n    }\n  }\n  \n  const prescriptionData = {\n    ...req.body,\n    dentistId: req.user._id,\n    issuedDate: new Date()\n  };\n  \n  const prescription = await Prescription.create(prescriptionData);\n  \n  const populatedPrescription = await Prescription.findById(prescription._id)\n    .populate('patientId', 'firstName lastName email')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .populate('medications.medicationId', 'name genericName');\n  \n  return res.status(201).json({\n    success: true,\n    data: populatedPrescription,\n    message: 'Prescription created successfully'\n  });\n});\n\n// @desc    Update prescription\n// @route   PUT /api/prescriptions/:id\n// @access  Private (Dentist - own only)\nexport const updatePrescription = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const prescription = await Prescription.findById(req.params.id);\n  \n  if (!prescription) {\n    return next(new AppError('Prescription not found', 404));\n  }\n  \n  // Check if dentist is updating their own prescription\n  if (req.user.role === 'dentist' && prescription.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  // Verify medications exist if medications are being updated\n  if (req.body.medications) {\n    for (const med of req.body.medications) {\n      const medication = await Medication.findById(med.medicationId);\n      if (!medication) {\n        return next(new AppError(`Medication with ID ${med.medicationId} not found`, 404));\n      }\n    }\n  }\n  \n  const updatedPrescription = await Prescription.findByIdAndUpdate(\n    req.params.id,\n    req.body,\n    { new: true, runValidators: true }\n  ).populate('patientId', 'firstName lastName email')\n   .populate('dentistId', 'firstName lastName')\n   .populate('clinicId', 'name')\n   .populate('medications.medicationId', 'name genericName');\n  \n  return res.status(200).json({\n    success: true,\n    data: updatedPrescription,\n    message: 'Prescription updated successfully'\n  });\n});\n\n// @desc    Delete prescription\n// @route   DELETE /api/prescriptions/:id\n// @access  Private (Dentist - own only, Admin)\nexport const deletePrescription = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const prescription = await Prescription.findById(req.params.id);\n  \n  if (!prescription) {\n    return next(new AppError('Prescription not found', 404));\n  }\n  \n  // Check if dentist is deleting their own prescription\n  if (req.user.role === 'dentist' && prescription.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  await Prescription.findByIdAndUpdate(req.params.id, { status: 'cancelled' });\n  \n  return res.status(200).json({\n    success: true,\n    message: 'Prescription cancelled successfully'\n  });\n});\n\n// @desc    Get prescriptions by patient\n// @route   GET /api/prescriptions/patient/:patientId\n// @access  Private (Dentist, Staff, Admin, Patient - own only)\nexport const getPrescriptionsByPatient = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { patientId } = req.params;\n  const { page = 1, limit = 10, status } = req.query;\n  \n  // Check if patient is accessing their own prescriptions\n  if (req.user.role === 'patient') {\n    // Find patient record linked to this user\n    const patient = await Patient.findOne({ userId: req.user._id });\n    if (!patient || patientId !== patient._id.toString()) {\n      return next(new AppError('Access denied', 403));\n    }\n  }\n  \n  const pageNum = Number(page);\n  const limitNum = Number(limit);\n  const skip = (pageNum - 1) * limitNum;\n  \n  let query: any = { patientId };\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  const [prescriptions, total] = await Promise.all([\n    Prescription.findByPatient(patientId, {\n      limit: limitNum,\n      skip,\n      status\n    }),\n    Prescription.countDocuments(query)\n  ]);\n  \n  const totalPages = Math.ceil(total / limitNum);\n  \n  return res.status(200).json({\n    success: true,\n    data: {\n      prescriptions,\n      totalPages,\n      currentPage: pageNum,\n      totalRecords: total\n    }\n  });\n});\n\n// @desc    Get active prescriptions\n// @route   GET /api/prescriptions/active\n// @access  Private (Dentist, Staff, Admin)\nexport const getActivePrescriptions = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { patientId } = req.query;\n  \n  const prescriptions = await Prescription.findActive(patientId as string);\n  \n  return res.status(200).json({\n    success: true,\n    data: prescriptions\n  });\n});\n\n// @desc    Get expiring prescriptions\n// @route   GET /api/prescriptions/expiring\n// @access  Private (Dentist, Staff, Admin)\nexport const getExpiringPrescriptions = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  const { days = 7 } = req.query;\n  \n  const prescriptions = await Prescription.findExpiring(Number(days));\n  \n  return res.status(200).json({\n    success: true,\n    data: prescriptions\n  });\n});\n\n// @desc    Add refill to prescription\n// @route   POST /api/prescriptions/:id/refill\n// @access  Private (Dentist - own only)\nexport const addRefill = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const prescription = await Prescription.findById(req.params.id);\n  \n  if (!prescription) {\n    return next(new AppError('Prescription not found', 404));\n  }\n  \n  // Check if dentist is adding refill to their own prescription\n  if (req.user.role === 'dentist' && prescription.dentistId.toString() !== req.user._id.toString()) {\n    return next(new AppError('Access denied', 403));\n  }\n  \n  const updatedPrescription = await prescription.addRefill();\n  \n  return res.status(200).json({\n    success: true,\n    data: updatedPrescription,\n    message: 'Refill added successfully'\n  });\n});\n\n// @desc    Perform medication safety check before prescribing\n// @route   POST /api/prescriptions/safety-check\n// @access  Private (Dentist, Doctor)\nexport const performSafetyCheck = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { patientId, medications } = req.body;\n\n  if (!patientId || !medications || !Array.isArray(medications) || medications.length === 0) {\n    return next(new AppError('Patient ID and medications array are required', 400));\n  }\n\n  // Import safety service\n  const { medicationSafetyService } = await import('../services/medicationSafetyService');\n\n  // Perform comprehensive safety check\n  const safetyCheckResult = await medicationSafetyService.performSafetyCheck(\n    patientId,\n    medications\n  );\n\n  return res.status(200).json({\n    success: true,\n    data: safetyCheckResult,\n    message: safetyCheckResult.safe ? 'No critical safety issues found' : 'Safety concerns detected'\n  });\n});\n\n// @desc    Get patient medication summary (allergies, current meds, conditions)\n// @route   GET /api/prescriptions/patient/:patientId/summary\n// @access  Private (Dentist, Doctor)\nexport const getPatientMedicationSummary = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { patientId } = req.params;\n\n  // Import safety service\n  const { medicationSafetyService } = await import('../services/medicationSafetyService');\n\n  const summary = await medicationSafetyService.getPatientMedicationSummary(patientId);\n\n  return res.status(200).json({\n    success: true,\n    data: summary,\n    message: 'Patient medication summary retrieved successfully'\n  });\n});\n\n// @desc    Get current user's prescriptions (for patients, dentists, staff, admin)\n// @route   GET /api/prescriptions/my-prescriptions\n// @access  Private (Patient, Dentist, Staff, Admin)\nexport const getMyPrescriptions = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { page = 1, limit = 10, status } = req.query;\n  \n  const pageNum = Number(page);\n  const limitNum = Number(limit);\n  const skip = (pageNum - 1) * limitNum;\n  \n  let query: any = {};\n  \n  // Handle different user roles\n  if (req.user.role === 'patient') {\n    // Find patient record linked to this user\n    const patient = await Patient.findOne({ userId: req.user._id });\n    if (!patient) {\n      return next(new AppError('Patient record not found', 404));\n    }\n    query.patientId = patient._id;\n  } else if (req.user.role === 'dentist') {\n    // Dentists can see prescriptions they created\n    query.dentistId = req.user._id;\n  } else if (req.user.role === 'staff' || req.user.role === 'admin') {\n    // Staff and admin can see all prescriptions (no additional filter)\n    // This allows them to see all prescriptions in the system\n  }\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  const [prescriptions, total] = await Promise.all([\n    Prescription.find(query)\n      .populate('patientId', 'firstName lastName email phone')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address phone')\n      .populate('medications.medicationId', 'name genericName category')\n      .sort({ issuedDate: -1 })\n      .limit(limitNum)\n      .skip(skip),\n    Prescription.countDocuments(query)\n  ]);\n  \n  const totalPages = Math.ceil(total / limitNum);\n  \n  // Prepare response data based on user role\n  let responseData: any = {\n    prescriptions,\n    totalPages,\n    currentPage: pageNum,\n    totalRecords: total\n  };\n  \n  // Add patient info for patient users\n  if (req.user.role === 'patient') {\n    const patient = await Patient.findOne({ userId: req.user._id });\n    if (patient) {\n      responseData.patient = {\n        _id: patient._id,\n        firstName: patient.firstName,\n        lastName: patient.lastName,\n        email: patient.email\n      };\n    }\n  }\n  \n  return res.status(200).json({\n    success: true,\n    data: responseData\n  });\n});\n\n// @desc    Get prescriptions for any patient across all clinics (for doctors)\n// @route   GET /api/prescriptions/cross-clinic/patient/:patientId\n// @access  Private (Dentist, Doctor, Admin)\nexport const getCrossClinicPrescriptions = asyncHandler(async (req: AuthenticatedRequest, res: Response, next: NextFunction) => {\n  const { patientId } = req.params;\n  const { page = 1, limit = 20, status } = req.query;\n\n  // Verify patient exists\n  const patient = await Patient.findById(patientId);\n  if (!patient) {\n    return next(new AppError('Patient not found', 404));\n  }\n\n  let query: any = { patientId };\n  \n  if (status) {\n    query.status = status;\n  }\n\n  // Get all prescriptions for this patient regardless of clinic\n  const prescriptions = await Prescription.find(query)\n    .populate('patientId', 'firstName lastName email phone dateOfBirth')\n    .populate('dentistId', 'firstName lastName email specialization')\n    .populate('clinicId', 'name address phone')\n    .populate('medications.medicationId', 'name genericName category strength dosageForm')\n    .sort({ issuedDate: -1 })\n    .limit(Number(limit))\n    .skip((Number(page) - 1) * Number(limit));\n\n  const total = await Prescription.countDocuments(query);\n\n  // Group by clinic for better organization\n  const prescriptionsByClinic: any = {};\n  prescriptions.forEach((prescription: any) => {\n    const clinicId = prescription.clinicId._id.toString();\n    const clinicName = prescription.clinicId.name;\n    \n    if (!prescriptionsByClinic[clinicName]) {\n      prescriptionsByClinic[clinicName] = {\n        clinic: prescription.clinicId,\n        prescriptions: [],\n        count: 0\n      };\n    }\n    \n    prescriptionsByClinic[clinicName].prescriptions.push(prescription);\n    prescriptionsByClinic[clinicName].count++;\n  });\n\n  return res.status(200).json({\n    success: true,\n    data: {\n      prescriptions,\n      prescriptionsByClinic,\n      pagination: {\n        page: Number(page),\n        limit: Number(limit),\n        total,\n        totalPages: Math.ceil(total / Number(limit))\n      },\n      patient: {\n        _id: patient._id,\n        fullName: `${patient.firstName} ${patient.lastName}`,\n        email: patient.email,\n        dateOfBirth: patient.dateOfBirth\n      }\n    },\n    message: 'Cross-clinic prescriptions retrieved successfully'\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\reminderController.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\staffScheduleController.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1003,1006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1003,1006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":56,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1552,1555],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1552,1555],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2493,2496],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2493,2496],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3370,3373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3370,3373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":187,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5465,5468],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5465,5468],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'conflictDetails' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":195,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":195,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":196,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":196,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5757,5760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5757,5760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5815,5818],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5815,5818],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5861,5864],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5861,5864],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5908,5911],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5908,5911],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'originalData' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":209,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":209,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":222,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6599,6602],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6599,6602],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6653,6656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6653,6656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6697,6700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6697,6700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":225,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6742,6745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6742,6745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { StaffSchedule, User, Clinic, Notification } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\nimport {\n  catchAsync,\n  createNotFoundError,\n  createValidationError,\n  createConflictError\n} from '../middleware/errorHandler';\n\n// Create a new staff schedule\nexport const createStaffSchedule = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    staffId,\n    clinicId,\n    date,\n    startTime,\n    endTime,\n    shiftType,\n    notes,\n    isRecurring,\n    recurringPattern\n  } = req.body;\n\n  // Verify staff member exists and is assigned to the clinic\n  const staff = await User.findById(staffId);\n  if (!staff || !staff.assignedClinics.includes(clinicId)) {\n    throw createValidationError('staffId', 'Staff member not found or not assigned to this clinic');\n  }\n\n  // Verify clinic exists\n  const clinic = await (Clinic as any).findById(clinicId);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  // Check for scheduling conflicts using the new method\n  const conflicts = await StaffSchedule.find({\n    staffId,\n    date: new Date(date),\n    $or: [\n      {\n        startTime: { $lt: endTime },\n        endTime: { $gt: startTime }\n      }\n    ]\n  });\n  \n  if (conflicts.length > 0) {\n    // Create conflict notification\n    const conflictDetails = `Overlapping schedule from ${conflicts[0].startTime} to ${conflicts[0].endTime}`;\n    await (Notification as any).create({\n      userId: staffId,\n      type: 'schedule_conflict',\n      title: 'Schedule Conflict Detected',\n      message: conflictDetails,\n      metadata: {\n        conflictingScheduleId: conflicts[0]?._id?.toString() ?? ''\n      },\n      channels: {\n        email: true,\n        inApp: true\n      }\n    });\n    throw createConflictError('Staff member already has a schedule during this time');\n  }\n\n  const scheduleData = {\n    staffId,\n    clinicId,\n    date: new Date(date),\n    startTime,\n    endTime,\n    shiftType,\n    notes,\n    isRecurring: isRecurring || false,\n    recurringPattern: isRecurring ? recurringPattern : undefined,\n    createdBy: req.user!.id\n  };\n\n  const schedule = await StaffSchedule.create(scheduleData);\n  await schedule.populate('staffId', 'firstName lastName role email phone');\n  await schedule.populate('clinicId', 'name address');\n\n  // Create schedule assignment notification\n  await (Notification as any).createScheduleNotification(\n    staffId,\n    'schedule_assignment',\n    'New Schedule Assignment',\n    `You have been assigned a ${shiftType} shift at ${clinic.name} on ${new Date(date).toLocaleDateString()} from ${startTime} to ${endTime}`,\n    {\n      scheduleId: schedule._id,\n      clinicId,\n      date: new Date(date),\n      startTime,\n      endTime\n    },\n    {\n      email: true,\n      sms: false,\n      inApp: true\n    }\n  );\n\n  res.status(201).json({\n    success: true,\n    message: 'Staff schedule created successfully',\n    data: { schedule }\n  });\n});\n\n// Get staff schedules with filtering and pagination\nexport const getStaffSchedules = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { clinicId, staffId, startDate, endDate, status, shiftType } = req.query;\n\n  const query: any = {};\n\n  if (clinicId) query.clinicId = clinicId;\n  if (staffId) query.staffId = staffId;\n  if (status) query.status = status;\n  if (shiftType) query.shiftType = shiftType;\n\n  if (startDate || endDate) {\n    query.date = {};\n    if (startDate) query.date.$gte = new Date(startDate as string);\n    if (endDate) query.date.$lte = new Date(endDate as string);\n  }\n\n  const [schedules, total] = await Promise.all([\n    StaffSchedule.find(query)\n      .populate('staffId', 'firstName lastName role email phone')\n      .populate('clinicId', 'name address')\n      .populate('createdBy', 'firstName lastName')\n      .sort({ date: 1, startTime: 1 })\n      .skip(skip)\n      .limit(limit),\n    StaffSchedule.countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(schedules, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get staff schedule by ID\nexport const getStaffScheduleById = catchAsync(async (req: Request, res: Response) => {\n  const schedule = await StaffSchedule.findById(req.params.id)\n    .populate('staffId', 'firstName lastName role email phone')\n    .populate('clinicId', 'name address phone email')\n    .populate('createdBy', 'firstName lastName');\n\n  if (!schedule) {\n    throw createNotFoundError('Staff schedule');\n  }\n\n  res.json({\n    success: true,\n    data: { schedule }\n  });\n});\n\n// Update staff schedule\nexport const updateStaffSchedule = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const updates = req.body;\n\n  const schedule = await StaffSchedule.findById(id);\n  if (!schedule) {\n    throw createNotFoundError('Staff schedule');\n  }\n\n  // Check for conflicts if time or date is being updated\n  if (updates.date || updates.startTime || updates.endTime) {\n    const newDate = updates.date ? new Date(updates.date) : schedule.date;\n    const newStartTime = updates.startTime || schedule.startTime;\n    const newEndTime = updates.endTime || schedule.endTime;\n    \n    const conflicts = await StaffSchedule.detectConflicts(\n      (schedule.staffId as any).toString(),\n      newDate,\n      newStartTime,\n      newEndTime,\n      id // exclude current schedule\n    );\n    \n    if (conflicts.length > 0) {\n      const conflictDetails = `Overlapping schedule from ${conflicts[0].startTime} to ${conflicts[0].endTime}`;\n      await (Notification as any).createScheduleConflict(\n        (schedule.staffId as any).toString(),\n        (conflicts[0]._id as any).toString(),\n        (schedule.clinicId as any).name || 'Unknown Clinic',\n        newDate,\n        newStartTime,\n        newEndTime,\n        'conflict_detected'\n      );\n      throw createConflictError('Staff member already has a schedule during this time');\n    }\n  }\n\n  const originalData = {\n    date: schedule.date,\n    startTime: schedule.startTime,\n    endTime: schedule.endTime\n  };\n\n  Object.assign(schedule, updates);\n  await schedule.save();\n  await schedule.populate('staffId', 'firstName lastName role email phone');\n  await schedule.populate('clinicId', 'name address');\n\n  // Send schedule change notification if time/date changed\n  if (updates.date || updates.startTime || updates.endTime) {\n    await (Notification as any).createScheduleChange(\n      (schedule.staffId as any)._id.toString(),\n      (schedule._id as any).toString(),\n      (schedule.clinicId as any).name,\n      schedule.date,\n      schedule.startTime,\n      schedule.endTime,\n      'updated'\n    );\n  }\n\n  res.json({\n    success: true,\n    message: 'Staff schedule updated successfully',\n    data: { schedule }\n  });\n});\n\n// Delete staff schedule\nexport const deleteStaffSchedule = catchAsync(async (req: Request, res: Response) => {\n  const schedule = await StaffSchedule.findById(req.params.id);\n  if (!schedule) {\n    throw createNotFoundError('Staff schedule');\n  }\n\n  await StaffSchedule.findByIdAndDelete(req.params.id);\n\n  res.json({\n    success: true,\n    message: 'Staff schedule deleted successfully'\n  });\n});\n\n// Get staff availability for a specific date\nexport const getStaffAvailability = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId, date } = req.query;\n\n  if (!clinicId || !date) {\n    throw createValidationError('query', 'Clinic ID and date are required');\n  }\n\n  // Get all staff assigned to the clinic\n  const allStaff = await User.find({\n    assignedClinics: clinicId,\n    role: { $in: ['dentist', 'staff'] },\n    isActive: true\n  }).select('firstName lastName role email phone');\n\n  // Get scheduled staff for the date\n  const scheduledStaff = await StaffSchedule.find({\n    clinicId,\n    date: new Date(date as string),\n    status: { $in: ['scheduled', 'completed'] }\n  }).populate('staffId', 'firstName lastName role email phone');\n\n  // Create availability map\n  const availability = allStaff.map(staff => {\n    const schedule = scheduledStaff.find(s => s.staffId.toString() === staff._id.toString());\n    return {\n      staff: {\n        id: staff._id,\n        firstName: staff.firstName,\n        lastName: staff.lastName,\n        role: staff.role,\n        email: staff.email,\n        phone: staff.phone\n      },\n      isScheduled: !!schedule,\n      schedule: schedule ? {\n        id: schedule._id,\n        startTime: schedule.startTime,\n        endTime: schedule.endTime,\n        shiftType: schedule.shiftType,\n        status: schedule.status\n      } : null\n    };\n  });\n\n  res.json({\n    success: true,\n    data: {\n      date: new Date(date as string),\n      clinic: clinicId,\n      availability\n    }\n  });\n});\n\n// Get schedule analytics for a clinic\nexport const getScheduleAnalytics = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.params;\n  const { startDate, endDate } = req.query;\n\n  const start = startDate ? new Date(startDate as string) : new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n  const end = endDate ? new Date(endDate as string) : new Date();\n\n  const [scheduleStats, shiftDistribution, staffUtilization] = await Promise.all([\n    // Overall schedule statistics\n    StaffSchedule.aggregate([\n      {\n        $match: {\n          clinicId: clinicId,\n          date: { $gte: start, $lte: end }\n        }\n      },\n      {\n        $group: {\n          _id: '$status',\n          count: { $sum: 1 },\n          totalHours: {\n            $sum: {\n              $divide: [\n                {\n                  $subtract: [\n                    { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$endTime', ':00Z'] } } },\n                    { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$startTime', ':00Z'] } } }\n                  ]\n                },\n                1000 * 60 * 60\n              ]\n            }\n          }\n        }\n      }\n    ]),\n\n    // Shift type distribution\n    StaffSchedule.aggregate([\n      {\n        $match: {\n          clinicId: clinicId,\n          date: { $gte: start, $lte: end }\n        }\n      },\n      {\n        $group: {\n          _id: '$shiftType',\n          count: { $sum: 1 }\n        }\n      }\n    ]),\n\n    // Staff utilization\n    StaffSchedule.aggregate([\n      {\n        $match: {\n          clinicId: clinicId,\n          date: { $gte: start, $lte: end }\n        }\n      },\n      {\n        $group: {\n          _id: '$staffId',\n          totalShifts: { $sum: 1 },\n          totalHours: {\n            $sum: {\n              $divide: [\n                {\n                  $subtract: [\n                    { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$endTime', ':00Z'] } } },\n                    { $dateFromString: { dateString: { $concat: ['1970-01-01T', '$startTime', ':00Z'] } } }\n                  ]\n                },\n                1000 * 60 * 60\n              ]\n            }\n          }\n        }\n      },\n      {\n        $lookup: {\n          from: 'users',\n          localField: '_id',\n          foreignField: '_id',\n          as: 'staff'\n        }\n      },\n      {\n        $unwind: '$staff'\n      },\n      {\n        $project: {\n          staffName: { $concat: ['$staff.firstName', ' ', '$staff.lastName'] },\n          role: '$staff.role',\n          totalShifts: 1,\n          totalHours: 1\n        }\n      },\n      {\n        $sort: { totalHours: -1 }\n      }\n    ])\n  ]);\n\n  res.json({\n    success: true,\n    data: {\n      dateRange: { start, end },\n      scheduleStats,\n      shiftDistribution,\n      staffUtilization\n    }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\supplierController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[665,668],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[665,668],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[994,997],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[994,997],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1129,1132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1129,1132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1285,1288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1285,1288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1671,1674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1671,1674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1906,1909],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1906,1909],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2742,2745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2742,2745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3141,3144],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3141,3144],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3346,3349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3346,3349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":144,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3818,3821],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3818,3821],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4096,4099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4096,4099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4389,4392],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4389,4392],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":175,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":175,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4687,4690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4687,4690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":188,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":188,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5035,5038],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5035,5038],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5174,5177],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5174,5177],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5867,5870],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5867,5870],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":222,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5998,6001],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5998,6001],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":242,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":242,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6503,6506],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6503,6506],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":245,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6626,6629],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6626,6629],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":254,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":254,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6956,6959],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6956,6959],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7202,7205],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7202,7205],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":21,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { AuthenticatedRequest } from '../types';\nimport { Supplier, InventoryItem } from '../models';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport {\n  getPaginationParams,\n  createPaginatedResponse\n} from '../utils/helpers';\n\n// Get all suppliers with filtering and pagination\nexport const getSuppliers = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit } = getPaginationParams(req);\n  const { \n    isActive,\n    search,\n    sortBy = 'name',\n    sortOrder = 'asc'\n  } = req.query;\n\n  // Build query\n  const query: any = {};\n  \n  if (isActive !== undefined) query.isActive = isActive === 'true';\n  \n  if (search) {\n    query.$or = [\n      { name: { $regex: search, $options: 'i' } },\n      { contactPerson: { $regex: search, $options: 'i' } },\n      { email: { $regex: search, $options: 'i' } }\n    ];\n  }\n\n  // Build sort object\n  const sort: any = {};\n  sort[sortBy as string] = sortOrder === 'desc' ? -1 : 1;\n\n  const [suppliers, total] = await Promise.all([\n    (Supplier as any).find(query)\n      .populate('createdBy', 'firstName lastName')\n      .sort(sort)\n      .skip((page - 1) * limit)\n      .limit(limit),\n    (Supplier as any).countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(suppliers, total, page, limit);\n  res.json({\n    message: 'Suppliers retrieved successfully',\n    ...paginatedResponse\n  });\n});\n\n// Get single supplier\nexport const getSupplier = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const supplier = await (Supplier as any).findById(id)\n    .populate('createdBy updatedBy', 'firstName lastName');\n\n  if (!supplier) {\n    throw createNotFoundError('Supplier');\n  }\n\n  // Get items supplied by this supplier\n  const suppliedItems = await (InventoryItem as any).find({ supplier: id, isActive: true })\n    .select('name sku category currentStock minimumStock')\n    .sort({ name: 1 });\n\n  // Calculate total inventory value from this supplier\n  const inventoryValue = suppliedItems.reduce(\n    (sum, item) => sum + (item.currentStock * item.costPrice || 0), 0\n  );\n\n  res.json({\n    success: true,\n    message: 'Supplier retrieved successfully',\n    data: {\n      supplier,\n      suppliedItems: {\n        items: suppliedItems,\n        count: suppliedItems.length,\n        totalValue: inventoryValue\n      }\n    }\n  });\n});\n\n// Create new supplier\nexport const createSupplier = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const supplierData = {\n    ...req.body,\n    createdBy: req.user!.id,\n    totalOrders: 0,\n    totalSpent: 0\n  };\n\n  const supplier = await (Supplier as any).create(supplierData);\n\n  await supplier.populate('createdBy', 'firstName lastName');\n\n  res.status(201).json({\n    success: true,\n    message: 'Supplier created successfully',\n    data: { supplier }\n  });\n});\n\n// Update supplier\nexport const updateSupplier = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  \n  const supplier = await (Supplier as any).findById(id);\n  if (!supplier) {\n    throw createNotFoundError('Supplier');\n  }\n\n  const updateData = {\n    ...req.body,\n    updatedBy: req.user!.id\n  };\n\n  const updatedSupplier = await (Supplier as any).findByIdAndUpdate(\n    id,\n    updateData,\n    { new: true, runValidators: true }\n  ).populate('createdBy updatedBy', 'firstName lastName');\n\n  res.json({\n    success: true,\n    message: 'Supplier updated successfully',\n    data: { supplier: updatedSupplier }\n  });\n});\n\n// Delete supplier (soft delete)\nexport const deleteSupplier = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const supplier = await (Supplier as any).findById(id);\n  if (!supplier) {\n    throw createNotFoundError('Supplier');\n  }\n\n  // Check if supplier has inventory items\n  const hasItems = await InventoryItem.exists({ supplier: id });\n  if (hasItems) {\n    // Soft delete - just mark as inactive\n    await (Supplier as any).findByIdAndUpdate(id, { \n      isActive: false,\n      updatedBy: req.user!.id\n    });\n    \n    res.json({\n      success: true,\n      message: 'Supplier deactivated successfully (has existing inventory items)'\n    });\n  } else {\n    // Hard delete if no items exist\n    await (Supplier as any).findByIdAndDelete(id);\n    \n    res.json({\n      success: true,\n      message: 'Supplier deleted successfully'\n    });\n  }\n});\n\n// Get active suppliers (for dropdowns)\nexport const getActiveSuppliers = catchAsync(async (req: Request, res: Response) => {\n  const suppliers = await (Supplier as any).findActive();\n\n  res.json({\n    success: true,\n    message: 'Active suppliers retrieved successfully',\n    data: { suppliers }\n  });\n});\n\n// Get supplier performance summary\nexport const getSupplierPerformance = catchAsync(async (req: Request, res: Response) => {\n  const { supplierId } = req.params;\n\n  const performance = await (Supplier as any).getPerformanceSummary(supplierId);\n\n  // Get recent orders/purchases from this supplier\n  const recentItems = await (InventoryItem as any).find(\n    supplierId ? { supplier: supplierId } : { supplier: { $exists: true } }\n  )\n    .populate('supplier', 'name')\n    .sort({ lastRestocked: -1 })\n    .limit(10);\n\n  res.json({\n    success: true,\n    message: 'Supplier performance retrieved successfully',\n    data: {\n      performance,\n      recentItems\n    }\n  });\n});\n\n// Update supplier rating\nexport const updateSupplierRating = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { rating, notes } = req.body;\n\n  if (!rating || rating < 1 || rating > 5) {\n    throw createValidationError('rating', 'Rating must be between 1 and 5');\n  }\n\n  const supplier = await (Supplier as any).findById(id);\n  if (!supplier) {\n    throw createNotFoundError('Supplier');\n  }\n\n  const updatedSupplier = await (Supplier as any).findByIdAndUpdate(\n    id,\n    { \n      rating,\n      notes: notes || supplier.notes,\n      updatedBy: req.user!.id\n    },\n    { new: true, runValidators: true }\n  );\n\n  res.json({\n    success: true,\n    message: 'Supplier rating updated successfully',\n    data: { supplier: updatedSupplier }\n  });\n});\n\n// Get suppliers dashboard data\nexport const getSuppliersDashboard = catchAsync(async (req: Request, res: Response) => {\n  // Get total suppliers count\n  const totalSuppliers = await (Supplier as any).countDocuments({ isActive: true });\n  \n  // Get supplier performance summary\n  const performance = await (Supplier as any).getPerformanceSummary();\n  \n  // Get top suppliers by spending\n  const topSuppliers = performance.slice(0, 5);\n  \n  // Get suppliers without recent activity (no orders in last 6 months)\n  const sixMonthsAgo = new Date();\n  sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);\n  \n  const inactiveSuppliers = await (Supplier as any).find({\n    isActive: true,\n    $or: [\n      { totalOrders: 0 },\n      { updatedAt: { $lt: sixMonthsAgo } }\n    ]\n  }).select('name contactPerson email totalOrders');\n\n  // Get average supplier rating\n  const ratingStats = await (Supplier as any).aggregate([\n    { $match: { isActive: true, rating: { $exists: true } } },\n    {\n      $group: {\n        _id: null,\n        averageRating: { $avg: '$rating' },\n        totalRatedSuppliers: { $sum: 1 }\n      }\n    }\n  ]);\n\n  res.json({\n    success: true,\n    message: 'Suppliers dashboard data retrieved successfully',\n    data: {\n      totalSuppliers,\n      topSuppliers,\n      inactiveSuppliers: {\n        suppliers: inactiveSuppliers,\n        count: inactiveSuppliers.length\n      },\n      ratings: {\n        average: ratingStats[0]?.averageRating || 0,\n        totalRated: ratingStats[0]?.totalRatedSuppliers || 0\n      },\n      performance: performance.length > 5 ? performance.slice(0, 10) : performance\n    }\n  });\n});\n\n// Import suppliers from CSV\nexport const importSuppliers = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  // TODO: Implement CSV import functionality\n  res.status(501).json({\n    success: false,\n    message: 'CSV import functionality not yet implemented'\n  });\n});\n\n// Export suppliers to CSV\nexport const exportSuppliers = catchAsync(async (req: Request, res: Response) => {\n  // TODO: Implement CSV export functionality\n  res.status(501).json({\n    success: false,\n    message: 'CSV export functionality not yet implemented'\n  });\n});\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\treatmentController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createSearchRegex' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDate' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[803,806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[803,806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[844,847],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[844,847],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2295,2298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2295,2298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5945,5948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5945,5948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":228,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6453,6456],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6453,6456],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8152,8155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8152,8155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":408,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":408,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11795,11798],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11795,11798],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":470,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":470,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13280,13283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13280,13283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":501,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":501,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13997,14000],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13997,14000],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { TreatmentRecord, Patient, User, Clinic } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse,\n  createSearchRegex,\n  formatDate\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport { uploadTreatmentAttachment } from '../utils/upload';\n\n// Create new treatment record\nexport const createTreatmentRecord = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const {\n    patientId,\n    clinicId,\n    procedure,\n    diagnosis,\n    notes,\n    date\n  } = req.body;\n\n  // Verify patient and clinic exist\n  const [patient, clinic] = await Promise.all([\n    (Patient as any).findById(patientId),\n    (Clinic as any).findById(clinicId)\n  ]);\n\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  // Verify dentist is assigned to the clinic\n  const dentist = await User.findById(req.user._id);\n  if (!dentist?.assignedClinics.includes(clinicId)) {\n    throw createValidationError('clinicId', 'You are not assigned to this clinic');\n  }\n\n  const treatmentRecord = new TreatmentRecord({\n    patientId,\n    dentistId: req.user._id,\n    clinicId,\n    procedure,\n    diagnosis,\n    notes,\n    date: date ? new Date(date) : new Date()\n  });\n\n  await treatmentRecord.save();\n\n  // Add to patient's treatment records\n  patient.treatmentRecords.push(treatmentRecord._id);\n  await patient.save();\n\n  // Populate and return\n  await treatmentRecord.populate([\n    { path: 'patientId', select: 'firstName lastName email dateOfBirth' },\n    { path: 'dentistId', select: 'firstName lastName specialization' },\n    { path: 'clinicId', select: 'name address' }\n  ]);\n\n  res.status(201).json({\n    success: true,\n    message: 'Treatment record created successfully',\n    data: { treatmentRecord }\n  });\n});\n\n// Get all treatment records\nexport const getAllTreatmentRecords = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { patientId, dentistId, clinicId, startDate, endDate, procedure } = req.query;\n\n  // Build query\n  const query: any = {};\n\n  if (patientId) {\n    query.patientId = patientId;\n  }\n\n  if (dentistId) {\n    query.dentistId = dentistId;\n  }\n\n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n\n  if (procedure) {\n    query.procedure = { $regex: new RegExp(procedure as string, 'i') };\n  }\n\n  // Date range filter\n  if (startDate || endDate) {\n    query.date = {};\n    if (startDate) {\n      query.date.$gte = new Date(startDate as string);\n    }\n    if (endDate) {\n      query.date.$lte = new Date(endDate as string);\n    }\n  }\n\n  // Get treatment records with pagination\n  const [treatmentRecords, total] = await Promise.all([\n    TreatmentRecord.find(query)\n      .populate('patientId', 'firstName lastName email dateOfBirth')\n      .populate('dentistId', 'firstName lastName specialization')\n      .populate('clinicId', 'name address')\n      .sort({ date: -1 })\n      .skip(skip)\n      .limit(limit),\n    TreatmentRecord.countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(treatmentRecords, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get treatment record by ID\nexport const getTreatmentRecordById = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const treatmentRecord = await TreatmentRecord.findById(id)\n    .populate('patientId', 'firstName lastName email dateOfBirth gender address medicalHistory')\n    .populate('dentistId', 'firstName lastName specialization email phone')\n    .populate('clinicId', 'name address phone email');\n\n  if (!treatmentRecord) {\n    throw createNotFoundError('Treatment record');\n  }\n\n  res.json({\n    success: true,\n    data: { treatmentRecord }\n  });\n});\n\n// Update treatment record\nexport const updateTreatmentRecord = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const {\n    procedure,\n    diagnosis,\n    notes,\n    date\n  } = req.body;\n\n  const treatmentRecord = await TreatmentRecord.findById(id);\n  if (!treatmentRecord) {\n    throw createNotFoundError('Treatment record');\n  }\n\n  // Check if user is the dentist who created the record or an admin\n  if (treatmentRecord.dentistId.toString() !== req.user._id.toString() && req.user.role !== 'admin') {\n    throw createValidationError('authorization', 'You can only update your own treatment records');\n  }\n\n  // Update fields\n  if (procedure) treatmentRecord.procedure = procedure;\n  if (diagnosis) treatmentRecord.diagnosis = diagnosis;\n  if (notes) treatmentRecord.notes = notes;\n  if (date) treatmentRecord.date = new Date(date);\n\n  await treatmentRecord.save();\n\n  // Populate and return updated record\n  await treatmentRecord.populate([\n    { path: 'patientId', select: 'firstName lastName email' },\n    { path: 'dentistId', select: 'firstName lastName specialization' },\n    { path: 'clinicId', select: 'name address' }\n  ]);\n\n  res.json({\n    success: true,\n    message: 'Treatment record updated successfully',\n    data: { treatmentRecord }\n  });\n});\n\n// Delete treatment record\nexport const deleteTreatmentRecord = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n\n  const treatmentRecord = await TreatmentRecord.findById(id);\n  if (!treatmentRecord) {\n    throw createNotFoundError('Treatment record');\n  }\n\n  // Check if user is the dentist who created the record or an admin\n  if (treatmentRecord.dentistId.toString() !== req.user._id.toString() && req.user.role !== 'admin') {\n    throw createValidationError('authorization', 'You can only delete your own treatment records');\n  }\n\n  // Remove from patient's treatment records\n  await (Patient as any).findByIdAndUpdate(\n    treatmentRecord.patientId,\n    { $pull: { treatmentRecords: id } }\n  );\n\n  await TreatmentRecord.findByIdAndDelete(id);\n\n  res.json({\n    success: true,\n    message: 'Treatment record deleted successfully'\n  });\n});\n\n// Get treatment records by patient\nexport const getTreatmentRecordsByPatient = catchAsync(async (req: Request, res: Response) => {\n  const { patientId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const patient = await (Patient as any).findById(patientId);\n  if (!patient) {\n    throw createNotFoundError('Patient');\n  }\n\n  const [treatmentRecords, total] = await Promise.all([\n    TreatmentRecord.findByPatient(patientId).skip(skip).limit(limit),\n    TreatmentRecord.countDocuments({ patientId })\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(treatmentRecords, total, page, limit);\n\n  res.json({\n    success: true,\n    data: {\n      patient: {\n        _id: patient._id,\n        fullName: patient.fullName,\n        email: patient.email\n      },\n      treatmentRecords: paginatedResponse\n    }\n  });\n});\n\n// Get treatment records by dentist\nexport const getTreatmentRecordsByDentist = catchAsync(async (req: Request, res: Response) => {\n  const { dentistId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const dentist = await User.findById(dentistId);\n  if (!dentist) {\n    throw createNotFoundError('Dentist');\n  }\n\n  const [treatmentRecords, total] = await Promise.all([\n    TreatmentRecord.findByDentist(dentistId).skip(skip).limit(limit),\n    TreatmentRecord.countDocuments({ dentistId })\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(treatmentRecords, total, page, limit);\n\n  res.json({\n    success: true,\n    data: {\n      dentist: {\n        _id: dentist._id,\n        fullName: dentist.fullName,\n        specialization: dentist.specialization\n      },\n      treatmentRecords: paginatedResponse\n    }\n  });\n});\n\n// Get treatment records by clinic\nexport const getTreatmentRecordsByClinic = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  const clinic = await (Clinic as any).findById(clinicId);\n  if (!clinic) {\n    throw createNotFoundError('Clinic');\n  }\n\n  const [treatmentRecords, total] = await Promise.all([\n    TreatmentRecord.findByClinic(clinicId).skip(skip).limit(limit),\n    TreatmentRecord.countDocuments({ clinicId })\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(treatmentRecords, total, page, limit);\n\n  res.json({\n    success: true,\n    data: {\n      clinic: {\n        _id: clinic._id,\n        name: clinic.name,\n        address: `${clinic.address.street}, ${clinic.address.city}, ${clinic.address.state} ${clinic.address.zipCode}, ${clinic.address.country}`\n      },\n      treatmentRecords: paginatedResponse\n    }\n  });\n});\n\n// Search treatment records\nexport const searchTreatmentRecords = catchAsync(async (req: Request, res: Response) => {\n  const { q: searchTerm } = req.query;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  if (!searchTerm) {\n    throw createValidationError('q', 'Search term is required');\n  }\n\n  const [treatmentRecords, total] = await TreatmentRecord.searchTreatmentRecords(\n    searchTerm as string,\n    { skip, limit }\n  );\n\n  const paginatedResponse = createPaginatedResponse(treatmentRecords, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Add attachment to treatment record\nexport const addAttachment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id } = req.params;\n  const { description } = req.body;\n\n  if (!req.file) {\n    throw createValidationError('file', 'Attachment file is required');\n  }\n\n  const treatmentRecord = await TreatmentRecord.findById(id);\n  if (!treatmentRecord) {\n    throw createNotFoundError('Treatment record');\n  }\n\n  // Check if user is the dentist who created the record or an admin\n  if (treatmentRecord.dentistId.toString() !== req.user._id.toString() && req.user.role !== 'admin') {\n    throw createValidationError('authorization', 'You can only add attachments to your own treatment records');\n  }\n\n  // Upload file\n  const uploadResult = await uploadTreatmentAttachment(\n    req.file,\n    treatmentRecord.patientId.toString(),\n    treatmentRecord._id.toString()\n  );\n\n  // Add attachment to treatment record\n  const attachment = {\n    filename: req.file.originalname,\n    url: uploadResult.secure_url,\n    fileType: req.file.mimetype,\n    fileSize: req.file.size,\n    description: description || '',\n    uploadedAt: new Date()\n  };\n\n  treatmentRecord.addAttachment(attachment);\n  await treatmentRecord.save();\n\n  res.json({\n    success: true,\n    message: 'Attachment added successfully',\n    data: { attachment }\n  });\n});\n\n// Remove attachment from treatment record\nexport const removeAttachment = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { id, attachmentId } = req.params;\n\n  const treatmentRecord = await TreatmentRecord.findById(id);\n  if (!treatmentRecord) {\n    throw createNotFoundError('Treatment record');\n  }\n\n  // Check if user is the dentist who created the record or an admin\n  if (treatmentRecord.dentistId.toString() !== req.user._id.toString() && req.user.role !== 'admin') {\n    throw createValidationError('authorization', 'You can only remove attachments from your own treatment records');\n  }\n\n  treatmentRecord.removeAttachment(attachmentId);\n  await treatmentRecord.save();\n\n  res.json({\n    success: true,\n    message: 'Attachment removed successfully'\n  });\n});\n\n// Get treatment statistics\nexport const getTreatmentStatistics = catchAsync(async (req: Request, res: Response) => {\n  const { dentistId, clinicId, startDate, endDate } = req.query;\n\n  const matchQuery: any = {};\n\n  if (dentistId) {\n    matchQuery.dentistId = dentistId;\n  }\n\n  if (clinicId) {\n    matchQuery.clinicId = clinicId;\n  }\n\n  if (startDate && endDate) {\n    matchQuery.date = {\n      $gte: new Date(startDate as string),\n      $lte: new Date(endDate as string)\n    };\n  }\n\n  const [procedureStats, totalTreatments, recentTreatments] = await Promise.all([\n    TreatmentRecord.aggregate([\n      { $match: matchQuery },\n      {\n        $group: {\n          _id: '$procedure',\n          count: { $sum: 1 }\n        }\n      },\n      { $sort: { count: -1 } },\n      { $limit: 10 }\n    ]),\n    TreatmentRecord.countDocuments(matchQuery),\n    TreatmentRecord.find(matchQuery)\n      .populate('patientId', 'firstName lastName')\n      .populate('dentistId', 'firstName lastName')\n      .sort({ date: -1 })\n      .limit(5)\n  ]);\n\n  // Format procedure statistics\n  const procedureDistribution = procedureStats.reduce((acc, item) => {\n    acc[item._id] = item.count;\n    return acc;\n  }, {});\n\n  res.json({\n    success: true,\n    data: {\n      totalTreatments,\n      procedureDistribution,\n      recentTreatments\n    }\n  });\n});\n\n// Get treatment records by date range\nexport const getTreatmentRecordsByDateRange = catchAsync(async (req: Request, res: Response) => {\n  const { startDate, endDate } = req.query;\n  const { dentistId, clinicId } = req.query;\n\n  if (!startDate || !endDate) {\n    throw createValidationError('query', 'Start date and end date are required');\n  }\n\n  const query: any = {\n    date: {\n      $gte: new Date(startDate as string),\n      $lte: new Date(endDate as string)\n    }\n  };\n\n  if (dentistId) {\n    query.dentistId = dentistId;\n  }\n\n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n\n  const treatmentRecords = await TreatmentRecord.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .sort({ date: -1 });\n\n  res.json({\n    success: true,\n    data: { treatmentRecords }\n  });\n});\n\n// Get recent treatment records\nexport const getRecentTreatmentRecords = catchAsync(async (req: Request, res: Response) => {\n  const { limit = 10, dentistId, clinicId } = req.query;\n\n  const query: any = {};\n\n  if (dentistId) {\n    query.dentistId = dentistId;\n  }\n\n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n\n  const treatmentRecords = await TreatmentRecord.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .sort({ date: -1 })\n    .limit(parseInt(limit as string));\n\n  res.json({\n    success: true,\n    data: { treatmentRecords }\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\controllers\\userController.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[666,669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[666,669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":181,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4554,4557],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4554,4557],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":214,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5359,5362],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5359,5362],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6060,6063],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6060,6063],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":343,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":343,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8936,8939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8936,8939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response } from 'express';\nimport { User } from '../models';\nimport { AuthenticatedRequest } from '../types';\nimport {\n  getPaginationParams,\n  createPaginatedResponse,\n  createSearchRegex\n} from '../utils/helpers';\nimport {\n  AppError,\n  catchAsync,\n  createNotFoundError,\n  createValidationError\n} from '../middleware/errorHandler';\nimport { uploadProfileImage } from '../utils/upload';\n\n// Get all users (admin only)\nexport const getAllUsers = catchAsync(async (req: Request, res: Response) => {\n  const { page, limit, skip } = getPaginationParams(req);\n  const { search, role, isActive, clinicId } = req.query;\n\n  // Build query\n  const query: any = {};\n\n  if (search) {\n    const searchRegex = createSearchRegex(search as string);\n    query.$or = [\n      { firstName: searchRegex },\n      { lastName: searchRegex },\n      { email: searchRegex },\n      { phone: searchRegex }\n    ];\n  }\n\n  if (role) {\n    query.role = role;\n  }\n\n  if (isActive !== undefined) {\n    query.isActive = isActive === 'true';\n  }\n\n  if (clinicId) {\n    query.assignedClinics = clinicId;\n  }\n\n  // Get users with pagination\n  const [users, total] = await Promise.all([\n    User.find(query)\n      .populate('assignedClinics', 'name address')\n      .populate('preferredClinicId', 'name address')\n      .select('-password')\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(limit),\n    User.countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(users, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get user by ID\nexport const getUserById = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  console.log('getUserById called with ID:', id);\n\n  const user = await User.findById(id)\n    .populate('assignedClinics', 'name address phone')\n    .populate('preferredClinicId', 'name address phone')\n    .select('-password');\n\n  console.log('User found:', user ? 'Yes' : 'No');\n  if (user) {\n    console.log('User data:', {\n      id: user._id,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      email: user.email,\n      role: user.role\n    });\n  }\n\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  res.json({\n    success: true,\n    data: user\n  });\n});\n\n// Update user (admin only)\nexport const updateUser = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const {\n    firstName,\n    lastName,\n    email,\n    phone,\n    role,\n    isActive,\n    assignedClinics,\n    preferredClinicId,\n    specialization,\n    licenseNumber,\n    bio\n  } = req.body;\n\n  const user = await User.findById(id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Check if email is being changed and if it's already taken\n  if (email && email !== user.email) {\n    const existingUser = await User.findOne({ email: email.toLowerCase() });\n    if (existingUser) {\n      throw createValidationError('email', 'Email is already taken');\n    }\n    user.email = email.toLowerCase();\n  }\n\n  // Update fields\n  if (firstName) user.firstName = firstName;\n  if (lastName) user.lastName = lastName;\n  if (phone) user.phone = phone;\n  if (role) user.role = role;\n  if (isActive !== undefined) user.isActive = isActive;\n  if (assignedClinics) user.assignedClinics = assignedClinics;\n  if (preferredClinicId) user.preferredClinicId = preferredClinicId;\n  if (specialization) user.specialization = specialization;\n  if (licenseNumber) user.licenseNumber = licenseNumber;\n  if (bio) user.bio = bio;\n\n  await user.save();\n\n  // Populate and return updated user\n  const updatedUser = await User.findById(id)\n    .populate('assignedClinics', 'name address')\n    .populate('preferredClinicId', 'name address')\n    .select('-password');\n\n  res.json({\n    success: true,\n    message: 'User updated successfully',\n    data: { user: updatedUser }\n  });\n});\n\n// Delete user (admin only)\nexport const deleteUser = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const user = await User.findById(id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Soft delete by deactivating\n  user.isActive = false;\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'User deleted successfully'\n  });\n});\n\n// Get users by role\nexport const getUsersByRole = catchAsync(async (req: Request, res: Response) => {\n  const { role } = req.params;\n  const { page, limit, skip } = getPaginationParams(req);\n  const { clinicId, isActive = 'true' } = req.query;\n\n  const query: any = {\n    role,\n    isActive: isActive === 'true'\n  };\n\n  if (clinicId) {\n    query.assignedClinics = clinicId;\n  }\n\n  const [users, total] = await Promise.all([\n    User.find(query)\n      .populate('assignedClinics', 'name')\n      .select('firstName lastName email phone specialization licenseNumber')\n      .sort({ firstName: 1 })\n      .skip(skip)\n      .limit(limit),\n    User.countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(users, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get dentists with enhanced error handling\nexport const getDentists = catchAsync(async (req: Request, res: Response) => {\n  const { clinicId } = req.query;\n  \n  console.log('getDentists called with clinicId:', clinicId);\n  \n  const query: any = {\n    role: 'dentist',\n    isActive: true\n  };\n\n  if (clinicId) {\n    query.assignedClinics = clinicId;\n  }\n\n  console.log('Dentist query:', JSON.stringify(query, null, 2));\n\n  const dentists = await User.find(query)\n    .populate('assignedClinics', 'name')\n    .select('firstName lastName email phone specialization licenseNumber profileImage')\n    .sort({ firstName: 1 });\n\n  console.log(`Found ${dentists.length} dentists for query`);\n\n  // If specific clinic requested but no dentists found, return 404 instead of 401\n  if (clinicId && dentists.length === 0) {\n    // First verify the clinic exists\n    const Clinic = require('../models/Clinic').default;\n    const clinic = await (Clinic as any).findById(clinicId);\n    \n    if (!clinic) {\n      return res.status(404).json({\n        success: false,\n        message: 'Clinic not found',\n        data: { dentists: [] }\n      });\n    }\n    \n    // Clinic exists but has no dentists assigned\n    return res.status(200).json({\n      success: true,\n      data: { dentists: [] },\n      message: `No dentists are currently assigned to clinic \"${clinic.name}\". Please contact administration to assign dentists.`\n    });\n  }\n\n  res.json({\n    success: true,\n    data: { dentists },\n    message: dentists.length > 0 ? undefined : 'No dentists found in the system'\n  });\n});\n\n// Assign clinic to user\nexport const assignClinicToUser = catchAsync(async (req: Request, res: Response) => {\n  const { userId } = req.params;\n  const { clinicId } = req.body;\n\n  const user = await User.findById(userId);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Add clinic to assigned clinics if not already assigned\n  if (!user.assignedClinics.includes(clinicId)) {\n    user.assignedClinics.push(clinicId);\n    await user.save();\n  }\n\n  res.json({\n    success: true,\n    message: 'Clinic assigned to user successfully'\n  });\n});\n\n// Remove clinic from user\nexport const removeClinicFromUser = catchAsync(async (req: Request, res: Response) => {\n  const { userId, clinicId } = req.params;\n\n  const user = await User.findById(userId);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Remove clinic from assigned clinics\n  user.assignedClinics = user.assignedClinics.filter(\n    clinic => clinic.toString() !== clinicId\n  );\n\n  // If this was the preferred clinic, clear it\n  if (user.preferredClinicId?.toString() === clinicId) {\n    user.preferredClinicId = undefined;\n  }\n\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Clinic removed from user successfully'\n  });\n});\n\n// Set preferred clinic\nexport const setPreferredClinic = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  const { clinicId } = req.body;\n\n  const user = await User.findById(req.user._id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Check if user is assigned to this clinic\n  if (!user.assignedClinics.includes(clinicId)) {\n    throw createValidationError('clinicId', 'You are not assigned to this clinic');\n  }\n\n  user.preferredClinicId = clinicId;\n  await user.save();\n\n  res.json({\n    success: true,\n    message: 'Preferred clinic set successfully'\n  });\n});\n\n// Get user's assigned clinics\nexport const getUserClinics = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const user = await User.findById(id).populate('assignedClinics', 'name address phone email');\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // Transform the clinic data to match the expected frontend format\n  const clinics = user.assignedClinics.map((clinic: any) => ({\n    id: clinic._id,\n    clinicId: clinic._id,\n    name: clinic.name,\n    clinicName: clinic.name,\n    branchName: clinic.branchName || null,\n    address: clinic.address || {\n      street: '',\n      city: '',\n      state: '',\n      zipCode: '',\n      country: ''\n    },\n    phone: clinic.phone || '',\n    email: clinic.email || '',\n    isPrimary: user.preferredClinicId?.toString() === clinic._id.toString()\n  }));\n\n  res.json({\n    success: true,\n    data: clinics,\n    message: clinics.length > 0 ? undefined : 'No clinics assigned to this user'\n  });\n});\n\n// Get user's availability schedule\nexport const getUserAvailability = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n\n  const user = await User.findById(id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // For now, return empty availability since we don't have a specific availability model\n  // In a real application, you would fetch from a UserAvailability or Schedule model\n  const availability = [];\n\n  res.json({\n    success: true,\n    data: availability,\n    message: 'User availability retrieved successfully'\n  });\n});\n\n// Update user's availability schedule\nexport const updateUserAvailability = catchAsync(async (req: Request, res: Response) => {\n  const { id } = req.params;\n  const { availability } = req.body;\n\n  const user = await User.findById(id);\n  if (!user) {\n    throw createNotFoundError('User');\n  }\n\n  // For now, just return the provided availability since we don't have a specific availability model\n  // In a real application, you would save to a UserAvailability or Schedule model\n  \n  res.json({\n    success: true,\n    data: availability || [],\n    message: 'User availability updated successfully'\n  });\n});\n\n// Upload profile image\nexport const uploadUserProfileImage = catchAsync(async (req: AuthenticatedRequest, res: Response) => {\n  console.log('Upload profile image called');\n  console.log('File received:', req.file ? 'Yes' : 'No');\n  console.log('User:', req.user ? req.user._id : 'No user');\n\n  if (!req.file) {\n    console.log('No file in request');\n    throw createValidationError('file', 'Profile image is required');\n  }\n\n  const user = await User.findById(req.user._id);\n  if (!user) {\n    console.log('User not found:', req.user._id);\n    throw createNotFoundError('User');\n  }\n\n  console.log('Uploading file:', req.file.originalname, 'Size:', req.file.size);\n\n  try {\n    // Upload image to cloud storage\n    const uploadResult = await uploadProfileImage(req.file, user._id.toString());\n    console.log('Upload successful:', uploadResult.secure_url);\n\n    // Update user profile image\n    user.profileImage = uploadResult.secure_url;\n    await user.save();\n\n    res.json({\n      success: true,\n      message: 'Profile image uploaded successfully',\n      data: {\n        profileImage: uploadResult.secure_url\n      }\n    });\n  } catch (uploadError) {\n    console.error('Upload error:', uploadError);\n    throw uploadError;\n  }\n});\n\n// Get user statistics (admin only)\nexport const getUserStatistics = catchAsync(async (req: Request, res: Response) => {\n  const [totalUsers, activeUsers, usersByRole] = await Promise.all([\n    User.countDocuments(),\n    User.countDocuments({ isActive: true }),\n    User.aggregate([\n      {\n        $group: {\n          _id: '$role',\n          count: { $sum: 1 }\n        }\n      }\n    ])\n  ]);\n\n  // Format role statistics\n  const roleStats = usersByRole.reduce((acc, item) => {\n    acc[item._id] = item.count;\n    return acc;\n  }, {});\n\n  res.json({\n    success: true,\n    data: {\n      totalUsers,\n      activeUsers,\n      inactiveUsers: totalUsers - activeUsers,\n      usersByRole: roleStats\n    }\n  });\n});\n\n// Search users\nexport const searchUsers = catchAsync(async (req: Request, res: Response) => {\n  const { q: searchTerm } = req.query;\n  const { page, limit, skip } = getPaginationParams(req);\n\n  if (!searchTerm) {\n    throw createValidationError('q', 'Search term is required');\n  }\n\n  const searchRegex = createSearchRegex(searchTerm as string);\n  const query = {\n    $or: [\n      { firstName: searchRegex },\n      { lastName: searchRegex },\n      { email: searchRegex },\n      { phone: searchRegex }\n    ],\n    isActive: true\n  };\n\n  const [users, total] = await Promise.all([\n    User.find(query)\n      .select('firstName lastName email phone role profileImage')\n      .sort({ firstName: 1 })\n      .skip(skip)\n      .limit(limit),\n    User.countDocuments(query)\n  ]);\n\n  const paginatedResponse = createPaginatedResponse(users, total, page, limit);\n\n  res.json({\n    success: true,\n    data: paginatedResponse\n  });\n});\n\n// Get recently registered users (admin only)\nexport const getRecentUsers = catchAsync(async (req: Request, res: Response) => {\n  const { limit = 10 } = req.query;\n\n  const users = await User.find({ isActive: true })\n    .select('firstName lastName email role createdAt')\n    .sort({ createdAt: -1 })\n    .limit(parseInt(limit as string));\n\n  res.json({\n    success: true,\n    data: { users }\n  });\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\appointmentValidation.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'body' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":211,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6126,6129],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6126,6129],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\nimport { body } from 'express-validator';\nimport DoctorSchedule from '../models/DoctorSchedule';\nimport { Clinic, User, Appointment } from '../models';\nimport { AppError } from '../middleware/errorHandler';\nimport { getDay } from 'date-fns';\n\n/**\n * Validates that the appointment time falls within doctor's schedule for the selected branch\n */\nexport const validateDoctorSchedule = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const { dentistId, clinicId, date, timeSlot, duration = 30 } = req.body;\n\n    // If no dentist is specified, skip this validation (appointment can be created without a specific dentist)\n    if (!dentistId) {\n      return next();\n    }\n\n    // Convert date to day of week (0 = Sunday, 1 = Monday, ..., 6 = Saturday)\n    const appointmentDate = new Date(date);\n    const dayOfWeek = getDay(appointmentDate);\n\n    // Find doctor's schedule for this day and clinic\n    const schedules = await DoctorSchedule.findByDoctorAndDay(\n      dentistId,\n      dayOfWeek,\n      clinicId\n    );\n\n    if (!schedules || schedules.length === 0) {\n      throw new AppError(\n        `Doctor is not scheduled to work at this clinic on ${appointmentDate.toLocaleDateString('en-US', { weekday: 'long' })}`,\n        400\n      );\n    }\n\n    // Check if the time slot falls within any of the doctor's schedules\n    const [hours, minutes] = timeSlot.split(':').map(Number);\n    const appointmentTimeInMinutes = hours * 60 + minutes;\n    const appointmentEndTimeInMinutes = appointmentTimeInMinutes + duration;\n\n    let isWithinSchedule = false;\n\n    for (const schedule of schedules) {\n      const [startHour, startMinute] = schedule.startTime.split(':').map(Number);\n      const [endHour, endMinute] = schedule.endTime.split(':').map(Number);\n\n      const scheduleStartInMinutes = startHour * 60 + startMinute;\n      const scheduleEndInMinutes = endHour * 60 + endMinute;\n\n      // Check if appointment falls within this schedule\n      if (\n        appointmentTimeInMinutes >= scheduleStartInMinutes &&\n        appointmentEndTimeInMinutes <= scheduleEndInMinutes\n      ) {\n        isWithinSchedule = true;\n        break;\n      }\n    }\n\n    if (!isWithinSchedule) {\n      const scheduleInfo = schedules\n        .map(s => `${s.startTime} - ${s.endTime}`)\n        .join(', ');\n      throw new AppError(\n        `The selected time slot is outside the doctor's working hours for this day. Available hours: ${scheduleInfo}`,\n        400\n      );\n    }\n\n    next();\n  } catch (error) {\n    next(error);\n  }\n};\n\n/**\n * Validates that the appointment time falls within clinic operating hours\n */\nexport const validateClinicOperatingHours = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const { clinicId, date, timeSlot, duration = 30 } = req.body;\n\n    // Find clinic\n    const clinic = await Clinic.findById(clinicId);\n    if (!clinic) {\n      throw new AppError('Clinic not found', 404);\n    }\n\n    // Check if clinic has operating hours defined\n    if (!clinic.operatingHours || clinic.operatingHours.length === 0) {\n      // If no operating hours defined, allow the appointment\n      return next();\n    }\n\n    // Get day of week\n    const appointmentDate = new Date(date);\n    const dayOfWeek = appointmentDate.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();\n\n    // Find operating hours for this day\n    const daySchedule = clinic.operatingHours.find(\n      oh => oh.day.toLowerCase() === dayOfWeek\n    );\n\n    if (!daySchedule || daySchedule.closed) {\n      throw new AppError(\n        `The clinic is closed on ${dayOfWeek.charAt(0).toUpperCase() + dayOfWeek.slice(1)}`,\n        400\n      );\n    }\n\n    // Check if appointment falls within operating hours\n    const [hours, minutes] = timeSlot.split(':').map(Number);\n    const appointmentTimeInMinutes = hours * 60 + minutes;\n    const appointmentEndTimeInMinutes = appointmentTimeInMinutes + duration;\n\n    const [openHour, openMinute] = daySchedule.open.split(':').map(Number);\n    const [closeHour, closeMinute] = daySchedule.close.split(':').map(Number);\n\n    const openTimeInMinutes = openHour * 60 + openMinute;\n    const closeTimeInMinutes = closeHour * 60 + closeMinute;\n\n    if (\n      appointmentTimeInMinutes < openTimeInMinutes ||\n      appointmentEndTimeInMinutes > closeTimeInMinutes\n    ) {\n      throw new AppError(\n        `The selected time slot is outside clinic operating hours (${daySchedule.open} - ${daySchedule.close})`,\n        400\n      );\n    }\n\n    next();\n  } catch (error) {\n    next(error);\n  }\n};\n\n/**\n * Validates that there are no scheduling conflicts with existing appointments\n */\nexport const validateAppointmentConflicts = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const { dentistId, date, timeSlot, duration = 30 } = req.body;\n    const appointmentId = req.params.id; // For updates\n\n    // If no dentist specified, skip conflict check\n    if (!dentistId) {\n      return next();\n    }\n\n    // Check for conflicts using the Appointment model's static method\n    const conflicts = await Appointment.findConflicts(\n      dentistId,\n      new Date(date),\n      timeSlot,\n      duration,\n      appointmentId\n    );\n\n    if (conflicts.length > 0) {\n      throw new AppError(\n        'This time slot conflicts with an existing appointment',\n        409\n      );\n    }\n\n    next();\n  } catch (error) {\n    next(error);\n  }\n};\n\n/**\n * Validates that the doctor is assigned to the selected clinic\n */\nexport const validateDoctorClinicAssignment = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const { dentistId, clinicId } = req.body;\n\n    // If no dentist specified, skip this check\n    if (!dentistId) {\n      return next();\n    }\n\n    // Find doctor\n    const doctor = await User.findById(dentistId).populate('assignedClinics');\n    if (!doctor) {\n      throw new AppError('Doctor not found', 404);\n    }\n\n    // Check if doctor is assigned to this clinic\n    const isAssigned = doctor.assignedClinics?.some(\n      (clinic: any) => clinic._id.toString() === clinicId\n    );\n\n    if (!isAssigned) {\n      throw new AppError(\n        'The selected doctor is not assigned to this clinic',\n        400\n      );\n    }\n\n    next();\n  } catch (error) {\n    next(error);\n  }\n};\n\n/**\n * Combined validation middleware for multi-branch appointments\n * Runs all validations in sequence\n */\nexport const validateMultiBranchAppointment = [\n  validateClinicOperatingHours,\n  validateDoctorClinicAssignment,\n  validateDoctorSchedule,\n  validateAppointmentConflicts\n];\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IUser' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":49},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1349,1352],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1349,1352],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":43,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2803,2806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2803,2806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2975,2978],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2975,2978],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":104,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":104,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":270,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":270,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8038,8041],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8038,8041],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":343,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":343,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10179,10182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10179,10182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":354,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":354,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10543,10546],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10543,10546],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\nimport User from '../models/User';\nimport Patient from '../models/Patient';\nimport { AuthenticatedRequest, JWTPayload, IUser } from '../types';\nimport { AppError } from '../utils/AppError';\nimport { asyncHandler } from '../utils/asyncHandler';\n\n// Protect routes - require authentication\nexport const protect = asyncHandler(async (req: Request, res: Response, next: NextFunction) => {\n  let token;\n\n  // Get token from header\n  console.log(req.headers.authorization);\n  \n  if (req.headers.authorization && req.headers.authorization.startsWith('Bearer')) {\n    token = req.headers.authorization.split(' ')[1];\n  }\n\n  // Make sure token exists\n  if (!token) {\n    return next(new AppError('Not authorized to access this route', 401));\n  }\n\n  try {\n    // Verify token\n    const decoded = jwt.verify(token, process.env.JWT_SECRET!) as JWTPayload;\n\n    // Get user from token\n    const user = await User.findById(decoded.id).select('-password');\n    if (!user) {\n      return next(new AppError('No user found with this token', 401));\n    }\n\n    // Check if user is active\n    if (!user.isActive) {\n      return next(new AppError('User account is deactivated', 401));\n    }\n\n    // Grant access to protected route\n    (req as AuthenticatedRequest).user = user as any;\n    next();\n  } catch (error) {\n    return next(new AppError('Not authorized to access this route', 401));\n  }\n});\n\n// Backward compatibility alias\nexport const auth = protect;\nexport const authenticate = protect;\n\n// Authorization middleware for specific roles\nexport const authorize = (...roles: string[]) => {\n  return (req: Request, res: Response, next: NextFunction): void => {\n    const authReq = req as unknown as AuthenticatedRequest;\n    if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    if (!roles.includes(authReq.user.role)) {\n      res.status(403).json({\n        success: false,\n        message: 'Access denied. Insufficient permissions.'\n      });\n      return;\n    }\n\n    next();\n  };\n};\n\n// Admin only middleware\nexport const adminOnly = authorize('admin');\n\n// Dentist or Admin middleware\nexport const dentistOrAdmin = authorize('dentist', 'admin');\n\n// Staff or Admin middleware (staff, dentist, admin)\nexport const staffOrAdmin = authorize('staff', 'dentist', 'admin');\n\n// Optional authentication middleware (doesn't fail if no token)\nexport const optionalAuth = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> => {\n  try {\n    const token = req.header('Authorization')?.replace('Bearer ', '');\n\n    if (token) {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET!) as any;\n      const user = await User.findById(decoded.id).select('-password');\n      \n      if (user && user.isActive) {\n        (req as AuthenticatedRequest).user = user as any;\n      }\n    }\n\n    next();\n  } catch (error) {\n    // Continue without authentication if token is invalid\n    next();\n  }\n};\n\n// Middleware to check if user owns the resource or is admin\nexport const ownerOrAdmin = (resourceUserIdField: string = 'userId') => {\n  return (req: Request, res: Response, next: NextFunction): void => {\n    const authReq = req as unknown as AuthenticatedRequest;\n    console.log(authReq);\n      if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    const resourceUserId = req.params[resourceUserIdField] || req.body[resourceUserIdField];\n    \n    if (authReq.user.role === 'admin' || authReq.user._id.toString() === resourceUserId) {\n      next();\n    } else {\n      res.status(403).json({\n        success: false,\n        message: 'Access denied. You can only access your own resources.'\n      });\n    }\n  };\n};\n\n// Middleware to check if user owns the resource or is staff/admin\nexport const userOwnerOrStaff = (userIdField: string = 'userId') => {\n  return (req: Request, res: Response, next: NextFunction): void => {\n    const authReq = req as unknown as AuthenticatedRequest;\n    if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    // Staff and admin can access all user data\n    if (['admin', 'dentist', 'staff'].includes(authReq.user.role)) {\n      next();\n      return;\n    }\n\n    // Users can only access their own data\n    const userId = req.params[userIdField] || req.body[userIdField];\n    if (authReq.user._id.toString() === userId) {\n      next();\n    } else {\n      res.status(403).json({\n        success: false,\n        message: 'Access denied. You can only access your own data.'\n      });\n    }\n  };\n};\n\n// Middleware to check if patient owns the resource or is staff/admin\nexport const patientOwnerOrStaff = (patientIdField: string = 'id') => {\n  console.log('I.m here');\n  return async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    \n    const authReq = req as unknown as AuthenticatedRequest;\n    console.log(authReq);\n    if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    // Staff and admin can access all patient data\n    if (['admin', 'dentist', 'staff'].includes(authReq.user.role)) {\n      next();\n      return;\n    }\n\n    // Patients can only access their own data\n    if (authReq.user.role === 'patient') {\n      try {\n        const patientId = req.params[patientIdField] || req.body[patientIdField];\n        \n        // Fetch the patient record to get the userId\n        const patient = await Patient.findById(patientId);\n        console.log(patient);\n        \n        if (!patient) {\n          res.status(404).json({\n            success: false,\n            message: 'Patient not found.'\n          });\n          return;\n        }\n        \n        // Compare the authenticated user's ID with the patient's userId\n        if (patient.userId && patient.userId.toString() === authReq.user.id.toString()) {\n          console.log('here we go');\n          next();\n          return;\n        } else {\n          res.status(403).json({\n            success: false,\n            message: 'Access denied. Patients can only access their own data111.'\n          });\n          return;\n        }\n      } catch (error) {\n        console.error('Patient ownership check error:', error);\n        res.status(500).json({\n          success: false,\n          message: 'Internal server error during access control check.'\n        });\n        return;\n      }\n    }\n\n    res.status(403).json({\n      success: false,\n      message: 'Access denied. Insufficient permissions.'\n    });\n  };\n};\n\n// Middleware for appointment access - allows staff/admin or patients accessing their own appointments\nexport const appointmentAccessControl = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> => {\n  try {\n    const authReq = req as unknown as AuthenticatedRequest;\n    if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    // Staff and admin can access all appointments\n    if (['admin', 'dentist', 'staff'].includes(authReq.user.role)) {\n      next();\n      return;\n    }\n\n    // For patients, check if they're accessing their own appointments\n    if (authReq.user.role === 'patient') {\n      const patientId = req.query.patientId as string;\n      \n      // If no patientId is provided, deny access (patients can't see all appointments)\n      if (!patientId) {\n        res.status(403).json({\n          success: false,\n          message: 'Access denied. Patients must specify a patient ID.'\n        });\n        return;\n      }\n\n      // Check if the patient record belongs to this user\n      const patient = await (Patient as any).findById(patientId);\n      if (!patient) {\n        res.status(404).json({\n          success: false,\n          message: 'Patient not found.'\n        });\n        return;\n      }\n\n      // Check if this patient belongs to the authenticated user\n      if (patient.userId && patient.userId.toString() === authReq.user._id.toString()) {\n        next();\n        return;\n      } else {\n        res.status(403).json({\n          success: false,\n          message: 'Access denied. You can only access your own appointments.'\n        });\n        return;\n      }\n    }\n\n    res.status(403).json({\n      success: false,\n      message: 'Access denied. Insufficient permissions.'\n    });\n  } catch (error) {\n    console.error('Appointment access control error:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal server error during access control check.'\n    });\n  }\n};\n\n// Middleware for individual appointment access - allows staff/admin or patients accessing their own appointments\nexport const appointmentDetailAccessControl = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> => {\n  try {\n    const authReq = req as unknown as AuthenticatedRequest;\n    if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    // Staff and admin can access all appointments\n    if (['admin', 'dentist', 'staff'].includes(authReq.user.role)) {\n      next();\n      return;\n    }\n\n    // For patients, check if they're accessing their own appointment\n    if (authReq.user.role === 'patient') {\n      const appointmentId = req.params.id;\n      \n      if (!appointmentId) {\n        res.status(400).json({\n          success: false,\n          message: 'Appointment ID is required.'\n        });\n        return;\n      }\n\n      // Import Appointment model dynamically to avoid circular dependencies\n      const { default: Appointment } = await import('../models/Appointment');\n      \n      // Find the appointment and check if it belongs to this patient\n      const appointment = await (Appointment as any).findById(appointmentId).populate('patientId', '_id userId');\n      \n      if (!appointment) {\n        res.status(404).json({\n          success: false,\n          message: 'Appointment not found.'\n        });\n        return;\n      }\n\n      // Check if this appointment belongs to the authenticated user\n      const appointmentPatient = appointment.patientId as any;\n      if (appointmentPatient && appointmentPatient.userId && appointmentPatient.userId.toString() === authReq.user._id.toString()) {\n        next();\n        return;\n      } else {\n        res.status(403).json({\n          success: false,\n          message: 'Access denied. You can only access your own appointments.'\n        });\n        return;\n      }\n    }\n\n    res.status(403).json({\n      success: false,\n      message: 'Access denied. Insufficient permissions.'\n    });\n  } catch (error) {\n    console.error('Appointment detail access control error:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal server error during access control check.'\n    });\n  }\n};\n\n// Middleware to check clinic access\nexport const checkClinicAccess = async (\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> => {\n  try {\n    const authReq = req as unknown as AuthenticatedRequest;\n    if (!authReq.user) {\n      res.status(401).json({\n        success: false,\n        message: 'Access denied. User not authenticated.'\n      });\n      return;\n    }\n\n    // Admin has access to all clinics\n    if (authReq.user.role === 'admin') {\n      next();\n      return;\n    }\n\n    const clinicId = req.params.clinicId || req.body.clinicId;\n    \n    if (!clinicId) {\n      res.status(400).json({\n        success: false,\n        message: 'Clinic ID is required.'\n      });\n      return;\n    }\n\n    // Check if user is assigned to this clinic\n    if (!authReq.user.assignedClinics.includes(clinicId)) {\n      res.status(403).json({\n        success: false,\n        message: 'Access denied. You are not assigned to this clinic.'\n      });\n      return;\n    }\n\n    next();\n  } catch (error) {\n    console.error('Clinic access check error:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal server error during clinic access check.'\n    });\n  }\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\errorHandler.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":8,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[226,229],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[226,229],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":10,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[293,296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[293,296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[619,622],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[619,622],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[694,697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[694,697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[900,903],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[900,903],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1234,1237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1234,1237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1770,1773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1770,1773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2368,2371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2368,2371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2639,2642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2639,2642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3182,3185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3182,3185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":113,"column":69,"nodeType":null,"messageId":"unusedVar","endLine":113,"endColumn":73},{"ruleId":"@typescript-eslint/no-unsafe-function-type","severity":1,"message":"The `Function` type accepts any function-like value.\nPrefer explicitly defining any function parameters and return type.","line":151,"column":32,"nodeType":"Identifier","messageId":"bannedFunctionType","endLine":151,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4691,4694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4691,4694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\n\n// Custom error class\nexport class AppError extends Error {\n  public statusCode: number;\n  public status: string;\n  public isOperational: boolean;\n  public details?: any;\n\n  constructor(message: string, statusCode: number, details?: any) {\n    super(message);\n    this.statusCode = statusCode;\n    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';\n    this.isOperational = true;\n    this.details = details;\n\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\n// Handle Mongoose validation errors\nconst handleValidationError = (error: any): AppError => {\n  const errors = Object.values(error.errors).map((err: any) => ({\n    field: err.path,\n    message: err.message\n  }));\n\n  return new AppError('Validation failed', 400, errors);\n};\n\n// Handle Mongoose duplicate key errors\nconst handleDuplicateKeyError = (error: any): AppError => {\n  const field = Object.keys(error.keyValue)[0];\n  const value = error.keyValue[field];\n  \n  const details = [{\n    field,\n    message: `${field} already exists`\n  }];\n\n  return new AppError(`Duplicate value for ${field}: ${value}`, 400, details);\n};\n\n// Handle Mongoose cast errors\nconst handleCastError = (error: any): AppError => {\n  const details = [{\n    field: error.path,\n    message: `Invalid ${error.path}`\n  }];\n\n  return new AppError(`Invalid ${error.path}: ${error.value}`, 400, details);\n};\n\n// Handle JWT errors\nconst handleJWTError = (): AppError => {\n  return new AppError('Invalid token. Please log in again.', 401);\n};\n\n// Handle JWT expired errors\nconst handleJWTExpiredError = (): AppError => {\n  return new AppError('Your token has expired. Please log in again.', 401);\n};\n\n// Handle Multer errors\nconst handleMulterError = (err: any): AppError => {\n  if (err.code === 'LIMIT_FILE_SIZE') {\n    return new AppError('File too large', 400);\n  }\n  if (err.code === 'LIMIT_FILE_COUNT') {\n    return new AppError('Too many files', 400);\n  }\n  if (err.code === 'LIMIT_UNEXPECTED_FILE') {\n    return new AppError('Unexpected file field', 400);\n  }\n  return new AppError(`File upload error: ${err.message}`, 400);\n};\n\n// Handle rate limit errors\nconst handleRateLimitError = (): AppError =>\n  new AppError('Too many requests from this IP, please try again later.', 429);\n\n// Send error response in development\nconst sendErrorDev = (err: any, res: Response) => {\n  res.status(err.statusCode || 500).json({\n    success: false,\n    error: err,\n    message: err.message,\n    stack: err.stack,\n    errors: err.details || err.errors || []\n  });\n};\n\n// Send error response in production\nconst sendErrorProd = (err: any, res: Response) => {\n  // Operational, trusted error: send message to client\n  if (err.isOperational) {\n    res.status(err.statusCode).json({\n      success: false,\n      message: err.message,\n      ...(err.details && { errors: err.details })\n    });\n  } else {\n    // Programming or other unknown error: don't leak error details\n    console.error('ERROR ', err);\n    res.status(500).json({\n      success: false,\n      message: 'Something went wrong!'\n    });\n  }\n};\n\n// Global error handling middleware\nexport const errorHandler = (err: any, req: Request, res: Response, next: NextFunction) => {\n  err.statusCode = err.statusCode || 500;\n  err.status = err.status || 'error';\n\n  if (process.env.NODE_ENV === 'development') {\n    sendErrorDev(err, res);\n  } else {\n    let error = { ...err };\n    error.message = err.message;\n\n    // Handle specific error types\n    if (error.name === 'ValidationError') {\n      error = handleValidationError(error);\n    }\n    if (error.code === 11000) {\n      error = handleDuplicateKeyError(error);\n    }\n    if (error.name === 'CastError') {\n      error = handleCastError(error);\n    }\n    if (error.name === 'JsonWebTokenError') {\n      error = handleJWTError();\n    }\n    if (error.name === 'TokenExpiredError') {\n      error = handleJWTExpiredError();\n    }\n    if (error.name === 'MulterError') {\n      error = handleMulterError(error);\n    }\n    if (error.name === 'RateLimitError') {\n      error = handleRateLimitError();\n    }\n\n    sendErrorProd(error, res);\n  }\n};\n\n// Async error wrapper\nexport const catchAsync = (fn: Function) => {\n  return async(req: Request, res: Response, next: NextFunction) => {\n    await fn(req, res, next).catch(next);\n  };\n};\n\n// 404 handler\nexport const notFound = (req: Request, res: Response, next: NextFunction) => {\n  const err = new AppError(`Not found - ${req.originalUrl}`, 404);\n  next(err);\n};\n\n// Validation error helper\nexport const createValidationError = (field: string, message: string) => {\n  const error = new AppError('Validation failed', 400);\n  (error as any).errors = [{ field, message }];\n  return error;\n};\n\n// Unauthorized error helper\nexport const createUnauthorizedError = (message: string = 'Unauthorized') => {\n  return new AppError(message, 401);\n};\n\n// Forbidden error helper\nexport const createForbiddenError = (message: string = 'Forbidden') => {\n  return new AppError(message, 403);\n};\n\n// Not found error helper\nexport const createNotFoundError = (resource: string = 'Resource') => {\n  return new AppError(`${resource} not found`, 404);\n};\n\n// Conflict error helper\nexport const createConflictError = (message: string) => {\n  return new AppError(message, 409);\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\rateLimiter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\upload.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mimeType' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":29,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2051,2054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2051,2054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2467,2470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2467,2470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3370,3373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3370,3373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3409,3412],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3409,3412],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3420,3423],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3420,3423],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3469,3472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3469,3472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6294,6297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6294,6297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import multer from 'multer';\nimport path from 'path';\nimport fs from 'fs';\nimport { Request as _Request } from 'express';\nimport { AppError } from '../utils/AppError';\n\n// Ensure upload directories exist\nconst ensureDirectoryExists = (dirPath: string) => {\n  if (!fs.existsSync(dirPath)) {\n    fs.mkdirSync(dirPath, { recursive: true });\n  }\n};\n\n// Create upload directories\nconst uploadDirs = {\n  profiles: path.join(process.cwd(), 'uploads', 'profiles'),\n  clinics: path.join(process.cwd(), 'uploads', 'clinics'),\n  treatments: path.join(process.cwd(), 'uploads', 'treatments'),\n  documents: path.join(process.cwd(), 'uploads', 'documents')\n};\n\n// Ensure all directories exist\nObject.values(uploadDirs).forEach(ensureDirectoryExists);\n\n// File filter function\nconst fileFilter = (allowedTypes: string[]) => {\n  return (req: Request, file: Express.Multer.File, cb: multer.FileFilterCallback) => {\n    const fileExtension = path.extname(file.originalname).toLowerCase();\n    const mimeType = file.mimetype;\n    \n    // Check file extension\n    if (allowedTypes.includes(fileExtension)) {\n      cb(null, true);\n    } else {\n      cb(new AppError(`Invalid file type. Allowed types: ${allowedTypes.join(', ')}`, 400));\n    }\n  };\n};\n\n// Storage configuration\nconst createStorage = (uploadPath: string) => {\n  return multer.diskStorage({\n    destination: (req, file, cb) => {\n      ensureDirectoryExists(uploadPath);\n      cb(null, uploadPath);\n    },\n    filename: (req, file, cb) => {\n      // Generate unique filename\n      const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n      const fileExtension = path.extname(file.originalname);\n      const fileName = `${file.fieldname}-${uniqueSuffix}${fileExtension}`;\n      cb(null, fileName);\n    }\n  });\n};\n\n// Image upload configuration\nconst imageFilter = fileFilter(['.jpg', '.jpeg', '.png', '.gif', '.webp']);\nconst imageUpload = (uploadPath: string, maxSize: number = 5 * 1024 * 1024) => {\n  return multer({\n    storage: createStorage(uploadPath),\n    fileFilter: imageFilter as any,\n    limits: {\n      fileSize: maxSize, // Default 5MB\n      files: 10 // Maximum 10 files\n    }\n  });\n};\n\n// Document upload configuration\nconst documentFilter = fileFilter(['.pdf', '.doc', '.docx', '.txt', '.jpg', '.jpeg', '.png']);\nconst documentUpload = (uploadPath: string, maxSize: number = 10 * 1024 * 1024) => {\n  return multer({\n    storage: createStorage(uploadPath),\n    fileFilter: documentFilter as any,\n    limits: {\n      fileSize: maxSize, // Default 10MB\n      files: 5 // Maximum 5 files\n    }\n  });\n};\n\n// Profile image upload\nexport const uploadProfileImage = imageUpload(uploadDirs.profiles, 2 * 1024 * 1024).single('profileImage');\n\n// Clinic images upload\nexport const uploadClinicImages = imageUpload(uploadDirs.clinics, 5 * 1024 * 1024).array('images', 10);\n\n// Treatment attachments upload\nexport const uploadTreatmentAttachments = documentUpload(uploadDirs.treatments, 10 * 1024 * 1024).array('attachments', 5);\n\n// General document upload\nexport const uploadDocuments = documentUpload(uploadDirs.documents, 10 * 1024 * 1024).array('documents', 5);\n\n// Single document upload\nexport const uploadSingleDocument = documentUpload(uploadDirs.documents, 10 * 1024 * 1024).single('document');\n\n// Custom upload middleware with error handling\nexport const handleUploadError = (uploadMiddleware: any) => {\n  return (req: Request, res: any, next: any) => {\n    uploadMiddleware(req, res, (error: any) => {\n      if (error instanceof multer.MulterError) {\n        if (error.code === 'LIMIT_FILE_SIZE') {\n          return next(new AppError('File too large', 400));\n        }\n        if (error.code === 'LIMIT_FILE_COUNT') {\n          return next(new AppError('Too many files', 400));\n        }\n        if (error.code === 'LIMIT_UNEXPECTED_FILE') {\n          return next(new AppError('Unexpected file field', 400));\n        }\n        return next(new AppError(`Upload error: ${error.message}`, 400));\n      }\n      if (error) {\n        return next(error);\n      }\n      next();\n    });\n  };\n};\n\n// Wrapped upload middlewares with error handling\nexport const uploadProfileImageWithErrorHandling = handleUploadError(uploadProfileImage);\nexport const uploadClinicImagesWithErrorHandling = handleUploadError(uploadClinicImages);\nexport const uploadTreatmentAttachmentsWithErrorHandling = handleUploadError(uploadTreatmentAttachments);\nexport const uploadDocumentsWithErrorHandling = handleUploadError(uploadDocuments);\nexport const uploadSingleDocumentWithErrorHandling = handleUploadError(uploadSingleDocument);\n\n// File cleanup utility\nexport const deleteFile = (filePath: string): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    fs.unlink(filePath, (error) => {\n      if (error && error.code !== 'ENOENT') {\n        reject(error);\n      } else {\n        resolve();\n      }\n    });\n  });\n};\n\n// Delete multiple files\nexport const deleteFiles = async (filePaths: string[]): Promise<void> => {\n  const deletePromises = filePaths.map(filePath => deleteFile(filePath));\n  await Promise.allSettled(deletePromises);\n};\n\n// Get file URL\nexport const getFileUrl = (filename: string, type: 'profiles' | 'clinics' | 'treatments' | 'documents'): string => {\n  const baseUrl = process.env.BASE_URL || 'http://localhost:3000';\n  return `${baseUrl}/uploads/${type}/${filename}`;\n};\n\n// Validate file existence\nexport const fileExists = (filePath: string): boolean => {\n  return fs.existsSync(filePath);\n};\n\n// Get file info\nexport const getFileInfo = (filePath: string) => {\n  if (!fileExists(filePath)) {\n    return null;\n  }\n  \n  const stats = fs.statSync(filePath);\n  return {\n    size: stats.size,\n    createdAt: stats.birthtime,\n    modifiedAt: stats.mtime,\n    extension: path.extname(filePath),\n    name: path.basename(filePath)\n  };\n};\n\n// Create custom upload middleware\nexport const createCustomUpload = (options: {\n  destination: string;\n  allowedTypes: string[];\n  maxSize: number;\n  maxFiles: number;\n  fieldName: string;\n  multiple?: boolean;\n}) => {\n  const { destination, allowedTypes, maxSize, maxFiles, fieldName, multiple = false } = options;\n  \n  const storage = createStorage(destination);\n  const filter = fileFilter(allowedTypes);\n  \n  const upload = multer({\n    storage,\n    fileFilter: filter as any,\n    limits: {\n      fileSize: maxSize,\n      files: maxFiles\n    }\n  });\n  \n  return multiple ? upload.array(fieldName, maxFiles) : upload.single(fieldName);\n};\n\n// Export upload directories for reference\nexport { uploadDirs };","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\middleware\\validation.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ValidationChain' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":63}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\nimport { body, param, query, validationResult, ValidationChain } from 'express-validator';\nimport { AppError } from '../utils/AppError';\n\n// Handle validation errors\nexport const handleValidationErrors = (req: Request, res: Response, next: NextFunction) => {\n  const errors = validationResult(req);\n  console.log('errors1' , errors);\n  if (!errors.isEmpty()) {\n    console.log('errors' , errors);\n    const errorMessages = errors.array().map(error => ({\n      field: 'path' in error ? error.path : 'param' in error ? error.param : 'unknown',\n      message: error.msg,\n      value: 'value' in error ? error.value : undefined\n    }));\n    return next(new AppError('Validation failed', 400, errorMessages));\n  }\n    console.log('errors2' , errors);\n  next();\n};\n\n// Common validation rules\nexport const commonValidations = {\n  email: body('email')\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email'),\n  \n  password: body('password')\n    .isLength({ min: 8 })\n    .withMessage('Password must be at least 8 characters long')\n    .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]/)\n    .withMessage('Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character'),\n  \n  name: (field: string) => body(field)\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage(`${field} must be between 2 and 50 characters`)\n    .matches(/^[a-zA-Z\\s]+$/)\n    .withMessage(`${field} must contain only letters and spaces`),\n  \n  phone: body('phone')\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n  \n  objectId: (field: string) => param(field)\n    .isMongoId()\n    .withMessage(`Invalid ${field} format`),\n  \n  date: (field: string) => body(field)\n    .isISO8601()\n    .withMessage(`${field} must be a valid date`),\n  \n  pagination: [\n    query('page')\n      .optional()\n      .isInt({ min: 1 })\n      .withMessage('Page must be a positive integer'),\n    query('limit')\n      .optional()\n      .isInt({ min: 1, max: 100 })\n      .withMessage('Limit must be between 1 and 100')\n  ]\n};\n\n// Export pagination validation rules for backward compatibility\nexport const paginationValidationRules = commonValidations.pagination;\n\n// User validation rules\nexport const userValidation = {\n  register: [\n    commonValidations.name('firstName'),\n    commonValidations.name('lastName'),\n    commonValidations.email,\n    commonValidations.password,\n    commonValidations.phone.optional(),\n    body('role')\n      .optional()\n      .isIn(['admin', 'dentist', 'staff', 'patient'])\n      .withMessage('Invalid role'),\n    body('dateOfBirth')\n      .optional()\n      .isISO8601()\n      .withMessage('Date of birth must be a valid date'),\n    body('gender')\n      .optional()\n      .isIn(['male', 'female', 'other'])\n      .withMessage('Gender must be male, female, or other'),\n    handleValidationErrors\n  ],\n  \n  login: [\n    commonValidations.email,\n    body('password')\n      .notEmpty()\n      .withMessage('Password is required'),\n    handleValidationErrors\n  ],\n  \n  updateProfile: [\n    commonValidations.name('firstName').optional(),\n    commonValidations.name('lastName').optional(),\n    commonValidations.phone.optional(),\n    body('dateOfBirth')\n      .optional()\n      .isISO8601()\n      .withMessage('Date of birth must be a valid date'),\n    body('gender')\n      .optional()\n      .isIn(['male', 'female', 'other'])\n      .withMessage('Gender must be male, female, or other'),\n    body('address')\n      .optional()\n      .isLength({ max: 200 })\n      .withMessage('Address must not exceed 200 characters'),\n    handleValidationErrors\n  ],\n  \n  changePassword: [\n    body('currentPassword')\n      .notEmpty()\n      .withMessage('Current password is required'),\n    commonValidations.password.withMessage('New password must be at least 8 characters long and contain uppercase, lowercase, number, and special character'),\n    handleValidationErrors\n  ],\n  \n  forgotPassword: [\n    commonValidations.email,\n    handleValidationErrors\n  ],\n  \n  resetPassword: [\n    body('token')\n      .notEmpty()\n      .withMessage('Reset token is required'),\n    commonValidations.password,\n    handleValidationErrors\n  ]\n};\n\n// Backward compatibility\nexport const validateUserRegistration = userValidation.register;\n\nexport const validateUserLogin = [\n  body('email')\n    .trim()\n    .isEmail()\n    .withMessage('Please provide a valid email')\n    .normalizeEmail(),\n  \n  body('password')\n    .notEmpty()\n    .withMessage('Password is required'),\n  \n  handleValidationErrors\n];\n\nexport const validatePasswordChange = [\n  body('currentPassword')\n    .notEmpty()\n    .withMessage('Current password is required'),\n  \n  body('newPassword')\n    .isLength({ min: 8 })\n    .withMessage('New password must be at least 8 characters long')\n    .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]/)\n    .withMessage('New password must contain at least one uppercase letter, one lowercase letter, one number, and one special character'),\n  \n  handleValidationErrors\n];\n\n// Patient validation rules\nexport const validatePatientCreation = [\n  body('firstName')\n    .trim()\n    .notEmpty()\n    .withMessage('First name is required')\n    .isLength({ min: 2, max: 50 })\n    .withMessage('First name must be between 2 and 50 characters'),\n\n  body('lastName')\n    .trim()\n    .notEmpty()\n    .withMessage('Last name is required')\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Last name must be between 2 and 50 characters'),\n\n  body('email')\n    .optional()\n    .trim()\n    .isEmail()\n    .withMessage('Please provide a valid email')\n    .normalizeEmail(),\n\n  body('phone')\n    .trim()\n    .notEmpty()\n    .withMessage('Phone number is required')\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n\n  body('dateOfBirth')\n    .isISO8601()\n    .withMessage('Please provide a valid date of birth')\n    .custom((value) => {\n      const birthDate = new Date(value);\n      const today = new Date();\n      if (birthDate >= today) {\n        throw new Error('Date of birth must be in the past');\n      }\n      return true;\n    }),\n\n  body('gender')\n    .isIn(['male', 'female', 'other'])\n    .withMessage('Invalid gender'),\n\n  body('preferredClinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n\n  body('userId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid user ID'),\n\n  handleValidationErrors\n];\n\n// Appointment validation rules\nexport const validateAppointmentCreation = [\n  body('patientId')\n    .isMongoId()\n    .withMessage('Invalid patient ID'),\n  \n  body('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  \n  body('clinicId')\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  \n  body('serviceType')\n    .trim()\n    .notEmpty()\n    .withMessage('Service type is required'),\n  \n  body('date')\n    .isISO8601()\n    .withMessage('Please provide a valid date')\n    .custom((value) => {\n      const appointmentDate = new Date(value);\n      const today = new Date();\n      \n      // Simple timezone-safe date comparison using date strings\n      const appointmentDateStr = appointmentDate.toISOString().split('T')[0];\n      const todayDateStr = today.toISOString().split('T')[0];\n      \n      if (appointmentDateStr < todayDateStr) {\n        throw new Error('Appointment date cannot be in the past');\n      }\n      return true;\n    }),\n  \n  body('timeSlot')\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Invalid time slot format (HH:MM)'),\n  \n  body('duration')\n    .optional()\n    .isInt({ min: 15, max: 480 })\n    .withMessage('Duration must be between 15 and 480 minutes'),\n  \n  handleValidationErrors\n];\n\nexport const validateAppointmentUpdate = [\n  body('serviceType')\n    .optional()\n    .trim()\n    .notEmpty()\n    .withMessage('Service type cannot be empty'),\n  \n  body('date')\n    .optional()\n    .isISO8601()\n    .withMessage('Please provide a valid date')\n    .custom((value) => {\n      if (value) {\n        const appointmentDate = new Date(value);\n        const today = new Date();\n        \n        // Simple timezone-safe date comparison using date strings\n        const appointmentDateStr = appointmentDate.toISOString().split('T')[0];\n        const todayDateStr = today.toISOString().split('T')[0];\n        \n        if (appointmentDateStr < todayDateStr) {\n          throw new Error('Appointment date cannot be in the past');\n        }\n      }\n      return true;\n    }),\n  \n  body('timeSlot.startTime')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Invalid start time format (HH:MM)'),\n  \n  body('timeSlot.endTime')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Invalid end time format (HH:MM)'),\n  \n  body('status')\n    .optional()\n    .isIn(['scheduled', 'confirmed', 'in-progress', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Invalid appointment status')\n];\n\n// Clinic validation rules\nexport const validateClinicCreation = [\n  body('name')\n    .trim()\n    .notEmpty()\n    .withMessage('Clinic name is required')\n    .isLength({ min: 2, max: 100 })\n    .withMessage('Clinic name must be between 2 and 100 characters'),\n  \n  body('phone')\n    .trim()\n    .notEmpty()\n    .withMessage('Phone number is required')\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n  \n  body('email')\n    .optional()\n    .trim()\n    .isEmail()\n    .withMessage('Please provide a valid email')\n    .normalizeEmail(),\n  \n  body('address.street')\n    .trim()\n    .notEmpty()\n    .withMessage('Street address is required'),\n  \n  body('address.city')\n    .trim()\n    .notEmpty()\n    .withMessage('City is required'),\n  \n  body('address.state')\n    .trim()\n    .notEmpty()\n    .withMessage('State is required'),\n  \n  body('address.zipCode')\n    .trim()\n    .notEmpty()\n    .withMessage('Zip code is required'),\n  \n  handleValidationErrors\n];\n\n// Common validation rules\nexport const validateMongoId = [\n  param('id')\n    .isMongoId()\n    .withMessage('Invalid ID format'),\n  \n  handleValidationErrors\n];\n\n// Function to create MongoDB ID validation for different parameter names\nexport const createMongoIdValidation = (paramName: string = 'id') => [\n  param(paramName)\n    .isMongoId()\n    .withMessage(`Invalid ${paramName} format`)\n];\n\nexport const validatePagination = [\n  query('page')\n    .optional()\n    .isInt({ min: 1 })\n    .withMessage('Page must be a positive integer'),\n  \n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 100 })\n    .withMessage('Limit must be between 1 and 100'),\n  \n  handleValidationErrors\n];\n\nexport const validateDateRange = [\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Invalid start date format'),\n  \n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Invalid end date format')\n    .custom((value, { req }) => {\n      if (value && req.query && req.query.startDate) {\n        const startDate = new Date(req.query.startDate as string);\n        const endDate = new Date(value);\n        if (endDate <= startDate) {\n          throw new Error('End date must be after start date');\n        }\n      }\n      return true;\n    }),\n  \n  handleValidationErrors\n];","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Appointment.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Model' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[312,315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[312,315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3786,3789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3786,3789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3796,3799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3796,3799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":162,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3861,3864],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3861,3864],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3905,3908],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3905,3908],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4977,4980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4977,4980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5416,5419],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5416,5419],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":208,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5725,5728],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5725,5728],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":213,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5874,5877],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5874,5877],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":221,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":221,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6210,6213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6210,6213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":228,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6489,6492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6489,6492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":233,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":233,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6708,6711],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6708,6711],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":270,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":270,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7861,7864],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7861,7864],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":283,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8219,8222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8219,8222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":284,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":284,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8268,8271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8268,8271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":311,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":311,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9602,9605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9602,9605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":333,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":333,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10602,10605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10602,10605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10676,10679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10676,10679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":387,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":387,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12433,12436],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12433,12436],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":430,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":430,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13986,13989],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13986,13989],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":472,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":472,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15262,15265],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15262,15265],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":477,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":477,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15633,15636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15633,15636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":22,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema, Model } from 'mongoose';\nimport { IAppointment, IAppointmentModel } from '../types';\nimport Clinic from './Clinic'; // Import Clinic model to access operating hours\n\n// Use a broad schema typing to accommodate extended fields present in the schema\nconst appointmentSchema = new Schema<any>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  dentistId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: false // Made optional - appointments can exist without dentists\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  serviceType: {\n    type: String,\n    required: [true, 'Service type is required'],\n    trim: true,\n    maxlength: [100, 'Service type cannot exceed 100 characters']\n  },\n  date: {\n    type: Date,\n    required: [true, 'Appointment date is required'],\n    validate: {\n      validator: function(value: Date) {\n        // Allow appointments to be scheduled for today or future dates\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        return value >= today;\n      },\n      message: 'Appointment date cannot be in the past'\n    }\n  },\n  timeSlot: {\n    type: String,\n    required: [true, 'Time slot is required'],\n    match: [/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/, 'Please provide time in HH:MM format']\n  },\n  duration: {\n    type: Number,\n    required: [true, 'Duration is required'],\n    min: [15, 'Minimum appointment duration is 15 minutes'],\n    max: [480, 'Maximum appointment duration is 8 hours']\n  },\n  status: {\n    type: String,\n    enum: ['scheduled', 'confirmed', 'completed', 'cancelled', 'no-show', 'urgent'],\n    default: 'scheduled'\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Notes cannot exceed 1000 characters']\n  },\n  emergency: {\n    type: Boolean,\n    default: false\n  },\n  notificationPreferences: {\n    enabled: {\n      type: Boolean,\n      default: true\n    },\n    channels: {\n      email: {\n        type: Boolean,\n        default: true\n      },\n      sms: {\n        type: Boolean,\n        default: true\n      },\n      inApp: {\n        type: Boolean,\n        default: true\n      }\n    },\n    reminderTimes: {\n      type: [Number],\n      default: [24] // Default reminder 24 hours before appointment\n    }\n  },\n  treatmentProvided: {\n    type: String,\n    trim: true\n  },\n  followUpRequired: {\n    type: Boolean,\n    default: false\n  },\n  followUpDate: {\n    type: Date\n  },\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: true\n  },\n  // Enhanced fields for unified dashboard\n  lastModifiedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  },\n  modificationHistory: [{\n    modifiedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    },\n    modifiedAt: {\n      type: Date,\n      required: true,\n      default: Date.now\n    },\n    changes: {\n      type: Schema.Types.Mixed,\n      required: true\n    }\n  }],\n  cancellationReason: {\n    type: String,\n    trim: true,\n    maxlength: [500, 'Cancellation reason cannot exceed 500 characters']\n  },\n  notificationsSent: [{\n    type: {\n      type: String,\n      enum: ['24h', '1h', '15min', 'confirmation', 'cancellation', 'rescheduling'],\n      required: true\n    },\n    sentAt: {\n      type: Date,\n      required: true,\n      default: Date.now\n    },\n    channels: {\n      type: [{\n        type: String,\n        enum: ['email', 'sms', 'inApp']\n      }],\n      required: true\n    },\n    status: {\n      type: String,\n      enum: ['sent', 'failed', 'delivered', 'pending'],\n      default: 'sent'\n    }\n  }]\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nappointmentSchema.index({ patientId: 1 });\nappointmentSchema.index({ dentistId: 1 });\nappointmentSchema.index({ clinicId: 1 });\nappointmentSchema.index({ date: 1 });\nappointmentSchema.index({ status: 1 });\nappointmentSchema.index({ date: 1, timeSlot: 1 });\nappointmentSchema.index({ dentistId: 1, date: 1, timeSlot: 1 }, { unique: true }); // Prevent double booking\nappointmentSchema.index({ serviceType: 1 });\nappointmentSchema.index({ createdAt: 1 });\n\n// Compound indexes for common queries\nappointmentSchema.index({ clinicId: 1, date: 1, status: 1 });\nappointmentSchema.index({ patientId: 1, status: 1, date: 1 });\nappointmentSchema.index({ dentistId: 1, status: 1, date: 1 });\n\n// Enhanced indexes for unified dashboard\nappointmentSchema.index({ dentistId: 1, clinicId: 1, date: 1 }); // Compound index for cross-clinic doctor view\nappointmentSchema.index({ lastModifiedBy: 1, createdAt: -1 }); // Index for audit trail\n\n// Virtual for appointment end time\nappointmentSchema.virtual('endTime').get(function(this: any) {\n  const [hours, minutes] = this.timeSlot.split(':').map(Number);\n  const startTime = new Date(this.date);\n  startTime.setHours(hours, minutes, 0, 0);\n  \n  const endTime = new Date(startTime.getTime() + this.duration * 60000);\n  return `${endTime.getHours().toString().padStart(2, '0')}:${endTime.getMinutes().toString().padStart(2, '0')}`;\n});\n\n// Virtual for full date-time\nappointmentSchema.virtual('dateTime').get(function(this: any) {\n  const appointmentDate = new Date(this.date);\n  const [hours, minutes] = this.timeSlot.split(':').map(Number);\n  appointmentDate.setHours(hours, minutes, 0, 0);\n  return appointmentDate;\n});\n\n// Virtual for appointment duration in hours\nappointmentSchema.virtual('durationInHours').get(function(this: any) {\n  return this.duration / 60;\n});\n\n// Instance method to check if appointment is in the past\nappointmentSchema.methods.isPast = function(this: any): boolean {\n  const appointmentDateTime = new Date(this.date);\n  const [hours, minutes] = this.timeSlot.split(':').map(Number);\n  appointmentDateTime.setHours(hours, minutes, 0, 0);\n  return appointmentDateTime < new Date();\n};\n\n// Instance method to check if appointment is today\nappointmentSchema.methods.isToday = function(this: any): boolean {\n  const today = new Date();\n  const appointmentDate = new Date(this.date);\n  return appointmentDate.toDateString() === today.toDateString();\n};\n\n// Instance method to check if appointment can be cancelled\nappointmentSchema.methods.canBeCancelled = function(this: any): boolean {\n  return ['scheduled', 'confirmed'].includes(this.status) && !this.isPast();\n};\n\n// Instance method to check if appointment can be rescheduled\nappointmentSchema.methods.canBeRescheduled = function(this: any): boolean {\n  return ['scheduled', 'confirmed'].includes(this.status) && !this.isPast();\n};\n\n// Static method to find appointments by date range\nappointmentSchema.statics.findByDateRange = function(startDate: Date, endDate: Date) {\n  return this.find({\n    date: {\n      $gte: startDate,\n      $lte: endDate\n    }\n  });\n};\n\n// Static method to find appointments for a specific dentist on a date\nappointmentSchema.statics.findByDentistAndDate = function(dentistId: string, date: Date) {\n  const startOfDay = new Date(date);\n  startOfDay.setHours(0, 0, 0, 0);\n  const endOfDay = new Date(date);\n  endOfDay.setHours(23, 59, 59, 999);\n  \n  return this.find({\n    dentistId,\n    date: {\n      $gte: startOfDay,\n      $lte: endOfDay\n    }\n  });\n};\n\n// Static method to check for conflicts\nappointmentSchema.statics.findConflicts = function(dentistId: string, date: Date, timeSlot: string, duration: number, excludeId?: string) {\n  const [hours, minutes] = timeSlot.split(':').map(Number);\n  const startTime = new Date(date);\n  startTime.setHours(hours, minutes, 0, 0);\n  const endTime = new Date(startTime.getTime() + duration * 60000);\n  \n  const query: any = {\n    dentistId,\n    date: {\n      $gte: new Date(date.getFullYear(), date.getMonth(), date.getDate()),\n      $lt: new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1)\n    },\n    status: { $in: ['scheduled', 'confirmed'] }\n  };\n  \n  if (excludeId) {\n    query._id = { $ne: excludeId };\n  }\n  \n  return this.find(query).then((appointments: any[]) => {\n    return appointments.filter((apt: any) => {\n      const [aptHours, aptMinutes] = apt.timeSlot.split(':').map(Number);\n      const aptStartTime = new Date(apt.date);\n      aptStartTime.setHours(aptHours, aptMinutes, 0, 0);\n      const aptEndTime = new Date(aptStartTime.getTime() + apt.duration * 60000);\n      \n      // Check for overlap\n      return (startTime < aptEndTime && endTime > aptStartTime);\n    });\n  });\n};\n\n// Static method to get available time slots\nappointmentSchema.statics.getAvailableTimeSlots = async function(dentistId: string, date: Date, duration: number = 30) {\n  try {\n    // Cast through unknown to satisfy TS where static `this` is typed as generic Model\n    const appointmentModel = (this as unknown) as IAppointmentModel;\n    \n    // Find the dentist to get their assigned clinic\n    const dentist = await mongoose.model('User').findById(dentistId).populate('assignedClinics');\n    if (!dentist || !dentist.assignedClinics || dentist.assignedClinics.length === 0) {\n      console.warn(`Dentist not found or not assigned to any clinic: ${dentistId}`);\n      return []; // No slots if dentist or clinic is invalid\n    }\n\n    // For simplicity, we'll use the first assigned clinic's operating hours.\n    // A more complex system might check schedules for a specific clinic if a dentist works at multiple.\n    const clinic = await (Clinic as any).findById(dentist.assignedClinics[0]);\n    if (!clinic || !clinic.operatingHours) {\n      console.warn(`Clinic or operating hours not found for dentist: ${dentistId}`);\n      return []; // No slots if clinic hours aren't defined\n    }\n    \n    // Determine operating hours for the specific day of the week\n    const dayOfWeek = date.toLocaleString('en-US', { weekday: 'long' }).toLowerCase();\n    const hoursForDay = clinic.operatingHours.find(h => h.day.toLowerCase() === dayOfWeek);\n\n    if (!hoursForDay || hoursForDay.closed) {\n      return []; // Clinic is closed on this day\n    }\n\n    const startHour = parseInt(hoursForDay.open.split(':')[0]);\n    const startMinute = parseInt(hoursForDay.open.split(':')[1]);\n    const endHour = parseInt(hoursForDay.close.split(':')[0]);\n    const endMinute = parseInt(hoursForDay.close.split(':')[1]);\n\n    const appointments = await appointmentModel.findByDentistAndDate(dentistId, date);\n    \n    const bookedSlots = appointments\n      .filter((apt: any) => ['scheduled', 'confirmed'].includes(apt.status))\n      .map((apt: any) => {\n        const [hours, minutes] = apt.timeSlot.split(':').map(Number);\n        const startTime = hours * 60 + minutes;\n        return {\n          start: startTime,\n          end: startTime + apt.duration\n        };\n      });\n      \n    const availableSlots = [];\n    const slotDuration = 30; // Assuming 30-minute slot increments for generation\n\n    let currentTime = startHour * 60 + startMinute;\n    const endTime = endHour * 60 + endMinute;\n    \n    while(currentTime + duration <= endTime) {\n      const slotStart = currentTime;\n      const slotEnd = slotStart + duration;\n\n      const hasConflict = bookedSlots.some(booked => \n        slotStart < booked.end && slotEnd > booked.start\n      );\n\n      if (!hasConflict) {\n        const hour = Math.floor(slotStart / 60);\n        const minute = slotStart % 60;\n        const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n        \n        const isPeak = hour >= 10 && hour < 14;\n        \n        availableSlots.push({\n          id: `${dentistId}-${date.toISOString().split('T')[0]}-${timeString}`,\n          time: timeString,\n          isAvailable: true,\n          isPeak: isPeak,\n          available: true\n        });\n      }\n      \n      currentTime += slotDuration;\n    }\n    \n    return availableSlots;\n  } catch (error) {\n    console.error(\"Error in getAvailableTimeSlots:\", error);\n    throw error; // Rethrow to be caught by the controller's error handler\n  }\n};\n\n// Static method to get next available slot after the last booked appointment\nappointmentSchema.statics.getNextSlotAfterLastBooking = async function(clinicId: string, date: Date, duration: number = 30) {\n  try {\n    // Get clinic operating hours\n    const clinic = await (Clinic as any).findById(clinicId);\n    if (!clinic || !clinic.operatingHours) {\n      console.warn(`Clinic or operating hours not found: ${clinicId}`);\n      return null;\n    }\n    \n    // Determine operating hours for the specific day of the week\n    const dayOfWeek = date.toLocaleString('en-US', { weekday: 'long' }).toLowerCase();\n    const hoursForDay = clinic.operatingHours.find(h => h.day.toLowerCase() === dayOfWeek);\n\n    if (!hoursForDay || hoursForDay.closed) {\n      return null; // Clinic is closed on this day\n    }\n\n    const startHour = parseInt(hoursForDay.open.split(':')[0]);\n    const startMinute = parseInt(hoursForDay.open.split(':')[1]);\n    const endHour = parseInt(hoursForDay.close.split(':')[0]);\n    const endMinute = parseInt(hoursForDay.close.split(':')[1]);\n    \n    const clinicStartTime = startHour * 60 + startMinute;\n    const clinicEndTime = endHour * 60 + endMinute;\n\n    // Find all appointments for this clinic on this date (across all dentists)\n    const startOfDay = new Date(date);\n    startOfDay.setHours(0, 0, 0, 0);\n    const endOfDay = new Date(date);\n    endOfDay.setHours(23, 59, 59, 999);\n    \n    const appointments = await this.find({\n      clinicId,\n      date: {\n        $gte: startOfDay,\n        $lte: endOfDay\n      },\n      status: { $in: ['scheduled', 'confirmed'] }\n    }).sort({ timeSlot: 1 });\n\n    let nextAvailableTime = clinicStartTime;\n\n    if (appointments.length > 0) {\n      // Find the latest end time among all appointments\n      let latestEndTime = 0;\n      \n      appointments.forEach((apt: any) => {\n        const [hours, minutes] = apt.timeSlot.split(':').map(Number);\n        const startTime = hours * 60 + minutes;\n        const endTime = startTime + apt.duration;\n        \n        if (endTime > latestEndTime) {\n          latestEndTime = endTime;\n        }\n      });\n      \n      // Set next available time to after the last appointment\n      nextAvailableTime = latestEndTime;\n    }\n\n    // Check if the next slot fits within clinic hours\n    if (nextAvailableTime + duration > clinicEndTime) {\n      return null; // No time available after last booking within clinic hours\n    }\n\n    // Convert back to time string\n    const hour = Math.floor(nextAvailableTime / 60);\n    const minute = nextAvailableTime % 60;\n    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n    \n    \n    const isPeak = hour >= 10 && hour < 14;\n\n    return {\n      time: timeString,\n      isAvailable: true,\n      isPeak: isPeak,\n      available: true,\n      id: `${clinicId}-${date.toISOString().split('T')[0]}-${timeString}`\n    };\n    \n  } catch (error) {\n    console.error(\"Error in getNextSlotAfterLastBooking:\", error);\n    throw error;\n  }\n};\n\n// Pre-save middleware for validation\nappointmentSchema.pre('save', async function(this: any, next) {\n  try {\n    // Check for conflicts only if this is a new appointment or date/time changed\n    // AND if a dentist is assigned (conflicts can only occur with specific dentists)\n    if ((this.isNew || this.isModified('date') || this.isModified('timeSlot') || this.isModified('duration')) && this.dentistId) {\n      const conflicts = await (this.constructor as any).findConflicts(\n        this.dentistId,\n        this.date,\n        this.timeSlot,\n        this.duration,\n        this._id\n      );\n      \n      if (conflicts.length > 0) {\n        throw new Error('This time slot conflicts with an existing appointment');\n      }\n    }\n    \n    next();\n  } catch (error) {\n    next(error as Error);\n  }\n});\n\nconst Appointment = mongoose.model<IAppointment, IAppointmentModel>('Appointment', appointmentSchema);\n\nexport default Appointment;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Billing.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3154,3157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3154,3157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3164,3167],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3164,3167],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3229,3232],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3229,3232],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3273,3276],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3273,3276],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4758,4761],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4758,4761],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4837,4840],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4837,4840],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":211,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5231,5234],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5231,5234],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":232,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5793,5796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5793,5796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { IBilling, IBillingModel } from '../types';\n\nconst billingSchema = new Schema<IBilling>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  appointmentId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Appointment'\n  },\n  treatmentRecordId: {\n    type: Schema.Types.ObjectId,\n    ref: 'TreatmentRecord'\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  dentistId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Dentist ID is required']\n  },\n  invoiceNumber: {\n    type: String,\n    unique: true,\n    required: [true, 'Invoice number is required']\n  },\n  items: [{\n    description: {\n      type: String,\n      required: [true, 'Item description is required'],\n      trim: true,\n      maxlength: [200, 'Description cannot exceed 200 characters']\n    },\n    quantity: {\n      type: Number,\n      required: [true, 'Quantity is required'],\n      min: [1, 'Quantity must be at least 1']\n    },\n    unitPrice: {\n      type: Number,\n      required: [true, 'Unit price is required'],\n      min: [0, 'Unit price cannot be negative']\n    },\n    totalPrice: {\n      type: Number,\n      required: [true, 'Total price is required'],\n      min: [0, 'Total price cannot be negative']\n    },\n    category: {\n      type: String,\n      enum: ['consultation', 'treatment', 'medication', 'equipment', 'other'],\n      default: 'treatment'\n    }\n  }],\n  subtotal: {\n    type: Number,\n    required: [true, 'Subtotal is required'],\n    min: [0, 'Subtotal cannot be negative']\n  },\n  taxAmount: {\n    type: Number,\n    default: 0,\n    min: [0, 'Tax amount cannot be negative']\n  },\n  discountAmount: {\n    type: Number,\n    default: 0,\n    min: [0, 'Discount amount cannot be negative']\n  },\n  totalAmount: {\n    type: Number,\n    required: [true, 'Total amount is required'],\n    min: [0, 'Total amount cannot be negative']\n  },\n  paidAmount: {\n    type: Number,\n    default: 0,\n    min: [0, 'Paid amount cannot be negative']\n  },\n  balanceAmount: {\n    type: Number,\n    default: 0\n  },\n  paymentMethod: {\n    type: String,\n    enum: ['cash', 'credit_card', 'debit_card', 'insurance', 'bank_transfer', 'check', 'other'],\n    default: 'cash'\n  },\n  paymentStatus: {\n    type: String,\n    enum: ['pending', 'partial', 'paid', 'overdue', 'cancelled'],\n    default: 'pending'\n  },\n  insuranceInfo: {\n    provider: {\n      type: String,\n      trim: true\n    },\n    policyNumber: {\n      type: String,\n      trim: true\n    },\n    coverageAmount: {\n      type: Number,\n      min: [0, 'Coverage amount cannot be negative']\n    },\n    claimNumber: {\n      type: String,\n      trim: true\n    }\n  },\n  dueDate: {\n    type: Date,\n    required: [true, 'Due date is required']\n  },\n  paidDate: {\n    type: Date\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Notes cannot exceed 1000 characters']\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nbillingSchema.index({ patientId: 1 });\nbillingSchema.index({ clinicId: 1 });\nbillingSchema.index({ dentistId: 1 });\n// Remove: billingSchema.index({ invoiceNumber: 1 });\nbillingSchema.index({ paymentStatus: 1 });\nbillingSchema.index({ dueDate: 1 });\nbillingSchema.index({ createdAt: -1 });\n\n// Virtual for checking if bill is overdue\nbillingSchema.virtual('isOverdue').get(function() {\n  return this.paymentStatus !== 'paid' && this.dueDate < new Date();\n});\n\n// Pre-save middleware to calculate balance\nbillingSchema.pre('save', function(next) {\n  this.balanceAmount = this.totalAmount - this.paidAmount;\n  \n  // Update payment status based on amounts\n  if (this.paidAmount === 0) {\n    this.paymentStatus = 'pending';\n  } else if (this.paidAmount < this.totalAmount) {\n    this.paymentStatus = 'partial';\n  } else if (this.paidAmount >= this.totalAmount) {\n    this.paymentStatus = 'paid';\n    if (!this.paidDate) {\n      this.paidDate = new Date();\n    }\n  }\n  \n  // Check if overdue\n  if (this.paymentStatus !== 'paid' && this.dueDate < new Date()) {\n    this.paymentStatus = 'overdue';\n  }\n  \n  next();\n});\n\n// Instance method to add payment\nbillingSchema.methods.addPayment = function(amount: number, method: string = 'cash') {\n  this.paidAmount += amount;\n  this.paymentMethod = method;\n  return this.save();\n};\n\n// Static method to find by patient\nbillingSchema.statics.findByPatient = function(patientId: string, options: any = {}) {\n  const { status, limit = 10, skip = 0 } = options;\n  const query: any = { patientId, isActive: true };\n  \n  if (status) {\n    query.paymentStatus = status;\n  }\n  \n  return this.find(query)\n    .populate('dentistId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .sort({ createdAt: -1 })\n    .limit(limit)\n    .skip(skip);\n};\n\n// Static method to find overdue bills\nbillingSchema.statics.findOverdue = function(clinicId?: string) {\n  const query: any = {\n    paymentStatus: { $in: ['pending', 'partial', 'overdue'] },\n    dueDate: { $lt: new Date() },\n    isActive: true\n  };\n  \n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName email phone')\n    .populate('clinicId', 'name')\n    .sort({ dueDate: 1 });\n};\n\n// Static method to get revenue statistics\nbillingSchema.statics.getRevenueStats = function(clinicId: string, startDate: Date, endDate: Date) {\n  return this.aggregate([\n    {\n      $match: {\n        clinicId: clinicId as any,\n        createdAt: { $gte: startDate, $lte: endDate },\n        isActive: true\n      }\n    },\n    {\n      $group: {\n        _id: null,\n        totalRevenue: { $sum: '$totalAmount' },\n        totalPaid: { $sum: '$paidAmount' },\n        totalPending: { $sum: { $cond: [{ $eq: ['$paymentStatus', 'pending'] }, '$balanceAmount', 0] } },\n        totalOverdue: { $sum: { $cond: [{ $eq: ['$paymentStatus', 'overdue'] }, '$balanceAmount', 0] } },\n        billCount: { $sum: 1 }\n      }\n    }\n  ]);\n};\n\nconst Billing = mongoose.model<IBilling, IBillingModel>('Billing', billingSchema);\n\nexport default Billing;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Clinic.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2687,2690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2687,2690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2893,2896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2893,2896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3376,3379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3376,3379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3386,3389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3386,3389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3451,3454],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3451,3454],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3495,3498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3495,3498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":165,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4642,4645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4642,4645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":171,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4903,4906],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4903,4906],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6936,6939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6936,6939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6972,6975],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6972,6975],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7047,7050],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7047,7050],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7264,7267],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7264,7267],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":247,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":247,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7291,7294],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7291,7294],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":247,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":247,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7313,7316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7313,7316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { IClinic, IClinicModel, Day } from '../types';\n\nconst clinicSchema = new Schema<IClinic>({\n  name: {\n    type: String,\n    required: [true, 'Clinic name is required'],\n    trim: true,\n    maxlength: [100, 'Clinic name cannot exceed 100 characters']\n  },\n  branchName: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Branch name cannot exceed 100 characters'],\n    index: true\n  },\n  description: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Description cannot exceed 1000 characters']\n  },\n  address: {\n    street: {\n      type: String,\n      required: [true, 'Street address is required'],\n      trim: true,\n      maxlength: [200, 'Street address cannot exceed 200 characters']\n    },\n    city: {\n      type: String,\n      required: [true, 'City is required'],\n      trim: true,\n      maxlength: [100, 'City cannot exceed 100 characters']\n    },\n    state: {\n      type: String,\n      required: [true, 'State is required'],\n      trim: true,\n      maxlength: [100, 'State cannot exceed 100 characters']\n    },\n    zipCode: {\n      type: String,\n      required: [true, 'Zip code is required'],\n      trim: true,\n      maxlength: [20, 'Zip code cannot exceed 20 characters']\n    },\n    country: {\n      type: String,\n      required: [true, 'Country is required'],\n      trim: true,\n      maxlength: [100, 'Country cannot exceed 100 characters']\n    },\n    coordinates: {\n      latitude: {\n        type: Number,\n        min: [-90, 'Latitude must be between -90 and 90'],\n        max: [90, 'Latitude must be between -90 and 90']\n      },\n      longitude: {\n        type: Number,\n        min: [-180, 'Longitude must be between -180 and 180'],\n        max: [180, 'Longitude must be between -180 and 180']\n      }\n    }\n  },\n  phone: {\n    type: String,\n    required: [true, 'Phone number is required'],\n    trim: true,\n    match: [/^[\\+]?[1-9][\\d]{0,15}$/, 'Please provide a valid phone number']\n  },\n  email: {\n    type: String,\n    required: [true, 'Email is required'],\n    lowercase: true,\n    trim: true,\n    match: [/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/, 'Please provide a valid email']\n  },\n  website: {\n    type: String,\n    trim: true,\n    match: [/^https?:\\/\\/.+/, 'Please provide a valid website URL']\n  },\n  emergencyContact: {\n    type: String,\n    trim: true,\n    match: [/^[\\+]?[1-9][\\d]{0,15}$/, 'Please provide a valid emergency contact number']\n  },\n  operatingHours: [{\n    day: {\n      type: String,\n      enum: ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'],\n      required: [true, 'Day is required']\n    },\n    open: {\n      type: String,\n      required: function(this: any) {\n        return !this.closed;\n      },\n      match: [/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/, 'Please provide time in HH:MM format']\n    },\n    close: {\n      type: String,\n      required: function(this: any) {\n        return !this.closed;\n      },\n      match: [/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/, 'Please provide time in HH:MM format']\n    },\n    closed: {\n      type: Boolean,\n      default: false\n    }\n  }],\n  services: [{\n    type: String,\n    trim: true,\n    maxlength: [100, 'Service name cannot exceed 100 characters']\n  }],\n  staff: [{\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }]\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nclinicSchema.index({ name: 1 });\nclinicSchema.index({ branchName: 1 });\nclinicSchema.index({ name: 1, branchName: 1 });\nclinicSchema.index({ 'address.city': 1 });\nclinicSchema.index({ 'address.state': 1 });\nclinicSchema.index({ 'address.zipCode': 1 });\nclinicSchema.index({ services: 1 });\nclinicSchema.index({ staff: 1 });\nclinicSchema.index({ 'address.coordinates.latitude': 1, 'address.coordinates.longitude': 1 });\n\n// Virtual for full address\nclinicSchema.virtual('fullAddress').get(function() {\n  const { street, city, state, zipCode, country } = this.address;\n  return `${street}, ${city}, ${state} ${zipCode}, ${country}`;\n});\n\n// Virtual for staff count\nclinicSchema.virtual('staffCount').get(function() {\n  return this.staff ? this.staff.length : 0;\n});\n\n// Virtual for services count\nclinicSchema.virtual('servicesCount').get(function() {\n  return this.services ? this.services.length : 0;\n});\n\n// Instance method to check if clinic is open on a specific day\nclinicSchema.methods.isOpenOnDay = function(day: Day): boolean {\n  const daySchedule = this.operatingHours.find((schedule: any) => schedule.day === day);\n  return daySchedule ? !daySchedule.closed : false;\n};\n\n// Instance method to get operating hours for a specific day\nclinicSchema.methods.getOperatingHoursForDay = function(day: Day) {\n  return this.operatingHours.find((schedule: any) => schedule.day === day);\n};\n\n// Instance method to check if clinic offers a specific service\nclinicSchema.methods.offersService = function(service: string): boolean {\n  return this.services.includes(service);\n};\n\n// Static method to find clinics by city\nclinicSchema.statics.findByCity = function(city: string) {\n  return this.find({ 'address.city': new RegExp(city, 'i') });\n};\n\n// Static method to find clinics by state\nclinicSchema.statics.findByState = function(state: string) {\n  return this.find({ 'address.state': new RegExp(state, 'i') });\n};\n\n// Static method to find clinics offering specific service\nclinicSchema.statics.findByService = function(service: string) {\n  return this.find({ services: new RegExp(service, 'i') });\n};\n\n// Static method to find clinics within radius (requires coordinates)\nclinicSchema.statics.findNearby = function(latitude: number, longitude: number, radiusInKm: number = 10) {\n  return this.find({\n    'address.coordinates': {\n      $near: {\n        $geometry: {\n          type: 'Point',\n          coordinates: [longitude, latitude]\n        },\n        $maxDistance: radiusInKm * 1000 // Convert km to meters\n      }\n    }\n  });\n};\n\n// Static method to search clinics\nclinicSchema.statics.searchClinics = function(searchTerm: string) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  return this.find({\n    $or: [\n      { name: searchRegex },\n      { description: searchRegex },\n      { 'address.city': searchRegex },\n      { 'address.state': searchRegex },\n      { services: searchRegex }\n    ]\n  });\n};\n\n// Static method to find clinics by name\nclinicSchema.statics.findByName = function(name: string) {\n  return this.find({ name: new RegExp(name, 'i') });\n};\n\n// Pre-save middleware to ensure operating hours for all days\nclinicSchema.pre('save', function(next) {\n  const days: Day[] = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];\n  \n  // Ensure we have operating hours for all days\n  days.forEach(day => {\n    const existingSchedule = (this as any).operatingHours.find((schedule: any) => schedule.day === day);\n    if (!existingSchedule) {\n      (this as any).operatingHours.push({\n        day,\n        open: '09:00',\n        close: '17:00',\n        closed: true // Default to closed if not specified\n      });\n    }\n  });\n  \n  // Ensure email is lowercase\n  if ((this as any).email) {\n    (this as any).email = (this as any).email.toLowerCase();\n  }\n  \n  next();\n});\n\nconst Clinic = mongoose.model<IClinic, IClinicModel>('Clinic', clinicSchema);\n\nexport default Clinic;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\DoctorSchedule.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":20,"column":70,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":20,"endColumn":72,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[689,691],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[689,691],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":20,"column":74,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":20,"endColumn":76,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[693,695],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[693,695],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":20,"column":78,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":20,"endColumn":80,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[697,699],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[697,699],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[701,704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[701,704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":87,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":90,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[706,709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[706,709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[711,714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[711,714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2886,2889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2886,2889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2896,2899],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2896,2899],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3961,3964],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3961,3964],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4400,4403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4400,4403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4886,4889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4886,4889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5349,5352],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5349,5352],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema, Document, Model } from 'mongoose';\n\n// Interface for DoctorSchedule document\nexport interface IDoctorSchedule extends Document {\n  _id: mongoose.Types.ObjectId;\n  doctorId: mongoose.Types.ObjectId;\n  clinicId: mongoose.Types.ObjectId;\n  dayOfWeek: 0 | 1 | 2 | 3 | 4 | 5 | 6; // 0=Sunday, 1=Monday, ..., 6=Saturday\n  startTime: string; // Format: \"HH:mm\" (24-hour format, e.g., \"14:30\")\n  endTime: string;   // Format: \"HH:mm\"\n  isActive: boolean;\n  notes?: string;\n  effectiveFrom?: Date;\n  effectiveUntil?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Interface for model static methods\nexport interface IDoctorScheduleModel extends Model<IDoctorSchedule, {}, {}, {}, any, any, any> {\n  findByDoctor(doctorId: string, isActive?: boolean): Promise<IDoctorSchedule[]>;\n  findByClinic(clinicId: string, isActive?: boolean): Promise<IDoctorSchedule[]>;\n  findByDoctorAndClinic(doctorId: string, clinicId: string, isActive?: boolean): Promise<IDoctorSchedule[]>;\n  findByDoctorAndDay(doctorId: string, dayOfWeek: number, clinicId?: string): Promise<IDoctorSchedule[]>;\n  getAvailableDoctorsForDay(clinicId: string, dayOfWeek: number): Promise<IDoctorSchedule[]>;\n}\n\nconst doctorScheduleSchema = new Schema<IDoctorSchedule>({\n  doctorId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Doctor ID is required'],\n    index: true\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required'],\n    index: true\n  },\n  dayOfWeek: {\n    type: Number,\n    required: [true, 'Day of week is required'],\n    min: 0,\n    max: 6,\n    validate: {\n      validator: function(value: number) {\n        return Number.isInteger(value) && value >= 0 && value <= 6;\n      },\n      message: 'Day of week must be an integer between 0 (Sunday) and 6 (Saturday)'\n    }\n  },\n  startTime: {\n    type: String,\n    required: [true, 'Start time is required'],\n    validate: {\n      validator: function(value: string) {\n        // Validate HH:mm format\n        return /^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(value);\n      },\n      message: 'Start time must be in HH:mm format (e.g., \"14:30\")'\n    }\n  },\n  endTime: {\n    type: String,\n    required: [true, 'End time is required'],\n    validate: {\n      validator: function(value: string) {\n        // Validate HH:mm format\n        return /^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(value);\n      },\n      message: 'End time must be in HH:mm format (e.g., \"18:00\")'\n    }\n  },\n  isActive: {\n    type: Boolean,\n    default: true,\n    index: true\n  },\n  notes: {\n    type: String,\n    maxlength: [500, 'Notes cannot exceed 500 characters'],\n    trim: true\n  },\n  effectiveFrom: {\n    type: Date,\n    default: Date.now\n  },\n  effectiveUntil: {\n    type: Date,\n    default: null\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      delete ret._id;\n      delete ret.__v;\n      return ret;\n    }\n  }\n});\n\n// Compound indexes for efficient queries\ndoctorScheduleSchema.index({ doctorId: 1, clinicId: 1 });\ndoctorScheduleSchema.index({ doctorId: 1, dayOfWeek: 1 });\ndoctorScheduleSchema.index({ clinicId: 1, dayOfWeek: 1 });\ndoctorScheduleSchema.index({ doctorId: 1, clinicId: 1, dayOfWeek: 1 });\ndoctorScheduleSchema.index({ isActive: 1, doctorId: 1 });\n\n// Pre-save validation: ensure start time is before end time\ndoctorScheduleSchema.pre('save', function(next) {\n  const start = this.startTime.split(':').map(Number);\n  const end = this.endTime.split(':').map(Number);\n  \n  const startMinutes = start[0] * 60 + start[1];\n  const endMinutes = end[0] * 60 + end[1];\n  \n  if (startMinutes >= endMinutes) {\n    return next(new Error('Start time must be before end time'));\n  }\n  \n  next();\n});\n\n// Static method: Find schedules by doctor\ndoctorScheduleSchema.statics.findByDoctor = async function(\n  doctorId: string,\n  isActive: boolean = true\n) {\n  const query: any = { doctorId };\n  if (isActive !== undefined) {\n    query.isActive = isActive;\n  }\n  \n  return this.find(query)\n    .populate('doctorId', 'firstName lastName email')\n    .populate('clinicId', 'name branchName address')\n    .sort({ dayOfWeek: 1, startTime: 1 });\n};\n\n// Static method: Find schedules by clinic\ndoctorScheduleSchema.statics.findByClinic = async function(\n  clinicId: string,\n  isActive: boolean = true\n) {\n  const query: any = { clinicId };\n  if (isActive !== undefined) {\n    query.isActive = isActive;\n  }\n  \n  return this.find(query)\n    .populate('doctorId', 'firstName lastName email specialization')\n    .populate('clinicId', 'name branchName')\n    .sort({ dayOfWeek: 1, startTime: 1 });\n};\n\n// Static method: Find schedules by doctor and clinic\ndoctorScheduleSchema.statics.findByDoctorAndClinic = async function(\n  doctorId: string,\n  clinicId: string,\n  isActive: boolean = true\n) {\n  const query: any = { doctorId, clinicId };\n  if (isActive !== undefined) {\n    query.isActive = isActive;\n  }\n  \n  return this.find(query)\n    .populate('doctorId', 'firstName lastName')\n    .populate('clinicId', 'name branchName')\n    .sort({ dayOfWeek: 1, startTime: 1 });\n};\n\n// Static method: Find schedules by doctor and day\ndoctorScheduleSchema.statics.findByDoctorAndDay = async function(\n  doctorId: string,\n  dayOfWeek: number,\n  clinicId?: string\n) {\n  const query: any = {\n    doctorId,\n    dayOfWeek,\n    isActive: true\n  };\n  \n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  return this.find(query)\n    .populate('doctorId', 'firstName lastName')\n    .populate('clinicId', 'name branchName')\n    .sort({ startTime: 1 });\n};\n\n// Static method: Get all available doctors for a specific day at a clinic\ndoctorScheduleSchema.statics.getAvailableDoctorsForDay = async function(\n  clinicId: string,\n  dayOfWeek: number\n) {\n  return this.find({\n    clinicId,\n    dayOfWeek,\n    isActive: true\n  })\n    .populate('doctorId', 'firstName lastName email specialization')\n    .populate('clinicId', 'name branchName')\n    .sort({ startTime: 1 });\n};\n\n// Virtual: Get day name\ndoctorScheduleSchema.virtual('dayName').get(function() {\n  const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  return days[this.dayOfWeek];\n});\n\n// Virtual: Get duration in minutes\ndoctorScheduleSchema.virtual('durationMinutes').get(function() {\n  const start = this.startTime.split(':').map(Number);\n  const end = this.endTime.split(':').map(Number);\n  \n  const startMinutes = start[0] * 60 + start[1];\n  const endMinutes = end[0] * 60 + end[1];\n  \n  return endMinutes - startMinutes;\n});\n\n// Virtual: Check if schedule is currently effective\ndoctorScheduleSchema.virtual('isCurrentlyEffective').get(function() {\n  const now = new Date();\n  \n  if (this.effectiveFrom && now < this.effectiveFrom) {\n    return false;\n  }\n  \n  if (this.effectiveUntil && now > this.effectiveUntil) {\n    return false;\n  }\n  \n  return this.isActive;\n});\n\nconst DoctorSchedule = mongoose.model<IDoctorSchedule, IDoctorScheduleModel>(\n  'DoctorSchedule',\n  doctorScheduleSchema\n);\n\nexport default DoctorSchedule;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\HomepageContentBlock.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[365,368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[365,368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[821,824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[821,824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport type ContentType = 'text' | 'image' | 'video';\nexport type ContentStatus = 'draft' | 'pending_review' | 'approved' | 'scheduled' | 'published' | 'archived';\nexport type ApprovalStatus = 'pending' | 'approved' | 'rejected';\n\ninterface ContentVersion {\n  _id?: Types.ObjectId;\n  data: Record<string, any>;\n  note?: string;\n  createdBy: Types.ObjectId;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\ninterface ApprovalEntry {\n  _id?: Types.ObjectId;\n  status: ApprovalStatus;\n  requestedBy: Types.ObjectId;\n  reviewer?: Types.ObjectId;\n  comment?: string;\n  createdAt?: Date;\n  updatedAt?: Date;\n  approvedAt?: Date;\n}\n\nexport interface IHomepageContentBlock extends Document {\n  title: string;\n  sectionKey: string;\n  type: ContentType;\n  data: Record<string, any>;\n  order: number;\n  visible: boolean;\n  status: ContentStatus;\n  versions: ContentVersion[];\n  currentVersionId?: Types.ObjectId;\n  approvals: ApprovalEntry[];\n  scheduledFor?: Date;\n  scheduledTo?: Date;\n  timezone?: string;\n  publishedAt?: Date;\n  createdBy?: Types.ObjectId;\n  updatedBy?: Types.ObjectId;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\nconst ContentVersionSchema = new Schema<ContentVersion>({\n  data: { type: Schema.Types.Mixed, required: true },\n  note: { type: String },\n  createdBy: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n}, { timestamps: true });\n\nconst ApprovalSchema = new Schema<ApprovalEntry>({\n  status: { type: String, enum: ['pending', 'approved', 'rejected'], required: true },\n  requestedBy: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n  reviewer: { type: Schema.Types.ObjectId, ref: 'User' },\n  comment: { type: String },\n  approvedAt: { type: Date },\n}, { timestamps: true });\n\nconst HomepageContentBlockSchema = new Schema<IHomepageContentBlock>({\n  title: { type: String, required: true },\n  sectionKey: { type: String, required: true, index: true },\n  type: { type: String, enum: ['text', 'image', 'video'], required: true },\n  data: { type: Schema.Types.Mixed, required: true },\n  order: { type: Number, default: 0 },\n  visible: { type: Boolean, default: true },\n  status: { type: String, enum: ['draft', 'pending_review', 'approved', 'scheduled', 'published', 'archived'], default: 'draft', index: true },\n  versions: { type: [ContentVersionSchema], default: [] },\n  currentVersionId: { type: Schema.Types.ObjectId },\n  approvals: { type: [ApprovalSchema], default: [] },\n  scheduledFor: { type: Date },\n  scheduledTo: { type: Date },\n  timezone: { type: String, default: 'UTC' },\n  publishedAt: { type: Date },\n  createdBy: { type: Schema.Types.ObjectId, ref: 'User' },\n  updatedBy: { type: Schema.Types.ObjectId, ref: 'User' },\n}, { timestamps: true });\n\nHomepageContentBlockSchema.index({ sectionKey: 1, order: 1 });\nHomepageContentBlockSchema.index({ status: 1, scheduledFor: 1 });\n\nexport default model<IHomepageContentBlock>('HomepageContentBlock', HomepageContentBlockSchema);","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Insurance.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":512,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":512,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13627,13630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13627,13630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface IInsurance extends Document {\n  _id: Types.ObjectId;\n  patientId: Types.ObjectId;\n  \n  // Primary Insurance Information\n  insuranceCompany: string;\n  policyNumber: string;\n  groupNumber?: string;\n  membershipNumber?: string;\n  \n  // Policy Holder Information\n  policyHolderName: string;\n  relationshipToPolicyHolder: 'self' | 'spouse' | 'child' | 'parent' | 'other';\n  policyHolderDateOfBirth?: Date;\n  policyHolderSSN?: string; // Encrypted\n  \n  // Coverage Information\n  coverageType: 'individual' | 'family' | 'group';\n  effectiveDate: Date;\n  expirationDate?: Date;\n  isActive: boolean;\n  \n  // Coverage Details\n  dentalCoveragePercentage?: number; // e.g., 80% coverage\n  annualMaxBenefit?: number;\n  annualDeductible?: number;\n  usedBenefits?: number;\n  remainingBenefits?: number;\n  \n  // Specific Coverage\n  preventiveCoverage?: number; // Usually 100%\n  basicCoverage?: number; // Usually 80%\n  majorCoverage?: number; // Usually 50%\n  orthodonticCoverage?: number;\n  orthodonticLifetimeMax?: number;\n  orthodonticUsed?: number;\n  \n  // Contact Information\n  insurancePhone?: string;\n  insuranceAddress?: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n  };\n  \n  // Verification Status\n  verificationStatus: 'pending' | 'verified' | 'expired' | 'invalid';\n  lastVerified?: Date;\n  verificationNotes?: string;\n  verifiedBy?: Types.ObjectId;\n  \n  // Claims Information\n  eligibilityStatus: 'eligible' | 'not_eligible' | 'pending' | 'unknown';\n  preAuthorizationRequired: boolean;\n  waitingPeriods?: Array<{\n    service: string;\n    months: number;\n    satisfied: boolean;\n  }>;\n  \n  // Exclusions and Limitations\n  exclusions?: string[];\n  limitations?: string[];\n  \n  // Audit\n  createdBy: Types.ObjectId;\n  updatedBy?: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst insuranceSchema = new Schema<IInsurance>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  \n  // Primary Insurance Information\n  insuranceCompany: {\n    type: String,\n    required: [true, 'Insurance company name is required'],\n    trim: true,\n    maxlength: [200, 'Insurance company name cannot exceed 200 characters']\n  },\n  policyNumber: {\n    type: String,\n    required: [true, 'Policy number is required'],\n    trim: true,\n    maxlength: [100, 'Policy number cannot exceed 100 characters']\n  },\n  groupNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Group number cannot exceed 50 characters']\n  },\n  membershipNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Membership number cannot exceed 50 characters']\n  },\n  \n  // Policy Holder Information\n  policyHolderName: {\n    type: String,\n    required: [true, 'Policy holder name is required'],\n    trim: true,\n    maxlength: [200, 'Policy holder name cannot exceed 200 characters']\n  },\n  relationshipToPolicyHolder: {\n    type: String,\n    required: [true, 'Relationship to policy holder is required'],\n    enum: ['self', 'spouse', 'child', 'parent', 'other']\n  },\n  policyHolderDateOfBirth: {\n    type: Date\n  },\n  policyHolderSSN: {\n    type: String,\n    trim: true\n  },\n  \n  // Coverage Information\n  coverageType: {\n    type: String,\n    required: [true, 'Coverage type is required'],\n    enum: ['individual', 'family', 'group']\n  },\n  effectiveDate: {\n    type: Date,\n    required: [true, 'Effective date is required']\n  },\n  expirationDate: {\n    type: Date\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  },\n  \n  // Coverage Details\n  dentalCoveragePercentage: {\n    type: Number,\n    min: [0, 'Coverage percentage cannot be negative'],\n    max: [100, 'Coverage percentage cannot exceed 100%']\n  },\n  annualMaxBenefit: {\n    type: Number,\n    min: [0, 'Annual max benefit cannot be negative']\n  },\n  annualDeductible: {\n    type: Number,\n    min: [0, 'Annual deductible cannot be negative'],\n    default: 0\n  },\n  usedBenefits: {\n    type: Number,\n    min: [0, 'Used benefits cannot be negative'],\n    default: 0\n  },\n  remainingBenefits: {\n    type: Number,\n    min: [0, 'Remaining benefits cannot be negative']\n  },\n  \n  // Specific Coverage\n  preventiveCoverage: {\n    type: Number,\n    min: [0, 'Preventive coverage cannot be negative'],\n    max: [100, 'Preventive coverage cannot exceed 100%'],\n    default: 100\n  },\n  basicCoverage: {\n    type: Number,\n    min: [0, 'Basic coverage cannot be negative'],\n    max: [100, 'Basic coverage cannot exceed 100%'],\n    default: 80\n  },\n  majorCoverage: {\n    type: Number,\n    min: [0, 'Major coverage cannot be negative'],\n    max: [100, 'Major coverage cannot exceed 100%'],\n    default: 50\n  },\n  orthodonticCoverage: {\n    type: Number,\n    min: [0, 'Orthodontic coverage cannot be negative'],\n    max: [100, 'Orthodontic coverage cannot exceed 100%'],\n    default: 0\n  },\n  orthodonticLifetimeMax: {\n    type: Number,\n    min: [0, 'Orthodontic lifetime max cannot be negative']\n  },\n  orthodonticUsed: {\n    type: Number,\n    min: [0, 'Orthodontic used cannot be negative'],\n    default: 0\n  },\n  \n  // Contact Information\n  insurancePhone: {\n    type: String,\n    trim: true,\n    match: [/^[\\+]?[1-9][\\d]{0,15}$/, 'Please provide a valid phone number']\n  },\n  insuranceAddress: {\n    street: {\n      type: String,\n      trim: true,\n      maxlength: [200, 'Street address cannot exceed 200 characters']\n    },\n    city: {\n      type: String,\n      trim: true,\n      maxlength: [100, 'City cannot exceed 100 characters']\n    },\n    state: {\n      type: String,\n      trim: true,\n      maxlength: [50, 'State cannot exceed 50 characters']\n    },\n    zipCode: {\n      type: String,\n      trim: true,\n      maxlength: [20, 'Zip code cannot exceed 20 characters']\n    }\n  },\n  \n  // Verification Status\n  verificationStatus: {\n    type: String,\n    enum: ['pending', 'verified', 'expired', 'invalid'],\n    default: 'pending'\n  },\n  lastVerified: {\n    type: Date\n  },\n  verificationNotes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Verification notes cannot exceed 1000 characters']\n  },\n  verifiedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  },\n  \n  // Claims Information\n  eligibilityStatus: {\n    type: String,\n    enum: ['eligible', 'not_eligible', 'pending', 'unknown'],\n    default: 'unknown'\n  },\n  preAuthorizationRequired: {\n    type: Boolean,\n    default: false\n  },\n  waitingPeriods: [{\n    service: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    months: {\n      type: Number,\n      required: true,\n      min: [0, 'Waiting period cannot be negative']\n    },\n    satisfied: {\n      type: Boolean,\n      default: false\n    }\n  }],\n  \n  // Exclusions and Limitations\n  exclusions: [{\n    type: String,\n    trim: true,\n    maxlength: [500, 'Each exclusion cannot exceed 500 characters']\n  }],\n  limitations: [{\n    type: String,\n    trim: true,\n    maxlength: [500, 'Each limitation cannot exceed 500 characters']\n  }],\n  \n  // Audit\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'CreatedBy is required']\n  },\n  updatedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }\n}, {\n  timestamps: true,\n  toJSON: { virtuals: true },\n  toObject: { virtuals: true }\n});\n\n// Indexes\ninsuranceSchema.index({ patientId: 1 });\ninsuranceSchema.index({ policyNumber: 1 });\ninsuranceSchema.index({ insuranceCompany: 1 });\ninsuranceSchema.index({ verificationStatus: 1 });\ninsuranceSchema.index({ eligibilityStatus: 1 });\ninsuranceSchema.index({ isActive: 1 });\ninsuranceSchema.index({ expirationDate: 1 });\n\n// Compound indexes\ninsuranceSchema.index({ patientId: 1, isActive: 1 });\ninsuranceSchema.index({ insuranceCompany: 1, policyNumber: 1 }, { unique: true });\n\n// Virtual for remaining orthodontic benefits\ninsuranceSchema.virtual('remainingOrthodonticBenefits').get(function() {\n  if (!this.orthodonticLifetimeMax) return 0;\n  return Math.max(0, this.orthodonticLifetimeMax - (this.orthodonticUsed || 0));\n});\n\n// Virtual for benefit year progress\ninsuranceSchema.virtual('benefitYearProgress').get(function() {\n  if (!this.annualMaxBenefit) return 0;\n  const usedPercentage = ((this.usedBenefits || 0) / this.annualMaxBenefit) * 100;\n  return Math.min(100, usedPercentage);\n});\n\n// Virtual for coverage status\ninsuranceSchema.virtual('coverageStatus').get(function() {\n  if (!this.isActive) return 'inactive';\n  if (this.expirationDate && this.expirationDate < new Date()) return 'expired';\n  if (this.verificationStatus === 'verified') return 'active';\n  return 'pending_verification';\n});\n\n// Pre-save middleware\ninsuranceSchema.pre('save', function(next) {\n  // Calculate remaining benefits\n  if (this.isModified('usedBenefits') || this.isModified('annualMaxBenefit')) {\n    if (this.annualMaxBenefit && this.usedBenefits !== undefined) {\n      this.remainingBenefits = Math.max(0, this.annualMaxBenefit - this.usedBenefits);\n    }\n  }\n  \n  // Check if insurance is expired\n  if (this.expirationDate && this.expirationDate < new Date() && this.isActive) {\n    this.isActive = false;\n    this.verificationStatus = 'expired';\n  }\n  \n  next();\n});\n\n// Static methods\ninsuranceSchema.statics.findByPatient = function(patientId: string) {\n  return this.find({ patientId, isActive: true })\n    .populate('verifiedBy', 'firstName lastName')\n    .sort({ createdAt: -1 });\n};\n\ninsuranceSchema.statics.findActiveInsurance = function(patientId: string) {\n  return this.findOne({ \n    patientId, \n    isActive: true,\n    verificationStatus: 'verified',\n    $or: [\n      { expirationDate: { $gte: new Date() } },\n      { expirationDate: null }\n    ]\n  });\n};\n\ninsuranceSchema.statics.findExpiring = function(days: number = 30) {\n  const futureDate = new Date();\n  futureDate.setDate(futureDate.getDate() + days);\n  \n  return this.find({\n    isActive: true,\n    expirationDate: {\n      $gte: new Date(),\n      $lte: futureDate\n    }\n  }).populate('patientId', 'firstName lastName email');\n};\n\ninsuranceSchema.statics.getVerificationStatistics = function() {\n  return this.aggregate([\n    {\n      $group: {\n        _id: '$verificationStatus',\n        count: { $sum: 1 },\n        averageUsedBenefits: { $avg: '$usedBenefits' }\n      }\n    }\n  ]);\n};\n\n// Instance methods\ninsuranceSchema.methods.calculateCoverage = function(treatmentType: string, amount: number) {\n  let coveragePercentage = 0;\n  \n  switch (treatmentType.toLowerCase()) {\n    case 'preventive':\n    case 'cleaning':\n    case 'exam':\n      coveragePercentage = this.preventiveCoverage || 0;\n      break;\n    case 'basic':\n    case 'filling':\n    case 'extraction':\n      coveragePercentage = this.basicCoverage || 0;\n      break;\n    case 'major':\n    case 'crown':\n    case 'bridge':\n    case 'implant':\n      coveragePercentage = this.majorCoverage || 0;\n      break;\n    case 'orthodontic':\n      coveragePercentage = this.orthodonticCoverage || 0;\n      break;\n    default:\n      coveragePercentage = this.dentalCoveragePercentage || 0;\n  }\n  \n  const coveredAmount = (amount * coveragePercentage) / 100;\n  const remainingBenefits = this.remainingBenefits || 0;\n  \n  return {\n    coveragePercentage,\n    coveredAmount: Math.min(coveredAmount, remainingBenefits),\n    patientResponsibility: amount - Math.min(coveredAmount, remainingBenefits),\n    exceedsAnnualMax: coveredAmount > remainingBenefits\n  };\n};\n\ninsuranceSchema.methods.markAsVerified = function(verifiedById: Types.ObjectId, notes?: string) {\n  this.verificationStatus = 'verified';\n  this.lastVerified = new Date();\n  this.verifiedBy = verifiedById;\n  if (notes) {\n    this.verificationNotes = notes;\n  }\n  return this.save();\n};\n\ninsuranceSchema.methods.updateBenefitUsage = function(amount: number) {\n  this.usedBenefits = (this.usedBenefits || 0) + amount;\n  if (this.annualMaxBenefit) {\n    this.remainingBenefits = Math.max(0, this.annualMaxBenefit - this.usedBenefits);\n  }\n  return this.save();\n};\n\ninsuranceSchema.methods.resetAnnualBenefits = function() {\n  this.usedBenefits = 0;\n  if (this.annualMaxBenefit) {\n    this.remainingBenefits = this.annualMaxBenefit;\n  }\n  return this.save();\n};\n\ninsuranceSchema.methods.updateBenefitUsage = function(amount: number) {\n  this.usedBenefits = (this.usedBenefits || 0) + amount;\n  if (this.annualMaxBenefit) {\n    this.remainingBenefits = Math.max(0, this.annualMaxBenefit - this.usedBenefits);\n  }\n  return this.save();\n};\n\n// Instance methods\ninsuranceSchema.methods.markAsVerified = function() {\n  this.verificationStatus = 'verified';\n  this.lastVerified = new Date();\n  return this.save();\n};\n\ninsuranceSchema.methods.calculateCoverage = function(treatmentCost: number) {\n  let coverageAmount = 0;\n  \n  if (this.coverageType === 'percentage' && this.coveragePercentage) {\n    coverageAmount = (treatmentCost * this.coveragePercentage) / 100;\n  } else if (this.coverageType === 'fixed' && this.fixedCoverage) {\n    coverageAmount = Math.min(treatmentCost, this.fixedCoverage);\n  }\n  \n  // Apply deductible\n  if (this.deductible && this.deductibleMet !== undefined) {\n    const remainingDeductible = Math.max(0, this.deductible - this.deductibleMet);\n    coverageAmount = Math.max(0, coverageAmount - remainingDeductible);\n  }\n  \n  // Apply annual limits\n  if (this.remainingBenefits !== undefined) {\n    coverageAmount = Math.min(coverageAmount, this.remainingBenefits);\n  }\n  \n  return {\n    coverageAmount,\n    patientResponsibility: treatmentCost - coverageAmount,\n    copayAmount: this.copayAmount || 0\n  };\n};\n\n// Static methods\ninsuranceSchema.statics.findActiveInsurance = function(patientId?: string) {\n  const query: any = { \n    isActive: true,\n    $or: [\n      { expiryDate: { $exists: false } },\n      { expiryDate: { $gte: new Date() } }\n    ]\n  };\n  \n  if (patientId) {\n    query.patientId = patientId;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName')\n    .sort({ createdAt: -1 });\n};\n\ninsuranceSchema.statics.findByPatient = function(patientId: string) {\n  return this.find({ patientId })\n    .sort({ createdAt: -1 });\n};\n\ninsuranceSchema.statics.findExpiring = function(days: number = 30) {\n  const futureDate = new Date();\n  futureDate.setDate(futureDate.getDate() + days);\n  \n  return this.find({\n    isActive: true,\n    expiryDate: {\n      $gte: new Date(),\n      $lte: futureDate\n    }\n  })\n    .populate('patientId', 'firstName lastName');\n};\n\ninsuranceSchema.statics.getVerificationStatistics = function() {\n  return this.aggregate([\n    {\n      $group: {\n        _id: '$verificationStatus',\n        count: { $sum: 1 }\n      }\n    }\n  ]);\n};\n\n// Instance methods\ninsuranceSchema.methods.markAsVerified = function() {\n  this.verificationStatus = 'verified';\n  this.verifiedAt = new Date();\n  return this.save();\n};\n\ninsuranceSchema.methods.calculateCoverage = function(procedureCode: string, amount: number) {\n  const coveragePercent = this.planType === 'premium' ? 0.8 : 0.6;\n  return {\n    coveredAmount: amount * coveragePercent,\n    patientResponsibility: amount * (1 - coveragePercent)\n  };\n};\n\ninsuranceSchema.methods.updateBenefitUsage = function(amount: number) {\n  if (!this.usedBenefits) this.usedBenefits = { annual: 0, remaining: this.maxBenefit || 0 };\n  this.usedBenefits.annual += amount;\n  return this.save();\n};\n\nconst Insurance = model<IInsurance>('Insurance', insuranceSchema);\nexport default Insurance;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\InsuranceClaim.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":472,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":472,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11095,11098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11095,11098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":474,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":474,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11174,11177],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11174,11177],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":497,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":497,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11834,11837],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11834,11837],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":510,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":510,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12210,12213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12210,12213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":526,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":526,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12650,12653],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12650,12653],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":665,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":665,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15819,15822],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15819,15822],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":672,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":672,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16031,16034],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16031,16034],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":684,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":684,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16316,16319],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16316,16319],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":754,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":754,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18323,18326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18323,18326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface IInsuranceClaim extends Document {\n  _id: Types.ObjectId;\n  \n  // Basic Information\n  claimNumber: string;\n  insuranceId: Types.ObjectId;\n  patientId: Types.ObjectId;\n  providerId: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  \n  // Associated Records\n  appointmentId?: Types.ObjectId;\n  treatmentRecordId?: Types.ObjectId;\n  billingId?: Types.ObjectId;\n  \n  // Claim Details\n  serviceDate: Date;\n  submissionDate: Date;\n  claimType: 'primary' | 'secondary' | 'predetermination';\n  \n  // Services and Procedures\n  procedures: Array<{\n    code: string; // ADA procedure code\n    description: string;\n    tooth?: string;\n    surface?: string;\n    quantity: number;\n    unitPrice: number;\n    totalPrice: number;\n  }>;\n  \n  // Amounts\n  totalBilled: number;\n  totalAllowed: number;\n  totalPaid: number;\n  patientResponsibility: number;\n  deductibleApplied: number;\n  copayAmount: number;\n  coinsuranceAmount: number;\n  \n  // Status and Processing\n  status: 'draft' | 'submitted' | 'pending' | 'processed' | 'paid' | 'denied' | 'rejected' | 'appealed';\n  submissionMethod: 'electronic' | 'paper' | 'online_portal';\n  \n  // Response Information\n  processedDate?: Date;\n  paidDate?: Date;\n  explanationOfBenefits?: string;\n  denialReason?: string;\n  denialCode?: string;\n  \n  // Prior Authorization\n  priorAuthNumber?: string;\n  priorAuthRequired: boolean;\n  priorAuthObtained: boolean;\n  \n  // Attachments and Documentation\n  attachments?: Array<{\n    filename: string;\n    path: string;\n    description: string;\n    uploadedAt: Date;\n    uploadedBy: Types.ObjectId;\n  }>;\n  \n  // Communication\n  correspondenceLog?: Array<{\n    date: Date;\n    type: 'email' | 'phone' | 'mail' | 'portal';\n    direction: 'inbound' | 'outbound';\n    subject: string;\n    notes: string;\n    handledBy: Types.ObjectId;\n  }>;\n  \n  // Processing Details\n  clearinghouse?: string;\n  electronicClaimId?: string;\n  batchNumber?: string;\n  \n  // Appeals\n  appealHistory?: Array<{\n    appealDate: Date;\n    appealReason: string;\n    appealStatus: 'pending' | 'approved' | 'denied';\n    appealOutcome?: string;\n    appealedBy: Types.ObjectId;\n  }>;\n  \n  // Follow-up\n  followUpRequired: boolean;\n  followUpDate?: Date;\n  followUpReason?: string;\n  \n  // Audit\n  createdBy: Types.ObjectId;\n  updatedBy?: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst insuranceClaimSchema = new Schema<IInsuranceClaim>({\n  claimNumber: {\n    type: String,\n    required: [true, 'Claim number is required'],\n    unique: true,\n    trim: true,\n    maxlength: [50, 'Claim number cannot exceed 50 characters']\n  },\n  insuranceId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Insurance',\n    required: [true, 'Insurance ID is required']\n  },\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  providerId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Provider ID is required']\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  \n  // Associated Records\n  appointmentId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Appointment'\n  },\n  treatmentRecordId: {\n    type: Schema.Types.ObjectId,\n    ref: 'TreatmentRecord'\n  },\n  billingId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Billing'\n  },\n  \n  // Claim Details\n  serviceDate: {\n    type: Date,\n    required: [true, 'Service date is required']\n  },\n  submissionDate: {\n    type: Date,\n    required: [true, 'Submission date is required'],\n    default: Date.now\n  },\n  claimType: {\n    type: String,\n    required: [true, 'Claim type is required'],\n    enum: ['primary', 'secondary', 'predetermination']\n  },\n  \n  // Services and Procedures\n  procedures: [{\n    code: {\n      type: String,\n      required: [true, 'Procedure code is required'],\n      trim: true,\n      maxlength: [10, 'Procedure code cannot exceed 10 characters']\n    },\n    description: {\n      type: String,\n      required: [true, 'Procedure description is required'],\n      trim: true,\n      maxlength: [500, 'Procedure description cannot exceed 500 characters']\n    },\n    tooth: {\n      type: String,\n      trim: true,\n      maxlength: [5, 'Tooth designation cannot exceed 5 characters']\n    },\n    surface: {\n      type: String,\n      trim: true,\n      maxlength: [10, 'Surface designation cannot exceed 10 characters']\n    },\n    quantity: {\n      type: Number,\n      required: [true, 'Quantity is required'],\n      min: [1, 'Quantity must be at least 1'],\n      default: 1\n    },\n    unitPrice: {\n      type: Number,\n      required: [true, 'Unit price is required'],\n      min: [0, 'Unit price cannot be negative']\n    },\n    totalPrice: {\n      type: Number,\n      required: [true, 'Total price is required'],\n      min: [0, 'Total price cannot be negative']\n    }\n  }],\n  \n  // Amounts\n  totalBilled: {\n    type: Number,\n    required: [true, 'Total billed amount is required'],\n    min: [0, 'Total billed cannot be negative']\n  },\n  totalAllowed: {\n    type: Number,\n    min: [0, 'Total allowed cannot be negative'],\n    default: 0\n  },\n  totalPaid: {\n    type: Number,\n    min: [0, 'Total paid cannot be negative'],\n    default: 0\n  },\n  patientResponsibility: {\n    type: Number,\n    min: [0, 'Patient responsibility cannot be negative'],\n    default: 0\n  },\n  deductibleApplied: {\n    type: Number,\n    min: [0, 'Deductible applied cannot be negative'],\n    default: 0\n  },\n  copayAmount: {\n    type: Number,\n    min: [0, 'Copay amount cannot be negative'],\n    default: 0\n  },\n  coinsuranceAmount: {\n    type: Number,\n    min: [0, 'Coinsurance amount cannot be negative'],\n    default: 0\n  },\n  \n  // Status and Processing\n  status: {\n    type: String,\n    required: [true, 'Claim status is required'],\n    enum: ['draft', 'submitted', 'pending', 'processed', 'paid', 'denied', 'rejected', 'appealed'],\n    default: 'draft'\n  },\n  submissionMethod: {\n    type: String,\n    enum: ['electronic', 'paper', 'online_portal'],\n    default: 'electronic'\n  },\n  \n  // Response Information\n  processedDate: {\n    type: Date\n  },\n  paidDate: {\n    type: Date\n  },\n  explanationOfBenefits: {\n    type: String,\n    trim: true,\n    maxlength: [2000, 'Explanation of benefits cannot exceed 2000 characters']\n  },\n  denialReason: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Denial reason cannot exceed 1000 characters']\n  },\n  denialCode: {\n    type: String,\n    trim: true,\n    maxlength: [10, 'Denial code cannot exceed 10 characters']\n  },\n  \n  // Prior Authorization\n  priorAuthNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Prior authorization number cannot exceed 50 characters']\n  },\n  priorAuthRequired: {\n    type: Boolean,\n    default: false\n  },\n  priorAuthObtained: {\n    type: Boolean,\n    default: false\n  },\n  \n  // Attachments and Documentation\n  attachments: [{\n    filename: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    path: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    description: {\n      type: String,\n      trim: true,\n      maxlength: [500, 'Attachment description cannot exceed 500 characters']\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now\n    },\n    uploadedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    }\n  }],\n  \n  // Communication\n  correspondenceLog: [{\n    date: {\n      type: Date,\n      required: true,\n      default: Date.now\n    },\n    type: {\n      type: String,\n      required: true,\n      enum: ['email', 'phone', 'mail', 'portal']\n    },\n    direction: {\n      type: String,\n      required: true,\n      enum: ['inbound', 'outbound']\n    },\n    subject: {\n      type: String,\n      required: true,\n      trim: true,\n      maxlength: [200, 'Subject cannot exceed 200 characters']\n    },\n    notes: {\n      type: String,\n      required: true,\n      trim: true,\n      maxlength: [2000, 'Notes cannot exceed 2000 characters']\n    },\n    handledBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    }\n  }],\n  \n  // Processing Details\n  clearinghouse: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Clearinghouse name cannot exceed 100 characters']\n  },\n  electronicClaimId: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Electronic claim ID cannot exceed 50 characters']\n  },\n  batchNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Batch number cannot exceed 50 characters']\n  },\n  \n  // Appeals\n  appealHistory: [{\n    appealDate: {\n      type: Date,\n      required: true,\n      default: Date.now\n    },\n    appealReason: {\n      type: String,\n      required: true,\n      trim: true,\n      maxlength: [1000, 'Appeal reason cannot exceed 1000 characters']\n    },\n    appealStatus: {\n      type: String,\n      required: true,\n      enum: ['pending', 'approved', 'denied']\n    },\n    appealOutcome: {\n      type: String,\n      trim: true,\n      maxlength: [1000, 'Appeal outcome cannot exceed 1000 characters']\n    },\n    appealedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    }\n  }],\n  \n  // Follow-up\n  followUpRequired: {\n    type: Boolean,\n    default: false\n  },\n  followUpDate: {\n    type: Date\n  },\n  followUpReason: {\n    type: String,\n    trim: true,\n    maxlength: [500, 'Follow-up reason cannot exceed 500 characters']\n  },\n  \n  // Audit\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'CreatedBy is required']\n  },\n  updatedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }\n}, {\n  timestamps: true,\n  toJSON: { virtuals: true },\n  toObject: { virtuals: true }\n});\n\n// Indexes\ninsuranceClaimSchema.index({ insuranceId: 1 });\ninsuranceClaimSchema.index({ patientId: 1 });\ninsuranceClaimSchema.index({ providerId: 1 });\ninsuranceClaimSchema.index({ clinicId: 1 });\ninsuranceClaimSchema.index({ status: 1 });\ninsuranceClaimSchema.index({ serviceDate: -1 });\ninsuranceClaimSchema.index({ submissionDate: -1 });\ninsuranceClaimSchema.index({ followUpRequired: 1, followUpDate: 1 });\n\n// Pre-save middleware\ninsuranceClaimSchema.pre('save', function(next) {\n  // Auto-generate claim number if not provided\n  if (!this.claimNumber) {\n    const timestamp = Date.now().toString();\n    const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n    this.claimNumber = `CLM-${timestamp}-${random}`;\n  }\n  \n  // Calculate total billed from procedures\n  if (this.isModified('procedures')) {\n    this.totalBilled = this.procedures.reduce((sum, proc) => sum + proc.totalPrice, 0);\n  }\n  \n  // Set follow-up required for certain statuses\n  if (this.isModified('status')) {\n    if (['denied', 'rejected'].includes(this.status)) {\n      this.followUpRequired = true;\n      if (!this.followUpDate) {\n        this.followUpDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); // 7 days from now\n      }\n    }\n  }\n  \n  next();\n});\n\n// Static methods\ninsuranceClaimSchema.statics.findByPatient = function(patientId: string, options: any = {}) {\n  const { skip = 0, limit = 10, status } = options;\n  const query: any = { patientId };\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  return this.find(query)\n    .populate('insuranceId', 'insuranceCompany policyNumber')\n    .populate('providerId', 'firstName lastName')\n    .populate('clinicId', 'name')\n    .sort({ serviceDate: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\ninsuranceClaimSchema.statics.findByInsurance = function(insuranceId: string) {\n  return this.find({ insuranceId })\n    .populate('patientId', 'firstName lastName')\n    .populate('providerId', 'firstName lastName')\n    .sort({ serviceDate: -1 });\n};\n\ninsuranceClaimSchema.statics.findPendingClaims = function(clinicId?: string) {\n  const query: any = { status: { $in: ['submitted', 'pending'] } };\n  \n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('insuranceId', 'insuranceCompany')\n    .sort({ submissionDate: 1 });\n};\n\ninsuranceClaimSchema.statics.findClaimsNeedingFollowUp = function(clinicId?: string) {\n  const query: any = { \n    followUpRequired: true,\n    followUpDate: { $lte: new Date() }\n  };\n  \n  if (clinicId) {\n    query.clinicId = clinicId;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('insuranceId', 'insuranceCompany')\n    .sort({ followUpDate: 1 });\n};\n\ninsuranceClaimSchema.statics.getClaimStatistics = function(clinicId?: string, dateRange?: { start: Date; end: Date }) {\n  const matchStage: any = {};\n  \n  if (clinicId) {\n    matchStage.clinicId = new Types.ObjectId(clinicId);\n  }\n  \n  if (dateRange) {\n    matchStage.serviceDate = {\n      $gte: dateRange.start,\n      $lte: dateRange.end\n    };\n  }\n  \n  return this.aggregate([\n    { $match: matchStage },\n    {\n      $group: {\n        _id: '$status',\n        count: { $sum: 1 },\n        totalBilled: { $sum: '$totalBilled' },\n        totalPaid: { $sum: '$totalPaid' },\n        averageProcessingTime: {\n          $avg: {\n            $cond: {\n              if: { $and: ['$processedDate', '$submissionDate'] },\n              then: { $subtract: ['$processedDate', '$submissionDate'] },\n              else: null\n            }\n          }\n        }\n      }\n    }\n  ]);\n};\n\n// Instance methods\ninsuranceClaimSchema.methods.submit = function() {\n  this.status = 'submitted';\n  this.submissionDate = new Date();\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.markAsProcessed = function(processedData: {\n  totalAllowed?: number;\n  totalPaid?: number;\n  patientResponsibility?: number;\n  explanationOfBenefits?: string;\n}) {\n  this.status = 'processed';\n  this.processedDate = new Date();\n  \n  Object.assign(this, processedData);\n  \n  return this.save();\n};\n\ninsuranceClaimSchema.methods.markAsPaid = function() {\n  this.status = 'paid';\n  this.paidDate = new Date();\n  this.followUpRequired = false;\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.deny = function(reason: string, code?: string) {\n  this.status = 'denied';\n  this.denialReason = reason;\n  this.denialCode = code;\n  this.processedDate = new Date();\n  this.followUpRequired = true;\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.addAppeal = function(appealData: {\n  reason: string;\n  appealedBy: Types.ObjectId;\n}) {\n  if (!this.appealHistory) {\n    this.appealHistory = [];\n  }\n  \n  this.appealHistory.push({\n    appealDate: new Date(),\n    appealReason: appealData.reason,\n    appealStatus: 'pending',\n    appealedBy: appealData.appealedBy\n  });\n  \n  this.status = 'appealed';\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.addCorrespondence = function(correspondenceData: {\n  type: string;\n  direction: string;\n  subject: string;\n  notes: string;\n  handledBy: Types.ObjectId;\n}) {\n  if (!this.correspondenceLog) {\n    this.correspondenceLog = [];\n  }\n  \n  this.correspondenceLog.push({\n    date: new Date(),\n    ...correspondenceData\n  });\n  \n  return this.save();\n};\n\n// Instance methods\ninsuranceClaimSchema.methods.submit = function() {\n  this.status = 'submitted';\n  this.submittedDate = new Date();\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.markAsProcessed = function() {\n  this.status = 'processed';\n  this.processedDate = new Date();\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.markAsPaid = function(amount?: number) {\n  this.status = 'paid';\n  this.paidDate = new Date();\n  if (amount) {\n    this.paidAmount = amount;\n  }\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.deny = function(reason: string) {\n  this.status = 'denied';\n  this.deniedDate = new Date();\n  this.denialReason = reason;\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.addAppeal = function(appealData: any) {\n  this.status = 'under_review';\n  this.appealDate = new Date();\n  this.appealReason = appealData.reason;\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.addCorrespondence = function(correspondence: any) {\n  if (!this.correspondenceLog) {\n    this.correspondenceLog = [];\n  }\n  this.correspondenceLog.push({\n    ...correspondence,\n    date: new Date()\n  });\n  return this.save();\n};\n\n// Static methods\ninsuranceClaimSchema.statics.findByPatient = function(patientId: string, options: any = {}) {\n  const { skip = 0, limit = 10 } = options;\n  return this.find({ patientId })\n    .populate('insuranceId', 'providerName policyNumber')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\ninsuranceClaimSchema.statics.findByInsurance = function(insuranceId: string) {\n  return this.find({ insuranceId })\n    .populate('patientId', 'firstName lastName')\n    .sort({ createdAt: -1 });\n};\n\ninsuranceClaimSchema.statics.findPendingClaims = function() {\n  return this.find({ status: { $in: ['submitted', 'under_review'] } })\n    .populate('patientId', 'firstName lastName')\n    .populate('insuranceId', 'providerName')\n    .sort({ submittedDate: 1 });\n};\n\ninsuranceClaimSchema.statics.findClaimsNeedingFollowUp = function() {\n  const thirtyDaysAgo = new Date();\n  thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n  \n  return this.find({\n    status: 'submitted',\n    submittedDate: { $lte: thirtyDaysAgo }\n  })\n    .populate('patientId', 'firstName lastName')\n    .populate('insuranceId', 'providerName');\n};\n\ninsuranceClaimSchema.statics.getClaimStatistics = function(insuranceId?: string) {\n  const matchStage = insuranceId ? { insuranceId: new Types.ObjectId(insuranceId) } : {};\n  \n  return this.aggregate([\n    { $match: matchStage },\n    {\n      $group: {\n        _id: '$status',\n        count: { $sum: 1 },\n        totalAmount: { $sum: '$claimAmount' },\n        avgAmount: { $avg: '$claimAmount' }\n      }\n    }\n  ]);\n};\n\n// Instance methods\ninsuranceClaimSchema.methods.markAsProcessed = function() {\n  this.status = 'processed';\n  this.processedDate = new Date();\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.markAsPaid = function() {\n  this.status = 'paid';\n  this.paidDate = new Date();\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.deny = function(reason: string, code?: string) {\n  this.status = 'denied';\n  this.denialReason = reason;\n  this.denialCode = code;\n  return this.save();\n};\n\ninsuranceClaimSchema.methods.addAppeal = function(appealData: any) {\n  if (!this.appealHistory) this.appealHistory = [];\n  this.appealHistory.push(appealData);\n  this.status = 'appealed';\n  return this.save();\n};\n\n// Static methods\ninsuranceClaimSchema.statics.findByPatient = function(patientId: string) {\n  return this.find({ patientId });\n};\n\ninsuranceClaimSchema.statics.findByInsurance = function(insuranceId: string) {\n  return this.find({ insuranceId });\n};\n\ninsuranceClaimSchema.statics.findPendingClaims = function() {\n  return this.find({ status: { $in: ['submitted', 'pending'] } });\n};\n\ninsuranceClaimSchema.statics.findClaimsNeedingFollowUp = function() {\n  return this.find({ followUpRequired: true });\n};\n\ninsuranceClaimSchema.statics.getClaimStatistics = function() {\n  return this.aggregate([{ $group: { _id: '$status', count: { $sum: 1 } } }]);\n};\n\nconst InsuranceClaim = model<IInsuranceClaim>('InsuranceClaim', insuranceClaimSchema);\nexport default InsuranceClaim;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\InventoryItem.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3857,3860],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3857,3860],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3867,3870],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3867,3870],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5163,5166],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5163,5166],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":227,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5574,5577],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5574,5577],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":238,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5907,5910],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5907,5910],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'reason' is defined but never used. Allowed unused args must match /^_/u.","line":261,"column":90,"nodeType":null,"messageId":"unusedVar","endLine":261,"endColumn":96}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface IInventoryItem extends Document {\n  _id: Types.ObjectId;\n  name: string;\n  description?: string;\n  category: 'supplies' | 'materials' | 'equipment' | 'medications' | 'instruments' | 'other';\n  subcategory?: string;\n  sku: string; // Stock Keeping Unit\n  barcode?: string;\n  clinic: Types.ObjectId;\n  \n  // Stock Information\n  currentStock: number;\n  minimumStock: number;\n  maximumStock?: number;\n  unit: string; // pieces, ml, kg, boxes, etc.\n  \n  // Pricing\n  costPrice: number;\n  sellingPrice?: number;\n  \n  // Supplier Information\n  supplier?: Types.ObjectId;\n  supplierItemCode?: string;\n  \n  // Storage Information\n  location?: string;\n  expiryDate?: Date;\n  batchNumber?: string;\n  \n  // Tracking\n  isActive: boolean;\n  isLowStock: boolean;\n  lastRestocked?: Date;\n  lastUsed?: Date;\n  \n  // Audit\n  createdBy: Types.ObjectId;\n  updatedBy?: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst inventoryItemSchema = new Schema<IInventoryItem>({\n  name: {\n    type: String,\n    required: [true, 'Item name is required'],\n    trim: true,\n    maxlength: [100, 'Item name cannot exceed 100 characters']\n  },\n  description: {\n    type: String,\n    trim: true,\n    maxlength: [500, 'Description cannot exceed 500 characters']\n  },\n  category: {\n    type: String,\n    required: [true, 'Category is required'],\n    enum: ['supplies', 'materials', 'equipment', 'medications', 'instruments', 'other']\n  },\n  subcategory: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Subcategory cannot exceed 50 characters']\n  },\n  sku: {\n    type: String,\n    required: [true, 'SKU is required'],\n    unique: true,\n    trim: true,\n    uppercase: true,\n    maxlength: [20, 'SKU cannot exceed 20 characters']\n  },\n  barcode: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Barcode cannot exceed 50 characters']\n  },\n  clinic: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic is required']\n  },\n  \n  // Stock Information\n  currentStock: {\n    type: Number,\n    required: [true, 'Current stock is required'],\n    min: [0, 'Current stock cannot be negative'],\n    default: 0\n  },\n  minimumStock: {\n    type: Number,\n    required: [true, 'Minimum stock level is required'],\n    min: [0, 'Minimum stock cannot be negative'],\n    default: 0\n  },\n  maximumStock: {\n    type: Number,\n    min: [0, 'Maximum stock cannot be negative']\n  },\n  unit: {\n    type: String,\n    required: [true, 'Unit is required'],\n    trim: true,\n    maxlength: [20, 'Unit cannot exceed 20 characters']\n  },\n  \n  // Pricing\n  costPrice: {\n    type: Number,\n    required: [true, 'Cost price is required'],\n    min: [0, 'Cost price cannot be negative']\n  },\n  sellingPrice: {\n    type: Number,\n    min: [0, 'Selling price cannot be negative']\n  },\n  \n  // Supplier Information\n  supplier: {\n    type: Schema.Types.ObjectId,\n    ref: 'Supplier'\n  },\n  supplierItemCode: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Supplier item code cannot exceed 50 characters']\n  },\n  \n  // Storage Information\n  location: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Location cannot exceed 100 characters']\n  },\n  expiryDate: {\n    type: Date\n  },\n  batchNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Batch number cannot exceed 50 characters']\n  },\n  \n  // Tracking\n  isActive: {\n    type: Boolean,\n    default: true\n  },\n  isLowStock: {\n    type: Boolean,\n    default: false\n  },\n  lastRestocked: {\n    type: Date\n  },\n  lastUsed: {\n    type: Date\n  },\n  \n  // Audit\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Created by is required']\n  },\n  updatedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      delete ret._id;\n      delete ret.__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\ninventoryItemSchema.index({ clinic: 1, category: 1 });\ninventoryItemSchema.index({ clinic: 1, isLowStock: 1 });\ninventoryItemSchema.index({ clinic: 1, isActive: 1 });\ninventoryItemSchema.index({ barcode: 1 }, { sparse: true });\n\n// Virtual for stock status\ninventoryItemSchema.virtual('stockStatus').get(function() {\n  if (this.currentStock <= 0) return 'out_of_stock';\n  if (this.currentStock <= this.minimumStock) return 'low_stock';\n  if (this.maximumStock && this.currentStock >= this.maximumStock) return 'overstock';\n  return 'in_stock';\n});\n\n// Virtual for days until expiry\ninventoryItemSchema.virtual('daysUntilExpiry').get(function() {\n  if (!this.expiryDate) return null;\n  const today = new Date();\n  const expiry = new Date(this.expiryDate);\n  const diffTime = expiry.getTime() - today.getTime();\n  return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n});\n\n// Pre-save middleware to update low stock status\ninventoryItemSchema.pre('save', function(next) {\n  this.isLowStock = this.currentStock <= this.minimumStock;\n  next();\n});\n\n// Static method to find low stock items\ninventoryItemSchema.statics.findLowStockItems = function(clinicId?: string) {\n  const query: any = { isLowStock: true, isActive: true };\n  if (clinicId) query.clinic = clinicId;\n  return this.find(query).populate('clinic', 'name').populate('supplier', 'name');\n};\n\n// Static method to find expiring items\ninventoryItemSchema.statics.findExpiringItems = function(days: number = 30, clinicId?: string) {\n  const futureDate = new Date();\n  futureDate.setDate(futureDate.getDate() + days);\n  \n  const query: any = {\n    expiryDate: { $exists: true, $lte: futureDate },\n    isActive: true\n  };\n  if (clinicId) query.clinic = clinicId;\n  \n  return this.find(query).populate('clinic', 'name');\n};\n\n// Static method to get stock summary by category\ninventoryItemSchema.statics.getStockSummary = function(clinicId?: string) {\n  const matchStage: any = { isActive: true };\n  if (clinicId) matchStage.clinic = new Types.ObjectId(clinicId);\n  \n  return this.aggregate([\n    { $match: matchStage },\n    {\n      $group: {\n        _id: '$category',\n        totalItems: { $sum: 1 },\n        totalValue: { $sum: { $multiply: ['$currentStock', '$costPrice'] } },\n        lowStockItems: {\n          $sum: { $cond: [{ $lte: ['$currentStock', '$minimumStock'] }, 1, 0] }\n        },\n        outOfStockItems: {\n          $sum: { $cond: [{ $eq: ['$currentStock', 0] }, 1, 0] }\n        }\n      }\n    },\n    { $sort: { _id: 1 } }\n  ]);\n};\n\n// Instance method to update stock\ninventoryItemSchema.methods.updateStock = function(quantity: number, type: 'in' | 'out', reason?: string) {\n  if (type === 'in') {\n    this.currentStock += quantity;\n    this.lastRestocked = new Date();\n  } else {\n    this.currentStock = Math.max(0, this.currentStock - quantity);\n    this.lastUsed = new Date();\n  }\n  \n  this.isLowStock = this.currentStock <= this.minimumStock;\n  return this.save();\n};\n\n// Static methods\ninventoryItemSchema.statics.findLowStockItems = function(clinicId?: string) {\n  const query = clinicId ? { clinic: clinicId } : {};\n  return this.find({ ...query, isLowStock: true });\n};\n\ninventoryItemSchema.statics.findExpiringItems = function(days = 30) {\n  const expirationDate = new Date();\n  expirationDate.setDate(expirationDate.getDate() + days);\n  return this.find({\n    expirationDate: { $lte: expirationDate, $ne: null }\n  });\n};\n\ninventoryItemSchema.statics.getStockSummary = function(clinicId?: string) {\n  const match = clinicId ? { clinic: clinicId } : {};\n  return this.aggregate([\n    { $match: match },\n    {\n      $group: {\n        _id: null,\n        totalItems: { $sum: 1 },\n        lowStockItems: { $sum: { $cond: ['$isLowStock', 1, 0] } },\n        totalValue: { $sum: { $multiply: ['$currentStock', '$costPrice'] } }\n      }\n    }\n  ]);\n};\n\nexport default model<IInventoryItem>('InventoryItem', inventoryItemSchema);\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Medication.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1619,1622],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1619,1622],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1629,1632],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1629,1632],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1694,1697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1694,1697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1738,1741],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1738,1741],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { IMedication, IMedicationModel } from '../types';\n\nconst medicationSchema = new Schema<IMedication>({\n  name: {\n    type: String,\n    required: [true, 'Medication name is required'],\n    trim: true,\n    maxlength: [200, 'Medication name cannot exceed 200 characters']\n  },\n  genericName: {\n    type: String,\n    trim: true,\n    maxlength: [200, 'Generic name cannot exceed 200 characters']\n  },\n  dosage: {\n    type: String,\n    required: [true, 'Dosage is required'],\n    trim: true,\n    maxlength: [100, 'Dosage cannot exceed 100 characters']\n  },\n  frequency: {\n    type: String,\n    required: [true, 'Frequency is required'],\n    trim: true,\n    maxlength: [100, 'Frequency cannot exceed 100 characters']\n  },\n  duration: {\n    type: String,\n    required: [true, 'Duration is required'],\n    trim: true,\n    maxlength: [100, 'Duration cannot exceed 100 characters']\n  },\n  instructions: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Instructions cannot exceed 1000 characters']\n  },\n  sideEffects: [{\n    type: String,\n    trim: true,\n    maxlength: [200, 'Side effect description cannot exceed 200 characters']\n  }],\n  contraindications: [{\n    type: String,\n    trim: true,\n    maxlength: [200, 'Contraindication cannot exceed 200 characters']\n  }],\n  category: {\n    type: String,\n    enum: ['antibiotic', 'painkiller', 'anti-inflammatory', 'anesthetic', 'antiseptic', 'other'],\n    default: 'other'\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nmedicationSchema.index({ name: 1 });\nmedicationSchema.index({ genericName: 1 });\nmedicationSchema.index({ category: 1 });\nmedicationSchema.index({ isActive: 1 });\n\n// Static method to search medications\nmedicationSchema.statics.searchMedications = function(searchTerm: string) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  return this.find({\n    isActive: true,\n    $or: [\n      { name: searchRegex },\n      { genericName: searchRegex },\n      { category: searchRegex }\n    ]\n  });\n};\n\n// Static method to find by category\nmedicationSchema.statics.findByCategory = function(category: string) {\n  return this.find({ category, isActive: true });\n};\n\nconst Medication = mongoose.model<IMedication, IMedicationModel>('Medication', medicationSchema);\n\nexport default Medication;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Message.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5561,5564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5561,5564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5575,5578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5575,5578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5743,5746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5743,5746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5757,5760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5757,5760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":304,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":304,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6890,6893],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6890,6893],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":331,"column":119,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":122,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7728,7731],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7728,7731],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":334,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":334,"endColumn":17,"fix":{"range":[7810,7861],"text":"const query: any = { deletedAt: { $exists: false } };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7821,7824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7821,7824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":535,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":535,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12545,12548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12545,12548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":537,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":537,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12616,12619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12616,12619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":557,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":557,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13084,13087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13084,13087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface IMessage extends Document {\n  _id: Types.ObjectId;\n  \n  // Participants\n  senderId: Types.ObjectId;\n  recipientId: Types.ObjectId;\n  \n  // Message Content\n  subject?: string;\n  content: string;\n  messageType: 'text' | 'appointment' | 'prescription' | 'lab_result' | 'insurance' | 'billing';\n  priority: 'low' | 'normal' | 'high' | 'urgent';\n  \n  // Status\n  status: 'draft' | 'sent' | 'delivered' | 'read' | 'archived';\n  isRead: boolean;\n  readAt?: Date;\n  \n  // Thread Information\n  threadId?: Types.ObjectId; // For message threading/replies\n  isReply: boolean;\n  originalMessageId?: Types.ObjectId;\n  \n  // Attachments\n  attachments?: Array<{\n    filename: string;\n    originalName: string;\n    path: string;\n    mimeType: string;\n    size: number;\n    uploadedAt: Date;\n  }>;\n  \n  // Related Records\n  relatedRecords?: {\n    appointmentId?: Types.ObjectId;\n    patientId?: Types.ObjectId;\n    treatmentId?: Types.ObjectId;\n    prescriptionId?: Types.ObjectId;\n    billingId?: Types.ObjectId;\n  };\n  \n  // Security and Compliance\n  isEncrypted: boolean;\n  encryptionKey?: string;\n  isHipaaCompliant: boolean;\n  \n  // Scheduling (for delayed messages)\n  scheduledSendTime?: Date;\n  isScheduled: boolean;\n  \n  // Audit\n  createdAt: Date;\n  updatedAt: Date;\n  sentAt?: Date;\n  archivedAt?: Date;\n  deletedAt?: Date;\n}\n\nconst messageSchema = new Schema<IMessage>({\n  senderId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Sender ID is required']\n  },\n  recipientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Recipient ID is required']\n  },\n  \n  // Message Content\n  subject: {\n    type: String,\n    trim: true,\n    maxlength: [200, 'Subject cannot exceed 200 characters']\n  },\n  content: {\n    type: String,\n    required: [true, 'Message content is required'],\n    trim: true,\n    maxlength: [5000, 'Message content cannot exceed 5000 characters']\n  },\n  messageType: {\n    type: String,\n    enum: ['text', 'appointment', 'prescription', 'lab_result', 'insurance', 'billing'],\n    default: 'text'\n  },\n  priority: {\n    type: String,\n    enum: ['low', 'normal', 'high', 'urgent'],\n    default: 'normal'\n  },\n  \n  // Status\n  status: {\n    type: String,\n    enum: ['draft', 'sent', 'delivered', 'read', 'archived'],\n    default: 'draft'\n  },\n  isRead: {\n    type: Boolean,\n    default: false\n  },\n  readAt: {\n    type: Date\n  },\n  \n  // Thread Information\n  threadId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Message'\n  },\n  isReply: {\n    type: Boolean,\n    default: false\n  },\n  originalMessageId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Message'\n  },\n  \n  // Attachments\n  attachments: [{\n    filename: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    originalName: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    path: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    mimeType: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    size: {\n      type: Number,\n      required: true,\n      min: [0, 'File size cannot be negative']\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now\n    }\n  }],\n  \n  // Related Records\n  relatedRecords: {\n    appointmentId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Appointment'\n    },\n    patientId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Patient'\n    },\n    treatmentId: {\n      type: Schema.Types.ObjectId,\n      ref: 'TreatmentRecord'\n    },\n    prescriptionId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Prescription'\n    },\n    billingId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Billing'\n    }\n  },\n  \n  // Security and Compliance\n  isEncrypted: {\n    type: Boolean,\n    default: false\n  },\n  encryptionKey: {\n    type: String,\n    select: false // Never include in queries\n  },\n  isHipaaCompliant: {\n    type: Boolean,\n    default: true\n  },\n  \n  // Scheduling\n  scheduledSendTime: {\n    type: Date\n  },\n  isScheduled: {\n    type: Boolean,\n    default: false\n  },\n  \n  // Audit\n  sentAt: {\n    type: Date\n  },\n  archivedAt: {\n    type: Date\n  },\n  deletedAt: {\n    type: Date\n  }\n}, {\n  timestamps: true,\n  toJSON: { virtuals: true },\n  toObject: { virtuals: true }\n});\n\n// Indexes\nmessageSchema.index({ senderId: 1, recipientId: 1 });\nmessageSchema.index({ senderId: 1 });\nmessageSchema.index({ recipientId: 1 });\nmessageSchema.index({ threadId: 1 });\nmessageSchema.index({ status: 1 });\nmessageSchema.index({ isRead: 1 });\nmessageSchema.index({ messageType: 1 });\nmessageSchema.index({ priority: 1 });\nmessageSchema.index({ scheduledSendTime: 1 });\nmessageSchema.index({ createdAt: -1 });\nmessageSchema.index({ sentAt: -1 });\n\n// Compound indexes\nmessageSchema.index({ recipientId: 1, isRead: 1 });\nmessageSchema.index({ senderId: 1, recipientId: 1, createdAt: -1 });\nmessageSchema.index({ threadId: 1, createdAt: 1 });\n\n// Virtual for attachment count\nmessageSchema.virtual('attachmentCount').get(function() {\n  return this.attachments?.length || 0;\n});\n\n// Virtual for has attachments\nmessageSchema.virtual('hasAttachments').get(function() {\n  return (this.attachments?.length || 0) > 0;\n});\n\n// Instance methods\nmessageSchema.methods.send = function() {\n  this.status = 'sent';\n  this.sentAt = new Date();\n  return this.save();\n};\n\nmessageSchema.methods.markAsRead = function() {\n  this.isRead = true;\n  this.readAt = new Date();\n  return this.save();\n};\n\n// Static methods\nmessageSchema.statics.findUserMessages = function(userId: any, options: any = {}) {\n  return this.find({ $or: [{ senderId: userId }, { recipientId: userId }] }, null, options);\n};\n\nmessageSchema.statics.findConversation = function(user1Id: any, user2Id: any) {\n  return this.find({\n    $or: [\n      { senderId: user1Id, recipientId: user2Id },\n      { senderId: user2Id, recipientId: user1Id }\n    ]\n  }).sort({ createdAt: 1 });\n};\n\n// Pre-save middleware\nmessageSchema.pre('save', function(next) {\n  // Set sentAt when status changes to sent\n  if (this.isModified('status') && this.status === 'sent' && !this.sentAt) {\n    this.sentAt = new Date();\n  }\n  \n  // Set readAt when isRead changes to true\n  if (this.isModified('isRead') && this.isRead && !this.readAt) {\n    this.readAt = new Date();\n    this.status = 'read';\n  }\n  \n  // Set threadId to self._id if not a reply and no threadId exists\n  if (!this.isReply && !this.threadId && this.isNew) {\n    this.threadId = this._id;\n  }\n  \n  // If it's a reply, inherit threadId from original message if not set\n  if (this.isReply && this.originalMessageId && !this.threadId) {\n    // This would require a pre-hook to fetch the original message\n    // For now, we'll handle this in the application layer\n  }\n  \n  next();\n});\n\n// Static methods\nmessageSchema.statics.findConversation = function(userId1: string, userId2: string, options: any = {}) {\n  const { skip = 0, limit = 20 } = options;\n  \n  return this.find({\n    $or: [\n      { senderId: userId1, recipientId: userId2 },\n      { senderId: userId2, recipientId: userId1 }\n    ],\n    deletedAt: { $exists: false }\n  })\n  .populate('senderId', 'firstName lastName profileImage')\n  .populate('recipientId', 'firstName lastName profileImage')\n  .sort({ createdAt: -1 })\n  .skip(skip)\n  .limit(limit);\n};\n\nmessageSchema.statics.findThreadMessages = function(threadId: string) {\n  return this.find({ \n    threadId,\n    deletedAt: { $exists: false }\n  })\n  .populate('senderId', 'firstName lastName profileImage')\n  .populate('recipientId', 'firstName lastName profileImage')\n  .sort({ createdAt: 1 });\n};\n\nmessageSchema.statics.findUserMessages = function(userId: string, type: 'sent' | 'received' | 'all' = 'all', options: any = {}) {\n  const { skip = 0, limit = 20, status, messageType } = options;\n  \n  let query: any = { deletedAt: { $exists: false } };\n  \n  if (type === 'sent') {\n    query.senderId = userId;\n  } else if (type === 'received') {\n    query.recipientId = userId;\n  } else {\n    query.$or = [\n      { senderId: userId },\n      { recipientId: userId }\n    ];\n  }\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  if (messageType) {\n    query.messageType = messageType;\n  }\n  \n  return this.find(query)\n    .populate('senderId', 'firstName lastName profileImage')\n    .populate('recipientId', 'firstName lastName profileImage')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\nmessageSchema.statics.findUnreadMessages = function(userId: string) {\n  return this.find({\n    recipientId: userId,\n    isRead: false,\n    deletedAt: { $exists: false }\n  })\n  .populate('senderId', 'firstName lastName profileImage')\n  .sort({ createdAt: -1 });\n};\n\nmessageSchema.statics.getUnreadCount = function(userId: string) {\n  return this.countDocuments({\n    recipientId: userId,\n    isRead: false,\n    deletedAt: { $exists: false }\n  });\n};\n\nmessageSchema.statics.findScheduledMessages = function() {\n  return this.find({\n    isScheduled: true,\n    scheduledSendTime: { $lte: new Date() },\n    status: 'draft'\n  });\n};\n\nmessageSchema.statics.getConversationList = function(userId: string) {\n  return this.aggregate([\n    // Match messages involving the user\n    {\n      $match: {\n        $or: [\n          { senderId: new Types.ObjectId(userId) },\n          { recipientId: new Types.ObjectId(userId) }\n        ],\n        deletedAt: { $exists: false }\n      }\n    },\n    // Sort by creation date\n    { $sort: { createdAt: -1 } },\n    // Group by conversation partner\n    {\n      $group: {\n        _id: {\n          $cond: {\n            if: { $eq: ['$senderId', new Types.ObjectId(userId)] },\n            then: '$recipientId',\n            else: '$senderId'\n          }\n        },\n        lastMessage: { $first: '$$ROOT' },\n        unreadCount: {\n          $sum: {\n            $cond: {\n              if: {\n                $and: [\n                  { $eq: ['$recipientId', new Types.ObjectId(userId)] },\n                  { $eq: ['$isRead', false] }\n                ]\n              },\n              then: 1,\n              else: 0\n            }\n          }\n        }\n      }\n    },\n    // Lookup user details\n    {\n      $lookup: {\n        from: 'users',\n        localField: '_id',\n        foreignField: '_id',\n        as: 'conversationPartner'\n      }\n    },\n    { $unwind: '$conversationPartner' },\n    // Project final structure\n    {\n      $project: {\n        conversationPartner: {\n          _id: '$conversationPartner._id',\n          firstName: '$conversationPartner.firstName',\n          lastName: '$conversationPartner.lastName',\n          profileImage: '$conversationPartner.profileImage',\n          role: '$conversationPartner.role'\n        },\n        lastMessage: 1,\n        unreadCount: 1\n      }\n    },\n    // Sort by last message date\n    { $sort: { 'last(Message as any).createdAt': -1 } }\n  ]);\n};\n\n// Instance methods\nmessageSchema.methods.markAsRead = function() {\n  this.isRead = true;\n  this.readAt = new Date();\n  this.status = 'read';\n  return this.save();\n};\n\nmessageSchema.methods.archive = function() {\n  this.status = 'archived';\n  this.archivedAt = new Date();\n  return this.save();\n};\n\nmessageSchema.methods.softDelete = function() {\n  this.deletedAt = new Date();\n  return this.save();\n};\n\nmessageSchema.methods.send = function() {\n  if (this.isScheduled && this.scheduledSendTime && this.scheduledSendTime > new Date()) {\n    // Don't send scheduled messages before their time\n    return Promise.resolve(this);\n  }\n  \n  this.status = 'sent';\n  this.sentAt = new Date();\n  this.isScheduled = false;\n  return this.save();\n};\n\nmessageSchema.methods.addAttachment = function(attachment: {\n  filename: string;\n  originalName: string;\n  path: string;\n  mimeType: string;\n  size: number;\n}) {\n  if (!this.attachments) {\n    this.attachments = [];\n  }\n  \n  this.attachments.push({\n    ...attachment,\n    uploadedAt: new Date()\n  });\n  \n  return this.save();\n};\n\n// Instance methods\nmessageSchema.methods.send = function() {\n  this.sentAt = new Date();\n  this.messageStatus = 'sent';\n  return this.save();\n};\n\nmessageSchema.methods.markAsRead = function() {\n  this.isRead = true;\n  this.readAt = new Date();\n  return this.save();\n};\n\nmessageSchema.methods.archive = function() {\n  this.isArchived = true;\n  this.archivedAt = new Date();\n  return this.save();\n};\n\nmessageSchema.methods.softDelete = function() {\n  this.isDeleted = true;\n  this.deletedAt = new Date();\n  return this.save();\n};\n\n// Static methods\nmessageSchema.statics.findUserMessages = function(userId: string, type?: string, options: any = {}) {\n  const { skip = 0, limit = 10 } = options;\n  const query: any = {\n    $or: [\n      { senderId: userId },\n      { recipientId: userId }\n    ],\n    isDeleted: { $ne: true }\n  };\n  \n  if (type) {\n    query.messageType = type;\n  }\n  \n  return this.find(query)\n    .populate('senderId', 'firstName lastName role')\n    .populate('recipientId', 'firstName lastName role')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\nmessageSchema.statics.findConversation = function(userId1: string, userId2: string, options: any = {}) {\n  const { skip = 0, limit = 10 } = options;\n  return this.find({\n    $or: [\n      { senderId: userId1, recipientId: userId2 },\n      { senderId: userId2, recipientId: userId1 }\n    ],\n    isDeleted: { $ne: true }\n  })\n    .populate('senderId', 'firstName lastName role')\n    .populate('recipientId', 'firstName lastName role')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\nmessageSchema.statics.getConversationList = function(userId: string) {\n  return this.aggregate([\n    {\n      $match: {\n        $or: [\n          { senderId: new Types.ObjectId(userId) },\n          { recipientId: new Types.ObjectId(userId) }\n        ],\n        isDeleted: { $ne: true }\n      }\n    },\n    {\n      $sort: { createdAt: -1 }\n    },\n    {\n      $group: {\n        _id: {\n          $cond: [\n            { $eq: ['$senderId', new Types.ObjectId(userId)] },\n            '$recipientId',\n            '$senderId'\n          ]\n        },\n        lastMessage: { $first: '$$ROOT' },\n        unreadCount: {\n          $sum: {\n            $cond: [\n              {\n                $and: [\n                  { $eq: ['$recipientId', new Types.ObjectId(userId)] },\n                  { $eq: ['$isRead', false] }\n                ]\n              },\n              1,\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      $lookup: {\n        from: 'users',\n        localField: '_id',\n        foreignField: '_id',\n        as: 'otherUser'\n      }\n    },\n    {\n      $unwind: '$otherUser'\n    }\n  ]);\n};\n\nmessageSchema.statics.findThreadMessages = function(threadId: string) {\n  return this.find({ threadId, isDeleted: { $ne: true } })\n    .populate('senderId', 'firstName lastName role')\n    .populate('recipientId', 'firstName lastName role')\n    .sort({ createdAt: 1 });\n};\n\nmessageSchema.statics.findUnreadMessages = function(userId: string) {\n  return this.find({\n    recipientId: userId,\n    isRead: false,\n    isDeleted: { $ne: true }\n  })\n    .populate('senderId', 'firstName lastName role')\n    .sort({ createdAt: -1 });\n};\n\nmessageSchema.statics.getUnreadCount = function(userId: string) {\n  return this.countDocuments({\n    recipientId: userId,\n    isRead: false,\n    isDeleted: { $ne: true }\n  });\n};\n\nmessageSchema.statics.findScheduledMessages = function() {\n  return this.find({\n    messageType: 'scheduled',\n    scheduledSendTime: { $lte: new Date() },\n    messageStatus: 'scheduled'\n  })\n    .populate('senderId', 'firstName lastName')\n    .populate('recipientId', 'firstName lastName');\n};\n\nconst Message = model<IMessage>('Message', messageSchema);\nexport default Message;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Notification.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1031,1034],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1031,1034],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1041,1044],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1041,1044],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1129,1132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1129,1132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1181,1184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1181,1184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6438,6441],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6438,6441],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":211,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6455,6458],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6455,6458],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { INotification, INotificationModel } from '../types';\n\nconst notificationSchema = new Schema<INotification>({\n  userId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'User ID is required']\n  },\n  title: {\n    type: String,\n    required: [true, 'Title is required'],\n    trim: true,\n    maxlength: [100, 'Title cannot exceed 100 characters']\n  },\n  message: {\n    type: String,\n    required: [true, 'Message is required'],\n    trim: true,\n    maxlength: [500, 'Message cannot exceed 500 characters']\n  },\n  type: {\n    type: String,\n    enum: ['general', 'appointment_reminder', 'appointment_confirmation', 'appointment_cancellation', 'system'],\n    required: [true, 'Notification type is required']\n  },\n  isRead: {\n    type: Boolean,\n    default: false\n  },\n  link: {\n    type: String,\n    trim: true,\n    maxlength: [200, 'Link cannot exceed 200 characters']\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      if (ret._id) {\n        ret.id = ret._id.toString();\n        delete (ret as any)._id;\n      }\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nnotificationSchema.index({ userId: 1 });\nnotificationSchema.index({ type: 1 });\nnotificationSchema.index({ isRead: 1 });\nnotificationSchema.index({ createdAt: -1 });\nnotificationSchema.index({ userId: 1, isRead: 1, createdAt: -1 });\n\n// Virtual for time ago\nnotificationSchema.virtual('timeAgo').get(function(this: INotification) {\n  const now = new Date();\n  const diff = now.getTime() - this.createdAt.getTime();\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n  \n  if (days > 0) {\n    return `${days} day${days > 1 ? 's' : ''} ago`;\n  } else if (hours > 0) {\n    return `${hours} hour${hours > 1 ? 's' : ''} ago`;\n  } else if (minutes > 0) {\n    return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;\n  } else {\n    return 'Just now';\n  }\n});\n\n// Instance method to mark as read\nnotificationSchema.methods.markAsRead = function() {\n  this.isRead = true;\n  return this.save();\n};\n\n// Instance method to mark as unread\nnotificationSchema.methods.markAsUnread = function() {\n  this.isRead = false;\n  return this.save();\n};\n\n// Static method to find unread notifications for user\nnotificationSchema.statics.findUnreadByUser = function(userId: string) {\n  return this.find({ userId, isRead: false }).sort({ createdAt: -1 });\n};\n\n// Static method to find unread notifications with limit\nnotificationSchema.statics.findUnread = function(userId: string, limit: number = 10) {\n  return this.find({ userId, isRead: false }).sort({ createdAt: -1 }).limit(limit);\n};\n\n// Static method to find notifications by user\nnotificationSchema.statics.findByUser = function(userId: string, limit: number = 50) {\n  return this.find({ userId }).sort({ createdAt: -1 }).limit(limit);\n};\n\n// Static method to find notifications by type\nnotificationSchema.statics.findByType = function(userId: string, type: string, options: { skip?: number; limit?: number } = {}) {\n  const query = this.find({ userId, type }).sort({ createdAt: -1 });\n  if (options.skip) query.skip(options.skip);\n  if (options.limit) query.limit(options.limit);\n  return query;\n};\n\n// Static method to mark all as read for user\nnotificationSchema.statics.markAllAsReadForUser = function(userId: string) {\n  return this.updateMany({ userId, isRead: false }, { isRead: true });\n};\n\n// Static method to mark all as read (alias)\nnotificationSchema.statics.markAllAsRead = function(userId: string) {\n  return this.updateMany({ userId, isRead: false }, { isRead: true });\n};\n\n// Static method to delete old notifications\nnotificationSchema.statics.deleteOldNotifications = function(daysOld: number = 30) {\n  const cutoffDate = new Date();\n  cutoffDate.setDate(cutoffDate.getDate() - daysOld);\n  return this.deleteMany({ createdAt: { $lt: cutoffDate } });\n};\n\n// Static method to create notification\nnotificationSchema.statics.createNotification = function(data: {\n  userId: string;\n  title: string;\n  message: string;\n  type: string;\n  link?: string;\n}) {\n  return this.create(data);\n};\n\n// Static method to create appointment reminder\nnotificationSchema.statics.createAppointmentReminder = function(\n  userId: string,\n  appointmentId: string,\n  appointmentDate: Date,\n  timeSlot: string\n) {\n  const formattedDate = appointmentDate.toLocaleDateString();\n  return this.create({\n    userId,\n    title: 'Appointment Reminder',\n    message: `You have an appointment scheduled for ${formattedDate} at ${timeSlot}`,\n    type: 'reminder',\n    link: `/appointments/${appointmentId}`\n  });\n};\n\n// Static method to create appointment confirmation\nnotificationSchema.statics.createAppointmentConfirmation = function(\n  userId: string,\n  appointmentId: string,\n  appointmentDate: Date,\n  timeSlot: string\n) {\n  const formattedDate = appointmentDate.toLocaleDateString();\n  return this.create({\n    userId,\n    title: 'Appointment Confirmed',\n    message: `Your appointment for ${formattedDate} at ${timeSlot} has been confirmed`,\n    type: 'appointment',\n    link: `/appointments/${appointmentId}`\n  });\n};\n\n// Static method to create appointment cancellation\nnotificationSchema.statics.createAppointmentCancellation = function(\n  userId: string,\n  appointmentDate: Date,\n  timeSlot: string,\n  reason?: string\n) {\n  const formattedDate = appointmentDate.toLocaleDateString();\n  const message = reason \n    ? `Your appointment for ${formattedDate} at ${timeSlot} has been cancelled. Reason: ${reason}`\n    : `Your appointment for ${formattedDate} at ${timeSlot} has been cancelled`;\n    \n  return this.create({\n    userId,\n    title: 'Appointment Cancelled',\n    message,\n    type: 'appointment'\n  });\n};\n\n// Static method to get unread count\nnotificationSchema.statics.getUnreadCount = function(userId: string) {\n  return this.countDocuments({ userId, isRead: false });\n};\n\n// Static method to mark as read (alias for instance method)\nnotificationSchema.statics.markAsRead = function(notificationId: string) {\n  return this.findByIdAndUpdate(notificationId, { isRead: true }, { new: true });\n};\n\n// Static method to create schedule notification\nnotificationSchema.statics.createScheduleNotification = function(\n  userId: string,\n  type: string,\n  title: string,\n  message: string,\n  scheduleData: any,\n  channels: any\n) {\n  return this.create({\n    userId,\n    type,\n    title,\n    message,\n    data: scheduleData,\n    channels\n  });\n};\n\n// Static method to create schedule reminder\nnotificationSchema.statics.createScheduleReminder = function(\n  userId: string,\n  scheduleId: string,\n  clinicName: string,\n  date: Date,\n  startTime: string,\n  endTime: string\n) {\n  const formattedDate = date.toLocaleDateString();\n  return this.create({\n    userId,\n    title: 'Schedule Reminder',\n    message: `You have a shift at ${clinicName} on ${formattedDate} from ${startTime} to ${endTime}`,\n    type: 'schedule_reminder',\n    data: {\n      scheduleId,\n      date,\n      startTime,\n      endTime\n    },\n    link: `/schedules/${scheduleId}`\n  });\n};\n\n// Static method to create schedule change notification\nnotificationSchema.statics.createScheduleChange = function(\n  userId: string,\n  scheduleId: string,\n  clinicName: string,\n  date: Date,\n  startTime: string,\n  endTime: string,\n  changeType: string\n) {\n  const formattedDate = date.toLocaleDateString();\n  return this.create({\n    userId,\n    title: 'Schedule Updated',\n    message: `Your shift at ${clinicName} on ${formattedDate} has been ${changeType}`,\n    type: 'schedule_change',\n    data: {\n      scheduleId,\n      date,\n      startTime,\n      endTime\n    },\n    link: `/schedules/${scheduleId}`\n  });\n};\n\n// Static method to create schedule conflict notification\nnotificationSchema.statics.createScheduleConflict = function(\n  userId: string,\n  scheduleId: string,\n  conflictDetails: string\n) {\n  return this.create({\n    userId,\n    title: 'Schedule Conflict Detected',\n    message: `A scheduling conflict has been detected: ${conflictDetails}`,\n    type: 'schedule_conflict',\n    data: {\n      scheduleId\n    },\n    link: `/schedules/${scheduleId}`\n  });\n};\n\nconst Notification = mongoose.model<INotification, INotificationModel>('Notification', notificationSchema);\n\nexport default Notification;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Patient.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3464,3467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3464,3467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3474,3477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3474,3477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3539,3542],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3539,3542],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":143,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3583,3586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3583,3586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":201,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":201,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5390,5393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5390,5393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { IPatient, IPatientModel } from '../types';\n\nconst patientSchema = new Schema<IPatient>({\n  firstName: {\n    type: String,\n    required: [true, 'First name is required'],\n    trim: true,\n    maxlength: [50, 'First name cannot exceed 50 characters']\n  },\n  lastName: {\n    type: String,\n    required: [true, 'Last name is required'],\n    trim: true,\n    maxlength: [50, 'Last name cannot exceed 50 characters']\n  },\n  email: {\n    type: String,\n    required: [true, 'Email is required'],\n    unique: true,\n    lowercase: true,\n    trim: true,\n    match: [/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/, 'Please provide a valid email']\n  },\n  phone: {\n    type: String,\n    required: [true, 'Phone number is required'],\n    trim: true,\n    match: [/^[\\+]?[1-9][\\d]{0,15}$/, 'Please provide a valid phone number']\n  },\n  dateOfBirth: {\n    type: Date,\n    required: [true, 'Date of birth is required'],\n    validate: {\n      validator: function(value: Date) {\n        return value < new Date();\n      },\n      message: 'Date of birth must be in the past'\n    }\n  },\n  address: {\n    street: {\n      type: String,\n      required: false,\n      trim: true,\n      maxlength: [200, 'Street address cannot exceed 200 characters']\n    },\n    city: {\n      type: String,\n      required: false,\n      trim: true,\n      maxlength: [100, 'City cannot exceed 100 characters']\n    },\n    state: {\n      type: String,\n      required: false,\n      trim: true,\n      maxlength: [100, 'State cannot exceed 100 characters']\n    },\n    zipCode: {\n      type: String,\n      required: false,\n      trim: true,\n      maxlength: [20, 'Zip code cannot exceed 20 characters']\n    },\n    country: {\n      type: String,\n      required: false,\n      trim: true,\n      maxlength: [100, 'Country cannot exceed 100 characters']\n    }\n  },\n  medicalHistory: {\n    allergies: [{\n      type: String,\n      trim: true,\n      maxlength: [200, 'Allergy description cannot exceed 200 characters']\n    }],\n    medications: [{\n      type: String,\n      trim: true,\n      maxlength: [200, 'Medication description cannot exceed 200 characters']\n    }],\n    conditions: [{\n      type: String,\n      trim: true,\n      maxlength: [200, 'Condition description cannot exceed 200 characters']\n    }],\n    notes: {\n      type: String,\n      trim: true,\n      maxlength: [2000, 'Medical history notes cannot exceed 2000 characters']\n    }\n  },\n  treatmentRecords: [{\n    type: Schema.Types.ObjectId,\n    ref: 'TreatmentRecord'\n  }],\n  preferredClinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Preferred clinic is required']\n  },\n  userId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: false, // Optional for existing patients\n    index: true\n  },\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: false\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  },\n  emergencyContact: {\n    name: {\n      type: String,\n      trim: true,\n      maxlength: [100, 'Emergency contact name cannot exceed 100 characters']\n    },\n    phone: {\n      type: String,\n      trim: true,\n      match: [/^[\\+]?[1-9][\\d]{0,15}$/, 'Please provide a valid emergency contact phone number']\n    },\n    relationship: {\n      type: String,\n      trim: true,\n      maxlength: [50, 'Relationship cannot exceed 50 characters']\n    }\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\n// Remove: patientSchema.index({ email: 1 });\npatientSchema.index({ phone: 1 });\npatientSchema.index({ preferredClinicId: 1 });\npatientSchema.index({ isActive: 1 });\npatientSchema.index({ firstName: 1, lastName: 1 });\npatientSchema.index({ 'address.city': 1 });\npatientSchema.index({ 'address.state': 1 });\n\n// Virtual for full name\npatientSchema.virtual('fullName').get(function() {\n  return `${this.firstName} ${this.lastName}`;\n});\n\n// Virtual for age calculation\npatientSchema.virtual('age').get(function() {\n  const today = new Date();\n  const birthDate = new Date(this.dateOfBirth);\n  let age = today.getFullYear() - birthDate.getFullYear();\n  const monthDiff = today.getMonth() - birthDate.getMonth();\n  \n  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n    age--;\n  }\n  \n  return age;\n});\n\n// Instance method to get full address\npatientSchema.methods.getFullAddress = function(): string {\n  const { street, city, state, zipCode, country } = this.address;\n  return `${street}, ${city}, ${state} ${zipCode}, ${country}`;\n};\n\n// Static method to find by email\npatientSchema.statics.findByEmail = function(email: string) {\n  return this.findOne({ email: email.toLowerCase(), isActive: true });\n};\n\n// Static method to find by phone\npatientSchema.statics.findByPhone = function(phone: string) {\n  return this.findOne({ phone, isActive: true });\n};\n\n// Static method to find by clinic\npatientSchema.statics.findByClinic = function(clinicId: string) {\n  return this.find({ preferredClinicId: clinicId, isActive: true });\n};\n\n// Static method to search patients\npatientSchema.statics.searchPatients = function(searchTerm: string, clinicId?: string) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  const query: any = {\n    isActive: true,\n    $or: [\n      { firstName: searchRegex },\n      { lastName: searchRegex },\n      { email: searchRegex },\n      { phone: searchRegex }\n    ]\n  };\n  \n  if (clinicId) {\n    query.preferredClinicId = clinicId;\n  }\n  \n  return this.find(query);\n};\n\n// Pre-save middleware\npatientSchema.pre('save', function(next) {\n  // Ensure email is lowercase\n  if (this.email) {\n    this.email = this.email.toLowerCase();\n  }\n  next();\n});\n\nconst Patient = mongoose.model<IPatient, IPatientModel>('Patient', patientSchema);\n\nexport default Patient;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\PatientFile.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1404,1407],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1404,1407],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1478,1481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1478,1481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4619,4622],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4619,4622],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4629,4632],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4629,4632],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":250,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6102,6105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6102,6105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":254,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":254,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6207,6210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6207,6210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6874,6877],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6874,6877],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":285,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":285,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6980,6983],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6980,6983],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":313,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":313,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7630,7633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7630,7633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":382,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":382,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9108,9111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9108,9111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IPatientFile extends Document {\n  patientId: mongoose.Types.ObjectId;\n  clinicId: mongoose.Types.ObjectId;\n  uploadedBy: mongoose.Types.ObjectId;\n  appointmentId?: mongoose.Types.ObjectId;\n  fileType: 'x-ray' | 'scan' | 'note' | 'lab-result' | 'consent-form' | 'other';\n  fileName: string;\n  originalFileName: string;\n  fileUrl: string;\n  fileSize: number; // in bytes\n  mimeType: string;\n  title: string;\n  description?: string;\n  category?: string;\n  tags: string[];\n  uploadDate: Date;\n  captureDate?: Date; // Date when the image/scan was taken\n  metadata: {\n    width?: number;\n    height?: number;\n    resolution?: string;\n    device?: string;\n    technician?: string;\n    notes?: string;\n  };\n  isEncrypted: boolean;\n  encryptionKey?: string;\n  accessLog: Array<{\n    userId: mongoose.Types.ObjectId;\n    accessDate: Date;\n    action: 'view' | 'download' | 'share';\n    ipAddress?: string;\n  }>;\n  sharedWith: Array<{\n    userId: mongoose.Types.ObjectId;\n    sharedAt: Date;\n    expiresAt?: Date;\n    permissions: ('view' | 'download')[];\n  }>;\n  isDeleted: boolean;\n  deletedAt?: Date;\n  deletedBy?: mongoose.Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Custom statics-only typing to avoid tight coupling to Mongoose generics\nexport interface IPatientFileModel {\n  findByPatient(patientId: string, options?: any): Promise<IPatientFile[]>;\n  findByClinic(clinicId: string, options?: any): Promise<IPatientFile[]>;\n  findByType(fileType: string, patientId?: string): Promise<IPatientFile[]>;\n  logAccess(fileId: string, userId: string, action: string, ipAddress?: string): Promise<void>;\n}\n\nconst patientFileSchema = new Schema<IPatientFile>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required'],\n    index: true\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required'],\n    index: true\n  },\n  uploadedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Uploader ID is required']\n  },\n  appointmentId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Appointment'\n  },\n  fileType: {\n    type: String,\n    enum: ['x-ray', 'scan', 'note', 'lab-result', 'consent-form', 'other'],\n    required: [true, 'File type is required'],\n    index: true\n  },\n  fileName: {\n    type: String,\n    required: [true, 'File name is required'],\n    trim: true\n  },\n  originalFileName: {\n    type: String,\n    required: [true, 'Original file name is required'],\n    trim: true\n  },\n  fileUrl: {\n    type: String,\n    required: [true, 'File URL is required']\n  },\n  fileSize: {\n    type: Number,\n    required: [true, 'File size is required'],\n    min: 0\n  },\n  mimeType: {\n    type: String,\n    required: [true, 'MIME type is required']\n  },\n  title: {\n    type: String,\n    required: [true, 'Title is required'],\n    trim: true,\n    maxlength: [200, 'Title cannot exceed 200 characters']\n  },\n  description: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Description cannot exceed 1000 characters']\n  },\n  category: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Category cannot exceed 100 characters']\n  },\n  tags: [{\n    type: String,\n    trim: true,\n    lowercase: true\n  }],\n  uploadDate: {\n    type: Date,\n    default: Date.now,\n    required: true\n  },\n  captureDate: {\n    type: Date\n  },\n  metadata: {\n    width: Number,\n    height: Number,\n    resolution: String,\n    device: String,\n    technician: String,\n    notes: String\n  },\n  isEncrypted: {\n    type: Boolean,\n    default: true\n  },\n  encryptionKey: {\n    type: String,\n    select: false // Don't return this by default\n  },\n  accessLog: [{\n    userId: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    },\n    accessDate: {\n      type: Date,\n      default: Date.now,\n      required: true\n    },\n    action: {\n      type: String,\n      enum: ['view', 'download', 'share'],\n      required: true\n    },\n    ipAddress: String\n  }],\n  sharedWith: [{\n    userId: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    },\n    sharedAt: {\n      type: Date,\n      default: Date.now,\n      required: true\n    },\n    expiresAt: Date,\n    permissions: [{\n      type: String,\n      enum: ['view', 'download']\n    }]\n  }],\n  isDeleted: {\n    type: Boolean,\n    default: false,\n    index: true\n  },\n  deletedAt: Date,\n  deletedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete ret._id;\n      if (ret.__v) delete ret.__v;\n      if (ret.encryptionKey) delete ret.encryptionKey; // Never expose encryption key\n      return ret;\n    }\n  }\n});\n\n// Compound indexes for efficient queries\npatientFileSchema.index({ patientId: 1, uploadDate: -1 });\npatientFileSchema.index({ clinicId: 1, fileType: 1 });\npatientFileSchema.index({ patientId: 1, fileType: 1, isDeleted: 1 });\npatientFileSchema.index({ uploadedBy: 1, uploadDate: -1 });\npatientFileSchema.index({ tags: 1 });\npatientFileSchema.index({ captureDate: -1 });\n\n// Text index for search\npatientFileSchema.index({ \n  title: 'text', \n  description: 'text', \n  originalFileName: 'text',\n  tags: 'text'\n});\n\n// Virtual for file size in readable format\npatientFileSchema.virtual('fileSizeFormatted').get(function() {\n  const bytes = this.fileSize;\n  if (bytes === 0) return '0 Bytes';\n  \n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  \n  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n});\n\n// Virtual for checking if file is expired (for shared files)\npatientFileSchema.virtual('isAccessExpired').get(function() {\n  return this.sharedWith.some(share => \n    share.expiresAt && share.expiresAt < new Date()\n  );\n});\n\n// Static method to find files by patient\npatientFileSchema.statics.findByPatient = async function(\n  patientId: string, \n  options: any = {}\n) {\n  const { fileType, startDate, endDate, limit = 50, skip = 0 } = options;\n  \n  const query: any = { \n    patientId,\n    isDeleted: false\n  };\n  \n  if (fileType) {\n    query.fileType = fileType;\n  }\n  \n  if (startDate || endDate) {\n    query.uploadDate = {};\n    if (startDate) query.uploadDate.$gte = new Date(startDate);\n    if (endDate) query.uploadDate.$lte = new Date(endDate);\n  }\n  \n  return this.find(query)\n    .populate('uploadedBy', 'firstName lastName email')\n    .populate('clinicId', 'name address')\n    .populate('appointmentId', 'date timeSlot')\n    .sort({ uploadDate: -1 })\n    .limit(limit)\n    .skip(skip);\n};\n\n// Static method to find files by clinic\npatientFileSchema.statics.findByClinic = async function(\n  clinicId: string,\n  options: any = {}\n) {\n  const { fileType, startDate, endDate, limit = 100, skip = 0 } = options;\n  \n  const query: any = { \n    clinicId,\n    isDeleted: false\n  };\n  \n  if (fileType) {\n    query.fileType = fileType;\n  }\n  \n  if (startDate || endDate) {\n    query.uploadDate = {};\n    if (startDate) query.uploadDate.$gte = new Date(startDate);\n    if (endDate) query.uploadDate.$lte = new Date(endDate);\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName email')\n    .populate('uploadedBy', 'firstName lastName')\n    .sort({ uploadDate: -1 })\n    .limit(limit)\n    .skip(skip);\n};\n\n// Static method to find files by type\npatientFileSchema.statics.findByType = async function(\n  fileType: string,\n  patientId?: string\n) {\n  const query: any = {\n    fileType,\n    isDeleted: false\n  };\n  \n  if (patientId) {\n    query.patientId = patientId;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('uploadedBy', 'firstName lastName')\n    .sort({ uploadDate: -1 });\n};\n\n// Static method to log file access\npatientFileSchema.statics.logAccess = async function(\n  fileId: string,\n  userId: string,\n  action: 'view' | 'download' | 'share',\n  ipAddress?: string\n) {\n  return this.findByIdAndUpdate(\n    fileId,\n    {\n      $push: {\n        accessLog: {\n          userId,\n          accessDate: new Date(),\n          action,\n          ipAddress\n        }\n      }\n    },\n    { new: true }\n  );\n};\n\n// Instance method to soft delete\npatientFileSchema.methods.softDelete = function(userId: mongoose.Types.ObjectId) {\n  this.isDeleted = true;\n  this.deletedAt = new Date();\n  this.deletedBy = userId;\n  return this.save();\n};\n\n// Instance method to share with user\npatientFileSchema.methods.shareWith = function(\n  userId: mongoose.Types.ObjectId,\n  permissions: ('view' | 'download')[],\n  expiresAt?: Date\n) {\n  this.sharedWith.push({\n    userId,\n    sharedAt: new Date(),\n    expiresAt,\n    permissions\n  });\n  return this.save();\n};\n\n// Pre-save middleware to set defaults\npatientFileSchema.pre('save', function(next) {\n  if (this.isNew && !this.uploadDate) {\n    this.uploadDate = new Date();\n  }\n  next();\n});\n\nconst PatientFile = mongoose.model('PatientFile', patientFileSchema) as any;\n\nexport default PatientFile;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\PatientReport.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":77,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1882,1885],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1882,1885],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":77,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1892,1895],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1892,1895],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1957,1960],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1957,1960],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2001,2004],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2001,2004],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2780,2783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2780,2783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3112,3115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3112,3115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4206,4209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4206,4209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { IPatientReport, IPatientReportModel } from '../types';\n\nconst patientReportSchema = new Schema<IPatientReport>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  dentistId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Dentist ID is required']\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  title: {\n    type: String,\n    required: [true, 'Report title is required'],\n    trim: true,\n    maxlength: [200, 'Report title cannot exceed 200 characters']\n  },\n  description: {\n    type: String,\n    required: [true, 'Report description is required'],\n    trim: true,\n    maxlength: [2000, 'Report description cannot exceed 2000 characters']\n  },\n  date: {\n    type: Date,\n    required: [true, 'Report date is required'],\n    validate: {\n      validator: function(value: Date) {\n        return value <= new Date();\n      },\n      message: 'Report date cannot be in the future'\n    }\n  },\n  attachments: [{\n    id: {\n      type: String,\n      required: true\n    },\n    fileName: {\n      type: String,\n      required: [true, 'File name is required'],\n      trim: true,\n      maxlength: [255, 'File name cannot exceed 255 characters']\n    },\n    fileType: {\n      type: String,\n      required: [true, 'File type is required'],\n      enum: ['image/jpeg', 'image/png', 'image/gif', 'application/pdf', 'text/plain'],\n      trim: true\n    },\n    fileUrl: {\n      type: String,\n      required: [true, 'File URL is required'],\n      trim: true\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now\n    }\n  }],\n  isShared: {\n    type: Boolean,\n    default: false\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\npatientReportSchema.index({ patientId: 1 });\npatientReportSchema.index({ dentistId: 1 });\npatientReportSchema.index({ clinicId: 1 });\npatientReportSchema.index({ date: 1 });\npatientReportSchema.index({ title: 1 });\npatientReportSchema.index({ createdAt: 1 });\n\n// Compound indexes for common queries\npatientReportSchema.index({ patientId: 1, date: -1 });\npatientReportSchema.index({ dentistId: 1, date: -1 });\npatientReportSchema.index({ clinicId: 1, date: -1 });\n\n// Virtual for attachment count\npatientReportSchema.virtual('attachmentCount').get(function() {\n  return this.attachments ? this.attachments.length : 0;\n});\n\n// Instance method to add attachment\npatientReportSchema.methods.addAttachment = function(attachment: any) {\n  this.attachments.push({\n    id: new mongoose.Types.ObjectId().toString(),\n    ...attachment,\n    uploadedAt: new Date()\n  });\n  return this.save();\n};\n\n// Instance method to remove attachment\npatientReportSchema.methods.removeAttachment = function(attachmentId: string) {\n  this.attachments = this.attachments.filter((att: any) => att.id !== attachmentId);\n  return this.save();\n};\n\n// Static method to find by patient\npatientReportSchema.statics.findByPatient = function(patientId: string) {\n  return this.find({ patientId }).sort({ date: -1 });\n};\n\n// Static method to find by dentist\npatientReportSchema.statics.findByDentist = function(dentistId: string) {\n  return this.find({ dentistId }).sort({ date: -1 });\n};\n\n// Static method to find by clinic\npatientReportSchema.statics.findByClinic = function(clinicId: string) {\n  return this.find({ clinicId }).sort({ date: -1 });\n};\n\n// Static method to find by date range\npatientReportSchema.statics.findByDateRange = function(startDate: Date, endDate: Date) {\n  return this.find({\n    date: {\n      $gte: startDate,\n      $lte: endDate\n    }\n  }).sort({ date: -1 });\n};\n\n// Static method to search reports\npatientReportSchema.statics.searchReports = function(searchTerm: string, options: {\n  patientId?: string;\n  dentistId?: string;\n  clinicId?: string;\n  skip?: number;\n  limit?: number;\n} = {}) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  const query: any = {\n    $or: [\n      { title: searchRegex },\n      { description: searchRegex }\n    ]\n  };\n  \n  if (options.patientId) {\n    query.patientId = options.patientId;\n  }\n  \n  if (options.dentistId) {\n    query.dentistId = options.dentistId;\n  }\n  \n  if (options.clinicId) {\n    query.clinicId = options.clinicId;\n  }\n  \n  const queryBuilder = this.find(query)\n    .populate('patientId', 'firstName lastName email')\n    .populate('dentistId', 'firstName lastName specialization')\n    .populate('clinicId', 'name address')\n    .sort({ date: -1 });\n    \n  if (options.skip) {\n    queryBuilder.skip(options.skip);\n  }\n  \n  if (options.limit) {\n    queryBuilder.limit(options.limit);\n  }\n  \n  return queryBuilder;\n};\n\nconst PatientReport = mongoose.model<IPatientReport, IPatientReportModel>('PatientReport', patientReportSchema);\n\nexport default PatientReport;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Payment.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":21,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[674,677],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[674,677],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5430,5433],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5430,5433],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":250,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5679,5682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5679,5682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":283,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6699,6702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6699,6702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":309,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":309,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7421,7424],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7421,7424],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":319,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7742,7745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7742,7745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":321,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":321,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7821,7824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7821,7824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":383,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":383,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9279,9282],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9279,9282],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":394,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":394,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9548,9551],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9548,9551],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface IPayment extends Document {\n  _id: Types.ObjectId;\n  billingId: Types.ObjectId;\n  patientId: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  \n  // Payment Details\n  amount: number;\n  currency: string;\n  paymentMethod: 'card' | 'cash' | 'check' | 'bank_transfer' | 'insurance';\n  \n  // Payment Status\n  status: 'pending' | 'processing' | 'completed' | 'failed' | 'cancelled' | 'refunded' | 'partially_refunded';\n  \n  // Payment Gateway Integration\n  paymentProvider?: 'stripe' | 'paypal' | 'square' | 'manual';\n  paymentIntentId?: string;\n  transactionId?: string;\n  gatewayResponse?: Record<string, any>;\n  \n  // Card Details (for card payments)\n  cardDetails?: {\n    last4?: string;\n    brand?: string;\n    expiryMonth?: number;\n    expiryYear?: number;\n    fingerprint?: string;\n  };\n  \n  // Refund Information\n  refunds?: Array<{\n    amount: number;\n    reason: string;\n    refundId: string;\n    refundedAt: Date;\n    refundedBy: Types.ObjectId;\n  }>;\n  \n  // Payment Metadata\n  description?: string;\n  receiptUrl?: string;\n  receiptEmail?: string;\n  \n  // Processing Fees\n  processingFee?: number;\n  netAmount?: number;\n  \n  // Timestamps\n  paidAt?: Date;\n  failedAt?: Date;\n  \n  // Audit\n  createdBy: Types.ObjectId;\n  updatedBy?: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst paymentSchema = new Schema<IPayment>({\n  billingId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Billing',\n    required: [true, 'Billing ID is required']\n  },\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  \n  amount: {\n    type: Number,\n    required: [true, 'Payment amount is required'],\n    min: [0, 'Payment amount cannot be negative']\n  },\n  currency: {\n    type: String,\n    required: [true, 'Currency is required'],\n    default: 'USD',\n    uppercase: true,\n    maxlength: [3, 'Currency code must be 3 characters']\n  },\n  paymentMethod: {\n    type: String,\n    required: [true, 'Payment method is required'],\n    enum: ['card', 'cash', 'check', 'bank_transfer', 'insurance']\n  },\n  \n  status: {\n    type: String,\n    required: [true, 'Payment status is required'],\n    enum: ['pending', 'processing', 'completed', 'failed', 'cancelled', 'refunded', 'partially_refunded'],\n    default: 'pending'\n  },\n  \n  // Payment Gateway Integration\n  paymentProvider: {\n    type: String,\n    enum: ['stripe', 'paypal', 'square', 'manual']\n  },\n  paymentIntentId: {\n    type: String,\n    trim: true\n  },\n  transactionId: {\n    type: String,\n    trim: true,\n    unique: true,\n    sparse: true\n  },\n  gatewayResponse: {\n    type: Schema.Types.Mixed\n  },\n  \n  // Card Details\n  cardDetails: {\n    last4: {\n      type: String,\n      maxlength: [4, 'Last 4 digits must be 4 characters']\n    },\n    brand: {\n      type: String,\n      trim: true\n    },\n    expiryMonth: {\n      type: Number,\n      min: [1, 'Expiry month must be between 1 and 12'],\n      max: [12, 'Expiry month must be between 1 and 12']\n    },\n    expiryYear: {\n      type: Number,\n      min: [2024, 'Expiry year cannot be in the past']\n    },\n    fingerprint: {\n      type: String,\n      trim: true\n    }\n  },\n  \n  // Refund Information\n  refunds: [{\n    amount: {\n      type: Number,\n      required: true,\n      min: [0, 'Refund amount cannot be negative']\n    },\n    reason: {\n      type: String,\n      required: true,\n      trim: true,\n      maxlength: [500, 'Refund reason cannot exceed 500 characters']\n    },\n    refundId: {\n      type: String,\n      required: true,\n      trim: true\n    },\n    refundedAt: {\n      type: Date,\n      required: true,\n      default: Date.now\n    },\n    refundedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true\n    }\n  }],\n  \n  // Payment Metadata\n  description: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Description cannot exceed 1000 characters']\n  },\n  receiptUrl: {\n    type: String,\n    trim: true\n  },\n  receiptEmail: {\n    type: String,\n    trim: true,\n    lowercase: true\n  },\n  \n  // Processing Fees\n  processingFee: {\n    type: Number,\n    min: [0, 'Processing fee cannot be negative'],\n    default: 0\n  },\n  netAmount: {\n    type: Number,\n    min: [0, 'Net amount cannot be negative']\n  },\n  \n  // Timestamps\n  paidAt: {\n    type: Date\n  },\n  failedAt: {\n    type: Date\n  },\n  \n  // Audit\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'CreatedBy is required']\n  },\n  updatedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }\n}, {\n  timestamps: true,\n  toJSON: { virtuals: true },\n  toObject: { virtuals: true }\n});\n\n// Indexes\npaymentSchema.index({ billingId: 1 });\npaymentSchema.index({ patientId: 1 });\npaymentSchema.index({ clinicId: 1 });\npaymentSchema.index({ status: 1 });\npaymentSchema.index({ paymentProvider: 1 });\npaymentSchema.index({ createdAt: -1 });\n\n// Virtual for total refunded amount\npaymentSchema.virtual('totalRefundedAmount').get(function() {\n  return this.refunds?.reduce((total, refund) => total + refund.amount, 0) || 0;\n});\n\n// Virtual for remaining refundable amount\npaymentSchema.virtual('refundableAmount').get(function() {\n  if (this.status !== 'completed') return 0;\n  const totalRefunded = this.refunds?.reduce((total: number, refund: any) => total + refund.amount, 0) || 0;\n  return Math.max(0, this.amount - totalRefunded);\n});\n\n// Virtual for refund status\npaymentSchema.virtual('refundStatus').get(function() {\n  const totalRefunded = this.refunds?.reduce((total: number, refund: any) => total + refund.amount, 0) || 0;\n  if (totalRefunded === 0) return 'none';\n  if (totalRefunded >= this.amount) return 'full';\n  return 'partial';\n});\n\n// Pre-save middleware\npaymentSchema.pre('save', function(next) {\n  // Calculate net amount if not provided\n  if (this.isModified('amount') || this.isModified('processingFee')) {\n    this.netAmount = this.amount - (this.processingFee || 0);\n  }\n  \n  // Set timestamps based on status\n  if (this.isModified('status')) {\n    if (this.status === 'completed' && !this.paidAt) {\n      this.paidAt = new Date();\n    } else if (this.status === 'failed' && !this.failedAt) {\n      this.failedAt = new Date();\n    }\n  }\n  \n  next();\n});\n\n// Static methods\npaymentSchema.statics.findByBilling = function(billingId: string) {\n  return this.find({ billingId })\n    .populate('patientId', 'firstName lastName email')\n    .populate('createdBy', 'firstName lastName')\n    .sort({ createdAt: -1 });\n};\n\npaymentSchema.statics.findByPatient = function(patientId: string, options: any = {}) {\n  const { skip = 0, limit = 10 } = options;\n  return this.find({ patientId })\n    .populate('billingId', 'invoiceNumber totalAmount')\n    .populate('clinicId', 'name')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\npaymentSchema.statics.getPaymentStats = function(clinicId?: string) {\n  const matchStage = clinicId ? { $match: { clinicId: new Types.ObjectId(clinicId) } } : { $match: {} };\n  \n  return this.aggregate([\n    matchStage,\n    {\n      $group: {\n        _id: '$status',\n        count: { $sum: 1 },\n        totalAmount: { $sum: '$amount' },\n        avgAmount: { $avg: '$amount' }\n      }\n    }\n  ]);\n};\n\npaymentSchema.statics.findByPatient = function(patientId: string, options: any = {}) {\n  const { skip = 0, limit = 10 } = options;\n  return this.find({ patientId })\n    .populate('billingId', 'invoiceNumber totalAmount')\n    .populate('clinicId', 'name')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\npaymentSchema.statics.findByClinic = function(clinicId: string, options: any = {}) {\n  const { skip = 0, limit = 10, status } = options;\n  const query: any = { clinicId };\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('billingId', 'invoiceNumber totalAmount')\n    .sort({ createdAt: -1 })\n    .skip(skip)\n    .limit(limit);\n};\n\npaymentSchema.statics.getPaymentStats = function(clinicId?: string) {\n  const matchStage = clinicId ? { $match: { clinicId: new Types.ObjectId(clinicId) } } : { $match: {} };\n  \n  return this.aggregate([\n    matchStage,\n    {\n      $group: {\n        _id: '$status',\n        count: { $sum: 1 },\n        totalAmount: { $sum: '$amount' },\n        avgAmount: { $avg: '$amount' }\n      }\n    }\n  ]);\n};\n\n// Instance methods\npaymentSchema.methods.markAsCompleted = function() {\n  this.status = 'completed';\n  this.paidAt = new Date();\n  return this.save();\n};\n\npaymentSchema.methods.markAsFailed = function(reason?: string) {\n  this.status = 'failed';\n  this.failedAt = new Date();\n  if (reason && this.gatewayResponse) {\n    this.gatewayResponse.failureReason = reason;\n  }\n  return this.save();\n};\n\npaymentSchema.methods.addRefund = function(refundData: {\n  amount: number;\n  reason: string;\n  refundId: string;\n  refundedBy: Types.ObjectId;\n}) {\n  if (!this.refunds) {\n    this.refunds = [];\n  }\n  \n  this.refunds.push({\n    ...refundData,\n    refundedAt: new Date()\n  });\n  \n  // Update status based on refund amount\n  const currentRefunded = this.refunds?.reduce((total: number, refund: any) => total + refund.amount, 0) || 0;\n  if (currentRefunded >= this.amount) {\n    this.status = 'refunded';\n  } else {\n    this.status = 'partially_refunded';\n  }\n  \n  return this.save();\n};\n\n// Instance methods\npaymentSchema.methods.addRefund = function(refundData: any) {\n  if (!this.refunds) this.refunds = [];\n  this.refunds.push(refundData);\n  return this.save();\n};\n\n// Static methods  \npaymentSchema.statics.findByBilling = function(billingId: string) {\n  return this.find({ billingId });\n};\n\npaymentSchema.statics.findByPatient = function(patientId: string) {\n  return this.find({ patientId });\n};\n\npaymentSchema.statics.getPaymentStats = function() {\n  return this.aggregate([{ $group: { _id: '$status', count: { $sum: 1 } } }]);\n};\n\nconst Payment = model<IPayment>('Payment', paymentSchema);\nexport default Payment;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Prescription.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1996,1999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1996,1999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2006,2009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2006,2009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2071,2074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2071,2074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2115,2118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2115,2118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2235,2238],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2235,2238],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2288,2291],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2288,2291],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2355,2358],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2355,2358],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2408,2411],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2408,2411],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2474,2477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2474,2477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2525,2528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2525,2528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2595,2598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2595,2598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2723,2726],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2723,2726],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2780,2783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2780,2783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":122,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2872,2875],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2872,2875],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3069,3072],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3069,3072],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3146,3149],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3146,3149],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3286,3289],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3286,3289],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4963,4966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4963,4966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5042,5045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5042,5045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5587,5590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5587,5590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { IPrescription, IPrescriptionModel } from '../types';\n\nconst prescriptionSchema = new Schema<IPrescription>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  dentistId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Dentist ID is required']\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  appointmentId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Appointment'\n  },\n  medications: [{\n    medicationId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Medication',\n      required: true\n    },\n    dosage: {\n      type: String,\n      required: [true, 'Dosage is required'],\n      trim: true\n    },\n    frequency: {\n      type: String,\n      required: [true, 'Frequency is required'],\n      trim: true\n    },\n    duration: {\n      type: String,\n      required: [true, 'Duration is required'],\n      trim: true\n    },\n    instructions: {\n      type: String,\n      trim: true,\n      maxlength: [500, 'Instructions cannot exceed 500 characters']\n    },\n    startDate: {\n      type: Date,\n      default: Date.now\n    },\n    endDate: {\n      type: Date\n    }\n  }],\n  diagnosis: {\n    type: String,\n    required: [true, 'Diagnosis is required'],\n    trim: true,\n    maxlength: [500, 'Diagnosis cannot exceed 500 characters']\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Notes cannot exceed 1000 characters']\n  },\n  status: {\n    type: String,\n    enum: ['active', 'completed', 'cancelled', 'expired'],\n    default: 'active'\n  },\n  issuedDate: {\n    type: Date,\n    default: Date.now\n  },\n  expiryDate: {\n    type: Date\n  },\n  refillsAllowed: {\n    type: Number,\n    default: 0,\n    min: 0\n  },\n  refillsUsed: {\n    type: Number,\n    default: 0,\n    min: 0\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      \n      // Map backend field names to frontend expected names\n      if (ret.patientId) {\n        (ret as any).patient = ret.patientId;\n        delete (ret as any).patientId;\n      }\n      if (ret.dentistId) {\n        (ret as any).dentist = ret.dentistId;\n        delete (ret as any).dentistId;\n      }\n      if (ret.clinicId) {\n        (ret as any).clinic = ret.clinicId;\n        delete (ret as any).clinicId;\n      }\n      if (ret.appointmentId) {\n        (ret as any).appointment = ret.appointmentId;\n        delete ret.appointmentId;\n      }\n      \n      // Map refill fields\n      (ret as any).maxRefills = ret.refillsAllowed || 0;\n      (ret as any).refills = [];\n      for (let i = 0; i < (ret.refillsUsed || 0); i++) {\n        (ret as any).refills.push({\n          date: ret.updatedAt,\n          refillNumber: i + 1,\n          notes: 'Refill dispensed'\n        });\n      }\n      if (ret.refillsAllowed !== undefined) delete (ret as any).refillsAllowed;\n      if (ret.refillsUsed !== undefined) delete (ret as any).refillsUsed;\n      \n      // Map medication structure\n      if (ret.medications) {\n        ret.medications = ret.medications.map((med: any) => ({\n          medicationId: med.medicationId,\n          medication: med.medicationId,\n          dosage: med.dosage,\n          frequency: med.frequency,\n          duration: med.duration,\n          instructions: med.instructions,\n          startDate: med.startDate,\n          endDate: med.endDate,\n// Remove duplicate medication property since it's already defined above\n// Removed duplicate dosage property since it's already defined above\n// frequency is already defined above, removing duplicate property\n// duration is already defined above, removing duplicate property\n// instructions is already defined above, removing duplicate property\n        }));\n      }\n      \n      return ret;\n    }\n  }\n});\n\n// Indexes\nprescriptionSchema.index({ patientId: 1 });\nprescriptionSchema.index({ dentistId: 1 });\nprescriptionSchema.index({ clinicId: 1 });\nprescriptionSchema.index({ status: 1 });\nprescriptionSchema.index({ issuedDate: -1 });\nprescriptionSchema.index({ expiryDate: 1 });\n\n// Virtual for checking if prescription is expired\nprescriptionSchema.virtual('isExpired').get(function() {\n  return this.expiryDate && this.expiryDate < new Date();\n});\n\n// Virtual for checking if refills are available\nprescriptionSchema.virtual('hasRefillsAvailable').get(function() {\n  return this.refillsUsed < this.refillsAllowed;\n});\n\n// Instance method to add refill\nprescriptionSchema.methods.addRefill = function() {\n  if (this.refillsUsed < this.refillsAllowed) {\n    this.refillsUsed += 1;\n    return this.save();\n  }\n  throw new Error('No refills available');\n};\n\n// Static method to find by patient\nprescriptionSchema.statics.findByPatient = function(patientId: string, options: any = {}) {\n  const { status, limit = 10, skip = 0 } = options;\n  const query: any = { patientId };\n  \n  if (status) {\n    query.status = status;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName email phone')\n    .populate('dentistId', 'firstName lastName specialization')\n    .populate('clinicId', 'name address phone')\n    .populate('medications.medicationId', 'name genericName category')\n    .sort({ issuedDate: -1 })\n    .limit(limit)\n    .skip(skip);\n};\n\n// Static method to find active prescriptions\nprescriptionSchema.statics.findActive = function(patientId?: string) {\n  const query: any = { \n    status: 'active',\n    $or: [\n      { expiryDate: { $gte: new Date() } },\n      { expiryDate: { $exists: false } }\n    ]\n  };\n  \n  if (patientId) {\n    query.patientId = patientId;\n  }\n  \n  return this.find(query)\n    .populate('patientId', 'firstName lastName')\n    .populate('dentistId', 'firstName lastName')\n    .populate('medications.medicationId');\n};\n\n// Static method to find expiring prescriptions\nprescriptionSchema.statics.findExpiring = function(days: number = 7) {\n  const futureDate = new Date();\n  futureDate.setDate(futureDate.getDate() + days);\n  \n  return this.find({\n    status: 'active',\n    expiryDate: {\n      $gte: new Date(),\n      $lte: futureDate\n    }\n  })\n  .populate('patientId', 'firstName lastName email')\n  .populate('dentistId', 'firstName lastName');\n};\n\nconst Prescription = mongoose.model<IPrescription, IPrescriptionModel>('Prescription', prescriptionSchema);\n\nexport default Prescription;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\StaffSchedule.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Document' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":184,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":184,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4751,4754],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4751,4754],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema, Document } from 'mongoose';\nimport { IStaffSchedule, IStaffScheduleModel } from '../types';\n\n// Remove local interface since it's now in types\n/*\nexport interface IStaffSchedule extends Document {\n  staffId: mongoose.Types.ObjectId;\n  clinicId: mongoose.Types.ObjectId;\n  date: Date;\n  startTime: string;\n  endTime: string;\n  shiftType: 'morning' | 'afternoon' | 'evening' | 'night' | 'full-day';\n  status: 'scheduled' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  isRecurring: boolean;\n  recurringPattern?: {\n    frequency: 'daily' | 'weekly' | 'monthly';\n    daysOfWeek?: number[]; // 0-6 (Sunday-Saturday)\n    endDate?: Date;\n  };\n  notifications: {\n    email: boolean;\n    sms: boolean;\n    inApp: boolean;\n    reminderTime: number; // minutes before shift\n  };\n  conflictResolution?: {\n    isConflict: boolean;\n    conflictWith?: mongoose.Types.ObjectId[];\n    resolvedBy?: mongoose.Types.ObjectId;\n    resolvedAt?: Date;\n  };\n  createdBy: mongoose.Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n*/\n\nconst staffScheduleSchema = new Schema<IStaffSchedule>({\n  staffId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Staff ID is required']\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  date: {\n    type: Date,\n    required: [true, 'Date is required']\n  },\n  startTime: {\n    type: String,\n    required: [true, 'Start time is required'],\n    match: [/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/, 'Please provide a valid time format (HH:MM)']\n  },\n  endTime: {\n    type: String,\n    required: [true, 'End time is required'],\n    match: [/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/, 'Please provide a valid time format (HH:MM)']\n  },\n  shiftType: {\n    type: String,\n    enum: ['morning', 'afternoon', 'evening', 'night', 'full-day'],\n    required: [true, 'Shift type is required']\n  },\n  status: {\n    type: String,\n    enum: ['scheduled', 'completed', 'cancelled', 'no-show'],\n    default: 'scheduled'\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [500, 'Notes cannot exceed 500 characters']\n  },\n  isRecurring: {\n    type: Boolean,\n    default: false\n  },\n  recurringPattern: {\n    frequency: {\n      type: String,\n      enum: ['daily', 'weekly', 'monthly']\n    },\n    daysOfWeek: [{\n      type: Number,\n      min: 0,\n      max: 6\n    }],\n    endDate: {\n      type: Date\n    }\n  },\n  notifications: {\n    email: {\n      type: Boolean,\n      default: true\n    },\n    sms: {\n      type: Boolean,\n      default: false\n    },\n    inApp: {\n      type: Boolean,\n      default: true\n    },\n    reminderTime: {\n      type: Number,\n      default: 60, // 1 hour before\n      min: 0,\n      max: 1440 // max 24 hours\n    }\n  },\n  conflictResolution: {\n    isConflict: {\n      type: Boolean,\n      default: false\n    },\n    conflictWith: [{\n      type: Schema.Types.ObjectId,\n      ref: 'StaffSchedule'\n    }],\n    resolvedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User'\n    },\n    resolvedAt: {\n      type: Date\n    }\n  },\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Created by is required']\n  }\n}, {\n  timestamps: true\n});\n\n// Indexes\nstaffScheduleSchema.index({ staffId: 1, date: 1 });\nstaffScheduleSchema.index({ clinicId: 1, date: 1 });\nstaffScheduleSchema.index({ date: 1, status: 1 });\n\n// Validation to ensure end time is after start time\nstaffScheduleSchema.pre('save', function(next) {\n  const startHour = parseInt(this.startTime.split(':')[0]);\n  const startMinute = parseInt(this.startTime.split(':')[1]);\n  const endHour = parseInt(this.endTime.split(':')[0]);\n  const endMinute = parseInt(this.endTime.split(':')[1]);\n  \n  const startTotalMinutes = startHour * 60 + startMinute;\n  const endTotalMinutes = endHour * 60 + endMinute;\n  \n  if (endTotalMinutes <= startTotalMinutes) {\n    return next(new Error('End time must be after start time'));\n  }\n  \n  next();\n});\n\n// Static method to find schedules by clinic and date range\nstaffScheduleSchema.statics.findByClinicAndDateRange = function(clinicId: string, startDate: Date, endDate: Date) {\n  return this.find({\n    clinicId,\n    date: { $gte: startDate, $lte: endDate }\n  }).populate('staffId', 'firstName lastName role email phone');\n};\n\n// Static method to find staff availability\nstaffScheduleSchema.statics.findStaffAvailability = function(staffId: string, date: Date) {\n  return this.find({\n    staffId,\n    date,\n    status: { $in: ['scheduled', 'completed'] }\n  });\n};\n\n// Static method to detect scheduling conflicts\nstaffScheduleSchema.statics.detectConflicts = function(staffId: string, date: Date, startTime: string, endTime: string, excludeId?: string) {\n  const query: any = {\n    staffId,\n    date,\n    status: { $in: ['scheduled', 'completed'] },\n    $or: [\n      {\n        startTime: { $lte: startTime },\n        endTime: { $gt: startTime }\n      },\n      {\n        startTime: { $lt: endTime },\n        endTime: { $gte: endTime }\n      },\n      {\n        startTime: { $gte: startTime },\n        endTime: { $lte: endTime }\n      }\n    ]\n  };\n  \n  if (excludeId) {\n    query._id = { $ne: excludeId };\n  }\n  \n  return this.find(query);\n};\n\n// Static method to get staff schedules for calendar view\nstaffScheduleSchema.statics.getCalendarView = function(clinicId: string, startDate: Date, endDate: Date) {\n  return this.find({\n    clinicId,\n    date: { $gte: startDate, $lte: endDate },\n    status: { $in: ['scheduled', 'completed'] }\n  })\n  .populate('staffId', 'firstName lastName role email phone')\n  .populate('clinicId', 'name')\n  .sort({ date: 1, startTime: 1 });\n};\n\nconst StaffSchedule = mongoose.model<IStaffSchedule, IStaffScheduleModel>('StaffSchedule', staffScheduleSchema);\n\nexport default StaffSchedule;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\StockMovement.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":143,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3244,3247],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3244,3247],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":143,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3254,3257],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3254,3257],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4752,4755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4752,4755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":212,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":212,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5242,5245],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5242,5245],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":272,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":272,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6783,6786],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6783,6786],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface IStockMovement extends Document {\n  _id: Types.ObjectId;\n  inventoryItem: Types.ObjectId;\n  clinic: Types.ObjectId;\n  \n  // Movement Details\n  type: 'in' | 'out' | 'adjustment';\n  quantity: number;\n  previousStock: number;\n  newStock: number;\n  \n  // Transaction Details\n  reason: 'purchase' | 'usage' | 'adjustment' | 'expired' | 'damaged' | 'transfer' | 'return' | 'other';\n  description?: string;\n  reference?: string; // PO number, treatment ID, etc.\n  \n  // Cost Information\n  unitCost?: number;\n  totalCost?: number;\n  \n  // Related Documents\n  relatedDocument?: {\n    type: 'purchase_order' | 'treatment' | 'prescription' | 'adjustment';\n    id: Types.ObjectId;\n  };\n  \n  // Batch/Expiry Information\n  batchNumber?: string;\n  expiryDate?: Date;\n  \n  // Audit\n  performedBy: Types.ObjectId;\n  performedAt: Date;\n  notes?: string;\n  \n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst stockMovementSchema = new Schema<IStockMovement>({\n  inventoryItem: {\n    type: Schema.Types.ObjectId,\n    ref: 'InventoryItem',\n    required: [true, 'Inventory item is required']\n  },\n  clinic: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic is required']\n  },\n  \n  // Movement Details\n  type: {\n    type: String,\n    required: [true, 'Movement type is required'],\n    enum: ['in', 'out', 'adjustment']\n  },\n  quantity: {\n    type: Number,\n    required: [true, 'Quantity is required'],\n    min: [0.01, 'Quantity must be greater than 0']\n  },\n  previousStock: {\n    type: Number,\n    required: [true, 'Previous stock is required'],\n    min: [0, 'Previous stock cannot be negative']\n  },\n  newStock: {\n    type: Number,\n    required: [true, 'New stock is required'],\n    min: [0, 'New stock cannot be negative']\n  },\n  \n  // Transaction Details\n  reason: {\n    type: String,\n    required: [true, 'Reason is required'],\n    enum: ['purchase', 'usage', 'adjustment', 'expired', 'damaged', 'transfer', 'return', 'other']\n  },\n  description: {\n    type: String,\n    trim: true,\n    maxlength: [500, 'Description cannot exceed 500 characters']\n  },\n  reference: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Reference cannot exceed 100 characters']\n  },\n  \n  // Cost Information\n  unitCost: {\n    type: Number,\n    min: [0, 'Unit cost cannot be negative']\n  },\n  totalCost: {\n    type: Number,\n    min: [0, 'Total cost cannot be negative']\n  },\n  \n  // Related Documents\n  relatedDocument: {\n    type: {\n      type: String,\n      enum: ['purchase_order', 'treatment', 'prescription', 'adjustment']\n    },\n    id: {\n      type: Schema.Types.ObjectId\n    }\n  },\n  \n  // Batch/Expiry Information\n  batchNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Batch number cannot exceed 50 characters']\n  },\n  expiryDate: {\n    type: Date\n  },\n  \n  // Audit\n  performedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Performed by is required']\n  },\n  performedAt: {\n    type: Date,\n    default: Date.now\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Notes cannot exceed 1000 characters']\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      delete ret._id;\n      delete ret.__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nstockMovementSchema.index({ inventoryItem: 1, createdAt: -1 });\nstockMovementSchema.index({ clinic: 1, createdAt: -1 });\nstockMovementSchema.index({ performedBy: 1, createdAt: -1 });\nstockMovementSchema.index({ type: 1, createdAt: -1 });\nstockMovementSchema.index({ reason: 1, createdAt: -1 });\n\n// Virtual for movement direction\nstockMovementSchema.virtual('direction').get(function() {\n  return this.type === 'in' ? 'incoming' : \n         this.type === 'out' ? 'outgoing' : 'adjustment';\n});\n\n// Virtual for stock change\nstockMovementSchema.virtual('stockChange').get(function() {\n  return this.newStock - this.previousStock;\n});\n\n// Pre-save middleware to calculate total cost\nstockMovementSchema.pre('save', function(next) {\n  if (this.unitCost && this.quantity) {\n    this.totalCost = this.unitCost * this.quantity;\n  }\n  next();\n});\n\n// Static method to get movement history for an item\nstockMovementSchema.statics.getItemHistory = function(inventoryItemId: string, limit: number = 50) {\n  return this.find({ inventoryItem: inventoryItemId })\n    .populate('performedBy', 'firstName lastName')\n    .sort({ createdAt: -1 })\n    .limit(limit);\n};\n\n// Static method to get movements by date range\nstockMovementSchema.statics.getMovementsByDateRange = function(\n  startDate: Date, \n  endDate: Date, \n  clinicId?: string,\n  type?: 'in' | 'out' | 'adjustment'\n) {\n  const query: any = {\n    createdAt: { $gte: startDate, $lte: endDate }\n  };\n  \n  if (clinicId) query.clinic = clinicId;\n  if (type) query.type = type;\n  \n  return this.find(query)\n    .populate('inventoryItem', 'name sku category')\n    .populate('performedBy', 'firstName lastName')\n    .sort({ createdAt: -1 });\n};\n\n// Static method to get stock movement summary\nstockMovementSchema.statics.getMovementSummary = function(\n  startDate: Date,\n  endDate: Date,\n  clinicId?: string\n) {\n  const matchStage: any = {\n    createdAt: { $gte: startDate, $lte: endDate }\n  };\n  if (clinicId) matchStage.clinic = new Types.ObjectId(clinicId);\n  \n  return this.aggregate([\n    { $match: matchStage },\n    {\n      $group: {\n        _id: {\n          type: '$type',\n          reason: '$reason'\n        },\n        count: { $sum: 1 },\n        totalQuantity: { $sum: '$quantity' },\n        totalValue: { $sum: '$totalCost' }\n      }\n    },\n    {\n      $group: {\n        _id: '$_id.type',\n        reasons: {\n          $push: {\n            reason: '$_id.reason',\n            count: '$count',\n            totalQuantity: '$totalQuantity',\n            totalValue: '$totalValue'\n          }\n        },\n        totalCount: { $sum: '$count' },\n        totalQuantity: { $sum: '$totalQuantity' },\n        totalValue: { $sum: '$totalValue' }\n      }\n    },\n    { $sort: { _id: 1 } }\n  ]);\n};\n\n// Static method to record a stock movement\nstockMovementSchema.statics.recordMovement = async function(data: {\n  inventoryItem: string;\n  clinic: string;\n  type: 'in' | 'out' | 'adjustment';\n  quantity: number;\n  previousStock: number;\n  newStock: number;\n  reason: 'purchase' | 'usage' | 'adjustment' | 'expired' | 'damaged' | 'transfer' | 'return' | 'other';\n  description?: string;\n  reference?: string;\n  unitCost?: number;\n  relatedDocument?: { type: string; id: string };\n  batchNumber?: string;\n  expiryDate?: Date;\n  performedBy: string;\n  notes?: string;\n}) {\n  return this.create(data);\n};\n\n// Static methods\nstockMovementSchema.statics.recordMovement = function(data: any) {\n  return this.create(data);\n};\n\nstockMovementSchema.statics.getMovementSummary = function(period = 30) {\n  const startDate = new Date();\n  startDate.setDate(startDate.getDate() - period);\n  \n  return this.aggregate([\n    { $match: { date: { $gte: startDate } } },\n    {\n      $group: {\n        _id: '$type',\n        count: { $sum: 1 },\n        totalQuantity: { $sum: '$quantity' }\n      }\n    }\n  ]);\n};\n\nexport default model<IStockMovement>('StockMovement', stockMovementSchema);\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\Supplier.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3204,3207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3204,3207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3214,3217],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3214,3217],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4053,4056],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4053,4056],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Schema, model, Document, Types } from 'mongoose';\n\nexport interface ISupplier extends Document {\n  _id: Types.ObjectId;\n  name: string;\n  contactPerson?: string;\n  email?: string;\n  phone?: string;\n  address?: {\n    street?: string;\n    city?: string;\n    state?: string;\n    zipCode?: string;\n    country?: string;\n  };\n  taxId?: string;\n  website?: string;\n  notes?: string;\n  \n  // Business Information\n  paymentTerms?: string;\n  creditLimit?: number;\n  isActive: boolean;\n  \n  // Performance Tracking\n  rating?: number;\n  totalOrders?: number;\n  totalSpent?: number;\n  \n  // Audit\n  createdBy: Types.ObjectId;\n  updatedBy?: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst supplierSchema = new Schema<ISupplier>({\n  name: {\n    type: String,\n    required: [true, 'Supplier name is required'],\n    trim: true,\n    maxlength: [100, 'Supplier name cannot exceed 100 characters']\n  },\n  contactPerson: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Contact person name cannot exceed 100 characters']\n  },\n  email: {\n    type: String,\n    trim: true,\n    lowercase: true,\n    match: [/^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/, 'Please enter a valid email']\n  },\n  phone: {\n    type: String,\n    trim: true,\n    maxlength: [20, 'Phone number cannot exceed 20 characters']\n  },\n  address: {\n    street: {\n      type: String,\n      trim: true,\n      maxlength: [200, 'Street address cannot exceed 200 characters']\n    },\n    city: {\n      type: String,\n      trim: true,\n      maxlength: [50, 'City cannot exceed 50 characters']\n    },\n    state: {\n      type: String,\n      trim: true,\n      maxlength: [50, 'State cannot exceed 50 characters']\n    },\n    zipCode: {\n      type: String,\n      trim: true,\n      maxlength: [20, 'Zip code cannot exceed 20 characters']\n    },\n    country: {\n      type: String,\n      trim: true,\n      maxlength: [50, 'Country cannot exceed 50 characters']\n    }\n  },\n  taxId: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Tax ID cannot exceed 50 characters']\n  },\n  website: {\n    type: String,\n    trim: true,\n    maxlength: [200, 'Website URL cannot exceed 200 characters']\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Notes cannot exceed 1000 characters']\n  },\n  \n  // Business Information\n  paymentTerms: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Payment terms cannot exceed 100 characters']\n  },\n  creditLimit: {\n    type: Number,\n    min: [0, 'Credit limit cannot be negative']\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  },\n  \n  // Performance Tracking\n  rating: {\n    type: Number,\n    min: [1, 'Rating must be at least 1'],\n    max: [5, 'Rating cannot exceed 5']\n  },\n  totalOrders: {\n    type: Number,\n    default: 0,\n    min: [0, 'Total orders cannot be negative']\n  },\n  totalSpent: {\n    type: Number,\n    default: 0,\n    min: [0, 'Total spent cannot be negative']\n  },\n  \n  // Audit\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Created by is required']\n  },\n  updatedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      delete ret._id;\n      delete ret.__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\nsupplierSchema.index({ name: 1 });\nsupplierSchema.index({ isActive: 1 });\nsupplierSchema.index({ email: 1 }, { sparse: true });\n\n// Virtual for full address\nsupplierSchema.virtual('fullAddress').get(function() {\n  if (!this.address) return '';\n  const { street, city, state, zipCode, country } = this.address;\n  const parts = [street, city, state, zipCode, country].filter(Boolean);\n  return parts.join(', ');\n});\n\n// Static method to find active suppliers\nsupplierSchema.statics.findActive = function() {\n  return this.find({ isActive: true }).sort({ name: 1 });\n};\n\n// Static method to get supplier performance summary\nsupplierSchema.statics.getPerformanceSummary = function(supplierId?: string) {\n  const matchStage: any = { isActive: true };\n  if (supplierId) matchStage._id = new Types.ObjectId(supplierId);\n  \n  return this.aggregate([\n    { $match: matchStage },\n    {\n      $project: {\n        name: 1,\n        totalOrders: 1,\n        totalSpent: 1,\n        rating: 1,\n        averageOrderValue: {\n          $cond: [\n            { $gt: ['$totalOrders', 0] },\n            { $divide: ['$totalSpent', '$totalOrders'] },\n            0\n          ]\n        }\n      }\n    },\n    { $sort: { totalSpent: -1 } }\n  ]);\n};\n\n// Static methods\nsupplierSchema.statics.findActive = function() {\n  return this.find({ isActive: true });\n};\n\nsupplierSchema.statics.getPerformanceSummary = function() {\n  return Promise.resolve({\n    averageRating: 4.5,\n    totalOrders: 0,\n    onTimeDelivery: 95\n  });\n};\n\nexport default model<ISupplier>('Supplier', supplierSchema);\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\TreatmentRecord.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1938,1941],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1938,1941],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1948,1951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1948,1951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2013,2016],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2013,2016],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2057,2060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2057,2060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2862,2865],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2862,2865],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3196,3199],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3196,3199],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4211,4214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4211,4214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4800,4803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4800,4803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5832,5835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5832,5835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Schema } from 'mongoose';\nimport { ITreatmentRecord, ITreatmentRecordModel } from '../types';\n\nconst treatmentRecordSchema = new Schema<ITreatmentRecord>({\n  patientId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Patient',\n    required: [true, 'Patient ID is required']\n  },\n  date: {\n    type: Date,\n    required: [true, 'Treatment date is required'],\n    validate: {\n      validator: function(value: Date) {\n        return value <= new Date();\n      },\n      message: 'Treatment date cannot be in the future'\n    }\n  },\n  dentistId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: [true, 'Dentist ID is required']\n  },\n  clinicId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Clinic',\n    required: [true, 'Clinic ID is required']\n  },\n  procedure: {\n    type: String,\n    required: [true, 'Procedure is required'],\n    trim: true,\n    maxlength: [200, 'Procedure description cannot exceed 200 characters']\n  },\n  diagnosis: {\n    type: String,\n    required: [true, 'Diagnosis is required'],\n    trim: true,\n    maxlength: [500, 'Diagnosis cannot exceed 500 characters']\n  },\n  notes: {\n    type: String,\n    trim: true,\n    maxlength: [2000, 'Notes cannot exceed 2000 characters']\n  },\n  attachments: [{\n    id: {\n      type: String,\n      required: true\n    },\n    fileName: {\n      type: String,\n      required: [true, 'File name is required'],\n      trim: true,\n      maxlength: [255, 'File name cannot exceed 255 characters']\n    },\n    fileType: {\n      type: String,\n      required: [true, 'File type is required'],\n      enum: ['image/jpeg', 'image/png', 'image/gif', 'application/pdf', 'text/plain'],\n      trim: true\n    },\n    fileUrl: {\n      type: String,\n      required: [true, 'File URL is required'],\n      trim: true\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now\n    }\n  }]\n}, {\n  timestamps: true,\n  toJSON: {\n    virtuals: true,\n    transform: function(doc: any, ret: any) {\n      ret.id = ret._id;\n      if (ret._id) delete (ret as any)._id;\n      if (ret.__v) delete (ret as any).__v;\n      return ret;\n    }\n  }\n});\n\n// Indexes\ntreatmentRecordSchema.index({ patientId: 1 });\ntreatmentRecordSchema.index({ dentistId: 1 });\ntreatmentRecordSchema.index({ clinicId: 1 });\ntreatmentRecordSchema.index({ date: 1 });\ntreatmentRecordSchema.index({ procedure: 1 });\ntreatmentRecordSchema.index({ createdAt: 1 });\n\n// Compound indexes for common queries\ntreatmentRecordSchema.index({ patientId: 1, date: -1 });\ntreatmentRecordSchema.index({ dentistId: 1, date: -1 });\ntreatmentRecordSchema.index({ clinicId: 1, date: -1 });\n\n// Virtual for attachment count\ntreatmentRecordSchema.virtual('attachmentCount').get(function() {\n  return this.attachments ? this.attachments.length : 0;\n});\n\n// Instance method to add attachment\ntreatmentRecordSchema.methods.addAttachment = function(attachment: any) {\n  this.attachments.push({\n    id: new mongoose.Types.ObjectId().toString(),\n    ...attachment,\n    uploadedAt: new Date()\n  });\n  return this.save();\n};\n\n// Instance method to remove attachment\ntreatmentRecordSchema.methods.removeAttachment = function(attachmentId: string) {\n  this.attachments = this.attachments.filter((att: any) => att.id !== attachmentId);\n  return this.save();\n};\n\n// Static method to find by patient\ntreatmentRecordSchema.statics.findByPatient = function(patientId: string) {\n  return this.find({ patientId }).sort({ date: -1 });\n};\n\n// Static method to find by dentist\ntreatmentRecordSchema.statics.findByDentist = function(dentistId: string) {\n  return this.find({ dentistId }).sort({ date: -1 });\n};\n\n// Static method to find by clinic\ntreatmentRecordSchema.statics.findByClinic = function(clinicId: string) {\n  return this.find({ clinicId }).sort({ date: -1 });\n};\n\n// Static method to find by date range\ntreatmentRecordSchema.statics.findByDateRange = function(startDate: Date, endDate: Date) {\n  return this.find({\n    date: {\n      $gte: startDate,\n      $lte: endDate\n    }\n  }).sort({ date: -1 });\n};\n\n// Static method to search treatment records\ntreatmentRecordSchema.statics.searchRecords = function(searchTerm: string, patientId?: string) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  const query: any = {\n    $or: [\n      { procedure: searchRegex },\n      { diagnosis: searchRegex },\n      { notes: searchRegex }\n    ]\n  };\n  \n  if (patientId) {\n    query.patientId = patientId;\n  }\n  \n  return this.find(query).sort({ date: -1 });\n};\n\n// Static method to search treatment records with pagination\ntreatmentRecordSchema.statics.searchTreatmentRecords = function(\n  searchTerm: string,\n  options: {\n    patientId?: string;\n    dentistId?: string;\n    clinicId?: string;\n    skip?: number;\n    limit?: number;\n  } = {}\n) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  const query: any = {\n    $or: [\n      { procedure: searchRegex },\n      { diagnosis: searchRegex },\n      { notes: searchRegex }\n    ]\n  };\n  \n  if (options.patientId) {\n    query.patientId = options.patientId;\n  }\n  \n  if (options.dentistId) {\n    query.dentistId = options.dentistId;\n  }\n  \n  if (options.clinicId) {\n    query.clinicId = options.clinicId;\n  }\n  \n  const queryBuilder = this.find(query)\n    .populate('patientId', 'firstName lastName email')\n    .populate('dentistId', 'firstName lastName specialization')\n    .populate('clinicId', 'name address')\n    .sort({ date: -1 });\n    \n  if (options.skip) {\n    queryBuilder.skip(options.skip);\n  }\n  \n  if (options.limit) {\n    queryBuilder.limit(options.limit);\n  }\n  \n  return queryBuilder;\n};\n\n// Static method to count search results\ntreatmentRecordSchema.statics.countSearchResults = function(\n  searchTerm: string,\n  options: {\n    patientId?: string;\n    dentistId?: string;\n    clinicId?: string;\n  } = {}\n) {\n  const searchRegex = new RegExp(searchTerm, 'i');\n  const query: any = {\n    $or: [\n      { procedure: searchRegex },\n      { diagnosis: searchRegex },\n      { notes: searchRegex }\n    ]\n  };\n  \n  if (options.patientId) {\n    query.patientId = options.patientId;\n  }\n  \n  if (options.dentistId) {\n    query.dentistId = options.dentistId;\n  }\n  \n  if (options.clinicId) {\n    query.clinicId = options.clinicId;\n  }\n  \n  return this.countDocuments(query);\n};\n\nconst TreatmentRecord = mongoose.model<ITreatmentRecord, ITreatmentRecordModel>('TreatmentRecord', treatmentRecordSchema);\n\nexport default TreatmentRecord;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\User.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IUser' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2871,2874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2871,2874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2881,2884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2881,2884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from 'mongoose';\nimport bcrypt from 'bcryptjs';\nimport { IUser, UserRole } from '../types';\n\nconst userSchema = new mongoose.Schema({\n  firstName: {\n    type: String,\n    required: [true, 'First name is required'],\n    trim: true,\n    maxlength: [50, 'First name cannot exceed 50 characters']\n  },\n  lastName: {\n    type: String,\n    required: [true, 'Last name is required'],\n    trim: true,\n    maxlength: [50, 'Last name cannot exceed 50 characters']\n  },\n  email: {\n    type: String,\n    required: [true, 'Email is required'],\n    unique: true,\n    lowercase: true,\n    trim: true,\n    match: [/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/, 'Please provide a valid email']\n  },\n  password: {\n    type: String,\n    required: [true, 'Password is required'],\n    minlength: [6, 'Password must be at least 6 characters'],\n    select: false // Don't include password in queries by default\n  },\n  phone: {\n    type: String,\n    trim: true,\n    match: [/^[\\+]?[1-9][\\d]{0,15}$/, 'Please provide a valid phone number']\n  },\n  role: {\n    type: String,\n    enum: ['patient', 'dentist', 'staff', 'admin', 'super_admin'],\n    default: 'patient'\n  },\n  profileImage: {\n    type: String,\n    default: null\n  },\n  assignedClinics: [{\n    type: mongoose.Types.ObjectId,\n    ref: 'Clinic'\n  }],\n  preferredClinicId: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'Clinic'\n  },\n  specialization: {\n    type: String,\n    trim: true,\n    maxlength: [100, 'Specialization cannot exceed 100 characters']\n  },\n  twoFactorEnabled: {\n    type: Boolean,\n    default: false\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  },\n  lastLogin: {\n    type: Date\n  },\n  dateOfBirth: {\n    type: String,\n    trim: true\n  },\n  gender: {\n    type: String,\n    enum: ['male', 'female', 'other', 'prefer_not_to_say'],\n    trim: true\n  },\n  address: {\n    street: {\n      type: String,\n      trim: true,\n      maxlength: [200, 'Street address cannot exceed 200 characters']\n    },\n    city: {\n      type: String,\n      trim: true,\n      maxlength: [100, 'City cannot exceed 100 characters']\n    },\n    state: {\n      type: String,\n      trim: true,\n      maxlength: [100, 'State cannot exceed 100 characters']\n    },\n    zipCode: {\n      type: String,\n      trim: true,\n      maxlength: [20, 'Zip code cannot exceed 20 characters']\n    },\n    country: {\n      type: String,\n      trim: true,\n      maxlength: [100, 'Country cannot exceed 100 characters']\n    }\n  },\n  licenseNumber: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'License number cannot exceed 50 characters']\n  },\n  bio: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Bio cannot exceed 1000 characters']\n  },\n  passwordResetToken: {\n    type: String,\n    select: false\n  },\n  passwordResetExpires: {\n    type: Date,\n    select: false\n  }\n}, {\n  timestamps: true,\n  toJSON: {\n    transform: function(doc: any, ret: any) {\n      if (ret.password) delete ret.password;\n      if (ret.passwordResetToken) delete ret.passwordResetToken;\n      if (ret.passwordResetExpires) delete ret.passwordResetExpires;\n      return ret;\n    }\n  }\n});\n\n// Indexes\n// Remove: userSchema.index({ email: 1 });\nuserSchema.index({ role: 1 });\nuserSchema.index({ isActive: 1 });\nuserSchema.index({ assignedClinics: 1 });\n\n// Pre-save middleware to hash password\nuserSchema.pre('save', async function(next) {\n  // Only hash the password if it has been modified (or is new)\n  if (!this.isModified('password') || !this.password) return next();\n\n  try {\n    // Hash password with cost of 12\n    const saltRounds = parseInt(process.env.BCRYPT_SALT_ROUNDS || '12');\n    this.password = await bcrypt.hash(this.password as string, saltRounds);\n    next();\n  } catch (error) {\n    next(error as Error);\n  }\n});\n\n// Instance method to check password\nuserSchema.methods.comparePassword = async function(candidatePassword: string): Promise<boolean> {\n  return bcrypt.compare(candidatePassword, this.password);\n};\n\n// Instance method to get full name\nuserSchema.methods.getFullName = function(): string {\n  return `${this.firstName} ${this.lastName}`;\n};\n\n// Static method to find by email\nuserSchema.statics.findByEmail = function(email: string) {\n  return this.findOne({ email: email.toLowerCase() });\n};\n\n// Static method to find active users\nuserSchema.statics.findActive = function() {\n  return this.find({ isActive: true });\n};\n\n// Static method to find by role\nuserSchema.statics.findByRole = function(role: UserRole) {\n  return this.find({ role, isActive: true });\n};\n\n// Virtual for full name\nuserSchema.virtual('fullName').get(function() {\n  return `${this.firstName} ${this.lastName}`;\n});\n\nconst User = mongoose.model('User', userSchema);\n\nexport default User;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\models\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\adminRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'param' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\r\nimport {\r\n  getAdminClinicOverview,\r\n  getClinicDetailedData,\r\n  getClinicComparison,\r\n  getSystemStatistics,\r\n  getMultiClinicDashboard,\r\n  getClinicPerformanceMetrics\r\n} from '../controllers/adminController';\r\nimport {\r\n  authenticate,\r\n  adminOnly\r\n} from '../middleware/auth';\r\nimport {\r\n  query,\r\n  param\r\n} from 'express-validator';\r\nimport {\r\n  handleValidationErrors,\r\n  createMongoIdValidation,\r\n  validatePagination\r\n} from '../middleware/validation';\r\nimport {\r\n  getHomepageContentBlocks,\r\n  createHomepageContentBlock,\r\n  updateHomepageContentBlock,\r\n  deleteHomepageContentBlock,\r\n  publishHomepageContentBlock\r\n} from '../controllers/homepageContentController';\r\n\r\nconst router = Router();\r\n\r\n// All admin routes require authentication and admin role\r\nrouter.use(authenticate);\r\nrouter.use(adminOnly);\r\n\r\n// Get comprehensive clinic overview for admin dashboard\r\nrouter.get('/clinics/overview', [\r\n  ...validatePagination,\r\n  query('search')\r\n    .optional()\r\n    .trim()\r\n    .isLength({ min: 2 })\r\n    .withMessage('Search term must be at least 2 characters'),\r\n  query('status')\r\n    .optional()\r\n    .isIn(['all', 'active', 'inactive'])\r\n    .withMessage('Status must be all, active, or inactive'),\r\n  query('sortBy')\r\n    .optional()\r\n    .isIn(['name', 'createdAt', 'patients', 'revenue', 'appointments'])\r\n    .withMessage('Invalid sort field')\r\n], handleValidationErrors, getAdminClinicOverview);\r\n\r\n// Get detailed data for a specific clinic\r\nrouter.get('/clinics/:clinicId/detailed', [\r\n  ...createMongoIdValidation('clinicId'),\r\n  query('startDate')\r\n    .optional()\r\n    .isISO8601()\r\n    .withMessage('Start date must be a valid ISO 8601 date'),\r\n  query('endDate')\r\n    .optional()\r\n    .isISO8601()\r\n    .withMessage('End date must be a valid ISO 8601 date')\r\n], handleValidationErrors, getClinicDetailedData);\r\n\r\n// Get clinic comparison data\r\nrouter.get('/clinics/comparison', [\r\n  query('clinicIds')\r\n    .notEmpty()\r\n    .withMessage('Clinic IDs are required')\r\n    .custom((value) => {\r\n      const ids = Array.isArray(value) ? value : [value];\r\n      if (ids.length < 2) {\r\n        throw new Error('At least 2 clinic IDs are required for comparison');\r\n      }\r\n      if (ids.length > 5) {\r\n        throw new Error('Maximum 5 clinics can be compared at once');\r\n      }\r\n      return true;\r\n    }),\r\n  query('metric')\r\n    .optional()\r\n    .isIn(['revenue', 'patients', 'appointments'])\r\n    .withMessage('Metric must be revenue, patients, or appointments'),\r\n  query('period')\r\n    .optional()\r\n    .isIn(['7d', '30d', '90d', '1y'])\r\n    .withMessage('Period must be 7d, 30d, 90d, or 1y')\r\n], handleValidationErrors, getClinicComparison);\r\n\r\n// Get system-wide statistics\r\nrouter.get('/system/statistics', [\r\n  query('period')\r\n    .optional()\r\n    .isIn(['7d', '30d', '90d', '1y'])\r\n    .withMessage('Period must be 7d, 30d, 90d, or 1y')\r\n], handleValidationErrors, getSystemStatistics);\r\n\r\n// Get multi-clinic dashboard overview with staff schedules\r\nrouter.get('/multi-clinic/dashboard', [\r\n  query('period')\r\n    .optional()\r\n    .isIn(['7d', '30d', '90d', '1y'])\r\n    .withMessage('Period must be 7d, 30d, 90d, or 1y'),\r\n  query('clinicIds')\r\n    .optional()\r\n    .custom((value) => {\r\n      if (value) {\r\n        const ids = Array.isArray(value) ? value : [value];\r\n        if (ids.length > 10) {\r\n          throw new Error('Maximum 10 clinics can be selected at once');\r\n        }\r\n      }\r\n      return true;\r\n    })\r\n], handleValidationErrors, getMultiClinicDashboard);\r\n\r\n// Get clinic performance metrics for comparison\r\nrouter.get('/clinics/performance', [\r\n  query('period')\r\n    .optional()\r\n    .isIn(['7d', '30d', '90d', '1y'])\r\n    .withMessage('Period must be 7d, 30d, 90d, or 1y'),\r\n  query('metrics')\r\n    .optional()\r\n    .isIn(['all', 'efficiency', 'satisfaction', 'revenue', 'productivity'])\r\n    .withMessage('Invalid metrics parameter')\r\n], handleValidationErrors, getClinicPerformanceMetrics);\r\n\r\n// Homepage content management routes\r\nrouter.get('/homepage/blocks', handleValidationErrors, getHomepageContentBlocks);\r\nrouter.post('/homepage/blocks', handleValidationErrors, createHomepageContentBlock);\r\nrouter.put('/homepage/blocks/:id', [\r\n  ...createMongoIdValidation('id')\r\n], handleValidationErrors, updateHomepageContentBlock);\r\nrouter.delete('/homepage/blocks/:id', [\r\n  ...createMongoIdValidation('id')\r\n], handleValidationErrors, deleteHomepageContentBlock);\r\nrouter.post('/homepage/blocks/:id/publish', [\r\n  ...createMongoIdValidation('id')\r\n], handleValidationErrors, publishHomepageContentBlock);\r\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\appointmentRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'checkClinicAccess' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":41,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":18}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  createAppointment,\n  getAllAppointments,\n  updateAppointment,\n  cancelAppointment,\n  rescheduleAppointment,\n  completeAppointment,\n  getAvailableTimeSlots,\n  getTodayAppointments,\n  getUpcomingAppointments,\n  getAppointmentsByDateRange,\n  getAppointmentStatistics,\n  sendAppointmentReminders,\n  getAppointmentById,\n  getRecentAppointments,\n  getRecentAppointmentsOverall,\n  checkAppointmentConflicts,\n  autoBookFirstAvailable,\n  getNextSlotAfterLastBooking,\n  getBookedSlots,\n  // Unified Dashboard Endpoints\n  getDoctorUnifiedAppointments,\n  getAdminUnifiedAppointments,\n  quickUpdateAppointment,\n  cancelAppointmentWithNotification,\n  rescheduleAppointmentEnhanced\n} from '../controllers/appointmentController';\nimport {\n  authenticate,\n  staffOrAdmin,\n  dentistOrAdmin,\n  checkClinicAccess,\n  patientOwnerOrStaff,\n  appointmentAccessControl,\n  appointmentDetailAccessControl\n} from '../middleware/auth';\nimport {\n  validateAppointmentCreation,\n  validateAppointmentUpdate,\n  validateMongoId,\n  validatePagination,\n  validateDateRange,\n  createMongoIdValidation,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body, query } from 'express-validator';\n\nconst router = Router();\n\n// Public routes (no authentication required)\n// Test route to verify public access works\n// router.get('/test-public', (req, res) => {\n//   res.json({ success: true, message: 'Public route works!', timestamp: new Date().toISOString() });\n// });\n\n// Get available time slots - public endpoint for booking flow\nrouter.get('/available-slots', [\n  query('date')\n    .isISO8601()\n    .withMessage('Date is required and must be a valid date'),\n  query('dentistId')\n    .optional()\n    .custom((value) => {\n      if (value === '' || value === undefined || value === null) {\n        return true; // Allow empty values\n      }\n      // If value is provided, validate it's a valid MongoDB ID\n      const mongoIdRegex = /^[0-9a-fA-F]{24}$/;\n      return mongoIdRegex.test(value);\n    })\n    .withMessage('Dentist ID must be valid if provided'),\n  query('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('duration')\n    .optional()\n    .isInt({ min: 15, max: 240 })\n    .withMessage('Duration must be between 15 and 240 minutes')\n], handleValidationErrors, getAvailableTimeSlots);\n\n// Get next slot after last booking - public endpoint for sequential booking\nrouter.get('/next-slot-after-last', [\n  query('date')\n    .isISO8601()\n    .withMessage('Date is required and must be a valid date'),\n  query('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('duration')\n    .optional()\n    .isInt({ min: 15, max: 240 })\n    .withMessage('Duration must be between 15 and 240 minutes')\n], handleValidationErrors, getNextSlotAfterLastBooking);\n\n// Get booked time slots - public endpoint for availability display\nrouter.get('/booked-slots', [\n  query('date')\n    .isISO8601()\n    .withMessage('Date is required and must be in YYYY-MM-DD format'),\n  query('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('doctorId')\n    .optional()\n    .isMongoId()\n    .withMessage('Doctor ID must be valid if provided')\n], handleValidationErrors, getBookedSlots);\n\n// Check appointment conflicts - public endpoint for booking validation\nrouter.get('/check-conflict', [\n  query('date')\n    .isISO8601()\n    .withMessage('Date is required and must be a valid date'),\n  query('timeSlot')\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Time slot must be in HH:MM format'),\n  query('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Dentist ID must be valid if provided'),\n  query('duration')\n    .optional()\n    .isInt({ min: 15, max: 240 })\n    .withMessage('Duration must be between 15 and 240 minutes'),\n  query('excludeAppointmentId')\n    .optional()\n    .isMongoId()\n    .withMessage('Exclude appointment ID must be valid if provided')\n], handleValidationErrors, checkAppointmentConflicts);\n\n// All routes below require authentication\nrouter.use(authenticate);\n\n// ==================== UNIFIED DASHBOARD ROUTES ====================\n\n// Get unified appointments for doctor across all assigned clinics\nrouter.get('/unified/doctor', dentistOrAdmin, [\n  ...validatePagination.slice(0, -1),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('patientName')\n    .optional()\n    .trim()\n    .isLength({ max: 100 })\n    .withMessage('Patient name must not exceed 100 characters'),\n  query('status')\n    .optional()\n    .isIn(['scheduled', 'confirmed', 'in-progress', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Invalid appointment status'),\n  query('sortBy')\n    .optional()\n    .isIn(['date', 'createdAt', 'status'])\n    .withMessage('Invalid sort field'),\n  query('sortOrder')\n    .optional()\n    .isIn(['asc', 'desc'])\n    .withMessage('Invalid sort order')\n], handleValidationErrors, getDoctorUnifiedAppointments);\n\n// Get unified appointments for admin (all appointments across all clinics)\nrouter.get('/unified/admin', dentistOrAdmin, [\n  ...validatePagination.slice(0, -1),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  query('patientName')\n    .optional()\n    .trim()\n    .isLength({ max: 100 })\n    .withMessage('Patient name must not exceed 100 characters'),\n  query('status')\n    .optional()\n    .isIn(['scheduled', 'confirmed', 'in-progress', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Invalid appointment status'),\n  query('sortBy')\n    .optional()\n    .isIn(['date', 'createdAt', 'status'])\n    .withMessage('Invalid sort field'),\n  query('sortOrder')\n    .optional()\n    .isIn(['asc', 'desc'])\n    .withMessage('Invalid sort order')\n], handleValidationErrors, getAdminUnifiedAppointments);\n\n// Quick update appointment (time/notes only)\nrouter.patch('/:id/quick-update', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('timeSlot')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Time slot must be in HH:MM format'),\n  body('notes')\n    .optional()\n    .trim()\n    .isLength({ max: 1000 })\n    .withMessage('Notes must not exceed 1000 characters'),\n  body('duration')\n    .optional()\n    .isInt({ min: 15, max: 480 })\n    .withMessage('Duration must be between 15 and 480 minutes')\n], handleValidationErrors, quickUpdateAppointment);\n\n// Cancel appointment with automatic notification\nrouter.post('/:id/cancel-notify', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('cancellationReason')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Cancellation reason must not exceed 500 characters'),\n  body('notifyPatient')\n    .optional()\n    .isBoolean()\n    .withMessage('notifyPatient must be a boolean')\n], handleValidationErrors, cancelAppointmentWithNotification);\n\n// Reschedule appointment with enhanced conflict checking\nrouter.post('/:id/reschedule-enhanced', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('newDate')\n    .isISO8601()\n    .withMessage('New date is required and must be a valid date'),\n  body('newTimeSlot')\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('New time slot is required and must be in HH:MM format'),\n  body('newDuration')\n    .optional()\n    .isInt({ min: 15, max: 480 })\n    .withMessage('Duration must be between 15 and 480 minutes'),\n  body('reason')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Reason must not exceed 500 characters')\n], handleValidationErrors, rescheduleAppointmentEnhanced);\n\n// ==================== END UNIFIED DASHBOARD ROUTES ====================\n\n// Create appointment\nrouter.post('/', validateAppointmentCreation, handleValidationErrors, createAppointment);\n\n// Auto-book first available appointment for a date\nrouter.post('/auto-book', [\n  body('patientId')\n    .isMongoId()\n    .withMessage('Invalid patient ID'),\n  body('clinicId')\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  body('serviceType')\n    .trim()\n    .notEmpty()\n    .withMessage('Service type is required'),\n  body('date')\n    .isISO8601()\n    .withMessage('Please provide a valid date')\n    .custom((value) => {\n      const appointmentDate = new Date(value);\n      const today = new Date();\n      \n      // Simple timezone-safe date comparison using date strings\n      const appointmentDateStr = appointmentDate.toISOString().split('T')[0];\n      const todayDateStr = today.toISOString().split('T')[0];\n      \n      if (appointmentDateStr < todayDateStr) {\n        throw new Error('Appointment date cannot be in the past');\n      }\n      return true;\n    }),\n  body('duration')\n    .optional()\n    .isInt({ min: 15, max: 480 })\n    .withMessage('Duration must be between 15 and 480 minutes'),\n  body('notes')\n    .optional()\n    .trim()\n    .isLength({ max: 1000 })\n    .withMessage('Notes must not exceed 1000 characters'),\n  body('emergency')\n    .optional()\n    .isBoolean()\n    .withMessage('Emergency must be a boolean')\n], handleValidationErrors, autoBookFirstAvailable);\n\n// Get all appointments\nrouter.get('/', appointmentAccessControl, [\n  ...validatePagination.slice(0, -1),\n  query('status')\n    .optional()\n    .isIn(['scheduled', 'confirmed', 'in-progress', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Invalid appointment status'),\n  query('patientId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid patient ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date')\n], handleValidationErrors, getAllAppointments);\n\n// Get today's appointments\nrouter.get('/today', staffOrAdmin, [\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID')\n], handleValidationErrors, getTodayAppointments);\n\n// Get upcoming appointments\nrouter.get('/upcoming', staffOrAdmin, [\n  query('days')\n    .optional()\n    .isInt({ min: 1, max: 30 })\n    .withMessage('Days must be between 1 and 30'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getUpcomingAppointments);\n\n// Get appointments by date range\nrouter.get('/date-range', staffOrAdmin, [\n  ...validateDateRange.slice(0, -1),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  query('status')\n    .optional()\n    .isIn(['scheduled', 'confirmed', 'in-progress', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Invalid appointment status'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getAppointmentsByDateRange);\n\n// Get appointment statistics\nrouter.get('/statistics', staffOrAdmin, [\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID')\n], handleValidationErrors, getAppointmentStatistics);\n\n// Get recent appointments\nrouter.get('/recent', staffOrAdmin, [\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 50 })\n    .withMessage('Limit must be between 1 and 50'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getRecentAppointments);\n\n// Get recent appointments across all clinics (admin only)\nrouter.get('/recent/overall', dentistOrAdmin, [\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 50 })\n    .withMessage('Limit must be between 1 and 50'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getRecentAppointmentsOverall);\n\n\n\n// Send appointment reminders (admin only)\nrouter.post('/send-reminders', dentistOrAdmin, [\n  body('date')\n    .optional()\n    .isISO8601()\n    .withMessage('Date must be a valid date'),\n  body('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID')\n], handleValidationErrors, sendAppointmentReminders);\n\n// Get appointment by ID (staff/admin or patient if it's their appointment)\nrouter.get('/:id', appointmentDetailAccessControl, [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getAppointmentById);\n\n// Get appointments by patient ID (staff/admin or patient themselves)\nrouter.get('/patient/:patientId', patientOwnerOrStaff('patientId'), [\n  ...createMongoIdValidation('patientId'),\n  ...validatePagination.slice(0, -1),\n  query('status')\n    .optional()\n    .isIn(['scheduled', 'confirmed', 'in-progress', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Invalid appointment status'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date')\n], handleValidationErrors, getAllAppointments);\n\n// Update appointment\nrouter.put('/:id', staffOrAdmin, [\n  ...createMongoIdValidation('id'),\n  ...validateAppointmentUpdate\n], handleValidationErrors, updateAppointment);\n\n// Cancel appointment (staff/admin or patient if it's their appointment)\nrouter.patch('/:id/cancel', staffOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('reason')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Cancellation reason must not exceed 500 characters'),\n  body('sendNotification')\n    .optional()\n    .isBoolean()\n    .withMessage('sendNotification must be a boolean')\n], handleValidationErrors, cancelAppointment);\n\n// Reschedule appointment\nrouter.patch('/:id/reschedule', staffOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('newDate')\n    .isISO8601()\n    .withMessage('New date is required and must be a valid date'),\n  body('newTime')\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('New time is required and must be in HH:MM format'),\n  body('reason')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Reschedule reason must not exceed 500 characters'),\n  body('sendNotification')\n    .optional()\n    .isBoolean()\n    .withMessage('sendNotification must be a boolean')\n], handleValidationErrors, rescheduleAppointment);\n\n// Complete appointment\nrouter.patch('/:id/complete', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('notes')\n    .optional()\n    .trim()\n    .isLength({ max: 1000 })\n    .withMessage('Notes must not exceed 1000 characters'),\n  body('treatmentProvided')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Treatment provided must not exceed 500 characters'),\n  body('followUpRequired')\n    .optional()\n    .isBoolean()\n    .withMessage('followUpRequired must be a boolean'),\n  body('followUpDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Follow-up date must be a valid date')\n], handleValidationErrors, completeAppointment);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\authRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'optionalAuth' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  register,\n  login,\n  refreshToken,\n  getCurrentUser,\n  updateProfile,\n  changePassword,\n  requestPasswordReset,\n  resetPassword,\n  logout,\n  validateToken,\n  deactivateAccount,\n  reactivateAccount\n} from '../controllers/authController';\nimport {\n  authenticate,\n  optionalAuth\n} from '../middleware/auth';\nimport {\n  validateUserRegistration,\n  validateUserLogin,\n  validatePasswordChange,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body } from 'express-validator';\nimport { authRateLimit, strictRateLimit } from '../middleware/rateLimiter';\n\nconst router = Router();\n\n// Public routes with rate limiting\nrouter.post('/register', authRateLimit, validateUserRegistration, handleValidationErrors, register);\nrouter.post('/login', authRateLimit, validateUserLogin, handleValidationErrors, login);\nrouter.post('/refresh-token', authRateLimit, refreshToken);\n\n// Password reset routes\nrouter.post('/request-password-reset', [\n  body('email')\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address')\n], handleValidationErrors, requestPasswordReset);\n\nrouter.post('/reset-password', [\n  body('token')\n    .notEmpty()\n    .withMessage('Reset token is required'),\n  body('newPassword')\n    .isLength({ min: 8 })\n    .withMessage('Password must be at least 8 characters long')\n    .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]/)\n    .withMessage('Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character')\n], handleValidationErrors, resetPassword);\n\n// Account reactivation (public)\nrouter.post('/reactivate', [\n  body('email')\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address'),\n  body('password')\n    .notEmpty()\n    .withMessage('Password is required')\n], handleValidationErrors, reactivateAccount);\n\n// Protected routes\nrouter.use(authenticate); // All routes below require authentication\n\n// User profile routes\nrouter.get('/me', strictRateLimit, getCurrentUser);\nrouter.get('/validate', strictRateLimit, validateToken);\nrouter.put('/profile', [\n  body('firstName')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('First name must be between 2 and 50 characters'),\n  body('lastName')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Last name must be between 2 and 50 characters'),\n  body('email')\n    .optional()\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address'),\n  body('phone')\n    .optional()\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n  body('dateOfBirth')\n    .optional()\n    .isISO8601()\n    .withMessage('Please provide a valid date of birth'),\n  body('gender')\n    .optional()\n    .isIn(['male', 'female', 'other'])\n    .withMessage('Gender must be male, female, or other'),\n  body('address')\n    .optional()\n    .trim()\n    .isLength({ max: 200 })\n    .withMessage('Address must not exceed 200 characters')\n], handleValidationErrors, updateProfile);\n\nrouter.put('/change-password', authRateLimit, validatePasswordChange, handleValidationErrors, changePassword);\n\n// Account management\nrouter.post('/logout', logout);\nrouter.put('/deactivate', authRateLimit, [\n  body('password')\n    .notEmpty()\n    .withMessage('Password is required to deactivate account')\n], handleValidationErrors, deactivateAccount);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\billing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\clinicRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3360,3363],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3360,3363],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3370,3373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3370,3373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3381,3384],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3381,3384],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  createClinic,\n  getAllClinics,\n  getClinicById,\n  updateClinic,\n  deleteClinic,\n  getClinicsByCity,\n  getClinicsByService,\n  getNearbyClinic,\n  searchClinics,\n  addStaffToClinic,\n  removeStaffFromClinic,\n  getClinicStaff,\n  uploadClinicImage,\n  getClinicStatistics,\n  getOverallStatistics,\n  checkClinicStatus,\n  getClinicDashboard\n} from '../controllers/clinicController';\nimport {\n  authenticate,\n  adminOnly,\n  staffOrAdmin,\n  checkClinicAccess\n} from '../middleware/auth';\nimport {\n  validateClinicCreation,\n  validateMongoId,\n  validatePagination,\n  createMongoIdValidation,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body, query } from 'express-validator';\nimport { uploadSingle } from '../utils/upload';\n\nconst router = Router();\n\n// Public routes (no authentication required)\nrouter.get('/public', [\n  ...validatePagination.slice(0, -1),\n  query('city')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('City must be at least 2 characters'),\n  query('service')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Service must be at least 2 characters')\n], handleValidationErrors, getAllClinics);\n\nrouter.get('/public/search', [\n  query('q')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search query must be at least 2 characters'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, searchClinics);\n\nrouter.get('/public/nearby', [\n  query('latitude')\n    .isFloat({ min: -90, max: 90 })\n    .withMessage('Latitude must be between -90 and 90'),\n  query('longitude')\n    .isFloat({ min: -180, max: 180 })\n    .withMessage('Longitude must be between -180 and 180'),\n  query('radius')\n    .optional()\n    .isFloat({ min: 0.1, max: 100 })\n    .withMessage('Radius must be between 0.1 and 100 km'),\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 50 })\n    .withMessage('Limit must be between 1 and 50')\n], handleValidationErrors, getNearbyClinic);\n\nrouter.get('/public/city/:city', [\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getClinicsByCity);\n\nrouter.get('/public/service/:service', [\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getClinicsByService);\n\nrouter.get('/public/:id', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getClinicById);\n\nrouter.get('/public/:id/status', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, checkClinicStatus);\n\n// TEMPORARY: Move appointment endpoints here until routing issue is fixed\nrouter.get('/appointments/available-slots', [\n  query('date')\n    .isISO8601()\n    .withMessage('Date is required and must be a valid date'),\n  query('dentistId')\n    .optional()\n    .custom((value) => {\n      if (value === '' || value === undefined || value === null) {\n        return true; // Allow empty values\n      }\n      // If value is provided, validate it's a valid MongoDB ID\n      const mongoIdRegex = /^[0-9a-fA-F]{24}$/;\n      return mongoIdRegex.test(value);\n    })\n    .withMessage('Dentist ID must be valid if provided'),\n  query('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('duration')\n    .optional()\n    .isInt({ min: 15, max: 240 })\n    .withMessage('Duration must be between 15 and 240 minutes')\n], handleValidationErrors, async (req: any, res: any, next: any) => {\n  // Import and use the controller\n  const { getAvailableTimeSlots } = await import('../controllers/appointmentController');\n  return getAvailableTimeSlots(req, res, next);\n});\n\n// Protected routes (authentication required)\nrouter.use(authenticate);\n\n// Create clinic (admin only)\nrouter.post('/', adminOnly, validateClinicCreation, handleValidationErrors, createClinic);\n\n// Get all clinics (staff and admin)\nrouter.get('/', staffOrAdmin, [\n  ...validatePagination.slice(0, -1),\n  query('search')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search term must be at least 2 characters'),\n  query('city')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('City must be at least 2 characters'),\n  query('isActive')\n    .optional()\n    .isBoolean()\n    .withMessage('isActive must be a boolean')\n], handleValidationErrors, getAllClinics);\n\n// Search clinics\nrouter.get('/search', [\n  query('q')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search query must be at least 2 characters'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, searchClinics);\n\n// Get overall statistics for all clinics (admin only)\nrouter.get('/statistics/overall', adminOnly, getOverallStatistics);\n\n// Get clinic statistics (admin only)\nrouter.get('/statistics', adminOnly, getClinicStatistics);\n\n// Get clinic by ID\nrouter.get('/:id', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getClinicById);\n\n// Update clinic\nrouter.put('/:id', adminOnly, [\n  ...createMongoIdValidation('id'),\n  body('name')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('Clinic name must be between 2 and 100 characters'),\n  body('email')\n    .optional()\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address'),\n  body('phone')\n    .optional()\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n  body('address.street')\n    .optional()\n    .trim()\n    .isLength({ min: 5, max: 200 })\n    .withMessage('Street address must be between 5 and 200 characters'),\n  body('address.city')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('City must be between 2 and 100 characters'),\n  body('address.state')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('State must be between 2 and 100 characters'),\n  body('address.zipCode')\n    .optional()\n    .trim()\n    .isLength({ min: 3, max: 20 })\n    .withMessage('Zip code must be between 3 and 20 characters'),\n  body('address.country')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('Country must be between 2 and 100 characters'),\n  body('services')\n    .optional()\n    .isArray()\n    .withMessage('Services must be an array'),\n  body('services.*')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('Each service must be between 2 and 100 characters'),\n  body('operatingHours.*.day')\n    .optional()\n    .isIn(['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'])\n    .withMessage('Invalid day of week'),\n  body('operatingHours.*.openTime')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Open time must be in HH:MM format'),\n  body('operatingHours.*.closeTime')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Close time must be in HH:MM format'),\n  body('operatingHours.*.isClosed')\n    .optional()\n    .isBoolean()\n    .withMessage('isClosed must be a boolean'),\n  body('description')\n    .optional()\n    .trim()\n    .isLength({ max: 1000 })\n    .withMessage('Description must not exceed 1000 characters'),\n  body('website')\n    .optional()\n    .isURL()\n    .withMessage('Please provide a valid website URL'),\n  body('isActive')\n    .optional()\n    .isBoolean()\n    .withMessage('isActive must be a boolean')\n], handleValidationErrors, updateClinic);\n\n// Delete clinic (admin only)\nrouter.delete('/:id', adminOnly, [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, deleteClinic);\n\n// Staff management routes\nrouter.get('/:id/staff', [\n  ...createMongoIdValidation('id'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, checkClinicAccess, getClinicStaff);\n\nrouter.post('/:id/staff/:userId', adminOnly, [\n  ...createMongoIdValidation('id'),\n  ...createMongoIdValidation('userId')\n], handleValidationErrors, addStaffToClinic);\n\nrouter.delete('/:id/staff/:userId', adminOnly, [\n  ...createMongoIdValidation('id'),\n  ...createMongoIdValidation('userId')\n], handleValidationErrors, removeStaffFromClinic);\n\n// Upload clinic image\nrouter.post('/:id/upload-image', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, checkClinicAccess, uploadSingle('clinicImage'), uploadClinicImage);\n\n// Get clinic dashboard data\nrouter.get('/:id/dashboard', [\n  ...createMongoIdValidation('id'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date')\n], handleValidationErrors, checkClinicAccess, getClinicDashboard);\n\n// Check clinic status\nrouter.get('/:id/status', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, checkClinicStatus);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\insuranceClaimRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\insuranceRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\inventoryRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'query' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":28}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  getInventoryItems,\n  getInventoryItem,\n  createInventoryItem,\n  updateInventoryItem,\n  deleteInventoryItem,\n  updateStock,\n  getStockMovements,\n  getLowStockItems,\n  getExpiringItems,\n  getInventoryDashboard,\n  generateInventoryReport\n} from '../controllers/inventoryController';\nimport { authenticate, staffOrAdmin } from '../middleware/auth';\nimport { validateMongoId, handleValidationErrors } from '../middleware/validation';\nimport { body, param, query } from 'express-validator';\n\nconst router = Router();\n\n// All inventory routes require authentication\nrouter.use(authenticate);\n\n// Validation rules\nconst createInventoryValidation = [\n  body('name')\n    .notEmpty()\n    .withMessage('Name is required')\n    .isLength({ max: 100 })\n    .withMessage('Name cannot exceed 100 characters'),\n  body('category')\n    .isIn(['supplies', 'materials', 'equipment', 'medications', 'instruments', 'other'])\n    .withMessage('Invalid category'),\n  body('sku')\n    .notEmpty()\n    .withMessage('SKU is required')\n    .isLength({ max: 20 })\n    .withMessage('SKU cannot exceed 20 characters'),\n  body('clinic')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  body('currentStock')\n    .isFloat({ min: 0 })\n    .withMessage('Current stock must be a positive number'),\n  body('minimumStock')\n    .isFloat({ min: 0 })\n    .withMessage('Minimum stock must be a positive number'),\n  body('unit')\n    .notEmpty()\n    .withMessage('Unit is required'),\n  body('costPrice')\n    .isFloat({ min: 0 })\n    .withMessage('Cost price must be a positive number')\n];\n\nconst updateStockValidation = [\n  param('id')\n    .isMongoId()\n    .withMessage('Valid inventory item ID is required'),\n  body('type')\n    .isIn(['in', 'out', 'adjustment'])\n    .withMessage('Type must be in, out, or adjustment'),\n  body('quantity')\n    .isFloat({ min: 0.01 })\n    .withMessage('Quantity must be greater than 0'),\n  body('reason')\n    .isIn(['purchase', 'usage', 'adjustment', 'expired', 'damaged', 'transfer', 'return', 'other'])\n    .withMessage('Invalid reason')\n];\n\n// Routes\n\n// GET /api/v1/inventory - Get all inventory items\nrouter.get('/', getInventoryItems);\n\n// GET /api/v1/inventory/dashboard - Get dashboard data (admin/staff only)\nrouter.get('/dashboard', staffOrAdmin, getInventoryDashboard);\n\n// GET /api/v1/inventory/low-stock - Get low stock items (admin/staff only)\nrouter.get('/low-stock', staffOrAdmin, getLowStockItems);\n\n// GET /api/v1/inventory/expiring - Get expiring items (admin/staff only)\nrouter.get('/expiring', staffOrAdmin, getExpiringItems);\n\n// GET /api/v1/inventory/movements - Get stock movements (admin/staff only)\nrouter.get('/movements', staffOrAdmin, getStockMovements);\n\n// GET /api/v1/inventory/report - Generate inventory report (admin/staff only)\nrouter.get('/report', staffOrAdmin, generateInventoryReport);\n\n// GET /api/v1/inventory/:id - Get single inventory item\nrouter.get('/:id', \n  param('id').isMongoId().withMessage('Valid inventory item ID is required'),\n  handleValidationErrors,\n  getInventoryItem\n);\n\n// POST /api/v1/inventory - Create new inventory item (admin/staff only)\nrouter.post('/',\n  staffOrAdmin,\n  createInventoryValidation,\n  handleValidationErrors,\n  createInventoryItem\n);\n\n// PUT /api/v1/inventory/:id - Update inventory item (admin/staff only)\nrouter.put('/:id',\n  staffOrAdmin,\n  param('id').isMongoId().withMessage('Valid inventory item ID is required'),\n  handleValidationErrors,\n  updateInventoryItem\n);\n\n// DELETE /api/v1/inventory/:id - Delete inventory item (admin only)\nrouter.delete('/:id',\n  staffOrAdmin, // Consider restricting to admin only\n  param('id').isMongoId().withMessage('Valid inventory item ID is required'),\n  handleValidationErrors,\n  deleteInventoryItem\n);\n\n// POST /api/v1/inventory/:id/stock - Update stock (admin/staff only)\nrouter.post('/:id/stock',\n  staffOrAdmin,\n  updateStockValidation,\n  handleValidationErrors,\n  updateStock\n);\n\nexport default router;\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\medications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\messageRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\notificationRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  getUserNotifications,\n  getUnreadNotificationsCount,\n  getUnreadNotifications,\n  markNotificationAsRead,\n  markNotificationAsUnread,\n  markAllNotificationsAsRead,\n  deleteNotification,\n  deleteAllNotifications,\n  createNotification,\n  createBulkNotifications,\n  getNotificationsByType,\n  getNotificationStatistics,\n  cleanupOldNotifications,\n  getRecentNotifications,\n  getNotificationById,\n  updateNotification\n} from '../controllers/notificationController';\nimport {\n  authenticate,\n  adminOnly\n} from '../middleware/auth';\nimport {\n  validateMongoId,\n  validatePagination,\n  createMongoIdValidation,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body, query } from 'express-validator';\n\nconst router = Router();\n\n// All routes require authentication\nrouter.use(authenticate);\n\n// Get user notifications\nrouter.get('/', [\n  ...validatePagination.slice(0, -1),\n  query('isRead')\n    .optional()\n    .isBoolean()\n    .withMessage('isRead must be a boolean'),\n  query('type')\n    .optional()\n    .isIn(['general', 'appointment_reminder', 'appointment_confirmation', 'appointment_cancellation', 'system'])\n    .withMessage('Invalid notification type')\n], handleValidationErrors, getUserNotifications);\n\n// Get unread notifications count\nrouter.get('/unread/count', getUnreadNotificationsCount);\n\n// Get unread notifications\nrouter.get('/unread', [\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 50 })\n    .withMessage('Limit must be between 1 and 50')\n], handleValidationErrors, getUnreadNotifications);\n\n// Get recent notifications\nrouter.get('/recent', [\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 20 })\n    .withMessage('Limit must be between 1 and 20')\n], handleValidationErrors, getRecentNotifications);\n\n// Get notification statistics\nrouter.get('/statistics', getNotificationStatistics);\n\n// Get notifications by type\nrouter.get('/type/:type', [\n  query('type')\n    .isIn(['general', 'appointment_reminder', 'appointment_confirmation', 'appointment_cancellation', 'system'])\n    .withMessage('Invalid notification type'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getNotificationsByType);\n\n// Mark all notifications as read\nrouter.put('/mark-all-read', markAllNotificationsAsRead);\n\n// Delete all notifications\nrouter.delete('/delete-all', deleteAllNotifications);\n\n// Admin routes for creating notifications\nrouter.post('/', adminOnly, [\n  body('userId')\n    .isMongoId()\n    .withMessage('Valid user ID is required'),\n  body('title')\n    .trim()\n    .notEmpty()\n    .isLength({ min: 1, max: 200 })\n    .withMessage('Title is required and must be between 1 and 200 characters'),\n  body('message')\n    .trim()\n    .notEmpty()\n    .isLength({ min: 1, max: 1000 })\n    .withMessage('Message is required and must be between 1 and 1000 characters'),\n  body('type')\n    .optional()\n    .isIn(['general', 'appointment_reminder', 'appointment_confirmation', 'appointment_cancellation', 'system'])\n    .withMessage('Invalid notification type'),\n  body('link')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Link must not exceed 500 characters')\n], handleValidationErrors, createNotification);\n\n// Create bulk notifications (admin only)\nrouter.post('/bulk', adminOnly, [\n  body('userIds')\n    .isArray({ min: 1 })\n    .withMessage('User IDs array is required and must not be empty'),\n  body('userIds.*')\n    .isMongoId()\n    .withMessage('Each user ID must be valid'),\n  body('title')\n    .trim()\n    .notEmpty()\n    .isLength({ min: 1, max: 200 })\n    .withMessage('Title is required and must be between 1 and 200 characters'),\n  body('message')\n    .trim()\n    .notEmpty()\n    .isLength({ min: 1, max: 1000 })\n    .withMessage('Message is required and must be between 1 and 1000 characters'),\n  body('type')\n    .optional()\n    .isIn(['general', 'appointment_reminder', 'appointment_confirmation', 'appointment_cancellation', 'system'])\n    .withMessage('Invalid notification type'),\n  body('link')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Link must not exceed 500 characters')\n], handleValidationErrors, createBulkNotifications);\n\n// Clean up old notifications (admin only)\nrouter.delete('/cleanup', adminOnly, [\n  query('days')\n    .optional()\n    .isInt({ min: 1, max: 365 })\n    .withMessage('Days must be between 1 and 365')\n], handleValidationErrors, cleanupOldNotifications);\n\n// Get notification by ID\nrouter.get('/:id', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getNotificationById);\n\n// Update notification\nrouter.put('/:id', [\n  ...createMongoIdValidation('id'),\n  body('title')\n    .optional()\n    .trim()\n    .isLength({ min: 1, max: 200 })\n    .withMessage('Title must be between 1 and 200 characters'),\n  body('message')\n    .optional()\n    .trim()\n    .isLength({ min: 1, max: 1000 })\n    .withMessage('Message must be between 1 and 1000 characters'),\n  body('link')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Link must not exceed 500 characters')\n], handleValidationErrors, updateNotification);\n\n// Mark notification as read\nrouter.patch('/:id/read', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, markNotificationAsRead);\n\n// Mark notification as unread\nrouter.patch('/:id/unread', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, markNotificationAsUnread);\n\n// Delete notification\nrouter.delete('/:id', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, deleteNotification);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\patientAppointmentRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\patientMedicalRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\patientRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getPatientMedications' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'checkClinicAccess' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":18}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  createPatient,\n  getPatients,\n  getPatientById,\n  updatePatient,\n  deletePatient,\n  searchPatients,\n  getPatientMedicalHistory,\n  updatePatientMedicalHistory,\n  getPatientsByUserId,\n  getRecentPatients,\n  getPatientStatistics\n} from '../controllers/patientController';\nimport { getPatientMedications } from '../controllers/medicationController';\nimport { \n  getPatientReports, \n  createPatientReport, \n  updatePatientReport, \n  deletePatientReport, \n  getPatientReportById \n} from '../controllers/patientReportController';\nimport {\n  authenticate,\n  staffOrAdmin,\n  dentistOrAdmin,\n  checkClinicAccess,\n  patientOwnerOrStaff,\n  userOwnerOrStaff\n} from '../middleware/auth';\nimport {\n  validatePatientCreation,\n  validateMongoId,\n  validatePagination,\n  createMongoIdValidation,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body, query } from 'express-validator';\n\nconst router = Router();\n\n// All routes require authentication\nrouter.use(authenticate);\n\n// Create patient\nrouter.post('/', staffOrAdmin, validatePatientCreation, handleValidationErrors, createPatient);\n\n// Get all patients\nrouter.get('/', staffOrAdmin, [\n  ...validatePagination.slice(0, -1),\n  query('search')\n    .optional()\n    .trim()\n    .custom((value) => {\n      if (value && value.length > 0 && value.length < 2) {\n        throw new Error('Search term must be at least 2 characters');\n      }\n      return true;\n    })\n    .withMessage('Search term must be at least 2 characters'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('gender')\n    .optional()\n    .isIn(['male', 'female', 'other'])\n    .withMessage('Invalid gender'),\n  query('ageMin')\n    .optional()\n    .isInt({ min: 0, max: 150 })\n    .withMessage('Minimum age must be between 0 and 150'),\n  query('ageMax')\n    .optional()\n    .isInt({ min: 0, max: 150 })\n    .withMessage('Maximum age must be between 0 and 150')\n], handleValidationErrors, getPatients);\n\n// Search patients\nrouter.get('/search', staffOrAdmin, [\n  query('q')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search query must be at least 2 characters'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, searchPatients);\n\n// Get patients by user ID (for patient users to find their own records)\nrouter.get('/user/:userId', userOwnerOrStaff('userId'), [\n  ...createMongoIdValidation('userId'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getPatientsByUserId);\n\n// Get recent patients\nrouter.get('/recent', staffOrAdmin, [\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 100 })\n    .withMessage('Limit must be between 1 and 100')\n], handleValidationErrors, getRecentPatients);\n\n// Get patient statistics\nrouter.get('/statistics', staffOrAdmin, [\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date')\n], handleValidationErrors, getPatientStatistics);\n\n// Get patient by ID (staff/admin or patient themselves)\nrouter.get('/:id', patientOwnerOrStaff('id'), [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getPatientById);\n\n// Update patient (staff/admin or patient themselves)\nrouter.put('/:id', patientOwnerOrStaff('id'), [\n  ...createMongoIdValidation('id'),\n  body('firstName')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('First name must be between 2 and 50 characters'),\n  body('lastName')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Last name must be between 2 and 50 characters'),\n  body('email')\n    .optional()\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address'),\n  body('phone')\n    .optional()\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n  body('dateOfBirth')\n    .optional()\n    .isISO8601()\n    .withMessage('Please provide a valid date of birth'),\n  body('gender')\n    .optional()\n    .isIn(['male', 'female', 'other'])\n    .withMessage('Gender must be male, female, or other'),\n  body('address')\n    .optional()\n    .trim()\n    .isLength({ max: 200 })\n    .withMessage('Address must not exceed 200 characters'),\n  body('emergencyContact.name')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('Emergency contact name must be between 2 and 100 characters'),\n  body('emergencyContact.phone')\n    .optional()\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid emergency contact phone number'),\n  body('emergencyContact.relationship')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Emergency contact relationship must be between 2 and 50 characters'),\n  body('insurance.provider')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 100 })\n    .withMessage('Insurance provider must be between 2 and 100 characters'),\n  body('insurance.policyNumber')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Insurance policy number must be between 2 and 50 characters'),\n  body('insurance.groupNumber')\n    .optional()\n    .trim()\n    .isLength({ max: 50 })\n    .withMessage('Insurance group number must not exceed 50 characters'),\n  body('userId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid user ID')\n], handleValidationErrors, updatePatient);\n\n// Delete patient\nrouter.delete('/:id', staffOrAdmin, [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, deletePatient);\n\n// Medical history routes (staff/admin or patient themselves)\nrouter.get('/:id/medical-history', patientOwnerOrStaff('id'), [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getPatientMedicalHistory);\n\n// Update patient medical history\nrouter.put('/:id/medical-history', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('medicalHistory')\n    .optional()\n    .isObject()\n    .withMessage('Medical history must be an object'),\n  body('allergies')\n    .optional()\n    .isArray()\n    .withMessage('Allergies must be an array'),\n  body('currentMedications')\n    .optional()\n    .isArray()\n    .withMessage('Current medications must be an array')\n], handleValidationErrors, updatePatientMedicalHistory);\n\n// Patient reports routes\n// Get patient reports\nrouter.get('/:id/reports', patientOwnerOrStaff('id'), [\n  ...createMongoIdValidation('id'),\n  query('page')\n    .optional()\n    .isInt({ min: 1 })\n    .withMessage('Page must be a positive integer'),\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 100 })\n    .withMessage('Limit must be between 1 and 100'),\n  query('search')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search term must be at least 2 characters')\n], handleValidationErrors, getPatientReports);\n\n// Create patient report\nrouter.post('/:id/reports', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('title')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 2, max: 200 })\n    .withMessage('Title must be between 2 and 200 characters'),\n  body('description')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 10, max: 2000 })\n    .withMessage('Description must be between 10 and 2000 characters'),\n  body('date')\n    .optional()\n    .isISO8601()\n    .withMessage('Date must be a valid date'),\n  body('attachments')\n    .optional()\n    .isArray()\n    .withMessage('Attachments must be an array'),\n  body('isShared')\n    .optional()\n    .isBoolean()\n    .withMessage('isShared must be a boolean')\n], handleValidationErrors, createPatientReport);\n\n// Get specific report by ID\nrouter.get('/reports/:reportId', [\n  ...createMongoIdValidation('reportId')\n], handleValidationErrors, getPatientReportById);\n\n// Update patient report\nrouter.put('/reports/:reportId', [\n  ...createMongoIdValidation('reportId'),\n  body('title')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 200 })\n    .withMessage('Title must be between 2 and 200 characters'),\n  body('description')\n    .optional()\n    .trim()\n    .isLength({ min: 10, max: 2000 })\n    .withMessage('Description must be between 10 and 2000 characters'),\n  body('date')\n    .optional()\n    .isISO8601()\n    .withMessage('Date must be a valid date'),\n  body('attachments')\n    .optional()\n    .isArray()\n    .withMessage('Attachments must be an array'),\n  body('isShared')\n    .optional()\n    .isBoolean()\n    .withMessage('isShared must be a boolean')\n], handleValidationErrors, updatePatientReport);\n\n// Delete patient report\nrouter.delete('/reports/:reportId', [\n  ...createMongoIdValidation('reportId')\n], handleValidationErrors, deletePatientReport);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\paymentRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\prescriptions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\reminderRoutes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\schedules.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\staffScheduleRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'param' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  createStaffSchedule,\n  getStaffSchedules,\n  getStaffScheduleById,\n  updateStaffSchedule,\n  deleteStaffSchedule,\n  getStaffAvailability,\n  getScheduleAnalytics\n} from '../controllers/staffScheduleController';\nimport {\n  authenticate,\n  staffOrAdmin\n} from '../middleware/auth';\nimport {\n  body,\n  query,\n  param\n} from 'express-validator';\nimport {\n  handleValidationErrors,\n  createMongoIdValidation,\n  validatePagination\n} from '../middleware/validation';\n\nconst router = Router();\n\n// All routes require authentication\nrouter.use(authenticate);\n\n// Create staff schedule\nrouter.post('/', [\n  body('staffId')\n    .isMongoId()\n    .withMessage('Valid staff ID is required'),\n  body('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  body('date')\n    .isISO8601()\n    .withMessage('Valid date is required'),\n  body('startTime')\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Valid start time is required (HH:MM format)'),\n  body('endTime')\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Valid end time is required (HH:MM format)'),\n  body('shiftType')\n    .isIn(['morning', 'afternoon', 'evening', 'night', 'full-day'])\n    .withMessage('Valid shift type is required'),\n  body('notes')\n    .optional()\n    .isLength({ max: 500 })\n    .withMessage('Notes cannot exceed 500 characters'),\n  body('isRecurring')\n    .optional()\n    .isBoolean()\n    .withMessage('isRecurring must be a boolean'),\n  body('recurringPattern.frequency')\n    .if(body('isRecurring').equals('true'))\n    .isIn(['daily', 'weekly', 'monthly'])\n    .withMessage('Valid frequency is required for recurring schedules'),\n  body('recurringPattern.daysOfWeek')\n    .optional()\n    .isArray()\n    .withMessage('Days of week must be an array'),\n  body('recurringPattern.daysOfWeek.*')\n    .optional()\n    .isInt({ min: 0, max: 6 })\n    .withMessage('Days of week must be integers between 0-6'),\n  body('recurringPattern.endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Valid end date is required')\n], handleValidationErrors, staffOrAdmin, createStaffSchedule);\n\n// Get staff schedules with filtering\nrouter.get('/', [\n  ...validatePagination,\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('staffId')\n    .optional()\n    .isMongoId()\n    .withMessage('Valid staff ID is required'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Valid start date is required'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Valid end date is required'),\n  query('status')\n    .optional()\n    .isIn(['scheduled', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Valid status is required'),\n  query('shiftType')\n    .optional()\n    .isIn(['morning', 'afternoon', 'evening', 'night', 'full-day'])\n    .withMessage('Valid shift type is required')\n], handleValidationErrors, getStaffSchedules);\n\n// Get staff availability\nrouter.get('/availability', [\n  query('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  query('date')\n    .isISO8601()\n    .withMessage('Valid date is required')\n], handleValidationErrors, getStaffAvailability);\n\n// Get schedule analytics for a clinic\nrouter.get('/analytics/:clinicId', [\n  ...createMongoIdValidation('clinicId'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Valid start date is required'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Valid end date is required')\n], handleValidationErrors, staffOrAdmin, getScheduleAnalytics);\n\n// Get staff schedule by ID\nrouter.get('/:id', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getStaffScheduleById);\n\n// Update staff schedule\nrouter.put('/:id', [\n  ...createMongoIdValidation('id'),\n  body('date')\n    .optional()\n    .isISO8601()\n    .withMessage('Valid date is required'),\n  body('startTime')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Valid start time is required (HH:MM format)'),\n  body('endTime')\n    .optional()\n    .matches(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)\n    .withMessage('Valid end time is required (HH:MM format)'),\n  body('shiftType')\n    .optional()\n    .isIn(['morning', 'afternoon', 'evening', 'night', 'full-day'])\n    .withMessage('Valid shift type is required'),\n  body('status')\n    .optional()\n    .isIn(['scheduled', 'completed', 'cancelled', 'no-show'])\n    .withMessage('Valid status is required'),\n  body('notes')\n    .optional()\n    .isLength({ max: 500 })\n    .withMessage('Notes cannot exceed 500 characters')\n], handleValidationErrors, staffOrAdmin, updateStaffSchedule);\n\n// Delete staff schedule\nrouter.delete('/:id', [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, staffOrAdmin, deleteStaffSchedule);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\supplierRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  getSuppliers,\n  getSupplier,\n  createSupplier,\n  updateSupplier,\n  deleteSupplier,\n  getActiveSuppliers,\n  getSupplierPerformance,\n  updateSupplierRating,\n  getSuppliersDashboard,\n  importSuppliers,\n  exportSuppliers\n} from '../controllers/supplierController';\nimport { authenticate, staffOrAdmin } from '../middleware/auth';\nimport { validateMongoId, handleValidationErrors } from '../middleware/validation';\nimport { body, param } from 'express-validator';\n\nconst router = Router();\n\n// All supplier routes require authentication\nrouter.use(authenticate);\n\n// Validation rules\nconst createSupplierValidation = [\n  body('name')\n    .notEmpty()\n    .withMessage('Supplier name is required')\n    .isLength({ max: 100 })\n    .withMessage('Supplier name cannot exceed 100 characters'),\n  body('email')\n    .optional()\n    .isEmail()\n    .withMessage('Valid email is required'),\n  body('phone')\n    .optional()\n    .isLength({ max: 20 })\n    .withMessage('Phone number cannot exceed 20 characters'),\n  body('website')\n    .optional()\n    .isURL()\n    .withMessage('Valid website URL is required'),\n  body('rating')\n    .optional()\n    .isFloat({ min: 1, max: 5 })\n    .withMessage('Rating must be between 1 and 5'),\n  body('creditLimit')\n    .optional()\n    .isFloat({ min: 0 })\n    .withMessage('Credit limit must be positive')\n];\n\nconst updateRatingValidation = [\n  param('id')\n    .isMongoId()\n    .withMessage('Valid supplier ID is required'),\n  body('rating')\n    .isFloat({ min: 1, max: 5 })\n    .withMessage('Rating must be between 1 and 5')\n];\n\n// Routes\n\n// GET /api/v1/suppliers - Get all suppliers\nrouter.get('/', getSuppliers);\n\n// GET /api/v1/suppliers/active - Get active suppliers (for dropdowns)\nrouter.get('/active', getActiveSuppliers);\n\n// GET /api/v1/suppliers/dashboard - Get suppliers dashboard data (admin/staff only)\nrouter.get('/dashboard', staffOrAdmin, getSuppliersDashboard);\n\n// GET /api/v1/suppliers/performance - Get all suppliers performance\nrouter.get('/performance', staffOrAdmin, getSupplierPerformance);\n\n// POST /api/v1/suppliers/import - Import suppliers from CSV (admin/staff only)\nrouter.post('/import', staffOrAdmin, importSuppliers);\n\n// GET /api/v1/suppliers/export - Export suppliers to CSV (admin/staff only)\nrouter.get('/export', staffOrAdmin, exportSuppliers);\n\n// GET /api/v1/suppliers/:id - Get single supplier\nrouter.get('/:id',\n  param('id').isMongoId().withMessage('Valid supplier ID is required'),\n  handleValidationErrors,\n  getSupplier\n);\n\n// GET /api/v1/suppliers/:supplierId/performance - Get specific supplier performance\nrouter.get('/:supplierId/performance',\n  param('supplierId').isMongoId().withMessage('Valid supplier ID is required'),\n  handleValidationErrors,\n  getSupplierPerformance\n);\n\n// POST /api/v1/suppliers - Create new supplier (admin/staff only)\nrouter.post('/',\n  staffOrAdmin,\n  createSupplierValidation,\n  handleValidationErrors,\n  createSupplier\n);\n\n// PUT /api/v1/suppliers/:id - Update supplier (admin/staff only)\nrouter.put('/:id',\n  staffOrAdmin,\n  param('id').isMongoId().withMessage('Valid supplier ID is required'),\n  handleValidationErrors,\n  updateSupplier\n);\n\n// DELETE /api/v1/suppliers/:id - Delete supplier (admin only)\nrouter.delete('/:id',\n  staffOrAdmin, // Consider restricting to admin only\n  param('id').isMongoId().withMessage('Valid supplier ID is required'),\n  handleValidationErrors,\n  deleteSupplier\n);\n\n// PUT /api/v1/suppliers/:id/rating - Update supplier rating (admin/staff only)\nrouter.put('/:id/rating',\n  staffOrAdmin,\n  updateRatingValidation,\n  handleValidationErrors,\n  updateSupplierRating\n);\n\nexport default router;\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\treatmentRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateMongoId' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  createTreatmentRecord,\n  getAllTreatmentRecords,\n  getTreatmentRecordById,\n  updateTreatmentRecord,\n  deleteTreatmentRecord,\n  getTreatmentRecordsByPatient,\n  getTreatmentRecordsByDentist,\n  getTreatmentRecordsByClinic,\n  getTreatmentRecordsByDateRange,\n  getRecentTreatmentRecords,\n  searchTreatmentRecords,\n  addAttachment,\n  removeAttachment,\n  getTreatmentStatistics\n} from '../controllers/treatmentController';\nimport {\n  authenticate,\n  staffOrAdmin,\n  dentistOrAdmin,\n  checkClinicAccess\n} from '../middleware/auth';\nimport {\n  validateMongoId,\n  validatePagination,\n  validateDateRange,\n  createMongoIdValidation,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body, query } from 'express-validator';\nimport { uploadSingle } from '../utils/upload';\n\nconst router = Router();\n\n// All routes require authentication\nrouter.use(authenticate);\n\n// Create treatment record\nrouter.post('/', dentistOrAdmin, [\n  body('patientId')\n    .isMongoId()\n    .withMessage('Valid patient ID is required'),\n  body('date')\n    .isISO8601()\n    .withMessage('Treatment date is required and must be a valid date'),\n  body('dentistId')\n    .isMongoId()\n    .withMessage('Valid dentist ID is required'),\n  body('clinicId')\n    .isMongoId()\n    .withMessage('Valid clinic ID is required'),\n  body('procedure')\n    .trim()\n    .notEmpty()\n    .isLength({ min: 2, max: 200 })\n    .withMessage('Procedure must be between 2 and 200 characters'),\n  body('diagnosis')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Diagnosis must not exceed 500 characters'),\n  body('notes')\n    .optional()\n    .trim()\n    .isLength({ max: 1000 })\n    .withMessage('Notes must not exceed 1000 characters')\n], handleValidationErrors, createTreatmentRecord);\n\n// Get all treatment records\nrouter.get('/', staffOrAdmin, [\n  ...validatePagination.slice(0, -1),\n  query('patientId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid patient ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('procedure')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Procedure search must be at least 2 characters')\n], handleValidationErrors, getAllTreatmentRecords);\n\n// Search treatment records\nrouter.get('/search', staffOrAdmin, [\n  query('q')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search query must be at least 2 characters'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, searchTreatmentRecords);\n\n// Get treatment statistics\nrouter.get('/statistics', staffOrAdmin, [\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID')\n], handleValidationErrors, getTreatmentStatistics);\n\n// Get recent treatment records\nrouter.get('/recent', staffOrAdmin, [\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 50 })\n    .withMessage('Limit must be between 1 and 50'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID')\n], handleValidationErrors, getRecentTreatmentRecords);\n\n// Get treatment records by date range\nrouter.get('/date-range', staffOrAdmin, [\n  ...validateDateRange.slice(0, -1),\n  query('patientId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid patient ID'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  ...validatePagination.slice(0, -1)\n], handleValidationErrors, getTreatmentRecordsByDateRange);\n\n// Get treatment records by patient\nrouter.get('/patient/:patientId', staffOrAdmin, [\n  ...createMongoIdValidation('patientId'),\n  ...validatePagination.slice(0, -1),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date')\n], handleValidationErrors, getTreatmentRecordsByPatient);\n\n// Get treatment records by dentist\nrouter.get('/dentist/:dentistId', staffOrAdmin, [\n  ...createMongoIdValidation('dentistId'),\n  ...validatePagination.slice(0, -1),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID')\n], handleValidationErrors, getTreatmentRecordsByDentist);\n\n// Get treatment records by clinic\nrouter.get('/clinic/:clinicId', staffOrAdmin, [\n  ...createMongoIdValidation('clinicId'),\n  ...validatePagination.slice(0, -1),\n  query('startDate')\n    .optional()\n    .isISO8601()\n    .withMessage('Start date must be a valid date'),\n  query('endDate')\n    .optional()\n    .isISO8601()\n    .withMessage('End date must be a valid date'),\n  query('dentistId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid dentist ID')\n], handleValidationErrors, checkClinicAccess, getTreatmentRecordsByClinic);\n\n// Get treatment record by ID\nrouter.get('/:id', staffOrAdmin, [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, getTreatmentRecordById);\n\n// Update treatment record\nrouter.put('/:id', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('date')\n    .optional()\n    .isISO8601()\n    .withMessage('Treatment date must be a valid date'),\n  body('procedure')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 200 })\n    .withMessage('Procedure must be between 2 and 200 characters'),\n  body('diagnosis')\n    .optional()\n    .trim()\n    .isLength({ max: 500 })\n    .withMessage('Diagnosis must not exceed 500 characters'),\n  body('notes')\n    .optional()\n    .trim()\n    .isLength({ max: 1000 })\n    .withMessage('Notes must not exceed 1000 characters')\n], handleValidationErrors, updateTreatmentRecord);\n\n// Delete treatment record\nrouter.delete('/:id', dentistOrAdmin, [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, deleteTreatmentRecord);\n\n// Add attachment to treatment record\nrouter.post('/:id/attachments', dentistOrAdmin, [\n  ...createMongoIdValidation('id')\n], handleValidationErrors, uploadSingle('attachment'), addAttachment);\n\n// Remove attachment from treatment record\nrouter.delete('/:id/attachments/:attachmentId', dentistOrAdmin, [\n  ...createMongoIdValidation('id'),\n  body('attachmentId')\n    .notEmpty()\n    .withMessage('Attachment ID is required')\n], handleValidationErrors, removeAttachment);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\userRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'authorize' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'dentistOrAdmin' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":17}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router } from 'express';\nimport {\n  getAllUsers,\n  getUserById,\n  updateUser,\n  deleteUser,\n  getUsersByRole,\n  getDentists,\n  assignClinicToUser,\n  removeClinicFromUser,\n  setPreferredClinic,\n  getUserClinics,\n  getUserAvailability,\n  updateUserAvailability,\n  uploadUserProfileImage,\n  getUserStatistics,\n  searchUsers,\n  getRecentUsers\n} from '../controllers/userController';\nimport {\n  authenticate,\n  authorize,\n  adminOnly,\n  dentistOrAdmin,\n  staffOrAdmin\n} from '../middleware/auth';\nimport {\n  validateMongoId,\n  validatePagination,\n  handleValidationErrors\n} from '../middleware/validation';\nimport { body, query } from 'express-validator';\nimport { uploadSingle } from '../utils/upload';\n\nconst router = Router();\n\n// All routes require authentication\nrouter.use(authenticate);\n\n// Get all users (admin/staff only)\nrouter.get('/', staffOrAdmin, [\n  ...validatePagination.slice(0, -1), // Remove handleValidationErrors from validatePagination\n  query('search')\n    .optional()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search term must be at least 2 characters'),\n  query('role')\n    .optional()\n    .isIn(['admin', 'dentist', 'staff', 'patient'])\n    .withMessage('Invalid role'),\n  query('isActive')\n    .optional()\n    .isBoolean()\n    .withMessage('isActive must be a boolean'),\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  handleValidationErrors\n], getAllUsers);\n\n// Search users\nrouter.get('/search', staffOrAdmin, [\n  query('q')\n    .notEmpty()\n    .trim()\n    .isLength({ min: 2 })\n    .withMessage('Search query must be at least 2 characters'),\n  ...validatePagination.slice(0, -1),\n  handleValidationErrors\n], searchUsers);\n\n// Get user statistics (admin only)\nrouter.get('/statistics', adminOnly, getUserStatistics);\n\n// Get recent users (admin only)\nrouter.get('/recent', adminOnly, [\n  query('limit')\n    .optional()\n    .isInt({ min: 1, max: 50 })\n    .withMessage('Limit must be between 1 and 50')\n], handleValidationErrors, getRecentUsers);\n\n// Get users by role\nrouter.get('/role/:role', staffOrAdmin, [\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  query('isActive')\n    .optional()\n    .isBoolean()\n    .withMessage('isActive must be a boolean'),\n  ...validatePagination.slice(0, -1),\n  handleValidationErrors\n], getUsersByRole);\n\n// Get dentists (authenticated users) - allow all authenticated users to fetch dentist list\nrouter.get('/dentists', [\n  query('clinicId')\n    .optional()\n    .isMongoId()\n    .withMessage('Invalid clinic ID'),\n  handleValidationErrors\n], getDentists);\n\n// Upload profile image\nrouter.post('/upload-image', uploadSingle('profileImage'), uploadUserProfileImage);\n\n// Add alias route for frontend compatibility\nrouter.post('/profile-image', uploadSingle('profileImage'), uploadUserProfileImage);\n\n// Upload profile image with user ID in URL (for dentist service compatibility)\nrouter.post('/:id/upload-image', validateMongoId, uploadSingle('profileImage'), uploadUserProfileImage);\n\n// Get user by ID\nrouter.get('/:id', validateMongoId, getUserById);\n\n// Get user's assigned clinics\nrouter.get('/:id/clinics', validateMongoId, getUserClinics);\n\n// Get user's availability schedule\nrouter.get('/:id/availability', validateMongoId, getUserAvailability);\n\n// Update user's availability schedule\nrouter.put('/:id/availability', validateMongoId, updateUserAvailability);\n\n// Update user (admin only or self)\nrouter.put('/:id', [\n  ...validateMongoId,\n  body('firstName')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('First name must be between 2 and 50 characters'),\n  body('lastName')\n    .optional()\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Last name must be between 2 and 50 characters'),\n  body('email')\n    .optional()\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address'),\n  body('phone')\n    .optional()\n    .isMobilePhone('any')\n    .withMessage('Please provide a valid phone number'),\n  body('role')\n    .optional()\n    .isIn(['admin', 'dentist', 'staff', 'patient'])\n    .withMessage('Invalid role'),\n  body('dateOfBirth')\n    .optional()\n    .isISO8601()\n    .withMessage('Please provide a valid date of birth'),\n  body('gender')\n    .optional()\n    .isIn(['male', 'female', 'other'])\n    .withMessage('Gender must be male, female, or other'),\n  body('address')\n    .optional()\n    .trim()\n    .isLength({ max: 200 })\n    .withMessage('Address must not exceed 200 characters'),\n  body('isActive')\n    .optional()\n    .isBoolean()\n    .withMessage('isActive must be a boolean')\n], handleValidationErrors, updateUser);\n\n// Delete user (admin only)\nrouter.delete('/:id', adminOnly, validateMongoId, deleteUser);\n\n// Clinic assignment routes (admin only)\nrouter.post('/:id/clinics/:clinicId', adminOnly, [\n  ...validateMongoId\n], handleValidationErrors, assignClinicToUser);\n\nrouter.delete('/:id/clinics/:clinicId', adminOnly, [\n  ...validateMongoId\n], handleValidationErrors, removeClinicFromUser);\n\n// Set preferred clinic\nrouter.put('/:id/preferred-clinic', [\n  ...validateMongoId,\n  body('clinicId')\n    .isMongoId()\n    .withMessage('Invalid clinic ID')\n], handleValidationErrors, setPreferredClinic);\n\nexport default router;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\routes\\webhookRoutes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppError' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1632,1635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1632,1635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3474,3477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3474,3477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3737,3740],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3737,3740],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":122,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3790,3793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3790,3793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4329,4332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4329,4332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5114,5117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5114,5117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5167,5170],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5167,5170],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6188,6191],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6188,6191],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":204,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6241,6244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6241,6244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6856,6859],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6856,6859],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":229,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":229,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7083,7086],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7083,7086],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7238,7241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7238,7241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7291,7294],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7291,7294],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":250,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7732,7735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7732,7735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":276,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8522,8525],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8522,8525],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":278,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":278,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8575,8578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8575,8578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":311,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":311,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9534,9537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9534,9537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Router, Request, Response } from 'express';\nimport { StripeService } from '../services/StripeService';\nimport { PayPalService } from '../services/PayPalService';\nimport { Payment, Billing } from '../models';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\nimport { AppError } from '../middleware/errorHandler';\n\nconst router = Router();\n\n// Stripe webhook handler\nrouter.post('/stripe', async (req: Request, res: Response): Promise<void> => {\n  const signature = req.headers['stripe-signature'] as string;\n  const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET!;\n\n  if (!signature || !webhookSecret) {\n    res.status(400).json({\n      success: false,\n      message: 'Missing stripe signature or webhook secret'\n    });\n    return;\n  }\n  \n  try {\n    const stripeService = new StripeService();\n    const event = stripeService.constructEvent(req.body, signature, webhookSecret);\n\n    console.log(`Stripe webhook received: ${event.type}`);\n\n    switch (event.type) {\n      case 'payment_intent.succeeded':\n        await handleStripePaymentSuccess(event.data.object);\n        break;\n      \n      case 'payment_intent.payment_failed':\n        await handleStripePaymentFailed(event.data.object);\n        break;\n      \n      case 'charge.dispute.created':\n        await handleStripeDispute(event.data.object);\n        break;\n      \n      case 'invoice.payment_succeeded':\n        await handleStripeSubscriptionPayment(event.data.object);\n        break;\n      \n      default:\n        console.log(`Unhandled Stripe event type: ${event.type}`);\n    }\n\n    res.json({ received: true });\n  } catch (error: any) {\n    console.error('Stripe webhook error:', error.message);\n    res.status(400).json({\n      success: false,\n      message: `Webhook error: ${error.message}`\n    });\n  }\n});\n\n// PayPal webhook handler\nrouter.post('/paypal', async (req: Request, res: Response) => {\n  try {\n    const headers = req.headers;\n    const body = req.body;\n\n    // Verify PayPal webhook signature\n    const paypalService = new PayPalService();\n    \n    const verificationData = {\n      authAlgo: headers['paypal-auth-algo'] as string,\n      transmission_id: headers['paypal-transmission-id'] as string,\n      cert_id: headers['paypal-cert-id'] as string,\n      payload: JSON.stringify(body),\n      transmission_time: headers['paypal-transmission-time'] as string,\n      webhook_id: process.env.PAYPAL_WEBHOOK_ID!,\n      webhook_event: body\n    };\n\n    if (process.env.NODE_ENV === 'production') {\n      const verification = await paypalService.verifyWebhookSignature(verificationData);\n      if (verification.verification_status !== 'SUCCESS') {\n        throw new Error('PayPal webhook verification failed');\n      }\n    }\n\n    console.log(`PayPal webhook received: ${body.event_type}`);\n\n    switch (body.event_type) {\n      case 'CHECKOUT.ORDER.APPROVED':\n        await handlePayPalOrderApproved(body.resource);\n        break;\n      \n      case 'PAYMENT.CAPTURE.COMPLETED':\n        await handlePayPalPaymentCompleted(body.resource);\n        break;\n      \n      case 'PAYMENT.CAPTURE.DENIED':\n        await handlePayPalPaymentFailed(body.resource);\n        break;\n      \n      case 'BILLING.SUBSCRIPTION.ACTIVATED':\n        await handlePayPalSubscriptionActivated(body.resource);\n        break;\n      \n      default:\n        console.log(`Unhandled PayPal event type: ${body.event_type}`);\n    }\n\n    res.status(200).json({ success: true });\n  } catch (error: any) {\n    console.error('PayPal webhook error:', error.message);\n    res.status(400).json({\n      success: false,\n      message: `Webhook error: ${error.message}`\n    });\n  }\n});\n\n// Stripe event handlers\nasync function handleStripePaymentSuccess(paymentIntent: any) {\n  try {\n    const payment = await (Payment as any).findOne({ paymentIntentId: paymentIntent.id });\n    if (!payment) {\n      console.error(`Payment not found for Stripe PaymentIntent: ${paymentIntent.id}`);\n      return;\n    }\n\n    // Update payment status\n    payment.status = 'completed';\n    payment.transactionId = paymentIntent.charges?.data[0]?.id;\n    payment.paidAt = new Date();\n    \n    if (paymentIntent.receipt_url) {\n      payment.receiptUrl = paymentIntent.receipt_url;\n    }\n\n    await payment.save();\n\n    // Update billing status\n    const billing = await (Billing as any).findById(payment.billingId);\n    if (billing) {\n      billing.paymentStatus = 'paid';\n      billing.paidAmount = payment.amount;\n        billing.paidDate = new Date();\n      await billing.save();\n    }\n\n    // Send notification to patient\n    await createAndSendNotification({\n      userId: payment.patientId.toString(),\n      title: 'Payment Successful',\n      message: `Your payment of $${payment.amount} has been processed successfully`,\n      type: 'payment_success',\n      link: `/billing/invoices/${billing?.invoiceNumber}`,\n      metadata: {\n        paymentId: payment._id,\n        amount: payment.amount\n      }\n    });\n\n  } catch (error) {\n    console.error('Error handling Stripe payment success:', error);\n  }\n}\n\nasync function handleStripePaymentFailed(paymentIntent: any) {\n  try {\n    const payment = await (Payment as any).findOne({ paymentIntentId: paymentIntent.id });\n    if (!payment) {\n      console.error(`Payment not found for Stripe PaymentIntent: ${paymentIntent.id}`);\n      return;\n    }\n\n    // Update payment status\n    payment.status = 'failed';\n    payment.failedAt = new Date();\n    payment.gatewayResponse = {\n      ...payment.gatewayResponse,\n      error: paymentIntent.last_payment_error?.message || 'Payment failed'\n    };\n\n    await payment.save();\n\n    // Send notification to patient\n    await createAndSendNotification({\n      userId: payment.patientId.toString(),\n      title: 'Payment Failed',\n      message: `Your payment of $${payment.amount} could not be processed. Please try again.`,\n      type: 'payment_failed',\n      metadata: {\n        paymentId: payment._id,\n        amount: payment.amount,\n        error: paymentIntent.last_payment_error?.message\n      }\n    });\n\n  } catch (error) {\n    console.error('Error handling Stripe payment failure:', error);\n  }\n}\n\nasync function handleStripeDispute(charge: any) {\n  try {\n    const payment = await (Payment as any).findOne({ transactionId: charge.id });\n    if (payment) {\n      // Send notification to admin about dispute\n      await createAndSendNotification({\n        userId: 'admin', // You might want to get actual admin user IDs\n        title: 'Payment Dispute',\n        message: `A dispute has been created for payment $${payment.amount}`,\n        type: 'system',\n        metadata: {\n          paymentId: payment._id,\n          disputeId: charge.id\n        }\n      });\n    }\n  } catch (error) {\n    console.error('Error handling Stripe dispute:', error);\n  }\n}\n\nasync function handleStripeSubscriptionPayment(invoice: any) {\n  // Handle subscription payments if you implement subscription features\n  console.log('Stripe subscription payment received:', invoice.id);\n}\n\n// PayPal event handlers\nasync function handlePayPalOrderApproved(resource: any) {\n  console.log('PayPal order approved:', resource.id);\n  // Handle order approval if needed\n}\n\nasync function handlePayPalPaymentCompleted(resource: any) {\n  try {\n    const payment = await (Payment as any).findOne({ paymentIntentId: resource.supplementary_data?.related_ids?.order_id });\n    if (!payment) {\n      console.error(`Payment not found for PayPal capture: ${resource.id}`);\n      return;\n    }\n\n    // Update payment status\n    payment.status = 'completed';\n    payment.transactionId = resource.id;\n    payment.paidAt = new Date();\n    \n    await payment.save();\n\n    // Update billing status\n    const billing = await (Billing as any).findById(payment.billingId);\n    if (billing) {\n      billing.paymentStatus = 'paid';\n      billing.paidAmount = payment.amount;\n        billing.paidDate = new Date();\n      await billing.save();\n    }\n\n    // Send notification to patient\n    await createAndSendNotification({\n      userId: payment.patientId.toString(),\n      title: 'Payment Successful',\n      message: `Your PayPal payment of $${payment.amount} has been processed successfully`,\n      type: 'payment_success',\n      link: `/billing/invoices/${billing?.invoiceNumber}`,\n      metadata: {\n        paymentId: payment._id,\n        amount: payment.amount\n      }\n    });\n\n  } catch (error) {\n    console.error('Error handling PayPal payment completion:', error);\n  }\n}\n\nasync function handlePayPalPaymentFailed(resource: any) {\n  try {\n    const payment = await (Payment as any).findOne({ paymentIntentId: resource.supplementary_data?.related_ids?.order_id });\n    if (!payment) {\n      console.error(`Payment not found for PayPal capture: ${resource.id}`);\n      return;\n    }\n\n    // Update payment status\n    payment.status = 'failed';\n    payment.failedAt = new Date();\n    payment.gatewayResponse = {\n      ...payment.gatewayResponse,\n      error: 'PayPal payment denied'\n    };\n\n    await payment.save();\n\n    // Send notification to patient\n    await createAndSendNotification({\n      userId: payment.patientId.toString(),\n      title: 'Payment Failed',\n      message: `Your PayPal payment of $${payment.amount} was denied. Please try again.`,\n      type: 'payment_failed',\n      metadata: {\n        paymentId: payment._id,\n        amount: payment.amount\n      }\n    });\n\n  } catch (error) {\n    console.error('Error handling PayPal payment failure:', error);\n  }\n}\n\nasync function handlePayPalSubscriptionActivated(resource: any) {\n  // Handle subscription activation if you implement subscription features\n  console.log('PayPal subscription activated:', resource.id);\n}\n\nexport default router;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\scripts\\seedMultiBranchData.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[923,926],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[923,926],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1522,1525],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1522,1525],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1640,1643],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1640,1643],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2922,2925],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2922,2925],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3037,3040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3037,3040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4303,4306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4303,4306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4418,4421],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4418,4421],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6305,6308],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6305,6308],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":159,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6518,6521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6518,6521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6606,6609],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6606,6609],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7204,7207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7204,7207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7417,7420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7417,7420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7505,7508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7505,7508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":201,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":201,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8078,8081],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8078,8081],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":206,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8231,8234],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8231,8234],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":208,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8315,8318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8315,8318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8873,8876],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8873,8876],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":229,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":229,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9026,9029],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9026,9029],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9110,9113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9110,9113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":496,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":496,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16011,16014],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16011,16014],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from 'mongoose';\nimport { config } from 'dotenv';\nimport { User } from '../models';\nimport DoctorSchedule from '../models/DoctorSchedule';\nimport Clinic from '../models/Clinic';\n\nconfig();\n\nconst MONGODB_URI = process.env.MONGODB_URI ||\n  'mongodb+srv://mohamedabdelnasser0123:pyyd9JSaA2wTUYzT@cluster0.ohipm4r.mongodb.net/smartclinic?retryWrites=true&w=majority&appName=Cluster0';\n\n/**\n * Seed data for 3 clinic branches with doctor schedules\n * Based on user requirements:\n * - Fayoum Branch (Clear): Daily 11 AM - 11 PM\n * - Atesa Branch: All days except Friday, 12 PM - 11 PM\n * - Minya Branch: All days except Friday, 11 AM - 11 PM\n */\n\nconst seedMultiBranchData = async () => {\n  try {\n    console.log(' Connecting to MongoDB...');\n    await mongoose.connect(MONGODB_URI);\n    console.log(' Connected to MongoDB');\n\n    console.log('\\n  Clearing existing data...');\n    await (DoctorSchedule as any).deleteMany({});\n    // Note: Not deleting clinics and users to preserve existing data\n    // If you want fresh data, uncomment the lines below:\n    // await Clinic.deleteMany({});\n    // await User.deleteMany({ role: 'dentist' });\n\n    console.log(' Cleared existing schedules');\n\n    // =====================================================\n    // STEP 1: Create or Update Clinics with Branch Names\n    // =====================================================\n    console.log('\\n Creating/Updating clinic branches...');\n\n    // Fayoum Branch (Clear)\n    let fayoumClinic = await (Clinic as any).findOne({ name: 'Clear', branchName: 'Fayoum' });\n    if (!fayoumClinic) {\n      fayoumClinic = await (Clinic as any).create({\n        name: 'Clear',\n        branchName: 'Fayoum',\n        email: 'fayoum@cleardentalclinic.com',\n        phone: '+20123456789',\n        address: {\n          street: 'City Center Street',\n          city: 'Fayoum',\n          state: 'Fayoum',\n          zipCode: '63514',\n          country: 'Egypt'\n        },\n        operatingHours: [\n          { day: 'sunday', open: '11:00', close: '23:00', closed: false },\n          { day: 'monday', open: '11:00', close: '23:00', closed: false },\n          { day: 'tuesday', open: '11:00', close: '23:00', closed: false },\n          { day: 'wednesday', open: '11:00', close: '23:00', closed: false },\n          { day: 'thursday', open: '11:00', close: '23:00', closed: false },\n          { day: 'friday', open: '11:00', close: '23:00', closed: false }, // Open on Friday\n          { day: 'saturday', open: '11:00', close: '23:00', closed: false }\n        ],\n        emergencyContact: '+20123456789',\n        workingDays: ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday']\n      });\n      console.log(` Created Fayoum branch: ${fayoumClinic._id}`);\n    } else {\n      console.log(` Found existing Fayoum branch: ${fayoumClinic._id}`);\n    }\n\n    // Atesa Branch\n    let atesaClinic = await (Clinic as any).findOne({ name: 'Clear', branchName: 'Atesa' });\n    if (!atesaClinic) {\n      atesaClinic = await (Clinic as any).create({\n        name: 'Clear',\n        branchName: 'Atesa',\n        email: 'atesa@cleardentalclinic.com',\n        phone: '+20123456780',\n        address: {\n          street: 'Main District Road',\n          city: 'Atesa',\n          state: 'Fayoum',\n          zipCode: '63515',\n          country: 'Egypt'\n        },\n        operatingHours: [\n          { day: 'sunday', open: '12:00', close: '23:00', closed: false },\n          { day: 'monday', open: '12:00', close: '23:00', closed: false },\n          { day: 'tuesday', open: '12:00', close: '23:00', closed: false },\n          { day: 'wednesday', open: '12:00', close: '23:00', closed: false },\n          { day: 'thursday', open: '12:00', close: '23:00', closed: false },\n          { day: 'friday', open: '12:00', close: '23:00', closed: true }, // Closed on Friday\n          { day: 'saturday', open: '12:00', close: '23:00', closed: false }\n        ],\n        emergencyContact: '+20123456780',\n        workingDays: ['monday', 'tuesday', 'wednesday', 'thursday', 'saturday', 'sunday']\n      });\n      console.log(` Created Atesa branch: ${atesaClinic._id}`);\n    } else {\n      console.log(` Found existing Atesa branch: ${atesaClinic._id}`);\n    }\n\n    // Minya Branch\n    let minyaClinic = await (Clinic as any).findOne({ name: 'Clear', branchName: 'Minya' });\n    if (!minyaClinic) {\n      minyaClinic = await (Clinic as any).create({\n        name: 'Clear',\n        branchName: 'Minya',\n        email: 'minya@cleardentalclinic.com',\n        phone: '+20123456781',\n        address: {\n          street: 'Downtown Avenue',\n          city: 'Minya',\n          state: 'Minya',\n          zipCode: '61111',\n          country: 'Egypt'\n        },\n        operatingHours: [\n          { day: 'sunday', open: '11:00', close: '23:00', closed: false },\n          { day: 'monday', open: '11:00', close: '23:00', closed: false },\n          { day: 'tuesday', open: '11:00', close: '23:00', closed: false },\n          { day: 'wednesday', open: '11:00', close: '23:00', closed: false },\n          { day: 'thursday', open: '11:00', close: '23:00', closed: false },\n          { day: 'friday', open: '11:00', close: '23:00', closed: true }, // Closed on Friday\n          { day: 'saturday', open: '11:00', close: '23:00', closed: false }\n        ],\n        emergencyContact: '+20123456781',\n        workingDays: ['monday', 'tuesday', 'wednesday', 'thursday', 'saturday', 'sunday']\n      });\n      console.log(` Created Minya branch: ${minyaClinic._id}`);\n    } else {\n      console.log(` Found existing Minya branch: ${minyaClinic._id}`);\n    }\n\n    // =====================================================\n    // STEP 2: Create or Find Doctors\n    // =====================================================\n    console.log('\\n Creating/Finding doctors...');\n\n\n    // Doctor Jamal\n    let drJamal = await User.findOne({ email: 'dr.jamal@cleardentalclinic.com' });\n    if (!drJamal) {\n      drJamal = await User.create({\n        firstName: 'Jamal',\n        lastName: 'Hassan',\n        email: 'dr.jamal@cleardentalclinic.com',\n        password: 'DentistPass123!',\n        role: 'dentist',\n        phone: '+20100000001',\n        specialization: 'General Dentistry',\n        assignedClinics: [fayoumClinic._id, atesaClinic._id] as any,\n        isActive: true\n      });\n      console.log(` Created Dr. Jamal: ${drJamal._id}`);\n    } else {\n      // Update assigned clinics\n      drJamal.assignedClinics = [fayoumClinic._id, atesaClinic._id] as any;\n      // Reset password to known value (hashed by pre-save hook)\n      (drJamal as any).password = 'DentistPass123!';\n      await drJamal.save();\n      console.log(` Found and updated Dr. Jamal: ${drJamal._id}`);\n    }\n\n    // Doctor Momen\n    let drMomen = await User.findOne({ email: 'dr.momen@cleardentalclinic.com' });\n    if (!drMomen) {\n      drMomen = await User.create({\n        firstName: 'Momen',\n        lastName: 'Ahmed',\n        email: 'dr.momen@cleardentalclinic.com',\n        password: 'DentistPass123!',\n        role: 'dentist',\n        phone: '+20100000002',\n        specialization: 'Orthodontics',\n        assignedClinics: [fayoumClinic._id, minyaClinic._id] as any,\n        isActive: true\n      });\n      console.log(` Created Dr. Momen: ${drMomen._id}`);\n    } else {\n      // Update assigned clinics\n      drMomen.assignedClinics = [fayoumClinic._id, minyaClinic._id] as any;\n      // Reset password to known value (hashed by pre-save hook)\n      (drMomen as any).password = 'DentistPass123!';\n      await drMomen.save();\n      console.log(` Found and updated Dr. Momen: ${drMomen._id}`);\n    }\n\n    // Doctor 3 (New)\n    let dr3 = await User.findOne({ email: 'dr.ali@cleardentalclinic.com' });\n    if (!dr3) {\n      dr3 = await User.create({\n        firstName: 'Ali',\n        lastName: 'Mahmoud',\n        email: 'dr.ali@cleardentalclinic.com',\n        password: 'DentistPass123!',\n        role: 'dentist',\n        phone: '+20100000003',\n        specialization: 'Cosmetic Dentistry',\n        assignedClinics: [fayoumClinic._id] as any,\n        isActive: true\n      });\n      console.log(` Created Dr. Ali: ${dr3._id}`);\n    } else {\n      dr3.assignedClinics = [fayoumClinic._id] as any;\n      // Reset password to known value (hashed by pre-save hook)\n      (dr3 as any).password = 'DentistPass123!';\n      await dr3.save();\n      console.log(` Found and updated Dr. Ali: ${dr3._id}`);\n    }\n\n    // Doctor 4 (New)\n    let dr4 = await User.findOne({ email: 'dr.sara@cleardentalclinic.com' });\n    if (!dr4) {\n      dr4 = await User.create({\n        firstName: 'Sara',\n        lastName: 'Ibrahim',\n        email: 'dr.sara@cleardentalclinic.com',\n        password: 'DentistPass123!',\n        role: 'dentist',\n        phone: '+20100000004',\n        specialization: 'Endodontics',\n        assignedClinics: [minyaClinic._id] as any,\n        isActive: true\n      });\n      console.log(` Created Dr. Sara: ${dr4._id}`);\n    } else {\n      dr4.assignedClinics = [minyaClinic._id] as any;\n      // Reset password to known value (hashed by pre-save hook)\n      (dr4 as any).password = 'DentistPass123!';\n      await dr4.save();\n      console.log(` Found and updated Dr. Sara: ${dr4._id}`);\n    }\n\n    // =====================================================\n    // STEP 3: Create Doctor Schedules\n    // =====================================================\n    console.log('\\n Creating doctor schedules...');\n\n    const schedules = [];\n\n    // ==================== FAYOUM BRANCH ====================\n    // Dr. Jamal at Fayoum: Sunday & Tuesday (7 PM - 11 PM), Thursday (11 AM - 7 PM)\n    schedules.push(\n      {\n        doctorId: drJamal._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 0, // Sunday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 2, // Tuesday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 4, // Thursday\n        startTime: '11:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      }\n    );\n\n    // Dr. Momen at Fayoum: Friday (11 AM - 11 PM), Sunday & Tuesday (11 AM - 7 PM), Thursday (7 PM - 11 PM)\n    schedules.push(\n      {\n        doctorId: drMomen._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 5, // Friday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 0, // Sunday\n        startTime: '11:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 2, // Tuesday\n        startTime: '11:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 4, // Thursday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      }\n    );\n\n    // Dr. Ali (Doctor 3) at Fayoum: Saturday, Monday, Wednesday (11 AM - 11 PM)\n    schedules.push(\n      {\n        doctorId: dr3._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 6, // Saturday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: dr3._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 1, // Monday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: dr3._id,\n        clinicId: fayoumClinic._id,\n        dayOfWeek: 3, // Wednesday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      }\n    );\n\n    // ==================== ATESA BRANCH ====================\n    // Dr. Jamal at Atesa: Sunday & Tuesday (12 PM - 7 PM), Thursday (7 PM - 11 PM), Saturday, Monday, Wednesday (12 PM - 11 PM)\n    schedules.push(\n      {\n        doctorId: drJamal._id,\n        clinicId: atesaClinic._id,\n        dayOfWeek: 0, // Sunday\n        startTime: '12:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: atesaClinic._id,\n        dayOfWeek: 2, // Tuesday\n        startTime: '12:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: atesaClinic._id,\n        dayOfWeek: 4, // Thursday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: atesaClinic._id,\n        dayOfWeek: 6, // Saturday\n        startTime: '12:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: atesaClinic._id,\n        dayOfWeek: 1, // Monday\n        startTime: '12:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drJamal._id,\n        clinicId: atesaClinic._id,\n        dayOfWeek: 3, // Wednesday\n        startTime: '12:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      }\n    );\n\n    // ==================== MINYA BRANCH ====================\n    // Dr. Momen at Minya: Sunday & Tuesday (11 AM - 7 PM), Thursday (7 PM - 11 PM), Saturday, Monday, Wednesday (11 AM - 11 PM)\n    schedules.push(\n      {\n        doctorId: drMomen._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 0, // Sunday\n        startTime: '11:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 2, // Tuesday\n        startTime: '11:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 4, // Thursday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 6, // Saturday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 1, // Monday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: drMomen._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 3, // Wednesday\n        startTime: '11:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      }\n    );\n\n    // Dr. Sara (Doctor 4) at Minya: Sunday & Tuesday (7 PM - 11 PM), Thursday (11 AM - 7 PM)\n    schedules.push(\n      {\n        doctorId: dr4._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 0, // Sunday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: dr4._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 2, // Tuesday\n        startTime: '19:00',\n        endTime: '23:00',\n        slotDuration: 30,\n        isActive: true\n      },\n      {\n        doctorId: dr4._id,\n        clinicId: minyaClinic._id,\n        dayOfWeek: 4, // Thursday\n        startTime: '11:00',\n        endTime: '19:00',\n        slotDuration: 30,\n        isActive: true\n      }\n    );\n\n    // Bulk insert all schedules\n    const createdSchedules = await (DoctorSchedule as any).insertMany(schedules);\n    console.log(` Created ${createdSchedules.length} doctor schedules`);\n\n    // =====================================================\n    // STEP 4: Display Summary\n    // =====================================================\n    console.log('\\n SEED SUMMARY');\n    console.log('=====================================');\n    console.log(` Fayoum Branch ID: ${fayoumClinic._id}`);\n    console.log(` Atesa Branch ID: ${atesaClinic._id}`);\n    console.log(` Minya Branch ID: ${minyaClinic._id}`);\n    console.log('');\n    console.log(` Dr. Jamal ID: ${drJamal._id} (Fayoum, Atesa)`);\n    console.log(` Dr. Momen ID: ${drMomen._id} (Fayoum, Minya)`);\n    console.log(` Dr. Ali ID: ${dr3._id} (Fayoum)`);\n    console.log(` Dr. Sara ID: ${dr4._id} (Minya)`);\n    console.log('');\n    console.log(` Total Schedules Created: ${createdSchedules.length}`);\n    console.log('');\n    console.log(' Multi-branch seeding completed successfully!');\n    console.log('');\n    console.log(' Login Credentials (All doctors):');\n    console.log('   Password: DentistPass123!');\n    console.log('   Emails: dr.jamal@cleardentalclinic.com, dr.momen@cleardentalclinic.com,');\n    console.log('           dr.ali@cleardentalclinic.com, dr.sara@cleardentalclinic.com');\n    console.log('=====================================');\n\n  } catch (error) {\n    console.error(' Error seeding data:', error);\n    throw error;\n  } finally {\n    await mongoose.connection.close();\n    console.log('\\n Database connection closed');\n  }\n};\n\n// Run the seed script\nif (require.main === module) {\n  seedMultiBranchData()\n    .then(() => {\n      console.log('\\n Seed script completed');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('\\n Seed script failed:', error);\n      process.exit(1);\n    });\n}\n\nexport default seedMultiBranchData;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\scripts\\test-patient-profile-fixes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'fs' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'path' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[724,727],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[724,727],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1352,1355],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1352,1355],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3080,3083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3080,3083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4291,4294],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4291,4294],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5697,5700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5697,5700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":219,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7017,7020],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7017,7020],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":266,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":266,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8514,8517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8514,8517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":309,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":309,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9952,9955],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9952,9955],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":345,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11102,11105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11102,11105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":380,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":380,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12133,12136],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12133,12136],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":434,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":434,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":467,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":467,"endColumn":21}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Manual Test Script for Patient Profile API Fixes\r\n * \r\n * This script tests the three main fixes:\r\n * 1. Profile image upload endpoint alias\r\n * 2. Patient data fetching authorization\r\n * 3. Patient data updating authorization\r\n * \r\n * Prerequisites:\r\n * - Backend server must be running\r\n * - Database must have test users and patients\r\n * \r\n * Run with: ts-node src/scripts/test-patient-profile-fixes.ts\r\n */\r\n\r\nimport axios from 'axios';\r\nimport FormData from 'form-data';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst API_BASE_URL = process.env.API_URL || 'http://localhost:3001/api/v1';\r\n\r\ninterface TestResult {\r\n  test: string;\r\n  status: 'PASS' | 'FAIL' | 'SKIP';\r\n  message: string;\r\n  details?: any;\r\n}\r\n\r\nconst results: TestResult[] = [];\r\n\r\nfunction logResult(result: TestResult) {\r\n  results.push(result);\r\n  const icon = result.status === 'PASS' ? '' : result.status === 'FAIL' ? '' : '';\r\n  console.log(`${icon} ${result.test}: ${result.message}`);\r\n  if (result.details) {\r\n    console.log('   Details:', JSON.stringify(result.details, null, 2));\r\n  }\r\n}\r\n\r\nasync function loginUser(email: string, password: string): Promise<string | null> {\r\n  try {\r\n    const response = await axios.post(`${API_BASE_URL}/auth/login`, {\r\n      email,\r\n      password\r\n    });\r\n    return response.data.token;\r\n  } catch (error: any) {\r\n    console.error(`Failed to login as ${email}:`, error.response?.data || error.message);\r\n    return null;\r\n  }\r\n}\r\n\r\nasync function test1_ProfileImageUploadEndpoint(token: string) {\r\n  console.log('\\n Test 3.1: Profile Image Upload Endpoint');\r\n  \r\n  // Test 1.1: POST to /users/profile-image (new alias)\r\n  try {\r\n    const formData = new FormData();\r\n    // Create a small test image buffer\r\n    const testImageBuffer = Buffer.from('R0lGODlhAQABAAAAACw=', 'base64');\r\n    formData.append('profileImage', testImageBuffer, {\r\n      filename: 'test-image.gif',\r\n      contentType: 'image/gif'\r\n    });\r\n\r\n    const response = await axios.post(`${API_BASE_URL}/users/profile-image`, formData, {\r\n      headers: {\r\n        ...formData.getHeaders(),\r\n        'Authorization': `Bearer ${token}`\r\n      },\r\n      validateStatus: () => true // Don't throw on any status\r\n    });\r\n\r\n    if (response.status === 404) {\r\n      logResult({\r\n        test: '3.1.1 POST /users/profile-image',\r\n        status: 'FAIL',\r\n        message: 'Endpoint returns 404 - route alias not added',\r\n        details: { status: response.status, data: response.data }\r\n      });\r\n    } else if (response.status === 200 || response.status === 201) {\r\n      logResult({\r\n        test: '3.1.1 POST /users/profile-image',\r\n        status: 'PASS',\r\n        message: 'Endpoint exists and accepts requests',\r\n        details: { status: response.status }\r\n      });\r\n    } else {\r\n      logResult({\r\n        test: '3.1.1 POST /users/profile-image',\r\n        status: 'PASS',\r\n        message: `Endpoint exists (status: ${response.status})`,\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    logResult({\r\n      test: '3.1.1 POST /users/profile-image',\r\n      status: 'FAIL',\r\n      message: 'Request failed',\r\n      details: error.message\r\n    });\r\n  }\r\n\r\n  // Test 1.2: POST to /users/upload-image (original endpoint)\r\n  try {\r\n    const formData = new FormData();\r\n    const testImageBuffer = Buffer.from('R0lGODlhAQABAAAAACw=', 'base64');\r\n    formData.append('profileImage', testImageBuffer, {\r\n      filename: 'test-image.gif',\r\n      contentType: 'image/gif'\r\n    });\r\n\r\n    const response = await axios.post(`${API_BASE_URL}/users/upload-image`, formData, {\r\n      headers: {\r\n        ...formData.getHeaders(),\r\n        'Authorization': `Bearer ${token}`\r\n      },\r\n      validateStatus: () => true\r\n    });\r\n\r\n    if (response.status === 404) {\r\n      logResult({\r\n        test: '3.1.2 POST /users/upload-image',\r\n        status: 'FAIL',\r\n        message: 'Original endpoint missing',\r\n        details: { status: response.status }\r\n      });\r\n    } else {\r\n      logResult({\r\n        test: '3.1.2 POST /users/upload-image',\r\n        status: 'PASS',\r\n        message: 'Original endpoint still works',\r\n        details: { status: response.status }\r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    logResult({\r\n      test: '3.1.2 POST /users/upload-image',\r\n      status: 'FAIL',\r\n      message: 'Request failed',\r\n      details: error.message\r\n    });\r\n  }\r\n}\r\n\r\nasync function test2_PatientDataFetching(patientToken: string, patientUserId: string, otherUserId: string) {\r\n  console.log('\\n Test 3.2: Patient Data Fetching');\r\n\r\n  // Test 2.1: Patient fetches their own data\r\n  try {\r\n    const response = await axios.get(`${API_BASE_URL}/patients/user/${patientUserId}`, {\r\n      headers: { 'Authorization': `Bearer ${patientToken}` },\r\n      validateStatus: () => true\r\n    });\r\n\r\n    if (response.status === 403) {\r\n      logResult({\r\n        test: '3.2.1 Patient fetches own data',\r\n        status: 'FAIL',\r\n        message: 'Patient receives 403 when accessing own data',\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    } else if (response.status === 200) {\r\n      logResult({\r\n        test: '3.2.1 Patient fetches own data',\r\n        status: 'PASS',\r\n        message: 'Patient can access own data',\r\n        details: { status: response.status }\r\n      });\r\n    } else {\r\n      logResult({\r\n        test: '3.2.1 Patient fetches own data',\r\n        status: 'FAIL',\r\n        message: `Unexpected status: ${response.status}`,\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    logResult({\r\n      test: '3.2.1 Patient fetches own data',\r\n      status: 'FAIL',\r\n      message: 'Request failed',\r\n      details: error.message\r\n    });\r\n  }\r\n\r\n  // Test 2.2: Patient tries to fetch another patient's data\r\n  if (otherUserId) {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/patients/user/${otherUserId}`, {\r\n        headers: { 'Authorization': `Bearer ${patientToken}` },\r\n        validateStatus: () => true\r\n      });\r\n\r\n      if (response.status === 403) {\r\n        logResult({\r\n          test: '3.2.2 Patient blocked from other data',\r\n          status: 'PASS',\r\n          message: 'Patient correctly denied access to other patient data',\r\n          details: { status: response.status }\r\n        });\r\n      } else if (response.status === 200) {\r\n        logResult({\r\n          test: '3.2.2 Patient blocked from other data',\r\n          status: 'FAIL',\r\n          message: 'Patient can access other patient data (security issue!)',\r\n          details: { status: response.status }\r\n        });\r\n      } else {\r\n        logResult({\r\n          test: '3.2.2 Patient blocked from other data',\r\n          status: 'SKIP',\r\n          message: `Unexpected status: ${response.status}`,\r\n          details: { status: response.status }\r\n        });\r\n      }\r\n    } catch (error: any) {\r\n      logResult({\r\n        test: '3.2.2 Patient blocked from other data',\r\n        status: 'FAIL',\r\n        message: 'Request failed',\r\n        details: error.message\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nasync function test3_PatientDataUpdating(patientToken: string, patientId: string, otherPatientId: string) {\r\n  console.log('\\n Test 3.3: Patient Data Updating');\r\n\r\n  // Test 3.1: Patient updates their own data\r\n  try {\r\n    const updateData = {\r\n      phone: '+1234567890'\r\n    };\r\n\r\n    const response = await axios.put(`${API_BASE_URL}/patients/${patientId}`, updateData, {\r\n      headers: { 'Authorization': `Bearer ${patientToken}` },\r\n      validateStatus: () => true\r\n    });\r\n\r\n    if (response.status === 403) {\r\n      logResult({\r\n        test: '3.3.1 Patient updates own data',\r\n        status: 'FAIL',\r\n        message: 'Patient receives 403 when updating own data',\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    } else if (response.status === 200) {\r\n      logResult({\r\n        test: '3.3.1 Patient updates own data',\r\n        status: 'PASS',\r\n        message: 'Patient can update own data',\r\n        details: { status: response.status }\r\n      });\r\n    } else {\r\n      logResult({\r\n        test: '3.3.1 Patient updates own data',\r\n        status: 'FAIL',\r\n        message: `Unexpected status: ${response.status}`,\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    logResult({\r\n      test: '3.3.1 Patient updates own data',\r\n      status: 'FAIL',\r\n      message: 'Request failed',\r\n      details: error.message\r\n    });\r\n  }\r\n\r\n  // Test 3.2: Patient tries to update another patient's data\r\n  if (otherPatientId) {\r\n    try {\r\n      const updateData = {\r\n        phone: '+9999999999'\r\n      };\r\n\r\n      const response = await axios.put(`${API_BASE_URL}/patients/${otherPatientId}`, updateData, {\r\n        headers: { 'Authorization': `Bearer ${patientToken}` },\r\n        validateStatus: () => true\r\n      });\r\n\r\n      if (response.status === 403) {\r\n        logResult({\r\n          test: '3.3.2 Patient blocked from updating other data',\r\n          status: 'PASS',\r\n          message: 'Patient correctly denied update access to other patient data',\r\n          details: { status: response.status }\r\n        });\r\n      } else if (response.status === 200) {\r\n        logResult({\r\n          test: '3.3.2 Patient blocked from updating other data',\r\n          status: 'FAIL',\r\n          message: 'Patient can update other patient data (security issue!)',\r\n          details: { status: response.status }\r\n        });\r\n      } else {\r\n        logResult({\r\n          test: '3.3.2 Patient blocked from updating other data',\r\n          status: 'SKIP',\r\n          message: `Unexpected status: ${response.status}`,\r\n          details: { status: response.status }\r\n        });\r\n      }\r\n    } catch (error: any) {\r\n      logResult({\r\n        test: '3.3.2 Patient blocked from updating other data',\r\n        status: 'FAIL',\r\n        message: 'Request failed',\r\n        details: error.message\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nasync function test4_StaffAccess(staffToken: string, patientUserId: string, patientId: string) {\r\n  console.log('\\n Test 3.5: Staff and Admin Access');\r\n\r\n  // Test 4.1: Staff fetches patient data\r\n  try {\r\n    const response = await axios.get(`${API_BASE_URL}/patients/user/${patientUserId}`, {\r\n      headers: { 'Authorization': `Bearer ${staffToken}` },\r\n      validateStatus: () => true\r\n    });\r\n\r\n    if (response.status === 200) {\r\n      logResult({\r\n        test: '3.5.1 Staff fetches patient data',\r\n        status: 'PASS',\r\n        message: 'Staff can access patient data',\r\n        details: { status: response.status }\r\n      });\r\n    } else {\r\n      logResult({\r\n        test: '3.5.1 Staff fetches patient data',\r\n        status: 'FAIL',\r\n        message: `Staff denied access (status: ${response.status})`,\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    logResult({\r\n      test: '3.5.1 Staff fetches patient data',\r\n      status: 'FAIL',\r\n      message: 'Request failed',\r\n      details: error.message\r\n    });\r\n  }\r\n\r\n  // Test 4.2: Staff updates patient data\r\n  try {\r\n    const updateData = {\r\n      phone: '+1111111111'\r\n    };\r\n\r\n    const response = await axios.put(`${API_BASE_URL}/patients/${patientId}`, updateData, {\r\n      headers: { 'Authorization': `Bearer ${staffToken}` },\r\n      validateStatus: () => true\r\n    });\r\n\r\n    if (response.status === 200) {\r\n      logResult({\r\n        test: '3.5.2 Staff updates patient data',\r\n        status: 'PASS',\r\n        message: 'Staff can update patient data',\r\n        details: { status: response.status }\r\n      });\r\n    } else {\r\n      logResult({\r\n        test: '3.5.2 Staff updates patient data',\r\n        status: 'FAIL',\r\n        message: `Staff denied update access (status: ${response.status})`,\r\n        details: { status: response.status, message: response.data.message }\r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    logResult({\r\n      test: '3.5.2 Staff updates patient data',\r\n      status: 'FAIL',\r\n      message: 'Request failed',\r\n      details: error.message\r\n    });\r\n  }\r\n}\r\n\r\nasync function main() {\r\n  console.log(' Patient Profile API Fixes - Manual Test Suite\\n');\r\n  console.log('================================================\\n');\r\n\r\n  // Get test credentials from environment or use defaults\r\n  const PATIENT_EMAIL = process.env.TEST_PATIENT_EMAIL || 'patient@example.com';\r\n  const PATIENT_PASSWORD = process.env.TEST_PATIENT_PASSWORD || 'password123';\r\n  const STAFF_EMAIL = process.env.TEST_STAFF_EMAIL || 'staff@example.com';\r\n  const STAFF_PASSWORD = process.env.TEST_STAFF_PASSWORD || 'password123';\r\n  const OTHER_PATIENT_EMAIL = process.env.TEST_OTHER_PATIENT_EMAIL;\r\n  const OTHER_PATIENT_PASSWORD = process.env.TEST_OTHER_PATIENT_PASSWORD;\r\n\r\n  console.log(' Test Configuration:');\r\n  console.log(`   API Base URL: ${API_BASE_URL}`);\r\n  console.log(`   Patient Email: ${PATIENT_EMAIL}`);\r\n  console.log(`   Staff Email: ${STAFF_EMAIL}`);\r\n  console.log(`   Other Patient Email: ${OTHER_PATIENT_EMAIL || 'Not configured'}\\n`);\r\n\r\n  // Login as patient\r\n  console.log(' Logging in as patient...');\r\n  const patientToken = await loginUser(PATIENT_EMAIL, PATIENT_PASSWORD);\r\n  if (!patientToken) {\r\n    console.error(' Failed to login as patient. Please check credentials and ensure backend is running.');\r\n    console.error('   You can set credentials via environment variables:');\r\n    console.error('   TEST_PATIENT_EMAIL, TEST_PATIENT_PASSWORD');\r\n    process.exit(1);\r\n  }\r\n\r\n  // Get patient user ID from token\r\n  const patientPayload = JSON.parse(Buffer.from(patientToken.split('.')[1], 'base64').toString());\r\n  const patientUserId = patientPayload.id;\r\n  console.log(` Logged in as patient (User ID: ${patientUserId})\\n`);\r\n\r\n  // Get patient record ID\r\n  let patientId: string | null = null;\r\n  try {\r\n    const response = await axios.get(`${API_BASE_URL}/patients/user/${patientUserId}`, {\r\n      headers: { 'Authorization': `Bearer ${patientToken}` },\r\n      validateStatus: () => true\r\n    });\r\n    if (response.status === 200 && response.data.data) {\r\n      patientId = response.data.data._id;\r\n      console.log(` Found patient record (Patient ID: ${patientId})\\n`);\r\n    }\r\n  } catch (error) {\r\n    console.warn('  Could not fetch patient record ID\\n');\r\n  }\r\n\r\n  // Login as staff\r\n  console.log(' Logging in as staff...');\r\n  const staffToken = await loginUser(STAFF_EMAIL, STAFF_PASSWORD);\r\n  if (!staffToken) {\r\n    console.warn('  Failed to login as staff. Staff tests will be skipped.\\n');\r\n  } else {\r\n    console.log(' Logged in as staff\\n');\r\n  }\r\n\r\n  // Login as other patient (optional)\r\n  let otherPatientToken: string | null = null;\r\n  let otherPatientUserId: string | null = null;\r\n  let otherPatientId: string | null = null;\r\n  if (OTHER_PATIENT_EMAIL && OTHER_PATIENT_PASSWORD) {\r\n    console.log(' Logging in as other patient...');\r\n    otherPatientToken = await loginUser(OTHER_PATIENT_EMAIL, OTHER_PATIENT_PASSWORD);\r\n    if (otherPatientToken) {\r\n      const otherPayload = JSON.parse(Buffer.from(otherPatientToken.split('.')[1], 'base64').toString());\r\n      otherPatientUserId = otherPayload.id;\r\n      \r\n      // Get other patient record ID\r\n      try {\r\n        const response = await axios.get(`${API_BASE_URL}/patients/user/${otherPatientUserId}`, {\r\n          headers: { 'Authorization': `Bearer ${otherPatientToken}` },\r\n          validateStatus: () => true\r\n        });\r\n        if (response.status === 200 && response.data.data) {\r\n          otherPatientId = response.data.data._id;\r\n        }\r\n      } catch (error) {\r\n        // Ignore\r\n      }\r\n      \r\n      console.log(` Logged in as other patient (User ID: ${otherPatientUserId})\\n`);\r\n    }\r\n  }\r\n\r\n  // Run tests\r\n  await test1_ProfileImageUploadEndpoint(patientToken);\r\n  await test2_PatientDataFetching(patientToken, patientUserId, otherPatientUserId || '');\r\n  \r\n  if (patientId) {\r\n    await test3_PatientDataUpdating(patientToken, patientId, otherPatientId || '');\r\n  } else {\r\n    console.log('\\n  Skipping patient update tests (no patient record found)');\r\n  }\r\n\r\n  if (staffToken && patientId) {\r\n    await test4_StaffAccess(staffToken, patientUserId, patientId);\r\n  } else {\r\n    console.log('\\n  Skipping staff access tests (staff login failed or no patient record)');\r\n  }\r\n\r\n  // Summary\r\n  console.log('\\n================================================');\r\n  console.log(' Test Summary\\n');\r\n  \r\n  const passed = results.filter(r => r.status === 'PASS').length;\r\n  const failed = results.filter(r => r.status === 'FAIL').length;\r\n  const skipped = results.filter(r => r.status === 'SKIP').length;\r\n  \r\n  console.log(` Passed: ${passed}`);\r\n  console.log(` Failed: ${failed}`);\r\n  console.log(`  Skipped: ${skipped}`);\r\n  console.log(` Total: ${results.length}\\n`);\r\n\r\n  if (failed > 0) {\r\n    console.log(' Some tests failed. Please review the results above.');\r\n    process.exit(1);\r\n  } else {\r\n    console.log(' All tests passed!');\r\n    process.exit(0);\r\n  }\r\n}\r\n\r\nmain().catch(error => {\r\n  console.error(' Test suite crashed:', error);\r\n  process.exit(1);\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\adminSeeder.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'bcrypt' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import bcrypt from 'bcryptjs';\nimport { User } from '../models';\nimport { connectDB } from '../config/database';\n\ninterface AdminData {\n  firstName: string;\n  lastName: string;\n  email: string;\n  password: string;\n  role: 'super_admin';\n  phone?: string;\n  isActive: boolean;\n}\n\nconst adminData: AdminData = {\n  firstName: 'Dr. Gamal',\n  lastName: 'Abdel Nasser',\n  email: 'admin@dentalclinic.com',\n  password: 'Admin123!',\n  role: 'super_admin',\n  phone: '+201017848825',\n  isActive: true\n};\n\nexport const createAdminUser = async (): Promise<void> => {\n  try {\n    // Check if admin already exists\n    const existingAdmin = await User.findOne({ email: adminData.email });\n    \n    if (existingAdmin) {\n      console.log(' Admin user already exists:', adminData.email);\n      return;\n    }\n\n    // Create admin user (password will be hashed by pre-save middleware)\n    const adminUser = new User({\n      ...adminData\n    });\n\n    await adminUser.save();\n    \n    console.log(' Admin user created successfully!');\n    console.log(' Email:', adminData.email);\n    console.log(' Password:', adminData.password);\n    console.log('  Please change the default password after first login!');\n    \n  } catch (error) {\n    console.error(' Error creating admin user:', error);\n    throw error;\n  }\n};\n\n// Run seeder if called directly\nif (require.main === module) {\n  const runSeeder = async () => {\n    try {\n      await connectDB();\n      await createAdminUser();\n      console.log(' Admin seeder completed successfully!');\n      process.exit(0);\n    } catch (error) {\n      console.error(' Admin seeder failed:', error);\n      process.exit(1);\n    }\n  };\n  \n  runSeeder();\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\clinicSeeder.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2803,2806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2803,2806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Clinic } from '../models';\nimport { connectDB } from '../config/database';\n\ninterface ClinicData {\n  name: string;\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n  };\n  phone: string;\n  email: string;\n  services: string[];\n  operatingHours: {\n    day: string;\n    open: string;\n    close: string;\n    closed: boolean;\n  }[];\n}\n\nconst clinicsData: ClinicData[] = [\n  {\n    name: 'Dr. Gamal Abdel Nasser Center for Laser Dental Implants and Aesthetics',\n    address: {\n      street: 'In front of Attsa Preparatory School',\n      city: 'Attsa',\n      state: 'Fayoum',\n      zipCode: '63511',\n      country: 'Egypt'\n    },\n    phone: '+201017848825',\n    email: 'attsa@dentalclinic.com',\n    services: [\n      'Dental treatment',\n      'Laser filling',\n      'Root canal filling',\n      'Children\\'s filling',\n      'Regular filling',\n      'Regular and surgical extraction',\n      'Implants',\n      'Installation',\n      'Teeth whitening services'\n    ],\n    operatingHours: [\n      { day: 'monday', open: '12:00', close: '23:00', closed: false },\n      { day: 'tuesday', open: '12:00', close: '23:00', closed: false },\n      { day: 'wednesday', open: '12:00', close: '23:00', closed: false },\n      { day: 'thursday', open: '12:00', close: '23:00', closed: false },\n      { day: 'friday', open: '', close: '', closed: true },\n      { day: 'saturday', open: '12:00', close: '23:00', closed: false },\n      { day: 'sunday', open: '12:00', close: '23:00', closed: false }\n    ]\n  },\n  {\n    name: 'Center for Laser Dental Implants and Aesthetics',\n    address: {\n      street: 'Al-Nabawi Street, in front of General Hospital',\n      city: 'Fayoum',\n      state: 'Fayoum',\n      zipCode: '63514',\n      country: 'Egypt'\n    },\n    phone: '+201017848825',\n    email: 'nabawi@dentalclinic.com',\n    services: [\n      'Dental treatment',\n      'Laser filling',\n      'Root canal filling',\n      'Children\\'s filling',\n      'Regular filling',\n      'Regular and surgical extraction',\n      'Implants',\n      'Installation',\n      'Teeth whitening services'\n    ],\n    operatingHours: [\n      { day: 'monday', open: '12:00', close: '23:00', closed: false },\n      { day: 'tuesday', open: '12:00', close: '23:00', closed: false },\n      { day: 'wednesday', open: '12:00', close: '23:00', closed: false },\n      { day: 'thursday', open: '12:00', close: '23:00', closed: false },\n      { day: 'friday', open: '', close: '', closed: true },\n      { day: 'saturday', open: '12:00', close: '23:00', closed: false },\n      { day: 'sunday', open: '12:00', close: '23:00', closed: false }\n    ]\n  }\n];\n\nexport const seedClinics = async (): Promise<void> => {\n  try {\n    // Check if clinics already exist\n    const existingCount = await (Clinic as any).countDocuments();\n    \n    if (existingCount > 0) {\n      console.log(` Clinics already seeded (${existingCount} clinics found)`);\n      return;\n    }\n\n    // Insert clinics\n    await Clinic.insertMany(clinicsData);\n    \n    console.log(` Successfully seeded ${clinicsData.length} clinics`);\n    \n  } catch (error) {\n    console.error(' Error seeding clinics:', error);\n    throw error;\n  }\n};\n\n// Run seeder if called directly\nif (require.main === module) {\n  const runSeeder = async () => {\n    try {\n      await connectDB();\n      await seedClinics();\n      console.log(' Clinic seeder completed successfully!');\n      process.exit(0);\n    } catch (error) {\n      console.error(' Clinic seeder failed:', error);\n      process.exit(1);\n    }\n  };\n  \n  runSeeder();\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\createDentistSchedules.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\dentistScheduleSeeder.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[949,952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[949,952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { StaffSchedule, User, Clinic } from '../models';\r\nimport { connectDB } from '../config/database';\r\n\r\ninterface DentistSchedule {\r\n  email: string;\r\n  name: string;\r\n  workingDays: number[]; // 0 = Sunday, 1 = Monday, ..., 6 = Saturday\r\n  startTime: string;\r\n  endTime: string;\r\n}\r\n\r\nconst dentistSchedules: DentistSchedule[] = [\r\n  {\r\n    email: 'dr.gamal@dentalclinic.com',\r\n    name: 'Dr. Gamal Abdel Nasser Khattab',\r\n    workingDays: [6, 0, 1, 5], // Saturday, Sunday, Monday, Friday\r\n    startTime: '09:00',\r\n    endTime: '17:00'\r\n  },\r\n  {\r\n    email: 'dr.moamen@dentalclinic.com', \r\n    name: 'Dr. Moamen Al-Banna',\r\n    workingDays: [2, 3, 4], // Tuesday, Wednesday, Thursday\r\n    startTime: '09:00',\r\n    endTime: '17:00'\r\n  }\r\n];\r\n\r\nexport const createDentistSchedules = async (): Promise<void> => {\r\n  try {\r\n    console.log(' Setting up dentist schedules...');\r\n    \r\n    // Get the clinic\r\n    const clinic = await (Clinic as any).findOne();\r\n    if (!clinic) {\r\n      console.log(' No clinic found. Cannot create schedules.');\r\n      return;\r\n    }\r\n    console.log(` Using clinic: ${clinic.name}`);\r\n\r\n    for (const scheduleInfo of dentistSchedules) {\r\n      // Find the dentist by email\r\n      const dentist = await User.findOne({ \r\n        email: scheduleInfo.email,\r\n        role: 'dentist'\r\n      });\r\n      \r\n      if (!dentist) {\r\n        console.log(` Dentist not found: ${scheduleInfo.name} (${scheduleInfo.email})`);\r\n        continue;\r\n      }\r\n\r\n      // Check if schedule already exists\r\n      const existingSchedule = await StaffSchedule.findOne({\r\n        staffId: dentist._id,\r\n        clinicId: clinic._id,\r\n        isRecurring: true\r\n      });\r\n\r\n      if (existingSchedule) {\r\n        // Update existing schedule\r\n        existingSchedule.recurringPattern = {\r\n          frequency: 'weekly',\r\n          daysOfWeek: scheduleInfo.workingDays,\r\n          endDate: undefined // No end date - ongoing\r\n        };\r\n        existingSchedule.startTime = scheduleInfo.startTime;\r\n        existingSchedule.endTime = scheduleInfo.endTime;\r\n        \r\n        await existingSchedule.save();\r\n        console.log(` Updated schedule for ${scheduleInfo.name}`);\r\n      } else {\r\n        // Create new recurring schedule\r\n        const schedule = new StaffSchedule({\r\n          staffId: dentist._id,\r\n          clinicId: clinic._id,\r\n          date: new Date(), // Required field, but not used for recurring\r\n          startTime: scheduleInfo.startTime,\r\n          endTime: scheduleInfo.endTime,\r\n          shiftType: 'full-day',\r\n          status: 'scheduled',\r\n          isRecurring: true,\r\n          recurringPattern: {\r\n            frequency: 'weekly',\r\n            daysOfWeek: scheduleInfo.workingDays,\r\n            // No end date - ongoing schedule\r\n          },\r\n          notifications: {\r\n            email: true,\r\n            sms: false,\r\n            inApp: true,\r\n            reminderTime: 60\r\n          },\r\n          createdBy: dentist._id\r\n        });\r\n\r\n        await schedule.save();\r\n        console.log(` Created schedule for ${scheduleInfo.name}`);\r\n      }\r\n\r\n      // Display the schedule\r\n      const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n      const workingDayNames = scheduleInfo.workingDays.map(day => dayNames[day]);\r\n      console.log(`    Working days: ${workingDayNames.join(', ')}`);\r\n      console.log(`    Hours: ${scheduleInfo.startTime} - ${scheduleInfo.endTime}`);\r\n      console.log('');\r\n    }\r\n    \r\n    console.log(' Dentist schedule setup completed successfully!');\r\n    \r\n  } catch (error) {\r\n    console.error(' Error creating dentist schedules:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Run seeder if called directly\r\nif (require.main === module) {\r\n  (async () => {\r\n    try {\r\n      await connectDB();\r\n      await createDentistSchedules();\r\n      process.exit(0);\r\n    } catch (error) {\r\n      console.error(' Seeder failed:', error);\r\n      process.exit(1);\r\n    }\r\n  })();\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\dentistSeeder.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'bcrypt' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1065,1068],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1065,1068],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import bcrypt from 'bcryptjs';\nimport { User, Clinic } from '../models';\nimport { connectDB } from '../config/database';\n\ninterface DentistData {\n  firstName: string;\n  lastName: string;\n  email: string;\n  password: string;\n  role: 'dentist';\n  phone?: string;\n  specialization?: string;\n  isActive: boolean;\n}\n\nconst dentistData: DentistData[] = [\n  {\n    firstName: 'Dr. Gamal',\n    lastName: 'Abdel Nasser Khattab',\n    email: 'dr.gamal@dentalclinic.com',\n    password: 'Dentist123!',\n    role: 'dentist',\n    phone: '+201070721469',\n    specialization: 'Oral and Dental Medicine and Surgery Specialist',\n    isActive: true\n  },\n  {\n    firstName: 'Dr. Moamen',\n    lastName: 'Al-Banna',\n    email: 'dr.moamen@dentalclinic.com',\n    password: 'Dentist123!',\n    role: 'dentist',\n    phone: '+201070721470',\n    specialization: 'Oral and Dental Medicine and Surgery Specialist',\n    isActive: true\n  }\n];\n\nexport const createDentistUsers = async (): Promise<void> => {\n  try {\n    // Get the first clinic to assign dentists to\n    const clinic = await (Clinic as any).findOne();\n    if (!clinic) {\n      console.log(' No clinic found. Cannot assign dentists.');\n      return;\n    }\n\n    for (const dentistInfo of dentistData) {\n      // Check if dentist already exists\n      const existingDentist = await User.findOne({ email: dentistInfo.email });\n      \n      if (existingDentist) {\n        console.log(` Dentist already exists: ${dentistInfo.firstName} ${dentistInfo.lastName}`);\n        continue;\n      }\n\n      // Create dentist user\n      const dentist = new User({\n        ...dentistInfo,\n        assignedClinics: [clinic._id]\n      });\n\n      await dentist.save();\n      \n      console.log(` Dentist created: ${dentistInfo.firstName} ${dentistInfo.lastName}`);\n      console.log(` Email: ${dentistInfo.email}`);\n      console.log(` Password: ${dentistInfo.password}`);\n      console.log(` Assigned to clinic: ${clinic.name}`);\n      console.log('');\n    }\n    \n    console.log(' Dentist seeding completed successfully!');\n    \n  } catch (error) {\n    console.error(' Error creating dentist users:', error);\n    throw error;\n  }\n};\n\n// Run seeder if called directly\nif (require.main === module) {\n  const runSeeder = async () => {\n    try {\n      await connectDB();\n      await createDentistUsers();\n      console.log(' Dentist seeder completed successfully!');\n      process.exit(0);\n    } catch (error) {\n      console.error(' Dentist seeder failed:', error);\n      process.exit(1);\n    }\n  };\n  \n  runSeeder();\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\fixDentistAssignment.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":17,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[547,550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[547,550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[741,744],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[741,744],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'assignedCount' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":84,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":84,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from 'mongoose';\r\nimport { User, Clinic } from '../models';\r\nimport { connectDB } from '../config/database';\r\n\r\nconst CLINIC_ID_STRING = '687468107e70478314c346be';\r\nconst CLINIC_ID = new mongoose.Types.ObjectId(CLINIC_ID_STRING);\r\n\r\nasync function fixDentistAssignment() {\r\n  try {\r\n    console.log(' === FIXING DENTIST ASSIGNMENT ISSUE ===\\n');\r\n\r\n    // Connect to database\r\n    await connectDB();\r\n\r\n    // Step 1: Verify clinic exists\r\n    console.log(' Step 1: Verifying clinic...');\r\n    const clinic = await (Clinic as any).findById(CLINIC_ID_STRING);\r\n    \r\n    if (!clinic) {\r\n      console.log(' ERROR: Clinic not found!');\r\n      console.log('Available clinics:');\r\n      const allClinics = await (Clinic as any).find({}, 'name _id');\r\n      allClinics.forEach(c => {\r\n        console.log(`   - ${c.name} (${c._id})`);\r\n      });\r\n      return;\r\n    }\r\n    \r\n    console.log(` Clinic found: ${clinic.name}`);\r\n    console.log(`   Address: ${clinic.address?.street}, ${clinic.address?.city}`);\r\n\r\n    // Step 2: Check current assignments\r\n    console.log('\\n Step 2: Checking current dentist assignments...');\r\n    \r\n    const assignedDentists = await User.find({ \r\n      role: 'dentist', \r\n      isActive: true,\r\n      assignedClinics: { $in: [CLINIC_ID_STRING] }\r\n    });\r\n    \r\n    console.log(` Currently assigned dentists: ${assignedDentists.length}`);\r\n    \r\n    if (assignedDentists.length > 0) {\r\n      console.log(' Dentists already assigned:');\r\n      assignedDentists.forEach((d, index) => {\r\n        console.log(`   ${index + 1}. Dr. ${d.firstName} ${d.lastName} (${d._id})`);\r\n      });\r\n      console.log('\\n No fix needed - dentists are already assigned!');\r\n      return;\r\n    }\r\n\r\n    // Step 3: Find available dentists to assign\r\n    console.log('\\n Step 3: Finding available dentists...');\r\n    \r\n    const availableDentists = await User.find({ \r\n      role: 'dentist', \r\n      isActive: true\r\n    }).limit(3);\r\n    \r\n    console.log(` Available dentists: ${availableDentists.length}`);\r\n    \r\n    if (availableDentists.length === 0) {\r\n      console.log(' No dentists found in the system!');\r\n      console.log(' You need to create dentist users first.');\r\n      return;\r\n    }\r\n\r\n    // Step 4: Assign dentists to the clinic\r\n    console.log('\\n Step 4: Assigning dentists to clinic...');\r\n    \r\n    let assignedCount = 0;\r\n    for (const dentist of availableDentists) {\r\n      // Initialize assignedClinics if it doesn't exist\r\n      if (!dentist.assignedClinics) {\r\n        dentist.assignedClinics = [];\r\n      }\r\n      \r\n      // Check if already assigned\r\n      if (!dentist.assignedClinics.some(id => id.toString() === CLINIC_ID_STRING)) {\r\n        dentist.assignedClinics.push(CLINIC_ID);\r\n        await dentist.save();\r\n        \r\n        console.log(` Assigned Dr. ${dentist.firstName} ${dentist.lastName} to ${clinic.name}`);\r\n        assignedCount++;\r\n      } else {\r\n        console.log(`  Dr. ${dentist.firstName} ${dentist.lastName} already assigned`);\r\n      }\r\n    }\r\n\r\n    // Step 5: Verify the fix\r\n    console.log('\\n Step 5: Verifying the fix...');\r\n    \r\n    const verifyDentists = await User.find({ \r\n      role: 'dentist', \r\n      isActive: true,\r\n      assignedClinics: { $in: [CLINIC_ID_STRING] }\r\n    });\r\n    \r\n    console.log(` Verification: ${verifyDentists.length} dentist(s) now assigned`);\r\n    \r\n    if (verifyDentists.length > 0) {\r\n      console.log(' SUCCESS! The following issues should now be resolved:');\r\n      console.log('   - 401 Unauthorized errors when fetching dentists');\r\n      console.log('   - Empty time slots in appointment booking');\r\n      console.log('   - \"No dentists in clinic\" conflict check messages');\r\n      console.log('\\n Try booking an appointment now - it should work!');\r\n    } else {\r\n      console.log(' Verification failed - no dentists assigned');\r\n    }\r\n\r\n    console.log('\\n === FIX COMPLETE ===');\r\n\r\n  } catch (error) {\r\n    console.error(' Error during fix:', error);\r\n  } finally {\r\n    await mongoose.disconnect();\r\n    console.log(' Disconnected from database');\r\n  }\r\n}\r\n\r\n// Run the fix if this file is executed directly\r\nif (require.main === module) {\r\n  fixDentistAssignment()\r\n    .then(() => process.exit(0))\r\n    .catch(error => {\r\n      console.error(' Unhandled error:', error);\r\n      process.exit(1);\r\n    });\r\n}\r\n\r\nexport default fixDentistAssignment;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1814,1817],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1814,1817],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1852,1855],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1852,1855],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1895,1898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1895,1898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1977,1980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1977,1980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2084,2087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2084,2087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import dotenv from 'dotenv';\n\n// Load environment variables\ndotenv.config();\n\nimport { connectDB } from '../config/database';\nimport { createAdminUser } from './adminSeeder';\nimport { seedMedications } from './medicationSeeder';\nimport { seedClinics } from './clinicSeeder';\nimport { createDentistUsers } from './dentistSeeder';\nimport { createPatientRecords } from './patientSeeder';\nimport { createDentistSchedules } from './dentistScheduleSeeder';\n\n/**\n * Main seeder function that runs all seeders\n */\nexport const runAllSeeders = async (): Promise<void> => {\n  try {\n    console.log(' Starting database seeding...');\n    \n    // Connect to database\n    await connectDB();\n    \n    // Run admin seeder first\n    await createAdminUser();\n    \n    // Run clinic seeder (required for dentists)\n    await seedClinics();\n    \n    // Run dentist seeder (creates dentist users)\n    await createDentistUsers();\n    \n    // Run patient seeder\n    await createPatientRecords();\n    \n    // Run medication seeder\n    await seedMedications();\n    \n    // Run dentist schedule seeder (set up working days)\n    await createDentistSchedules();\n    \n    console.log(' All seeders completed successfully!');\n    \n  } catch (error) {\n    console.error(' Seeding failed:', error);\n    throw error;\n  }\n};\n\n/**\n * Reset database function (use with caution)\n */\nexport const resetDatabase = async (): Promise<void> => {\n  try {\n    console.log('  WARNING: This will delete all data!');\n    \n    // Connect to database\n    await connectDB();\n    \n    // Import models\n    const { User, Patient, Clinic, Appointment, TreatmentRecord, Notification, Medication, Prescription, Billing, StaffSchedule } = await import('../models');\n    \n    // Delete all data\n    await Promise.all([\n      User.deleteMany({}),\n      (Patient as any).deleteMany({}),\n      (Clinic as any).deleteMany({}),\n      (Appointment as any).deleteMany({}),\n      TreatmentRecord.deleteMany({}),\n      (Notification as any).deleteMany({}),\n      Medication.deleteMany({}),\n      Prescription.deleteMany({}),\n      (Billing as any).deleteMany({}),\n      StaffSchedule.deleteMany({})\n    ]);\n    \n    console.log(' Database reset completed');\n    \n    // Run seeders after reset\n    await runAllSeeders();\n    \n  } catch (error) {\n    console.error(' Database reset failed:', error);\n    throw error;\n  }\n};\n\n// Run seeder if called directly\nif (require.main === module) {\n  const args = process.argv.slice(2);\n  const shouldReset = args.includes('--reset');\n  \n  const runSeeder = async () => {\n    try {\n      if (shouldReset) {\n        await resetDatabase();\n      } else {\n        await runAllSeeders();\n      }\n      process.exit(0);\n    } catch (error) {\n      console.error(' Seeder execution failed:', error);\n      process.exit(1);\n    }\n  };\n  \n  runSeeder();\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\medicationSeeder.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":131,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4455,4458],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4455,4458],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4672,4675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4672,4675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Medication } from '../models';\nimport { connectDB } from '../config/database';\n\ninterface MedicationData {\n  name: string;\n  genericName?: string;\n  dosage: string;\n  frequency: string;\n  duration: string;\n  instructions?: string;\n  sideEffects: string[];\n  contraindications: string[];\n  category: 'antibiotic' | 'painkiller' | 'anti-inflammatory' | 'anesthetic' | 'antiseptic' | 'other';\n  isActive: boolean;\n}\n\nconst medicationsData: MedicationData[] = [\n  {\n    name: 'Ibuprofen',\n    genericName: 'Ibuprofen',\n    dosage: '200mg, 400mg, 600mg',\n    frequency: '3-4 times daily',\n    duration: '3-5 days',\n    instructions: 'Take with food or milk to prevent stomach irritation. OTC, commonly used for headaches, muscle pain',\n    sideEffects: ['Stomach upset', 'Heartburn', 'Dizziness', 'Headache'],\n    contraindications: ['Stomach ulcers', 'Kidney disease', 'Heart disease'],\n    category: 'anti-inflammatory',\n    isActive: true\n  },\n  {\n    name: 'Amoxicillin',\n    genericName: 'Amoxicillin',\n    dosage: '250mg, 500mg',\n    frequency: '3 times daily',\n    duration: '7-10 days',\n    instructions: 'Take with food to reduce stomach upset. Used for ear infections, sinusitis',\n    sideEffects: ['Nausea', 'Diarrhea', 'Stomach upset', 'Allergic reactions'],\n    contraindications: ['Penicillin allergy', 'Severe kidney disease'],\n    category: 'antibiotic',\n    isActive: true\n  },\n  {\n    name: 'Lisinopril',\n    genericName: 'Lisinopril',\n    dosage: '5mg, 10mg, 20mg',\n    frequency: 'Once daily',\n    duration: 'Long-term',\n    instructions: 'ACE inhibitor, monitor for cough. For blood pressure control',\n    sideEffects: ['Dry cough', 'Dizziness', 'Headache', 'Fatigue'],\n    contraindications: ['ACE inhibitor allergy', 'Pregnancy', 'Severe kidney disease'],\n    category: 'other',\n    isActive: true\n  },\n  {\n    name: 'Metformin',\n    genericName: 'Metformin HCl',\n    dosage: '500mg, 850mg, 1000mg',\n    frequency: '2-3 times daily',\n    duration: 'Long-term',\n    instructions: 'Take with meals. Monitor for GI side effects. For type 2 diabetes',\n    sideEffects: ['Nausea', 'Diarrhea', 'Stomach upset', 'Metallic taste'],\n    contraindications: ['Severe kidney disease', 'Liver disease', 'Heart failure'],\n    category: 'other',\n    isActive: true\n  },\n  {\n    name: 'Albuterol',\n    genericName: 'Albuterol Sulfate',\n    dosage: '90mcg/inhalation',\n    frequency: 'As needed',\n    duration: 'As needed',\n    instructions: 'Inhaler, used as needed for wheezing. For asthma/COPD',\n    sideEffects: ['Tremor', 'Nervousness', 'Headache', 'Throat irritation'],\n    contraindications: ['Severe heart conditions', 'Hyperthyroidism'],\n    category: 'other',\n    isActive: true\n  },\n  {\n    name: 'Lidocaine',\n    genericName: 'Lidocaine HCl',\n    dosage: '2%',\n    frequency: 'As needed',\n    duration: 'Single application',\n    instructions: 'Apply topically to affected area',\n    sideEffects: ['Local irritation', 'Numbness', 'Allergic reactions'],\n    contraindications: ['Lidocaine allergy', 'Severe heart conditions'],\n    category: 'anesthetic',\n    isActive: true\n  },\n  {\n    name: 'Chlorhexidine',\n    genericName: 'Chlorhexidine Gluconate',\n    dosage: '0.12%',\n    frequency: '2 times daily',\n    duration: '7-14 days',\n    instructions: 'Rinse mouth for 30 seconds, do not swallow',\n    sideEffects: ['Tooth staining', 'Altered taste', 'Mouth irritation'],\n    contraindications: ['Chlorhexidine allergy'],\n    category: 'antiseptic',\n    isActive: true\n  },\n  {\n    name: 'Acetaminophen',\n    genericName: 'Paracetamol',\n    dosage: '500mg',\n    frequency: '4 times daily',\n    duration: '3-5 days',\n    instructions: 'Do not exceed 4000mg in 24 hours',\n    sideEffects: ['Rare allergic reactions', 'Liver damage with overdose'],\n    contraindications: ['Severe liver disease', 'Alcohol dependency'],\n    category: 'painkiller',\n    isActive: true\n  },\n  {\n    name: 'Clindamycin',\n    genericName: 'Clindamycin HCl',\n    dosage: '300mg',\n    frequency: '4 times daily',\n    duration: '7-10 days',\n    instructions: 'Take with full glass of water',\n    sideEffects: ['Diarrhea', 'Nausea', 'Abdominal pain', 'C. diff colitis'],\n    contraindications: ['Clindamycin allergy', 'History of C. diff infection'],\n    category: 'antibiotic',\n    isActive: true\n  }\n];\n\nexport const seedMedications = async (): Promise<void> => {\n  try {\n    // Check if medications already exist\n    const existingCount = await (Medication as any).countDocuments();\n    \n    if (existingCount > 0) {\n      console.log(` Medications already seeded (${existingCount} medications found)`);\n      return;\n    }\n\n    // Insert medications\n    await (Medication as any).insertMany(medicationsData);\n    \n    console.log(` Successfully seeded ${medicationsData.length} medications`);\n    \n  } catch (error) {\n    console.error(' Error seeding medications:', error);\n    throw error;\n  }\n};\n\n// Run seeder if called directly\nif (require.main === module) {\n  const runSeeder = async () => {\n    try {\n      await connectDB();\n      await seedMedications();\n      console.log(' Medication seeder completed successfully!');\n      process.exit(0);\n    } catch (error) {\n      console.error(' Medication seeder failed:', error);\n      process.exit(1);\n    }\n  };\n  \n  runSeeder();\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\seeders\\patientSeeder.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":71,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1526,1529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1526,1529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1781,1784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1781,1784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Patient, Clinic } from '../models';\nimport { connectDB } from '../config/database';\n\ninterface PatientData {\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone: string;\n  dateOfBirth: string;\n  gender: 'male' | 'female';\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    country: string;\n    zipCode: string;\n  };\n}\n\nconst patientData: PatientData[] = [\n  {\n    firstName: 'Ahmed',\n    lastName: 'Mohammed',\n    email: 'ahmed.mohammed@example.com',\n    phone: '+201234567890',\n    dateOfBirth: '1990-05-15',\n    gender: 'male',\n    address: {\n      street: '123 Main Street',\n      city: 'Cairo',\n      state: 'Cairo',\n      country: 'Egypt',\n      zipCode: '12345'\n    }\n  },\n  {\n    firstName: 'Fatima',\n    lastName: 'Ali',\n    email: 'fatima.ali@example.com',\n    phone: '+201234567891',\n    dateOfBirth: '1985-08-22',\n    gender: 'female',\n    address: {\n      street: '456 Oak Avenue',\n      city: 'Alexandria',\n      state: 'Alexandria',\n      country: 'Egypt',\n      zipCode: '54321'\n    }\n  },\n  {\n    firstName: 'Omar',\n    lastName: 'Hassan',\n    email: 'omar.hassan@example.com',\n    phone: '+201234567892',\n    dateOfBirth: '1995-03-10',\n    gender: 'male',\n    address: {\n      street: '789 Pine Road',\n      city: 'Giza',\n      state: 'Giza',\n      country: 'Egypt',\n      zipCode: '67890'\n    }\n  }\n];\n\nexport const createPatientRecords = async (): Promise<void> => {\n  try {\n    // Get the first clinic to assign patients to\n    const clinic = await (Clinic as any).findOne();\n    if (!clinic) {\n      console.log(' No clinic found. Cannot assign patients.');\n      return;\n    }\n\n    for (const patientInfo of patientData) {\n      // Check if patient already exists\n      const existingPatient = await (Patient as any).findOne({ email: patientInfo.email });\n      \n      if (existingPatient) {\n        console.log(` Patient already exists: ${patientInfo.firstName} ${patientInfo.lastName}`);\n        continue;\n      }\n\n      // Create patient record\n      const patient = new Patient({\n        ...patientInfo,\n        preferredClinicId: clinic._id\n      });\n\n      await patient.save();\n      \n      console.log(` Patient created: ${patientInfo.firstName} ${patientInfo.lastName}`);\n      console.log(` Email: ${patientInfo.email}`);\n      console.log(` Phone: ${patientInfo.phone}`);\n      console.log(` Preferred clinic: ${clinic.name}`);\n      console.log('');\n    }\n    \n    console.log(' Patient seeding completed successfully!');\n    \n  } catch (error) {\n    console.error(' Error creating patient records:', error);\n    throw error;\n  }\n};\n\n// Run seeder if called directly\nif (require.main === module) {\n  const runSeeder = async () => {\n    try {\n      await connectDB();\n      await createPatientRecords();\n      console.log(' Patient seeder completed successfully!');\n      process.exit(0);\n    } catch (error) {\n      console.error(' Patient seeder failed:', error);\n      process.exit(1);\n    }\n  };\n  \n  runSeeder();\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\server.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mongoose' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":10,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import dotenv from 'dotenv';\r\nimport app from './app';\r\nimport { initWebSocket } from './utils/websocketInstance';\r\n\r\n// Load environment variables\r\ndotenv.config(); // Trigger restart\r\nconst PORT = parseInt(process.env.PORT || '3001', 10);\r\n\r\n// Check database connection state\r\nconst mongoose = require('mongoose');\r\n\r\n// Start server\r\nconst server = app.listen(PORT, '0.0.0.0', () => {\r\n  console.log(` Server running in ${process.env.NODE_ENV || 'development'} mode on port ${PORT}`);\r\n});\r\n\r\n// Initialize WebSocketService\r\ninitWebSocket(server);\r\n\r\n// Handle server errors\r\nserver.on('error', (error: NodeJS.ErrnoException) => {\r\n  if (error.syscall !== 'listen') {\r\n    throw error;\r\n  }\r\n\r\n  const bind = typeof PORT === 'string' ? 'Pipe ' + PORT : 'Port ' + PORT;\r\n\r\n  switch (error.code) {\r\n    case 'EACCES':\r\n      console.error(` ${bind} requires elevated privileges`);\r\n      process.exit(1);\r\n      break;\r\n    case 'EADDRINUSE':\r\n      console.error(` ${bind} is already in use`);\r\n      process.exit(1);\r\n      break;\r\n    default:\r\n      throw error;\r\n  }\r\n});\r\n\r\n// Graceful shutdown\r\nconst gracefulShutdown = (signal: string) => {\r\n  console.log(`\\n ${signal} received. Starting graceful shutdown...`);\r\n  \r\n  server.close((err) => {\r\n    if (err) {\r\n      console.error(' Error during server shutdown:', err);\r\n      process.exit(1);\r\n    }\r\n    \r\n    console.log(' Server closed successfully');\r\n    \r\n    // Close database connection\r\n    // Note: mongoose.connection.close() is handled in the database config\r\n    \r\n    console.log(' Graceful shutdown completed');\r\n    process.exit(0);\r\n  });\r\n  \r\n  // Force close after 10 seconds\r\n  setTimeout(() => {\r\n    console.error(' Forcing shutdown after 10 seconds...');\r\n    process.exit(1);\r\n  }, 10000);\r\n};\r\n\r\n// Listen for termination signals\r\nprocess.on('SIGTERM', () => gracefulShutdown('SIGTERM'));\r\nprocess.on('SIGINT', () => gracefulShutdown('SIGINT'));\r\n\r\n// Handle unhandled promise rejections\r\nprocess.on('unhandledRejection', (err: Error) => {\r\n  console.error('Unhandled Promise Rejection:', err.message);\r\n  process.exit(1);\r\n});\r\n\r\n// Handle uncaught exceptions\r\nprocess.on('uncaughtException', (err: Error) => {\r\n  console.error('Uncaught Exception:', err.message);\r\n  process.exit(1);\r\n});\r\n\r\nexport default app;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\services\\NotificationService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Notification' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cancelJob' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":32},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[329,332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[329,332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[712,715],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[712,715],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":61,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2584,2587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2584,2587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":136,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5410,5413],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5410,5413],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5732,5735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5732,5735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5864,5867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5864,5867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6111,6114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6111,6114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6366,6369],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6366,6369],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":162,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6423,6426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6423,6426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":179,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6942,6945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6942,6945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7782,7785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7782,7785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7889,7892],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7889,7892],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":284,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":284,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11051,11054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11051,11054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":350,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":350,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13138,13141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13138,13141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":351,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":351,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13162,13165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13162,13165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Appointment, Patient, Prescription, Notification } from '../models';\nimport { createAndSendNotification } from '../utils/notificationHelpers';\nimport { scheduleJob, cancelJob } from 'node-schedule';\n\nexport class NotificationService {\n  private static instance: NotificationService;\n  private scheduledJobs: Map<string, any> = new Map();\n\n  public static getInstance(): NotificationService {\n    if (!NotificationService.instance) {\n      NotificationService.instance = new NotificationService();\n    }\n    return NotificationService.instance;\n  }\n\n  // Schedule appointment reminder\n  async scheduleAppointmentReminder(appointmentId: string) {\n    try {\n      const appointment = await (Appointment as any).findById(appointmentId)\n        .populate('patientId', 'firstName lastName userId')\n        .populate('dentistId', 'firstName lastName')\n        .populate('clinicId', 'name address phone');\n\n      if (!appointment || !appointment.patientId.userId) {\n        console.log(`Appointment not found or patient has no user account: ${appointmentId}`);\n        return;\n      }\n\n      const appointmentDate = new Date(appointment.date);\n      const [hours, minutes] = appointment.timeSlot.split(':').map(Number);\n      appointmentDate.setHours(hours, minutes, 0, 0);\n\n      // Schedule reminders based on notification preferences\n      const reminderTimes = appointment.notificationPreferences.reminderTimes || [24];\n      \n      reminderTimes.forEach((hoursBeforeAppointment: number) => {\n        const reminderTime = new Date(appointmentDate.getTime() - (hoursBeforeAppointment * 60 * 60 * 1000));\n        \n        // Only schedule if reminder time is in the future\n        if (reminderTime > new Date()) {\n          const jobName = `appointment_reminder_${appointmentId}_${hoursBeforeAppointment}h`;\n          \n          const job = scheduleJob(jobName, reminderTime, async () => {\n            await this.sendAppointmentReminder(appointmentId, hoursBeforeAppointment);\n            this.scheduledJobs.delete(jobName);\n          });\n\n          this.scheduledJobs.set(jobName, job);\n          console.log(`Scheduled appointment reminder for ${appointment.patientId.firstName} ${appointment.patientId.lastName} - ${hoursBeforeAppointment}h before appointment`);\n        }\n      });\n\n    } catch (error) {\n      console.error('Error scheduling appointment reminder:', error);\n    }\n  }\n\n  // Send appointment reminder notification\n  async sendAppointmentReminder(appointmentId: string, hoursBeforeAppointment: number) {\n    try {\n      const appointment = await (Appointment as any).findById(appointmentId)\n        .populate('patientId', 'firstName lastName userId')\n        .populate('dentistId', 'firstName lastName specialization')\n        .populate('clinicId', 'name address phone');\n\n      if (!appointment || !appointment.patientId.userId) {\n        console.log(`Appointment not found for reminder: ${appointmentId}`);\n        return;\n      }\n\n      let timeText = '';\n      if (hoursBeforeAppointment === 24) {\n        timeText = 'tomorrow';\n      } else if (hoursBeforeAppointment === 1) {\n        timeText = 'in 1 hour';\n      } else if (hoursBeforeAppointment < 24) {\n        timeText = `in ${hoursBeforeAppointment} hours`;\n      } else {\n        timeText = `in ${Math.floor(hoursBeforeAppointment / 24)} days`;\n      }\n\n      const dentistInfo = appointment.dentistId ? \n        ` with Dr. ${appointment.dentistId.firstName} ${appointment.dentistId.lastName}` : \n        '';\n\n      await createAndSendNotification({\n        userId: appointment.patientId.userId.toString(),\n        title: 'Upcoming Appointment Reminder',\n        message: `Your appointment${dentistInfo} is scheduled for ${timeText} at ${appointment.timeSlot} on ${appointment.date.toDateString()}`,\n        type: 'appointment_reminder',\n        link: `/appointments/${appointment._id}`,\n        metadata: {\n          appointmentId: appointment._id,\n          clinicName: appointment.clinicId.name,\n          clinicAddress: appointment.clinicId.address,\n          clinicPhone: appointment.clinicId.phone,\n          date: appointment.date,\n          time: appointment.timeSlot,\n          serviceType: appointment.serviceType,\n          dentistName: appointment.dentistId ? \n            `${appointment.dentistId.firstName} ${appointment.dentistId.lastName}` : \n            'To be assigned',\n          hoursUntilAppointment: hoursBeforeAppointment\n        }\n      });\n\n    } catch (error) {\n      console.error('Error sending appointment reminder:', error);\n    }\n  }\n\n  // Cancel appointment reminders\n  async cancelAppointmentReminders(appointmentId: string) {\n    try {\n      // Find and cancel all scheduled jobs for this appointment\n      const jobsToCancel = Array.from(this.scheduledJobs.keys())\n        .filter(jobName => jobName.startsWith(`appointment_reminder_${appointmentId}`));\n\n      jobsToCancel.forEach(jobName => {\n        const job = this.scheduledJobs.get(jobName);\n        if (job) {\n          job.cancel();\n          this.scheduledJobs.delete(jobName);\n          console.log(`Cancelled appointment reminder job: ${jobName}`);\n        }\n      });\n\n    } catch (error) {\n      console.error('Error cancelling appointment reminders:', error);\n    }\n  }\n\n  // Schedule medication reminders for a patient\n  async scheduleMedicationReminders(patientId: string) {\n    try {\n      const patient = await (Patient as any).findById(patientId)\n        .populate('medicationHistory.prescribedBy', 'firstName lastName');\n\n      if (!patient || !patient.userId) {\n        console.log(`Patient not found or has no user account: ${patientId}`);\n        return;\n      }\n\n      // Get active medications\n      const activeMedications = (patient as any).getActiveMedications();\n      \n      // Also get active prescriptions\n      const activePrescriptions = await (Prescription as any).findActive(patientId);\n\n      // Clear existing medication reminders for this patient\n      await this.cancelMedicationReminders(patientId);\n\n      // Schedule reminders for medications in history\n      activeMedications.forEach((medication: any) => {\n        if (medication.frequency) {\n          this.scheduleMedicationReminderTimes(patientId, medication, 'history');\n        }\n      });\n\n      // Schedule reminders for prescription medications\n      activePrescriptions.forEach((prescription: any) => {\n        prescription.medications.forEach((med: any) => {\n          if (med.frequency) {\n            this.scheduleMedicationReminderTimes(patientId, {\n              ...med,\n              prescriptionId: prescription._id,\n              medicationName: med.medicationId.name\n            }, 'prescription');\n          }\n        });\n      });\n\n    } catch (error) {\n      console.error('Error scheduling medication reminders:', error);\n    }\n  }\n\n  // Schedule individual medication reminder times\n  private scheduleMedicationReminderTimes(patientId: string, medication: any, source: 'history' | 'prescription') {\n    const times = this.parseFrequencyToTimes(medication.frequency);\n    \n    times.forEach((time: string) => {\n      const jobName = `medication_reminder_${patientId}_${medication._id || medication.medicationId}_${time}`;\n      \n      // Schedule daily recurring job at the specified time\n      const job = scheduleJob(jobName, `0 ${time.split(':')[1]} ${time.split(':')[0]} * * *`, async () => {\n        await this.sendMedicationReminder(patientId, medication, time, source);\n      });\n\n      if (job) {\n        this.scheduledJobs.set(jobName, job);\n        console.log(`Scheduled medication reminder for patient ${patientId}: ${medication.medicationName} at ${time}`);\n      }\n    });\n  }\n\n  // Send medication reminder notification\n  async sendMedicationReminder(patientId: string, medication: any, time: string, source: 'history' | 'prescription') {\n    try {\n      const patient = await (Patient as any).findById(patientId);\n      if (!patient || !patient.userId) {\n        console.log(`Patient not found for medication reminder: ${patientId}`);\n        return;\n      }\n\n      const medicationName = medication.medicationName || medication.name;\n      const dosageInfo = medication.dosage ? ` (${medication.dosage})` : '';\n\n      await createAndSendNotification({\n        userId: patient.userId.toString(),\n        title: 'Medication Reminder',\n        message: `Time to take your medication: ${medicationName}${dosageInfo}`,\n        type: 'general',\n        link: source === 'prescription' ? \n          `/prescriptions/${medication.prescriptionId}` : \n          `/medical-record/medications`,\n        metadata: {\n          patientId: patientId,\n          medicationName: medicationName,\n          dosage: medication.dosage,\n          time: time,\n          frequency: medication.frequency,\n          instructions: medication.instructions,\n          source: source,\n          ...(medication.prescriptionId && { prescriptionId: medication.prescriptionId })\n        }\n      });\n\n    } catch (error) {\n      console.error('Error sending medication reminder:', error);\n    }\n  }\n\n  // Cancel medication reminders for a patient\n  async cancelMedicationReminders(patientId: string) {\n    try {\n      const jobsToCancel = Array.from(this.scheduledJobs.keys())\n        .filter(jobName => jobName.startsWith(`medication_reminder_${patientId}`));\n\n      jobsToCancel.forEach(jobName => {\n        const job = this.scheduledJobs.get(jobName);\n        if (job) {\n          job.cancel();\n          this.scheduledJobs.delete(jobName);\n        }\n      });\n\n      console.log(`Cancelled ${jobsToCancel.length} medication reminder jobs for patient ${patientId}`);\n\n    } catch (error) {\n      console.error('Error cancelling medication reminders:', error);\n    }\n  }\n\n  // Parse frequency string to specific times\n  private parseFrequencyToTimes(frequency: string): string[] {\n    const times: string[] = [];\n    const freq = frequency.toLowerCase();\n    \n    if (freq.includes('once') || freq.includes('1 time') || freq.includes('daily')) {\n      times.push('08:00');\n    } else if (freq.includes('twice') || freq.includes('2 times') || freq.includes('bid')) {\n      times.push('08:00', '20:00');\n    } else if (freq.includes('three times') || freq.includes('3 times') || freq.includes('tid')) {\n      times.push('08:00', '14:00', '20:00');\n    } else if (freq.includes('four times') || freq.includes('4 times') || freq.includes('qid')) {\n      times.push('08:00', '12:00', '16:00', '20:00');\n    } else if (freq.includes('every 8 hours')) {\n      times.push('08:00', '16:00', '00:00');\n    } else if (freq.includes('every 6 hours')) {\n      times.push('06:00', '12:00', '18:00', '00:00');\n    } else if (freq.includes('every 4 hours')) {\n      times.push('08:00', '12:00', '16:00', '20:00', '00:00', '04:00');\n    } else {\n      times.push('08:00'); // Default to morning\n    }\n    \n    return times;\n  }\n\n  // Send notification when appointment is confirmed\n  async sendAppointmentConfirmation(appointmentId: string) {\n    try {\n      const appointment = await (Appointment as any).findById(appointmentId)\n        .populate('patientId', 'firstName lastName userId')\n        .populate('dentistId', 'firstName lastName specialization')\n        .populate('clinicId', 'name address phone');\n\n      if (!appointment || !appointment.patientId.userId) {\n        return;\n      }\n\n      const dentistInfo = appointment.dentistId ? \n        ` with Dr. ${appointment.dentistId.firstName} ${appointment.dentistId.lastName}` : \n        '';\n\n      await createAndSendNotification({\n        userId: appointment.patientId.userId.toString(),\n        title: 'Appointment Confirmed',\n        message: `Your appointment${dentistInfo} has been confirmed for ${appointment.date.toDateString()} at ${appointment.timeSlot}`,\n        type: 'appointment_confirmation',\n        link: `/appointments/${appointment._id}`,\n        metadata: {\n          appointmentId: appointment._id,\n          clinicName: appointment.clinicId.name,\n          date: appointment.date,\n          time: appointment.timeSlot,\n          serviceType: appointment.serviceType\n        }\n      });\n\n      // Schedule reminders for this appointment\n      await this.scheduleAppointmentReminder(appointmentId);\n\n    } catch (error) {\n      console.error('Error sending appointment confirmation:', error);\n    }\n  }\n\n  // Clean up expired jobs\n  async cleanupExpiredJobs() {\n    try {\n      const now = new Date();\n      const jobsToRemove: string[] = [];\n\n      this.scheduledJobs.forEach((job, jobName) => {\n        if (job.nextInvocation() === null || job.nextInvocation() < now) {\n          job.cancel();\n          jobsToRemove.push(jobName);\n        }\n      });\n\n      jobsToRemove.forEach(jobName => {\n        this.scheduledJobs.delete(jobName);\n      });\n\n      console.log(`Cleaned up ${jobsToRemove.length} expired notification jobs`);\n\n    } catch (error) {\n      console.error('Error cleaning up expired jobs:', error);\n    }\n  }\n\n  // Get active scheduled jobs count\n  getActiveJobsCount(): number {\n    return this.scheduledJobs.size;\n  }\n\n  // Get scheduled jobs info for debugging\n  getScheduledJobsInfo(): any[] {\n    const jobs: any[] = [];\n    this.scheduledJobs.forEach((job, jobName) => {\n      jobs.push({\n        name: jobName,\n        nextRun: job.nextInvocation()?.toISOString(),\n        type: jobName.startsWith('appointment_') ? 'appointment' : 'medication'\n      });\n    });\n    return jobs;\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\services\\PayPalService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":57,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1654,1657],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1654,1657],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1917,1920],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1917,1920],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2324,2327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2324,2327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3960,3963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3960,3963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7869,7872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7869,7872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axios from 'axios';\n\ninterface PayPalTokenResponse {\n  access_token: string;\n  token_type: string;\n  expires_in: number;\n}\n\nexport class PayPalService {\n  private baseURL: string;\n  private clientId: string;\n  private clientSecret: string;\n  private accessToken: string | null = null;\n  private tokenExpiry: number = 0;\n\n  constructor() {\n    this.baseURL = process.env.PAYPAL_ENVIRONMENT === 'production' \n      ? 'https://api.paypal.com'\n      : 'https://api.sandbox.paypal.com';\n\n    this.clientId = process.env.PAYPAL_CLIENT_ID!;\n    this.clientSecret = process.env.PAYPAL_CLIENT_SECRET!;\n\n    if (!this.clientId || !this.clientSecret) {\n      throw new Error('PayPal client ID and secret are required');\n    }\n  }\n\n  /**\n   * Get access token from PayPal\n   */\n  private async getAccessToken(): Promise<string> {\n    // Return cached token if still valid\n    if (this.accessToken && Date.now() < this.tokenExpiry) {\n      return this.accessToken;\n    }\n\n    try {\n      const auth = Buffer.from(`${this.clientId}:${this.clientSecret}`).toString('base64');\n      \n      const response = await axios.post<PayPalTokenResponse>(\n        `${this.baseURL}/v1/oauth2/token`,\n        'grant_type=client_credentials',\n        {\n          headers: {\n            'Authorization': `Basic ${auth}`,\n            'Content-Type': 'application/x-www-form-urlencoded',\n            'Accept': 'application/json'\n          }\n        }\n      );\n\n      this.accessToken = response.data.access_token;\n      this.tokenExpiry = Date.now() + (response.data.expires_in * 1000) - 60000; // Subtract 1 minute for safety\n\n      return this.accessToken;\n    } catch (error: any) {\n      throw new Error(`PayPal token generation failed: ${error.response?.data?.error_description || error.message}`);\n    }\n  }\n\n  /**\n   * Make authenticated request to PayPal API\n   */\n  private async makeRequest(method: string, endpoint: string, data?: any) {\n    const token = await this.getAccessToken();\n    \n    const config = {\n      method,\n      url: `${this.baseURL}${endpoint}`,\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      data\n    };\n\n    try {\n      const response = await axios(config);\n      return response.data;\n    } catch (error: any) {\n      throw new Error(`PayPal API request failed: ${error.response?.data?.message || error.message}`);\n    }\n  }\n\n  /**\n   * Create an order\n   */\n  async createOrder(params: {\n    amount: number;\n    currency: string;\n    description?: string;\n    invoiceId?: string;\n  }) {\n    const { amount, currency, description, invoiceId } = params;\n\n    const orderData = {\n      intent: 'CAPTURE',\n      purchase_units: [{\n        reference_id: invoiceId || `order_${Date.now()}`,\n        description: description || 'Payment for services',\n        amount: {\n          currency_code: currency.toUpperCase(),\n          value: amount.toFixed(2)\n        }\n      }],\n      application_context: {\n        brand_name: process.env.CLINIC_NAME || 'Smart Clinic',\n        landing_page: 'NO_PREFERENCE',\n        user_action: 'PAY_NOW',\n        return_url: `${process.env.FRONTEND_URL}/payment/success`,\n        cancel_url: `${process.env.FRONTEND_URL}/payment/cancelled`\n      }\n    };\n\n    return await this.makeRequest('POST', '/v2/checkout/orders', orderData);\n  }\n\n  /**\n   * Capture an order\n   */\n  async captureOrder(orderId: string) {\n    return await this.makeRequest('POST', `/v2/checkout/orders/${orderId}/capture`);\n  }\n\n  /**\n   * Get order details\n   */\n  async getOrder(orderId: string) {\n    return await this.makeRequest('GET', `/v2/checkout/orders/${orderId}`);\n  }\n\n  /**\n   * Refund a captured payment\n   */\n  async refundCapture(params: {\n    captureId: string;\n    amount?: number;\n    currency?: string;\n    reason?: string;\n  }) {\n    const { captureId, amount, currency = 'USD', reason } = params;\n\n    const refundData: any = {\n      note_to_payer: reason || 'Refund processed'\n    };\n\n    if (amount) {\n      refundData.amount = {\n        value: amount.toFixed(2),\n        currency_code: currency.toUpperCase()\n      };\n    }\n\n    return await this.makeRequest('POST', `/v2/payments/captures/${captureId}/refund`, refundData);\n  }\n\n  /**\n   * Get capture details\n   */\n  async getCapture(captureId: string) {\n    return await this.makeRequest('GET', `/v2/payments/captures/${captureId}`);\n  }\n\n  /**\n   * Get refund details\n   */\n  async getRefund(refundId: string) {\n    return await this.makeRequest('GET', `/v2/payments/refunds/${refundId}`);\n  }\n\n  /**\n   * Create a subscription plan\n   */\n  async createSubscriptionPlan(params: {\n    name: string;\n    description: string;\n    amount: number;\n    currency: string;\n    interval: 'MONTH' | 'YEAR';\n  }) {\n    const { name, description, amount, currency, interval } = params;\n\n    const planData = {\n      product_id: await this.createProduct({ name, description }),\n      name,\n      description,\n      status: 'ACTIVE',\n      billing_cycles: [{\n        frequency: {\n          interval_unit: interval,\n          interval_count: 1\n        },\n        tenure_type: 'REGULAR',\n        sequence: 1,\n        total_cycles: 0, // Infinite cycles\n        pricing_scheme: {\n          fixed_price: {\n            value: amount.toFixed(2),\n            currency_code: currency.toUpperCase()\n          }\n        }\n      }],\n      payment_preferences: {\n        auto_bill_outstanding: true,\n        setup_fee_failure_action: 'CONTINUE',\n        payment_failure_threshold: 3\n      }\n    };\n\n    return await this.makeRequest('POST', '/v1/billing/plans', planData);\n  }\n\n  /**\n   * Create a product (required for subscription plans)\n   */\n  private async createProduct(params: { name: string; description: string }) {\n    const { name, description } = params;\n\n    const productData = {\n      name,\n      description,\n      type: 'SERVICE',\n      category: 'HEALTHCARE'\n    };\n\n    const product = await this.makeRequest('POST', '/v1/catalogs/products', productData);\n    return product.id;\n  }\n\n  /**\n   * Create a subscription\n   */\n  async createSubscription(params: {\n    planId: string;\n    subscriberName?: string;\n    subscriberEmail?: string;\n  }) {\n    const { planId, subscriberName, subscriberEmail } = params;\n\n    const subscriptionData = {\n      plan_id: planId,\n      start_time: new Date().toISOString(),\n      subscriber: {\n        name: {\n          given_name: subscriberName?.split(' ')[0] || 'Subscriber',\n          surname: subscriberName?.split(' ')[1] || ''\n        },\n        email_address: subscriberEmail\n      },\n      application_context: {\n        brand_name: process.env.CLINIC_NAME || 'Smart Clinic',\n        user_action: 'SUBSCRIBE_NOW',\n        payment_method: {\n          payer_selected: 'PAYPAL',\n          payee_preferred: 'IMMEDIATE_PAYMENT_REQUIRED'\n        },\n        return_url: `${process.env.FRONTEND_URL}/subscription/success`,\n        cancel_url: `${process.env.FRONTEND_URL}/subscription/cancelled`\n      }\n    };\n\n    return await this.makeRequest('POST', '/v1/billing/subscriptions', subscriptionData);\n  }\n\n  /**\n   * Get subscription details\n   */\n  async getSubscription(subscriptionId: string) {\n    return await this.makeRequest('GET', `/v1/billing/subscriptions/${subscriptionId}`);\n  }\n\n  /**\n   * Cancel a subscription\n   */\n  async cancelSubscription(subscriptionId: string, reason?: string) {\n    const cancelData = {\n      reason: reason || 'Cancelled by user'\n    };\n\n    return await this.makeRequest('POST', `/v1/billing/subscriptions/${subscriptionId}/cancel`, cancelData);\n  }\n\n  /**\n   * Verify webhook signature\n   */\n  async verifyWebhookSignature(params: {\n    authAlgo: string;\n    transmission_id: string;\n    cert_id: string;\n    payload: string;\n    transmission_time: string;\n    webhook_id: string;\n    webhook_event: any;\n  }) {\n    const verifyData = {\n      auth_algo: params.authAlgo,\n      transmission_id: params.transmission_id,\n      cert_id: params.cert_id,\n      raw_body: params.payload,\n      transmission_time: params.transmission_time,\n      webhook_id: params.webhook_id,\n      webhook_event: params.webhook_event\n    };\n\n    return await this.makeRequest('POST', '/v1/notifications/verify-webhook-signature', verifyData);\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\services\\StripeService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1167,1170],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1167,1170],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":57,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1548,1551],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1548,1551],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1803,1806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1803,1806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2000,2003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2000,2003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2539,2542],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2539,2542],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2686,2689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2686,2689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":109,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2967,2970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2967,2970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3447,3450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3447,3450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3955,3958],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3955,3958],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":162,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4224,4227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4224,4227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4676,4679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4676,4679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":189,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5014,5017],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5014,5017],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5048,5051],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5048,5051],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5347,5350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5347,5350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":213,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5676,5679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5676,5679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":235,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6332,6335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6332,6335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6620,6623],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6620,6623],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":257,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":257,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6908,6911],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6908,6911],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":268,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7143,7146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7143,7146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":279,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":279,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7436,7439],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7436,7439],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Stripe from 'stripe';\n\nexport class StripeService {\n  private stripe: Stripe;\n\n  constructor() {\n    const secretKey = process.env.STRIPE_SECRET_KEY;\n    if (!secretKey) {\n      throw new Error('STRIPE_SECRET_KEY environment variable is required');\n    }\n\n    this.stripe = new Stripe(secretKey, {\n      apiVersion: '2025-08-27.basil',\n      typescript: true\n    });\n  }\n\n  /**\n   * Create a payment intent\n   */\n  async createPaymentIntent(params: {\n    amount: number;\n    currency: string;\n    metadata?: Record<string, string>;\n    customerId?: string;\n    paymentMethodTypes?: string[];\n  }) {\n    try {\n      const { amount, currency, metadata, customerId, paymentMethodTypes = ['card'] } = params;\n\n      const paymentIntent = await this.stripe.paymentIntents.create({\n        amount: Math.round(amount * 100), // Convert to cents\n        currency: currency.toLowerCase(),\n        payment_method_types: paymentMethodTypes,\n        metadata: metadata || {},\n        customer: customerId,\n        automatic_payment_methods: {\n          enabled: true,\n          allow_redirects: 'never'\n        }\n      });\n\n      return paymentIntent;\n    } catch (error: any) {\n      throw new Error(`Stripe Payment Intent creation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Retrieve a payment intent\n   */\n  async retrievePaymentIntent(paymentIntentId: string) {\n    try {\n      return await this.stripe.paymentIntents.retrieve(paymentIntentId, {\n        expand: ['charges', 'charges.data.payment_method_details']\n      });\n    } catch (error: any) {\n      throw new Error(`Stripe Payment Intent retrieval failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Confirm a payment intent\n   */\n  async confirmPaymentIntent(paymentIntentId: string, paymentMethodId?: string) {\n    try {\n      const params: any = {};\n      if (paymentMethodId) {\n        params.payment_method = paymentMethodId;\n      }\n\n      return await this.stripe.paymentIntents.confirm(paymentIntentId, params);\n    } catch (error: any) {\n      throw new Error(`Stripe Payment Intent confirmation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Create a refund\n   */\n  async createRefund(params: {\n    paymentIntentId: string;\n    amount?: number;\n    reason?: string;\n  }) {\n    try {\n      const { paymentIntentId, amount, reason } = params;\n\n      // First get the payment intent to find the charge\n      const paymentIntent = await this.stripe.paymentIntents.retrieve(paymentIntentId, {\n        expand: ['charges']\n      });\n\n      const charge = (paymentIntent as any).charges?.data[0];\n      if (!charge) {\n        throw new Error('No charge found for this payment intent');\n      }\n\n      const refundParams: any = {\n        charge: charge.id,\n        reason: reason || 'requested_by_customer'\n      };\n\n      if (amount) {\n        refundParams.amount = Math.round(amount * 100); // Convert to cents\n      }\n\n      return await this.stripe.refunds.create(refundParams);\n    } catch (error: any) {\n      throw new Error(`Stripe refund creation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Create a customer\n   */\n  async createCustomer(params: {\n    email?: string;\n    name?: string;\n    phone?: string;\n    metadata?: Record<string, string>;\n  }) {\n    try {\n      return await this.stripe.customers.create({\n        email: params.email,\n        name: params.name,\n        phone: params.phone,\n        metadata: params.metadata || {}\n      });\n    } catch (error: any) {\n      throw new Error(`Stripe customer creation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Update a customer\n   */\n  async updateCustomer(customerId: string, params: {\n    email?: string;\n    name?: string;\n    phone?: string;\n    metadata?: Record<string, string>;\n  }) {\n    try {\n      return await this.stripe.customers.update(customerId, {\n        email: params.email,\n        name: params.name,\n        phone: params.phone,\n        metadata: params.metadata\n      });\n    } catch (error: any) {\n      throw new Error(`Stripe customer update failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Retrieve a customer\n   */\n  async retrieveCustomer(customerId: string) {\n    try {\n      return await this.stripe.customers.retrieve(customerId);\n    } catch (error: any) {\n      throw new Error(`Stripe customer retrieval failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Create a setup intent for saving payment methods\n   */\n  async createSetupIntent(customerId: string, paymentMethodTypes: string[] = ['card']) {\n    try {\n      return await this.stripe.setupIntents.create({\n        customer: customerId,\n        payment_method_types: paymentMethodTypes,\n        usage: 'off_session'\n      });\n    } catch (error: any) {\n      throw new Error(`Stripe Setup Intent creation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * List payment methods for a customer\n   */\n  async listPaymentMethods(customerId: string, type: string = 'card') {\n    try {\n      return await this.stripe.paymentMethods.list({\n        customer: customerId,\n        type: type as any\n      });\n    } catch (error: any) {\n      throw new Error(`Stripe payment methods retrieval failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Detach a payment method\n   */\n  async detachPaymentMethod(paymentMethodId: string) {\n    try {\n      return await this.stripe.paymentMethods.detach(paymentMethodId);\n    } catch (error: any) {\n      throw new Error(`Stripe payment method detachment failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Handle webhook events\n   */\n  constructEvent(payload: string | Buffer, signature: string, secret: string) {\n    try {\n      return this.stripe.webhooks.constructEvent(payload, signature, secret);\n    } catch (error: any) {\n      throw new Error(`Stripe webhook verification failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Create a subscription\n   */\n  async createSubscription(params: {\n    customerId: string;\n    priceId: string;\n    metadata?: Record<string, string>;\n  }) {\n    try {\n      return await this.stripe.subscriptions.create({\n        customer: params.customerId,\n        items: [{ price: params.priceId }],\n        metadata: params.metadata || {},\n        payment_behavior: 'default_incomplete',\n        payment_settings: { save_default_payment_method: 'on_subscription' },\n        expand: ['latest_invoice.payment_intent']\n      });\n    } catch (error: any) {\n      throw new Error(`Stripe subscription creation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get subscription\n   */\n  async retrieveSubscription(subscriptionId: string) {\n    try {\n      return await this.stripe.subscriptions.retrieve(subscriptionId);\n    } catch (error: any) {\n      throw new Error(`Stripe subscription retrieval failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Cancel subscription\n   */\n  async cancelSubscription(subscriptionId: string) {\n    try {\n      return await this.stripe.subscriptions.cancel(subscriptionId);\n    } catch (error: any) {\n      throw new Error(`Stripe subscription cancellation failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get balance\n   */\n  async getBalance() {\n    try {\n      return await this.stripe.balance.retrieve();\n    } catch (error: any) {\n      throw new Error(`Stripe balance retrieval failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get dashboard URL for Express accounts\n   */\n  async createLoginLink(accountId: string) {\n    try {\n      return await this.stripe.accounts.createLoginLink(accountId);\n    } catch (error: any) {\n      throw new Error(`Stripe login link creation failed: ${error.message}`);\n    }\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\services\\ePrescribingService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":201,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":201,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5721,5724],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5721,5724],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6427,6430],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6427,6430],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6825,6828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6825,6828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":260,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7562,7565],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7562,7565],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":268,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7877,7880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7877,7880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":308,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":308,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9022,9025],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9022,9025],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":338,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":338,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9859,9862],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9859,9862],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":345,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10052,10055],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10052,10055],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":385,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":385,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10948,10951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10948,10951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ePrescribing Service - Surescripts Integration\n * \n * This service provides integration with Surescripts (or compatible) e-prescribing APIs\n * Handles electronic prescription sending, medication history, and formulary checking\n */\n\nimport axios, { AxiosInstance } from 'axios';\nimport { AppError } from '../middleware/errorHandler';\n\ninterface SurescriptsConfig {\n  baseUrl: string;\n  apiKey: string;\n  username: string;\n  password: string;\n  practiceId: string;\n  environment: 'sandbox' | 'production';\n}\n\ninterface Medication {\n  ndc: string; // National Drug Code\n  name: string;\n  genericName?: string;\n  strength: string;\n  dosageForm: string;\n}\n\ninterface PrescriptionRequest {\n  patientId: string;\n  prescriberId: string;\n  medication: Medication;\n  directions: string;\n  quantity: number;\n  refills: number;\n  daysSupply: number;\n  pharmacyNCPDP?: string; // Pharmacy identifier\n  substitutionAllowed: boolean;\n  priorAuthorizationRequired?: boolean;\n}\n\ninterface MedicationHistoryResponse {\n  medications: Array<{\n    name: string;\n    genericName: string;\n    ndc: string;\n    strength: string;\n    dosageForm: string;\n    lastFillDate: Date;\n    prescriber: string;\n    pharmacy: string;\n    status: 'active' | 'discontinued' | 'completed';\n  }>;\n  retrieved: Date;\n}\n\ninterface DrugInteractionCheck {\n  severity: 'mild' | 'moderate' | 'severe' | 'contraindicated';\n  description: string;\n  drug1: string;\n  drug2: string;\n  clinicalEffects: string[];\n  recommendations: string[];\n}\n\ninterface FormularyCheckResult {\n  covered: boolean;\n  tier: number;\n  copay?: number;\n  priorAuthRequired: boolean;\n  quantityLimit?: number;\n  alternatives?: Array<{\n    name: string;\n    genericName: string;\n    tier: number;\n    copay: number;\n  }>;\n}\n\nclass EPrescribingService {\n  private client: AxiosInstance;\n  private config: SurescriptsConfig;\n  private enabled: boolean;\n\n  constructor() {\n    // Load configuration from environment variables\n    this.config = {\n      baseUrl: process.env.SURESCRIPTS_BASE_URL || 'https://api-sandbox.surescripts.com',\n      apiKey: process.env.SURESCRIPTS_API_KEY || '',\n      username: process.env.SURESCRIPTS_USERNAME || '',\n      password: process.env.SURESCRIPTS_PASSWORD || '',\n      practiceId: process.env.SURESCRIPTS_PRACTICE_ID || '',\n      environment: (process.env.SURESCRIPTS_ENVIRONMENT as 'sandbox' | 'production') || 'sandbox'\n    };\n\n    // Service is enabled only if credentials are configured\n    this.enabled = !!(this.config.apiKey && this.config.username && this.config.password);\n\n    if (this.enabled) {\n      this.client = axios.create({\n        baseURL: this.config.baseUrl,\n        timeout: 30000,\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${this.config.apiKey}`,\n          'X-Practice-ID': this.config.practiceId\n        },\n        auth: {\n          username: this.config.username,\n          password: this.config.password\n        }\n      });\n\n      // Request interceptor for logging\n      this.client.interceptors.request.use(\n        (config) => {\n          console.log(`[ePrescribing] ${config.method?.toUpperCase()} ${config.url}`);\n          return config;\n        },\n        (error) => {\n          console.error('[ePrescribing] Request error:', error);\n          return Promise.reject(error);\n        }\n      );\n\n      // Response interceptor for error handling\n      this.client.interceptors.response.use(\n        (response) => response,\n        (error) => {\n          console.error('[ePrescribing] Response error:', error.response?.data || error.message);\n          throw new AppError(\n            error.response?.data?.message || 'ePrescribing service error',\n            error.response?.status || 500\n          );\n        }\n      );\n    } else {\n      console.warn('[ePrescribing] Service disabled - credentials not configured');\n      // Create a dummy client for type safety\n      this.client = {} as AxiosInstance;\n    }\n  }\n\n  /**\n   * Check if the service is enabled and configured\n   */\n  isEnabled(): boolean {\n    return this.enabled;\n  }\n\n  /**\n   * Send electronic prescription to pharmacy\n   */\n  async sendPrescription(prescriptionData: PrescriptionRequest): Promise<{\n    success: boolean;\n    prescriptionId: string;\n    status: string;\n    sentAt: Date;\n  }> {\n    if (!this.enabled) {\n      console.warn('[ePrescribing] Service not enabled, returning mock response');\n      return {\n        success: true,\n        prescriptionId: `MOCK-${Date.now()}`,\n        status: 'sent',\n        sentAt: new Date()\n      };\n    }\n\n    try {\n      const response = await this.client.post('/v1/prescriptions', {\n        patient: {\n          id: prescriptionData.patientId\n        },\n        prescriber: {\n          id: prescriptionData.prescriberId,\n          practiceId: this.config.practiceId\n        },\n        medication: {\n          ndc: prescriptionData.medication.ndc,\n          name: prescriptionData.medication.name,\n          strength: prescriptionData.medication.strength,\n          dosageForm: prescriptionData.medication.dosageForm\n        },\n        directions: prescriptionData.directions,\n        quantity: prescriptionData.quantity,\n        refills: prescriptionData.refills,\n        daysSupply: prescriptionData.daysSupply,\n        substitutionAllowed: prescriptionData.substitutionAllowed,\n        pharmacy: {\n          ncpdp: prescriptionData.pharmacyNCPDP\n        },\n        priorAuthorizationRequired: prescriptionData.priorAuthorizationRequired || false\n      });\n\n      return {\n        success: true,\n        prescriptionId: response.data.prescriptionId,\n        status: response.data.status,\n        sentAt: new Date()\n      };\n    } catch (error: any) {\n      console.error('[ePrescribing] Failed to send prescription:', error);\n      throw new AppError('Failed to send electronic prescription', 500);\n    }\n  }\n\n  /**\n   * Get patient medication history from Surescripts network\n   */\n  async getMedicationHistory(patientId: string): Promise<MedicationHistoryResponse> {\n    if (!this.enabled) {\n      console.warn('[ePrescribing] Service not enabled, returning mock medication history');\n      return {\n        medications: [],\n        retrieved: new Date()\n      };\n    }\n\n    try {\n      const response = await this.client.get(`/v1/patients/${patientId}/medication-history`);\n\n      return {\n        medications: response.data.medications.map((med: any) => ({\n          name: med.name,\n          genericName: med.genericName,\n          ndc: med.ndc,\n          strength: med.strength,\n          dosageForm: med.dosageForm,\n          lastFillDate: new Date(med.lastFillDate),\n          prescriber: med.prescriber,\n          pharmacy: med.pharmacy,\n          status: med.status\n        })),\n        retrieved: new Date()\n      };\n    } catch (error: any) {\n      console.error('[ePrescribing] Failed to fetch medication history:', error);\n      // Return empty history rather than failing completely\n      return {\n        medications: [],\n        retrieved: new Date()\n      };\n    }\n  }\n\n  /**\n   * Check for drug-drug interactions\n   */\n  async checkDrugInteractions(medications: string[]): Promise<DrugInteractionCheck[]> {\n    if (!this.enabled) {\n      console.warn('[ePrescribing] Service not enabled, returning mock interaction check');\n      return this.mockDrugInteractionCheck(medications);\n    }\n\n    try {\n      const response = await this.client.post('/v1/drug-interactions/check', {\n        medications\n      });\n\n      return response.data.interactions.map((interaction: any) => ({\n        severity: interaction.severity,\n        description: interaction.description,\n        drug1: interaction.drug1,\n        drug2: interaction.drug2,\n        clinicalEffects: interaction.clinicalEffects || [],\n        recommendations: interaction.recommendations || []\n      }));\n    } catch (error: any) {\n      console.error('[ePrescribing] Failed to check drug interactions:', error);\n      // Return mock data as fallback\n      return this.mockDrugInteractionCheck(medications);\n    }\n  }\n\n  /**\n   * Check formulary coverage and alternatives\n   */\n  async checkFormulary(\n    medicationNDC: string,\n    patientInsuranceId?: string\n  ): Promise<FormularyCheckResult> {\n    if (!this.enabled) {\n      console.warn('[ePrescribing] Service not enabled, returning mock formulary check');\n      return {\n        covered: true,\n        tier: 2,\n        copay: 15,\n        priorAuthRequired: false,\n        quantityLimit: 90,\n        alternatives: []\n      };\n    }\n\n    try {\n      const response = await this.client.post('/v1/formulary/check', {\n        ndc: medicationNDC,\n        insuranceId: patientInsuranceId\n      });\n\n      return {\n        covered: response.data.covered,\n        tier: response.data.tier,\n        copay: response.data.copay,\n        priorAuthRequired: response.data.priorAuthRequired,\n        quantityLimit: response.data.quantityLimit,\n        alternatives: response.data.alternatives || []\n      };\n    } catch (error: any) {\n      console.error('[ePrescribing] Failed to check formulary:', error);\n      // Return generic coverage info as fallback\n      return {\n        covered: true,\n        tier: 2,\n        copay: undefined,\n        priorAuthRequired: false,\n        alternatives: []\n      };\n    }\n  }\n\n  /**\n   * Search for medications in the drug database\n   */\n  async searchMedications(searchTerm: string, limit: number = 20): Promise<Medication[]> {\n    if (!this.enabled) {\n      console.warn('[ePrescribing] Service not enabled, returning mock medication search');\n      return this.mockMedicationSearch(searchTerm, limit);\n    }\n\n    try {\n      const response = await this.client.get('/v1/medications/search', {\n        params: {\n          q: searchTerm,\n          limit\n        }\n      });\n\n      return response.data.medications.map((med: any) => ({\n        ndc: med.ndc,\n        name: med.name,\n        genericName: med.genericName,\n        strength: med.strength,\n        dosageForm: med.dosageForm\n      }));\n    } catch (error: any) {\n      console.error('[ePrescribing] Failed to search medications:', error);\n      return this.mockMedicationSearch(searchTerm, limit);\n    }\n  }\n\n  /**\n   * Verify prescriber credentials with DEA/NPI\n   */\n  async verifyPrescriber(npi: string, deaNumber?: string): Promise<{\n    valid: boolean;\n    prescriber: {\n      name: string;\n      npi: string;\n      deaNumber?: string;\n      specialties: string[];\n    };\n  }> {\n    if (!this.enabled) {\n      return {\n        valid: true,\n        prescriber: {\n          name: 'Mock Prescriber',\n          npi,\n          deaNumber,\n          specialties: ['Dentistry']\n        }\n      };\n    }\n\n    try {\n      const response = await this.client.post('/v1/prescribers/verify', {\n        npi,\n        deaNumber\n      });\n\n      return {\n        valid: response.data.valid,\n        prescriber: response.data.prescriber\n      };\n    } catch (error: any) {\n      console.error('[ePrescribing] Failed to verify prescriber:', error);\n      return {\n        valid: false,\n        prescriber: {\n          name: '',\n          npi,\n          deaNumber,\n          specialties: []\n        }\n      };\n    }\n  }\n\n  // ============================================================================\n  // Mock Data Helpers (used when service is disabled or as fallbacks)\n  // ============================================================================\n\n  private mockDrugInteractionCheck(medications: string[]): DrugInteractionCheck[] {\n    // Basic mock interaction logic for common dental medications\n    const interactions: DrugInteractionCheck[] = [];\n\n    // Check for common interactions\n    if (medications.includes('warfarin') && medications.includes('ibuprofen')) {\n      interactions.push({\n        severity: 'severe',\n        description: 'Increased risk of bleeding',\n        drug1: 'Warfarin',\n        drug2: 'Ibuprofen',\n        clinicalEffects: ['Increased anticoagulant effect', 'Gastrointestinal bleeding risk'],\n        recommendations: ['Consider alternative pain management', 'Monitor INR closely', 'Use acetaminophen instead']\n      });\n    }\n\n    if (medications.includes('metronidazole') && medications.includes('alcohol')) {\n      interactions.push({\n        severity: 'moderate',\n        description: 'Disulfiram-like reaction possible',\n        drug1: 'Metronidazole',\n        drug2: 'Alcohol',\n        clinicalEffects: ['Nausea', 'Vomiting', 'Flushing', 'Tachycardia'],\n        recommendations: ['Avoid alcohol during treatment and for 48 hours after']\n      });\n    }\n\n    return interactions;\n  }\n\n  private mockMedicationSearch(searchTerm: string, limit: number): Medication[] {\n    // Common dental medications database (mock)\n    const dentalMeds: Medication[] = [\n      { ndc: '00781-1506-10', name: 'Amoxicillin 500mg Capsule', genericName: 'Amoxicillin', strength: '500mg', dosageForm: 'Capsule' },\n      { ndc: '00093-2264-01', name: 'Ibuprofen 600mg Tablet', genericName: 'Ibuprofen', strength: '600mg', dosageForm: 'Tablet' },\n      { ndc: '00179-0155-01', name: 'Hydrocodone-Acetaminophen 5-325mg Tablet', genericName: 'Hydrocodone/Acetaminophen', strength: '5-325mg', dosageForm: 'Tablet' },\n      { ndc: '00093-3109-01', name: 'Clindamycin 150mg Capsule', genericName: 'Clindamycin', strength: '150mg', dosageForm: 'Capsule' },\n      { ndc: '66336-0718-30', name: 'Azithromycin 250mg Tablet', genericName: 'Azithromycin', strength: '250mg', dosageForm: 'Tablet' },\n      { ndc: '00378-0613-93', name: 'Penicillin VK 500mg Tablet', genericName: 'Penicillin V Potassium', strength: '500mg', dosageForm: 'Tablet' },\n      { ndc: '00093-0147-01', name: 'Metronidazole 500mg Tablet', genericName: 'Metronidazole', strength: '500mg', dosageForm: 'Tablet' },\n      { ndc: '00781-5092-10', name: 'Amoxicillin-Clavulanate 875-125mg Tablet', genericName: 'Amoxicillin/Clavulanate', strength: '875-125mg', dosageForm: 'Tablet' },\n      { ndc: '00378-3967-01', name: 'Acetaminophen 500mg Tablet', genericName: 'Acetaminophen', strength: '500mg', dosageForm: 'Tablet' },\n      { ndc: '00228-2063-10', name: 'Chlorhexidine Gluconate 0.12% Oral Rinse', genericName: 'Chlorhexidine', strength: '0.12%', dosageForm: 'Solution' }\n    ];\n\n    const searchLower = searchTerm.toLowerCase();\n    return dentalMeds\n      .filter(med => \n        med.name.toLowerCase().includes(searchLower) ||\n        med.genericName?.toLowerCase().includes(searchLower)\n      )\n      .slice(0, limit);\n  }\n}\n\n// Export singleton instance\nexport const ePrescribingService = new EPrescribingService();\nexport default ePrescribingService;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\services\\medicationSafetyService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Medication' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mongoose' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1866,1869],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1866,1869],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2626,2629],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2626,2629],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5067,5070],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5067,5070],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientAge' is defined but never used. Allowed unused args must match /^_/u.","line":399,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":399,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":580,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":580,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19648,19651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19648,19651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":589,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":589,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19929,19932],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19929,19932],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":594,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":594,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20107,20110],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20107,20110],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Medication Safety Service\n * \n * Provides comprehensive medication safety checks including:\n * - Drug-allergy interactions\n * - Drug-drug interactions\n * - Contraindications based on patient conditions\n * - Dosage validation\n * - Duplicate therapy detection\n */\n\nimport Patient from '../models/Patient';\nimport Prescription from '../models/Prescription';\nimport Medication from '../models/Medication';\nimport { ePrescribingService } from './ePrescribingService';\nimport mongoose from 'mongoose';\n\ninterface SafetyCheckResult {\n  safe: boolean;\n  warnings: SafetyWarning[];\n  errors: SafetyError[];\n  recommendations: string[];\n}\n\ninterface SafetyWarning {\n  type: 'allergy' | 'interaction' | 'contraindication' | 'duplicate' | 'dosage' | 'age' | 'pregnancy';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  message: string;\n  details: string;\n  affectedDrugs?: string[];\n  recommendation?: string;\n}\n\ninterface SafetyError {\n  type: 'allergy' | 'contraindication' | 'invalid-dosage';\n  message: string;\n  details: string;\n}\n\ninterface MedicationToCheck {\n  medicationId: string;\n  name: string;\n  genericName?: string;\n  dosage: string;\n  frequency: string;\n  duration: string;\n}\n\ninterface PatientMedicationHistory {\n  allergies: string[];\n  currentMedications: Array<{\n    name: string;\n    genericName?: string;\n    dosage: string;\n    status: string;\n  }>;\n  medicalConditions: string[];\n  age: number;\n  isPregnant?: boolean;\n}\n\nclass MedicationSafetyService {\n  /**\n   * Perform comprehensive safety check before prescribing\n   */\n  async performSafetyCheck(\n    patientId: string,\n    newMedications: MedicationToCheck[]\n  ): Promise<SafetyCheckResult> {\n    const warnings: SafetyWarning[] = [];\n    const errors: SafetyError[] = [];\n    const recommendations: string[] = [];\n\n    try {\n      // Get patient medical history\n      const patient: any = await Patient.findById(patientId)\n        .select('medicalHistory dateOfBirth')\n        .lean();\n\n      if (!patient) {\n        throw new Error('Patient not found');\n      }\n\n      const patientHistory: PatientMedicationHistory = {\n        allergies: patient.medicalHistory?.allergies || [],\n        currentMedications: [],\n        medicalConditions: patient.medicalHistory?.conditions || [],\n        age: this.calculateAge(patient.dateOfBirth)\n      };\n\n      // Get current active prescriptions\n      const activePrescriptions = await Prescription.findActive(patientId);\n      \n      for (const prescription of activePrescriptions) {\n        for (const med of prescription.medications) {\n          if (med.medicationId) {\n            const medication: any = med.medicationId;\n            patientHistory.currentMedications.push({\n              name: medication.name,\n              genericName: medication.genericName,\n              dosage: med.dosage,\n              status: 'active'\n            });\n          }\n        }\n      }\n\n      // 1. Check for allergies\n      const allergyChecks = await this.checkAllergies(\n        patientHistory.allergies,\n        newMedications\n      );\n      warnings.push(...allergyChecks.warnings);\n      errors.push(...allergyChecks.errors);\n\n      // 2. Check for drug-drug interactions\n      const interactionChecks = await this.checkDrugInteractions(\n        patientHistory.currentMedications,\n        newMedications\n      );\n      warnings.push(...interactionChecks.warnings);\n\n      // 3. Check for contraindications based on conditions\n      const contraindicationChecks = await this.checkContraindications(\n        patientHistory.medicalConditions,\n        newMedications\n      );\n      warnings.push(...contraindicationChecks.warnings);\n      errors.push(...contraindicationChecks.errors);\n\n      // 4. Check for duplicate therapy\n      const duplicateChecks = this.checkDuplicateTherapy(\n        patientHistory.currentMedications,\n        newMedications\n      );\n      warnings.push(...duplicateChecks.warnings);\n\n      // 5. Check dosage appropriateness\n      const dosageChecks = this.checkDosage(\n        newMedications,\n        patientHistory.age\n      );\n      warnings.push(...dosageChecks.warnings);\n\n      // 6. Age-specific warnings\n      const ageWarnings = this.checkAgeAppropriate(\n        newMedications,\n        patientHistory.age\n      );\n      warnings.push(...ageWarnings);\n\n      // Generate recommendations\n      if (warnings.length > 0) {\n        recommendations.push('Review all warnings before prescribing');\n      }\n      if (errors.length > 0) {\n        recommendations.push('Resolve all critical errors before proceeding');\n      }\n      if (warnings.some(w => w.severity === 'high' || w.severity === 'critical')) {\n        recommendations.push('Consider consulting with a pharmacist or specialist');\n      }\n\n      const safe = errors.length === 0 && \n                   !warnings.some(w => w.severity === 'critical');\n\n      return {\n        safe,\n        warnings: warnings.sort((a, b) => this.severityScore(b.severity) - this.severityScore(a.severity)),\n        errors,\n        recommendations\n      };\n    } catch (error: any) {\n      console.error('[MedicationSafety] Safety check error:', error);\n      return {\n        safe: false,\n        warnings: [],\n        errors: [{\n          type: 'contraindication',\n          message: 'Safety check failed',\n          details: error.message\n        }],\n        recommendations: ['Unable to perform safety check. Please verify manually.']\n      };\n    }\n  }\n\n  /**\n   * Check for drug allergies\n   */\n  private async checkAllergies(\n    allergies: string[],\n    newMedications: MedicationToCheck[]\n  ): Promise<{ warnings: SafetyWarning[]; errors: SafetyError[] }> {\n    const warnings: SafetyWarning[] = [];\n    const errors: SafetyError[] = [];\n\n    if (allergies.length === 0) {\n      return { warnings, errors };\n    }\n\n    for (const medication of newMedications) {\n      const medName = medication.name.toLowerCase();\n      const genericName = medication.genericName?.toLowerCase() || '';\n\n      for (const allergy of allergies) {\n        const allergyLower = allergy.toLowerCase();\n\n        // Direct match\n        if (medName.includes(allergyLower) || genericName.includes(allergyLower)) {\n          errors.push({\n            type: 'allergy',\n            message: `ALLERGY ALERT: ${medication.name}`,\n            details: `Patient has documented allergy to ${allergy}. DO NOT PRESCRIBE.`\n          });\n          continue;\n        }\n\n        // Check for class allergies (e.g., \"Penicillin\" should flag \"Amoxicillin\")\n        const classMatch = this.checkDrugClassAllergy(allergyLower, medName, genericName);\n        if (classMatch) {\n          errors.push({\n            type: 'allergy',\n            message: `CROSS-ALLERGY ALERT: ${medication.name}`,\n            details: `Patient allergic to ${allergy}. ${medication.name} is in the same drug class and may cause allergic reaction.`\n          });\n        }\n      }\n    }\n\n    return { warnings, errors };\n  }\n\n  /**\n   * Check for drug-drug interactions\n   */\n  private async checkDrugInteractions(\n    currentMedications: Array<{ name: string; genericName?: string }>,\n    newMedications: MedicationToCheck[]\n  ): Promise<{ warnings: SafetyWarning[] }> {\n    const warnings: SafetyWarning[] = [];\n\n    if (currentMedications.length === 0) {\n      return { warnings };\n    }\n\n    // Build list of all medication names for interaction check\n    const allMedNames = [\n      ...currentMedications.map(m => m.genericName || m.name),\n      ...newMedications.map(m => m.genericName || m.name)\n    ];\n\n    // Check interactions using ePrescribing service\n    const interactions = await ePrescribingService.checkDrugInteractions(allMedNames);\n\n    for (const interaction of interactions) {\n      const severityMap: Record<string, 'low' | 'medium' | 'high' | 'critical'> = {\n        'mild': 'low',\n        'moderate': 'medium',\n        'severe': 'high',\n        'contraindicated': 'critical'\n      };\n\n      warnings.push({\n        type: 'interaction',\n        severity: severityMap[interaction.severity] || 'medium',\n        message: `Drug Interaction: ${interaction.drug1}  ${interaction.drug2}`,\n        details: interaction.description,\n        affectedDrugs: [interaction.drug1, interaction.drug2],\n        recommendation: interaction.recommendations.join('. ')\n      });\n    }\n\n    return { warnings };\n  }\n\n  /**\n   * Check for contraindications based on medical conditions\n   */\n  private async checkContraindications(\n    conditions: string[],\n    newMedications: MedicationToCheck[]\n  ): Promise<{ warnings: SafetyWarning[]; errors: SafetyError[] }> {\n    const warnings: SafetyWarning[] = [];\n    const errors: SafetyError[] = [];\n\n    // Define contraindication rules for common dental medications\n    const contraindicationRules: Record<string, string[]> = {\n      'aspirin': ['bleeding disorder', 'hemophilia', 'active ulcer'],\n      'ibuprofen': ['kidney disease', 'heart failure', 'active ulcer', 'asthma'],\n      'naproxen': ['kidney disease', 'heart failure', 'active ulcer'],\n      'codeine': ['respiratory depression', 'severe asthma', 'sleep apnea'],\n      'tramadol': ['seizure disorder', 'epilepsy'],\n      'amoxicillin': ['mononucleosis'],\n      'erythromycin': ['long qt syndrome'],\n      'metronidazole': ['liver disease'],\n      'clindamycin': ['colitis', 'inflammatory bowel disease']\n    };\n\n    for (const medication of newMedications) {\n      const medKey = (medication.genericName || medication.name).toLowerCase();\n      \n      // Check each condition against contraindications\n      for (const [drug, contraindicatedConditions] of Object.entries(contraindicationRules)) {\n        if (medKey.includes(drug)) {\n          for (const condition of conditions) {\n            const conditionLower = condition.toLowerCase();\n            \n            for (const contraindication of contraindicatedConditions) {\n              if (conditionLower.includes(contraindication)) {\n                const isCritical = ['bleeding disorder', 'hemophilia', 'severe asthma'].includes(contraindication);\n                \n                if (isCritical) {\n                  errors.push({\n                    type: 'contraindication',\n                    message: `CONTRAINDICATION: ${medication.name}`,\n                    details: `Patient has ${condition}. ${medication.name} is contraindicated.`\n                  });\n                } else {\n                  warnings.push({\n                    type: 'contraindication',\n                    severity: 'high',\n                    message: `Caution: ${medication.name} and ${condition}`,\n                    details: `${medication.name} should be used with caution in patients with ${condition}.`,\n                    recommendation: 'Consider alternative medication or adjust dosage'\n                  });\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return { warnings, errors };\n  }\n\n  /**\n   * Check for duplicate therapy\n   */\n  private checkDuplicateTherapy(\n    currentMedications: Array<{ name: string; genericName?: string }>,\n    newMedications: MedicationToCheck[]\n  ): { warnings: SafetyWarning[] } {\n    const warnings: SafetyWarning[] = [];\n\n    // Define drug classes for duplicate therapy detection\n    const drugClasses: Record<string, string[]> = {\n      'nsaid': ['ibuprofen', 'naproxen', 'aspirin', 'ketorolac', 'diclofenac'],\n      'opioid': ['codeine', 'hydrocodone', 'oxycodone', 'tramadol', 'morphine'],\n      'antibiotic-penicillin': ['amoxicillin', 'penicillin', 'ampicillin'],\n      'antibiotic-macrolide': ['erythromycin', 'azithromycin', 'clarithromycin']\n    };\n\n    for (const newMed of newMedications) {\n      const newMedName = (newMed.genericName || newMed.name).toLowerCase();\n\n      for (const currentMed of currentMedications) {\n        const currentMedName = (currentMed.genericName || currentMed.name).toLowerCase();\n\n        // Check for exact duplicate\n        if (newMedName === currentMedName) {\n          warnings.push({\n            type: 'duplicate',\n            severity: 'high',\n            message: `Duplicate Medication: ${newMed.name}`,\n            details: `Patient is already taking ${currentMed.name}`,\n            recommendation: 'Verify if this is an intentional dose increase or prescription error'\n          });\n          continue;\n        }\n\n        // Check for same drug class\n        for (const [className, drugs] of Object.entries(drugClasses)) {\n          const newInClass = drugs.some(d => newMedName.includes(d));\n          const currentInClass = drugs.some(d => currentMedName.includes(d));\n\n          if (newInClass && currentInClass) {\n            warnings.push({\n              type: 'duplicate',\n              severity: 'medium',\n              message: `Duplicate Therapy: ${className.toUpperCase()}`,\n              details: `Patient already taking ${currentMed.name} (${className}). New prescription ${newMed.name} is in the same class.`,\n              affectedDrugs: [currentMed.name, newMed.name],\n              recommendation: 'Consider discontinuing current medication before starting new one'\n            });\n          }\n        }\n      }\n    }\n\n    return { warnings };\n  }\n\n  /**\n   * Check dosage appropriateness\n   */\n  private checkDosage(\n    medications: MedicationToCheck[],\n    patientAge: number\n  ): { warnings: SafetyWarning[] } {\n    const warnings: SafetyWarning[] = [];\n\n    // Define maximum recommended doses for common medications\n    const maxDoses: Record<string, { max: number; unit: string; period: string }> = {\n      'ibuprofen': { max: 3200, unit: 'mg', period: 'day' },\n      'acetaminophen': { max: 4000, unit: 'mg', period: 'day' },\n      'aspirin': { max: 4000, unit: 'mg', period: 'day' },\n      'naproxen': { max: 1500, unit: 'mg', period: 'day' },\n      'tramadol': { max: 400, unit: 'mg', period: 'day' }\n    };\n\n    for (const med of medications) {\n      const medName = (med.genericName || med.name).toLowerCase();\n      \n      // Extract dosage amount from string (e.g., \"400mg\" -> 400)\n      const dosageMatch = med.dosage.match(/(\\d+)\\s*mg/i);\n      if (!dosageMatch) continue;\n      \n      const dosageAmount = parseInt(dosageMatch[1]);\n      \n      // Extract frequency (e.g., \"3 times daily\" -> 3)\n      const frequencyMatch = med.frequency.match(/(\\d+)/);\n      const frequencyCount = frequencyMatch ? parseInt(frequencyMatch[1]) : 1;\n      \n      const dailyDose = dosageAmount * frequencyCount;\n\n      // Check against max doses\n      for (const [drug, limits] of Object.entries(maxDoses)) {\n        if (medName.includes(drug)) {\n          if (dailyDose > limits.max) {\n            warnings.push({\n              type: 'dosage',\n              severity: 'high',\n              message: `High Dosage Warning: ${med.name}`,\n              details: `Prescribed daily dose (${dailyDose}${limits.unit}) exceeds maximum recommended dose (${limits.max}${limits.unit}/${limits.period})`,\n              recommendation: 'Reduce dosage or frequency to stay within safe limits'\n            });\n          } else if (dailyDose > limits.max * 0.8) {\n            warnings.push({\n              type: 'dosage',\n              severity: 'medium',\n              message: `Dosage Near Maximum: ${med.name}`,\n              details: `Prescribed daily dose (${dailyDose}${limits.unit}) is near maximum recommended dose (${limits.max}${limits.unit}/${limits.period})`,\n              recommendation: 'Monitor patient closely for adverse effects'\n            });\n          }\n        }\n      }\n    }\n\n    return { warnings };\n  }\n\n  /**\n   * Check age-appropriate prescribing\n   */\n  private checkAgeAppropriate(\n    medications: MedicationToCheck[],\n    patientAge: number\n  ): SafetyWarning[] {\n    const warnings: SafetyWarning[] = [];\n\n    // Age-specific warnings\n    for (const med of medications) {\n      const medName = (med.genericName || med.name).toLowerCase();\n\n      // Pediatric warnings (under 18)\n      if (patientAge < 18) {\n        if (medName.includes('aspirin') && patientAge < 16) {\n          warnings.push({\n            type: 'age',\n            severity: 'critical',\n            message: `Aspirin Not Recommended for Children`,\n            details: `Patient is ${patientAge} years old. Aspirin in children under 16 is associated with Reye's syndrome risk.`,\n            recommendation: 'Use acetaminophen or ibuprofen instead'\n          });\n        }\n\n        if (medName.includes('codeine') && patientAge < 12) {\n          warnings.push({\n            type: 'age',\n            severity: 'high',\n            message: `Codeine Use in Children`,\n            details: `Patient is ${patientAge} years old. Codeine not recommended in children under 12 due to serious breathing problems.`,\n            recommendation: 'Consider alternative pain management'\n          });\n        }\n      }\n\n      // Geriatric warnings (over 65)\n      if (patientAge > 65) {\n        if (medName.includes('ibuprofen') || medName.includes('naproxen')) {\n          warnings.push({\n            type: 'age',\n            severity: 'medium',\n            message: `NSAID Use in Elderly`,\n            details: `Patient is ${patientAge} years old. NSAIDs increase risk of GI bleeding and cardiovascular events in elderly.`,\n            recommendation: 'Use lowest effective dose for shortest duration. Monitor closely.'\n          });\n        }\n\n        if (medName.includes('tramadol') || medName.includes('codeine')) {\n          warnings.push({\n            type: 'age',\n            severity: 'medium',\n            message: `Opioid Use in Elderly`,\n            details: `Patient is ${patientAge} years old. Increased risk of falls, confusion, and respiratory depression in elderly.`,\n            recommendation: 'Start with reduced dose. Monitor closely for adverse effects.'\n          });\n        }\n      }\n    }\n\n    return warnings;\n  }\n\n  /**\n   * Check if medication is in same class as allergy\n   */\n  private checkDrugClassAllergy(allergy: string, medName: string, genericName: string): boolean {\n    const drugClassMappings: Record<string, string[]> = {\n      'penicillin': ['amoxicillin', 'ampicillin', 'penicillin'],\n      'sulfa': ['sulfamethoxazole', 'sulfisoxazole'],\n      'aspirin': ['aspirin', 'salicylate'],\n      'nsaid': ['ibuprofen', 'naproxen', 'ketorolac', 'diclofenac']\n    };\n\n    for (const [allergyClass, drugs] of Object.entries(drugClassMappings)) {\n      if (allergy.includes(allergyClass)) {\n        return drugs.some(drug => medName.includes(drug) || genericName.includes(drug));\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Calculate patient age from date of birth\n   */\n  private calculateAge(dateOfBirth: Date): number {\n    const today = new Date();\n    const birthDate = new Date(dateOfBirth);\n    let age = today.getFullYear() - birthDate.getFullYear();\n    const monthDiff = today.getMonth() - birthDate.getMonth();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n      age--;\n    }\n    \n    return age;\n  }\n\n  /**\n   * Get numeric severity score for sorting\n   */\n  private severityScore(severity: string): number {\n    const scores: Record<string, number> = {\n      'critical': 4,\n      'high': 3,\n      'medium': 2,\n      'low': 1\n    };\n    return scores[severity] || 0;\n  }\n\n  /**\n   * Get patient medication summary for display\n   */\n  async getPatientMedicationSummary(patientId: string): Promise<{\n    allergies: string[];\n    currentMedications: Array<{\n      name: string;\n      dosage: string;\n      frequency: string;\n      prescribedDate: Date;\n    }>;\n    medicalConditions: string[];\n    age: number;\n  }> {\n    const patient: any = await Patient.findById(patientId)\n      .select('medicalHistory dateOfBirth')\n      .lean();\n\n    if (!patient) {\n      throw new Error('Patient not found');\n    }\n\n    const activePrescriptions = await Prescription.findActive(patientId);\n    const currentMedications: Array<any> = [];\n\n    for (const prescription of activePrescriptions) {\n      for (const med of prescription.medications) {\n        if (med.medicationId) {\n          const medication: any = med.medicationId;\n          currentMedications.push({\n            name: medication.name,\n            dosage: med.dosage,\n            frequency: med.frequency,\n            prescribedDate: prescription.issuedDate\n          });\n        }\n      }\n    }\n\n    return {\n      allergies: patient.medicalHistory?.allergies || [],\n      currentMedications,\n      medicalConditions: patient.medicalHistory?.conditions || [],\n      age: this.calculateAge(patient.dateOfBirth)\n    };\n  }\n}\n\n// Export singleton instance\nexport const medicationSafetyService = new MedicationSafetyService();\nexport default medicationSafetyService;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\types\\global.d.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'T' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":4,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[103,106],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[103,106],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":11,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[256,259],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[256,259],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'T' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[310,313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[310,313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Global type suppressions for development\ndeclare global {\n  interface Array<T> {\n    push(...items: any[]): number;\n  }\n}\n\n// Extend existing interfaces to suppress TypeScript errors\ndeclare module 'mongoose' {\n  interface Document {\n    [key: string]: any;\n  }\n  \n  interface Model<T> {\n    [key: string]: any;\n  }\n}\n\nexport {};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\types\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":82,"column":56,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":82,"endColumn":58,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[2099,2101],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[2099,2101],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":82,"column":60,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":82,"endColumn":62,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[2103,2105],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[2103,2105],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":82,"column":64,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":82,"endColumn":66,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[2107,2109],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[2107,2109],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2111,2114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2111,2114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2116,2119],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2116,2119],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2121,2124],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2121,2124],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2274,2277],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2274,2277],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2336,2339],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2336,2339],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":110,"column":68,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":110,"endColumn":70,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[2846,2848],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[2846,2848],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":110,"column":72,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":110,"endColumn":74,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[2850,2852],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[2850,2852],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":110,"column":76,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":110,"endColumn":78,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[2854,2856],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[2854,2856],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2858,2861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2858,2861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2863,2866],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2863,2866],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2868,2871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2868,2871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2911,2914],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2911,2914],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2952,2955],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2952,2955],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2991,2994],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2991,2994],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3042,3045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3042,3045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3048,3051],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3048,3051],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":152,"column":54,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":152,"endColumn":56,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[3909,3911],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[3909,3911],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":152,"column":58,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":152,"endColumn":60,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[3913,3915],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[3913,3915],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":152,"column":62,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":152,"endColumn":64,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[3917,3919],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[3917,3919],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3921,3924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3921,3924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3926,3929],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3926,3929],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3931,3934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3931,3934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":157,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4295,4298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4295,4298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":197,"column":64,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":197,"endColumn":66,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[5255,5257],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[5255,5257],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":197,"column":68,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":197,"endColumn":70,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[5259,5261],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[5259,5261],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":197,"column":72,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":197,"endColumn":74,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[5263,5265],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[5263,5265],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5267,5270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5267,5270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5272,5275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5272,5275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":86,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":89,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5277,5280],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5277,5280],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":201,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":201,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5652,5655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5652,5655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":227,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6290,6293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6290,6293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":231,"column":72,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":231,"endColumn":74,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[6466,6468],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[6466,6468],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":231,"column":76,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":231,"endColumn":78,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[6470,6472],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[6470,6472],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":231,"column":80,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":231,"endColumn":82,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[6474,6476],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[6474,6476],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6478,6481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6478,6481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6483,6486],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6483,6486],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6488,6491],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6488,6491],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":232,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6531,6534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6531,6534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":233,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":233,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6572,6575],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6572,6575],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6611,6614],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6611,6614],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":235,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6671,6674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6671,6674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":235,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6677,6680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6677,6680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6733,6736],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6733,6736],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6802,6805],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6802,6805],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6808,6811],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6808,6811],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":238,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6864,6867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6864,6867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":259,"column":62,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":259,"endColumn":64,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[7407,7409],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[7407,7409],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":259,"column":66,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":259,"endColumn":68,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[7411,7413],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[7411,7413],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":259,"column":70,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":259,"endColumn":72,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[7415,7417],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[7415,7417],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":259,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":259,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7419,7422],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7419,7422],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":259,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":259,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7424,7427],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7424,7427],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":259,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":259,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7429,7432],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7429,7432],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":260,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7477,7480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7477,7480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":261,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":261,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7518,7521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7518,7521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":296,"column":66,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":296,"endColumn":68,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[8395,8397],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[8395,8397],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":296,"column":70,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":296,"endColumn":72,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[8399,8401],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[8399,8401],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":296,"column":74,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":296,"endColumn":76,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[8403,8405],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[8403,8405],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8407,8410],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8407,8410],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8412,8415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8412,8415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8417,8420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8417,8420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":297,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":297,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8469,8472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8469,8472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":297,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":297,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8475,8478],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8475,8478],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":298,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":298,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8514,8517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8514,8517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":299,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8550,8553],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8550,8553],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":344,"column":56,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":344,"endColumn":58,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[9784,9786],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[9784,9786],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":344,"column":60,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":344,"endColumn":62,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[9788,9790],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[9788,9790],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":344,"column":64,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":344,"endColumn":66,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[9792,9794],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[9792,9794],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":344,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":344,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9796,9799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9796,9799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":344,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":344,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9801,9804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9801,9804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":344,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":344,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9806,9809],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9806,9809],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":345,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9858,9861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9858,9861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":345,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9864,9867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9864,9867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":346,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":346,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9903,9906],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9903,9906],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":347,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9977,9980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9977,9980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":366,"column":66,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":366,"endColumn":68,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[10482,10484],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[10482,10484],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":366,"column":70,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":366,"endColumn":72,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[10486,10488],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[10486,10488],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":366,"column":74,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":366,"endColumn":76,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[10490,10492],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[10490,10492],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10494,10497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10494,10497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10499,10502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10499,10502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10504,10507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10504,10507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":367,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":367,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10549,10552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10549,10552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":367,"column":125,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":367,"endColumn":128,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10635,10638],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10635,10638],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":367,"column":153,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":367,"endColumn":156,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10663,10666],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10663,10666],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":367,"column":167,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":367,"endColumn":170,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10677,10680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10677,10680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":373,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":373,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11425,11428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11425,11428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":375,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":375,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11534,11537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11534,11537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":377,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":377,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11618,11621],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11618,11621],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":378,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":378,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11701,11704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11701,11704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":378,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":378,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11707,11710],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11707,11710],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":379,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":379,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11758,11761],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11758,11761],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":416,"column":68,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":416,"endColumn":70,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[12674,12676],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[12674,12676],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":416,"column":72,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":416,"endColumn":74,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[12678,12680],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[12678,12680],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"The `{}` (\"empty object\") type allows any non-nullish value, including literals like `0` and `\"\"`.\n- If that's what you want, disable this lint rule with an inline comment or configure the 'allowObjectTypes' rule option.\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.","line":416,"column":76,"nodeType":"TSTypeLiteral","messageId":"noEmptyObject","endLine":416,"endColumn":78,"suggestions":[{"messageId":"replaceEmptyObjectType","data":{"replacement":"object"},"fix":{"range":[12682,12684],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"replaceEmptyObjectType","data":{"replacement":"unknown"},"fix":{"range":[12682,12684],"text":"unknown"},"desc":"Replace `{}` with `unknown`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":416,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":416,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12686,12689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12686,12689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":416,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":416,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12691,12694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12691,12694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":416,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":416,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12696,12699],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12696,12699],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":417,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":417,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12781,12784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12781,12784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":418,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":418,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12840,12843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12840,12843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":419,"column":105,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":419,"endColumn":108,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12949,12952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12949,12952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":420,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":420,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13023,13026],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13023,13026],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":441,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":441,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13361,13364],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13361,13364],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":448,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":448,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13480,13483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13480,13483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":570,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":570,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15736,15739],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15736,15739],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":577,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":577,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15845,15848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15845,15848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":107,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request } from 'express';\nimport { Document, Types, Model } from 'mongoose';\n\n// Day type for operating hours\nexport type Day = 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday' | 'saturday' | 'sunday';\n\n// User role type\nexport type UserRole = 'admin' | 'dentist' | 'staff' | 'patient' | 'super_admin';\n\n// User related types\nexport interface IUser extends Document {\n  _id: Types.ObjectId;\n  firstName: string;\n  lastName: string;\n  email: string;\n  password?: string;\n  role: 'admin' | 'dentist' | 'staff' | 'patient' | 'super_admin';\n  phone?: string;\n  dateOfBirth?: string;\n  gender?: 'male' | 'female' | 'other' | 'prefer_not_to_say';\n  address?: {\n    street?: string;\n    city?: string;\n    state?: string;\n    zipCode?: string;\n    country?: string;\n  };\n  profileImage?: string;\n  isActive: boolean;\n  lastLogin?: Date;\n  assignedClinics: Types.ObjectId[];\n  preferredClinicId?: Types.ObjectId;\n  specialization?: string;\n  twoFactorEnabled?: boolean;\n  licenseNumber?: string;\n  bio?: string;\n  passwordResetToken?: string;\n  passwordResetExpires?: Date;\n  fullName?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Patient related types\nexport interface IPatient extends Document {\n  _id: Types.ObjectId;\n  firstName: string;\n  lastName: string;\n  email?: string;\n  phone: string;\n  dateOfBirth: Date;\n  gender: 'male' | 'female' | 'other';\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n  };\n  medicalHistory: {\n    allergies: string[];\n    medications: string[];\n    conditions: string[];\n    notes?: string;\n  };\n  treatmentRecords: Types.ObjectId[];\n  preferredClinicId: Types.ObjectId;\n  userId?: Types.ObjectId; // Link to user account\n  createdBy: Types.ObjectId; // User who created this patient record\n  isActive: boolean;\n  emergencyContact?: {\n    name?: string;\n    phone?: string;\n    relationship?: string;\n  };\n  fullName?: string; // Virtual property\n  age?: number; // Virtual property\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface IPatientModel extends Model<IPatient, {}, {}, {}, any, any, any> {\n  findByEmail(email: string): Promise<IPatient | null>;\n  findByPhone(phone: string): Promise<IPatient | null>;\n  findByClinic(clinicId: string): any;\n  searchPatients(searchTerm: string, clinicId?: string): any;\n}\n\n// Patient Report related types\nexport interface IPatientReport extends Document {\n  _id: Types.ObjectId;\n  patientId: Types.ObjectId;\n  dentistId: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  title: string;\n  description: string;\n  date: Date;\n  attachments: {\n    id: string;\n    fileName: string;\n    fileType: string;\n    fileUrl: string;\n    uploadedAt: Date;\n  }[];\n  isShared: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface IPatientReportModel extends Model<IPatientReport, {}, {}, {}, any, any, any> {\n  findByPatient(patientId: string): any;\n  findByDentist(dentistId: string): any;\n  findByClinic(clinicId: string): any;\n  searchReports(searchTerm: string, options?: any): any;\n}\n\n// Clinic related types\nexport interface IClinic extends Document {\n  _id: Types.ObjectId;\n  name: string;\n  branchName?: string; // New: Branch identifier (e.g., \"Fayoum\", \"Atesa\", \"Minya\")\n  email: string;\n  phone: string;\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n    coordinates?: {\n      latitude: number;\n      longitude: number;\n    };\n  };\n  services: string[];\n  operatingHours: {\n    day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday' | 'saturday' | 'sunday';\n    open: string;\n    close: string;\n    closed: boolean;\n  }[];\n  description?: string;\n  website?: string;\n  emergencyContact?: string;\n  images: string[];\n  staff: Types.ObjectId[];\n  isActive: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface IClinicModel extends Model<IClinic, {}, {}, {}, any, any, any> {\n  findByCity(city: string, options?: { skip?: number; limit?: number }): Promise<IClinic[]>;\n  findByName(name: string): Promise<IClinic[]>;\n  findByService(service: string, options?: { skip?: number; limit?: number }): Promise<IClinic[]>;\n  findNearby(lat: number, lng: number, radiusInKm: number): Promise<IClinic[]>;\n  searchClinics(searchTerm: string): any;\n}\n\n// Appointment related types\nexport interface IAppointment extends Document {\n  _id: Types.ObjectId;\n  patientId: Types.ObjectId;\n  dentistId?: Types.ObjectId; // Made optional\n  clinicId: Types.ObjectId;\n  date: Date;\n  timeSlot: string;\n  duration: number;\n  serviceType: string;\n  status: 'scheduled' | 'confirmed' | 'in-progress' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  reason?: string;\n  treatmentProvided?: string;\n  followUpRequired?: boolean;\n  followUpDate?: Date;\n  emergency?: boolean;\n  notificationPreferences?: {\n    enabled: boolean;\n    channels: {\n      email: boolean;\n      sms: boolean;\n      inApp: boolean;\n    };\n    reminderTimes: number[];\n  };\n  createdBy: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n  \n  // Instance methods\n  isPast(): boolean;\n  isToday(): boolean;\n  canBeCancelled(): boolean;\n  canBeRescheduled(): boolean;\n}\n\nexport interface IAppointmentModel extends Model<IAppointment, {}, {}, {}, any, any, any> {\n  findByDateRange(startDate: Date, endDate: Date): Promise<IAppointment[]>;\n  findByDentistAndDate(dentistId: string, date: Date): Promise<IAppointment[]>;\n  findConflicts(dentistId: string, date: Date, timeSlot: string, duration: number, excludeId?: string): Promise<IAppointment[]>;\n  getAvailableTimeSlots(dentistId: string, date: Date, duration?: number): Promise<any[]>;\n  getNextSlotAfterLastBooking(clinicId: string, date: Date, duration?: number): Promise<IAppointment | null>;\n}\n\n// Treatment Record related types\nexport interface ITreatmentRecord extends Document {\n  _id: Types.ObjectId;\n  patientId: Types.ObjectId;\n  date: Date;\n  dentistId: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  procedure: string;\n  diagnosis?: string;\n  notes?: string;\n  attachments: {\n    filename: string;\n    originalName: string;\n    url: string;\n    fileType: string;\n    fileSize: number;\n    uploadedAt: Date;\n  }[];\n  createdAt: Date;\n  updatedAt: Date;\n  \n  // Instance methods\n  addAttachment(attachment: any): Promise<ITreatmentRecord>;\n  removeAttachment(attachmentId: string): Promise<ITreatmentRecord>;\n}\n\nexport interface ITreatmentRecordModel extends Model<ITreatmentRecord, {}, {}, {}, any, any, any> {\n  findByPatient(patientId: string): any;\n  findByDentist(dentistId: string): any;\n  findByClinic(clinicId: string): any;\n  searchTreatmentRecords(searchTerm: string, options?: any): any;\n  countSearchResults(searchTerm: string, options?: any): Promise<number>;\n  searchRecords(searchTerm: string, options?: any): any;\n  findByDateRange(startDate: Date, endDate: Date): any;\n}\n\n// Notification related types\n// Medication related types\nexport interface IMedication extends Document {\n  _id: Types.ObjectId;\n  name: string;\n  genericName?: string;\n  dosage: string;\n  frequency: string;\n  duration: string;\n  instructions?: string;\n  sideEffects: string[];\n  contraindications: string[];\n  category: 'antibiotic' | 'painkiller' | 'anti-inflammatory' | 'anesthetic' | 'antiseptic' | 'other';\n  isActive: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface IMedicationModel extends Model<IMedication, {}, {}, {}, any, any, any> {\n  searchMedications(searchTerm: string): any;\n  findByCategory(category: string): any;\n}\n\n// Prescription related types\nexport interface IPrescription extends Document {\n  _id: Types.ObjectId;\n  patientId: Types.ObjectId;\n  dentistId: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  appointmentId?: Types.ObjectId;\n  medications: {\n    medicationId: Types.ObjectId;\n    dosage: string;\n    frequency: string;\n    duration: string;\n    instructions?: string;\n    startDate: Date;\n    endDate?: Date;\n  }[];\n  diagnosis: string;\n  notes?: string;\n  status: 'active' | 'completed' | 'cancelled' | 'expired';\n  issuedDate: Date;\n  expiryDate?: Date;\n  refillsAllowed: number;\n  refillsUsed: number;\n  isExpired?: boolean; // Virtual property\n  hasRefillsAvailable?: boolean; // Virtual property\n  createdAt: Date;\n  updatedAt: Date;\n  \n  // Instance methods\n  addRefill(): Promise<IPrescription>;\n}\n\nexport interface IPrescriptionModel extends Model<IPrescription, {}, {}, {}, any, any, any> {\n  findByPatient(patientId: string, options?: any): any;\n  findActive(patientId?: string): any;\n  findExpiring(days?: number): any;\n}\n\n// Billing related types\nexport interface IBilling extends Document {\n  _id: Types.ObjectId;\n  patientId: Types.ObjectId;\n  appointmentId?: Types.ObjectId;\n  treatmentRecordId?: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  dentistId: Types.ObjectId;\n  invoiceNumber: string;\n  items: {\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    totalPrice: number;\n    category: 'consultation' | 'treatment' | 'medication' | 'equipment' | 'other';\n  }[];\n  subtotal: number;\n  taxAmount: number;\n  discountAmount: number;\n  totalAmount: number;\n  paidAmount: number;\n  balanceAmount: number;\n  paymentMethod: 'cash' | 'credit_card' | 'debit_card' | 'insurance' | 'bank_transfer' | 'check' | 'other';\n  paymentStatus: 'pending' | 'partial' | 'paid' | 'overdue' | 'cancelled';\n  insuranceInfo?: {\n    provider?: string;\n    policyNumber?: string;\n    coverageAmount?: number;\n    claimNumber?: string;\n  };\n  dueDate: Date;\n  paidDate?: Date;\n  notes?: string;\n  isActive: boolean;\n  isOverdue?: boolean; // Virtual property\n  createdAt: Date;\n  updatedAt: Date;\n  \n  // Instance methods\n  addPayment(amount: number, method?: string): Promise<IBilling>;\n}\n\nexport interface IBillingModel extends Model<IBilling, {}, {}, {}, any, any, any> {\n  findByPatient(patientId: string, options?: any): any;\n  findOverdue(clinicId?: string): any;\n  getRevenueStats(clinicId: string, startDate: Date, endDate: Date): any;\n}\n\nexport interface INotification extends Document {\n  _id: Types.ObjectId;\n  userId: Types.ObjectId;\n  title: string;\n  message: string;\n  type: 'general' | 'appointment_reminder' | 'appointment_confirmation' | 'appointment_cancellation' | 'system';\n  isRead: boolean;\n  link?: string;\n  createdAt: Date;\n  updatedAt: Date;\n  \n  // Instance methods\n  markAsRead(): Promise<INotification>;\n  markAsUnread(): Promise<INotification>;\n}\n\nexport interface INotificationModel extends Model<INotification, {}, {}, {}, any, any, any> {\n  createScheduleNotification(staffId: any, arg1: string, arg2: string, arg3: string, arg4: { scheduleId: unknown; clinicId: any; date: Date; startTime: any; endTime: any; }, arg5: { email: boolean; sms: boolean; inApp: boolean; }): unknown;\n  createAppointmentConfirmation(appointmentId: string, userId: string): Promise<INotification>;\n  createAppointmentReminder(appointmentId: string, userId: string): Promise<INotification>;\n  createAppointmentCancellation(appointmentId: string, userId: string): Promise<INotification>;\n  createScheduleConflict(staffId: string, scheduleId: string, clinicName: string, date: Date, startTime: string, endTime: string, action: string): Promise<INotification>;\n  createScheduleChange(staffId: string, scheduleId: string, clinicName: string, date: Date, startTime: string, endTime: string, action: string): Promise<INotification>;\n  deleteOldNotifications(days?: number): Promise<any>;\n  markAsRead(notificationId: string): Promise<INotification>;\n  markAllAsRead(userId: string): Promise<any>;\n  getUnreadCount(userId: string): Promise<number>;\n  createNotification(data: any): Promise<INotification>;\n  findByType(userId: string, type: string, options?: any): any;\n  findUnread(userId: string, limit?: number): any;\n}\n\n// Staff Schedule related types\nexport interface IStaffSchedule extends Document {\n  _id: Types.ObjectId;\n  staffId: Types.ObjectId;\n  clinicId: Types.ObjectId;\n  date: Date;\n  startTime: string;\n  endTime: string;\n  shiftType: 'morning' | 'afternoon' | 'evening' | 'night' | 'full-day';\n  status: 'scheduled' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  isRecurring: boolean;\n  recurringPattern?: {\n    frequency: 'daily' | 'weekly' | 'monthly';\n    daysOfWeek?: number[];\n    endDate?: Date;\n  };\n  notifications: {\n    email: boolean;\n    sms: boolean;\n    inApp: boolean;\n    reminderTime: number;\n  };\n  conflictResolution?: {\n    isConflict: boolean;\n    conflictWith?: Types.ObjectId[];\n    resolvedBy?: Types.ObjectId;\n    resolvedAt?: Date;\n  };\n  createdBy: Types.ObjectId;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface IStaffScheduleModel extends Model<IStaffSchedule, {}, {}, {}, any, any, any> {\n  findByClinicAndDateRange(clinicId: string, startDate: Date, endDate: Date): any;\n  findStaffAvailability(staffId: string, date: Date): any;\n  detectConflicts(staffId: string, date: Date, startTime: string, endTime: string, excludeId?: string): any;\n  getCalendarView(clinicId: string, startDate: Date, endDate: Date): any;\n}\n\n// Request types\nexport interface AuthenticatedRequest extends Request {\n  user: IUser;\n}\n\nexport interface PaginationQuery {\n  page?: number;\n  limit?: number;\n  sort?: string;\n  fields?: string;\n}\n\nexport interface DateRangeQuery {\n  startDate?: string;\n  endDate?: string;\n}\n\n// Response types\nexport interface ApiResponse<T = any> {\n  success: boolean;\n  message?: string;\n  data?: T;\n  error?: string;\n}\n\nexport interface PaginatedResponse<T = any> {\n  data: T[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    pages: number;\n    hasNext: boolean;\n    hasPrev: boolean;\n  };\n  success: boolean;\n  message?: string;\n}\n\n// JWT Payload\nexport interface JWTPayload {\n  id: string;\n  email?: string;\n  role?: string;\n  type?: string; // for refresh tokens\n  iat?: number;\n  exp?: number;\n}\n\n// File upload types\nexport interface UploadedFile {\n  fieldname: string;\n  originalname: string;\n  encoding: string;\n  mimetype: string;\n  size: number;\n  destination: string;\n  filename: string;\n  path: string;\n  buffer?: Buffer;\n}\n\n// Email types\nexport interface EmailOptions {\n  to: string;\n  subject: string;\n  text?: string;\n  html?: string;\n  attachments?: {\n    filename: string;\n    content: Buffer | string;\n    contentType?: string;\n  }[];\n}\n\n// Statistics types\nexport interface UserStatistics {\n  totalUsers: number;\n  activeUsers: number;\n  usersByRole: {\n    admin: number;\n    dentist: number;\n    staff: number;\n    patient: number;\n  };\n  recentRegistrations: number;\n}\n\nexport interface PatientStatistics {\n  totalPatients: number;\n  patientsByGender: {\n    male: number;\n    female: number;\n    other: number;\n  };\n  patientsByAgeGroup: {\n    '0-18': number;\n    '19-35': number;\n    '36-50': number;\n    '51-65': number;\n    '65+': number;\n  };\n  recentPatients: number;\n}\n\nexport interface AppointmentStatistics {\n  totalAppointments: number;\n  appointmentsByStatus: {\n    scheduled: number;\n    confirmed: number;\n    'in-progress': number;\n    completed: number;\n    cancelled: number;\n    'no-show': number;\n  };\n  appointmentsToday: number;\n  upcomingAppointments: number;\n  completionRate: number;\n}\n\nexport interface TreatmentStatistics {\n  totalTreatments: number;\n  treatmentsByProcedure: {\n    [procedure: string]: number;\n  };\n  recentTreatments: number;\n  averageTreatmentsPerDay: number;\n}\n\nexport interface ClinicStatistics {\n  totalClinics: number;\n  activeClinics: number;\n  clinicsByCity: {\n    [city: string]: number;\n  };\n  averageStaffPerClinic: number;\n}\n\n// Search and filter types\nexport interface SearchOptions {\n  query: string;\n  fields?: string[];\n  limit?: number;\n  page?: number;\n}\n\nexport interface FilterOptions {\n  [key: string]: any;\n}\n\n// Validation types\nexport interface ValidationError {\n  field: string;\n  message: string;\n  value?: any;\n}\n\n// Time slot types\nexport interface TimeSlot {\n  id: string;\n  time: string;\n  isAvailable: boolean;\n  isPeak: boolean;\n  available: boolean; // Keep for backward compatibility\n  reason?: string;\n}\n\n// Dashboard data types\nexport interface DashboardData {\n  appointments: {\n    today: number;\n    upcoming: number;\n    completed: number;\n    cancelled: number;\n  };\n  patients: {\n    total: number;\n    new: number;\n  };\n  treatments: {\n    total: number;\n    recent: number;\n  };\n  revenue?: {\n    today: number;\n    month: number;\n    year: number;\n  };\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\types\\sharp.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":2,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[40,43],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[40,43],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"declare module 'sharp' {\n  const sharp: any;\n  export = sharp;\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\AppError.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":5,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[144,147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[144,147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[211,214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[211,214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export class AppError extends Error {\n  public statusCode: number;\n  public status: string;\n  public isOperational: boolean;\n  public details?: any;\n\n  constructor(message: string, statusCode: number, details?: any) {\n    super(message);\n    this.statusCode = statusCode;\n    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';\n    this.isOperational = true;\n    this.details = details;\n\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\nexport default AppError;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\asyncHandler.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-function-type","severity":1,"message":"The `Function` type accepts any function-like value.\nPrefer explicitly defining any function parameters and return type.","line":4,"column":34,"nodeType":"Identifier","messageId":"bannedFunctionType","endLine":4,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request, Response, NextFunction } from 'express';\n\n// Async handler to wrap async functions and catch errors\nexport const asyncHandler = (fn: Function) => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    Promise.resolve(fn(req, res, next)).catch(next);\n  };\n};\n\nexport default asyncHandler;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\auth.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[837,840],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[837,840],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[978,981],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[978,981],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2595,2598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2595,2598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":96,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2806,2809],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2806,2809],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":111,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":111,"endColumn":17}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import jwt, { SignOptions } from 'jsonwebtoken';\nimport { StringValue } from 'ms';\nimport bcrypt from 'bcryptjs';\nimport crypto from 'crypto';\nimport { IUser } from '../types';\n\n// Generate JWT token\nexport const generateToken = (userId: string): string => {\n  const options: SignOptions = {\n    expiresIn: (process.env.JWT_EXPIRES_IN || '7d') as StringValue\n  };\n  return jwt.sign(\n    { id: userId },\n    process.env.JWT_SECRET!,\n    options\n  );\n};\n\n// Generate refresh token\nexport const generateRefreshToken = (userId: string): string => {\n  const options: SignOptions = {\n    expiresIn: (process.env.JWT_REFRESH_EXPIRES_IN || '30d') as StringValue\n  };\n  return jwt.sign(\n    { id: userId, type: 'refresh' },\n    process.env.JWT_REFRESH_SECRET!,\n    options\n  );\n};\n\n// Verify JWT token\nexport const verifyToken = (token: string): any => {\n  return jwt.verify(token, process.env.JWT_SECRET!);\n};\n\n// Verify refresh token\nexport const verifyRefreshToken = (token: string): any => {\n  return jwt.verify(token, process.env.JWT_REFRESH_SECRET!);\n};\n\n// Hash password\nexport const hashPassword = async (password: string): Promise<string> => {\n  const saltRounds = await bcrypt.genSaltSync(10);\n  return await bcrypt.hash(password, saltRounds);\n};\n\n// Compare password\nexport const comparePassword = async (\n  plainPassword: string,\n  hashedPassword: string\n): Promise<boolean> => {\n  return await bcrypt.compare(plainPassword, hashedPassword);\n};\n\n// Generate random token for password reset\nexport const generateResetToken = (): string => {\n  return crypto.randomBytes(32).toString('hex');\n};\n\n// Hash reset token\nexport const hashResetToken = (token: string): string => {\n  return crypto.createHash('sha256').update(token).digest('hex');\n};\n\n// Generate OTP for two-factor authentication\nexport const generateOTP = (): string => {\n  return Math.floor(100000 + Math.random() * 900000).toString();\n};\n\n// Create token response object\nexport const createTokenResponse = (user: IUser) => {\n  const token = generateToken(user._id.toString());\n  const refreshToken = generateRefreshToken(user._id.toString());\n  \n  return {\n    token,\n    refreshToken,\n    user: {\n      id: user._id,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      email: user.email,\n      role: user.role,\n      profileImage: user.profileImage,\n      preferredClinicId: user.preferredClinicId,\n      assignedClinics: user.assignedClinics\n    }\n  };\n};\n\n// Extract user ID from token\nexport const extractUserIdFromToken = (token: string): string | null => {\n  try {\n    const decoded = verifyToken(token) as any;\n    return decoded.id;\n  } catch (error) {\n    return null;\n  }\n};\n\n// Check if token is expired\nexport const isTokenExpired = (token: string): boolean => {\n  try {\n    const decoded = jwt.decode(token) as any;\n    if (!decoded || !decoded.exp) {\n      return true;\n    }\n    \n    const currentTime = Math.floor(Date.now() / 1000);\n    return decoded.exp < currentTime;\n  } catch (error) {\n    return true;\n  }\n};\n\n// Generate secure random string\nexport const generateSecureRandom = (length: number = 32): string => {\n  return crypto.randomBytes(length).toString('hex');\n};\n\n// Create password reset URL\nexport const createPasswordResetURL = (token: string): string => {\n  const frontendURL = process.env.FRONTEND_URL || 'http://localhost:3000';\n  return `${frontendURL}/reset-password?token=${token}`;\n};\n\n// Create email verification URL\nexport const createEmailVerificationURL = (token: string): string => {\n  const frontendURL = process.env.FRONTEND_URL || 'http://localhost:3000';\n  return `${frontendURL}/verify-email?token=${token}`;\n};\n\n// Validate password strength\nexport const validatePasswordStrength = (password: string): {\n  isValid: boolean;\n  errors: string[];\n} => {\n  const errors: string[] = [];\n  \n  if (password.length < 8) {\n    errors.push('Password must be at least 8 characters long');\n  }\n  \n  if (!/[a-z]/.test(password)) {\n    errors.push('Password must contain at least one lowercase letter');\n  }\n  \n  if (!/[A-Z]/.test(password)) {\n    errors.push('Password must contain at least one uppercase letter');\n  }\n  \n  if (!/\\d/.test(password)) {\n    errors.push('Password must contain at least one number');\n  }\n  \n  if (!/[@$!%*?&]/.test(password)) {\n    errors.push('Password must contain at least one special character (@$!%*?&)');\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n// Generate API key\nexport const generateApiKey = (): string => {\n  const prefix = 'dk_'; // dental clinic key prefix\n  const randomPart = crypto.randomBytes(24).toString('hex');\n  return `${prefix}${randomPart}`;\n};\n\n// Hash API key for storage\nexport const hashApiKey = (apiKey: string): string => {\n  return crypto.createHash('sha256').update(apiKey).digest('hex');\n};                                          ","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\cronService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":8,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[256,259],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[256,259],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1066,1069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1066,1069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":54,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1643,1646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1643,1646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":88,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2736,2739],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2736,2739],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3897,3900],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3897,3900],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4750,4753],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4750,4753],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5922,5925],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5922,5925],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6268,6271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6268,6271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":257,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":257,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8040,8043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8040,8043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import cron from 'node-cron';\nimport logger from './logger';\nimport { scheduleDailyReminderBatch, getQueueStats } from './jobQueue';\nimport mongoose from 'mongoose';\n\nclass CronService {\n  private static instance: CronService;\n  private tasks: Map<string, any> = new Map();\n\n  private constructor() {}\n\n  public static getInstance(): CronService {\n    if (!CronService.instance) {\n      CronService.instance = new CronService();\n    }\n    return CronService.instance;\n  }\n\n  // Initialize all cron jobs\n  public async initialize() {\n    logger.info('Initializing cron service...');\n\n    try {\n      // Daily reminder batch - runs at 6:00 AM every day\n      this.scheduleDailyReminderBatch();\n      \n      // Queue cleanup - runs every 4 hours\n      this.scheduleQueueCleanup();\n      \n      // Queue monitoring - runs every 30 minutes\n      this.scheduleQueueMonitoring();\n      \n      // Database maintenance - runs at 2:00 AM every day\n      this.scheduleDatabaseMaintenance();\n      \n      logger.info('All cron jobs scheduled successfully');\n    } catch (error: any) {\n      logger.error('Failed to initialize cron service:', error.message);\n    }\n  }\n\n  // Schedule daily reminder batch processing\n  private scheduleDailyReminderBatch() {\n    const task = cron.schedule(\n      '0 6 * * *', // Every day at 6:00 AM\n      async () => {\n        try {\n          logger.info('Starting daily reminder batch processing...');\n          \n          // Schedule reminders for tomorrow's appointments\n          await scheduleDailyReminderBatch();\n          \n          logger.info('Daily reminder batch scheduling completed');\n        } catch (error: any) {\n          logger.error('Error in daily reminder batch processing:', error.message);\n        }\n      },\n      {\n        timezone: process.env.TIMEZONE || 'UTC'\n      }\n    );\n\n    this.tasks.set('dailyReminderBatch', task);\n    logger.info('Daily reminder batch job scheduled (6:00 AM daily)');\n  }\n\n  // Schedule queue cleanup to remove old completed/failed jobs\n  private scheduleQueueCleanup() {\n    const task = cron.schedule(\n      '0 */4 * * *', // Every 4 hours\n      async () => {\n        try {\n          logger.info('Starting queue cleanup...');\n          \n          const stats = await getQueueStats();\n          if (stats) {\n            logger.info(`Queue stats before cleanup: ${JSON.stringify(stats)}`);\n          }\n          \n          // Queue cleanup is handled by Bull's built-in mechanisms\n          // but we can add custom logic here if needed\n          \n          const statsAfter = await getQueueStats();\n          if (statsAfter) {\n            logger.info(`Queue stats after cleanup: ${JSON.stringify(statsAfter)}`);\n          }\n          \n        } catch (error: any) {\n          logger.error('Error in queue cleanup:', error.message);\n        }\n      },\n      {\n        timezone: process.env.TIMEZONE || 'UTC'\n      }\n    );\n\n    this.tasks.set('queueCleanup', task);\n    logger.info('Queue cleanup job scheduled (every 4 hours)');\n  }\n\n  // Schedule queue monitoring and health checks\n  private scheduleQueueMonitoring() {\n    const task = cron.schedule(\n      '*/30 * * * *', // Every 30 minutes\n      async () => {\n        try {\n          const stats = await getQueueStats();\n          if (stats) {\n            logger.info(`Queue health check - Total jobs: ${stats.total}, Active: ${stats.active}, Failed: ${stats.failed}, Delayed: ${stats.delayed}`);\n            \n            // Alert if there are too many failed jobs\n            if (stats.failed > 50) {\n              logger.warn(`High number of failed jobs detected: ${stats.failed}`);\n            }\n            \n            // Alert if queue seems stalled\n            if (stats.active === 0 && stats.waiting > 0) {\n              logger.warn(`Queue appears stalled - ${stats.waiting} jobs waiting but none active`);\n            }\n          }\n        } catch (error: any) {\n          logger.error('Error in queue monitoring:', error.message);\n        }\n      },\n      {\n        timezone: process.env.TIMEZONE || 'UTC'\n      }\n    );\n\n    this.tasks.set('queueMonitoring', task);\n    logger.info('Queue monitoring job scheduled (every 30 minutes)');\n  }\n\n  // Schedule database maintenance tasks\n  private scheduleDatabaseMaintenance() {\n    const task = cron.schedule(\n      '0 2 * * *', // Every day at 2:00 AM\n      async () => {\n        try {\n          logger.info('Starting database maintenance...');\n          \n          // Clean up old notifications (older than 30 days)\n          const Notification = mongoose.model('Notification');\n          const thirtyDaysAgo = new Date();\n          thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n          \n          const deletedNotifications = await (Notification as any).deleteMany({\n            createdAt: { $lt: thirtyDaysAgo },\n            read: true\n          });\n          \n          if (deletedNotifications.deletedCount > 0) {\n            logger.info(`Cleaned up ${deletedNotifications.deletedCount} old notifications`);\n          }\n          \n          // Update appointment statuses for past appointments\n          const Appointment = mongoose.model('Appointment');\n          const yesterday = new Date();\n          yesterday.setDate(yesterday.getDate() - 1);\n          yesterday.setHours(23, 59, 59, 999);\n          \n          const outdatedAppointments = await Appointment.updateMany(\n            {\n              date: { $lt: yesterday },\n              status: { $in: ['scheduled', 'confirmed'] }\n            },\n            { \n              status: 'no-show',\n              $set: { updatedAt: new Date() }\n            }\n          );\n          \n          if (outdatedAppointments.modifiedCount > 0) {\n            logger.info(`Updated ${outdatedAppointments.modifiedCount} past appointments to no-show status`);\n          }\n          \n          // Log database statistics\n          const appointmentStats = await (Appointment as any).aggregate([\n            {\n              $group: {\n                _id: '$status',\n                count: { $sum: 1 }\n              }\n            }\n          ]);\n          \n          logger.info('Appointment status distribution:', appointmentStats);\n          \n          logger.info('Database maintenance completed');\n        } catch (error: any) {\n          logger.error('Error in database maintenance:', error.message);\n        }\n      },\n      {\n        timezone: process.env.TIMEZONE || 'UTC'\n      }\n    );\n\n    this.tasks.set('databaseMaintenance', task);\n    logger.info('Database maintenance job scheduled (2:00 AM daily)');\n  }\n\n  // Stop a specific cron job\n  public stopTask(taskName: string): boolean {\n    const task = this.tasks.get(taskName);\n    if (task) {\n      task.stop();\n      this.tasks.delete(taskName);\n      logger.info(`Stopped cron task: ${taskName}`);\n      return true;\n    }\n    return false;\n  }\n\n  // Start a specific cron job\n  public startTask(taskName: string): boolean {\n    const task = this.tasks.get(taskName);\n    if (task) {\n      task.start();\n      logger.info(`Started cron task: ${taskName}`);\n      return true;\n    }\n    return false;\n  }\n\n  // Stop all cron jobs\n  public stopAll() {\n    logger.info('Stopping all cron jobs...');\n    \n    this.tasks.forEach((task, taskName) => {\n      task.stop();\n      logger.info(`Stopped cron task: ${taskName}`);\n    });\n    \n    this.tasks.clear();\n    logger.info('All cron jobs stopped');\n  }\n\n  // Get status of all cron jobs\n  public getStatus() {\n    const status: Record<string, boolean> = {};\n    \n    this.tasks.forEach((task, taskName) => {\n      status[taskName] = task.getStatus() === 'scheduled';\n    });\n    \n    return status;\n  }\n\n  // Manual trigger for daily reminder batch (for testing)\n  public async triggerDailyBatch(targetDate?: Date, clinicIds?: string[]) {\n    try {\n      logger.info('Manually triggering daily reminder batch...');\n      await scheduleDailyReminderBatch(targetDate, clinicIds);\n      logger.info('Daily reminder batch triggered successfully');\n      return true;\n    } catch (error: any) {\n      logger.error('Failed to trigger daily reminder batch:', error.message);\n      return false;\n    }\n  }\n}\n\nexport default CronService;\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\email.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createEmailVerificationURL' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":60}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import nodemailer from 'nodemailer';\nimport { createPasswordResetURL, createEmailVerificationURL } from './auth';\n\n// Email configuration\nconst createTransporter = () => {\n  return nodemailer.createTransport({\n    host: process.env.EMAIL_HOST,\n    port: parseInt(process.env.EMAIL_PORT || '587'),\n    secure: process.env.EMAIL_SECURE === 'true',\n    auth: {\n      user: process.env.EMAIL_USER,\n      pass: process.env.EMAIL_PASS\n    }\n  });\n};\n\n// Send email function\nconst sendEmail = async (options: {\n  to: string;\n  subject: string;\n  text?: string;\n  html?: string;\n}) => {\n  try {\n    const transporter = createTransporter();\n    \n    const mailOptions = {\n      from: `${process.env.EMAIL_FROM_NAME || 'Dental Clinic'} <${process.env.EMAIL_FROM}>`,\n      to: options.to,\n      subject: options.subject,\n      text: options.text,\n      html: options.html\n    };\n\n    const info = await transporter.sendMail(mailOptions);\n    console.log('Email sent:', info.messageId);\n    return info;\n  } catch (error) {\n    console.error('Email sending failed:', error);\n    throw new Error('Failed to send email');\n  }\n};\n\n// Send welcome email\nexport const sendWelcomeEmail = async (email: string, firstName: string) => {\n  const subject = 'Welcome to Our Dental Clinic!';\n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Welcome</title>\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background-color: #2563eb; color: white; padding: 20px; text-align: center; }\n            .content { padding: 20px; background-color: #f9fafb; }\n            .footer { padding: 20px; text-align: center; color: #666; }\n            .button { display: inline-block; padding: 12px 24px; background-color: #2563eb; color: white; text-decoration: none; border-radius: 5px; }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <h1>Welcome to Our Dental Clinic!</h1>\n            </div>\n            <div class=\"content\">\n                <h2>Hello ${firstName}!</h2>\n                <p>Thank you for joining our dental clinic management system. We're excited to have you on board!</p>\n                <p>You can now:</p>\n                <ul>\n                    <li>Schedule appointments online</li>\n                    <li>View your treatment history</li>\n                    <li>Manage your profile</li>\n                    <li>Receive appointment reminders</li>\n                </ul>\n                <p>If you have any questions, please don't hesitate to contact us.</p>\n            </div>\n            <div class=\"footer\">\n                <p>Best regards,<br>The Dental Clinic Team</p>\n            </div>\n        </div>\n    </body>\n    </html>\n  `;\n  \n  const text = `\n    Welcome to Our Dental Clinic!\n    \n    Hello ${firstName}!\n    \n    Thank you for joining our dental clinic management system. We're excited to have you on board!\n    \n    You can now:\n    - Schedule appointments online\n    - View your treatment history\n    - Manage your profile\n    - Receive appointment reminders\n    \n    If you have any questions, please don't hesitate to contact us.\n    \n    Best regards,\n    The Dental Clinic Team\n  `;\n\n  return await sendEmail({ to: email, subject, text, html });\n};\n\n// Send password reset email\nexport const sendPasswordResetEmail = async (email: string, resetToken: string) => {\n  const resetURL = createPasswordResetURL(resetToken);\n  const subject = 'Password Reset Request';\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Password Reset</title>\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background-color: #dc2626; color: white; padding: 20px; text-align: center; }\n            .content { padding: 20px; background-color: #f9fafb; }\n            .footer { padding: 20px; text-align: center; color: #666; }\n            .button { display: inline-block; padding: 12px 24px; background-color: #dc2626; color: white; text-decoration: none; border-radius: 5px; margin: 20px 0; }\n            .warning { background-color: #fef2f2; border-left: 4px solid #dc2626; padding: 15px; margin: 20px 0; }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <h1>Password Reset Request</h1>\n            </div>\n            <div class=\"content\">\n                <p>You have requested a password reset for your account.</p>\n                <p>Click the button below to reset your password:</p>\n                <a href=\"${resetURL}\" class=\"button\">Reset Password</a>\n                <div class=\"warning\">\n                    <strong>Important:</strong>\n                    <ul>\n                        <li>This link will expire in 1 hour</li>\n                        <li>If you didn't request this reset, please ignore this email</li>\n                        <li>For security, this link can only be used once</li>\n                    </ul>\n                </div>\n                <p>If the button doesn't work, copy and paste this link into your browser:</p>\n                <p style=\"word-break: break-all; color: #666;\">${resetURL}</p>\n            </div>\n            <div class=\"footer\">\n                <p>Best regards,<br>The Dental Clinic Team</p>\n            </div>\n        </div>\n    </body>\n    </html>\n  `;\n  \n  const text = `\n    Password Reset Request\n    \n    You have requested a password reset for your account.\n    \n    Click the link below to reset your password:\n    ${resetURL}\n    \n    Important:\n    - This link will expire in 1 hour\n    - If you didn't request this reset, please ignore this email\n    - For security, this link can only be used once\n    \n    Best regards,\n    The Dental Clinic Team\n  `;\n\n  return await sendEmail({ to: email, subject, text, html });\n};\n\n// Send appointment confirmation email\nexport const sendAppointmentConfirmationEmail = async (\n  email: string,\n  patientName: string,\n  appointmentDetails: {\n    date: string;\n    time: string;\n    dentist: string;\n    clinic: string;\n    service: string;\n  }\n) => {\n  const subject = 'Appointment Confirmation';\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Appointment Confirmation</title>\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background-color: #059669; color: white; padding: 20px; text-align: center; }\n            .content { padding: 20px; background-color: #f9fafb; }\n            .footer { padding: 20px; text-align: center; color: #666; }\n            .appointment-details { background-color: white; padding: 20px; border-radius: 8px; margin: 20px 0; }\n            .detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #e5e7eb; }\n            .detail-label { font-weight: bold; }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <h1> Appointment Confirmed</h1>\n            </div>\n            <div class=\"content\">\n                <h2>Hello ${patientName}!</h2>\n                <p>Your appointment has been confirmed. Here are the details:</p>\n                \n                <div class=\"appointment-details\">\n                    <div class=\"detail-row\">\n                        <span class=\"detail-label\">Date:</span>\n                        <span>${appointmentDetails.date}</span>\n                    </div>\n                    <div class=\"detail-row\">\n                        <span class=\"detail-label\">Time:</span>\n                        <span>${appointmentDetails.time}</span>\n                    </div>\n                    <div class=\"detail-row\">\n                        <span class=\"detail-label\">Dentist:</span>\n                        <span>${appointmentDetails.dentist}</span>\n                    </div>\n                    <div class=\"detail-row\">\n                        <span class=\"detail-label\">Clinic:</span>\n                        <span>${appointmentDetails.clinic}</span>\n                    </div>\n                    <div class=\"detail-row\">\n                        <span class=\"detail-label\">Service:</span>\n                        <span>${appointmentDetails.service}</span>\n                    </div>\n                </div>\n                \n                <p><strong>Please note:</strong></p>\n                <ul>\n                    <li>Arrive 15 minutes early for check-in</li>\n                    <li>Bring a valid ID and insurance card</li>\n                    <li>If you need to reschedule, please contact us at least 24 hours in advance</li>\n                </ul>\n            </div>\n            <div class=\"footer\">\n                <p>Best regards,<br>The Dental Clinic Team</p>\n            </div>\n        </div>\n    </body>\n    </html>\n  `;\n  \n  const text = `\n    Appointment Confirmed\n    \n    Hello ${patientName}!\n    \n    Your appointment has been confirmed. Here are the details:\n    \n    Date: ${appointmentDetails.date}\n    Time: ${appointmentDetails.time}\n    Dentist: ${appointmentDetails.dentist}\n    Clinic: ${appointmentDetails.clinic}\n    Service: ${appointmentDetails.service}\n    \n    Please note:\n    - Arrive 15 minutes early for check-in\n    - Bring a valid ID and insurance card\n    - If you need to reschedule, please contact us at least 24 hours in advance\n    \n    Best regards,\n    The Dental Clinic Team\n  `;\n\n  return await sendEmail({ to: email, subject, text, html });\n};\n\n// Send appointment reminder email\nexport const sendAppointmentReminderEmail = async (\n  email: string,\n  patientName: string,\n  appointmentDetails: {\n    date: string;\n    time: string;\n    dentist: string;\n    clinic: string;\n  }\n) => {\n  const subject = 'Appointment Reminder - Tomorrow';\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Appointment Reminder</title>\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background-color: #f59e0b; color: white; padding: 20px; text-align: center; }\n            .content { padding: 20px; background-color: #f9fafb; }\n            .footer { padding: 20px; text-align: center; color: #666; }\n            .reminder-box { background-color: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 20px 0; }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <h1> Appointment Reminder</h1>\n            </div>\n            <div class=\"content\">\n                <h2>Hello ${patientName}!</h2>\n                <div class=\"reminder-box\">\n                    <p><strong>This is a friendly reminder about your upcoming appointment:</strong></p>\n                    <p><strong>Tomorrow, ${appointmentDetails.date} at ${appointmentDetails.time}</strong></p>\n                    <p>Dentist: ${appointmentDetails.dentist}<br>\n                    Location: ${appointmentDetails.clinic}</p>\n                </div>\n                \n                <p>Please remember to:</p>\n                <ul>\n                    <li>Arrive 15 minutes early</li>\n                    <li>Bring your ID and insurance card</li>\n                    <li>Contact us if you need to reschedule</li>\n                </ul>\n            </div>\n            <div class=\"footer\">\n                <p>Best regards,<br>The Dental Clinic Team</p>\n            </div>\n        </div>\n    </body>\n    </html>\n  `;\n  \n  const text = `\n    Appointment Reminder\n    \n    Hello ${patientName}!\n    \n    This is a friendly reminder about your upcoming appointment:\n    \n    Tomorrow, ${appointmentDetails.date} at ${appointmentDetails.time}\n    Dentist: ${appointmentDetails.dentist}\n    Location: ${appointmentDetails.clinic}\n    \n    Please remember to:\n    - Arrive 15 minutes early\n    - Bring your ID and insurance card\n    - Contact us if you need to reschedule\n    \n    Best regards,\n    The Dental Clinic Team\n  `;\n\n  return await sendEmail({ to: email, subject, text, html });\n};\n\n// Send appointment cancellation email\nexport const sendAppointmentCancellationEmail = async (\n  email: string,\n  patientName: string,\n  appointmentDetails: {\n    date: string;\n    time: string;\n    reason?: string;\n  }\n) => {\n  const subject = 'Appointment Cancelled';\n  \n  const reasonText = appointmentDetails.reason \n    ? `<p><strong>Reason:</strong> ${appointmentDetails.reason}</p>`\n    : '';\n  \n  const html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Appointment Cancelled</title>\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background-color: #dc2626; color: white; padding: 20px; text-align: center; }\n            .content { padding: 20px; background-color: #f9fafb; }\n            .footer { padding: 20px; text-align: center; color: #666; }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <h1> Appointment Cancelled</h1>\n            </div>\n            <div class=\"content\">\n                <h2>Hello ${patientName}!</h2>\n                <p>We regret to inform you that your appointment scheduled for <strong>${appointmentDetails.date} at ${appointmentDetails.time}</strong> has been cancelled.</p>\n                ${reasonText}\n                <p>We apologize for any inconvenience this may cause. Please contact us to reschedule your appointment.</p>\n            </div>\n            <div class=\"footer\">\n                <p>Best regards,<br>The Dental Clinic Team</p>\n            </div>\n        </div>\n    </body>\n    </html>\n  `;\n  \n  const text = `\n    Appointment Cancelled\n    \n    Hello ${patientName}!\n    \n    We regret to inform you that your appointment scheduled for ${appointmentDetails.date} at ${appointmentDetails.time} has been cancelled.\n    \n    ${appointmentDetails.reason ? `Reason: ${appointmentDetails.reason}` : ''}\n    \n    We apologize for any inconvenience this may cause. Please contact us to reschedule your appointment.\n    \n    Best regards,\n    The Dental Clinic Team\n  `;\n\n  return await sendEmail({ to: email, subject, text, html });\n};\n\n// Test email configuration\nexport const testEmailConfiguration = async (): Promise<boolean> => {\n  try {\n    const transporter = createTransporter();\n    await transporter.verify();\n    console.log('Email configuration is valid');\n    return true;\n  } catch (error) {\n    console.error('Email configuration error:', error);\n    return false;\n  }\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\helpers.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PaginationQuery' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":312,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":312,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8881,8884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8881,8884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Request } from 'express';\nimport { PaginatedResponse, PaginationQuery } from '../types';\n\n// Pagination helper\nexport const getPaginationParams = (req: Request) => {\n  const page = Math.max(1, typeof req.query.page === 'number' ? req.query.page : parseInt(req.query.page?.toString() || '1', 10));\n  const limit = Math.min(100, Math.max(1, typeof req.query.limit === 'number' ? req.query.limit : parseInt(req.query.limit?.toString() || '10', 10)));\n  const skip = (page - 1) * limit;\n  \n  return {\n    page,\n    limit,\n    skip\n  };\n};\n\n// Create paginated response\nexport const createPaginatedResponse = <T>(\n  data: T[],\n  total: number,\n  page: number,\n  limit: number\n): PaginatedResponse<T> => {\n  const totalPages = Math.ceil(total / limit);\n  const hasNextPage = page < totalPages;\n  const hasPrevPage = page > 1;\n  \n  return {\n    success: true,\n    data,\n    pagination: {\n      page,\n      limit,\n      total,\n      pages: totalPages,\n      hasNext: hasNextPage,\n      hasPrev: hasPrevPage\n    }\n  };\n};\n\n// Date formatting helpers\nexport const formatDate = (date: Date, format: 'short' | 'long' | 'iso' = 'short'): string => {\n  switch (format) {\n    case 'short':\n      return date.toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      });\n    case 'long':\n      return date.toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        weekday: 'long'\n      });\n    case 'iso':\n      return date.toISOString().split('T')[0];\n    default:\n      return date.toLocaleDateString();\n  }\n};\n\nexport const formatDateTime = (date: Date): string => {\n  return date.toLocaleString('en-US', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true\n  });\n};\n\nexport const formatTime = (date: Date): string => {\n  return date.toLocaleTimeString('en-US', {\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true\n  });\n};\n\n// Date validation helpers\nexport const isValidDate = (dateString: string): boolean => {\n  const date = new Date(dateString);\n  return date instanceof Date && !isNaN(date.getTime());\n};\n\nexport const isFutureDate = (date: Date): boolean => {\n  return date > new Date();\n};\n\nexport const isPastDate = (date: Date): boolean => {\n  return date < new Date();\n};\n\nexport const isToday = (date: Date): boolean => {\n  const today = new Date();\n  return date.toDateString() === today.toDateString();\n};\n\nexport const isTomorrow = (date: Date): boolean => {\n  const tomorrow = new Date();\n  tomorrow.setDate(tomorrow.getDate() + 1);\n  return date.toDateString() === tomorrow.toDateString();\n};\n\n// Time helpers\nexport const parseTimeString = (timeString: string): { hours: number; minutes: number } => {\n  const [hours, minutes] = timeString.split(':').map(Number);\n  return { hours, minutes };\n};\n\nexport const formatTimeString = (hours: number, minutes: number): string => {\n  return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n};\n\nexport const addMinutesToTime = (timeString: string, minutesToAdd: number): string => {\n  const { hours, minutes } = parseTimeString(timeString);\n  const totalMinutes = hours * 60 + minutes + minutesToAdd;\n  const newHours = Math.floor(totalMinutes / 60) % 24;\n  const newMinutes = totalMinutes % 60;\n  return formatTimeString(newHours, newMinutes);\n};\n\nexport const getTimeDifferenceInMinutes = (startTime: string, endTime: string): number => {\n  const start = parseTimeString(startTime);\n  const end = parseTimeString(endTime);\n  const startMinutes = start.hours * 60 + start.minutes;\n  const endMinutes = end.hours * 60 + end.minutes;\n  return endMinutes - startMinutes;\n};\n\n// String helpers\nexport const capitalizeFirstLetter = (str: string): string => {\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n};\n\nexport const capitalizeWords = (str: string): string => {\n  return str.split(' ').map(capitalizeFirstLetter).join(' ');\n};\n\nexport const generateSlug = (text: string): string => {\n  return text\n    .toLowerCase()\n    .replace(/[^\\w\\s-]/g, '')\n    .replace(/[\\s_-]+/g, '-')\n    .replace(/^-+|-+$/g, '');\n};\n\nexport const truncateText = (text: string, maxLength: number): string => {\n  if (text.length <= maxLength) return text;\n  return text.substring(0, maxLength).trim() + '...';\n};\n\n// Phone number helpers\nexport const formatPhoneNumber = (phone: string): string => {\n  const cleaned = phone.replace(/\\D/g, '');\n  if (cleaned.length === 10) {\n    return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(6)}`;\n  }\n  return phone;\n};\n\nexport const validatePhoneNumber = (phone: string): boolean => {\n  const phoneRegex = /^[\\+]?[1-9][\\d]{0,15}$/;\n  return phoneRegex.test(phone.replace(/\\D/g, ''));\n};\n\n// Email helpers\nexport const validateEmail = (email: string): boolean => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n};\n\nexport const maskEmail = (email: string): string => {\n  const [username, domain] = email.split('@');\n  if (username.length <= 2) return email;\n  const maskedUsername = username[0] + '*'.repeat(username.length - 2) + username[username.length - 1];\n  return `${maskedUsername}@${domain}`;\n};\n\n// Array helpers\nexport const removeDuplicates = <T>(array: T[]): T[] => {\n  return [...new Set(array)];\n};\n\nexport const groupBy = <T, K extends keyof T>(array: T[], key: K): Record<string, T[]> => {\n  return array.reduce((groups, item) => {\n    const group = String(item[key]);\n    groups[group] = groups[group] || [];\n    groups[group].push(item);\n    return groups;\n  }, {} as Record<string, T[]>);\n};\n\nexport const sortBy = <T>(array: T[], key: keyof T, direction: 'asc' | 'desc' = 'asc'): T[] => {\n  return [...array].sort((a, b) => {\n    const aVal = a[key];\n    const bVal = b[key];\n    \n    if (aVal < bVal) return direction === 'asc' ? -1 : 1;\n    if (aVal > bVal) return direction === 'asc' ? 1 : -1;\n    return 0;\n  });\n};\n\n// Object helpers\nexport const omit = <T, K extends keyof T>(obj: T, keys: K[]): Omit<T, K> => {\n  const result = { ...obj };\n  keys.forEach(key => delete result[key]);\n  return result;\n};\n\nexport const pick = <T extends object, K extends keyof T>(obj: T, keys: K[]): Pick<T, K> => {\n  const result = {} as Pick<T, K>;\n  keys.forEach((key) => {\n    if (key in obj) {\n      result[key] = obj[key];\n    }\n  });\n  return result;\n};\n\n// Search helpers\nexport const createSearchRegex = (searchTerm: string): RegExp => {\n  const escapedTerm = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  return new RegExp(escapedTerm, 'i');\n};\n\nexport const highlightSearchTerm = (text: string, searchTerm: string): string => {\n  if (!searchTerm) return text;\n  const regex = new RegExp(`(${searchTerm})`, 'gi');\n  return text.replace(regex, '<mark>$1</mark>');\n};\n\n// Age calculation\nexport const calculateAge = (birthDate: Date): number => {\n  const today = new Date();\n  let age = today.getFullYear() - birthDate.getFullYear();\n  const monthDiff = today.getMonth() - birthDate.getMonth();\n  \n  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n    age--;\n  }\n  \n  return age;\n};\n\n// Random helpers\nexport const generateRandomString = (length: number): string => {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let result = '';\n  for (let i = 0; i < length; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return result;\n};\n\nexport const generateRandomNumber = (min: number, max: number): number => {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\n// Delay helper\nexport const delay = (ms: number): Promise<void> => {\n  return new Promise(resolve => setTimeout(resolve, ms));\n};\n\n// Environment helpers\nexport const isDevelopment = (): boolean => {\n  return process.env.NODE_ENV === 'development';\n};\n\nexport const isProduction = (): boolean => {\n  return process.env.NODE_ENV === 'production';\n};\n\nexport const isTest = (): boolean => {\n  return process.env.NODE_ENV === 'test';\n};\n\n// Error helpers\nexport const getErrorMessage = (error: unknown): string => {\n  if (error instanceof Error) {\n    return error.message;\n  }\n  return String(error);\n};\n\n// URL helpers\nexport const buildUrl = (baseUrl: string, path: string, params?: Record<string, string>): string => {\n  const url = new URL(path, baseUrl);\n  if (params) {\n    Object.entries(params).forEach(([key, value]) => {\n      url.searchParams.append(key, value);\n    });\n  }\n  return url.toString();\n};\n\n// Validation helpers\nexport const isValidObjectId = (id: string): boolean => {\n  return /^[0-9a-fA-F]{24}$/.test(id);\n};\n\nexport const sanitizeInput = (input: string): string => {\n  return input.trim().replace(/[<>\"'&]/g, '');\n};\n\n// Time slot validation\nexport const isValidTimeSlot = (timeSlot: any): boolean => {\n  if (!timeSlot || typeof timeSlot !== 'object') {\n    return false;\n  }\n  \n  const { start, end } = timeSlot;\n  \n  if (!start || !end) {\n    return false;\n  }\n  \n  // Validate time format (HH:MM)\n  const timeRegex = /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/;\n  \n  if (!timeRegex.test(start) || !timeRegex.test(end)) {\n    return false;\n  }\n  \n  // Validate that end time is after start time\n  const startMinutes = parseTimeString(start);\n  const endMinutes = parseTimeString(end);\n  const startTotal = startMinutes.hours * 60 + startMinutes.minutes;\n  const endTotal = endMinutes.hours * 60 + endMinutes.minutes;\n  \n  return endTotal > startTotal;\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\jobQueue.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'redis' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":10,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2018,2021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2018,2021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2577,2580],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2577,2580],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2707,2710],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2707,2710],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":89,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2920,2923],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2920,2923],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3586,3589],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3586,3589],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4428,4431],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4428,4431],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":136,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4727,4730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4727,4730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":146,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":146,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5204,5207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5204,5207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5449,5452],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5449,5452],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6004,6007],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6004,6007],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6407,6410],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6407,6410],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8415,8418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8415,8418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patient' is defined but never used. Allowed unused args must match /^_/u.","line":244,"column":79,"nodeType":null,"messageId":"unusedVar","endLine":244,"endColumn":86},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8664,8667],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8664,8667],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'dentist' is defined but never used. Allowed unused args must match /^_/u.","line":244,"column":94,"nodeType":null,"messageId":"unusedVar","endLine":244,"endColumn":101},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8679,8682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8679,8682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'clinic' is defined but never used. Allowed unused args must match /^_/u.","line":244,"column":109,"nodeType":null,"messageId":"unusedVar","endLine":244,"endColumn":115},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":118,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":121,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8693,8696],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8693,8696],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10515,10518],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10515,10518],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":306,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":306,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11184,11187],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11184,11187],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":331,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11975,11978],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11975,11978],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":355,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":355,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12835,12838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12835,12838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Bull from 'bull';\nimport Redis from 'ioredis';\nimport { IAppointment } from '../types';\nimport { sendAppointmentReminderEmail } from './email';\nimport { sendAppointmentReminderSMS } from './sms';\nimport mongoose from 'mongoose';\nimport logger from './logger';\n\n// Redis connection\nconst redis = new Redis({\n  host: process.env.REDIS_HOST || 'localhost',\n  port: parseInt(process.env.REDIS_PORT || '6379'),\n  password: process.env.REDIS_PASSWORD,\n  lazyConnect: true,\n});\n\n// Job queue for appointment reminders\nexport const appointmentReminderQueue = new Bull('appointment-reminders', {\n  redis: {\n    host: process.env.REDIS_HOST || 'localhost',\n    port: parseInt(process.env.REDIS_PORT || '6379'),\n    password: process.env.REDIS_PASSWORD,\n  },\n  defaultJobOptions: {\n    removeOnComplete: 50, // Keep 50 completed jobs for monitoring\n    removeOnFail: 100, // Keep 100 failed jobs for debugging\n    attempts: 3, // Retry failed jobs up to 3 times\n    backoff: {\n      type: 'exponential',\n      delay: 5000, // Start with 5 second delay\n    },\n  },\n});\n\n// Job data interfaces\ninterface AppointmentReminderJob {\n  appointmentId: string;\n  patientId: string;\n  reminderType: '24h' | '2h' | '30m' | 'custom';\n  customHours?: number;\n  channels: {\n    email: boolean;\n    sms: boolean;\n    inApp: boolean;\n  };\n}\n\ninterface DailyReminderBatchJob {\n  date: string;\n  clinicIds?: string[];\n}\n\n// Process appointment reminder jobs\nappointmentReminderQueue.process('send-reminder', async (job) => {\n  const { appointmentId, patientId, channels } = job.data as AppointmentReminderJob;\n  \n  try {\n    logger.info(`Processing reminder for appointment ${appointmentId}`);\n    \n    // Fetch appointment with populated data\n    const Appointment = mongoose.model('Appointment');\n    const Patient = mongoose.model('Patient');\n    const User = mongoose.model('User');\n    const Clinic = mongoose.model('Clinic');\n    const Notification = mongoose.model('Notification');\n    \n    const appointment = await (Appointment as any).findById(appointmentId);\n    if (!appointment) {\n      throw new Error(`Appointment ${appointmentId} not found`);\n    }\n    \n    // Check if appointment is still valid for reminders\n    if (['cancelled', 'completed', 'no-show'].includes(appointment.status)) {\n      logger.info(`Skipping reminder for ${appointmentId} - status: ${appointment.status}`);\n      return { skipped: true, reason: `Appointment status is ${appointment.status}` };\n    }\n    \n    // Fetch related data\n    const [patient, dentist, clinic] = await Promise.all([\n      (Patient as any).findById(appointment.patientId),\n      appointment.dentistId ? User.findById(appointment.dentistId) : null,\n      (Clinic as any).findById(appointment.clinicId)\n    ]);\n    \n    if (!patient) {\n      throw new Error(`Patient ${patientId} not found`);\n    }\n    \n    const results = { email: false, sms: false, inApp: false, errors: [] as any[] };\n    \n    // Send email reminder\n    if (channels.email && patient.email) {\n      try {\n        await sendAppointmentReminderEmail(\n          patient.email,\n          patient.fullName || `${patient.firstName} ${patient.lastName}`,\n          {\n            date: appointment.date.toDateString(),\n            time: appointment.timeSlot,\n            dentist: dentist ? (dentist.fullName || `${dentist.firstName} ${dentist.lastName}`) : 'Assigned dentist',\n            clinic: clinic ? clinic.name : 'Our clinic'\n          }\n        );\n        results.email = true;\n        logger.info(`Email reminder sent for appointment ${appointmentId}`);\n      } catch (err: any) {\n        results.errors.push({ type: 'email', message: err.message });\n        logger.error(`Failed to send email reminder for appointment ${appointmentId}: ${err.message}`);\n      }\n    }\n    \n    // Send SMS reminder\n    if (channels.sms && patient.phone) {\n      try {\n        await sendAppointmentReminderSMS(\n          patient.phone,\n          patient.fullName || `${patient.firstName} ${patient.lastName}`,\n          {\n            date: appointment.date.toDateString(),\n            time: appointment.timeSlot,\n            dentist: dentist ? (dentist.fullName || `${dentist.firstName} ${dentist.lastName}`) : 'Assigned dentist',\n            clinic: clinic ? clinic.name : 'Our clinic'\n          }\n        );\n        results.sms = true;\n        logger.info(`SMS reminder sent for appointment ${appointmentId}`);\n      } catch (err: any) {\n        results.errors.push({ type: 'sms', message: err.message });\n        logger.error(`Failed to send SMS reminder for appointment ${appointmentId}: ${err.message}`);\n      }\n    }\n    \n    // Create in-app notification\n    if (channels.inApp) {\n      try {\n        await (Notification as any).create({\n          userId: patient.userId || patient._id,\n          type: 'appointment_reminder',\n          title: 'Appointment Reminder',\n          message: `You have an appointment scheduled for ${appointment.date.toDateString()} at ${appointment.timeSlot}`,\n          appointmentId: appointment._id,\n          read: false\n        });\n        results.inApp = true;\n        logger.info(`In-app notification created for appointment ${appointmentId}`);\n      } catch (err: any) {\n        results.errors.push({ type: 'inApp', message: err.message });\n        logger.error(`Failed to create in-app notification for appointment ${appointmentId}: ${err.message}`);\n      }\n    }\n    \n    return results;\n  } catch (error: any) {\n    logger.error(`Failed to process reminder for appointment ${appointmentId}: ${error.message}`);\n    throw error;\n  }\n});\n\n// Process daily reminder batch jobs\nappointmentReminderQueue.process('daily-batch', async (job) => {\n  const { date, clinicIds } = job.data as DailyReminderBatchJob;\n  \n  try {\n    logger.info(`Processing daily reminder batch for date: ${date}`);\n    \n    const Appointment = mongoose.model('Appointment');\n    const targetDate = new Date(date);\n    \n    // Build query for appointments needing reminders\n    const query: any = {\n      date: {\n        $gte: new Date(targetDate.toDateString()),\n        $lt: new Date(targetDate.getTime() + 24 * 60 * 60 * 1000)\n      },\n      status: { $in: ['scheduled', 'confirmed'] },\n      'notificationPreferences.enabled': true\n    };\n    \n    if (clinicIds && clinicIds.length > 0) {\n      query.clinicId = { $in: clinicIds };\n    }\n    \n    const appointments = await (Appointment as any).find(query);\n    let scheduledCount = 0;\n    let skippedCount = 0;\n    \n    for (const appointment of appointments) {\n      const notificationPreferences = appointment.notificationPreferences || {\n        enabled: true,\n        channels: { email: true, sms: true, inApp: true },\n        reminderTimes: [24]\n      };\n      \n      if (!notificationPreferences.enabled) {\n        skippedCount++;\n        continue;\n      }\n      \n      // Schedule reminders based on reminder times\n      for (const reminderHours of notificationPreferences.reminderTimes) {\n        const appointmentDateTime = new Date(appointment.date);\n        const [hours, minutes] = appointment.timeSlot.split(':').map(Number);\n        appointmentDateTime.setHours(hours, minutes, 0, 0);\n        \n        const reminderTime = new Date(appointmentDateTime.getTime() - reminderHours * 60 * 60 * 1000);\n        const delay = reminderTime.getTime() - Date.now();\n        \n        if (delay > 0) {\n          await appointmentReminderQueue.add(\n            'send-reminder',\n            {\n              appointmentId: appointment._id.toString(),\n              patientId: appointment.patientId.toString(),\n              reminderType: reminderHours === 24 ? '24h' : \n                          reminderHours === 2 ? '2h' : \n                          reminderHours === 0.5 ? '30m' : 'custom',\n              customHours: reminderHours !== 24 && reminderHours !== 2 && reminderHours !== 0.5 ? reminderHours : undefined,\n              channels: notificationPreferences.channels\n            },\n            {\n              delay,\n              removeOnComplete: 10,\n              removeOnFail: 50\n            }\n          );\n          scheduledCount++;\n        }\n      }\n    }\n    \n    logger.info(`Daily batch complete: ${scheduledCount} reminders scheduled, ${skippedCount} skipped`);\n    return {\n      totalAppointments: appointments.length,\n      scheduledReminders: scheduledCount,\n      skippedAppointments: skippedCount\n    };\n  } catch (error: any) {\n    logger.error(`Failed to process daily reminder batch: ${error.message}`);\n    throw error;\n  }\n});\n\n// Schedule appointment reminders using job queue\nexport const scheduleAppointmentReminders = async (appointment: IAppointment, patient?: any, dentist?: any, clinic?: any): Promise<void> => {\n  try {\n    const notificationPreferences = appointment.notificationPreferences;\n    if (!notificationPreferences?.enabled) {\n      return;\n    }\n    \n    const { reminderTimes = [24], channels = { email: true, sms: true, inApp: true } } = notificationPreferences;\n    \n    // Get the appointment date and time\n    const appointmentDateTime = new Date(appointment.date);\n    const [hours, minutes] = appointment.timeSlot.split(':').map(Number);\n    appointmentDateTime.setHours(hours, minutes, 0, 0);\n    \n    // Schedule reminders for each reminder time\n    for (const reminderHours of reminderTimes) {\n      // Calculate when to send the reminder\n      const reminderTime = new Date(appointmentDateTime.getTime() - reminderHours * 60 * 60 * 1000);\n      const delay = reminderTime.getTime() - Date.now();\n      \n      // Only schedule if the reminder time is in the future\n      if (delay > 0) {\n        await appointmentReminderQueue.add(\n          'send-reminder',\n          {\n            appointmentId: appointment._id.toString(),\n            patientId: appointment.patientId.toString(),\n            reminderType: reminderHours === 24 ? '24h' : \n                        reminderHours === 2 ? '2h' : \n                        reminderHours === 0.5 ? '30m' : 'custom',\n            customHours: reminderHours !== 24 && reminderHours !== 2 && reminderHours !== 0.5 ? reminderHours : undefined,\n            channels\n          },\n          {\n            delay,\n            removeOnComplete: 10,\n            removeOnFail: 50,\n            jobId: `reminder-${appointment._id}-${reminderHours}h` // Unique job ID to prevent duplicates\n          }\n        );\n        \n        logger.info(`Scheduled reminder for appointment ${appointment._id} in ${reminderHours} hours`);\n      }\n    }\n  } catch (error: any) {\n    logger.error(`Failed to schedule reminders for appointment ${appointment._id}: ${error.message}`);\n    throw error;\n  }\n};\n\n// Cancel scheduled reminders for an appointment\nexport const cancelAppointmentReminders = async (appointmentId: string): Promise<void> => {\n  try {\n    // Get all jobs and remove those matching the appointment ID\n    const jobs = await appointmentReminderQueue.getJobs(['delayed', 'waiting']);\n    \n    for (const job of jobs) {\n      if (job.data.appointmentId === appointmentId) {\n        await job.remove();\n        logger.info(`Cancelled reminder job ${job.id} for appointment ${appointmentId}`);\n      }\n    }\n  } catch (error: any) {\n    logger.error(`Failed to cancel reminders for appointment ${appointmentId}: ${error.message}`);\n  }\n};\n\n// Schedule daily reminder batch processing\nexport const scheduleDailyReminderBatch = async (targetDate?: Date, clinicIds?: string[]): Promise<void> => {\n  try {\n    const date = targetDate || new Date();\n    date.setDate(date.getDate() + 1); // Process reminders for next day\n    \n    await appointmentReminderQueue.add(\n      'daily-batch',\n      {\n        date: date.toISOString(),\n        clinicIds\n      },\n      {\n        removeOnComplete: 5,\n        removeOnFail: 10,\n        jobId: `daily-batch-${date.toISOString().split('T')[0]}` // One batch per day\n      }\n    );\n    \n    logger.info(`Scheduled daily reminder batch for ${date.toDateString()}`);\n  } catch (error: any) {\n    logger.error(`Failed to schedule daily reminder batch: ${error.message}`);\n  }\n};\n\n// Get queue status and statistics\nexport const getQueueStats = async () => {\n  try {\n    const [waiting, active, completed, failed, delayed] = await Promise.all([\n      appointmentReminderQueue.getJobs(['waiting'], 0, -1),\n      appointmentReminderQueue.getJobs(['active'], 0, -1),\n      appointmentReminderQueue.getJobs(['completed'], 0, -1),\n      appointmentReminderQueue.getJobs(['failed'], 0, -1),\n      appointmentReminderQueue.getJobs(['delayed'], 0, -1),\n    ]);\n    \n    return {\n      waiting: waiting.length,\n      active: active.length,\n      completed: completed.length,\n      failed: failed.length,\n      delayed: delayed.length,\n      total: waiting.length + active.length + completed.length + failed.length + delayed.length\n    };\n  } catch (error: any) {\n    logger.error(`Failed to get queue stats: ${error.message}`);\n    return null;\n  }\n};\n\n// Initialize queue monitoring\nappointmentReminderQueue.on('completed', (job, result) => {\n  logger.info(`Job ${job.id} completed with result:`, result);\n});\n\nappointmentReminderQueue.on('failed', (job, err) => {\n  logger.error(`Job ${job.id} failed:`, err.message);\n});\n\nappointmentReminderQueue.on('stalled', (job) => {\n  logger.warn(`Job ${job.id} stalled`);\n});\n\nexport default appointmentReminderQueue;\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\linkPatientsToUsers.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mongoose' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IPatient' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IUser' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[794,797],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[794,797],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2890,2893],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2890,2893],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4801,4804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4801,4804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4869,4872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4869,4872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5117,5120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5117,5120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6247,6250],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6247,6250],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from 'mongoose';\nimport Patient from '../models/Patient';\nimport User from '../models/User';\nimport { IPatient, IUser } from '../types';\n\n/**\n * Migration utility to link existing patients to user accounts\n * This script matches patients to users based on email addresses\n */\n\nexport interface LinkingResult {\n  totalPatients: number;\n  linkedPatients: number;\n  unlinkedPatients: number;\n  errors: string[];\n}\n\n/**\n * Link patients to users based on matching email addresses\n */\nexport const linkPatientsByEmail = async (): Promise<LinkingResult> => {\n  const result: LinkingResult = {\n    totalPatients: 0,\n    linkedPatients: 0,\n    unlinkedPatients: 0,\n    errors: []\n  };\n\n  try {\n    // Get all patients that don't have a userId yet\n    const patients = await (Patient as any).find({ \n      userId: { $exists: false },\n      email: { $exists: true, $ne: null, $and: [{ $ne: '' }] }\n    });\n\n    result.totalPatients = patients.length;\n    console.log(`Found ${patients.length} patients without linked user accounts`);\n\n    for (const patient of patients) {\n      try {\n        if (!patient.email) continue;\n\n        // Find user with matching email\n        const user = await User.findOne({ \n          email: patient.email.toLowerCase(),\n          role: 'patient'\n        });\n\n        if (user) {\n          // Link patient to user\n          patient.userId = user._id;\n          await patient.save();\n          result.linkedPatients++;\n          console.log(`Linked patient ${patient.firstName} ${patient.lastName} to user ${user.email}`);\n        } else {\n          result.unlinkedPatients++;\n          console.log(`No matching user found for patient ${patient.firstName} ${patient.lastName} (${patient.email})`);\n        }\n      } catch (error) {\n        const errorMsg = `Error linking patient ${patient._id}: ${error instanceof Error ? error.message : 'Unknown error'}`;\n        result.errors.push(errorMsg);\n        console.error(errorMsg);\n      }\n    }\n\n    console.log('\\nLinking Summary:');\n    console.log(`Total patients processed: ${result.totalPatients}`);\n    console.log(`Successfully linked: ${result.linkedPatients}`);\n    console.log(`Unlinked (no matching user): ${result.unlinkedPatients}`);\n    console.log(`Errors: ${result.errors.length}`);\n\n    return result;\n  } catch (error) {\n    const errorMsg = `Fatal error during linking process: ${error instanceof Error ? error.message : 'Unknown error'}`;\n    result.errors.push(errorMsg);\n    console.error(errorMsg);\n    return result;\n  }\n};\n\n/**\n * Link patients to users based on phone numbers\n */\nexport const linkPatientsByPhone = async (): Promise<LinkingResult> => {\n  const result: LinkingResult = {\n    totalPatients: 0,\n    linkedPatients: 0,\n    unlinkedPatients: 0,\n    errors: []\n  };\n\n  try {\n    // Get all patients that don't have a userId yet\n    const patients = await (Patient as any).find({ \n      userId: { $exists: false },\n      phone: { $exists: true, $ne: null, $and: [{ $ne: '' }] }\n    });\n\n    result.totalPatients = patients.length;\n    console.log(`Found ${patients.length} patients without linked user accounts (phone matching)`);\n\n    for (const patient of patients) {\n      try {\n        if (!patient.phone) continue;\n\n        // Find user with matching phone\n        const user = await User.findOne({ \n          phone: patient.phone,\n          role: 'patient'\n        });\n\n        if (user) {\n          // Link patient to user\n          patient.userId = user._id;\n          await patient.save();\n          result.linkedPatients++;\n          console.log(`Linked patient ${patient.firstName} ${patient.lastName} to user ${user.phone}`);\n        } else {\n          result.unlinkedPatients++;\n          console.log(`No matching user found for patient ${patient.firstName} ${patient.lastName} (${patient.phone})`);\n        }\n      } catch (error) {\n        const errorMsg = `Error linking patient ${patient._id}: ${error instanceof Error ? error.message : 'Unknown error'}`;\n        result.errors.push(errorMsg);\n        console.error(errorMsg);\n      }\n    }\n\n    console.log('\\nPhone Linking Summary:');\n    console.log(`Total patients processed: ${result.totalPatients}`);\n    console.log(`Successfully linked: ${result.linkedPatients}`);\n    console.log(`Unlinked (no matching user): ${result.unlinkedPatients}`);\n    console.log(`Errors: ${result.errors.length}`);\n\n    return result;\n  } catch (error) {\n    const errorMsg = `Fatal error during phone linking process: ${error instanceof Error ? error.message : 'Unknown error'}`;\n    result.errors.push(errorMsg);\n    console.error(errorMsg);\n    return result;\n  }\n};\n\n/**\n * Get statistics about patient-user linking\n */\nexport const getLinkingStatistics = async () => {\n  try {\n    const totalPatients = await (Patient as any).countDocuments();\n    const linkedPatients = await (Patient as any).countDocuments({ userId: { $exists: true, $ne: null } });\n    const unlinkedPatients = totalPatients - linkedPatients;\n    \n    const totalUsers = await User.countDocuments({ role: 'patient' });\n    const usersWithPatients = await (Patient as any).distinct('userId').then(userIds => userIds.filter(id => id).length);\n    const usersWithoutPatients = totalUsers - usersWithPatients;\n\n    return {\n      patients: {\n        total: totalPatients,\n        linked: linkedPatients,\n        unlinked: unlinkedPatients,\n        linkingPercentage: totalPatients > 0 ? ((linkedPatients / totalPatients) * 100).toFixed(2) : '0'\n      },\n      users: {\n        total: totalUsers,\n        withPatients: usersWithPatients,\n        withoutPatients: usersWithoutPatients\n      }\n    };\n  } catch (error) {\n    console.error('Error getting linking statistics:', error);\n    throw error;\n  }\n};\n\n/**\n * Create user accounts for patients that don't have linked users\n * This is useful for migrating existing patient data\n */\nexport const createUsersForUnlinkedPatients = async (defaultPassword: string = 'TempPassword123!'): Promise<LinkingResult> => {\n  const result: LinkingResult = {\n    totalPatients: 0,\n    linkedPatients: 0,\n    unlinkedPatients: 0,\n    errors: []\n  };\n\n  try {\n    // Get all patients that don't have a userId and have an email\n    const patients = await (Patient as any).find({ \n      userId: { $exists: false },\n      email: { $exists: true, $ne: null, $and: [{ $ne: '' }] }\n    });\n\n    result.totalPatients = patients.length;\n    console.log(`Found ${patients.length} patients without linked user accounts`);\n\n    for (const patient of patients) {\n      try {\n        if (!patient.email) continue;\n\n        // Check if user already exists\n        const existingUser = await User.findOne({ email: patient.email.toLowerCase() });\n        if (existingUser) {\n          // Link to existing user\n          patient.userId = existingUser._id;\n          await patient.save();\n          result.linkedPatients++;\n          console.log(`Linked patient ${patient.firstName} ${patient.lastName} to existing user ${existingUser.email}`);\n          continue;\n        }\n\n        // Create new user account\n        const newUser = new User({\n          firstName: patient.firstName,\n          lastName: patient.lastName,\n          email: patient.email.toLowerCase(),\n          password: defaultPassword,\n          role: 'patient',\n          phone: patient.phone,\n          dateOfBirth: patient.dateOfBirth,\n          gender: patient.gender,\n          address: patient.address,\n          isActive: true\n        });\n\n        await newUser.save();\n\n        // Link patient to new user\n        patient.userId = newUser._id;\n        await patient.save();\n        \n        result.linkedPatients++;\n        console.log(`Created user and linked patient ${patient.firstName} ${patient.lastName} (${patient.email})`);\n      } catch (error) {\n        const errorMsg = `Error creating user for patient ${patient._id}: ${error instanceof Error ? error.message : 'Unknown error'}`;\n        result.errors.push(errorMsg);\n        console.error(errorMsg);\n      }\n    }\n\n    console.log('\\nUser Creation Summary:');\n    console.log(`Total patients processed: ${result.totalPatients}`);\n    console.log(`Successfully linked: ${result.linkedPatients}`);\n    console.log(`Errors: ${result.errors.length}`);\n\n    return result;\n  } catch (error) {\n    const errorMsg = `Fatal error during user creation process: ${error instanceof Error ? error.message : 'Unknown error'}`;\n    result.errors.push(errorMsg);\n    console.error(errorMsg);\n    return result;\n  }\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\logger.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[540,543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[540,543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[904,907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[904,907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1113,1116],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1113,1116],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":55,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1323,1326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1323,1326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1875,1878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1875,1878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":125,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3442,3445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3442,3445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Simple logger utility for the application\r\n// In production, consider using a more robust logging library like Winston\r\n\r\ninterface LogLevel {\r\n  INFO: 'info';\r\n  WARN: 'warn';\r\n  ERROR: 'error';\r\n  DEBUG: 'debug';\r\n}\r\n\r\nconst LOG_LEVEL: LogLevel = {\r\n  INFO: 'info',\r\n  WARN: 'warn',\r\n  ERROR: 'error',\r\n  DEBUG: 'debug'\r\n};\r\n\r\nclass Logger {\r\n  private isDevelopment: boolean;\r\n\r\n  constructor() {\r\n    this.isDevelopment = process.env.NODE_ENV === 'development';\r\n  }\r\n\r\n  private formatMessage(level: string, message: string, meta?: any): string {\r\n    const timestamp = new Date().toISOString();\r\n    const baseMessage = `[${timestamp}] [${level.toUpperCase()}] ${message}`;\r\n    \r\n    if (meta && typeof meta === 'object') {\r\n      return `${baseMessage} ${JSON.stringify(meta)}`;\r\n    }\r\n    \r\n    return baseMessage;\r\n  }\r\n\r\n  /**\r\n   * Log info message\r\n   */\r\n  info(message: string, meta?: any): void {\r\n    const formattedMessage = this.formatMessage(LOG_LEVEL.INFO, message, meta);\r\n    console.log(formattedMessage);\r\n  }\r\n\r\n  /**\r\n   * Log warning message\r\n   */\r\n  warn(message: string, meta?: any): void {\r\n    const formattedMessage = this.formatMessage(LOG_LEVEL.WARN, message, meta);\r\n    console.warn(formattedMessage);\r\n  }\r\n\r\n  /**\r\n   * Log error message\r\n   */\r\n  error(message: string, error?: any): void {\r\n    const formattedMessage = this.formatMessage(LOG_LEVEL.ERROR, message);\r\n    console.error(formattedMessage);\r\n    \r\n    if (error) {\r\n      if (error instanceof Error) {\r\n        console.error('Error details:', {\r\n          name: error.name,\r\n          message: error.message,\r\n          stack: this.isDevelopment ? error.stack : undefined\r\n        });\r\n      } else {\r\n        console.error('Error details:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log debug message (only in development)\r\n   */\r\n  debug(message: string, meta?: any): void {\r\n    if (this.isDevelopment) {\r\n      const formattedMessage = this.formatMessage(LOG_LEVEL.DEBUG, message, meta);\r\n      console.debug(formattedMessage);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log HTTP request details\r\n   */\r\n  request(method: string, url: string, statusCode: number, responseTime?: number): void {\r\n    const message = `${method} ${url} ${statusCode}${responseTime ? ` - ${responseTime}ms` : ''}`;\r\n    this.info(message);\r\n  }\r\n\r\n  /**\r\n   * Log database operations\r\n   */\r\n  database(operation: string, collection?: string, duration?: number): void {\r\n    const message = `DB ${operation}${collection ? ` on ${collection}` : ''}${duration ? ` - ${duration}ms` : ''}`;\r\n    this.debug(message);\r\n  }\r\n\r\n  /**\r\n   * Log authentication events\r\n   */\r\n  auth(event: string, userId?: string, email?: string): void {\r\n    const message = `Auth: ${event}${userId ? ` - User: ${userId}` : ''}${email ? ` - Email: ${email}` : ''}`;\r\n    this.info(message);\r\n  }\r\n\r\n  /**\r\n   * Log appointment events\r\n   */\r\n  appointment(event: string, appointmentId: string, patientId?: string): void {\r\n    const message = `Appointment: ${event} - ID: ${appointmentId}${patientId ? ` - Patient: ${patientId}` : ''}`;\r\n    this.info(message);\r\n  }\r\n\r\n  /**\r\n   * Log notification events\r\n   */\r\n  notification(event: string, type: string, userId?: string): void {\r\n    const message = `Notification: ${event} - Type: ${type}${userId ? ` - User: ${userId}` : ''}`;\r\n    this.info(message);\r\n  }\r\n\r\n  /**\r\n   * Log system events\r\n   */\r\n  system(event: string, details?: any): void {\r\n    const message = `System: ${event}`;\r\n    this.info(message, details);\r\n  }\r\n}\r\n\r\n// Create and export a singleton instance\r\nconst logger = new Logger();\r\n\r\nexport default logger;\r\n\r\n// Also export the logger class for custom instances if needed\r\nexport { Logger };\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\notificationHelpers.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[454,457],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[454,457],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[596,599],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[596,599],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[701,704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[701,704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1635,1638],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1635,1638],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":61,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1850,1853],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1850,1853],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2782,2785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2782,2785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3523,3526],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3523,3526],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4096,4099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4096,4099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":155,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4750,4753],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4750,4753],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5261,5264],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5261,5264],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Notification } from '../models';\n\n/**\n * Helper functions for creating and sending notifications\n */\n\nexport interface NotificationData {\n  userId: string;\n  title: string;\n  message: string;\n  type?: 'general' | 'appointment_reminder' | 'appointment_confirmation' | 'appointment_cancellation' | 'system' | 'inventory_alert' | 'low_stock' | 'payment_success' | 'payment_failed' | 'insurance_update';\n  link?: string;\n  metadata?: Record<string, any>;\n}\n\n/**\n * Create and send a notification to a user\n */\nexport const createAndSendNotification = async (data: NotificationData): Promise<any> => {\n  try {\n    // Create notification in database\n    const notification = await (Notification as any).createNotification(data);\n\n    // Send real-time notification if WebSocket service is available\n    if (global.webSocketService) {\n      const sent = global.webSocketService.sendNotification(data.userId, {\n        id: notification._id,\n        title: notification.title,\n        message: notification.message,\n        type: notification.type,\n        link: notification.link,\n        metadata: data.metadata,\n        createdAt: notification.createdAt\n      });\n      \n      console.log(`Real-time notification ${sent ? 'sent' : 'queued'} for user ${data.userId}`);\n    }\n\n    return notification;\n  } catch (error) {\n    console.error('Error creating and sending notification:', error);\n    throw error;\n  }\n};\n\n/**\n * Create and send bulk notifications\n */\nexport const createAndSendBulkNotifications = async (\n  userIds: string[],\n  notificationData: Omit<NotificationData, 'userId'>\n): Promise<{ count: number; notifications: any[] }> => {\n  try {\n    const notifications = userIds.map(userId => ({\n      userId,\n      ...notificationData,\n      isRead: false,\n      createdAt: new Date()\n    }));\n\n    const result = await (Notification as any).insertMany(notifications);\n\n    // Send real-time notifications if WebSocket service is available\n    if (global.webSocketService) {\n      const realtimeData = {\n        title: notificationData.title,\n        message: notificationData.message,\n        type: notificationData.type,\n        link: notificationData.link,\n        metadata: notificationData.metadata,\n        createdAt: new Date()\n      };\n      \n      const sentCount = global.webSocketService.sendBulkNotifications(userIds, realtimeData);\n      console.log(`Real-time notifications sent to ${sentCount}/${userIds.length} connected users`);\n    }\n\n    return { count: result.length, notifications: result };\n  } catch (error) {\n    console.error('Error creating and sending bulk notifications:', error);\n    throw error;\n  }\n};\n\n/**\n * Send appointment reminder notifications\n */\nexport const sendAppointmentReminder = async (\n  userId: string,\n  appointmentData: any\n): Promise<void> => {\n  const notificationData: NotificationData = {\n    userId,\n    title: 'Appointment Reminder',\n    message: `You have an appointment scheduled for ${appointmentData.date} at ${appointmentData.time}`,\n    type: 'appointment_reminder',\n    link: `/appointments/${appointmentData.id}`,\n    metadata: { appointmentId: appointmentData.id }\n  };\n\n  await createAndSendNotification(notificationData);\n\n  // Also send real-time appointment reminder if available\n  if (global.webSocketService) {\n    global.webSocketService.sendAppointmentReminder(userId, appointmentData);\n  }\n};\n\n/**\n * Send appointment confirmation notifications\n */\nexport const sendAppointmentConfirmation = async (\n  userId: string,\n  appointmentData: any\n): Promise<void> => {\n  const notificationData: NotificationData = {\n    userId,\n    title: 'Appointment Confirmed',\n    message: `Your appointment has been confirmed for ${appointmentData.date} at ${appointmentData.time}`,\n    type: 'appointment_confirmation',\n    link: `/appointments/${appointmentData.id}`,\n    metadata: { appointmentId: appointmentData.id }\n  };\n\n  await createAndSendNotification(notificationData);\n};\n\n/**\n * Send appointment cancellation notifications\n */\nexport const sendAppointmentCancellation = async (\n  userId: string,\n  appointmentData: any,\n  reason?: string\n): Promise<void> => {\n  const notificationData: NotificationData = {\n    userId,\n    title: 'Appointment Cancelled',\n    message: `Your appointment scheduled for ${appointmentData.date} at ${appointmentData.time} has been cancelled${reason ? `: ${reason}` : ''}`,\n    type: 'appointment_cancellation',\n    link: `/appointments`,\n    metadata: { appointmentId: appointmentData.id, reason }\n  };\n\n  await createAndSendNotification(notificationData);\n};\n\n/**\n * Send inventory alerts\n */\nexport const sendInventoryAlert = async (\n  clinicId: string,\n  alertData: {\n    type: 'low_stock' | 'out_of_stock' | 'expiring_soon';\n    items: any[];\n    message: string;\n  }\n): Promise<void> => {\n  // Send to clinic staff and admins\n  if (global.webSocketService) {\n    global.webSocketService.sendToClinic(clinicId, 'inventory-alert', alertData);\n  }\n\n  // Also create database notifications for clinic staff\n  // This would require getting all staff members for the clinic\n  // Implementation depends on your user-clinic relationship structure\n};\n\n/**\n * Send low stock alerts\n */\nexport const sendLowStockAlert = async (\n  clinicId: string,\n  items: any[]\n): Promise<void> => {\n  const alertData = {\n    type: 'low_stock' as const,\n    items,\n    message: `${items.length} item(s) are running low in stock`\n  };\n\n  await sendInventoryAlert(clinicId, alertData);\n};\n\n/**\n * Send system announcements\n */\nexport const sendSystemAnnouncement = async (\n  title: string,\n  message: string,\n  targetRole?: string,\n  clinicId?: string\n): Promise<void> => {\n  if (global.webSocketService) {\n    const announcementData = {\n      title,\n      message,\n      type: 'system',\n      createdAt: new Date()\n    };\n\n    if (targetRole) {\n      global.webSocketService.sendToRole(targetRole, 'system-announcement', announcementData);\n    } else if (clinicId) {\n      global.webSocketService.sendToClinic(clinicId, 'system-announcement', announcementData);\n    } else {\n      global.webSocketService.sendSystemAnnouncement(announcementData);\n    }\n  }\n};\n\n/**\n * Send payment notifications\n */\nexport const sendPaymentNotification = async (\n  userId: string,\n  paymentData: {\n    status: 'success' | 'failed' | 'pending';\n    amount: number;\n    invoiceNumber: string;\n  }\n): Promise<void> => {\n  const { status, amount, invoiceNumber } = paymentData;\n  \n  const notificationData: NotificationData = {\n    userId,\n    title: status === 'success' ? 'Payment Successful' : status === 'failed' ? 'Payment Failed' : 'Payment Pending',\n    message: status === 'success' \n      ? `Your payment of $${amount} for invoice ${invoiceNumber} was processed successfully`\n      : status === 'failed'\n      ? `Your payment of $${amount} for invoice ${invoiceNumber} failed. Please try again`\n      : `Your payment of $${amount} for invoice ${invoiceNumber} is being processed`,\n    type: status === 'success' ? 'payment_success' : 'payment_failed',\n    link: `/billing/invoices/${invoiceNumber}`,\n    metadata: { amount, invoiceNumber, status }\n  };\n\n  await createAndSendNotification(notificationData);\n};\n\nexport default {\n  createAndSendNotification,\n  createAndSendBulkNotifications,\n  sendAppointmentReminder,\n  sendAppointmentConfirmation,\n  sendAppointmentCancellation,\n  sendInventoryAlert,\n  sendLowStockAlert,\n  sendSystemAnnouncement,\n  sendPaymentNotification\n};\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\scheduler.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[666,669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[666,669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[681,684],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[681,684],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":118,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":121,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[695,698],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[695,698],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3182,3185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3182,3185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4068,4071],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4068,4071],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4235,4238],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4235,4238],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":93,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4823,4826],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4823,4826],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5563,5566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5563,5566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6264,6267],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6264,6267],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from 'mongoose';\nimport { IAppointment } from '../types';\nimport { sendAppointmentReminderEmail } from './email';\nimport { sendAppointmentReminderSMS } from './sms';\nimport logger from './logger';\n\n// In-memory storage for scheduled reminders\n// In a production environment, this should be replaced with a persistent job queue like Bull or Agenda\nconst scheduledReminders: Map<string, NodeJS.Timeout> = new Map();\n\n/**\n * Schedule reminders for an appointment based on notification preferences\n * @param appointment The appointment to schedule reminders for\n */\nexport const scheduleAppointmentReminders = async (appointment: IAppointment, patient?: any, dentist?: any, clinic?: any): Promise<void> => {\n  try {\n    // Check if notification preferences exist and are enabled\n    const notificationPreferences = appointment.notificationPreferences;\n    if (!notificationPreferences?.enabled) {\n      return;\n    }\n\n    const { reminderTimes = [24], channels = { email: true, sms: true, inApp: true } } = notificationPreferences;\n    \n    // Get the appointment date and time\n    const appointmentDateTime = new Date(appointment.date);\n    const [hours, minutes] = appointment.timeSlot.split(':').map(Number);\n    appointmentDateTime.setHours(hours, minutes, 0, 0);\n    \n    // Schedule reminders for each reminder time\n    for (const reminderHours of reminderTimes) {\n      // Calculate when to send the reminder\n      const reminderTime = new Date(appointmentDateTime.getTime() - reminderHours * 60 * 60 * 1000);\n      const now = new Date();\n      \n      // Only schedule if the reminder time is in the future\n      if (reminderTime > now) {\n        const timeoutId = setTimeout(async () => {\n          try {\n            // Send reminders based on enabled channels\n            const notificationPromises = [];\n            \n            // We need to fetch the patient, dentist, and clinic data for the reminder\n            try {\n              // In a real implementation, we would fetch these from the database\n              // For now, we'll use the data passed to the function if available\n              const patientData = patient || await mongoose.model('Patient').findById(appointment.patientId);\n              const dentistData = dentist || await mongoose.model('User').findById(appointment.dentistId);\n              const clinicData = clinic || await mongoose.model('Clinic').findById(appointment.clinicId);\n              \n              // Send email reminder if enabled\n              if (channels.email && patientData.email) {\n                notificationPromises.push(\n                  sendAppointmentReminderEmail(\n                    patientData.email,\n                    patientData.fullName || `${patientData.firstName} ${patientData.lastName}`,\n                    {\n                      date: appointment.date.toDateString(),\n                      time: appointment.timeSlot,\n                      dentist: dentistData ? (dentistData.fullName || `${dentistData.firstName} ${dentistData.lastName}`) : 'Assigned dentist',\n                      clinic: clinicData ? clinicData.name : 'Our clinic'\n                    }\n                  ).catch((err: any) => logger.error(`Failed to send reminder email for appointment ${appointment._id}: ${err.message}`))\n                );\n              }\n              \n              // Send SMS reminder if enabled\n              if (channels.sms && patientData.phone) {\n                notificationPromises.push(\n                  sendAppointmentReminderSMS(\n                    patientData.phone,\n                    patientData.fullName || `${patientData.firstName} ${patientData.lastName}`,\n                    {\n                      date: appointment.date.toDateString(),\n                      time: appointment.timeSlot,\n                      dentist: dentistData ? (dentistData.fullName || `${dentistData.firstName} ${dentistData.lastName}`) : 'Assigned dentist',\n                      clinic: clinicData ? clinicData.name : 'Our clinic'\n                    }\n                  ).catch((err: any) => logger.error(`Failed to send reminder SMS for appointment ${appointment._id}: ${err.message}`))\n                );\n              }\n            } catch (error: any) {\n              logger.error(`Failed to fetch data for appointment reminder ${appointment._id}: ${error?.message || 'Unknown error'}`);\n            }\n            \n            // Wait for all notifications to be sent\n            await Promise.allSettled(notificationPromises);\n            \n            // Remove the scheduled reminder from the map\n            scheduledReminders.delete(getReminderKey(appointment._id.toString(), reminderHours));\n            \n            logger.info(`Sent ${reminderHours}-hour reminder for appointment ${appointment._id}`);\n          } catch (error: any) {\n            logger.error(`Error processing reminder for appointment ${appointment._id}: ${error?.message || 'Unknown error'}`);\n          }\n        }, reminderTime.getTime() - now.getTime());\n        \n        // Store the timeout ID for potential cancellation\n        const reminderKey = getReminderKey(appointment._id.toString(), reminderHours);\n        scheduledReminders.set(reminderKey, timeoutId);\n        \n        logger.info(`Scheduled ${reminderHours}-hour reminder for appointment ${appointment._id} at ${reminderTime.toISOString()}`);\n      } else {\n        logger.info(`Skipped scheduling ${reminderHours}-hour reminder for appointment ${appointment._id} as the reminder time has passed`);\n      }\n    }\n  } catch (error: any) {\n    logger.error(`Failed to schedule reminders for appointment ${appointment._id}: ${error?.message || 'Unknown error'}`);\n  }\n};\n\n/**\n * Cancel all scheduled reminders for an appointment\n * @param appointmentId The ID of the appointment\n */\nexport const cancelAppointmentReminders = (appointmentId: string): void => {\n  try {\n    // Find all reminders for this appointment and clear them\n    for (const [key, timeoutId] of scheduledReminders.entries()) {\n      if (key.startsWith(`${appointmentId}::`)) {\n        clearTimeout(timeoutId);\n        scheduledReminders.delete(key);\n        logger.info(`Cancelled reminder ${key} for appointment ${appointmentId}`);\n      }\n    }\n  } catch (error: any) {\n    logger.error(`Failed to cancel reminders for appointment ${appointmentId}: ${error?.message || 'Unknown error'}`);\n  }\n};\n\n/**\n * Generate a unique key for storing reminder timeouts\n * @param appointmentId The appointment ID\n * @param reminderHours Hours before the appointment to send the reminder\n * @returns A unique key string\n */\nconst getReminderKey = (appointmentId: string, reminderHours: number): string => {\n  return `${appointmentId}::${reminderHours}`;\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\sms.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1967,1970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1967,1970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * SMS Service with Twilio Integration\r\n * \r\n * Provides SMS functionality for appointment notifications, reminders, and alerts.\r\n * Supports customizable templates and graceful fallback when Twilio is not configured.\r\n */\r\n\r\nimport twilio from 'twilio';\r\n\r\ninterface SMSData {\r\n  date: string;\r\n  time: string;\r\n  dentist?: string;\r\n  clinic?: string;\r\n  service?: string;\r\n  duration?: string;\r\n  notes?: string;\r\n  contactPhone?: string;\r\n  reason?: string;\r\n}\r\n\r\n// Twilio configuration\r\nconst TWILIO_ACCOUNT_SID = process.env.TWILIO_ACCOUNT_SID || '';\r\nconst TWILIO_AUTH_TOKEN = process.env.TWILIO_AUTH_TOKEN || '';\r\nconst TWILIO_PHONE_NUMBER = process.env.TWILIO_PHONE_NUMBER || '';\r\nconst TWILIO_ENABLED = !!(TWILIO_ACCOUNT_SID && TWILIO_AUTH_TOKEN && TWILIO_PHONE_NUMBER);\r\n\r\n// Initialize Twilio client if credentials are provided\r\nlet twilioClient: ReturnType<typeof twilio> | null = null;\r\nif (TWILIO_ENABLED) {\r\n  try {\r\n    twilioClient = twilio(TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN);\r\n    console.log('[SMS] Twilio client initialized successfully');\r\n  } catch (error) {\r\n    console.error('[SMS] Failed to initialize Twilio client:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Core SMS sending function with Twilio\r\n */\r\nconst sendSMS = async (to: string, message: string): Promise<boolean> => {\r\n  const formattedPhone = formatPhoneNumber(to);\r\n  \r\n  if (!validatePhoneNumber(formattedPhone)) {\r\n    console.error(`[SMS] Invalid phone number: ${to}`);\r\n    return false;\r\n  }\r\n\r\n  if (!TWILIO_ENABLED || !twilioClient) {\r\n    console.log(`[SMS] Twilio not configured. Would send to ${formattedPhone}: ${message}`);\r\n    return true; // Return true in development mode\r\n  }\r\n\r\n  try {\r\n    const result = await twilioClient.messages.create({\r\n      body: message,\r\n      from: TWILIO_PHONE_NUMBER,\r\n      to: formattedPhone\r\n    });\r\n    \r\n    console.log(`[SMS] Sent successfully to ${formattedPhone}. SID: ${result.sid}`);\r\n    return true;\r\n  } catch (error: any) {\r\n    console.error(`[SMS] Failed to send to ${formattedPhone}:`, error.message);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Send appointment confirmation SMS\r\n * @param phoneNumber Patient's phone number\r\n * @param patientName Patient's name\r\n * @param appointmentData Appointment details\r\n */\r\nexport const sendAppointmentConfirmationSMS = async (\r\n  phoneNumber: string,\r\n  patientName: string,\r\n  appointmentData: SMSData\r\n): Promise<void> => {\r\n  try {\r\n    const message = `Hi ${patientName}, your appointment is confirmed for ${appointmentData.date} at ${appointmentData.time}${appointmentData.dentist ? ` with ${appointmentData.dentist}` : ''}. Contact: ${appointmentData.contactPhone || 'clinic'}`;\r\n    \r\n    await sendSMS(phoneNumber, message);\r\n  } catch (error) {\r\n    console.error('Failed to send confirmation SMS:', error);\r\n    throw new Error(`Failed to send SMS to ${phoneNumber}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Send appointment reminder SMS with customizable template\r\n * @param phoneNumber Patient's phone number\r\n * @param patientName Patient's name\r\n * @param appointmentData Appointment details\r\n * @param reminderType Type of reminder (24h, 1h, 15min)\r\n */\r\nexport const sendAppointmentReminderSMS = async (\r\n  phoneNumber: string,\r\n  patientName: string,\r\n  appointmentData: SMSData,\r\n  reminderType?: '24h' | '1h' | '15min'\r\n): Promise<void> => {\r\n  try {\r\n    let message = '';\r\n    \r\n    switch (reminderType) {\r\n      case '24h':\r\n        message = `Reminder: ${patientName}, you have an appointment TOMORROW at ${appointmentData.time}${appointmentData.dentist ? ` with ${appointmentData.dentist}` : ''}${appointmentData.clinic ? ` at ${appointmentData.clinic}` : ''}. Reply CONFIRM or call ${appointmentData.contactPhone || 'clinic'}.`;\r\n        break;\r\n      case '1h':\r\n        message = `Reminder: ${patientName}, your appointment is in 1 HOUR at ${appointmentData.time}${appointmentData.dentist ? ` with ${appointmentData.dentist}` : ''}${appointmentData.clinic ? ` at ${appointmentData.clinic}` : ''}.`;\r\n        break;\r\n      case '15min':\r\n        message = `Reminder: ${patientName}, your appointment is in 15 MINUTES at ${appointmentData.time}${appointmentData.dentist ? ` with ${appointmentData.dentist}` : ''}. Please check in at reception.`;\r\n        break;\r\n      default:\r\n        message = `Reminder: ${patientName}, you have an appointment on ${appointmentData.date} at ${appointmentData.time}${appointmentData.dentist ? ` with ${appointmentData.dentist}` : ''}. Contact: ${appointmentData.contactPhone || 'clinic'}`;\r\n    }\r\n    \r\n    await sendSMS(phoneNumber, message);\r\n  } catch (error) {\r\n    console.error('Failed to send reminder SMS:', error);\r\n    throw new Error(`Failed to send reminder SMS to ${phoneNumber}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Send appointment cancellation SMS\r\n * @param phoneNumber Patient's phone number\r\n * @param patientName Patient's name\r\n * @param appointmentData Appointment details\r\n */\r\nexport const sendAppointmentCancellationSMS = async (\r\n  phoneNumber: string,\r\n  patientName: string,\r\n  appointmentData: SMSData\r\n): Promise<void> => {\r\n  try {\r\n    const message = `${patientName}, your appointment for ${appointmentData.date} at ${appointmentData.time} has been cancelled${appointmentData.reason ? `: ${appointmentData.reason}` : ''}. Please call ${appointmentData.contactPhone || 'clinic'} to reschedule.`;\r\n    \r\n    await sendSMS(phoneNumber, message);\r\n  } catch (error) {\r\n    console.error('Failed to send cancellation SMS:', error);\r\n    throw new Error(`Failed to send cancellation SMS to ${phoneNumber}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Send urgent appointment notification SMS to staff\r\n * @param phoneNumber Staff member's phone number\r\n * @param staffName Staff member's name\r\n * @param appointmentData Appointment details\r\n */\r\nexport const sendUrgentAppointmentSMS = async (\r\n  phoneNumber: string,\r\n  staffName: string,\r\n  appointmentData: SMSData\r\n): Promise<void> => {\r\n  try {\r\n    const message = `Urgent: ${staffName}, emergency appointment scheduled for ${appointmentData.date} at ${appointmentData.time}. Please check your schedule immediately.`;\r\n    \r\n    await sendSMS(phoneNumber, message);\r\n  } catch (error) {\r\n    console.error('Failed to send urgent SMS:', error);\r\n    throw new Error(`Failed to send urgent SMS to ${phoneNumber}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Send custom SMS message\r\n * @param phoneNumber Recipient's phone number\r\n * @param message Custom message content\r\n */\r\nexport const sendCustomSMS = async (phoneNumber: string, message: string): Promise<boolean> => {\r\n  try {\r\n    return await sendSMS(phoneNumber, message);\r\n  } catch (error) {\r\n    console.error('Failed to send custom SMS:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Check if Twilio is enabled and configured\r\n */\r\nexport const isTwilioEnabled = (): boolean => {\r\n  return TWILIO_ENABLED;\r\n};\r\n\r\n/**\r\n * Validate phone number format\r\n * @param phoneNumber Phone number to validate\r\n * @returns boolean indicating if phone number is valid\r\n */\r\nexport const validatePhoneNumber = (phoneNumber: string): boolean => {\r\n  // Basic phone number validation - can be enhanced based on requirements\r\n  const phoneRegex = /^[\\+]?[1-9][\\d]{0,15}$/;\r\n  return phoneRegex.test(phoneNumber.replace(/\\D/g, ''));\r\n};\r\n\r\n/**\r\n * Format phone number for SMS service\r\n * @param phoneNumber Raw phone number\r\n * @returns Formatted phone number\r\n */\r\nexport const formatPhoneNumber = (phoneNumber: string): string => {\r\n  const cleaned = phoneNumber.replace(/\\D/g, '');\r\n  \r\n  // Add country code if not present (assuming US numbers)\r\n  if (cleaned.length === 10) {\r\n    return `+1${cleaned}`;\r\n  }\r\n  \r\n  if (cleaned.length === 11 && cleaned.startsWith('1')) {\r\n    return `+${cleaned}`;\r\n  }\r\n  \r\n  return phoneNumber; // Return as-is if already formatted or international\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\upload.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1417,1420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1417,1420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":92,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":168,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":168,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":331,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":331,"endColumn":17}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { v2 as cloudinary } from 'cloudinary';\nimport multer from 'multer';\nimport { Request as _Request } from 'express';\nimport path from 'path';\nimport fs from 'fs';\nimport { AppError } from '../middleware/errorHandler';\n\n// Configure Cloudinary\nconst isCloudinaryConfigured = !!(\n  process.env.CLOUDINARY_CLOUD_NAME &&\n  process.env.CLOUDINARY_API_KEY &&\n  process.env.CLOUDINARY_API_SECRET\n);\n\nif (isCloudinaryConfigured) {\n  cloudinary.config({\n    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n    api_key: process.env.CLOUDINARY_API_KEY,\n    api_secret: process.env.CLOUDINARY_API_SECRET\n  });\n}\n\n// File filter function\nconst fileFilter = (req: Request, file: Express.Multer.File, cb: multer.FileFilterCallback) => {\n  // Allowed file types\n  const allowedTypes = {\n    'image/jpeg': 'jpg',\n    'image/jpg': 'jpg',\n    'image/png': 'png',\n    'image/gif': 'gif',\n    'application/pdf': 'pdf',\n    'text/plain': 'txt'\n  };\n\n  if (allowedTypes[file.mimetype as keyof typeof allowedTypes]) {\n    cb(null, true);\n  } else {\n    cb(new AppError('Invalid file type. Only JPEG, PNG, GIF, PDF, and TXT files are allowed.', 400));\n  }\n};\n\n// Multer configuration for memory storage\nexport const upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: parseInt(process.env.MAX_FILE_SIZE || '5242880'), // 5MB default\n    files: 5 // Maximum 5 files per request\n  },\n  fileFilter: fileFilter as any\n});\n\n// Single file upload middleware\nexport const uploadSingle = (fieldName: string) => upload.single(fieldName);\n\n// Upload to local storage (fallback when Cloudinary is not configured)\nconst uploadToLocal = async (\n  file: Express.Multer.File,\n  folder: string = 'dental-clinic'\n): Promise<{\n  public_id: string;\n  secure_url: string;\n  format: string;\n  bytes: number;\n}> => {\n  try {\n    // Create uploads directory if it doesn't exist\n    const uploadsDir = path.join(process.cwd(), 'uploads', folder);\n    if (!fs.existsSync(uploadsDir)) {\n      fs.mkdirSync(uploadsDir, { recursive: true });\n    }\n\n    // Generate unique filename\n    const timestamp = Date.now();\n    const randomString = Math.random().toString(36).substring(2, 15);\n    const fileExtension = path.extname(file.originalname);\n    const filename = `${timestamp}-${randomString}${fileExtension}`;\n    const filePath = path.join(uploadsDir, filename);\n\n    // Write file to disk\n    fs.writeFileSync(filePath, file.buffer);\n\n    // Return URL that can be served by the backend\n    const baseUrl = process.env.CLIENT_URL || 'http://localhost:5000';\n    const fileUrl = `${baseUrl}/uploads/${folder}/${filename}`;\n\n    return {\n      public_id: `${folder}/${filename}`,\n      secure_url: fileUrl,\n      format: fileExtension.substring(1),\n      bytes: file.buffer.length\n    };\n  } catch (error) {\n    throw new AppError('Failed to save file locally', 500);\n  }\n};\n\n// Upload single file to Cloudinary or local storage\nexport const uploadToCloudinary = async (\n  file: Express.Multer.File,\n  folder: string = 'dental-clinic'\n): Promise<{\n  public_id: string;\n  secure_url: string;\n  format: string;\n  bytes: number;\n}> => {\n  // Use local storage if Cloudinary is not configured\n  if (!isCloudinaryConfigured) {\n    console.log('Cloudinary not configured, using local storage');\n    return uploadToLocal(file, folder);\n  }\n\n  try {\n    return new Promise((resolve, reject) => {\n      const uploadOptions = {\n        folder,\n        resource_type: 'auto' as const,\n        quality: 'auto',\n        fetch_format: 'auto'\n      };\n\n      cloudinary.uploader.upload_stream(\n        uploadOptions,\n        (error, result) => {\n          if (error) {\n            console.error('Cloudinary upload error:', error);\n            reject(new AppError('Failed to upload file to cloud storage', 500));\n          } else if (result) {\n            resolve({\n              public_id: result.public_id,\n              secure_url: result.secure_url,\n              format: result.format,\n              bytes: result.bytes\n            });\n          } else {\n            reject(new AppError('Upload failed - no result returned', 500));\n          }\n        }\n      ).end(file.buffer);\n    });\n  } catch (error) {\n    console.error('Upload error:', error);\n    throw new AppError('File upload failed', 500);\n  }\n};\n\n// Upload multiple files to Cloudinary\nexport const uploadMultipleToCloudinary = async (\n  files: Express.Multer.File[],\n  folder: string = 'dental-clinic'\n): Promise<Array<{\n  public_id: string;\n  secure_url: string;\n  format: string;\n  bytes: number;\n  originalName: string;\n}>> => {\n  try {\n    const uploadPromises = files.map(async (file) => {\n      const result = await uploadToCloudinary(file, folder);\n      return {\n        ...result,\n        originalName: file.originalname\n      };\n    });\n\n    return await Promise.all(uploadPromises);\n  } catch (error) {\n    throw new AppError('Failed to upload multiple files', 500);\n  }\n};\n\n// Delete file from Cloudinary\nexport const deleteFromCloudinary = async (publicId: string): Promise<void> => {\n  try {\n    await cloudinary.uploader.destroy(publicId);\n  } catch (error) {\n    console.error('Failed to delete file from Cloudinary:', error);\n    throw new AppError('Failed to delete file from cloud storage', 500);\n  }\n};\n\n// Delete multiple files from Cloudinary\nexport const deleteMultipleFromCloudinary = async (publicIds: string[]): Promise<void> => {\n  try {\n    await cloudinary.api.delete_resources(publicIds);\n  } catch (error) {\n    console.error('Failed to delete multiple files from Cloudinary:', error);\n    throw new AppError('Failed to delete files from cloud storage', 500);\n  }\n};\n\n// Generate optimized image URL\nexport const getOptimizedImageUrl = (\n  publicId: string,\n  options: {\n    width?: number;\n    height?: number;\n    crop?: string;\n    quality?: string;\n    format?: string;\n  } = {}\n): string => {\n  const {\n    width = 800,\n    height = 600,\n    crop = 'fill',\n    quality = 'auto',\n    format = 'auto'\n  } = options;\n\n  return cloudinary.url(publicId, {\n    width,\n    height,\n    crop,\n    quality,\n    fetch_format: format\n  });\n};\n\n// Generate thumbnail URL\nexport const getThumbnailUrl = (publicId: string, size: number = 150): string => {\n  return cloudinary.url(publicId, {\n    width: size,\n    height: size,\n    crop: 'fill',\n    quality: 'auto',\n    fetch_format: 'auto'\n  });\n};\n\n// Validate file size\nexport const validateFileSize = (file: Express.Multer.File, maxSize?: number): boolean => {\n  const maxFileSize = maxSize || parseInt(process.env.MAX_FILE_SIZE || '5242880');\n  return file.size <= maxFileSize;\n};\n\n// Get file extension\nexport const getFileExtension = (filename: string): string => {\n  return path.extname(filename).toLowerCase();\n};\n\n// Generate unique filename\nexport const generateUniqueFilename = (originalName: string): string => {\n  const timestamp = Date.now();\n  const random = Math.random().toString(36).substring(2, 15);\n  const extension = getFileExtension(originalName);\n  const nameWithoutExt = path.basename(originalName, extension);\n  \n  return `${nameWithoutExt}_${timestamp}_${random}${extension}`;\n};\n\n// Check if file is image\nexport const isImageFile = (mimetype: string): boolean => {\n  return mimetype.startsWith('image/');\n};\n\n// Check if file is PDF\nexport const isPdfFile = (mimetype: string): boolean => {\n  return mimetype === 'application/pdf';\n};\n\n// Get file type category\nexport const getFileTypeCategory = (mimetype: string): 'image' | 'document' | 'other' => {\n  if (isImageFile(mimetype)) {\n    return 'image';\n  } else if (isPdfFile(mimetype) || mimetype === 'text/plain') {\n    return 'document';\n  } else {\n    return 'other';\n  }\n};\n\n// Format file size\nexport const formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 Bytes';\n  \n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n};\n\n// Upload profile image\nexport const uploadProfileImage = async (file: Express.Multer.File, userId: string) => {\n  if (!isImageFile(file.mimetype)) {\n    throw new AppError('Only image files are allowed for profile pictures', 400);\n  }\n\n  const folder = `dental-clinic/profiles/${userId}`;\n  return await uploadToCloudinary(file, folder);\n};\n\n// Upload treatment attachment\nexport const uploadTreatmentAttachment = async (\n  file: Express.Multer.File,\n  patientId: string,\n  treatmentId: string\n) => {\n  const folder = `dental-clinic/treatments/${patientId}/${treatmentId}`;\n  return await uploadToCloudinary(file, folder);\n};\n\n// Upload clinic image\nexport const uploadClinicImage = async (file: Express.Multer.File, clinicId: string) => {\n  if (!isImageFile(file.mimetype)) {\n    throw new AppError('Only image files are allowed for clinic images', 400);\n  }\n\n  const folder = `dental-clinic/clinics/${clinicId}`;\n  return await uploadToCloudinary(file, folder);\n};\n\n// Clean up orphaned files (files uploaded but not saved to database)\nexport const cleanupOrphanedFiles = async (publicIds: string[]): Promise<void> => {\n  try {\n    if (publicIds.length > 0) {\n      await deleteMultipleFromCloudinary(publicIds);\n      console.log(`Cleaned up ${publicIds.length} orphaned files`);\n    }\n  } catch (error) {\n    console.error('Failed to cleanup orphaned files:', error);\n  }\n};\n\n// Get file info from Cloudinary\nexport const getFileInfo = async (publicId: string) => {\n  try {\n    return await cloudinary.api.resource(publicId);\n  } catch (error) {\n    throw new AppError('Failed to get file information', 500);\n  }\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\websocket.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1368,1371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1368,1371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1609,1612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1609,1612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":61,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4121,4124],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4121,4124],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":137,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4359,4362],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4359,4362],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4482,4485],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4482,4485],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4621,4624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4621,4624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4744,4747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4744,4747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5160,5163],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5160,5163],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5306,5309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5306,5309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":181,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5599,5602],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5599,5602],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5747,5750],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5747,5750],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5910,5913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5910,5913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":194,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":194,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6033,6036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6033,6036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6187,6190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6187,6190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Server as HttpServer } from 'http';\nimport { Server as SocketIOServer, Socket } from 'socket.io';\nimport jwt from 'jsonwebtoken';\nimport { IUser } from '../types';\nimport User from '../models/User';\n\ninterface AuthenticatedSocket extends Socket {\n  user?: IUser;\n}\n\ninterface SocketData {\n  userId: string;\n  role: string;\n  clinicIds: string[];\n}\n\nclass WebSocketService {\n  private io: SocketIOServer;\n  private connectedUsers = new Map<string, string>(); // userId -> socketId\n  private userSockets = new Map<string, AuthenticatedSocket>(); // socketId -> socket\n\n  constructor(server: HttpServer) {\n    this.io = new SocketIOServer(server, {\n      cors: {\n        origin: process.env.FRONTEND_URL || \"http://localhost:5173\",\n        methods: [\"GET\", \"POST\"],\n        credentials: true\n      },\n      transports: ['websocket', 'polling']\n    });\n\n    this.setupMiddleware();\n    this.setupEventHandlers();\n  }\n\n  private setupMiddleware() {\n    // Authentication middleware\n    this.io.use(async (socket: AuthenticatedSocket, next) => {\n      try {\n        const token = socket.handshake.auth.token || socket.handshake.headers.authorization?.replace('Bearer ', '');\n        \n        if (!token) {\n          return next(new Error('Authentication failed: No token provided'));\n        }\n\n        const decoded = jwt.verify(token, process.env.JWT_SECRET!) as any;\n        const user = await User.findById(decoded.id).select('-password');\n        \n        if (!user || !user.isActive) {\n          return next(new Error('Authentication failed: Invalid user'));\n        }\n\n        socket.user = user as any;\n        socket.data = {\n          userId: user._id.toString(),\n          role: user.role,\n          clinicIds: user.assignedClinics?.map(id => id.toString()) || []\n        } as SocketData;\n\n        next();\n      } catch (error) {\n        next(new Error('Authentication failed: Invalid token'));\n      }\n    });\n  }\n\n  private setupEventHandlers() {\n    this.io.on('connection', (socket: AuthenticatedSocket) => {\n      if (!socket.user) return;\n\n      const userId = socket.user._id.toString();\n      \n      // Store user connection\n      this.connectedUsers.set(userId, socket.id);\n      this.userSockets.set(socket.id, socket);\n\n      console.log(`User ${socket.user.firstName} ${socket.user.lastName} connected (${socket.id})`);\n\n      // Join user-specific room\n      socket.join(`user:${userId}`);\n      \n      // Join role-specific room\n      socket.join(`role:${socket.user.role}`);\n      \n      // Join clinic-specific rooms\n      if (socket.user.assignedClinics && socket.user.assignedClinics.length > 0) {\n        socket.user.assignedClinics.forEach(clinicId => {\n          socket.join(`clinic:${clinicId}`);\n        });\n      }\n\n      // Handle real-time events\n      socket.on('join-appointment-room', (appointmentId: string) => {\n        socket.join(`appointment:${appointmentId}`);\n      });\n\n      socket.on('leave-appointment-room', (appointmentId: string) => {\n        socket.leave(`appointment:${appointmentId}`);\n      });\n\n      socket.on('join-clinic-room', (clinicId: string) => {\n        // Verify user has access to this clinic\n        if (socket.data?.clinicIds.includes(clinicId) || socket.user?.role === 'admin' || socket.user?.role === 'super_admin') {\n          socket.join(`clinic:${clinicId}`);\n        }\n      });\n\n      socket.on('mark-notification-read', async (notificationId: string) => {\n        try {\n          // Emit to user's room that notification was read\n          this.io.to(`user:${userId}`).emit('notification-read', { notificationId });\n        } catch (error) {\n          console.error('Error handling mark-notification-read:', error);\n        }\n      });\n\n      socket.on('disconnect', () => {\n        console.log(`User ${socket.user?.firstName} ${socket.user?.lastName} disconnected (${socket.id})`);\n        \n        // Clean up connections\n        this.connectedUsers.delete(userId);\n        this.userSockets.delete(socket.id);\n      });\n    });\n  }\n\n  // Public methods for sending notifications\n  public sendToUser(userId: string, event: string, data: any) {\n    const socketId = this.connectedUsers.get(userId);\n    if (socketId) {\n      this.io.to(`user:${userId}`).emit(event, data);\n      return true;\n    }\n    return false;\n  }\n\n  public sendToRole(role: string, event: string, data: any) {\n    this.io.to(`role:${role}`).emit(event, data);\n  }\n\n  public sendToClinic(clinicId: string, event: string, data: any) {\n    this.io.to(`clinic:${clinicId}`).emit(event, data);\n  }\n\n  public sendToAppointment(appointmentId: string, event: string, data: any) {\n    this.io.to(`appointment:${appointmentId}`).emit(event, data);\n  }\n\n  public broadcastToAll(event: string, data: any) {\n    this.io.emit(event, data);\n  }\n\n  public isUserConnected(userId: string): boolean {\n    return this.connectedUsers.has(userId);\n  }\n\n  public getConnectedUserIds(): string[] {\n    return Array.from(this.connectedUsers.keys());\n  }\n\n  public getConnectionCount(): number {\n    return this.connectedUsers.size;\n  }\n\n  // Notification-specific methods\n  public sendNotification(userId: string, notification: any) {\n    return this.sendToUser(userId, 'new-notification', notification);\n  }\n\n  public sendBulkNotifications(userIds: string[], notification: any) {\n    let sentCount = 0;\n    userIds.forEach(userId => {\n      if (this.sendToUser(userId, 'new-notification', notification)) {\n        sentCount++;\n      }\n    });\n    return sentCount;\n  }\n\n  // Appointment-specific methods\n  public sendAppointmentUpdate(appointmentId: string, update: any) {\n    this.sendToAppointment(appointmentId, 'appointment-updated', update);\n  }\n\n  public sendAppointmentReminder(userId: string, appointment: any) {\n    this.sendToUser(userId, 'appointment-reminder', appointment);\n  }\n\n  // Inventory-specific methods\n  public sendInventoryAlert(clinicId: string, alert: any) {\n    this.sendToClinic(clinicId, 'inventory-alert', alert);\n  }\n\n  public sendLowStockAlert(clinicId: string, items: any[]) {\n    this.sendToClinic(clinicId, 'low-stock-alert', { items });\n  }\n\n  // System-wide announcements\n  public sendSystemAnnouncement(announcement: any) {\n    this.broadcastToAll('system-announcement', announcement);\n  }\n}\n\nexport default WebSocketService;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\backend\\src\\utils\\websocketInstance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ConflictDetection.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'detectConflicts'. Either include it or remove the dependency array.","line":78,"column":6,"nodeType":"ArrayExpression","endLine":78,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [detectConflicts, schedules]","fix":{"range":[2163,2174],"text":"[detectConflicts, schedules]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":341,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":341,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12413,12416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12413,12416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { AlertTriangle, Clock, CheckCircle, XCircle, RefreshCw } from 'lucide-react';\nimport { Card, Button, Alert, Modal, Select } from './ui';\nimport adminService from '../services/adminService';\n\ninterface StaffSchedule {\n  _id: string;\n  staffId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    role: string;\n    email: string;\n  };\n  clinicId: {\n    _id: string;\n    name: string;\n  };\n  date: string;\n  startTime: string;\n  endTime: string;\n  shiftType: 'morning' | 'afternoon' | 'evening' | 'night' | 'full-day';\n  status: 'scheduled' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  isRecurring: boolean;\n  recurringPattern?: {\n    frequency: 'daily' | 'weekly' | 'monthly';\n    interval: number;\n    daysOfWeek?: number[];\n    endDate?: string;\n  };\n  notifications: {\n    enabled: boolean;\n    reminderTime: number;\n    channels: {\n      email: boolean;\n      sms: boolean;\n      inApp: boolean;\n    };\n  };\n}\n\ninterface Conflict {\n  id: string;\n  staffId: string;\n  staffName: string;\n  date: string;\n  conflictingSchedules: {\n    schedule1: StaffSchedule;\n    schedule2: StaffSchedule;\n  };\n  severity: 'high' | 'medium' | 'low';\n  type: 'time_overlap' | 'double_booking' | 'insufficient_break';\n  description: string;\n}\n\ninterface ConflictDetectionProps {\n  clinicId: string;\n  schedules: StaffSchedule[];\n  onResolveConflict: (conflictId: string) => void;\n}\n\nconst ConflictDetection: React.FC<ConflictDetectionProps> = ({\n  schedules,\n  onResolveConflict,\n}) => {\n  const queryClient = useQueryClient();\n  const [detectedConflicts, setDetectedConflicts] = useState<Conflict[]>([]);\n  const [showResolutionModal, setShowResolutionModal] = useState(false);\n  const [selectedConflict, setSelectedConflict] = useState<Conflict | null>(null);\n  const [resolutionAction, setResolutionAction] = useState<'modify' | 'cancel' | 'reassign'>('modify');\n  const [isResolving, setIsResolving] = useState(false);\n\n  // Detect conflicts whenever schedules change\n  useEffect(() => {\n    detectConflicts();\n  }, [schedules]);\n\n  const detectConflicts = () => {\n    const conflicts: Conflict[] = [];\n    const schedulesByStaff = schedules.reduce((acc, schedule) => {\n      const staffId = schedule.staffId._id;\n      if (!acc[staffId]) {\n        acc[staffId] = [];\n      }\n      acc[staffId].push(schedule);\n      return acc;\n    }, {} as Record<string, StaffSchedule[]>);\n\n    // Check for conflicts within each staff member's schedules\n    Object.entries(schedulesByStaff).forEach(([staffId, staffSchedules]) => {\n      const sortedSchedules = staffSchedules.sort((a, b) => {\n        const dateCompare = new Date(a.date).getTime() - new Date(b.date).getTime();\n        if (dateCompare !== 0) return dateCompare;\n        return a.startTime.localeCompare(b.startTime);\n      });\n\n      for (let i = 0; i < sortedSchedules.length - 1; i++) {\n        const current = sortedSchedules[i];\n        const next = sortedSchedules[i + 1];\n\n        // Check if schedules are on the same date\n        if (current.date.split('T')[0] === next.date.split('T')[0]) {\n          const currentEnd = new Date(`2000-01-01T${current.endTime}`);\n          const nextStart = new Date(`2000-01-01T${next.startTime}`);\n          // Check for insufficient break time between shifts\n\n          // Time overlap conflict\n          if (currentEnd > nextStart) {\n            conflicts.push({\n              id: `${current._id}-${next._id}`,\n              staffId,\n              staffName: `${current.staffId.firstName} ${current.staffId.lastName}`,\n              date: current.date,\n              conflictingSchedules: {\n                schedule1: current,\n                schedule2: next,\n              },\n              severity: 'high',\n              type: 'time_overlap',\n              description: `Overlapping schedules: ${current.startTime}-${current.endTime} and ${next.startTime}-${next.endTime}`,\n            });\n          }\n          // Insufficient break time (less than 30 minutes between shifts)\n          else if (nextStart.getTime() - currentEnd.getTime() < 30 * 60 * 1000) {\n            conflicts.push({\n              id: `${current._id}-${next._id}-break`,\n              staffId,\n              staffName: `${current.staffId.firstName} ${current.staffId.lastName}`,\n              date: current.date,\n              conflictingSchedules: {\n                schedule1: current,\n                schedule2: next,\n              },\n              severity: 'medium',\n              type: 'insufficient_break',\n              description: `Insufficient break time between shifts (${Math.round((nextStart.getTime() - currentEnd.getTime()) / (1000 * 60))} minutes)`,\n            });\n          }\n        }\n      }\n    });\n\n    setDetectedConflicts(conflicts);\n  };\n\n  // Resolve conflict mutation\n  const resolveConflictMutation = useMutation(\n    async ({ action, scheduleId }: { action: string; scheduleId?: string }) => {\n      if (action === 'cancel' && scheduleId) {\n        await adminService.deleteStaffSchedule(scheduleId);\n      }\n      // Add other resolution actions as needed\n    },\n    {\n      onSuccess: () => {\n        queryClient.invalidateQueries(['schedules']);\n        setShowResolutionModal(false);\n        setSelectedConflict(null);\n        onResolveConflict(selectedConflict?.id || '');\n      },\n    }\n  );\n\n  const handleResolveConflict = async () => {\n    if (!selectedConflict) return;\n\n    setIsResolving(true);\n    try {\n      if (resolutionAction === 'cancel') {\n        // Let user choose which schedule to cancel\n        const scheduleToCancel = selectedConflict.conflictingSchedules.schedule1._id;\n        await resolveConflictMutation.mutateAsync({\n          action: 'cancel',\n          scheduleId: scheduleToCancel,\n        });\n      }\n      // Add other resolution logic here\n    } finally {\n      setIsResolving(false);\n    }\n  };\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case 'high':\n        return 'bg-red-100 text-red-800 border-red-200';\n      case 'medium':\n        return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      case 'low':\n        return 'bg-blue-100 text-blue-800 border-blue-200';\n      default:\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const getConflictIcon = (type: string) => {\n    switch (type) {\n      case 'time_overlap':\n        return <AlertTriangle className=\"h-5 w-5 text-red-500\" />;\n      case 'double_booking':\n        return <XCircle className=\"h-5 w-5 text-red-500\" />;\n      case 'insufficient_break':\n        return <Clock className=\"h-5 w-5 text-yellow-500\" />;\n      default:\n        return <AlertTriangle className=\"h-5 w-5 text-gray-500\" />;\n    }\n  };\n\n  if (detectedConflicts.length === 0) {\n    return (\n      <Alert className=\"border-green-200 bg-green-50\">\n        <CheckCircle className=\"h-4 w-4 text-green-600\" />\n        <div className=\"ml-2\">\n          <h4 className=\"text-green-800 font-medium\">No Conflicts Detected</h4>\n          <p className=\"text-green-700 text-sm\">All staff schedules are properly organized without conflicts.</p>\n        </div>\n      </Alert>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Alert className=\"border-red-200 bg-red-50\">\n        <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n        <div className=\"ml-2\">\n          <h4 className=\"text-red-800 font-medium\">\n            {detectedConflicts.length} Scheduling Conflict{detectedConflicts.length > 1 ? 's' : ''} Detected\n          </h4>\n          <p className=\"text-red-700 text-sm\">\n            Please review and resolve the conflicts below to ensure proper staff scheduling.\n          </p>\n        </div>\n      </Alert>\n\n      <Card>\n        <div className=\"p-4 border-b\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Scheduling Conflicts</h3>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={detectConflicts}\n              className=\"flex items-center gap-2\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n              Refresh\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"divide-y divide-gray-200\">\n          {detectedConflicts.map((conflict) => (\n            <div key={conflict.id} className=\"p-4\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-3\">\n                  {getConflictIcon(conflict.type)}\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <h4 className=\"font-medium text-gray-900\">{conflict.staffName}</h4>\n                      <span className={`px-2 py-1 text-xs font-medium rounded-full border ${getSeverityColor(conflict.severity)}`}>\n                        {conflict.severity.toUpperCase()}\n                      </span>\n                    </div>\n                    <p className=\"text-sm text-gray-600 mb-2\">{conflict.description}</p>\n                    <div className=\"text-xs text-gray-500\">\n                      Date: {new Date(conflict.date).toLocaleDateString()}\n                    </div>\n                  </div>\n                </div>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => {\n                    setSelectedConflict(conflict);\n                    setShowResolutionModal(true);\n                  }}\n                >\n                  Resolve\n                </Button>\n              </div>\n\n              {/* Conflicting Schedules Details */}\n              <div className=\"mt-3 ml-8 space-y-2\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"p-3 bg-gray-50 rounded-lg\">\n                    <div className=\"text-sm font-medium text-gray-700 mb-1\">Schedule 1</div>\n                    <div className=\"text-sm text-gray-600\">\n                      {conflict.conflictingSchedules.schedule1.startTime} - {conflict.conflictingSchedules.schedule1.endTime}\n                    </div>\n                    <div className=\"text-xs text-gray-500\">\n                      {conflict.conflictingSchedules.schedule1.shiftType} shift\n                    </div>\n                  </div>\n                  <div className=\"p-3 bg-gray-50 rounded-lg\">\n                    <div className=\"text-sm font-medium text-gray-700 mb-1\">Schedule 2</div>\n                    <div className=\"text-sm text-gray-600\">\n                      {conflict.conflictingSchedules.schedule2.startTime} - {conflict.conflictingSchedules.schedule2.endTime}\n                    </div>\n                    <div className=\"text-xs text-gray-500\">\n                      {conflict.conflictingSchedules.schedule2.shiftType} shift\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </Card>\n\n      {/* Resolution Modal */}\n      {showResolutionModal && selectedConflict && (\n        <Modal\n        isOpen={showResolutionModal}\n        onClose={() => {\n          setShowResolutionModal(false);\n          setSelectedConflict(null);\n        }}\n        title=\"Resolve Scheduling Conflict\"\n        size=\"lg\"\n      >\n          <div className=\"space-y-4\">\n            <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <AlertTriangle className=\"h-5 w-5 text-red-500\" />\n                <h4 className=\"font-medium text-red-800\">Conflict Details</h4>\n              </div>\n              <p className=\"text-sm text-red-700\">{selectedConflict.description}</p>\n              <p className=\"text-xs text-red-600 mt-1\">\n                Staff: {selectedConflict.staffName} | Date: {new Date(selectedConflict.date).toLocaleDateString()}\n              </p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Resolution Action\n              </label>\n              <Select\n                value={resolutionAction}\n                onChange={(e: React.ChangeEvent<HTMLSelectElement>) => setResolutionAction(e.target.value as any)}\n                options={[\n                  { value: 'modify', label: 'Modify Schedule Times' },\n                  { value: 'cancel', label: 'Cancel One Schedule' },\n                  { value: 'reassign', label: 'Reassign to Different Staff' }\n                ]}\n              />\n            </div>\n\n            {resolutionAction === 'cancel' && (\n              <Alert className=\"border-yellow-200 bg-yellow-50\">\n                <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\n                <div className=\"ml-2\">\n                  <p className=\"text-yellow-800 text-sm\">\n                    This will cancel the first conflicting schedule. You can manually reschedule if needed.\n                  </p>\n                </div>\n              </Alert>\n            )}\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowResolutionModal(false);\n                  setSelectedConflict(null);\n                }}\n                disabled={isResolving}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleResolveConflict}\n                disabled={isResolving}\n              >\n                {isResolving ? 'Resolving...' : 'Resolve Conflict'}\n              </Button>\n            </div>\n          </div>\n        </Modal>\n      )}\n    </div>\n  );\n};\n\nexport default ConflictDetection;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ScheduleCalendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ScheduleForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1137,1140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1137,1140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4497,4500],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4497,4500],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4803,4806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4803,4806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5021,5024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5021,5024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Bell, Repeat, User } from 'lucide-react';\nimport { Card, Button, Select, Input, Checkbox } from './ui';\n\ninterface StaffSchedule {\n  _id: string;\n  staffId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    role: string;\n  };\n  date: string;\n  startTime: string;\n  endTime: string;\n  shiftType: 'morning' | 'afternoon' | 'evening' | 'night' | 'full-day';\n  status: 'scheduled' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  isRecurring: boolean;\n  recurringPattern?: {\n    frequency: 'daily' | 'weekly' | 'monthly';\n    interval: number;\n    endDate?: string;\n    daysOfWeek?: number[];\n  };\n  notifications: {\n    enabled: boolean;\n    reminderTime: number;\n    channels: {\n      email: boolean;\n      sms: boolean;\n      inApp: boolean;\n    };\n  };\n}\n\ninterface StaffMember {\n  _id: string;\n  firstName: string;\n  lastName: string;\n  role: string;\n  email: string;\n  phone?: string;\n}\n\ninterface ScheduleFormProps {\n  schedule?: StaffSchedule | null;\n  staff: StaffMember[];\n  onSubmit: (data: any) => void;\n  onCancel: () => void;\n  isLoading: boolean;\n}\n\nconst ScheduleForm: React.FC<ScheduleFormProps> = ({\n  schedule,\n  staff,\n  onSubmit,\n  onCancel,\n  isLoading,\n}) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState({\n    staffId: '',\n    date: '',\n    startTime: '',\n    endTime: '',\n    shiftType: 'morning' as 'morning' | 'afternoon' | 'evening' | 'night' | 'full-day',\n    status: 'scheduled' as 'scheduled' | 'completed' | 'cancelled' | 'no-show',\n    notes: '',\n    isRecurring: false,\n    recurringPattern: {\n      frequency: 'weekly' as 'daily' | 'weekly' | 'monthly',\n      interval: 1,\n      endDate: '',\n      daysOfWeek: [] as number[],\n    },\n    notifications: {\n      enabled: true,\n      reminderTime: 60, // minutes before shift\n      channels: {\n        email: true,\n        sms: false,\n        inApp: true,\n      },\n    },\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  useEffect(() => {\n    if (schedule) {\n      setFormData({\n        staffId: schedule.staffId._id,\n        date: schedule.date.split('T')[0],\n        startTime: schedule.startTime,\n        endTime: schedule.endTime,\n        shiftType: schedule.shiftType,\n        status: schedule.status,\n        notes: schedule.notes || '',\n        isRecurring: schedule.isRecurring,\n        recurringPattern: {\n          frequency: (schedule.recurringPattern?.frequency || 'weekly') as 'daily' | 'weekly' | 'monthly',\n          interval: schedule.recurringPattern?.interval || 1,\n          endDate: schedule.recurringPattern?.endDate || '',\n          daysOfWeek: schedule.recurringPattern?.daysOfWeek || []\n        },\n        notifications: schedule.notifications || {\n          enabled: true,\n          reminderTime: 60,\n          channels: {\n            email: true,\n            sms: false,\n            inApp: true,\n          },\n        },\n      });\n    }\n  }, [schedule]);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.staffId) {\n      newErrors.staffId = t('scheduleForm.validation.staffRequired');\n    }\n\n    if (!formData.date) {\n      newErrors.date = t('scheduleForm.validation.dateRequired');\n    }\n\n    if (!formData.startTime) {\n      newErrors.startTime = t('scheduleForm.validation.startTimeRequired');\n    }\n\n    if (!formData.endTime) {\n      newErrors.endTime = t('scheduleForm.validation.endTimeRequired');\n    }\n\n    if (formData.startTime && formData.endTime) {\n      const start = new Date(`2000-01-01T${formData.startTime}`);\n      const end = new Date(`2000-01-01T${formData.endTime}`);\n      if (start >= end) {\n        newErrors.endTime = t('scheduleForm.validation.endTimeAfterStart');\n      }\n    }\n\n    if (formData.isRecurring) {\n      if (formData.recurringPattern.frequency === 'weekly' && formData.recurringPattern.daysOfWeek.length === 0) {\n        newErrors.daysOfWeek = t('scheduleForm.validation.dayRequired');\n      }\n      if (!formData.recurringPattern.endDate) {\n        newErrors.endDate = t('scheduleForm.validation.endDateRequired');\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (validateForm()) {\n      onSubmit(formData);\n    }\n  };\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value,\n    }));\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({\n        ...prev,\n        [field]: '',\n      }));\n    }\n  };\n\n  const handleRecurringPatternChange = (field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      recurringPattern: {\n        ...prev.recurringPattern,\n        [field]: value,\n      },\n    }));\n  };\n\n  const handleNotificationChange = (field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      notifications: {\n        ...prev.notifications,\n        [field]: value,\n      },\n    }));\n  };\n\n  const handleDayOfWeekToggle = (day: number) => {\n    const currentDays = formData.recurringPattern.daysOfWeek;\n    const newDays = currentDays.includes(day)\n      ? currentDays.filter(d => d !== day)\n      : [...currentDays, day].sort();\n    \n    handleRecurringPatternChange('daysOfWeek', newDays);\n  };\n\n  const dayNames = [\n    t('scheduleForm.days.sunday'),\n    t('scheduleForm.days.monday'),\n    t('scheduleForm.days.tuesday'),\n    t('scheduleForm.days.wednesday'),\n    t('scheduleForm.days.thursday'),\n    t('scheduleForm.days.friday'),\n    t('scheduleForm.days.saturday'),\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\n      {/* Basic Information */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-2 mb-4\">\n          <User className=\"h-5 w-5 text-gray-500\" />\n          <h3 className=\"text-lg font-semibold\">{t('scheduleForm.basicInfo.title')}</h3>\n        </div>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.basicInfo.staffMember')} *\n            </label>\n            <Select\n              value={formData.staffId}\n              onChange={(e) => handleInputChange('staffId', e.target.value)}\n              className={errors.staffId ? 'border-red-500' : ''}\n              options={[\n                { value: '', label: t('scheduleForm.basicInfo.selectStaff') },\n                ...staff.map((member) => ({\n                  value: member._id,\n                  label: `${member.firstName} ${member.lastName} (${member.role})`\n                }))\n              ]}\n            />\n            {errors.staffId && (\n              <p className=\"text-red-500 text-xs mt-1\">{errors.staffId}</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.basicInfo.date')} *\n            </label>\n            <Input\n              type=\"date\"\n              value={formData.date}\n              onChange={(e) => handleInputChange('date', e.target.value)}\n              className={errors.date ? 'border-red-500' : ''}\n            />\n            {errors.date && (\n              <p className=\"text-red-500 text-xs mt-1\">{errors.date}</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.basicInfo.startTime')} *\n            </label>\n            <Input\n              type=\"time\"\n              value={formData.startTime}\n              onChange={(e) => handleInputChange('startTime', e.target.value)}\n              className={errors.startTime ? 'border-red-500' : ''}\n            />\n            {errors.startTime && (\n              <p className=\"text-red-500 text-xs mt-1\">{errors.startTime}</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.basicInfo.endTime')} *\n            </label>\n            <Input\n              type=\"time\"\n              value={formData.endTime}\n              onChange={(e) => handleInputChange('endTime', e.target.value)}\n              className={errors.endTime ? 'border-red-500' : ''}\n            />\n            {errors.endTime && (\n              <p className=\"text-red-500 text-xs mt-1\">{errors.endTime}</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.basicInfo.shiftType')}\n            </label>\n            <Select\n              value={formData.shiftType}\n              onChange={(e) => handleInputChange('shiftType', e.target.value)}\n              options={[\n                { value: 'morning', label: t('scheduleForm.shiftTypes.morning') },\n                { value: 'afternoon', label: t('scheduleForm.shiftTypes.afternoon') },\n                { value: 'evening', label: t('scheduleForm.shiftTypes.evening') },\n                { value: 'night', label: t('scheduleForm.shiftTypes.night') },\n                { value: 'full-day', label: t('scheduleForm.shiftTypes.fullDay') }\n              ]}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.basicInfo.status')}\n            </label>\n            <Select\n              value={formData.status}\n              onChange={(e) => handleInputChange('status', e.target.value)}\n              options={[\n                { value: 'scheduled', label: t('scheduleForm.statuses.scheduled') },\n                { value: 'completed', label: t('scheduleForm.statuses.completed') },\n                { value: 'cancelled', label: t('scheduleForm.statuses.cancelled') },\n                { value: 'no-show', label: t('scheduleForm.statuses.noShow') }\n              ]}\n            />\n          </div>\n        </div>\n\n        <div className=\"mt-4\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('scheduleForm.basicInfo.notes')}\n          </label>\n          <textarea\n            value={formData.notes}\n            onChange={(e) => handleInputChange('notes', e.target.value)}\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder={t('scheduleForm.basicInfo.notesPlaceholder')}\n          />\n        </div>\n      </Card>\n\n      {/* Recurring Schedule */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-2 mb-4\">\n          <Repeat className=\"h-5 w-5 text-gray-500\" />\n          <h3 className=\"text-lg font-semibold\">{t('scheduleForm.recurring.title')}</h3>\n        </div>\n        \n        <div className=\"space-y-4\">\n          <div className=\"flex items-center gap-2\">\n            <Checkbox\n              checked={formData.isRecurring}\n              onChange={(e) => handleInputChange('isRecurring', e.target.checked)}\n            />\n            <label className=\"text-sm font-medium text-gray-700\">\n              {t('scheduleForm.recurring.makeRecurring')}\n            </label>\n          </div>\n\n          {formData.isRecurring && (\n            <div className=\"space-y-4 pl-6 border-l-2 border-gray-200\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {t('scheduleForm.recurring.frequency')}\n                  </label>\n                  <Select\n                    value={formData.recurringPattern.frequency}\n                    onChange={(e) => handleRecurringPatternChange('frequency', e.target.value)}\n                    options={[\n                      { value: 'daily', label: t('scheduleForm.frequencies.daily') },\n                      { value: 'weekly', label: t('scheduleForm.frequencies.weekly') },\n                      { value: 'monthly', label: t('scheduleForm.frequencies.monthly') }\n                    ]}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {t('scheduleForm.recurring.interval')}\n                  </label>\n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    value={formData.recurringPattern.interval}\n                    onChange={(e) => handleRecurringPatternChange('interval', parseInt(e.target.value))}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {t('scheduleForm.recurring.endDate')} *\n                  </label>\n                  <Input\n                    type=\"date\"\n                    value={formData.recurringPattern.endDate}\n                    onChange={(e) => handleRecurringPatternChange('endDate', e.target.value)}\n                    className={errors.endDate ? 'border-red-500' : ''}\n                  />\n                  {errors.endDate && (\n                    <p className=\"text-red-500 text-xs mt-1\">{errors.endDate}</p>\n                  )}\n                </div>\n              </div>\n\n              {formData.recurringPattern.frequency === 'weekly' && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    {t('scheduleForm.recurring.daysOfWeek')} *\n                  </label>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {dayNames.map((day, index) => (\n                      <label key={index} className=\"flex items-center gap-1 cursor-pointer\">\n                        <Checkbox\n                          checked={formData.recurringPattern.daysOfWeek.includes(index)}\n                          onChange={() => handleDayOfWeekToggle(index)}\n                        />\n                        <span className=\"text-sm\">{day}</span>\n                      </label>\n                    ))}\n                  </div>\n                  {errors.daysOfWeek && (\n                    <p className=\"text-red-500 text-xs mt-1\">{errors.daysOfWeek}</p>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Notifications */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-2 mb-4\">\n          <Bell className=\"h-5 w-5 text-gray-500\" />\n          <h3 className=\"text-lg font-semibold\">{t('scheduleForm.notifications.title')}</h3>\n        </div>\n        \n        <div className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                checked={formData.notifications.enabled}\n                onChange={(e) => handleNotificationChange('enabled', e.target.checked)}\n              />\n              <label className=\"text-sm font-medium text-gray-700\">\n                {t('scheduleForm.notifications.enable')}\n              </label>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                checked={formData.notifications.channels.email}\n                onChange={(e) => handleNotificationChange('channels', { ...formData.notifications.channels, email: e.target.checked })}\n              />\n              <label className=\"text-sm font-medium text-gray-700\">\n                {t('scheduleForm.notifications.email')}\n              </label>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                checked={formData.notifications.channels.sms}\n                onChange={(e) => handleNotificationChange('channels', { ...formData.notifications.channels, sms: e.target.checked })}\n              />\n              <label className=\"text-sm font-medium text-gray-700\">\n                {t('scheduleForm.notifications.sms')}\n              </label>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                checked={formData.notifications.channels.inApp}\n                onChange={(e) => handleNotificationChange('channels', { ...formData.notifications.channels, inApp: e.target.checked })}\n              />\n              <label className=\"text-sm font-medium text-gray-700\">\n                {t('scheduleForm.notifications.inApp')}\n              </label>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('scheduleForm.notifications.reminderTime')}\n            </label>\n            <Select\n              value={formData.notifications.reminderTime.toString()}\n              onChange={(e) => handleNotificationChange('reminderTime', parseInt(e.target.value))}\n              options={[\n                { value: '15', label: t('scheduleForm.reminders.15min') },\n                { value: '30', label: t('scheduleForm.reminders.30min') },\n                { value: '60', label: t('scheduleForm.reminders.1hr') },\n                { value: '120', label: t('scheduleForm.reminders.2hr') },\n                { value: '1440', label: t('scheduleForm.reminders.1day') }\n              ]}\n            />\n          </div>\n        </div>\n      </Card>\n\n      {/* Form Actions */}\n      <div className=\"flex justify-end gap-3\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          disabled={isLoading}\n        >\n          {t('scheduleForm.buttons.cancel')}\n        </Button>\n        <Button\n          type=\"submit\"\n          disabled={isLoading}\n        >\n          {isLoading ? t('scheduleForm.buttons.saving') : schedule ? t('scheduleForm.buttons.update') : t('scheduleForm.buttons.create')}\n        </Button>\n      </div>\n    </form>\n  );\n};\n\nexport default ScheduleForm;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\StaffScheduling.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3306,3309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3306,3309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":123,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":123,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3627,3630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3627,3630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'clinics' logical expression could make the dependencies of useEffect Hook (at line 147) change on every render. To fix this, wrap the initialization of 'clinics' in its own useMemo() Hook.","line":139,"column":9,"nodeType":"VariableDeclarator","endLine":139,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4495,4498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4495,4498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4656,4659],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4656,4659],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Calendar, Users, Plus, Edit, Trash2 } from 'lucide-react';\nimport { Card, Button, Select, Modal, Spinner } from './ui';\nimport { useAuth } from '../hooks/useAuth';\nimport adminService from '../services/adminService';\nimport ScheduleCalendar from './ScheduleCalendar';\nimport ScheduleForm from './ScheduleForm';\nimport ConflictDetection from './ConflictDetection';\n\ninterface StaffSchedule {\n  _id: string;\n  staffId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    role: string;\n    email: string;\n  };\n  clinicId: {\n    _id: string;\n    name: string;\n  };\n  date: string;\n  startTime: string;\n  endTime: string;\n  shiftType: 'morning' | 'afternoon' | 'evening' | 'night' | 'full-day';\n  status: 'scheduled' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  isRecurring: boolean;\n  recurringPattern?: {\n    frequency: 'daily' | 'weekly' | 'monthly';\n    interval: number;\n    endDate?: string;\n    daysOfWeek?: number[];\n  };\n  notifications: {\n    enabled: boolean;\n    reminderTime: number;\n    channels: {\n      email: boolean;\n      sms: boolean;\n      inApp: boolean;\n    };\n  };\n}\n\ninterface StaffMember {\n  _id: string;\n  firstName: string;\n  lastName: string;\n  role: string;\n  email: string;\n  phone?: string;\n}\n\ninterface Clinic {\n  _id: string;\n  name: string;\n  address: string;\n}\n\nconst StaffScheduling: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n  const [selectedClinic, setSelectedClinic] = useState<string>('');\n  const [selectedDate, setSelectedDate] = useState<Date>(new Date());\n  const [viewMode, setViewMode] = useState<'calendar' | 'list'>('calendar');\n  const [showScheduleForm, setShowScheduleForm] = useState(false);\n  const [editingSchedule, setEditingSchedule] = useState<StaffSchedule | null>(null);\n  const [filters, setFilters] = useState({\n    staffId: '',\n    shiftType: '',\n    status: ''\n  });\n\n  // Fetch clinics\n  const { data: clinicsData } = useQuery({\n    queryKey: ['clinics'],\n    queryFn: () => adminService.getAdminClinics(),\n    enabled: !!user && (user.role === 'admin' || user.role === 'staff'),\n  });\n\n  // Fetch staff members for selected clinic\n  const { data: staffData } = useQuery({\n    queryKey: ['staff', selectedClinic],\n    queryFn: () => adminService.getStaffByClinic(selectedClinic),\n    enabled: !!selectedClinic,\n  });\n\n  // Fetch schedules\n  const { data: schedulesData, isLoading: schedulesLoading } = useQuery({\n    queryKey: ['schedules', selectedClinic, selectedDate, filters],\n    queryFn: () => {\n      const startDate = new Date(selectedDate);\n      startDate.setDate(startDate.getDate() - 7);\n      const endDate = new Date(selectedDate);\n      endDate.setDate(endDate.getDate() + 7);\n      \n      return adminService.getStaffSchedules({\n        clinicId: selectedClinic,\n        startDate: startDate.toISOString(),\n        endDate: endDate.toISOString(),\n        ...filters\n      });\n    },\n    enabled: !!selectedClinic,\n  });\n\n  // Create schedule mutation\n  const createScheduleMutation = useMutation({\n    mutationFn: (scheduleData: any) => adminService.createStaffSchedule(scheduleData),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['schedules'] });\n      setShowScheduleForm(false);\n    },\n  });\n\n  // Update schedule mutation\n  const updateScheduleMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => adminService.updateStaffSchedule(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['schedules'] });\n      setEditingSchedule(null);\n      setShowScheduleForm(false);\n    },\n  });\n\n  // Delete schedule mutation\n  const deleteScheduleMutation = useMutation({\n    mutationFn: (id: string) => adminService.deleteStaffSchedule(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['schedules'] });\n    },\n  });\n\n  const clinics: Clinic[] = clinicsData?.data?.clinics || [];\n  const staff: StaffMember[] = staffData?.data?.staff || [];\n  const schedules: StaffSchedule[] = schedulesData?.data?.schedules || [];\n\n  useEffect(() => {\n    if (clinics.length > 0 && !selectedClinic) {\n      setSelectedClinic(clinics[0]._id);\n    }\n  }, [clinics, selectedClinic]);\n\n  const handleCreateSchedule = (scheduleData: any) => {\n    createScheduleMutation.mutate({\n      ...scheduleData,\n      clinicId: selectedClinic,\n    });\n  };\n\n  const handleUpdateSchedule = (scheduleData: any) => {\n    if (editingSchedule) {\n      updateScheduleMutation.mutate({\n        id: editingSchedule._id,\n        data: scheduleData,\n      });\n    }\n  };\n\n  const handleDeleteSchedule = (scheduleId: string) => {\n    if (window.confirm(t('staff_scheduling.delete_confirmation'))) {\n      deleteScheduleMutation.mutate(scheduleId);\n    }\n  };\n\n  const handleEditSchedule = (schedule: StaffSchedule) => {\n    setEditingSchedule(schedule);\n    setShowScheduleForm(true);\n  };\n\n  const getShiftTypeColor = (shiftType: string) => {\n    const colors = {\n      morning: 'bg-yellow-100 text-yellow-800',\n      afternoon: 'bg-blue-100 text-blue-800',\n      evening: 'bg-purple-100 text-purple-800',\n      night: 'bg-gray-100 text-gray-800',\n      'full-day': 'bg-green-100 text-green-800',\n    };\n    return colors[shiftType as keyof typeof colors] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getStatusColor = (status: string) => {\n    const colors = {\n      scheduled: 'bg-blue-100 text-blue-800',\n      completed: 'bg-green-100 text-green-800',\n      cancelled: 'bg-red-100 text-red-800',\n      'no-show': 'bg-orange-100 text-orange-800',\n    };\n    return colors[status as keyof typeof colors] || 'bg-gray-100 text-gray-800';\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">{t('staff_scheduling.title')}</h1>\n          <p className=\"text-gray-600\">{t('staff_scheduling.description')}</p>\n        </div>\n        <Button\n          onClick={() => {\n            setEditingSchedule(null);\n            setShowScheduleForm(true);\n          }}\n          className=\"flex items-center gap-2\"\n        >\n          <Plus className=\"h-4 w-4\" />\n          {t('staff_scheduling.add_schedule')}\n        </Button>\n      </div>\n\n      {/* Filters and Controls */}\n      <Card className=\"p-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('staff_scheduling.clinic')}\n            </label>\n            <Select\n              value={selectedClinic}\n              onChange={(e) => setSelectedClinic(e.target.value)}\n              options={[\n                { value: '', label: t('staff_scheduling.select_clinic') },\n                ...clinics.map((clinic) => ({\n                  value: clinic._id,\n                  label: clinic.name\n                }))\n              ]}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('staff_scheduling.staff_member')}\n            </label>\n            <Select\n              value={filters.staffId}\n              onChange={(e) => setFilters({ ...filters, staffId: e.target.value })}\n              options={[\n                { value: '', label: t('staff_scheduling.all_staff') },\n                ...staff.map((member) => ({\n                  value: member._id,\n                  label: `${member.firstName} ${member.lastName} (${member.role})`\n                }))\n              ]}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('staff_scheduling.shift_type')}\n            </label>\n            <Select\n              value={filters.shiftType}\n              onChange={(e) => setFilters({ ...filters, shiftType: e.target.value })}\n              options={[\n                { value: '', label: t('staff_scheduling.all_shifts') },\n                { value: 'morning', label: t('staff_scheduling.morning') },\n                { value: 'afternoon', label: t('staff_scheduling.afternoon') },\n                { value: 'evening', label: t('staff_scheduling.evening') },\n                { value: 'night', label: t('staff_scheduling.night') },\n                { value: 'full-day', label: t('staff_scheduling.full_day') }\n              ]}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('staff_scheduling.status')}\n            </label>\n            <Select\n              value={filters.status}\n              onChange={(e) => setFilters({ ...filters, status: e.target.value })}\n              options={[\n                { value: '', label: t('staff_scheduling.all_status') },\n                { value: 'scheduled', label: t('staff_scheduling.scheduled') },\n                { value: 'completed', label: t('staff_scheduling.completed') },\n                { value: 'cancelled', label: t('staff_scheduling.cancelled') },\n                { value: 'no-show', label: t('staff_scheduling.no_show') }\n              ]}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('staff_scheduling.view_mode')}\n            </label>\n            <div className=\"flex gap-2\">\n              <Button\n                variant={viewMode === 'calendar' ? 'primary' : 'outline'}\n                size=\"sm\"\n                onClick={() => setViewMode('calendar')}\n                className=\"flex items-center gap-1\"\n              >\n                <Calendar className=\"h-4 w-4\" />\n                Calendar\n              </Button>\n              <Button\n                variant={viewMode === 'list' ? 'primary' : 'outline'}\n                size=\"sm\"\n                onClick={() => setViewMode('list')}\n                className=\"flex items-center gap-1\"\n              >\n                <Users className=\"h-4 w-4\" />\n                {t('staff_scheduling.list')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Conflict Detection */}\n      {selectedClinic && (\n        <ConflictDetection\n          clinicId={selectedClinic}\n          schedules={schedules}\n          onResolveConflict={() => {\n            // Handle conflict resolution\n            queryClient.invalidateQueries({ queryKey: ['schedules'] });\n          }}\n        />\n      )}\n\n      {/* Main Content */}\n      {schedulesLoading ? (\n        <div className=\"flex justify-center items-center h-64\">\n          <Spinner size=\"lg\" />\n        </div>\n      ) : (\n        <div>\n          {viewMode === 'calendar' ? (\n            <ScheduleCalendar\n              schedules={schedules}\n              staff={staff}\n              selectedDate={selectedDate}\n              onDateChange={setSelectedDate}\n              onEditSchedule={handleEditSchedule}\n              onDeleteSchedule={handleDeleteSchedule}\n              getShiftTypeColor={getShiftTypeColor}\n              getStatusColor={getStatusColor}\n            />\n          ) : (\n            <Card>\n              <div className=\"p-4 border-b\">\n                <h3 className=\"text-lg font-semibold\">{t('staff_scheduling.schedule_list')}</h3>\n              </div>\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        {t('staff_scheduling.staff_member')}\n                      </th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        {t('staff_scheduling.date')}\n                      </th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        {t('staff_scheduling.time')}\n                      </th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        {t('staff_scheduling.shift_type')}\n                      </th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        {t('staff_scheduling.status')}\n                      </th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        {t('staff_scheduling.actions')}\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\n                    {schedules.map((schedule) => (\n                      <tr key={schedule._id}>\n                        <td className=\"px-4 py-4 whitespace-nowrap\">\n                          <div>\n                            <div className=\"text-sm font-medium text-gray-900\">\n                              {schedule.staffId.firstName} {schedule.staffId.lastName}\n                            </div>\n                            <div className=\"text-sm text-gray-500\">\n                              {schedule.staffId.role}\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">\n                          {new Date(schedule.date).toLocaleDateString()}\n                        </td>\n                        <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">\n                          {schedule.startTime} - {schedule.endTime}\n                        </td>\n                        <td className=\"px-4 py-4 whitespace-nowrap\">\n                          <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getShiftTypeColor(schedule.shiftType)}`}>\n                            {schedule.shiftType}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-4 whitespace-nowrap\">\n                          <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(schedule.status)}`}>\n                            {schedule.status}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-4 whitespace-nowrap text-sm font-medium\">\n                          <div className=\"flex gap-2\">\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => handleEditSchedule(schedule)}\n                            >\n                              <Edit className=\"h-4 w-4\" />\n                            </Button>\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => handleDeleteSchedule(schedule._id)}\n                              className=\"text-red-600 hover:text-red-700\"\n                            >\n                              <Trash2 className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </Card>\n          )}\n        </div>\n      )}\n\n      {/* Schedule Form Modal */}\n      {showScheduleForm && (\n        <Modal\n          isOpen={showScheduleForm}\n          onClose={() => {\n            setShowScheduleForm(false);\n            setEditingSchedule(null);\n          }}\n          title={editingSchedule ? 'Edit Schedule' : 'Create Schedule'}\n          size=\"lg\"\n        >\n          <ScheduleForm\n            schedule={editingSchedule}\n            staff={staff}\n            onSubmit={editingSchedule ? handleUpdateSchedule : handleCreateSchedule}\n            onCancel={() => {\n              setShowScheduleForm(false);\n              setEditingSchedule(null);\n            }}\n            isLoading={createScheduleMutation.isLoading || updateScheduleMutation.isLoading}\n          />\n        </Modal>\n      )}\n    </div>\n  );\n};\n\nexport default StaffScheduling;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\appointment\\AppointmentBooking.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'timeSlots'. Either include it or remove the dependency array.","line":70,"column":6,"nodeType":"ArrayExpression","endLine":70,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [selectedDate, timeSlots]","fix":{"range":[2934,2948],"text":"[selectedDate, timeSlots]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Calendar, User, Phone, Mail, CheckCircle, AlertTriangle, Stethoscope, Clock } from 'lucide-react';\nimport { Button, Card, Input, Modal, LoadingSpinner } from '../ui';\nimport { useAuth } from '../../hooks';\nimport { appointmentService } from '../../services';\nimport toast from 'react-hot-toast';\n\ninterface AppointmentFormData {\n  patientName: string;\n  patientEmail: string;\n  patientPhone: string;\n  service: string;\n  preferredDate: string;\n  preferredTime: string;\n  notes: string;\n  emergency: boolean;\n}\n\ninterface TimeSlot {\n  time: string;\n  available: boolean;\n}\n\nconst AppointmentBooking: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [selectedDate, setSelectedDate] = useState('');\n  const [availableSlots, setAvailableSlots] = useState<TimeSlot[]>([]);\n  const [formData, setFormData] = useState<AppointmentFormData>({\n    patientName: user?.firstName && user?.lastName ? `${user.firstName} ${user.lastName}` : '',\n    patientEmail: user?.email || '',\n    patientPhone: user?.phone || '',\n    service: '',\n    preferredDate: '',\n    preferredTime: '',\n    notes: '',\n    emergency: false\n  });\n\n  const services = [\n    { value: 'consultation', label: t('appointments.services.consultation'), icon: '', duration: 30, description: t('appointments.services.consultationDesc') },\n    { value: 'cleaning', label: t('appointments.services.cleaning'), icon: '', duration: 60, description: t('appointments.services.cleaningDesc') },\n    { value: 'filling', label: t('appointments.services.filling'), icon: '', duration: 90, description: t('appointments.services.fillingDesc') },\n    { value: 'whitening', label: t('appointments.services.whitening'), icon: '', duration: 90, description: t('appointments.services.whiteningDesc') },\n    { value: 'crown', label: t('appointments.services.crown'), icon: '', duration: 120, description: t('appointments.services.crownDesc') },\n    { value: 'orthodontics', label: t('appointments.services.orthodontics'), icon: '', duration: 45, description: t('appointments.services.orthodonticsDesc') },\n    { value: 'emergency', label: t('appointments.services.emergency'), icon: '', duration: 60, description: t('appointments.services.emergencyDesc') }\n  ];\n\n\n\n  const timeSlots = [\n    '09:00', '09:30', '10:00', '10:30', '11:00', '11:30',\n    '12:00', '12:30', '14:00', '14:30', '15:00', '15:30',\n    '16:00', '16:30', '17:00', '17:30'\n  ];\n\n  // Generate available time slots for selected date\n  useEffect(() => {\n    if (selectedDate) {\n      const slots = timeSlots.map(time => ({\n        time,\n        available: Math.random() > 0.3 // Simulate availability\n      }));\n      setAvailableSlots(slots);\n    }\n  }, [selectedDate]);\n\n  const handleInputChange = (field: keyof AppointmentFormData, value: string | boolean) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n\n  const handleDateSelect = (date: string) => {\n    setSelectedDate(date);\n    setFormData(prev => ({\n      ...prev,\n      preferredDate: date\n    }));\n  };\n\n  const handleTimeSelect = (time: string) => {\n    setFormData(prev => ({\n      ...prev,\n      preferredTime: time\n    }));\n  };\n\n  const validateForm = (): boolean => {\n    const requiredFields = ['patientName', 'patientEmail', 'patientPhone', 'service', 'preferredDate', 'preferredTime'];\n    for (const field of requiredFields) {\n      if (!formData[field as keyof AppointmentFormData]) {\n        toast.error(t('appointment.validation.required', { field: t(`appointment.fields.${field}`) }) || `Please fill in ${field}`);\n        return false;\n      }\n    }\n    \n    if (!formData.patientEmail.includes('@')) {\n      toast.error(t('appointment.validation.email'));\n      return false;\n    }\n    \n    return true;\n  };\n\n  const handleAutoBooking = async () => {\n    if (!user?.id || !formData.service || !selectedDate) {\n      toast.error('Please fill in all required fields before auto-booking');\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const autoBookData = {\n        patientId: user.id,\n        clinicId: '687468107e70478314c346be', // Default clinic ID\n        serviceType: formData.service,\n        date: selectedDate,\n        duration: 60, // Default duration\n        notes: formData.notes || '',\n        emergency: formData.emergency || false\n      };\n\n      const result = await appointmentService.autoBookFirstAvailable(autoBookData);\n\n      if (result.success && result.appointment) {\n        toast.success(result.message || 'Appointment successfully auto-booked!', {\n          duration: 5000\n        });\n\n        // Show additional info about the booked slot\n        if (result.bookedSlot) {\n          toast.success(\n            `Booked at ${result.bookedSlot.time} with Dr. ${result.bookedSlot.dentistName}`,\n            { duration: 7000 }\n          );\n        }\n\n        setIsModalOpen(false);\n        setFormData({\n          patientName: user?.firstName && user?.lastName ? `${user.firstName} ${user.lastName}` : '',\n          patientEmail: user?.email || '',\n          patientPhone: user?.phone || '',\n          service: '',\n          preferredDate: '',\n          preferredTime: '',\n          notes: '',\n          emergency: false\n        });\n      } else {\n        toast.error(result.message || 'Failed to auto-book appointment. Please try selecting a time slot manually.');\n      }\n    } catch (error) {\n      console.error('Auto-booking error:', error);\n      toast.error('An error occurred while auto-booking. Please try again or select a time slot manually.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    setIsLoading(true);\n    \n    try {\n      const appointmentData = {\n        patientId: user?.id || '',\n        dentistId: '', // Will be assigned by backend based on availability\n        service: formData.service, // Use service to match CreateAppointmentDto interface\n        date: formData.preferredDate,\n        timeSlot: formData.preferredTime,\n        notes: formData.notes,\n        emergency: formData.emergency\n      };\n      \n      const response = await appointmentService.createAppointment(appointmentData);\n      \n      if (response) {\n        toast.success(t('appointment.success'));\n        setIsModalOpen(false);\n        setFormData({\n          patientName: user?.firstName && user?.lastName ? `${user.firstName} ${user.lastName}` : '',\n          patientEmail: user?.email || '',\n          patientPhone: user?.phone || '',\n          service: '',\n          preferredDate: '',\n          preferredTime: '',\n          notes: '',\n          emergency: false\n        });\n      } else {\n        toast.error(t('appointment.error'));\n      }\n    } catch (error) {\n      console.error('Appointment booking error:', error);\n      toast.error(t('appointment.error'));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const getNextAvailableDates = () => {\n    const dates = [];\n    const today = new Date();\n    \n    for (let i = 1; i <= 14; i++) {\n      const date = new Date(today);\n      date.setDate(today.getDate() + i);\n      \n      // Skip weekends (Saturday = 6, Sunday = 0)\n      if (date.getDay() !== 0 && date.getDay() !== 6) {\n        dates.push(date.toISOString().split('T')[0]);\n      }\n    }\n    \n    return dates;\n  };\n\n  return (\n    <>\n      <Button \n        onClick={() => setIsModalOpen(true)}\n        className=\"btn-primary group\"\n      >\n        <Calendar className=\"w-5 h-5 mr-2 group-hover:animate-pulse\" />\n        {t('appointment.bookNow')}\n      </Button>\n\n      <Modal\n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        title={t('appointment.title')}\n        size=\"lg\"\n      >\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Patient Information */}\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <Input\n              label={t('appointment.fields.patientName')}\n              value={formData.patientName}\n              onChange={(e) => handleInputChange('patientName', e.target.value)}\n              leftIcon={<User className=\"w-4 h-4\" />}\n              required\n            />\n            <Input\n              label={t('appointment.fields.patientEmail')}\n              type=\"email\"\n              value={formData.patientEmail}\n              onChange={(e) => handleInputChange('patientEmail', e.target.value)}\n              leftIcon={<Mail className=\"w-4 h-4\" />}\n              required\n            />\n            <Input\n              label={t('appointment.fields.patientPhone')}\n              value={formData.patientPhone}\n              onChange={(e) => handleInputChange('patientPhone', e.target.value)}\n              leftIcon={<Phone className=\"w-4 h-4\" />}\n              required\n            />\n          </div>\n\n          {/* Enhanced Service Selection */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              {t('appointment.fields.service')} <span className=\"text-red-500\">*</span>\n            </label>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n              {services.map((service) => (\n                <button\n                  key={service.value}\n                  type=\"button\"\n                  onClick={() => handleInputChange('service', service.value)}\n                  className={`p-4 rounded-lg border-2 transition-all text-left ${\n                    formData.service === service.value\n                      ? 'border-blue-500 bg-blue-50'\n                      : 'border-gray-200 hover:border-gray-300'\n                  }`}\n                >\n                  <div className=\"flex items-center\">\n                    <span className=\"text-2xl mr-3\">{service.icon}</span>\n                    <div>\n                      <div className=\"font-medium text-gray-900\">{service.label}</div>\n                      <div className=\"text-sm text-gray-500\">{service.description}</div>\n                      <div className=\"text-xs text-gray-400 mt-1\">{service.duration} minutes</div>\n                    </div>\n                  </div>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Date Selection */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              {t('appointment.fields.preferredDate')}\n            </label>\n            <div className=\"grid grid-cols-3 gap-2 max-h-32 overflow-y-auto\">\n              {getNextAvailableDates().map((date) => (\n                <button\n                  key={date}\n                  type=\"button\"\n                  onClick={() => handleDateSelect(date)}\n                  className={`p-2 text-sm rounded-lg border transition-colors ${\n                    selectedDate === date\n                      ? 'bg-blue-600 text-white border-blue-600'\n                      : 'bg-white text-gray-700 border-gray-300 hover:border-blue-300'\n                  }`}\n                >\n                  {new Date(date).toLocaleDateString('en-US', { \n                    month: 'short', \n                    day: 'numeric' \n                  })}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Auto-booking option */}\n          {selectedDate && (\n            <div className=\"mb-6\">\n              <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg mb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h3 className=\"text-sm font-medium text-blue-900 mb-1\">\n                      {t('appointment.autoBook.title') || 'Quick Book'}\n                    </h3>\n                    <p className=\"text-xs text-blue-700\">\n                      {t('appointment.autoBook.description') || 'Automatically book the first available time slot for this date'}\n                    </p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={handleAutoBooking}\n                    disabled={isLoading || !selectedDate || !formData.service}\n                    className=\"ml-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-md transition-colors\"\n                  >\n                    {isLoading ? (\n                      <>\n                        <div className=\"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                        {t('appointment.autoBook.booking') || 'Booking...'}\n                      </>\n                    ) : (\n                      t('appointment.autoBook.button') || 'Auto Book'\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"text-center text-sm text-gray-500 mb-4\">\n                {t('appointment.orSelectManually') || 'Or select a time slot manually:'}\n              </div>\n            </div>\n          )}\n\n          {/* Enhanced Time Slots */}\n          {selectedDate && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                {t('appointment.fields.preferredTime')} <span className=\"text-red-500\">*</span>\n              </label>\n              <div className=\"grid grid-cols-4 gap-2\">\n                {availableSlots.map((slot) => {\n                  const hour = parseInt(slot.time.split(':')[0]);\n                  const isPeakHour = (hour >= 10 && hour <= 12) || (hour >= 14 && hour <= 16);\n                  \n                  return (\n                    <button\n                      key={slot.time}\n                      type=\"button\"\n                      onClick={() => handleTimeSelect(slot.time)}\n                      disabled={!slot.available}\n                      className={`p-3 text-sm rounded-lg border transition-all ${\n                        !slot.available\n                          ? 'bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed'\n                          : formData.preferredTime === slot.time\n                          ? 'bg-blue-600 text-white border-blue-600 shadow-lg scale-105'\n                          : isPeakHour\n                          ? 'bg-yellow-50 text-yellow-800 border-yellow-300 hover:border-yellow-400 hover:bg-yellow-100'\n                          : 'bg-white text-gray-700 border-gray-300 hover:border-blue-300 hover:bg-blue-50'\n                      }`}\n                    >\n                      <div className=\"font-medium\">{slot.time}</div>\n                      {isPeakHour && (\n                        <div className=\"text-xs opacity-75 mt-1\">Peak</div>\n                      )}\n                    </button>\n                  );\n                })}\n              </div>\n              <p className=\"text-xs text-gray-500 mt-2\">\n                Peak hours (10 AM - 12 PM, 2 PM - 4 PM) may have higher demand\n              </p>\n            </div>\n          )}\n\n          {/* Emergency Checkbox */}\n          <div className=\"flex items-center space-x-2\">\n            <input\n              type=\"checkbox\"\n              id=\"emergency\"\n              checked={formData.emergency}\n              onChange={(e) => handleInputChange('emergency', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <label htmlFor=\"emergency\" className=\"text-sm text-gray-700\">\n              {t('appointment.fields.emergency')}\n            </label>\n          </div>\n\n          {/* Notes */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              {t('appointment.fields.notes')}\n            </label>\n            <textarea\n              value={formData.notes}\n              onChange={(e) => handleInputChange('notes', e.target.value)}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder={t('appointment.fields.notesPlaceholder')}\n            />\n          </div>\n\n          {/* Enhanced Summary */}\n          {formData.preferredDate && formData.preferredTime && (\n            <Card className=\"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200\">\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <CheckCircle className=\"w-6 h-6 text-blue-600\" />\n                <h3 className=\"font-semibold text-blue-900 text-lg\">Appointment Summary</h3>\n              </div>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center\">\n                    <Calendar className=\"w-4 h-4 text-gray-500 mr-2\" />\n                    <span className=\"text-sm font-medium text-gray-600\">Date:</span>\n                    <span className=\"text-sm text-gray-900 ml-auto\">\n                      {new Date(formData.preferredDate).toLocaleDateString('en-US', { \n                        weekday: 'long', \n                        year: 'numeric', \n                        month: 'long', \n                        day: 'numeric' \n                      })}\n                    </span>\n                  </div>\n                  \n                  <div className=\"flex items-center\">\n                    <Clock className=\"w-4 h-4 text-gray-500 mr-2\" />\n                    <span className=\"text-sm font-medium text-gray-600\">Time:</span>\n                    <span className=\"text-sm text-gray-900 ml-auto\">{formData.preferredTime}</span>\n                  </div>\n                </div>\n                \n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center\">\n                    <Stethoscope className=\"w-4 h-4 text-gray-500 mr-2\" />\n                    <span className=\"text-sm font-medium text-gray-600\">Service:</span>\n                    <span className=\"text-sm text-gray-900 ml-auto\">\n                      {services.find(s => s.value === formData.service)?.label}\n                    </span>\n                  </div>\n                  \n\n                </div>\n              </div>\n              \n              {formData.emergency && (\n                <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\n                  <div className=\"flex items-center\">\n                    <AlertTriangle className=\"w-4 h-4 text-red-500 mr-2\" />\n                    <span className=\"text-sm font-medium text-red-800\">Emergency Appointment</span>\n                  </div>\n                  <p className=\"text-xs text-red-600 mt-1\">\n                    This appointment will be prioritized for urgent care\n                  </p>\n                </div>\n              )}\n              \n              <div className=\"mt-4 pt-4 border-t border-blue-200\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm font-medium text-gray-600\">Estimated Duration:</span>\n                  <span className=\"text-sm font-semibold text-blue-600\">\n                    {services.find(s => s.value === formData.service)?.duration || 60} minutes\n                  </span>\n                </div>\n              </div>\n            </Card>\n          )}\n\n          {/* Submit Button */}\n          <div className=\"flex justify-end space-x-3\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => setIsModalOpen(false)}\n              disabled={isLoading}\n            >\n              {t('appointment.cancel')}\n            </Button>\n            <Button\n              type=\"submit\"\n              disabled={isLoading}\n              className=\"btn-primary\"\n            >\n              {isLoading ? (\n                <LoadingSpinner size=\"sm\" className=\"mr-2\" />\n              ) : (\n                <Calendar className=\"w-4 h-4 mr-2\" />\n              )}\n              {t('appointment.submit')}\n            </Button>\n          </div>\n        </form>\n      </Modal>\n    </>\n  );\n};\n\nexport default AppointmentBooking;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\appointment\\AppointmentFilterPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5600,5603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5600,5603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6189,6192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6189,6192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { X } from 'lucide-react';\nimport { useTranslation } from 'react-i18next';\nimport api from '../../services/api';\n\ninterface Filters {\n  startDate: string;\n  endDate: string;\n  clinicId: string;\n  patientName: string;\n  status: string;\n  sortBy: 'date' | 'createdAt' | 'status';\n  sortOrder: 'asc' | 'desc';\n}\n\ninterface AppointmentFilterPanelProps {\n  filters: Filters;\n  onFiltersChange: (filters: Filters) => void;\n  isAdmin?: boolean; // For future use (admin-specific filters)\n}\n\ninterface Clinic {\n  _id: string;\n  name: string;\n}\n\nconst AppointmentFilterPanel: React.FC<AppointmentFilterPanelProps> = ({\n  filters,\n  onFiltersChange\n}) => {\n  const { t } = useTranslation();\n  const [clinics, setClinics] = useState<Clinic[]>([]);\n  const [localFilters, setLocalFilters] = useState<Filters>(filters);\n\n  useEffect(() => {\n    fetchClinics();\n  }, []);\n\n  const fetchClinics = async () => {\n    try {\n      const response = await api.get('/clinics', {\n        params: { page: 1, limit: 100 }\n      });\n      if (response.data.success) {\n        setClinics(response.data.data.clinics || response.data.data);\n      }\n    } catch (error) {\n      console.error('Error fetching clinics:', error);\n    }\n  };\n\n  const handleChange = (field: keyof Filters, value: string) => {\n    setLocalFilters(prev => ({ ...prev, [field]: value }));\n  };\n\n  const applyFilters = () => {\n    onFiltersChange(localFilters);\n  };\n\n  const resetFilters = () => {\n    const defaultFilters: Filters = {\n      startDate: '',\n      endDate: '',\n      clinicId: '',\n      patientName: '',\n      status: '',\n      sortBy: 'date',\n      sortOrder: 'asc'\n    };\n    setLocalFilters(defaultFilters);\n    onFiltersChange(defaultFilters);\n  };\n\n  return (\n    <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {/* Date Range */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('appointmentFilter.startDate')}\n          </label>\n          <input\n            type=\"date\"\n            value={localFilters.startDate}\n            onChange={(e) => handleChange('startDate', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('appointmentFilter.endDate')}\n          </label>\n          <input\n            type=\"date\"\n            value={localFilters.endDate}\n            onChange={(e) => handleChange('endDate', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        </div>\n\n        {/* Clinic Filter */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('appointmentFilter.clinic')}\n          </label>\n          <select\n            value={localFilters.clinicId}\n            onChange={(e) => handleChange('clinicId', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value=\"\">{t('appointmentFilter.allClinics')}</option>\n            {clinics.map(clinic => (\n              <option key={clinic._id} value={clinic._id}>\n                {clinic.name}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Patient Name Search */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('appointmentFilter.patientName')}\n          </label>\n          <input\n            type=\"text\"\n            placeholder={t('appointmentFilter.searchPlaceholder')}\n            value={localFilters.patientName}\n            onChange={(e) => handleChange('patientName', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        </div>\n\n        {/* Status Filter */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('appointmentFilter.status')}\n          </label>\n          <select\n            value={localFilters.status}\n            onChange={(e) => handleChange('status', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value=\"\">{t('appointmentFilter.allStatuses')}</option>\n            <option value=\"scheduled\">{t('appointments.scheduled')}</option>\n            <option value=\"confirmed\">{t('appointments.confirmed')}</option>\n            <option value=\"in-progress\">{t('appointments.inProgress')}</option>\n            <option value=\"completed\">{t('appointments.completed')}</option>\n            <option value=\"cancelled\">{t('appointments.cancelled')}</option>\n            <option value=\"no-show\">{t('appointments.noshow')}</option>\n          </select>\n        </div>\n\n        {/* Sort Options */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('appointmentFilter.sortBy')}\n          </label>\n          <div className=\"flex gap-2\">\n            <select\n              value={localFilters.sortBy}\n              onChange={(e) => handleChange('sortBy', e.target.value as any)}\n              className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"date\">{t('appointmentFilter.sortOptions.date')}</option>\n              <option value=\"createdAt\">{t('appointmentFilter.sortOptions.createdAt')}</option>\n              <option value=\"status\">{t('appointmentFilter.sortOptions.status')}</option>\n            </select>\n            <select\n              value={localFilters.sortOrder}\n              onChange={(e) => handleChange('sortOrder', e.target.value as any)}\n              className=\"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"asc\">{t('appointmentFilter.sortOrder.asc')}</option>\n              <option value=\"desc\">{t('appointmentFilter.sortOrder.desc')}</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"flex justify-end gap-3 mt-4\">\n        <button\n          onClick={resetFilters}\n          className=\"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n        >\n          <X className=\"w-4 h-4 inline mr-1\" />\n          {t('appointmentFilter.reset')}\n        </button>\n        <button\n          onClick={applyFilters}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n        >\n          {t('appointmentFilter.applyFilters')}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AppointmentFilterPanel;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\appointment\\CancelConfirmDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1318,1321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1318,1321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { X, Trash2, AlertCircle, Mail, MessageSquare, Bell } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { useTranslation } from 'react-i18next';\n\ninterface Appointment {\n  _id: string;\n  date: string;\n  timeSlot: string;\n  patientId: {\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone: string;\n  };\n  clinicId: {\n    name: string;\n  };\n  serviceType: string;\n}\n\ninterface CancelConfirmDialogProps {\n  appointment: Appointment;\n  onClose: () => void;\n  onConfirm: (appointmentId: string, cancellationReason: string, notifyPatient: boolean) => Promise<void>;\n}\n\nconst CancelConfirmDialog: React.FC<CancelConfirmDialogProps> = ({\n  appointment,\n  onClose,\n  onConfirm\n}) => {\n  const { t } = useTranslation();\n  const [cancellationReason, setCancellationReason] = useState('');\n  const [notifyPatient, setNotifyPatient] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleConfirm = async () => {\n    if (!cancellationReason.trim()) {\n      setError(t('cancelDialog.reasonRequired'));\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n    \n    try {\n      await onConfirm(appointment._id, cancellationReason, notifyPatient);\n    } catch (err: any) {\n      setError(err.response?.data?.message || t('appointments.errorCancelling'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n          <div className=\"flex items-center\">\n            <div className=\"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center mr-3\">\n              <Trash2 className=\"w-5 h-5 text-red-600\" />\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">{t('cancelDialog.title')}</h2>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            disabled={loading}\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-4\">\n          {/* Appointment Info */}\n          <div className=\"p-4 bg-gray-50 rounded-lg\">\n            <p className=\"text-sm font-medium text-gray-900 mb-2\">{t('cancelDialog.appointmentDetails')}</p>\n            <div className=\"space-y-1 text-sm text-gray-700\">\n              <p><strong>{t('cancelDialog.patient')}:</strong> {appointment.patientId.firstName} {appointment.patientId.lastName}</p>\n              <p><strong>{t('cancelDialog.date')}:</strong> {format(parseISO(appointment.date), 'MMM dd, yyyy')} at {appointment.timeSlot}</p>\n              <p><strong>{t('cancelDialog.service')}:</strong> {appointment.serviceType}</p>\n              <p><strong>{t('cancelDialog.clinic')}:</strong> {appointment.clinicId.name}</p>\n            </div>\n          </div>\n\n          {/* Warning */}\n          <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg flex items-start\">\n            <AlertCircle className=\"w-5 h-5 text-red-600 mr-2 flex-shrink-0 mt-0.5\" />\n            <div>\n              <p className=\"text-sm font-medium text-red-900\">{t('cancelDialog.warning')}</p>\n              <p className=\"text-sm text-red-700 mt-1\">\n                {t('cancelDialog.warningMessage')}\n              </p>\n            </div>\n          </div>\n\n          {error && (\n            <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg\">\n              <p className=\"text-sm text-red-700\">{error}</p>\n            </div>\n          )}\n\n          {/* Cancellation Reason */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('cancelDialog.cancellationReason')} *\n            </label>\n            <textarea\n              value={cancellationReason}\n              onChange={(e) => setCancellationReason(e.target.value)}\n              rows={3}\n              placeholder={t('cancelDialog.reasonPlaceholder')}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none\"\n              disabled={loading}\n              required\n            />\n          </div>\n\n          {/* Notify Patient Checkbox */}\n          <div className=\"flex items-start\">\n            <input\n              type=\"checkbox\"\n              id=\"notifyPatient\"\n              checked={notifyPatient}\n              onChange={(e) => setNotifyPatient(e.target.checked)}\n              className=\"mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n              disabled={loading}\n            />\n            <label htmlFor=\"notifyPatient\" className=\"ml-3\">\n              <p className=\"text-sm font-medium text-gray-900\">\n                {t('cancelDialog.notifyPatient')}\n              </p>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                {t('cancelDialog.notificationInfo')}\n              </p>\n              <div className=\"flex items-center gap-3 mt-2 text-xs text-gray-600\">\n                <span className=\"flex items-center\">\n                  <Mail className=\"w-3 h-3 mr-1\" />\n                  {t('cancelDialog.emailTo')} {appointment.patientId.email}\n                </span>\n                <span className=\"flex items-center\">\n                  <MessageSquare className=\"w-3 h-3 mr-1\" />\n                  {t('cancelDialog.smsTo')} {appointment.patientId.phone}\n                </span>\n                <span className=\"flex items-center\">\n                  <Bell className=\"w-3 h-3 mr-1\" />\n                  {t('cancelDialog.inAppNotification')}\n                </span>\n              </div>\n            </label>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex justify-end gap-3 p-6 border-t border-gray-200\">\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n            disabled={loading}\n          >\n            {t('cancelDialog.keepAppointment')}\n          </button>\n          <button\n            onClick={handleConfirm}\n            disabled={loading}\n            className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {loading ? (\n              <>\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline mr-2\"></div>\n                {t('cancelDialog.cancelling')}\n              </>\n            ) : (\n              <>\n                <Trash2 className=\"w-4 h-4 inline mr-2\" />\n                {t('cancelDialog.cancelAppointment')}\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CancelConfirmDialog;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\appointment\\QuickEditModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[866,869],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[866,869],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { X, Save, Clock, FileText } from 'lucide-react';\n\ninterface Appointment {\n  _id: string;\n  timeSlot: string;\n  duration: number;\n  notes?: string;\n  patientId: {\n    firstName: string;\n    lastName: string;\n  };\n}\n\ninterface QuickEditModalProps {\n  appointment: Appointment;\n  onClose: () => void;\n  onSave: (appointmentId: string, updates: { timeSlot?: string; notes?: string; duration?: number }) => Promise<void>;\n}\n\nconst QuickEditModal: React.FC<QuickEditModalProps> = ({\n  appointment,\n  onClose,\n  onSave\n}) => {\n  const [timeSlot, setTimeSlot] = useState(appointment.timeSlot);\n  const [duration, setDuration] = useState(appointment.duration);\n  const [notes, setNotes] = useState(appointment.notes || '');\n  const [saving, setSaving] = useState(false);\n\n  const handleSave = async () => {\n    const updates: any = {};\n    \n    if (timeSlot !== appointment.timeSlot) {\n      updates.timeSlot = timeSlot;\n    }\n    if (duration !== appointment.duration) {\n      updates.duration = duration;\n    }\n    if (notes !== appointment.notes) {\n      updates.notes = notes;\n    }\n\n    if (Object.keys(updates).length === 0) {\n      onClose();\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await onSave(appointment._id, updates);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">Quick Edit</h2>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            disabled={saving}\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-4\">\n          <div>\n            <p className=\"text-sm text-gray-600 mb-4\">\n              Patient: <span className=\"font-medium text-gray-900\">\n                {appointment.patientId.firstName} {appointment.patientId.lastName}\n              </span>\n            </p>\n          </div>\n\n          {/* Time Slot */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              Time Slot\n            </label>\n            <input\n              type=\"time\"\n              value={timeSlot}\n              onChange={(e) => setTimeSlot(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={saving}\n            />\n          </div>\n\n          {/* Duration */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              Duration (minutes)\n            </label>\n            <select\n              value={duration}\n              onChange={(e) => setDuration(Number(e.target.value))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={saving}\n            >\n              <option value={15}>15 minutes</option>\n              <option value={30}>30 minutes</option>\n              <option value={45}>45 minutes</option>\n              <option value={60}>1 hour</option>\n              <option value={90}>1.5 hours</option>\n              <option value={120}>2 hours</option>\n            </select>\n          </div>\n\n          {/* Notes */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <FileText className=\"w-4 h-4 inline mr-1\" />\n              Notes\n            </label>\n            <textarea\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              rows={4}\n              placeholder=\"Add appointment notes...\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n              disabled={saving}\n            />\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex justify-end gap-3 p-6 border-t border-gray-200\">\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n            disabled={saving}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={saving}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {saving ? (\n              <>\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline mr-2\"></div>\n                Saving...\n              </>\n            ) : (\n              <>\n                <Save className=\"w-4 h-4 inline mr-2\" />\n                Save Changes\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default QuickEditModal;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\appointment\\RescheduleModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":54,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1495,1498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1495,1498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { X, Calendar, Clock, FileText, AlertCircle } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\n\ninterface Appointment {\n  _id: string;\n  date: string;\n  timeSlot: string;\n  duration: number;\n  patientId: {\n    firstName: string;\n    lastName: string;\n  };\n  clinicId: {\n    name: string;\n  };\n}\n\ninterface RescheduleModalProps {\n  appointment: Appointment;\n  onClose: () => void;\n  onReschedule: (appointmentId: string, newDate: string, newTimeSlot: string, newDuration: number, reason: string) => Promise<void>;\n}\n\nconst RescheduleModal: React.FC<RescheduleModalProps> = ({\n  appointment,\n  onClose,\n  onReschedule\n}) => {\n  const [newDate, setNewDate] = useState(format(parseISO(appointment.date), 'yyyy-MM-dd'));\n  const [newTimeSlot, setNewTimeSlot] = useState(appointment.timeSlot);\n  const [newDuration, setNewDuration] = useState(appointment.duration);\n  const [reason, setReason] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleReschedule = async () => {\n    // Validation\n    if (!newDate || !newTimeSlot) {\n      setError('Please select both date and time');\n      return;\n    }\n\n    if (!reason.trim()) {\n      setError('Please provide a reason for rescheduling');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n    \n    try {\n      await onReschedule(appointment._id, newDate, newTimeSlot, newDuration, reason);\n    } catch (err: any) {\n      setError(err.response?.data?.message || 'Failed to reschedule appointment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-lg w-full\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">Reschedule Appointment</h2>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            disabled={loading}\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-4\">\n          {/* Current Appointment Info */}\n          <div className=\"p-4 bg-blue-50 rounded-lg\">\n            <p className=\"text-sm font-medium text-blue-900 mb-2\">Current Appointment</p>\n            <p className=\"text-sm text-blue-800\">\n              <strong>Patient:</strong> {appointment.patientId.firstName} {appointment.patientId.lastName}\n            </p>\n            <p className=\"text-sm text-blue-800\">\n              <strong>Date:</strong> {format(parseISO(appointment.date), 'MMM dd, yyyy')} at {appointment.timeSlot}\n            </p>\n            <p className=\"text-sm text-blue-800\">\n              <strong>Duration:</strong> {appointment.duration} minutes\n            </p>\n            <p className=\"text-sm text-blue-800\">\n              <strong>Clinic:</strong> {appointment.clinicId.name}\n            </p>\n          </div>\n\n          {error && (\n            <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg flex items-start\">\n              <AlertCircle className=\"w-5 h-5 text-red-600 mr-2 flex-shrink-0 mt-0.5\" />\n              <p className=\"text-sm text-red-700\">{error}</p>\n            </div>\n          )}\n\n          {/* New Date */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <Calendar className=\"w-4 h-4 inline mr-1\" />\n              New Date\n            </label>\n            <input\n              type=\"date\"\n              value={newDate}\n              onChange={(e) => setNewDate(e.target.value)}\n              min={format(new Date(), 'yyyy-MM-dd')}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={loading}\n            />\n          </div>\n\n          {/* New Time Slot */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              New Time\n            </label>\n            <input\n              type=\"time\"\n              value={newTimeSlot}\n              onChange={(e) => setNewTimeSlot(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={loading}\n            />\n          </div>\n\n          {/* New Duration */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              Duration (minutes)\n            </label>\n            <select\n              value={newDuration}\n              onChange={(e) => setNewDuration(Number(e.target.value))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={loading}\n            >\n              <option value={15}>15 minutes</option>\n              <option value={30}>30 minutes</option>\n              <option value={45}>45 minutes</option>\n              <option value={60}>1 hour</option>\n              <option value={90}>1.5 hours</option>\n              <option value={120}>2 hours</option>\n            </select>\n          </div>\n\n          {/* Reason */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <FileText className=\"w-4 h-4 inline mr-1\" />\n              Reason for Rescheduling *\n            </label>\n            <textarea\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              rows={3}\n              placeholder=\"e.g., Doctor unavailable, patient request, emergency...\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n              disabled={loading}\n              required\n            />\n          </div>\n\n          <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n            <p className=\"text-sm text-yellow-800\">\n              <AlertCircle className=\"w-4 h-4 inline mr-1\" />\n              The patient will be notified via email and SMS about the rescheduled appointment.\n            </p>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex justify-end gap-3 p-6 border-t border-gray-200\">\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n            disabled={loading}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleReschedule}\n            disabled={loading}\n            className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {loading ? (\n              <>\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline mr-2\"></div>\n                Rescheduling...\n              </>\n            ) : (\n              <>\n                <Calendar className=\"w-4 h-4 inline mr-2\" />\n                Reschedule & Notify\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RescheduleModal;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\auth\\ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\auth\\RoleBasedProfile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\auth\\RoleBasedSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\billing\\BillingDetails.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\billing\\BillingForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5877,5880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5877,5880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6137,6140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6137,6140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9504,9507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9504,9507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { useTranslation } from 'react-i18next';\nimport { PlusIcon, TrashIcon } from '@heroicons/react/24/outline/index.js';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport Textarea from '../ui/Textarea';\nimport Card from '../ui/Card';\nimport { billingService } from '../../services/billingService';\nimport { patientService } from '../../services/patientService';\nimport { appointmentService } from '../../services/appointmentService';\nimport { treatmentService } from '../../services/treatmentService';\nimport { toast } from 'react-toastify';\nimport { format } from 'date-fns';\n\nconst getBillingSchema = (t: (key: string) => string) => z.object({\n  patient: z.string().min(1, t('billingForm.validation.patientRequired')),\n  appointment: z.string().optional(),\n  treatmentRecord: z.string().optional(),\n  items: z.array(z.object({\n    description: z.string().min(1, t('billingForm.validation.itemDescriptionRequired')),\n    quantity: z.number().min(1, t('billingForm.validation.itemQuantityMin')),\n    unitPrice: z.number().min(0, t('billingForm.validation.itemUnitPriceMin')),\n    total: z.number().min(0, t('billingForm.validation.itemTotalMin'))\n  })).min(1, t('billingForm.validation.atLeastOneItem')),\n  subtotal: z.number().min(0, t('billingForm.validation.subtotalMin')),\n  taxRate: z.number().min(0).max(100, t('billingForm.validation.taxRateMin')),\n  taxAmount: z.number().min(0, t('billingForm.validation.taxAmountMin')),\n  discountAmount: z.number().min(0, t('billingForm.validation.discountAmountMin')),\n  totalAmount: z.number().min(0, t('billingForm.validation.totalAmountMin')),\n  paymentMethod: z.string().optional(),\n  insuranceProvider: z.string().optional(),\n  insurancePolicyNumber: z.string().optional(),\n  insuranceCoverageAmount: z.number().min(0).optional(),\n  dueDate: z.string().min(1, t('billingForm.validation.dueDateRequired')),\n  notes: z.string().optional()\n});\n\ntype BillingFormData = z.infer<ReturnType<typeof getBillingSchema>>;\n\ninterface BillingRecord {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n    type: string;\n  };\n  treatmentRecord?: {\n    _id: string;\n    treatment: string;\n  };\n  items: Array<{\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    total: number;\n  }>;\n  subtotal: number;\n  taxAmount: number;\n  discountAmount: number;\n  totalAmount: number;\n  paymentMethod?: string;\n  insuranceInfo?: {\n    provider: string;\n    policyNumber: string;\n    coverageAmount: number;\n  };\n  dueDate: string;\n  notes?: string;\n}\n\ninterface BillingFormProps {\n  billingRecord?: BillingRecord | null;\n  patientId?: string;\n  onSave: () => void;\n  onCancel: () => void;\n}\n\ninterface Patient {\n  _id: string;\n  firstName: string;\n  lastName: string;\n  email: string;\n}\n\ninterface Appointment {\n  _id: string;\n  date: string;\n  type: string;\n  status: string;\n}\n\ninterface TreatmentRecord {\n  _id: string;\n  treatment: string;\n  date: string;\n}\n\nexport const BillingForm: React.FC<BillingFormProps> = ({\n  billingRecord,\n  patientId,\n  onSave,\n  onCancel\n}) => {\n  const { t } = useTranslation();\n  const [loading, setLoading] = useState(false);\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [treatmentRecords, setTreatmentRecords] = useState<TreatmentRecord[]>([]);\n  const [selectedPatient, setSelectedPatient] = useState<string>(patientId || '');\n  const [taxRate, setTaxRate] = useState(10); // Default 10% tax\n\n  const billingSchema = getBillingSchema(t);\n\n  const {\n    register,\n    control,\n    handleSubmit,\n    watch,\n    setValue,\n    formState: { errors },\n    reset\n  } = useForm<BillingFormData>({\n    resolver: zodResolver(billingSchema),\n    defaultValues: {\n      patient: patientId || '',\n      items: [{ description: '', quantity: 1, unitPrice: 0, total: 0 }],\n      subtotal: 0,\n      taxRate: 10,\n      taxAmount: 0,\n      discountAmount: 0,\n      totalAmount: 0,\n      dueDate: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd') // 30 days from now\n    }\n  });\n\n  const { fields, append, remove } = useFieldArray({\n    control,\n    name: 'items'\n  });\n\n  const watchedItems = watch('items');\n  const watchedDiscountAmount = watch('discountAmount');\n\n  const paymentMethodOptions = [\n    { value: '', label: t('billingForm.selectPaymentMethod') },\n    { value: 'cash', label: t('billingForm.cash') },\n    { value: 'credit_card', label: t('billingForm.creditCard') },\n    { value: 'debit_card', label: t('billingForm.debitCard') },\n    { value: 'check', label: t('billingForm.check') },\n    { value: 'bank_transfer', label: t('billingForm.bankTransfer') },\n    { value: 'insurance', label: t('billingForm.insurance') }\n  ];\n\n  // Fetch patients\n  useEffect(() => {\n    const fetchPatients = async () => {\n      try {\n        const response = await patientService.getPatients({ limit: 100 });\n        setPatients((response.data as unknown) as Patient[]);\n      } catch (_error) {\n        console.error('Error fetching patients:', _error);\n      }\n    };\n\n    if (!patientId) {\n      fetchPatients();\n    }\n  }, [patientId]);\n\n  // Fetch appointments and treatment records when patient changes\n  useEffect(() => {\n    const fetchPatientData = async () => {\n      if (!selectedPatient) return;\n\n      try {\n        // Fetch appointments\n        const appointmentsResponse = await appointmentService.getAppointments({\n          patientId: selectedPatient,\n          limit: 50\n        });\n        setAppointments((appointmentsResponse as any).data.appointments);\n\n        // Fetch treatment records\n        const treatmentsResponse = await treatmentService.getTreatmentRecords({\n          patient: selectedPatient,\n          limit: 50\n        });\n        setTreatmentRecords((treatmentsResponse as any).data.treatmentRecords);\n      } catch (_error) {\n        console.error('Error fetching patient data:', _error);\n      }\n    };\n\n    fetchPatientData();\n  }, [selectedPatient]);\n\n  // Initialize form with existing billing record\n  useEffect(() => {\n    if (billingRecord) {\n      reset({\n        patient: billingRecord.patient._id,\n        appointment: billingRecord.appointment?._id || '',\n        treatmentRecord: billingRecord.treatmentRecord?._id || '',\n        items: billingRecord.items,\n        subtotal: billingRecord.subtotal,\n        taxRate: (billingRecord.taxAmount / billingRecord.subtotal) * 100 || 10,\n        taxAmount: billingRecord.taxAmount,\n        discountAmount: billingRecord.discountAmount,\n        totalAmount: billingRecord.totalAmount,\n        paymentMethod: billingRecord.paymentMethod || '',\n        insuranceProvider: billingRecord.insuranceInfo?.provider || '',\n        insurancePolicyNumber: billingRecord.insuranceInfo?.policyNumber || '',\n        insuranceCoverageAmount: billingRecord.insuranceInfo?.coverageAmount || 0,\n        dueDate: format(new Date(billingRecord.dueDate), 'yyyy-MM-dd'),\n        notes: billingRecord.notes || ''\n      });\n      setSelectedPatient(billingRecord.patient._id);\n      setTaxRate((billingRecord.taxAmount / billingRecord.subtotal) * 100 || 10);\n    }\n  }, [billingRecord, reset]);\n\n  // Calculate totals when items or discount change\n  useEffect(() => {\n    const subtotal = watchedItems.reduce((sum, item) => {\n      const itemTotal = (item.quantity || 0) * (item.unitPrice || 0);\n      return sum + itemTotal;\n    }, 0);\n\n    const taxAmount = (subtotal * taxRate) / 100;\n    const totalAmount = subtotal + taxAmount - (watchedDiscountAmount || 0);\n\n    setValue('subtotal', subtotal);\n    setValue('taxAmount', taxAmount);\n    setValue('totalAmount', Math.max(0, totalAmount));\n\n    // Update individual item totals\n    watchedItems.forEach((item, index) => {\n      const itemTotal = (item.quantity || 0) * (item.unitPrice || 0);\n      setValue(`items.${index}.total`, itemTotal);\n    });\n  }, [watchedItems, watchedDiscountAmount, taxRate, setValue]);\n\n  const handlePatientChange = (patientId: string) => {\n    setSelectedPatient(patientId);\n    setValue('patient', patientId);\n    setValue('appointment', '');\n    setValue('treatmentRecord', '');\n  };\n\n  const handleTaxRateChange = (rate: number) => {\n    setTaxRate(rate);\n    setValue('taxRate', rate);\n  };\n\n  const addItem = () => {\n    append({ description: '', quantity: 1, unitPrice: 0, total: 0 });\n  };\n\n  const removeItem = (index: number) => {\n    if (fields.length > 1) {\n      remove(index);\n    }\n  };\n\n  const onSubmit = async (data: BillingFormData) => {\n    try {\n      setLoading(true);\n\n      const billingData = {\n        ...data,\n        insuranceInfo: data.insuranceProvider ? {\n          provider: data.insuranceProvider,\n          policyNumber: data.insurancePolicyNumber || '',\n          coverageAmount: data.insuranceCoverageAmount || 0\n        } : undefined\n      };\n\n      if (billingRecord) {\n        await billingService.updateBillingRecord(billingRecord._id, billingData);\n        toast.success('Invoice updated successfully');\n      } else {\n        await billingService.createBillingRecord(billingData);\n        toast.success('Invoice created successfully');\n      }\n\n      onSave();\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Failed to save invoice');\n      console.error('Error saving billing record:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const patientOptions = patients.map(patient => ({\n    value: patient._id,\n    label: `${patient.firstName} ${patient.lastName} (${patient.email})`\n  }));\n\n  const appointmentOptions = [\n    { value: '', label: 'No appointment' },\n    ...appointments.map(appointment => ({\n      value: appointment._id,\n      label: `${appointment.type} - ${format(new Date(appointment.date), 'MMM dd, yyyy')}`\n    }))\n  ];\n\n  const treatmentOptions = [\n    { value: '', label: 'No treatment record' },\n    ...treatmentRecords.map(treatment => ({\n      value: treatment._id,\n      label: `${treatment.treatment} - ${format(new Date(treatment.date), 'MMM dd, yyyy')}`\n    }))\n  ];\n\n  return (\n    <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n      {/* Patient Selection */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('billingForm.patient')} *\n          </label>\n          {patientId ? (\n            <Input\n              value={billingRecord ? `${billingRecord.patient.firstName} ${billingRecord.patient.lastName}` : t('billingForm.selectPatient')}\n              disabled\n            />\n          ) : (\n            <Select\n              {...register('patient')}\n              options={patientOptions}\n              onChange={(e) => handlePatientChange(e.target.value)}\n              error={errors.patient?.message}\n            />\n          )}\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('billingForm.dueDate')} *\n          </label>\n          <Input\n            type=\"date\"\n            {...register('dueDate')}\n            error={errors.dueDate?.message}\n          />\n        </div>\n      </div>\n\n      {/* Appointment and Treatment */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('billingForm.appointment')}\n          </label>\n          <Select\n            {...register('appointment')}\n            options={appointmentOptions}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('billingForm.treatmentRecord')}\n          </label>\n          <Select\n            {...register('treatmentRecord')}\n            options={treatmentOptions}\n          />\n        </div>\n      </div>\n\n      {/* Items */}\n      <Card className=\"p-4\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <h3 className=\"text-lg font-medium text-gray-900\">{t('billingForm.invoiceItems')}</h3>\n          <Button type=\"button\" onClick={addItem} size=\"sm\">\n            <PlusIcon className=\"h-4 w-4 mr-1\" />\n            {t('billingForm.addItem')}\n          </Button>\n        </div>\n\n        <div className=\"space-y-4\">\n          {fields.map((field, index) => (\n            <div key={field.id} className=\"grid grid-cols-12 gap-2 items-start\">\n              <div className=\"col-span-5\">\n                <Input\n                  {...register(`items.${index}.description`)}\n                  placeholder={t('billingForm.description')}\n                  error={errors.items?.[index]?.description?.message}\n                />\n              </div>\n              <div className=\"col-span-2\">\n                <Input\n                  type=\"number\"\n                  min=\"1\"\n                  step=\"1\"\n                  {...register(`items.${index}.quantity`, { valueAsNumber: true })}\n                  placeholder={t('billingForm.quantity')}\n                  error={errors.items?.[index]?.quantity?.message}\n                />\n              </div>\n              <div className=\"col-span-2\">\n                <Input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.01\"\n                  {...register(`items.${index}.unitPrice`, { valueAsNumber: true })}\n                  placeholder={t('billingForm.unitPrice')}\n                  error={errors.items?.[index]?.unitPrice?.message}\n                />\n              </div>\n              <div className=\"col-span-2\">\n                <Input\n                  type=\"number\"\n                  {...register(`items.${index}.total`, { valueAsNumber: true })}\n                  placeholder={t('billingForm.total')}\n                  disabled\n                  className=\"bg-gray-50\"\n                />\n              </div>\n              <div className=\"col-span-1\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => removeItem(index)}\n                  disabled={fields.length === 1}\n                  className=\"text-red-600 hover:text-red-700\"\n                >\n                  <TrashIcon className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </Card>\n\n      {/* Totals */}\n      <Card className=\"p-4\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">{t('billingForm.summary')}</h3>\n        <div className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.subtotal')}\n              </label>\n              <Input\n                type=\"number\"\n                {...register('subtotal', { valueAsNumber: true })}\n                disabled\n                className=\"bg-gray-50\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.taxRate')}\n              </label>\n              <Input\n                type=\"number\"\n                min=\"0\"\n                max=\"100\"\n                step=\"0.01\"\n                {...register('taxRate', { \n                  valueAsNumber: true,\n                  onChange: (e) => handleTaxRateChange(parseFloat(e.target.value) || 0)\n                })}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Tax Amount\n              </label>\n              <Input\n                type=\"number\"\n                {...register('taxAmount', { valueAsNumber: true })}\n                disabled\n                className=\"bg-gray-50\"\n              />\n            </div>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.discountAmount')}\n              </label>\n              <Input\n                type=\"number\"\n                min=\"0\"\n                step=\"0.01\"\n                {...register('discountAmount', { valueAsNumber: true })}\n                placeholder=\"0.00\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.totalAmount')}\n              </label>\n              <Input\n                type=\"number\"\n                {...register('totalAmount', { valueAsNumber: true })}\n                disabled\n                className=\"bg-gray-50 text-lg font-semibold\"\n              />\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Payment and Insurance */}\n      <Card className=\"p-4\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">{t('billingForm.paymentInformation')}</h3>\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('billingForm.paymentMethod')}\n            </label>\n            <Select\n              {...register('paymentMethod')}\n              options={paymentMethodOptions}\n            />\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.insuranceProvider')}\n              </label>\n              <Input\n                {...register('insuranceProvider')}\n                placeholder=\"Insurance company name\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.insurancePolicyNumber')}\n              </label>\n              <Input\n                {...register('insurancePolicyNumber')}\n                placeholder=\"Policy number\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t('billingForm.insuranceCoverageAmount')}\n              </label>\n              <Input\n                type=\"number\"\n                min=\"0\"\n                step=\"0.01\"\n                {...register('insuranceCoverageAmount', { valueAsNumber: true })}\n                placeholder=\"0.00\"\n              />\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Notes */}\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n          {t('billingForm.notes')}\n        </label>\n        <Textarea\n          {...register('notes')}\n          placeholder=\"Additional notes or comments...\"\n          rows={3}\n        />\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex justify-end gap-3\">\n        <Button type=\"button\" variant=\"outline\" onClick={onCancel} disabled={loading}>\n          {t('billingForm.cancel')}\n        </Button>\n        <Button type=\"submit\" disabled={loading}>\n          {loading ? (billingRecord ? t('billingForm.updating') : t('billingForm.saving')) : (billingRecord ? t('billingForm.updateInvoice') : t('billingForm.createInvoice'))}\n        </Button>\n      </div>\n    </form>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\billing\\BillingList.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchBillingRecords'. Either include it or remove the dependency array.","line":134,"column":6,"nodeType":"ArrayExpression","endLine":134,"endColumn":56,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, searchTerm, statusFilter, patientId, fetchBillingRecords]","fix":{"range":[4223,4273],"text":"[currentPage, searchTerm, statusFilter, patientId, fetchBillingRecords]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Search, Plus, Eye, Edit, Trash2, DollarSign, Calendar, User, CreditCard } from 'lucide-react';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select  from '../ui/Select';\nimport Card from '../ui/Card';\nimport Badge from '../ui/Badge';\nimport Modal from '../ui/Modal';\nimport { BillingForm } from './BillingForm';\nimport { BillingDetails } from './BillingDetails';\nimport { PaymentForm } from './PaymentForm';\nimport { useAuth } from '../../hooks/useAuth';\nimport { useTranslation } from 'react-i18next';\nimport { billingService } from '../../services/billingService';\nimport toast from 'react-hot-toast';\nimport { format } from 'date-fns';\n\ninterface BillingRecord {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n    type: string;\n  };\n  treatmentRecord?: {\n    _id: string;\n    treatment: string;\n  };\n  clinic: {\n    _id: string;\n    name: string;\n  };\n  dentist: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  invoiceNumber: string;\n  items: Array<{\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    total: number;\n  }>;\n  subtotal: number;\n  taxAmount: number;\n  discountAmount: number;\n  totalAmount: number;\n  paidAmount: number;\n  balanceAmount: number;\n  paymentMethod?: string;\n  paymentStatus: 'pending' | 'partial' | 'paid' | 'overdue';\n  insuranceInfo?: {\n    provider: string;\n    policyNumber: string;\n    coverageAmount: number;\n  };\n  dueDate: string;\n  paidDate?: string;\n  notes?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface BillingListProps {\n  patientId?: string;\n}\n\nexport const BillingList: React.FC<BillingListProps> = ({ patientId }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [billingRecords, setBillingRecords] = useState<BillingRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [isFormModalOpen, setIsFormModalOpen] = useState(false);\n  const [isDetailsModalOpen, setIsDetailsModalOpen] = useState(false);\n  const [isPaymentModalOpen, setIsPaymentModalOpen] = useState(false);\n  const [editingRecord, setEditingRecord] = useState<BillingRecord | null>(null);\n  const [viewingRecord, setViewingRecord] = useState<BillingRecord | null>(null);\n  const [paymentRecord, setPaymentRecord] = useState<BillingRecord | null>(null);\n\n  const statusOptions = [\n    { value: 'all', label: t('billingList.allStatus') },\n    { value: 'pending', label: t('billingList.pending') },\n    { value: 'partial', label: t('billingList.partial') },\n    { value: 'paid', label: t('billingList.paid') },\n    { value: 'overdue', label: t('billingList.overdue') }\n  ];\n\n  const fetchBillingRecords = async () => {\n    try {\n      setLoading(true);\n      const params = {\n        page: currentPage,\n        limit: 10,\n        search: searchTerm,\n        paymentStatus: statusFilter !== 'all' ? statusFilter : undefined,\n        patient: patientId\n      };\n      \n      let response;\n      if (patientId) {\n        response = await billingService.getBillingByPatient(patientId, params);\n      } else {\n        response = await billingService.getBillingRecords(params);\n      }\n      \n      // Handle response data with fallbacks\n      const billingRecordsData = response.data?.billingRecords || response.data || [];\n      const totalPagesData = response.data?.totalPages || response.data?.pagination?.pages || 1;\n      \n      // Ensure billingRecordsData is an array\n      setBillingRecords(Array.isArray(billingRecordsData) ? billingRecordsData : []);\n      setTotalPages(typeof totalPagesData === 'number' ? totalPagesData : 1);\n    } catch (_error) {\n      toast.error(t('billingList.fetchError'));\n      console.error('Error fetching billing records:', _error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchBillingRecords();\n  }, [currentPage, searchTerm, statusFilter, patientId]);\n\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchTerm(e.target.value);\n    setCurrentPage(1);\n  };\n\n  const handleStatusFilter = (status: string) => {\n    setStatusFilter(status);\n    setCurrentPage(1);\n  };\n\n  const handleAddRecord = () => {\n    setEditingRecord(null);\n    setIsFormModalOpen(true);\n  };\n\n  const handleEditRecord = (record: BillingRecord) => {\n    setEditingRecord(record);\n    setIsFormModalOpen(true);\n  };\n\n  const handleViewRecord = (record: BillingRecord) => {\n    setViewingRecord(record);\n    setIsDetailsModalOpen(true);\n  };\n\n  const handleAddPayment = (record: BillingRecord) => {\n    setPaymentRecord(record);\n    setIsPaymentModalOpen(true);\n  };\n\n  const handleDeleteRecord = async (recordId: string) => {\n    if (!window.confirm(t('billingList.deleteConfirmation'))) {\n      return;\n    }\n\n    try {\n      await billingService.deleteBillingRecord(recordId);\n      toast.success(t('billingList.deleteSuccess'));\n      fetchBillingRecords();\n    } catch (_error) {\n      toast.error(t('billingList.deleteError'));\n      console.error('Error deleting billing record:', _error);\n    }\n  };\n\n  const handleRecordSaved = () => {\n    setIsFormModalOpen(false);\n    setEditingRecord(null);\n    fetchBillingRecords();\n  };\n\n  const handlePaymentAdded = () => {\n    setIsPaymentModalOpen(false);\n    setPaymentRecord(null);\n    fetchBillingRecords();\n  };\n\n  const getStatusColor = (status: string) => {\n    const colors = {\n      pending: 'bg-yellow-100 text-yellow-800',\n      partial: 'bg-blue-100 text-blue-800',\n      paid: 'bg-green-100 text-green-800',\n      overdue: 'bg-red-100 text-red-800'\n    };\n    return colors[status as keyof typeof colors] || colors.pending;\n  };\n\n  const isOverdue = (dueDate: string, paymentStatus: string) => {\n    return new Date(dueDate) < new Date() && paymentStatus !== 'paid';\n  };\n\n  const canManageBilling = user?.role === 'dentist' || user?.role === 'admin' || user?.role === 'staff';\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold text-gray-900\">\n          {patientId ? t('billingList.patientBilling') : t('billingList.title')}\n        </h2>\n        {canManageBilling && (\n          <Button onClick={handleAddRecord} className=\"flex items-center gap-2\">\n            <Plus className=\"h-4 w-4\" />\n            {t('billingList.newInvoice')}\n          </Button>\n        )}\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"flex-1\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n            <Input\n              type=\"text\"\n              placeholder={t('billingList.searchPlaceholder')}\n              value={searchTerm}\n              onChange={handleSearch}\n              className=\"pl-10\"\n            />\n          </div>\n        </div>\n        <div className=\"sm:w-48\">\n          <Select\n            value={statusFilter}\n            onChange={(e) => handleStatusFilter(e.target.value)}\n            options={statusOptions}\n          />\n        </div>\n      </div>\n\n      {/* Billing Records List */}\n      <div className=\"space-y-4\">\n        {billingRecords.map((record) => (\n          <Card key={record._id} className=\"p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"space-y-4\">\n              {/* Header */}\n              <div className=\"flex justify-between items-start\">\n                <div className=\"space-y-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">\n                      {t('billingList.invoice')} #{record.invoiceNumber}\n                    </h3>\n                    <Badge className={getStatusColor(record.paymentStatus)}>\n                      {t(`billingList.${record.paymentStatus}`)}\n                    </Badge>\n                    {isOverdue(record.dueDate, record.paymentStatus) && (\n                      <Badge className=\"bg-red-100 text-red-800\">\n                        {t('billingList.overdue')}\n                      </Badge>\n                    )}\n                  </div>\n                  {!patientId && (\n                    <div className=\"flex items-center gap-1 text-sm text-gray-600\">\n                      <User className=\"h-4 w-4\" />\n                      {record.patient.firstName} {record.patient.lastName}\n                    </div>\n                  )}\n                  <div className=\"flex items-center gap-1 text-sm text-gray-600\">\n                    <Calendar className=\"h-4 w-4\" />\n                    {t('billingList.dueDateLabel')}: {format(new Date(record.dueDate), 'MMM dd, yyyy')}\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => handleViewRecord(record)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  {canManageBilling && (\n                    <>\n                      {record.balanceAmount > 0 && (\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleAddPayment(record)}\n                          className=\"text-green-600 hover:text-green-700\"\n                        >\n                          <CreditCard className=\"h-4 w-4\" />\n                        </Button>\n                      )}\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleEditRecord(record)}\n                      >\n                        <Edit className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleDeleteRecord(record._id)}\n                        className=\"text-red-600 hover:text-red-700\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </>\n                  )}\n                </div>\n              </div>\n\n              {/* Amount Summary */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600\">{t('billingList.totalAmount')}</p>\n                  <p className=\"text-lg font-semibold text-gray-900\">\n                    {t('common.currency')}{record.totalAmount.toFixed(2)}\n                  </p>\n                </div>\n                <div className=\"text-center p-3 bg-green-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600\">{t('billingList.paidAmount')}</p>\n                  <p className=\"text-lg font-semibold text-green-600\">\n                    {t('common.currency')}{record.paidAmount.toFixed(2)}\n                  </p>\n                </div>\n                <div className=\"text-center p-3 bg-red-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600\">{t('billingList.balance')}</p>\n                  <p className=\"text-lg font-semibold text-red-600\">\n                    {t('common.currency')}{record.balanceAmount.toFixed(2)}\n                  </p>\n                </div>\n                <div className=\"text-center p-3 bg-blue-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600\">{t('billingList.items')}</p>\n                  <p className=\"text-lg font-semibold text-blue-600\">\n                    {record.items.length}\n                  </p>\n                </div>\n              </div>\n\n              {/* Items Preview */}\n              <div>\n                <p className=\"text-sm text-gray-600 mb-2\">{t('billingList.items')}:</p>\n                <div className=\"space-y-1\">\n                  {record.items.slice(0, 3).map((item, index) => (\n                    <div key={index} className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-800\">\n                        {item.description} (x{item.quantity})\n                      </span>\n                      <span className=\"font-medium\">{t('common.currency')}{item.total.toFixed(2)}</span>\n                    </div>\n                  ))}\n                  {record.items.length > 3 && (\n                    <p className=\"text-sm text-gray-500\">\n                      +{record.items.length - 3} {t('billingList.moreItems')}\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              {/* Additional Info */}\n              <div className=\"flex justify-between items-center text-sm text-gray-600\">\n                <div className=\"flex items-center gap-4\">\n                  <span>{t('prescriptions.doctor', { firstName: record.dentist.firstName, lastName: record.dentist.lastName })}</span>\n                  <span>{t('common.separator')}</span>\n                  <span>{record.clinic.name}</span>\n                  {record.paymentMethod && (\n                    <>\n                      <span>{t('common.separator')}</span>\n                      <span>{record.paymentMethod}</span>\n                    </>\n                  )}\n                </div>\n                {record.paidDate && (\n                  <span>{t('billingList.paidOn')}: {format(new Date(record.paidDate), 'MMM dd, yyyy')}</span>\n                )}\n              </div>\n            </div>\n          </Card>\n        ))}\n      </div>\n\n      {/* Empty State */}\n      {billingRecords.length === 0 && (\n        <div className=\"text-center py-12\">\n          <DollarSign className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{t('billingList.noRecordsFound')}</h3>\n          <p className=\"text-gray-600 mb-4\">\n            {patientId \n              ? t('billingList.noPatientRecords')\n              : t('billingList.noFilteredRecords')}\n          </p>\n          {canManageBilling && (\n            <Button onClick={handleAddRecord}>\n              {t('billingList.createFirstInvoice')}\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex justify-center items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}\n            disabled={currentPage === 1}\n          >\n            {t('billingList.previous')}\n          </Button>\n          <span className=\"text-sm text-gray-600\">\n            {t('billingList.page')} {currentPage} / {totalPages}\n          </span>\n          <Button\n            variant=\"outline\"\n            onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}\n            disabled={currentPage === totalPages}\n          >\n            {t('billingList.next')}\n          </Button>\n        </div>\n      )}\n\n      {/* Form Modal */}\n      <Modal\n        isOpen={isFormModalOpen}\n        onClose={() => {\n          setIsFormModalOpen(false);\n          setEditingRecord(null);\n        }}\n        title={editingRecord ? t('billingList.editInvoice') : t('billingList.newInvoice')}\n        size=\"lg\"\n      >\n        <BillingForm\n          billingRecord={editingRecord}\n          patientId={patientId}\n          onSave={handleRecordSaved}\n          onCancel={() => {\n            setIsFormModalOpen(false);\n            setEditingRecord(null);\n          }}\n        />\n      </Modal>\n\n      {/* Details Modal */}\n      <Modal\n        isOpen={isDetailsModalOpen}\n        onClose={() => {\n          setIsDetailsModalOpen(false);\n          setViewingRecord(null);\n        }}\n        title={t('billingList.invoiceDetails')}\n        size=\"lg\"\n      >\n        {viewingRecord && (\n          <BillingDetails\n            billingRecord={viewingRecord}\n            onClose={() => {\n              setIsDetailsModalOpen(false);\n              setViewingRecord(null);\n            }}\n            onRefresh={fetchBillingRecords}\n          />\n        )}\n      </Modal>\n\n      {/* Payment Modal */}\n      <Modal\n        isOpen={isPaymentModalOpen}\n        onClose={() => {\n          setIsPaymentModalOpen(false);\n          setPaymentRecord(null);\n        }}\n        title={t('billingList.addPayment')}\n      >\n        {paymentRecord && (\n          <PaymentForm\n            billingRecord={paymentRecord}\n            onSave={handlePaymentAdded}\n            onCancel={() => {\n              setIsPaymentModalOpen(false);\n              setPaymentRecord(null);\n            }}\n          />\n        )}\n      </Modal>\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\billing\\PaymentForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\blog\\BlogSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\blog\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\charts\\BarChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":4,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[70,73],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[70,73],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\n\ninterface BarChartData {\n  [key: string]: any;\n}\n\ninterface BarChartProps {\n  data: BarChartData[];\n  xKey: string;\n  yKey: string;\n  xLabel?: string;\n  yLabel?: string;\n  className?: string;\n}\n\nconst BarChart: React.FC<BarChartProps> = ({\n  data,\n  xKey,\n  yKey,\n  xLabel,\n  yLabel,\n  className = ''\n}) => {\n  const maxValue = Math.max(...data.map(item => item[yKey]));\n  const chartHeight = 200;\n  const barWidth = 40;\n  const spacing = 10;\n  const chartWidth = data.length * (barWidth + spacing);\n\n  return (\n    <div className={`w-full h-full flex flex-col ${className}`}>\n      <div className=\"flex-1 flex items-end justify-center overflow-x-auto\">\n        <svg width={chartWidth} height={chartHeight} className=\"min-w-full\">\n          {data.map((item, index) => {\n            const barHeight = (item[yKey] / maxValue) * (chartHeight - 40);\n            const x = index * (barWidth + spacing);\n            const y = chartHeight - barHeight - 20;\n            \n            return (\n              <g key={index}>\n                <rect\n                  x={x}\n                  y={y}\n                  width={barWidth}\n                  height={barHeight}\n                  fill=\"#3B82F6\"\n                  className=\"hover:fill-blue-600 transition-colors\"\n                />\n                <text\n                  x={x + barWidth / 2}\n                  y={chartHeight - 5}\n                  textAnchor=\"middle\"\n                  className=\"text-xs fill-gray-600\"\n                >\n                  {item[xKey]}\n                </text>\n                <text\n                  x={x + barWidth / 2}\n                  y={y - 5}\n                  textAnchor=\"middle\"\n                  className=\"text-xs fill-gray-800 font-medium\"\n                >\n                  {item[yKey]}\n                </text>\n              </g>\n            );\n          })}\n        </svg>\n      </div>\n      {(xLabel || yLabel) && (\n        <div className=\"flex justify-between text-sm text-gray-600 mt-2\">\n          {xLabel && <span>{xLabel}</span>}\n          {yLabel && <span>{yLabel}</span>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default BarChart;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\charts\\LineChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":4,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[71,74],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[71,74],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\n\ninterface LineChartData {\n  [key: string]: any;\n}\n\ninterface LineChartProps {\n  data: LineChartData[];\n  xKey: string;\n  yKey: string;\n  xLabel?: string;\n  yLabel?: string;\n  className?: string;\n}\n\nconst LineChart: React.FC<LineChartProps> = ({\n  data,\n  xKey,\n  yKey,\n  xLabel,\n  yLabel,\n  className = ''\n}) => {\n  const maxValue = Math.max(...data.map(item => item[yKey]));\n  const minValue = Math.min(...data.map(item => item[yKey]));\n  const chartHeight = 200;\n  const chartWidth = 400;\n  const padding = 40;\n  \n  const getX = (index: number) => {\n    return padding + (index / (data.length - 1)) * (chartWidth - 2 * padding);\n  };\n  \n  const getY = (value: number) => {\n    const range = maxValue - minValue;\n    const normalizedValue = range === 0 ? 0.5 : (value - minValue) / range;\n    return chartHeight - padding - normalizedValue * (chartHeight - 2 * padding);\n  };\n  \n  const pathData = data.map((item, index) => {\n    const x = getX(index);\n    const y = getY(item[yKey]);\n    return `${index === 0 ? 'M' : 'L'} ${x} ${y}`;\n  }).join(' ');\n\n  return (\n    <div className={`w-full h-full flex flex-col ${className}`}>\n      <div className=\"flex-1 flex items-center justify-center\">\n        <svg width={chartWidth} height={chartHeight} className=\"w-full h-full\">\n          {/* Grid lines */}\n          <defs>\n            <pattern id=\"grid\" width=\"40\" height=\"40\" patternUnits=\"userSpaceOnUse\">\n              <path d=\"M 40 0 L 0 0 0 40\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"1\"/>\n            </pattern>\n          </defs>\n          <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\" opacity=\"0.3\" />\n          \n          {/* Line */}\n          <path\n            d={pathData}\n            fill=\"none\"\n            stroke=\"#3B82F6\"\n            strokeWidth=\"2\"\n            className=\"drop-shadow-sm\"\n          />\n          \n          {/* Data points */}\n          {data.map((item, index) => {\n            const x = getX(index);\n            const y = getY(item[yKey]);\n            \n            return (\n              <g key={index}>\n                <circle\n                  cx={x}\n                  cy={y}\n                  r=\"4\"\n                  fill=\"#3B82F6\"\n                  className=\"hover:fill-blue-600 transition-colors cursor-pointer\"\n                />\n                <title>{`${item[xKey]}: ${item[yKey]}`}</title>\n              </g>\n            );\n          })}\n          \n          {/* Y-axis labels */}\n          <text x=\"10\" y={getY(maxValue)} className=\"text-xs fill-gray-600\" dominantBaseline=\"middle\">\n            {maxValue}\n          </text>\n          <text x=\"10\" y={getY(minValue)} className=\"text-xs fill-gray-600\" dominantBaseline=\"middle\">\n            {minValue}\n          </text>\n        </svg>\n      </div>\n      {(xLabel || yLabel) && (\n        <div className=\"flex justify-between text-sm text-gray-600 mt-2\">\n          {xLabel && <span>{xLabel}</span>}\n          {yLabel && <span>{yLabel}</span>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LineChart;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\charts\\PieChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\charts\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\clinic\\ClinicCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\clinic\\ClinicSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\clinic\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\AppointmentCTA.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\DataTable.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":8,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[195,198],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[195,198],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[919,922],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[919,922],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button, Spinner } from '../ui';\n\nexport interface Column<T> {\n  key: keyof T | string;\n  title: string;\n  sortable?: boolean;\n  render?: (value: any, record: T, index: number) => React.ReactNode;\n  width?: string;\n  align?: 'left' | 'center' | 'right';\n}\n\nexport interface DataTableProps<T> {\n  columns: Column<T>[];\n  data: T[];\n  loading?: boolean;\n  pagination?: {\n    current: number;\n    pageSize: number;\n    total: number;\n    onChange: (page: number, pageSize: number) => void;\n  };\n  onSort?: (key: string, direction: 'asc' | 'desc') => void;\n  rowKey?: keyof T | ((record: T) => string);\n  emptyText?: string;\n  className?: string;\n  rowClassName?: (record: T, index: number) => string;\n  onRowClick?: (record: T, index: number) => void;\n}\n\ntype SortState = {\n  key: string;\n  direction: 'asc' | 'desc';\n} | null;\n\nfunction DataTable<T extends Record<string, any>>({\n  columns,\n  data,\n  loading = false,\n  pagination,\n  onSort,\n  rowKey = 'id',\n  emptyText = 'No data available',\n  className = '',\n  rowClassName,\n  onRowClick\n}: DataTableProps<T>) {\n  const [sortState, setSortState] = useState<SortState>(null);\n\n  const getRowKey = (record: T, index: number): string => {\n    if (typeof rowKey === 'function') {\n      return rowKey(record);\n    }\n    return record[rowKey] || index.toString();\n  };\n\n  const handleSort = (column: Column<T>) => {\n    if (!column.sortable) return;\n\n    const key = column.key as string;\n    let direction: 'asc' | 'desc' = 'asc';\n\n    if (sortState && sortState.key === key && sortState.direction === 'asc') {\n      direction = 'desc';\n    }\n\n    const newSortState = { key, direction };\n    setSortState(newSortState);\n\n    if (onSort) {\n      onSort(key, direction);\n    }\n  };\n\n  const renderSortIcon = (column: Column<T>) => {\n    if (!column.sortable) return null;\n\n    const key = column.key as string;\n    const isActive = sortState?.key === key;\n    const direction = sortState?.direction;\n\n    return (\n      <span className=\"ml-1 inline-flex flex-col\">\n        <svg \n          className={`w-3 h-3 ${isActive && direction === 'asc' ? 'text-blue-600' : 'text-gray-400'}`}\n          fill=\"currentColor\" \n          viewBox=\"0 0 20 20\"\n        >\n          <path fillRule=\"evenodd\" d=\"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z\" clipRule=\"evenodd\" />\n        </svg>\n        <svg \n          className={`w-3 h-3 -mt-1 ${isActive && direction === 'desc' ? 'text-blue-600' : 'text-gray-400'}`}\n          fill=\"currentColor\" \n          viewBox=\"0 0 20 20\"\n        >\n          <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n        </svg>\n      </span>\n    );\n  };\n\n  const renderCell = (column: Column<T>, record: T, index: number) => {\n    const value = record[column.key as keyof T];\n    \n    if (column.render) {\n      return column.render(value, record, index);\n    }\n    \n    return value;\n  };\n\n  const renderPagination = () => {\n    if (!pagination) return null;\n\n    const { current, pageSize, total, onChange } = pagination;\n    const totalPages = Math.ceil(total / pageSize);\n    const startItem = (current - 1) * pageSize + 1;\n    const endItem = Math.min(current * pageSize, total);\n\n    return (\n      <div className=\"flex items-center justify-between px-6 py-3 bg-white border-t border-gray-200\">\n        <div className=\"flex items-center text-sm text-gray-700\">\n          Showing {startItem} to {endItem} of {total} results\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => onChange(current - 1, pageSize)}\n            disabled={current <= 1}\n          >\n            Previous\n          </Button>\n          \n          {/* Page numbers */}\n          <div className=\"flex items-center space-x-1\">\n            {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n              let pageNum;\n              if (totalPages <= 5) {\n                pageNum = i + 1;\n              } else if (current <= 3) {\n                pageNum = i + 1;\n              } else if (current >= totalPages - 2) {\n                pageNum = totalPages - 4 + i;\n              } else {\n                pageNum = current - 2 + i;\n              }\n              \n              return (\n                <Button\n                  key={pageNum}\n                  variant={current === pageNum ? \"primary\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => onChange(pageNum, pageSize)}\n                  className=\"w-8 h-8 p-0\"\n                >\n                  {pageNum}\n                </Button>\n              );\n            })}\n          </div>\n          \n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => onChange(current + 1, pageSize)}\n            disabled={current >= totalPages}\n          >\n            Next\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`bg-white shadow rounded-lg overflow-hidden ${className}`}>\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              {columns.map((column, index) => (\n                <th\n                  key={index}\n                  className={`\n                    px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider\n                    ${column.align === 'center' ? 'text-center' : column.align === 'right' ? 'text-right' : 'text-left'}\n                    ${column.sortable ? 'cursor-pointer hover:bg-gray-100 select-none' : ''}\n                  `}\n                  style={{ width: column.width }}\n                  onClick={() => handleSort(column)}\n                >\n                  <div className=\"flex items-center\">\n                    {column.title}\n                    {renderSortIcon(column)}\n                  </div>\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {loading ? (\n              <tr>\n                <td colSpan={columns.length} className=\"px-6 py-12 text-center\">\n                  <div className=\"flex items-center justify-center\">\n                    <Spinner size=\"md\" />\n                    <span className=\"ml-2 text-gray-500\">Loading...</span>\n                  </div>\n                </td>\n              </tr>\n            ) : data.length === 0 ? (\n              <tr>\n                <td colSpan={columns.length} className=\"px-6 py-12 text-center text-gray-500\">\n                  {emptyText}\n                </td>\n              </tr>\n            ) : (\n              data.map((record, index) => {\n                const key = getRowKey(record, index);\n                const className = rowClassName ? rowClassName(record, index) : '';\n                \n                return (\n                  <tr\n                    key={key}\n                    className={`\n                      hover:bg-gray-50 transition-colors\n                      ${onRowClick ? 'cursor-pointer' : ''}\n                      ${className}\n                    `}\n                    onClick={() => onRowClick?.(record, index)}\n                  >\n                    {columns.map((column, colIndex) => (\n                      <td\n                        key={colIndex}\n                        className={`\n                          px-6 py-4 whitespace-nowrap text-sm text-gray-900\n                          ${column.align === 'center' ? 'text-center' : column.align === 'right' ? 'text-right' : 'text-left'}\n                        `}\n                      >\n                        {renderCell(column, record, index)}\n                      </td>\n                    ))}\n                  </tr>\n                );\n              })\n            )}\n          </tbody>\n        </table>\n      </div>\n      {renderPagination()}\n    </div>\n  );\n}\n\nexport default DataTable;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\ErrorMessage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\FilterPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":14,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[375,378],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[375,378],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[931,934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[931,934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button, Input, Select } from '../ui';\n\nexport interface FilterField {\n  key: string;\n  label: string;\n  type: 'text' | 'select' | 'date' | 'dateRange' | 'number' | 'numberRange';\n  options?: { value: string; label: string }[];\n  placeholder?: string;\n  multiple?: boolean;\n}\n\nexport interface FilterValues {\n  [key: string]: any;\n}\n\ninterface FilterPanelProps {\n  fields: FilterField[];\n  values: FilterValues;\n  onChange: (values: FilterValues) => void;\n  onApply?: () => void;\n  onReset?: () => void;\n  className?: string;\n  collapsible?: boolean;\n  defaultCollapsed?: boolean;\n}\n\nconst FilterPanel: React.FC<FilterPanelProps> = ({\n  fields,\n  values,\n  onChange,\n  onApply,\n  onReset,\n  className = '',\n  collapsible = true,\n  defaultCollapsed = false\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(defaultCollapsed);\n\n  const handleFieldChange = (key: string, value: any) => {\n    onChange({\n      ...values,\n      [key]: value\n    });\n  };\n\n  const handleReset = () => {\n    const resetValues: FilterValues = {};\n    fields.forEach(field => {\n      resetValues[field.key] = field.multiple ? [] : '';\n    });\n    onChange(resetValues);\n    if (onReset) {\n      onReset();\n    }\n  };\n\n  const renderField = (field: FilterField) => {\n    const value = values[field.key] || (field.multiple ? [] : '');\n\n    switch (field.type) {\n      case 'text':\n        return (\n          <Input\n            type=\"text\"\n            placeholder={field.placeholder}\n            value={value}\n            onChange={(e) => handleFieldChange(field.key, e.target.value)}\n          />\n        );\n\n      case 'select':\n        const selectOptions = field.options || [];\n        const optionsWithPlaceholder = field.placeholder \n          ? [{ value: '', label: field.placeholder }, ...selectOptions]\n          : selectOptions;\n        return (\n          <Select\n            options={optionsWithPlaceholder}\n            value={value}\n            onChange={(selectedValue) => handleFieldChange(field.key, selectedValue)}\n          />\n        );\n\n      case 'date':\n        return (\n          <Input\n            type=\"date\"\n            value={value}\n            onChange={(e) => handleFieldChange(field.key, e.target.value)}\n          />\n        );\n\n      case 'dateRange':\n        return (\n          <div className=\"grid grid-cols-2 gap-2\">\n            <Input\n              type=\"date\"\n              placeholder=\"From\"\n              value={value.from || ''}\n              onChange={(e) => handleFieldChange(field.key, { ...value, from: e.target.value })}\n            />\n            <Input\n              type=\"date\"\n              placeholder=\"To\"\n              value={value.to || ''}\n              onChange={(e) => handleFieldChange(field.key, { ...value, to: e.target.value })}\n            />\n          </div>\n        );\n\n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            placeholder={field.placeholder}\n            value={value}\n            onChange={(e) => handleFieldChange(field.key, e.target.value)}\n          />\n        );\n\n      case 'numberRange':\n        return (\n          <div className=\"grid grid-cols-2 gap-2\">\n            <Input\n              type=\"number\"\n              placeholder=\"Min\"\n              value={value.min || ''}\n              onChange={(e) => handleFieldChange(field.key, { ...value, min: e.target.value })}\n            />\n            <Input\n              type=\"number\"\n              placeholder=\"Max\"\n              value={value.max || ''}\n              onChange={(e) => handleFieldChange(field.key, { ...value, max: e.target.value })}\n            />\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  const hasActiveFilters = () => {\n    return fields.some(field => {\n      const value = values[field.key];\n      if (field.multiple) {\n        return Array.isArray(value) && value.length > 0;\n      }\n      if (field.type === 'dateRange' || field.type === 'numberRange') {\n        return value && (value.from || value.to || value.min || value.max);\n      }\n      return value && value !== '';\n    });\n  };\n\n  return (\n    <div className={`bg-white border border-gray-200 rounded-lg ${className}`}>\n      {/* Header */}\n      {collapsible ? (\n        <button\n          onClick={() => setIsCollapsed(!isCollapsed)}\n          className=\"w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 transition-colors\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <svg className=\"w-5 h-5 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z\" />\n            </svg>\n            <span className=\"font-medium text-gray-900\">Filters</span>\n            {hasActiveFilters() && (\n              <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                Active\n              </span>\n            )}\n          </div>\n          <svg \n            className={`w-5 h-5 text-gray-400 transition-transform ${\n              isCollapsed ? '' : 'transform rotate-180'\n            }`} \n            fill=\"none\" \n            stroke=\"currentColor\" \n            viewBox=\"0 0 24 24\"\n          >\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n      ) : (\n        <div className=\"p-4 border-b border-gray-200\">\n          <div className=\"flex items-center gap-2\">\n            <svg className=\"w-5 h-5 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z\" />\n            </svg>\n            <span className=\"font-medium text-gray-900\">Filters</span>\n            {hasActiveFilters() && (\n              <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                Active\n              </span>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Filter Fields */}\n      {(!collapsible || !isCollapsed) && (\n        <div className=\"p-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {fields.map((field) => (\n              <div key={field.key} className=\"space-y-2\">\n                <label className=\"block text-sm font-medium text-gray-700\">\n                  {field.label}\n                </label>\n                {renderField(field)}\n              </div>\n            ))}\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex items-center justify-end gap-3 mt-6 pt-4 border-t border-gray-200\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleReset}\n              disabled={!hasActiveFilters()}\n            >\n              Reset\n            </Button>\n            {onApply && (\n              <Button\n                variant=\"primary\"\n                size=\"sm\"\n                onClick={onApply}\n              >\n                Apply Filters\n              </Button>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FilterPanel;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\LanguageSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\NotificationCenter.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchNotifications'. Either include it or remove the dependency array.","line":39,"column":6,"nodeType":"ArrayExpression","endLine":39,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, filter, fetchNotifications]","fix":{"range":[1172,1188],"text":"[isOpen, filter, fetchNotifications]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Bell, X, Check, CheckCheck, Trash2, Calendar, FileText, AlertCircle, MessageSquare, Info } from 'lucide-react';\nimport api from '../../services/api';\nimport { toast } from 'react-hot-toast';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface Notification {\n  _id: string;\n  userId: string;\n  type: 'appointment' | 'prescription' | 'message' | 'cancellation' | 'reminder' | 'system';\n  title: string;\n  message: string;\n  read: boolean;\n  createdAt: string;\n  data?: {\n    appointmentId?: string;\n    prescriptionId?: string;\n    messageId?: string;\n    actionUrl?: string;\n  };\n}\n\ninterface NotificationCenterProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst NotificationCenter: React.FC<NotificationCenterProps> = ({ isOpen, onClose }) => {\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState<'all' | 'unread'>('all');\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(true);\n\n  useEffect(() => {\n    if (isOpen) {\n      fetchNotifications();\n    }\n  }, [isOpen, filter]);\n\n  const fetchNotifications = async (pageNum: number = 1) => {\n    try {\n      setLoading(true);\n      const response = await api.get('/notifications', {\n        params: {\n          page: pageNum,\n          limit: 20,\n          unreadOnly: filter === 'unread'\n        }\n      });\n\n      if (response.data.success) {\n        const newNotifications = response.data.data.notifications || response.data.data;\n        if (pageNum === 1) {\n          setNotifications(newNotifications);\n        } else {\n          setNotifications(prev => [...prev, ...newNotifications]);\n        }\n        setHasMore(newNotifications.length === 20);\n        setPage(pageNum);\n      }\n    } catch (error) {\n      console.error('Failed to fetch notifications:', error);\n      toast.error('Failed to load notifications');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const markAsRead = async (notificationId: string) => {\n    try {\n      await api.patch(`/notifications/${notificationId}/read`);\n      setNotifications(prev =>\n        prev.map(n => n._id === notificationId ? { ...n, read: true } : n)\n      );\n    } catch (error) {\n      console.error('Failed to mark as read:', error);\n    }\n  };\n\n  const markAllAsRead = async () => {\n    try {\n      await api.patch('/notifications/mark-all-read');\n      setNotifications(prev => prev.map(n => ({ ...n, read: true })));\n      toast.success('All notifications marked as read');\n    } catch (error) {\n      console.error('Failed to mark all as read:', error);\n      toast.error('Failed to mark all as read');\n    }\n  };\n\n  const deleteNotification = async (notificationId: string) => {\n    try {\n      await api.delete(`/notifications/${notificationId}`);\n      setNotifications(prev => prev.filter(n => n._id !== notificationId));\n      toast.success('Notification deleted');\n    } catch (error) {\n      console.error('Failed to delete notification:', error);\n      toast.error('Failed to delete notification');\n    }\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case 'appointment':\n        return <Calendar className=\"w-5 h-5 text-blue-600\" />;\n      case 'prescription':\n        return <FileText className=\"w-5 h-5 text-green-600\" />;\n      case 'message':\n        return <MessageSquare className=\"w-5 h-5 text-purple-600\" />;\n      case 'cancellation':\n        return <AlertCircle className=\"w-5 h-5 text-red-600\" />;\n      case 'reminder':\n        return <Bell className=\"w-5 h-5 text-orange-600\" />;\n      case 'system':\n        return <Info className=\"w-5 h-5 text-gray-600\" />;\n      default:\n        return <Bell className=\"w-5 h-5 text-gray-600\" />;\n    }\n  };\n\n  const getNotificationColor = (type: string) => {\n    switch (type) {\n      case 'appointment':\n        return 'bg-blue-50 border-blue-200';\n      case 'prescription':\n        return 'bg-green-50 border-green-200';\n      case 'message':\n        return 'bg-purple-50 border-purple-200';\n      case 'cancellation':\n        return 'bg-red-50 border-red-200';\n      case 'reminder':\n        return 'bg-orange-50 border-orange-200';\n      case 'system':\n        return 'bg-gray-50 border-gray-200';\n      default:\n        return 'bg-gray-50 border-gray-200';\n    }\n  };\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.read) {\n      markAsRead(notification._id);\n    }\n\n    if (notification.data?.actionUrl) {\n      window.location.href = notification.data.actionUrl;\n      onClose();\n    }\n  };\n\n  const unreadCount = notifications.filter(n => !n.read).length;\n\n  if (!isOpen) return null;\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div\n        className=\"fixed inset-0 bg-black bg-opacity-25 z-40\"\n        onClick={onClose}\n      />\n\n      {/* Notification Panel */}\n      <div className=\"fixed right-0 top-0 h-full w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n          <div className=\"flex items-center\">\n            <Bell className=\"w-6 h-6 text-blue-600 mr-2\" />\n            <h2 className=\"text-xl font-semibold text-gray-900\">\n              Notifications\n              {unreadCount > 0 && (\n                <span className=\"ml-2 px-2 py-0.5 text-xs bg-red-500 text-white rounded-full\">\n                  {unreadCount}\n                </span>\n              )}\n            </h2>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        </div>\n\n        {/* Filter Tabs */}\n        <div className=\"flex border-b border-gray-200\">\n          <button\n            onClick={() => setFilter('all')}\n            className={`flex-1 px-4 py-3 text-sm font-medium transition-colors ${\n              filter === 'all'\n                ? 'text-blue-600 border-b-2 border-blue-600'\n                : 'text-gray-600 hover:text-gray-900'\n            }`}\n          >\n            All\n          </button>\n          <button\n            onClick={() => setFilter('unread')}\n            className={`flex-1 px-4 py-3 text-sm font-medium transition-colors ${\n              filter === 'unread'\n                ? 'text-blue-600 border-b-2 border-blue-600'\n                : 'text-gray-600 hover:text-gray-900'\n            }`}\n          >\n            Unread {unreadCount > 0 && `(${unreadCount})`}\n          </button>\n        </div>\n\n        {/* Actions Bar */}\n        {notifications.length > 0 && unreadCount > 0 && (\n          <div className=\"flex items-center justify-end p-3 border-b border-gray-200 bg-gray-50\">\n            <button\n              onClick={markAllAsRead}\n              className=\"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center\"\n            >\n              <CheckCheck className=\"w-4 h-4 mr-1\" />\n              Mark all as read\n            </button>\n          </div>\n        )}\n\n        {/* Notifications List */}\n        <div className=\"flex-1 overflow-y-auto\">\n          {loading && notifications.length === 0 ? (\n            <div className=\"flex items-center justify-center h-full\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center h-full text-gray-500\">\n              <Bell className=\"w-16 h-16 text-gray-300 mb-4\" />\n              <p className=\"text-lg font-medium\">No notifications</p>\n              <p className=\"text-sm\">You're all caught up!</p>\n            </div>\n          ) : (\n            <div className=\"divide-y divide-gray-200\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification._id}\n                  className={`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${\n                    !notification.read ? 'bg-blue-50/50' : ''\n                  }`}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  <div className=\"flex items-start\">\n                    <div className={`w-10 h-10 rounded-full flex items-center justify-center mr-3 flex-shrink-0 ${getNotificationColor(notification.type)}`}>\n                      {getNotificationIcon(notification.type)}\n                    </div>\n\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <h3 className={`text-sm font-semibold ${\n                            !notification.read ? 'text-gray-900' : 'text-gray-700'\n                          }`}>\n                            {notification.title}\n                          </h3>\n                          <p className=\"text-sm text-gray-600 mt-1\">\n                            {notification.message}\n                          </p>\n                          <p className=\"text-xs text-gray-400 mt-2\">\n                            {formatDistanceToNow(new Date(notification.createdAt), { addSuffix: true })}\n                          </p>\n                        </div>\n\n                        <div className=\"flex items-center ml-2\">\n                          {!notification.read && (\n                            <div className=\"w-2 h-2 bg-blue-600 rounded-full mr-2\"></div>\n                          )}\n                          <button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              deleteNotification(notification._id);\n                            }}\n                            className=\"p-1 hover:bg-gray-200 rounded transition-colors\"\n                            title=\"Delete notification\"\n                          >\n                            <Trash2 className=\"w-4 h-4 text-gray-400 hover:text-red-600\" />\n                          </button>\n                        </div>\n                      </div>\n\n                      {!notification.read && (\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            markAsRead(notification._id);\n                          }}\n                          className=\"text-xs text-blue-600 hover:text-blue-700 mt-2 flex items-center\"\n                        >\n                          <Check className=\"w-3 h-3 mr-1\" />\n                          Mark as read\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Load More */}\n          {hasMore && notifications.length > 0 && (\n            <div className=\"p-4 text-center\">\n              <button\n                onClick={() => fetchNotifications(page + 1)}\n                disabled={loading}\n                className=\"text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50\"\n              >\n                {loading ? 'Loading...' : 'Load more'}\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default NotificationCenter;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\SearchBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\StatsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\common\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\dashboard\\AnalyticsWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\dashboard\\DashboardCustomizer.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5115,5118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5115,5118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback } from 'react';\nimport { Button, Badge } from '../ui';\nimport {\n  Settings,\n  Layout,\n  Eye,\n  EyeOff,\n  Move,\n  Palette,\n  Save,\n  RotateCcw,\n  Grid,\n  X,\n  ChevronDown,\n  ChevronUp\n} from 'lucide-react';\n\nexport interface DashboardWidget {\n  id: string;\n  type: 'metric' | 'chart' | 'table' | 'feed' | 'calendar' | 'quick-actions';\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n  size: 'small' | 'medium' | 'large' | 'full';\n  position: { x: number; y: number };\n  visible: boolean;\n  configurable: boolean;\n  required?: boolean;\n}\n\nexport interface DashboardTheme {\n  id: string;\n  name: string;\n  primary: string;\n  secondary: string;\n  accent: string;\n  background: string;\n  preview: string;\n}\n\ninterface DashboardCustomizerProps {\n  widgets: DashboardWidget[];\n  currentTheme: string;\n  themes: DashboardTheme[];\n  onWidgetToggle: (widgetId: string) => void;\n  onWidgetReorder: (widgets: DashboardWidget[]) => void;\n  onThemeChange: (themeId: string) => void;\n  onSave: () => void;\n  onReset: () => void;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst DashboardCustomizer: React.FC<DashboardCustomizerProps> = ({\n  widgets,\n  currentTheme,\n  themes,\n  onWidgetToggle,\n  onWidgetReorder,\n  onThemeChange,\n  onSave,\n  onReset,\n  isOpen,\n  onClose\n}) => {\n  const [activeTab, setActiveTab] = useState<'layout' | 'widgets' | 'themes'>('layout');\n  const [draggedWidget, setDraggedWidget] = useState<string | null>(null);\n  const [expandedSections, setExpandedSections] = useState<Set<string>>(new Set(['visible']));\n\n  const toggleSection = useCallback((section: string) => {\n    setExpandedSections(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(section)) {\n        newSet.delete(section);\n      } else {\n        newSet.add(section);\n      }\n      return newSet;\n    });\n  }, []);\n\n  const handleDragStart = useCallback((e: React.DragEvent, widgetId: string) => {\n    setDraggedWidget(widgetId);\n    e.dataTransfer.effectAllowed = 'move';\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent, targetWidgetId: string) => {\n    e.preventDefault();\n    if (!draggedWidget || draggedWidget === targetWidgetId) return;\n\n    const draggedIndex = widgets.findIndex(w => w.id === draggedWidget);\n    const targetIndex = widgets.findIndex(w => w.id === targetWidgetId);\n\n    if (draggedIndex === -1 || targetIndex === -1) return;\n\n    const newWidgets = [...widgets];\n    const [draggedItem] = newWidgets.splice(draggedIndex, 1);\n    newWidgets.splice(targetIndex, 0, draggedItem);\n\n    onWidgetReorder(newWidgets);\n    setDraggedWidget(null);\n  }, [draggedWidget, widgets, onWidgetReorder]);\n\n  const getSizeLabel = (size: string) => {\n    switch (size) {\n      case 'small': return '1/4';\n      case 'medium': return '1/2';\n      case 'large': return '3/4';\n      case 'full': return 'Full';\n      default: return size;\n    }\n  };\n\n  const getSizeColor = (size: string) => {\n    switch (size) {\n      case 'small': return 'bg-blue-100 text-blue-700';\n      case 'medium': return 'bg-green-100 text-green-700';\n      case 'large': return 'bg-orange-100 text-orange-700';\n      case 'full': return 'bg-purple-100 text-purple-700';\n      default: return 'bg-gray-100 text-gray-700';\n    }\n  };\n\n  const visibleWidgets = widgets.filter(w => w.visible);\n  const hiddenWidgets = widgets.filter(w => !w.visible);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg\">\n              <Settings className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-bold text-gray-900\">Dashboard Customization</h2>\n              <p className=\"text-sm text-gray-600\">Personalize your dashboard layout and appearance</p>\n            </div>\n          </div>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"flex border-b border-gray-200\">\n          {[\n            { id: 'layout', label: 'Layout', icon: Layout },\n            { id: 'widgets', label: 'Widgets', icon: Grid },\n            { id: 'themes', label: 'Themes', icon: Palette }\n          ].map(tab => {\n            const IconComponent = tab.icon;\n            return (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id as any)}\n                className={`flex items-center space-x-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors ${\n                  activeTab === tab.id\n                    ? 'border-blue-500 text-blue-600 bg-blue-50'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50'\n                }`}\n              >\n                <IconComponent className=\"w-4 h-4\" />\n                <span>{tab.label}</span>\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 max-h-[60vh] overflow-y-auto\">\n          {activeTab === 'layout' && (\n            <div className=\"space-y-6\">\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Widget Layout</h3>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  Drag and drop widgets to reorder them on your dashboard.\n                </p>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {visibleWidgets.map((widget) => (\n                    <div\n                      key={widget.id}\n                      draggable\n                      onDragStart={(e) => handleDragStart(e, widget.id)}\n                      onDragOver={handleDragOver}\n                      onDrop={(e) => handleDrop(e, widget.id)}\n                      className={`p-4 border-2 border-dashed rounded-lg cursor-move transition-all ${\n                        draggedWidget === widget.id\n                          ? 'border-blue-500 bg-blue-50 opacity-50'\n                          : 'border-gray-200 hover:border-gray-300 bg-white'\n                      }`}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-3\">\n                          <Move className=\"w-4 h-4 text-gray-400\" />\n                          <div className=\"text-gray-600\">{widget.icon}</div>\n                          <div>\n                            <h4 className=\"font-medium text-gray-900\">{widget.title}</h4>\n                            <p className=\"text-xs text-gray-500\">{widget.description}</p>\n                          </div>\n                        </div>\n                        <Badge className={`text-xs ${getSizeColor(widget.size)}`}>\n                          {getSizeLabel(widget.size)}\n                        </Badge>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {activeTab === 'widgets' && (\n            <div className=\"space-y-6\">\n              {/* Visible Widgets */}\n              <div>\n                <button\n                  onClick={() => toggleSection('visible')}\n                  className=\"flex items-center justify-between w-full text-left\"\n                >\n                  <h3 className=\"text-lg font-semibold text-gray-900 flex items-center space-x-2\">\n                    <span>Visible Widgets</span>\n                    <Badge className=\"bg-green-100 text-green-700\">{visibleWidgets.length}</Badge>\n                  </h3>\n                  {expandedSections.has('visible') ? (\n                    <ChevronUp className=\"w-5 h-5 text-gray-500\" />\n                  ) : (\n                    <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n                  )}\n                </button>\n                \n                {expandedSections.has('visible') && (\n                  <div className=\"mt-4 space-y-2\">\n                    {visibleWidgets.map((widget) => (\n                      <div\n                        key={widget.id}\n                        className=\"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg\"\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <div className=\"text-green-600\">{widget.icon}</div>\n                          <div>\n                            <h4 className=\"font-medium text-gray-900\">{widget.title}</h4>\n                            <p className=\"text-xs text-gray-500\">{widget.description}</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          <Badge className={`text-xs ${getSizeColor(widget.size)}`}>\n                            {getSizeLabel(widget.size)}\n                          </Badge>\n                          {!widget.required && (\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => onWidgetToggle(widget.id)}\n                              className=\"text-xs px-2 py-1\"\n                            >\n                              <EyeOff className=\"w-3 h-3\" />\n                            </Button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Hidden Widgets */}\n              {hiddenWidgets.length > 0 && (\n                <div>\n                  <button\n                    onClick={() => toggleSection('hidden')}\n                    className=\"flex items-center justify-between w-full text-left\"\n                  >\n                    <h3 className=\"text-lg font-semibold text-gray-900 flex items-center space-x-2\">\n                      <span>Hidden Widgets</span>\n                      <Badge className=\"bg-gray-100 text-gray-700\">{hiddenWidgets.length}</Badge>\n                    </h3>\n                    {expandedSections.has('hidden') ? (\n                      <ChevronUp className=\"w-5 h-5 text-gray-500\" />\n                    ) : (\n                      <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n                    )}\n                  </button>\n                  \n                  {expandedSections.has('hidden') && (\n                    <div className=\"mt-4 space-y-2\">\n                      {hiddenWidgets.map((widget) => (\n                        <div\n                          key={widget.id}\n                          className=\"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg opacity-60\"\n                        >\n                          <div className=\"flex items-center space-x-3\">\n                            <div className=\"text-gray-400\">{widget.icon}</div>\n                            <div>\n                              <h4 className=\"font-medium text-gray-700\">{widget.title}</h4>\n                              <p className=\"text-xs text-gray-500\">{widget.description}</p>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center space-x-2\">\n                            <Badge className={`text-xs ${getSizeColor(widget.size)}`}>\n                              {getSizeLabel(widget.size)}\n                            </Badge>\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => onWidgetToggle(widget.id)}\n                              className=\"text-xs px-2 py-1\"\n                            >\n                              <Eye className=\"w-3 h-3\" />\n                            </Button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'themes' && (\n            <div className=\"space-y-6\">\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Color Themes</h3>\n                <p className=\"text-sm text-gray-600 mb-6\">\n                  Choose a color theme that matches your preference.\n                </p>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {themes.map((theme) => (\n                    <div\n                      key={theme.id}\n                      onClick={() => onThemeChange(theme.id)}\n                      className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${\n                        currentTheme === theme.id\n                          ? 'border-blue-500 bg-blue-50'\n                          : 'border-gray-200 hover:border-gray-300 bg-white'\n                      }`}\n                    >\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <h4 className=\"font-medium text-gray-900\">{theme.name}</h4>\n                        {currentTheme === theme.id && (\n                          <Badge className=\"bg-blue-100 text-blue-700 text-xs\">Active</Badge>\n                        )}\n                      </div>\n                      \n                      {/* Theme Preview */}\n                      <div className=\"flex space-x-2 mb-3\">\n                        <div \n                          className=\"w-8 h-8 rounded-full border-2 border-white shadow-sm\"\n                          style={{ backgroundColor: theme.primary }}\n                        />\n                        <div \n                          className=\"w-8 h-8 rounded-full border-2 border-white shadow-sm\"\n                          style={{ backgroundColor: theme.secondary }}\n                        />\n                        <div \n                          className=\"w-8 h-8 rounded-full border-2 border-white shadow-sm\"\n                          style={{ backgroundColor: theme.accent }}\n                        />\n                      </div>\n                      \n                      {/* Mini Dashboard Preview */}\n                      <div \n                        className=\"h-16 rounded border p-2\"\n                        style={{ backgroundColor: theme.background }}\n                      >\n                        <div className=\"flex space-x-1 mb-2\">\n                          <div \n                            className=\"w-4 h-2 rounded\"\n                            style={{ backgroundColor: theme.primary }}\n                          />\n                          <div \n                            className=\"w-6 h-2 rounded\"\n                            style={{ backgroundColor: theme.secondary }}\n                          />\n                          <div \n                            className=\"w-3 h-2 rounded\"\n                            style={{ backgroundColor: theme.accent }}\n                          />\n                        </div>\n                        <div className=\"flex space-x-1\">\n                          <div \n                            className=\"w-8 h-6 rounded\"\n                            style={{ backgroundColor: theme.primary, opacity: 0.3 }}\n                          />\n                          <div \n                            className=\"w-8 h-6 rounded\"\n                            style={{ backgroundColor: theme.secondary, opacity: 0.3 }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50\">\n          <Button\n            variant=\"outline\"\n            onClick={onReset}\n            className=\"flex items-center space-x-2\"\n          >\n            <RotateCcw className=\"w-4 h-4\" />\n            <span>Reset to Default</span>\n          </Button>\n          \n          <div className=\"flex items-center space-x-3\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n            >\n              Cancel\n            </Button>\n            <Button\n              variant=\"primary\"\n              onClick={() => {\n                onSave();\n                onClose();\n              }}\n              className=\"flex items-center space-x-2\"\n            >\n              <Save className=\"w-4 h-4\" />\n              <span>Save Changes</span>\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default DashboardCustomizer;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\dashboard\\NotificationFeed.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":173,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5459,5462],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5459,5462],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, Button, Badge } from '../ui';\nimport {\n  Bell,\n  Calendar,\n  Users,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  X,\n  Settings,\n  Filter,\n  Trash2,\n  User,\n  CreditCard,\n  ChevronRight\n} from 'lucide-react';\n\nexport interface Notification {\n  id: string;\n  type: 'appointment' | 'patient' | 'payment' | 'system' | 'reminder' | 'alert';\n  title: string;\n  message: string;\n  timestamp: Date;\n  read: boolean;\n  priority: 'low' | 'medium' | 'high' | 'urgent';\n  actionUrl?: string;\n  actionLabel?: string;\n  metadata?: {\n    patientName?: string;\n    appointmentTime?: string;\n    amount?: number;\n    clinicName?: string;\n  };\n}\n\ninterface NotificationFeedProps {\n  notifications: Notification[];\n  onMarkAsRead: (id: string) => void;\n  onMarkAllAsRead: () => void;\n  onDelete: (id: string) => void;\n  onClearAll: () => void;\n  loading?: boolean;\n  maxHeight?: string;\n  showFilters?: boolean;\n}\n\nconst NotificationFeed: React.FC<NotificationFeedProps> = ({\n  notifications,\n  onMarkAsRead,\n  onMarkAllAsRead,\n  onDelete,\n  onClearAll,\n  loading = false,\n  maxHeight = 'max-h-96',\n  showFilters = true\n}) => {\n  const [filter, setFilter] = useState<'all' | 'unread' | 'urgent'>('all');\n  const [typeFilter, setTypeFilter] = useState<string>('all');\n\n  const getNotificationIcon = (type: string, priority: string) => {\n    const iconClass = `w-5 h-5 ${\n      priority === 'urgent' ? 'text-red-500' : \n      priority === 'high' ? 'text-orange-500' : \n      priority === 'medium' ? 'text-blue-500' : 'text-gray-500'\n    }`;\n\n    switch (type) {\n      case 'appointment':\n        return <Calendar className={iconClass} />;\n      case 'patient':\n        return <Users className={iconClass} />;\n      case 'payment':\n        return <CreditCard className={iconClass} />;\n      case 'system':\n        return <Settings className={iconClass} />;\n      case 'reminder':\n        return <Clock className={iconClass} />;\n      case 'alert':\n        return <AlertCircle className={iconClass} />;\n      default:\n        return <Bell className={iconClass} />;\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'urgent':\n        return 'bg-red-100 text-red-800 border-red-200';\n      case 'high':\n        return 'bg-orange-100 text-orange-800 border-orange-200';\n      case 'medium':\n        return 'bg-blue-100 text-blue-800 border-blue-200';\n      default:\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const formatTimeAgo = (timestamp: Date): string => {\n    const now = new Date();\n    const diffInMinutes = Math.floor((now.getTime() - timestamp.getTime()) / (1000 * 60));\n\n    if (diffInMinutes < 1) return 'Just now';\n    if (diffInMinutes < 60) return `${diffInMinutes}m ago`;\n    if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}h ago`;\n    return `${Math.floor(diffInMinutes / 1440)}d ago`;\n  };\n\n  const filteredNotifications = notifications.filter(notification => {\n    if (filter === 'unread' && notification.read) return false;\n    if (filter === 'urgent' && notification.priority !== 'urgent') return false;\n    if (typeFilter !== 'all' && notification.type !== typeFilter) return false;\n    return true;\n  });\n\n  const unreadCount = notifications.filter(n => !n.read).length;\n\n  return (\n    <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-gray-50/50\">\n      <div className=\"p-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"relative\">\n              <Bell className=\"w-5 h-5 text-blue-600\" />\n              {unreadCount > 0 && (\n                <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white animate-pulse\"></div>\n              )}\n            </div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">\n              Notifications\n              {unreadCount > 0 && (\n                <Badge className=\"ml-2 bg-red-100 text-red-700 text-xs\">\n                  {unreadCount} new\n                </Badge>\n              )}\n            </h3>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            {unreadCount > 0 && (\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={onMarkAllAsRead}\n                className=\"text-xs\"\n              >\n                Mark all read\n              </Button>\n            )}\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={onClearAll}\n              className=\"text-xs text-red-600 hover:text-red-700\"\n            >\n              <Trash2 className=\"w-3 h-3 mr-1\" />\n              Clear all\n            </Button>\n          </div>\n        </div>\n\n        {/* Filters */}\n        {showFilters && (\n          <div className=\"flex flex-wrap gap-2 mb-4 pb-4 border-b border-gray-100\">\n            <div className=\"flex items-center space-x-2\">\n              <Filter className=\"w-4 h-4 text-gray-500\" />\n              <div className=\"flex space-x-1\">\n                {['all', 'unread', 'urgent'].map((filterOption) => (\n                  <Button\n                    key={filterOption}\n                    variant={filter === filterOption ? 'primary' : 'outline'}\n                    size=\"sm\"\n                    onClick={() => setFilter(filterOption as any)}\n                    className=\"text-xs capitalize\"\n                  >\n                    {filterOption}\n                  </Button>\n                ))}\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-1\">\n              <select\n                value={typeFilter}\n                onChange={(e) => setTypeFilter(e.target.value)}\n                className=\"text-xs border border-gray-200 rounded px-2 py-1 focus:border-blue-500 focus:ring-1 focus:ring-blue-500\"\n              >\n                <option value=\"all\">All types</option>\n                <option value=\"appointment\">Appointments</option>\n                <option value=\"patient\">Patients</option>\n                <option value=\"payment\">Payments</option>\n                <option value=\"system\">System</option>\n                <option value=\"reminder\">Reminders</option>\n                <option value=\"alert\">Alerts</option>\n              </select>\n            </div>\n          </div>\n        )}\n\n        {/* Notifications List */}\n        <div className={`${maxHeight} overflow-y-auto space-y-3`}>\n          {loading ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n            </div>\n          ) : filteredNotifications.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <Bell className=\"w-12 h-12 text-gray-300 mx-auto mb-4\" />\n              <p className=\"text-gray-500 text-sm\">\n                {filter === 'all' ? 'No notifications yet' : `No ${filter} notifications`}\n              </p>\n            </div>\n          ) : (\n            filteredNotifications.map((notification) => (\n              <div\n                key={notification.id}\n                className={`p-4 rounded-xl border transition-all duration-200 hover:shadow-md group ${\n                  notification.read \n                    ? 'bg-white border-gray-100' \n                    : 'bg-blue-50/50 border-blue-200 shadow-sm'\n                }`}\n              >\n                <div className=\"flex items-start space-x-3\">\n                  {/* Icon */}\n                  <div className={`p-2 rounded-lg flex-shrink-0 ${\n                    notification.read ? 'bg-gray-100' : 'bg-white shadow-sm'\n                  }`}>\n                    {getNotificationIcon(notification.type, notification.priority)}\n                  </div>\n\n                  {/* Content */}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-2 mb-1\">\n                          <h4 className={`text-sm font-medium ${\n                            notification.read ? 'text-gray-700' : 'text-gray-900'\n                          }`}>\n                            {notification.title}\n                          </h4>\n                          <Badge className={`text-xs ${getPriorityColor(notification.priority)}`}>\n                            {notification.priority}\n                          </Badge>\n                        </div>\n                        <p className={`text-sm ${\n                          notification.read ? 'text-gray-500' : 'text-gray-600'\n                        }`}>\n                          {notification.message}\n                        </p>\n                        \n                        {/* Metadata */}\n                        {notification.metadata && (\n                          <div className=\"mt-2 flex flex-wrap gap-2 text-xs text-gray-500\">\n                            {notification.metadata.patientName && (\n                              <span className=\"flex items-center space-x-1\">\n                                <User className=\"w-3 h-3\" />\n                                <span>{notification.metadata.patientName}</span>\n                              </span>\n                            )}\n                            {notification.metadata.appointmentTime && (\n                              <span className=\"flex items-center space-x-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                <span>{notification.metadata.appointmentTime}</span>\n                              </span>\n                            )}\n                            {notification.metadata.amount && (\n                              <span className=\"flex items-center space-x-1\">\n                                <CreditCard className=\"w-3 h-3\" />\n                                <span>${notification.metadata.amount}</span>\n                              </span>\n                            )}\n                          </div>\n                        )}\n                      </div>\n\n                      {/* Actions */}\n                      <div className=\"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                        {!notification.read && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => onMarkAsRead(notification.id)}\n                            className=\"text-xs px-2 py-1\"\n                          >\n                            <CheckCircle className=\"w-3 h-3\" />\n                          </Button>\n                        )}\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => onDelete(notification.id)}\n                          className=\"text-xs px-2 py-1 text-red-600 hover:text-red-700\"\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    </div>\n\n                    {/* Action Button */}\n                    {notification.actionUrl && notification.actionLabel && (\n                      <div className=\"mt-3 pt-3 border-t border-gray-100\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"text-xs flex items-center space-x-1 hover:bg-blue-50\"\n                        >\n                          <span>{notification.actionLabel}</span>\n                          <ChevronRight className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    )}\n\n                    {/* Timestamp */}\n                    <div className=\"mt-2 flex items-center justify-between\">\n                      <span className=\"text-xs text-gray-400\">\n                        {formatTimeAgo(notification.timestamp)}\n                      </span>\n                      {!notification.read && (\n                        <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n\n        {/* Footer */}\n        {filteredNotifications.length > 0 && (\n          <div className=\"mt-4 pt-4 border-t border-gray-100 text-center\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-xs\"\n            >\n              View all notifications\n              <ChevronRight className=\"w-3 h-3 ml-1\" />\n            </Button>\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n};\n\nexport default NotificationFeed;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\dashboard\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\examples\\ImprovedDentistProfileExample.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\ClinicBranchCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\ClinicBranchesShowcase.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":271,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":271,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9789,9792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9789,9792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":283,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10344,10347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10344,10347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { \r\n  MapIcon, \r\n  BuildingOfficeIcon,\r\n  ChevronLeftIcon,\r\n  ChevronRightIcon,\r\n  FunnelIcon,\r\n  MagnifyingGlassIcon\r\n} from '@heroicons/react/24/outline';\r\nimport ClinicBranchCard from './ClinicBranchCard';\r\nimport LoadingSpinner from '../ui/LoadingSpinner';\r\nimport ErrorMessage from '../common/ErrorMessage';\r\nimport { getClinicBranches, filterClinicBranches } from '../../services/clinicBranchService';\r\nimport { sortClinicBranches } from '../../utils/clinicBranchUtils';\r\nimport type { ClinicBranch, ClinicBranchFilters } from '../../types/clinicBranch';\r\n\r\ninterface ClinicBranchesShowcaseProps {\r\n  onBookAppointment?: (branchId: string) => void;\r\n  onViewBranchDetails?: (branchId: string) => void;\r\n  className?: string;\r\n  showFilters?: boolean;\r\n  showFavorites?: boolean;\r\n  maxBranches?: number;\r\n}\r\n\r\nconst ClinicBranchesShowcase: React.FC<ClinicBranchesShowcaseProps> = ({\r\n  onBookAppointment,\r\n  onViewBranchDetails,\r\n  className = '',\r\n  showFilters = true,\r\n  showFavorites = false,\r\n  maxBranches\r\n}) => {\r\n  const [branches, setBranches] = useState<ClinicBranch[]>([]);\r\n  const [filteredBranches, setFilteredBranches] = useState<ClinicBranch[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [currentSlide, setCurrentSlide] = useState(0);\r\n  const [favorites, setFavorites] = useState<Set<string>>(new Set());\r\n  \r\n  // Filter states\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedLocation, setSelectedLocation] = useState('');\r\n  const [selectedAvailability, setSelectedAvailability] = useState<'all' | 'now' | 'today'>('all');\r\n  const [sortBy, setSortBy] = useState<'name' | 'rating' | 'availability'>('name');\r\n  const [showFiltersPanel, setShowFiltersPanel] = useState(false);\r\n\r\n  // Load clinic branches\r\n  useEffect(() => {\r\n    const loadBranches = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        const response = await getClinicBranches();\r\n        \r\n        if (response.success && response.data) {\r\n          setBranches(response.data);\r\n          setFilteredBranches(response.data);\r\n        } else {\r\n          setError(response.message || 'Failed to load clinic branches');\r\n        }\r\n      } catch (err) {\r\n        setError('An unexpected error occurred while loading clinic branches');\r\n        console.error('Error loading clinic branches:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadBranches();\r\n  }, []);\r\n\r\n  // Load favorites from localStorage\r\n  useEffect(() => {\r\n    const savedFavorites = localStorage.getItem('clinic-favorites');\r\n    if (savedFavorites) {\r\n      try {\r\n        const favoriteIds = JSON.parse(savedFavorites);\r\n        setFavorites(new Set(favoriteIds));\r\n      } catch (err) {\r\n        console.error('Error loading favorites:', err);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Apply filters and sorting\r\n  useEffect(() => {\r\n    const applyFilters = async () => {\r\n      let filtered = [...branches];\r\n\r\n      // Apply search filter\r\n      if (searchQuery.trim()) {\r\n        filtered = filtered.filter(branch =>\r\n          branch.displayName.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n          branch.branchName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n          branch.address.city.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n          branch.serviceHighlights.some(service =>\r\n            service.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n          )\r\n        );\r\n      }\r\n\r\n      // Apply location filter\r\n      if (selectedLocation) {\r\n        filtered = filtered.filter(branch =>\r\n          branch.address.city.toLowerCase() === selectedLocation.toLowerCase() ||\r\n          branch.branchName?.toLowerCase() === selectedLocation.toLowerCase()\r\n        );\r\n      }\r\n\r\n      // Apply availability filter\r\n      if (selectedAvailability !== 'all') {\r\n        const filters: ClinicBranchFilters = {\r\n          availability: selectedAvailability\r\n        };\r\n        \r\n        try {\r\n          const filterResponse = await filterClinicBranches(filters);\r\n          if (filterResponse.success && filterResponse.data) {\r\n            const availableIds = new Set(filterResponse.data.map(b => b.id));\r\n            filtered = filtered.filter(branch => availableIds.has(branch.id));\r\n          }\r\n        } catch (err) {\r\n          console.error('Error applying availability filter:', err);\r\n        }\r\n      }\r\n\r\n      // Apply sorting\r\n      filtered = sortClinicBranches(filtered, sortBy);\r\n\r\n      // Apply max branches limit\r\n      if (maxBranches && maxBranches > 0) {\r\n        filtered = filtered.slice(0, maxBranches);\r\n      }\r\n\r\n      setFilteredBranches(filtered);\r\n      setCurrentSlide(0); // Reset to first slide when filters change\r\n    };\r\n\r\n    applyFilters();\r\n  }, [branches, searchQuery, selectedLocation, selectedAvailability, sortBy, maxBranches]);\r\n\r\n  const handleToggleFavorite = (branchId: string) => {\r\n    const newFavorites = new Set(favorites);\r\n    \r\n    if (newFavorites.has(branchId)) {\r\n      newFavorites.delete(branchId);\r\n    } else {\r\n      newFavorites.add(branchId);\r\n    }\r\n    \r\n    setFavorites(newFavorites);\r\n    localStorage.setItem('clinic-favorites', JSON.stringify([...newFavorites]));\r\n  };\r\n\r\n  const handlePrevSlide = () => {\r\n    setCurrentSlide(prev => \r\n      prev === 0 ? Math.max(0, filteredBranches.length - 3) : Math.max(0, prev - 1)\r\n    );\r\n  };\r\n\r\n  const handleNextSlide = () => {\r\n    setCurrentSlide(prev => \r\n      prev >= filteredBranches.length - 3 ? 0 : prev + 1\r\n    );\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    setSearchQuery('');\r\n    setSelectedLocation('');\r\n    setSelectedAvailability('all');\r\n    setSortBy('name');\r\n  };\r\n\r\n  const uniqueLocations = [...new Set(branches.map(b => b.address.city))];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className={`py-16 ${className}`}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"text-center\">\r\n            <LoadingSpinner size=\"lg\" />\r\n            <p className=\"mt-4 text-gray-600\">Loading clinic branches...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className={`py-16 ${className}`}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <ErrorMessage \r\n            message={error}\r\n            onRetry={() => window.location.reload()}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <section className={`py-16 bg-gray-50 ${className}`}>\r\n      <div className=\"container mx-auto px-4\">\r\n        {/* Section Header */}\r\n        <div className=\"text-center mb-12\">\r\n          <div className=\"flex items-center justify-center mb-4\">\r\n            <BuildingOfficeIcon className=\"h-8 w-8 text-blue-600 mr-3\" />\r\n            <h2 className=\"text-3xl md:text-4xl font-bold text-gray-900\">\r\n              Our Clinic Branches\r\n            </h2>\r\n          </div>\r\n          <p className=\"text-lg text-gray-600 max-w-3xl mx-auto\">\r\n            Choose from our three convenient locations across Egypt. Each branch offers \r\n            comprehensive dental care with modern facilities and experienced professionals.\r\n          </p>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        {showFilters && (\r\n          <div className=\"mb-8\">\r\n            {/* Mobile Filter Toggle */}\r\n            <div className=\"md:hidden mb-4\">\r\n              <button\r\n                onClick={() => setShowFiltersPanel(!showFiltersPanel)}\r\n                className=\"flex items-center justify-center w-full px-4 py-2 bg-white border border-gray-300 \r\n                         rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-200\"\r\n              >\r\n                <FunnelIcon className=\"h-5 w-5 mr-2\" />\r\n                Filters & Search\r\n              </button>\r\n            </div>\r\n\r\n            {/* Filter Panel */}\r\n            <div className={`\r\n              bg-white rounded-lg shadow-sm border border-gray-200 p-6 transition-all duration-300\r\n              ${showFiltersPanel || 'hidden md:block'}\r\n            `}>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                {/* Search */}\r\n                <div className=\"relative\">\r\n                  <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search branches, services...\"\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                    className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 \r\n                             focus:ring-blue-500 focus:border-transparent\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Location Filter */}\r\n                <select\r\n                  value={selectedLocation}\r\n                  onChange={(e) => setSelectedLocation(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 \r\n                           focus:ring-blue-500 focus:border-transparent\"\r\n                >\r\n                  <option value=\"\">All Locations</option>\r\n                  {uniqueLocations.map(location => (\r\n                    <option key={location} value={location}>{location}</option>\r\n                  ))}\r\n                </select>\r\n\r\n                {/* Availability Filter */}\r\n                <select\r\n                  value={selectedAvailability}\r\n                  onChange={(e) => setSelectedAvailability(e.target.value as any)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 \r\n                           focus:ring-blue-500 focus:border-transparent\"\r\n                >\r\n                  <option value=\"all\">All Hours</option>\r\n                  <option value=\"now\">Open Now</option>\r\n                  <option value=\"today\">Open Today</option>\r\n                </select>\r\n\r\n                {/* Sort By */}\r\n                <select\r\n                  value={sortBy}\r\n                  onChange={(e) => setSortBy(e.target.value as any)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 \r\n                           focus:ring-blue-500 focus:border-transparent\"\r\n                >\r\n                  <option value=\"name\">Sort by Name</option>\r\n                  <option value=\"rating\">Sort by Rating</option>\r\n                  <option value=\"availability\">Sort by Availability</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Active Filters & Clear */}\r\n              {(searchQuery || selectedLocation || selectedAvailability !== 'all' || sortBy !== 'name') && (\r\n                <div className=\"mt-4 flex items-center justify-between\">\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {searchQuery && (\r\n                      <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800\">\r\n                        Search: \"{searchQuery}\"\r\n                      </span>\r\n                    )}\r\n                    {selectedLocation && (\r\n                      <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800\">\r\n                        Location: {selectedLocation}\r\n                      </span>\r\n                    )}\r\n                    {selectedAvailability !== 'all' && (\r\n                      <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800\">\r\n                        {selectedAvailability === 'now' ? 'Open Now' : 'Open Today'}\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <button\r\n                    onClick={clearFilters}\r\n                    className=\"text-sm text-gray-600 hover:text-gray-900 underline\"\r\n                  >\r\n                    Clear All\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Results Count */}\r\n        <div className=\"mb-6 text-center\">\r\n          <p className=\"text-gray-600\">\r\n            Showing {filteredBranches.length} of {branches.length} clinic branches\r\n          </p>\r\n        </div>\r\n\r\n        {/* Clinic Cards */}\r\n        {filteredBranches.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <MapIcon className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\r\n            <h3 className=\"text-xl font-medium text-gray-900 mb-2\">No branches found</h3>\r\n            <p className=\"text-gray-600 mb-4\">\r\n              Try adjusting your filters or search terms to find clinic branches.\r\n            </p>\r\n            <button\r\n              onClick={clearFilters}\r\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 \r\n                       transition-colors duration-200\"\r\n            >\r\n              Clear Filters\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"relative\">\r\n            {/* Desktop Grid Layout */}\r\n            <div className=\"hidden lg:grid lg:grid-cols-3 gap-8\">\r\n              {filteredBranches.map((branch) => (\r\n                <ClinicBranchCard\r\n                  key={branch.id}\r\n                  branch={branch}\r\n                  onBookAppointment={onBookAppointment}\r\n                  onViewDetails={onViewBranchDetails}\r\n                  showFavorite={showFavorites}\r\n                  isFavorite={favorites.has(branch.id)}\r\n                  onToggleFavorite={handleToggleFavorite}\r\n                />\r\n              ))}\r\n            </div>\r\n\r\n            {/* Mobile/Tablet Carousel */}\r\n            <div className=\"lg:hidden\">\r\n              <div className=\"relative overflow-hidden\">\r\n                <div \r\n                  className=\"flex transition-transform duration-300 ease-in-out\"\r\n                  style={{ \r\n                    transform: `translateX(-${currentSlide * (100 / Math.min(filteredBranches.length, 2))}%)`,\r\n                    width: `${Math.max(filteredBranches.length * 50, 100)}%`\r\n                  }}\r\n                >\r\n                  {filteredBranches.map((branch) => (\r\n                    <div \r\n                      key={branch.id} \r\n                      className=\"w-full md:w-1/2 flex-shrink-0 px-2\"\r\n                    >\r\n                      <ClinicBranchCard\r\n                        branch={branch}\r\n                        onBookAppointment={onBookAppointment}\r\n                        onViewDetails={onViewBranchDetails}\r\n                        showFavorite={showFavorites}\r\n                        isFavorite={favorites.has(branch.id)}\r\n                        onToggleFavorite={handleToggleFavorite}\r\n                      />\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Carousel Controls */}\r\n              {filteredBranches.length > 1 && (\r\n                <div className=\"flex items-center justify-center mt-6 space-x-4\">\r\n                  <button\r\n                    onClick={handlePrevSlide}\r\n                    disabled={currentSlide === 0}\r\n                    className=\"p-2 rounded-full bg-white border border-gray-300 text-gray-600 \r\n                             hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\r\n                             transition-colors duration-200\"\r\n                  >\r\n                    <ChevronLeftIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n\r\n                  {/* Dots Indicator */}\r\n                  <div className=\"flex space-x-2\">\r\n                    {Array.from({ length: Math.max(1, filteredBranches.length - 1) }).map((_, index) => (\r\n                      <button\r\n                        key={index}\r\n                        onClick={() => setCurrentSlide(index)}\r\n                        className={`w-2 h-2 rounded-full transition-colors duration-200 ${\r\n                          currentSlide === index ? 'bg-blue-600' : 'bg-gray-300'\r\n                        }`}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n\r\n                  <button\r\n                    onClick={handleNextSlide}\r\n                    disabled={currentSlide >= filteredBranches.length - 1}\r\n                    className=\"p-2 rounded-full bg-white border border-gray-300 text-gray-600 \r\n                             hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\r\n                             transition-colors duration-200\"\r\n                  >\r\n                    <ChevronRightIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Call to Action */}\r\n        <div className=\"text-center mt-12\">\r\n          <p className=\"text-gray-600 mb-6\">\r\n            Can't decide which branch is right for you? We're here to help!\r\n          </p>\r\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\r\n            <button\r\n              onClick={() => onBookAppointment?.('any')}\r\n              className=\"px-8 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 \r\n                       transition-colors duration-200 focus:outline-none focus:ring-2 \r\n                       focus:ring-blue-500 focus:ring-opacity-50\"\r\n            >\r\n              Book at Any Branch\r\n            </button>\r\n            <a\r\n              href=\"tel:+20123456789\"\r\n              className=\"px-8 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium \r\n                       hover:bg-gray-50 transition-colors duration-200 focus:outline-none \r\n                       focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50\"\r\n            >\r\n              Call for Guidance\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default ClinicBranchesShowcase;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\ClinicContactActions.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":3,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[101,104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[101,104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\n// Declare global gtag for TypeScript\r\ndeclare const gtag: any;\r\nimport {\r\n  PhoneIcon,\r\n  CalendarIcon,\r\n  GlobeAltIcon,\r\n  ClockIcon,\r\n  InformationCircleIcon\r\n} from '@heroicons/react/24/outline';\r\nimport {\r\n  PhoneIcon as PhoneIconSolid,\r\n  MapPinIcon as MapPinIconSolid\r\n} from '@heroicons/react/24/solid';\r\nimport type { ClinicBranch, ContactMethod } from '../../types/clinicBranch';\r\nimport { getClinicContactMethods, getEnhancedOperatingHours } from '../../services/clinicBranchService';\r\nimport { formatPhoneNumber, generateWhatsAppUrl } from '../../utils/clinicBranchUtils';\r\n\r\ninterface ClinicContactActionsProps {\r\n  branch: ClinicBranch;\r\n  onBookAppointment?: (branchId: string) => void;\r\n  className?: string;\r\n  layout?: 'horizontal' | 'vertical' | 'grid';\r\n  showOperatingHours?: boolean;\r\n  showEmergencyContact?: boolean;\r\n}\r\n\r\nconst ClinicContactActions: React.FC<ClinicContactActionsProps> = ({\r\n  branch,\r\n  onBookAppointment,\r\n  className = '',\r\n  layout = 'horizontal',\r\n  showOperatingHours = true,\r\n  showEmergencyContact = true\r\n}) => {\r\n  const [showAllHours, setShowAllHours] = useState(false);\r\n  const [mapLoading, setMapLoading] = useState(false);\r\n\r\n  const contactMethods = getClinicContactMethods(branch);\r\n  const enhancedHours = getEnhancedOperatingHours(branch);\r\n  const todayHours = enhancedHours.find(h => h.isToday);\r\n\r\n  const handleContactAction = async (method: ContactMethod) => {\r\n    switch (method.type) {\r\n      case 'phone':\r\n        // Track phone call analytics\r\n        if (typeof gtag !== 'undefined') {\r\n          gtag('event', 'phone_call', {\r\n            clinic_branch: branch.branchName,\r\n            phone_number: method.value\r\n          });\r\n        }\r\n        window.open(`tel:${method.value}`, '_self');\r\n        break;\r\n\r\n      case 'whatsapp':\r\n        // Track WhatsApp analytics\r\n        if (typeof gtag !== 'undefined') {\r\n          gtag('event', 'whatsapp_contact', {\r\n            clinic_branch: branch.branchName\r\n          });\r\n        }\r\n        const whatsappUrl = generateWhatsAppUrl(\r\n          branch.whatsappNumber,\r\n          branch.branchName,\r\n          `Hello! I would like to book an appointment at ${branch.displayName}. Could you please help me with available time slots?`\r\n        );\r\n        window.open(whatsappUrl, '_blank');\r\n        break;\r\n\r\n      case 'directions':\r\n        // Track directions analytics\r\n        if (typeof gtag !== 'undefined') {\r\n          gtag('event', 'get_directions', {\r\n            clinic_branch: branch.branchName,\r\n            clinic_address: `${branch.address.city}, ${branch.address.state}`\r\n          });\r\n        }\r\n        setMapLoading(true);\r\n        \r\n        // Try to use user's location for better directions\r\n        if (navigator.geolocation) {\r\n          navigator.geolocation.getCurrentPosition(\r\n            (position) => {\r\n              const { latitude, longitude } = position.coords;\r\n              const directionsUrl = `https://www.google.com/maps/dir/${latitude},${longitude}/${encodeURIComponent(\r\n                `${branch.address.street}, ${branch.address.city}, ${branch.address.country}`\r\n              )}`;\r\n              window.open(directionsUrl, '_blank');\r\n              setMapLoading(false);\r\n            },\r\n            () => {\r\n              // Fallback to basic directions without user location\r\n              window.open(branch.directionsUrl || branch.mapUrl, '_blank');\r\n              setMapLoading(false);\r\n            },\r\n            { timeout: 5000 }\r\n          );\r\n        } else {\r\n          window.open(branch.directionsUrl || branch.mapUrl, '_blank');\r\n          setMapLoading(false);\r\n        }\r\n        break;\r\n\r\n      case 'booking':\r\n        // Track booking analytics\r\n        if (typeof gtag !== 'undefined') {\r\n          gtag('event', 'book_appointment_click', {\r\n            clinic_branch: branch.branchName,\r\n            source: 'contact_actions'\r\n          });\r\n        }\r\n        \r\n        if (onBookAppointment) {\r\n          onBookAppointment(branch.id);\r\n        } else if (branch.bookingUrl) {\r\n          window.open(branch.bookingUrl, '_blank');\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  const handleEmergencyCall = () => {\r\n    if (typeof gtag !== 'undefined') {\r\n      gtag('event', 'emergency_call', {\r\n        clinic_branch: branch.branchName\r\n      });\r\n    }\r\n    window.open(`tel:${branch.emergencyContact}`, '_self');\r\n  };\r\n\r\n  const handleViewOnMap = () => {\r\n    if (typeof gtag !== 'undefined') {\r\n      gtag('event', 'view_on_map', {\r\n        clinic_branch: branch.branchName\r\n      });\r\n    }\r\n    window.open(branch.mapUrl, '_blank');\r\n  };\r\n\r\n  const layoutClasses = {\r\n    horizontal: 'flex flex-wrap gap-3',\r\n    vertical: 'flex flex-col space-y-3',\r\n    grid: 'grid grid-cols-2 gap-3'\r\n  };\r\n\r\n  const buttonBaseClasses = `\r\n    flex items-center justify-center px-4 py-3 rounded-lg font-medium text-sm\r\n    transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-opacity-50\r\n    hover:transform hover:scale-105 active:scale-95\r\n  `;\r\n\r\n  return (\r\n    <div className={`${className}`}>\r\n      {/* Primary Contact Actions */}\r\n      <div className={layoutClasses[layout]}>\r\n        {contactMethods.map((method) => {\r\n          const isPrimary = method.primary;\r\n          const buttonClasses = isPrimary\r\n            ? `${buttonBaseClasses} bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-md`\r\n            : `${buttonBaseClasses} bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500`;\r\n\r\n          return (\r\n            <button\r\n              key={method.type}\r\n              onClick={() => handleContactAction(method)}\r\n              disabled={method.type === 'directions' && mapLoading}\r\n              className={`${buttonClasses} ${\r\n                method.type === 'directions' && mapLoading ? 'opacity-50 cursor-not-allowed' : ''\r\n              }`}\r\n              title={method.label}\r\n            >\r\n              {method.type === 'phone' && <PhoneIconSolid className=\"h-5 w-5 mr-2\" />}\r\n              {method.type === 'whatsapp' && (\r\n                <svg className=\"h-5 w-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path d=\"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488\"/>\r\n                </svg>\r\n              )}\r\n              {method.type === 'directions' && (\r\n                mapLoading ? (\r\n                  <div className=\"animate-spin h-5 w-5 mr-2 border-2 border-current border-t-transparent rounded-full\" />\r\n                ) : (\r\n                  <MapPinIconSolid className=\"h-5 w-5 mr-2\" />\r\n                )\r\n              )}\r\n              {method.type === 'booking' && <CalendarIcon className=\"h-5 w-5 mr-2\" />}\r\n              <span className=\"hidden sm:inline\">{method.label}</span>\r\n              <span className=\"sm:hidden\">\r\n                {method.type === 'phone' && 'Call'}\r\n                {method.type === 'whatsapp' && 'Chat'}\r\n                {method.type === 'directions' && 'Directions'}\r\n                {method.type === 'booking' && 'Book'}\r\n              </span>\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Additional Actions */}\r\n      <div className=\"mt-4 flex flex-wrap gap-2 justify-center\">\r\n        {/* View on Map */}\r\n        <button\r\n          onClick={handleViewOnMap}\r\n          className=\"inline-flex items-center px-3 py-1.5 text-sm text-gray-600 hover:text-blue-600 \r\n                   transition-colors duration-200\"\r\n          title=\"View location on Google Maps\"\r\n        >\r\n          <GlobeAltIcon className=\"h-4 w-4 mr-1\" />\r\n          View on Map\r\n        </button>\r\n\r\n        {/* Emergency Contact */}\r\n        {showEmergencyContact && branch.emergencyContact && (\r\n          <button\r\n            onClick={handleEmergencyCall}\r\n            className=\"inline-flex items-center px-3 py-1.5 text-sm text-red-600 hover:text-red-700 \r\n                     transition-colors duration-200\"\r\n            title=\"Emergency contact\"\r\n          >\r\n            <PhoneIcon className=\"h-4 w-4 mr-1\" />\r\n            Emergency\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Operating Hours */}\r\n      {showOperatingHours && (\r\n        <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h4 className=\"flex items-center text-sm font-medium text-gray-900\">\r\n              <ClockIcon className=\"h-4 w-4 mr-2\" />\r\n              Operating Hours\r\n            </h4>\r\n            {enhancedHours.length > 1 && (\r\n              <button\r\n                onClick={() => setShowAllHours(!showAllHours)}\r\n                className=\"text-sm text-blue-600 hover:text-blue-700 transition-colors duration-200\"\r\n              >\r\n                {showAllHours ? 'Show Less' : 'Show All'}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Current Status */}\r\n          <div className={`\r\n            flex items-center mb-3 p-2 rounded-md text-sm font-medium\r\n            ${branch.currentStatus.isOpen \r\n              ? 'bg-green-100 text-green-800' \r\n              : 'bg-red-100 text-red-800'\r\n            }\r\n          `}>\r\n            <div className={`\r\n              w-2 h-2 rounded-full mr-2\r\n              ${branch.currentStatus.isOpen ? 'bg-green-500' : 'bg-red-500'}\r\n            `} />\r\n            {branch.currentStatus.statusText}\r\n          </div>\r\n\r\n          {/* Hours Display */}\r\n          <div className=\"space-y-1\">\r\n            {showAllHours ? (\r\n              enhancedHours.map((hours) => (\r\n                <div\r\n                  key={hours.day}\r\n                  className={`\r\n                    flex justify-between text-sm py-1 px-2 rounded\r\n                    ${hours.isToday ? 'bg-blue-50 text-blue-900 font-medium' : 'text-gray-600'}\r\n                  `}\r\n                >\r\n                  <span className=\"capitalize\">{hours.day}</span>\r\n                  <span>{hours.displayText}</span>\r\n                </div>\r\n              ))\r\n            ) : todayHours ? (\r\n              <div className=\"flex justify-between text-sm py-1 px-2 bg-blue-50 text-blue-900 font-medium rounded\">\r\n                <span>Today</span>\r\n                <span>{todayHours.displayText}</span>\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-sm text-gray-600 text-center py-2\">\r\n                Hours information not available\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Busy Level Indicator */}\r\n          {branch.currentStatus.isOpen && branch.currentStatus.busyLevel && (\r\n            <div className=\"mt-3 flex items-center text-sm\">\r\n              <InformationCircleIcon className=\"h-4 w-4 mr-2 text-gray-400\" />\r\n              <span className=\"text-gray-600\">Current wait time: </span>\r\n              <span className={`\r\n                ml-1 font-medium\r\n                ${branch.currentStatus.busyLevel === 'low' ? 'text-green-600' : \r\n                  branch.currentStatus.busyLevel === 'medium' ? 'text-yellow-600' : 'text-red-600'}\r\n              `}>\r\n                {branch.currentStatus.busyLevel === 'low' ? 'Short' : \r\n                 branch.currentStatus.busyLevel === 'medium' ? 'Moderate' : 'Longer'}\r\n              </span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Contact Information */}\r\n      <div className=\"mt-4 text-center text-sm text-gray-600\">\r\n        <p className=\"mb-1\">\r\n          <span className=\"font-medium\">Phone:</span> {formatPhoneNumber(branch.phone)}\r\n        </p>\r\n        <p>\r\n          <span className=\"font-medium\">Address:</span> {branch.address.street}, {branch.address.city}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClinicContactActions;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\ClinicDetailsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\ClinicMapView.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":4,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[138,141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[138,141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[196,199],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[196,199],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[983,986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[983,986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1037,1040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1037,1040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1097,1100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1097,1100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeMap'. Either include it or remove the dependency array.","line":103,"column":6,"nodeType":"ArrayExpression","endLine":103,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [apiKey, initializeMap]","fix":{"range":[2988,2996],"text":"[apiKey, initializeMap]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleBranchSelect'. Either include it or remove the dependency array.","line":283,"column":6,"nodeType":"ArrayExpression","endLine":283,"endColumn":50,"suggestions":[{"desc":"Update the dependencies array to be: [selectedBranchId, markers, map, infoWindow, handleBranchSelect]","fix":{"range":[9338,9382],"text":"[selectedBranchId, markers, map, infoWindow, handleBranchSelect]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\n\r\n// Declare global Google Maps object for TypeScript\r\ndeclare const google: any;\r\ndeclare global {\r\n  interface Window {\r\n    google: any;\r\n  }\r\n}\r\nimport { ExclamationTriangleIcon } from '@heroicons/react/24/outline';\r\nimport type { ClinicBranch } from '../../types/clinicBranch';\r\n\r\ninterface ClinicMapViewProps {\r\n  branches: ClinicBranch[];\r\n  selectedBranchId?: string;\r\n  onBranchSelect?: (branchId: string) => void;\r\n  className?: string;\r\n  height?: string;\r\n  showControls?: boolean;\r\n  apiKey?: string;\r\n}\r\n\r\ninterface MapMarker {\r\n  id: string;\r\n  position: { lat: number; lng: number };\r\n  title: string;\r\n  branch: ClinicBranch;\r\n}\r\n\r\nconst ClinicMapView: React.FC<ClinicMapViewProps> = ({\r\n  branches,\r\n  selectedBranchId,\r\n  onBranchSelect,\r\n  className = '',\r\n  height = '400px',\r\n  showControls = true,\r\n  apiKey\r\n}) => {\r\n  const mapRef = useRef<HTMLDivElement>(null);\r\n  const [map, setMap] = useState<any>(null);\r\n  const [markers, setMarkers] = useState<any[]>([]);\r\n  const [infoWindow, setInfoWindow] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [userLocation, setUserLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n\r\n  // Default coordinates for Egypt (center of the country)\r\n  const defaultCenter = { lat: 26.8206, lng: 30.8025 };\r\n\r\n  // Prepare markers data\r\n  const mapMarkers: MapMarker[] = branches\r\n    .filter(branch => branch.address.coordinates)\r\n    .map(branch => ({\r\n      id: branch.id,\r\n      position: {\r\n        lat: branch.address.coordinates!.latitude,\r\n        lng: branch.address.coordinates!.longitude\r\n      },\r\n      title: branch.displayName,\r\n      branch\r\n    }));\r\n\r\n  // Load Google Maps API\r\n  useEffect(() => {\r\n    const loadGoogleMaps = async () => {\r\n      try {\r\n        // Check if Google Maps is already loaded\r\n        if (window.google && window.google.maps) {\r\n          initializeMap();\r\n          return;\r\n        }\r\n\r\n        // Use provided API key or fallback to embedded maps\r\n        if (!apiKey) {\r\n          setError('Google Maps API key not provided. Using fallback map view.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Load Google Maps API\r\n        const script = document.createElement('script');\r\n        script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places`;\r\n        script.async = true;\r\n        script.defer = true;\r\n        script.onload = initializeMap;\r\n        script.onerror = () => {\r\n          setError('Failed to load Google Maps API');\r\n          setLoading(false);\r\n        };\r\n\r\n        document.head.appendChild(script);\r\n\r\n        return () => {\r\n          document.head.removeChild(script);\r\n        };\r\n      } catch (_err) {\r\n        setError('Error loading Google Maps');\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadGoogleMaps();\r\n  }, [apiKey]);\r\n\r\n  // Get user location\r\n  useEffect(() => {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          setUserLocation({\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          });\r\n        },\r\n        (error) => {\r\n          console.warn('Could not get user location:', error);\r\n        },\r\n        { timeout: 10000 }\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  const initializeMap = () => {\r\n    if (!mapRef.current || !window.google) return;\r\n\r\n    try {\r\n      // Calculate center point from all markers or use default\r\n      const center = mapMarkers.length > 0\r\n        ? calculateCenter(mapMarkers.map(m => m.position))\r\n        : defaultCenter;\r\n\r\n      // Create map\r\n      const mapInstance = new google.maps.Map(mapRef.current, {\r\n        center,\r\n        zoom: mapMarkers.length > 1 ? 8 : 12,\r\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n        styles: [\r\n          {\r\n            featureType: 'poi.business',\r\n            stylers: [{ visibility: 'off' }]\r\n          },\r\n          {\r\n            featureType: 'poi.medical',\r\n            stylers: [{ visibility: 'on' }]\r\n          }\r\n        ]\r\n      });\r\n\r\n      setMap(mapInstance);\r\n\r\n      // Create info window\r\n      const infoWindowInstance = new google.maps.InfoWindow();\r\n      setInfoWindow(infoWindowInstance);\r\n\r\n      // Add markers\r\n      const markerInstances = mapMarkers.map(markerData => {\r\n        const marker = new google.maps.Marker({\r\n          position: markerData.position,\r\n          map: mapInstance,\r\n          title: markerData.title,\r\n          icon: {\r\n            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`\r\n              <svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <circle cx=\"16\" cy=\"16\" r=\"12\" fill=\"#2563eb\" stroke=\"#ffffff\" stroke-width=\"2\"/>\r\n                <path d=\"M16 8l-3 8h2v4h2v-4h2l-3-8z\" fill=\"#ffffff\"/>\r\n              </svg>\r\n            `),\r\n            scaledSize: new google.maps.Size(32, 32),\r\n            anchor: new google.maps.Point(16, 16)\r\n          }\r\n        });\r\n\r\n        // Add click listener\r\n        marker.addListener('click', () => {\r\n          // Update info window content\r\n          const content = createInfoWindowContent(markerData.branch);\r\n          infoWindowInstance.setContent(content);\r\n          infoWindowInstance.open(mapInstance, marker);\r\n\r\n          // Notify parent component\r\n          if (onBranchSelect) {\r\n            onBranchSelect(markerData.id);\r\n          }\r\n        });\r\n\r\n        return marker;\r\n      });\r\n\r\n      setMarkers(markerInstances);\r\n\r\n      // Add user location marker if available\r\n      if (userLocation) {\r\n        new google.maps.Marker({\r\n          position: userLocation,\r\n          map: mapInstance,\r\n          title: 'Your Location',\r\n          icon: {\r\n            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`\r\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <circle cx=\"12\" cy=\"12\" r=\"8\" fill=\"#10b981\" stroke=\"#ffffff\" stroke-width=\"2\"/>\r\n                <circle cx=\"12\" cy=\"12\" r=\"3\" fill=\"#ffffff\"/>\r\n              </svg>\r\n            `),\r\n            scaledSize: new google.maps.Size(24, 24),\r\n            anchor: new google.maps.Point(12, 12)\r\n          }\r\n        });\r\n      }\r\n\r\n      // Fit bounds to show all markers\r\n      if (mapMarkers.length > 1) {\r\n        const bounds = new google.maps.LatLngBounds();\r\n        mapMarkers.forEach(marker => bounds.extend(marker.position));\r\n        if (userLocation) bounds.extend(userLocation);\r\n        mapInstance.fitBounds(bounds);\r\n      }\r\n\r\n      setLoading(false);\r\n    } catch (_err) {\r\n      setError('Error initializing map');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const calculateCenter = (positions: { lat: number; lng: number }[]) => {\r\n    const lat = positions.reduce((sum, pos) => sum + pos.lat, 0) / positions.length;\r\n    const lng = positions.reduce((sum, pos) => sum + pos.lng, 0) / positions.length;\r\n    return { lat, lng };\r\n  };\r\n\r\n  const createInfoWindowContent = (branch: ClinicBranch) => {\r\n    return `\r\n      <div style=\"max-width: 300px; padding: 12px;\">\r\n        <h3 style=\"margin: 0 0 8px 0; font-size: 16px; font-weight: 600; color: #1f2937;\">\r\n          ${branch.displayName}\r\n        </h3>\r\n        <p style=\"margin: 0 0 8px 0; font-size: 14px; color: #6b7280;\">\r\n          ${branch.address.street}<br>\r\n          ${branch.address.city}, ${branch.address.state}\r\n        </p>\r\n        <div style=\"margin: 8px 0; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500; display: inline-block; ${\r\n          branch.currentStatus.isOpen \r\n            ? 'background-color: #dcfce7; color: #166534;' \r\n            : 'background-color: #fef2f2; color: #991b1b;'\r\n        }\">\r\n          ${branch.currentStatus.statusText}\r\n        </div>\r\n        <div style=\"margin-top: 12px; display: flex; gap: 8px;\">\r\n          <a href=\"tel:${branch.phone}\" \r\n             style=\"padding: 6px 12px; background-color: #2563eb; color: white; text-decoration: none; \r\n                    border-radius: 4px; font-size: 12px; font-weight: 500;\">\r\n            Call Now\r\n          </a>\r\n          <a href=\"${branch.directionsUrl || branch.mapUrl}\" target=\"_blank\"\r\n             style=\"padding: 6px 12px; background-color: #f3f4f6; color: #374151; text-decoration: none; \r\n                    border-radius: 4px; font-size: 12px; font-weight: 500; border: 1px solid #d1d5db;\">\r\n            Directions\r\n          </a>\r\n        </div>\r\n      </div>\r\n    `;\r\n  };\r\n\r\n  const handleBranchSelect = (branchId: string) => {\r\n    const marker = markers.find((_, index) => mapMarkers[index]?.id === branchId);\r\n    const markerData = mapMarkers.find(m => m.id === branchId);\r\n    \r\n    if (marker && markerData && map && infoWindow) {\r\n      map.setCenter(markerData.position);\r\n      map.setZoom(14);\r\n      \r\n      const content = createInfoWindowContent(markerData.branch);\r\n      infoWindow.setContent(content);\r\n      infoWindow.open(map, marker);\r\n    }\r\n  };\r\n\r\n  // Update selected marker when prop changes\r\n  useEffect(() => {\r\n    if (selectedBranchId) {\r\n      handleBranchSelect(selectedBranchId);\r\n    }\r\n  }, [selectedBranchId, markers, map, infoWindow]);\r\n\r\n  const handleGetDirections = (branch: ClinicBranch) => {\r\n    if (userLocation) {\r\n      const directionsUrl = `https://www.google.com/maps/dir/${userLocation.lat},${userLocation.lng}/${encodeURIComponent(\r\n        `${branch.address.street}, ${branch.address.city}, ${branch.address.country}`\r\n      )}`;\r\n      window.open(directionsUrl, '_blank');\r\n    } else {\r\n      window.open(branch.directionsUrl || branch.mapUrl, '_blank');\r\n    }\r\n  };\r\n\r\n  // Fallback view when Google Maps is not available\r\n  if (error && !apiKey) {\r\n    return (\r\n      <div className={`${className}`} style={{ height }}>\r\n        <div className=\"h-full bg-gray-100 rounded-lg overflow-hidden\">\r\n          <div className=\"h-full flex flex-col\">\r\n            {/* Static Map Header */}\r\n            <div className=\"bg-white p-4 border-b border-gray-200\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Clinic Locations</h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                Interactive map requires Google Maps API. View individual locations below.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Branch List */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n              {branches.map((branch) => (\r\n                <div\r\n                  key={branch.id}\r\n                  className={`\r\n                    p-4 bg-white rounded-lg border-2 transition-colors duration-200 cursor-pointer\r\n                    ${selectedBranchId === branch.id \r\n                      ? 'border-blue-500 bg-blue-50' \r\n                      : 'border-gray-200 hover:border-gray-300'\r\n                    }\r\n                  `}\r\n                  onClick={() => onBranchSelect?.(branch.id)}\r\n                >\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <h4 className=\"font-medium text-gray-900 mb-1\">{branch.displayName}</h4>\r\n                      <p className=\"text-sm text-gray-600 mb-2\">\r\n                        {branch.address.street}<br />\r\n                        {branch.address.city}, {branch.address.state}\r\n                      </p>\r\n                      <div className={`\r\n                        inline-flex items-center px-2 py-1 rounded-full text-xs font-medium\r\n                        ${branch.currentStatus.isOpen \r\n                          ? 'bg-green-100 text-green-800' \r\n                          : 'bg-red-100 text-red-800'\r\n                        }\r\n                      `}>\r\n                        {branch.currentStatus.statusText}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex flex-col space-y-2 ml-4\">\r\n                      <a\r\n                        href={`tel:${branch.phone}`}\r\n                        className=\"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 \r\n                                 transition-colors duration-200 text-center\"\r\n                      >\r\n                        Call\r\n                      </a>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleGetDirections(branch);\r\n                        }}\r\n                        className=\"px-3 py-1 bg-gray-100 text-gray-700 text-xs rounded hover:bg-gray-200 \r\n                                 transition-colors duration-200\"\r\n                      >\r\n                        Directions\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`relative ${className}`} style={{ height }}>\r\n      {loading && (\r\n        <div className=\"absolute inset-0 bg-gray-100 flex items-center justify-center z-10\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4\"></div>\r\n            <p className=\"text-gray-600\">Loading map...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {error && apiKey && (\r\n        <div className=\"absolute inset-0 bg-red-50 flex items-center justify-center z-10\">\r\n          <div className=\"text-center p-6\">\r\n            <ExclamationTriangleIcon className=\"h-12 w-12 text-red-400 mx-auto mb-4\" />\r\n            <h3 className=\"text-lg font-medium text-red-800 mb-2\">Map Error</h3>\r\n            <p className=\"text-red-600\">{error}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div ref={mapRef} className=\"w-full h-full rounded-lg\" />\r\n\r\n      {/* Map Controls */}\r\n      {showControls && map && (\r\n        <div className=\"absolute top-4 right-4 bg-white rounded-lg shadow-lg p-2 space-y-2\">\r\n          <button\r\n            onClick={() => {\r\n              if (userLocation && map) {\r\n                map.setCenter(userLocation);\r\n                map.setZoom(12);\r\n              }\r\n            }}\r\n            disabled={!userLocation}\r\n            className=\"block w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded \r\n                     disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200\"\r\n            title=\"Center on your location\"\r\n          >\r\n            My Location\r\n          </button>\r\n          \r\n          <button\r\n            onClick={() => {\r\n              if (map && mapMarkers.length > 0) {\r\n                const bounds = new google.maps.LatLngBounds();\r\n                mapMarkers.forEach(marker => bounds.extend(marker.position));\r\n                map.fitBounds(bounds);\r\n              }\r\n            }}\r\n            className=\"block w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded \r\n                     transition-colors duration-200\"\r\n            title=\"Show all clinics\"\r\n          >\r\n            Show All\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClinicMapView;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\HeroSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isBookDialogOpen' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\r\nimport { Button } from '../ui';\r\nimport OptimizedImage from '../ui/OptimizedImage';\r\nimport { HeroSkeleton, LoadingOverlay } from '../ui/LoadingStates';\r\nimport { usePerformanceMonitor, useCoreWebVitals } from '../../hooks/usePerformanceMonitor';\r\nimport {\r\n  Calendar,\r\n  ArrowRight,\r\n  PlayCircle,\r\n  Heart,\r\n  CheckCircle,\r\n  Shield,\r\n  Award,\r\n  Star,\r\n  Sparkles\r\n} from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { trackEvent } from '../../utils/analytics'\r\n\r\ninterface HeroSectionProps {\r\n  className?: string;\r\n}\r\n\r\nconst HeroSection: React.FC<HeroSectionProps> = ({ className = '' }) => {\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });\r\n  const [imageLoaded, setImageLoaded] = useState(false);\r\n  const [isBookDialogOpen, setIsBookDialogOpen] = useState(false);\r\n  const navigate = useNavigate()\r\n  \r\n  // Performance monitoring\r\n  const { measureInteraction } = usePerformanceMonitor('HeroSection');\r\n  useCoreWebVitals();\r\n\r\n  useEffect(() => {\r\n    setIsLoaded(true);\r\n    measureInteraction('component_mounted');\r\n  }, [measureInteraction]);\r\n\r\n  // Memoize particle positions for better performance\r\n  const particles = useMemo(() => \r\n    Array.from({ length: 15 }, (_, i) => ({\r\n      id: i,\r\n      left: Math.random() * 100,\r\n      top: Math.random() * 100,\r\n      delay: Math.random() * 3,\r\n      duration: 2 + Math.random() * 3\r\n    })), []\r\n  );\r\n\r\n  const handleMouseMove = (e: React.MouseEvent) => {\r\n    // Throttle mouse move events for better performance\r\n    requestAnimationFrame(() => {\r\n      const rect = e.currentTarget.getBoundingClientRect();\r\n      setMousePosition({\r\n        x: (e.clientX - rect.left) / rect.width,\r\n        y: (e.clientY - rect.top) / rect.height,\r\n      });\r\n    });\r\n  };\r\n\r\n  const handleImageLoad = () => {\r\n    setImageLoaded(true);\r\n    measureInteraction('hero_image_loaded');\r\n    trackEvent('hero_image_loaded')\r\n  };\r\n\r\n  const handleCTAClick = (action: 'book' | 'learn_more') => {\r\n    setIsBookDialogOpen(action === 'book')\r\n    trackEvent('hero_cta_click', { action })\r\n    if (action === 'book') {\r\n      navigate('/appointments/create')\r\n    } else {\r\n      navigate('/services')\r\n    }\r\n  };\r\n\r\n  return (\r\n    <LoadingOverlay isLoading={!isLoaded && !imageLoaded} fallback={<HeroSkeleton />}>\r\n      <section \r\n        className={`relative bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 py-20 md:py-32 overflow-hidden ${className}`} \r\n        role=\"banner\"\r\n        onMouseMove={handleMouseMove}\r\n        style={{ willChange: 'transform' }}\r\n      >\r\n      {/* Enhanced Background Pattern with Animated Particles */}\r\n      <div className=\"absolute inset-0 opacity-10\">\r\n        <div className=\"absolute inset-0\" style={{\r\n          backgroundImage: `url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")`,\r\n        }} />\r\n      </div>\r\n\r\n      {/* Animated Gradient Overlay */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-r from-blue-600/20 via-transparent to-indigo-600/20 animate-pulse\"></div>\r\n\r\n      {/* Enhanced Floating Elements with Interactive Animation */}\r\n      <div \r\n        className=\"absolute top-20 left-10 w-20 h-20 bg-blue-400 rounded-full opacity-20 transition-all duration-1000 ease-out\"\r\n        style={{ \r\n          transform: `translate(${mousePosition.x * 20}px, ${mousePosition.y * 20}px)`,\r\n          animation: 'float 4s ease-in-out infinite'\r\n        }}\r\n      ></div>\r\n      <div \r\n        className=\"absolute bottom-20 right-10 w-32 h-32 bg-indigo-400 rounded-full opacity-20 transition-all duration-1000 ease-out\"\r\n        style={{ \r\n          transform: `translate(${-mousePosition.x * 15}px, ${-mousePosition.y * 15}px)`,\r\n          animation: 'float 5s ease-in-out infinite 1s'\r\n        }}\r\n      ></div>\r\n      <div \r\n        className=\"absolute top-1/3 right-1/4 w-16 h-16 bg-cyan-400 rounded-full opacity-15 transition-all duration-1000 ease-out\"\r\n        style={{ \r\n          transform: `translate(${mousePosition.x * 25}px, ${-mousePosition.y * 25}px)`,\r\n          animation: 'float 3.5s ease-in-out infinite 2s'\r\n        }}\r\n      ></div>\r\n      <div \r\n        className=\"absolute bottom-1/3 left-1/4 w-24 h-24 bg-purple-400 rounded-full opacity-15 transition-all duration-1000 ease-out\"\r\n        style={{ \r\n          transform: `translate(${-mousePosition.x * 10}px, ${mousePosition.y * 10}px)`,\r\n          animation: 'float 4.5s ease-in-out infinite 1.5s'\r\n        }}\r\n      ></div>\r\n\r\n      {/* Additional Sparkle Elements */}\r\n      <div className=\"absolute top-1/4 left-1/3 w-3 h-3 bg-yellow-300 rounded-full opacity-40 animate-ping\" style={{ animationDelay: '0.5s' }}></div>\r\n      <div className=\"absolute bottom-1/4 right-1/3 w-2 h-2 bg-pink-300 rounded-full opacity-40 animate-ping\" style={{ animationDelay: '1.5s' }}></div>\r\n      <div className=\"absolute top-2/3 left-1/5 w-4 h-4 bg-green-300 rounded-full opacity-30 animate-ping\" style={{ animationDelay: '2.5s' }}></div>\r\n\r\n      {/* Optimized Particle Animation Background */}\r\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\r\n        {particles.map((particle) => (\r\n          <div\r\n            key={particle.id}\r\n            className=\"absolute w-2 h-2 bg-white rounded-full opacity-20 animate-pulse\"\r\n            style={{\r\n              left: `${particle.left}%`,\r\n              top: `${particle.top}%`,\r\n              animationDelay: `${particle.delay}s`,\r\n              animationDuration: `${particle.duration}s`,\r\n              willChange: 'opacity'\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"container mx-auto px-4 relative z-10\">\r\n        {/* Split-Screen Layout */}\r\n        <div className=\"flex flex-col lg:flex-row items-center gap-12 min-h-[600px]\">\r\n          \r\n          {/* Left Side - Content */}\r\n          <div className={`lg:w-1/2 text-center lg:text-left space-y-8 transition-all duration-1000 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'}`}>\r\n            \r\n            {/* Trust Badge with Enhanced Animation */}\r\n            <div className={`inline-flex items-center bg-blue-500/20 backdrop-blur-sm rounded-full px-6 py-3 mb-6 border border-blue-400/30 hover:bg-blue-500/30 hover:border-blue-300/50 transition-all duration-300 transform hover:scale-105 ${isLoaded ? 'animate-fade-in animate-delay-200' : ''}`}>\r\n              <Heart className=\"w-5 h-5 text-red-400 mr-3 animate-pulse\" />\r\n              <Sparkles className=\"w-4 h-4 text-yellow-300 mr-2 animate-pulse\" style={{ animationDelay: '0.5s' }} />\r\n              <span className=\"text-blue-100 text-sm font-medium\">Serving Fayoum & Attsa communities since 2015</span>\r\n            </div>\r\n\r\n            {/* Enhanced Typography Hierarchy with Staggered Animation */}\r\n            <div className=\"space-y-6\">\r\n              <h1 className=\"text-5xl md:text-6xl lg:text-7xl font-bold text-white leading-tight\">\r\n                <span className={`block mb-2 transition-all duration-700 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`} style={{ transitionDelay: '0.3s' }}>\r\n                  Advanced Dental Care\r\n                </span>\r\n                <span className={`block text-transparent bg-clip-text bg-gradient-to-r from-blue-200 via-cyan-200 to-blue-100 transition-all duration-700 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`} style={{ transitionDelay: '0.5s' }}>\r\n                  <span className=\"inline-block animate-pulse\">With Laser Technology</span>\r\n                </span>\r\n              </h1>\r\n\r\n              <p className={`text-xl md:text-2xl text-blue-100 leading-relaxed max-w-2xl mx-auto lg:mx-0 transition-all duration-700 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`} style={{ transitionDelay: '0.7s' }}>\r\n                Experience exceptional dental care at Clear Dental Centers with state-of-the-art laser technology, \r\n                expert specialists, and personalized treatment plans tailored to your needs.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Enhanced Call-to-Action Buttons with Advanced Interactions */}\r\n            <div className={`flex flex-col sm:flex-row gap-4 pt-4 transition-all duration-700 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`} style={{ transitionDelay: '0.9s' }}>\r\n              <Button \r\n                size=\"lg\" \r\n                className=\"bg-white text-blue-700 hover:bg-blue-50 px-8 py-4 text-lg font-semibold shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 hover:-translate-y-2 group relative overflow-hidden\"\r\n                onClick={() => handleCTAClick('book_appointment')}\r\n                onMouseEnter={(e) => {\r\n                  // Optimized ripple effect with requestAnimationFrame\r\n                  requestAnimationFrame(() => {\r\n                    const ripple = document.createElement('span');\r\n                    ripple.className = 'absolute inset-0 bg-blue-100 rounded-lg opacity-30 animate-ping';\r\n                    e.currentTarget.appendChild(ripple);\r\n                    setTimeout(() => {\r\n                      if (ripple.parentNode) {\r\n                        ripple.parentNode.removeChild(ripple);\r\n                      }\r\n                    }, 600);\r\n                  });\r\n                }}\r\n              >\r\n                <Calendar className=\"w-5 h-5 mr-2 group-hover:animate-bounce transition-all duration-300\" />\r\n                Book Appointment\r\n                <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-2 transition-all duration-300\" />\r\n              </Button>\r\n              \r\n              <Button \r\n                variant=\"outline\" \r\n                size=\"lg\" \r\n                className=\"border-2 border-white text-white hover:bg-white hover:text-blue-700 px-8 py-4 text-lg font-semibold backdrop-blur-sm transition-all duration-300 transform hover:scale-105 hover:-translate-y-2 group relative overflow-hidden\"\r\n                onClick={() => handleCTAClick('watch_story')}\r\n                onMouseEnter={(e) => {\r\n                  // Optimized ripple effect with requestAnimationFrame\r\n                  requestAnimationFrame(() => {\r\n                    const ripple = document.createElement('span');\r\n                    ripple.className = 'absolute inset-0 bg-white/20 rounded-lg opacity-50 animate-ping';\r\n                    e.currentTarget.appendChild(ripple);\r\n                    setTimeout(() => {\r\n                      if (ripple.parentNode) {\r\n                        ripple.parentNode.removeChild(ripple);\r\n                      }\r\n                    }, 600);\r\n                  });\r\n                }}\r\n              >\r\n                <PlayCircle className=\"w-5 h-5 mr-2 group-hover:rotate-90 transition-all duration-500\" />\r\n                Watch Our Story\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Enhanced Trust Indicators with Staggered Animation */}\r\n            <div className={`flex flex-wrap items-center gap-4 pt-6 transition-all duration-700 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`} style={{ transitionDelay: '1.1s' }}>\r\n              <div className={`flex items-center bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 border border-white/20 hover:bg-white/20 hover:scale-105 transition-all duration-300 transform ${isLoaded ? 'animate-fade-in' : ''}`} style={{ animationDelay: '1.2s' }}>\r\n                <CheckCircle className=\"w-4 h-4 text-green-400 mr-2 animate-pulse\" />\r\n                <span className=\"text-blue-100 text-sm font-medium\">HIPAA Compliant</span>\r\n              </div>\r\n              <div className={`flex items-center bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 border border-white/20 hover:bg-white/20 hover:scale-105 transition-all duration-300 transform ${isLoaded ? 'animate-fade-in' : ''}`} style={{ animationDelay: '1.4s' }}>\r\n                <Shield className=\"w-4 h-4 text-blue-300 mr-2 animate-pulse\" style={{ animationDelay: '0.5s' }} />\r\n                <span className=\"text-blue-100 text-sm font-medium\">ADA Certified</span>\r\n              </div>\r\n              <div className={`flex items-center bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 border border-white/20 hover:bg-white/20 hover:scale-105 transition-all duration-300 transform ${isLoaded ? 'animate-fade-in' : ''}`} style={{ animationDelay: '1.6s' }}>\r\n                <Award className=\"w-4 h-4 text-yellow-400 mr-2 animate-pulse\" style={{ animationDelay: '1s' }} />\r\n                <span className=\"text-blue-100 text-sm font-medium\">15+ Years Experience</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right Side - Visual Content */}\r\n          <div className={`lg:w-1/2 flex justify-center transition-all duration-1000 ${isLoaded ? 'opacity-100 translate-x-0' : 'opacity-0 translate-x-8'}`} style={{ transitionDelay: '0.4s' }}>\r\n            <div className=\"relative max-w-lg w-full group\">\r\n              \r\n              {/* Enhanced Glow Effect */}\r\n              <div className=\"absolute -inset-6 bg-gradient-to-r from-blue-400 via-cyan-400 to-indigo-400 rounded-3xl blur-3xl opacity-30 animate-pulse\"></div>\r\n              \r\n              {/* Optimized Main Hero Image */}\r\n              <div className=\"relative\">\r\n                <OptimizedImage\r\n                  src=\"/images/image1.jpg\"\r\n                  alt=\"Modern dental office with advanced laser technology and happy patient receiving treatment\"\r\n                  className=\"relative rounded-3xl shadow-2xl w-full h-auto transform hover:scale-105 transition-transform duration-500 border-4 border-white/20\"\r\n                  width={600}\r\n                  height={400}\r\n                  priority={true}\r\n                  placeholder=\"blur\"\r\n                  fallbackSrc=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDYwMCA0MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI2MDAiIGhlaWdodD0iNDAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjMwMCIgeT0iMjAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUNBM0FGIiBmb250LXNpemU9IjI0Ij5Nb2Rlcm4gRGVudGFsIE9mZmljZTwvdGV4dD4KPC9zdmc+\"\r\n                  sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 600px\"\r\n                  onLoad={handleImageLoad}\r\n                  loading=\"eager\"\r\n                />\r\n              </div>\r\n\r\n              {/* Enhanced Floating Stats Cards with Advanced Animations */}\r\n              <div className={`absolute -bottom-8 -left-8 bg-white/95 backdrop-blur-sm p-6 rounded-2xl shadow-2xl border border-white/50 hover:shadow-3xl transition-all duration-500 transform hover:-translate-y-3 hover:rotate-1 ${isLoaded ? 'animate-slide-up' : ''}`} style={{ animationDelay: '1.8s' }}>\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"flex text-yellow-400\">\r\n                    {[...Array(5)].map((_, i) => (\r\n                      <Star \r\n                        key={i} \r\n                        className=\"w-5 h-5 fill-current transition-all duration-300 hover:scale-125 cursor-pointer\" \r\n                        style={{ \r\n                          animation: `pulse 2s ease-in-out infinite`,\r\n                          animationDelay: `${i * 0.2}s` \r\n                        }} \r\n                      />\r\n                    ))}\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"text-2xl font-bold text-gray-900 animate-pulse\">4.9/5</div>\r\n                    <div className=\"text-sm text-gray-600 font-medium\">2,500+ Reviews</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className={`absolute -top-8 -right-8 bg-gradient-to-r from-green-500 to-emerald-500 text-white p-6 rounded-2xl shadow-2xl hover:shadow-3xl transition-all duration-500 transform hover:-translate-y-3 hover:-rotate-1 ${isLoaded ? 'animate-slide-down' : ''}`} style={{ animationDelay: '2s' }}>\r\n                <div className=\"text-center\">\r\n                  <div className=\"text-3xl font-bold animate-pulse\">24/7</div>\r\n                  <div className=\"text-sm opacity-90 font-medium\">Emergency Care</div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Additional Floating Element - Patient Count */}\r\n              <div className={`absolute top-1/2 -left-6 bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 rounded-xl shadow-xl hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 hover:scale-110 ${isLoaded ? 'animate-slide-right' : ''}`} style={{ animationDelay: '2.2s' }}>\r\n                <div className=\"text-center\">\r\n                  <div className=\"text-xl font-bold animate-pulse\">10K+</div>\r\n                  <div className=\"text-xs opacity-90\">Happy Patients</div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* New Floating Trust Badge */}\r\n              <div className={`absolute bottom-1/4 -right-4 bg-gradient-to-r from-blue-500 to-cyan-500 text-white p-3 rounded-full shadow-xl hover:shadow-2xl transition-all duration-500 transform hover:scale-110 hover:rotate-12 ${isLoaded ? 'animate-scale-up' : ''}`} style={{ animationDelay: '2.4s' }}>\r\n                <CheckCircle className=\"w-6 h-6 animate-pulse\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n        {/* Bottom Gradient Fade */}\r\n        <div className=\"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-white/10 to-transparent\"></div>\r\n      </section>\r\n    </LoadingOverlay>\r\n  );\r\n};\r\n\r\nexport default HeroSection;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\ServicesSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":245,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8155,8158],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8155,8158],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":290,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9878,9881],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9878,9881],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10066,10069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10066,10069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":31,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":31,"endColumn":31,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":42,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":42,"endColumn":30,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable react-refresh/only-export-components */\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { Button, Card, Badge } from '../ui';\r\nimport ServiceBookingModal from '../services/ServiceBookingModal';\r\nimport { useServiceBooking } from '../../hooks/useServiceBooking';\r\nimport { trackEvent } from '../../utils/analytics';\r\nimport {\r\n  Zap,\r\n  Shield,\r\n  Star,\r\n  Heart,\r\n  Smile,\r\n  CheckCircle,\r\n  ArrowRight,\r\n  Calendar,\r\n  Phone,\r\n  MessageCircle,\r\n  Search,\r\n  Filter,\r\n  X,\r\n  ChevronDown,\r\n  Eye,\r\n  Sparkles,\r\n  Award,\r\n  Clock,\r\n  Users\r\n} from 'lucide-react';\r\n\r\n// Service categories for filtering\r\nexport const serviceCategories = [\r\n  { id: 'all', name: 'All Services', icon: <Sparkles className=\"w-4 h-4\" /> },\r\n  { id: 'general', name: 'General Dentistry', icon: <CheckCircle className=\"w-4 h-4\" /> },\r\n  { id: 'cosmetic', name: 'Cosmetic Dentistry', icon: <Star className=\"w-4 h-4\" /> },\r\n  { id: 'orthodontics', name: 'Orthodontics', icon: <Smile className=\"w-4 h-4\" /> },\r\n  { id: 'surgery', name: 'Oral Surgery', icon: <Shield className=\"w-4 h-4\" /> },\r\n  { id: 'pediatric', name: 'Pediatric Dentistry', icon: <Heart className=\"w-4 h-4\" /> },\r\n  { id: 'emergency', name: 'Emergency Care', icon: <Zap className=\"w-4 h-4\" /> }\r\n];\r\n\r\n// Enhanced services data with categories and detailed information\r\nexport const enhancedServices = [\r\n  {\r\n    id: 'laser-treatment',\r\n    title: 'Laser Dental Treatment',\r\n    category: 'general',\r\n    shortDescription: 'Advanced laser technology for precise, comfortable procedures',\r\n    description: 'State-of-the-art laser technology for precise, comfortable, and minimally invasive dental procedures with faster healing times and reduced discomfort.',\r\n    icon: <Zap className=\"w-8 h-8\" />,\r\n    image: '/images/service-laser.jpg',\r\n    features: [\r\n      'Minimally invasive procedures',\r\n      'Faster healing times',\r\n      'Reduced bleeding and swelling',\r\n      'Precise treatment targeting',\r\n      'Comfortable patient experience'\r\n    ],\r\n    duration: '30-90 minutes',\r\n    price: 'From $150',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.9,\r\n    reviewCount: 156,\r\n    isPopular: true,\r\n    isNew: false\r\n  },\r\n  {\r\n    id: 'dental-implants',\r\n    title: 'Dental Implants',\r\n    category: 'surgery',\r\n    shortDescription: 'Permanent tooth replacement solutions',\r\n    description: 'State-of-the-art dental implants to replace missing teeth with natural-looking, permanent solutions that restore function and aesthetics.',\r\n    icon: <Shield className=\"w-8 h-8\" />,\r\n    image: '/images/service-implants.jpg',\r\n    features: [\r\n      'Permanent tooth replacement',\r\n      'Natural appearance and feel',\r\n      'Preserves jawbone structure',\r\n      'Long-lasting solution',\r\n      'Improved chewing function'\r\n    ],\r\n    duration: '2-4 hours',\r\n    price: 'From $800',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.8,\r\n    reviewCount: 89,\r\n    isPopular: true,\r\n    isNew: false\r\n  },\r\n  {\r\n    id: 'cosmetic-dentistry',\r\n    title: 'Cosmetic Dentistry',\r\n    category: 'cosmetic',\r\n    shortDescription: 'Transform your smile with aesthetic treatments',\r\n    description: 'Professional teeth whitening, veneers, and aesthetic treatments to give you the perfect smile you\\'ve always wanted.',\r\n    icon: <Star className=\"w-8 h-8\" />,\r\n    image: '/images/service-cosmetic.jpg',\r\n    features: [\r\n      'Professional teeth whitening',\r\n      'Porcelain veneers',\r\n      'Smile makeovers',\r\n      'Tooth bonding',\r\n      'Gum contouring'\r\n    ],\r\n    duration: '1-3 hours',\r\n    price: 'From $200',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.9,\r\n    reviewCount: 203,\r\n    isPopular: true,\r\n    isNew: false\r\n  },\r\n  {\r\n    id: 'root-canal',\r\n    title: 'Root Canal Treatment',\r\n    category: 'general',\r\n    shortDescription: 'Pain-free endodontic therapy',\r\n    description: 'Pain-free root canal procedures using modern techniques to save your natural teeth and eliminate infection.',\r\n    icon: <Heart className=\"w-8 h-8\" />,\r\n    image: '/images/service-root-canal.jpg',\r\n    features: [\r\n      'Pain-free procedures',\r\n      'Save natural teeth',\r\n      'Advanced techniques',\r\n      'Single-visit treatment',\r\n      'Long-term success'\r\n    ],\r\n    duration: '60-90 minutes',\r\n    price: 'From $300',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.7,\r\n    reviewCount: 134,\r\n    isPopular: false,\r\n    isNew: false\r\n  },\r\n  {\r\n    id: 'pediatric-dentistry',\r\n    title: 'Pediatric Dentistry',\r\n    category: 'pediatric',\r\n    shortDescription: 'Gentle dental care for children',\r\n    description: 'Specialized dental care for children in a comfortable, child-friendly environment with gentle techniques and patient approach.',\r\n    icon: <Smile className=\"w-8 h-8\" />,\r\n    image: '/images/service-pediatric.jpg',\r\n    features: [\r\n      'Child-friendly environment',\r\n      'Gentle techniques',\r\n      'Preventive care focus',\r\n      'Behavior management',\r\n      'Parent education'\r\n    ],\r\n    duration: '30-60 minutes',\r\n    price: 'From $80',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.9,\r\n    reviewCount: 167,\r\n    isPopular: false,\r\n    isNew: false\r\n  },\r\n  {\r\n    id: 'oral-surgery',\r\n    title: 'Oral Surgery',\r\n    category: 'surgery',\r\n    shortDescription: 'Expert surgical procedures',\r\n    description: 'Expert surgical procedures including extractions, wisdom teeth removal, and advanced oral surgery with modern techniques.',\r\n    icon: <CheckCircle className=\"w-8 h-8\" />,\r\n    image: '/images/service-surgery.jpg',\r\n    features: [\r\n      'Wisdom teeth removal',\r\n      'Tooth extractions',\r\n      'Bone grafting',\r\n      'Sinus lifts',\r\n      'Sedation options'\r\n    ],\r\n    duration: '45-120 minutes',\r\n    price: 'From $250',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.8,\r\n    reviewCount: 92,\r\n    isPopular: false,\r\n    isNew: false\r\n  },\r\n  {\r\n    id: 'orthodontics',\r\n    title: 'Orthodontic Treatment',\r\n    category: 'orthodontics',\r\n    shortDescription: 'Straighten your teeth with modern braces',\r\n    description: 'Comprehensive orthodontic treatment including traditional braces, clear aligners, and modern teeth straightening solutions.',\r\n    icon: <Smile className=\"w-8 h-8\" />,\r\n    image: '/images/service-orthodontics.jpg',\r\n    features: [\r\n      'Traditional metal braces',\r\n      'Clear ceramic braces',\r\n      'Invisible aligners',\r\n      'Retainer therapy',\r\n      'Adult orthodontics'\r\n    ],\r\n    duration: '12-24 months',\r\n    price: 'From $1200',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.8,\r\n    reviewCount: 78,\r\n    isPopular: false,\r\n    isNew: true\r\n  },\r\n  {\r\n    id: 'emergency-care',\r\n    title: 'Emergency Dental Care',\r\n    category: 'emergency',\r\n    shortDescription: '24/7 urgent dental treatment',\r\n    description: 'Immediate dental care for urgent situations including severe pain, trauma, and dental emergencies available 24/7.',\r\n    icon: <Zap className=\"w-8 h-8\" />,\r\n    image: '/images/service-emergency.jpg',\r\n    features: [\r\n      '24/7 availability',\r\n      'Immediate pain relief',\r\n      'Trauma treatment',\r\n      'Emergency extractions',\r\n      'Same-day appointments'\r\n    ],\r\n    duration: '30-120 minutes',\r\n    price: 'From $100',\r\n    availableAt: ['Fayoum', 'Attsa'],\r\n    rating: 4.9,\r\n    reviewCount: 234,\r\n    isPopular: false,\r\n    isNew: false\r\n  }\r\n];\r\n\r\ninterface ServicesSectionProps {\r\n  showFilters?: boolean;\r\n  maxServices?: number;\r\n  showBookingIntegration?: boolean;\r\n}\r\n\r\nconst ServicesSection: React.FC<ServicesSectionProps> = ({ \r\n  showFilters = true, \r\n  maxServices,\r\n  showBookingIntegration = true \r\n}) => {\r\n  const [selectedCategory, setSelectedCategory] = useState('all');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showFiltersDropdown, setShowFiltersDropdown] = useState(false);\r\n  const [expandedService, setExpandedService] = useState<string | null>(null);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [selectedServiceForBooking, setSelectedServiceForBooking] = useState<any | null>(null);\r\n  const sectionRef = useRef<HTMLElement>(null);\r\n  const impressionSentRef = useRef(false);\r\n  const navigate = useNavigate();\r\n  \r\n  // Service booking hook\r\n  const { contactForService } = useServiceBooking();\r\n\r\n  // Intersection Observer for animations + analytics impression\r\n  useEffect(() => {\r\n    const observer = new IntersectionObserver(\r\n      ([entry]) => {\r\n        if (entry.isIntersecting) {\r\n          setIsVisible(true);\r\n          if (!impressionSentRef.current) {\r\n            impressionSentRef.current = true;\r\n            trackEvent('section_view', { section: 'services' });\r\n          }\r\n        }\r\n      },\r\n      { threshold: 0.1 }\r\n    );\r\n\r\n    if (sectionRef.current) {\r\n      observer.observe(sectionRef.current);\r\n    }\r\n\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  // Filter services based on category and search\r\n  const filteredServices = enhancedServices.filter(service => {\r\n    const matchesCategory = selectedCategory === 'all' || service.category === selectedCategory;\r\n    const matchesSearch = service.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         service.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         service.features.some(feature => feature.toLowerCase().includes(searchTerm.toLowerCase()));\r\n    return matchesCategory && matchesSearch;\r\n  }).slice(0, maxServices);\r\n\r\n  const handleServiceExpand = (serviceId: string) => {\r\n    const expanded = expandedService === serviceId ? null : serviceId;\r\n    setExpandedService(expanded);\r\n    trackEvent('service_expand_toggle', { id: serviceId, expanded: !!expanded });\r\n  };\r\n\r\n  const handleBookAppointment = (service: any) => {\r\n    setSelectedServiceForBooking(service);\r\n    trackEvent('service_book_click', { id: service.id, title: service.title });\r\n  };\r\n\r\n  const handleContactForService = (service: any) => {\r\n    trackEvent('service_contact_click', { id: service.id, channel: 'whatsapp' });\r\n    contactForService(service, 'whatsapp');\r\n  };\r\n\r\n  const closeBookingModal = () => {\r\n    setSelectedServiceForBooking(null);\r\n  };\r\n\r\n  return (\r\n    <section \r\n      ref={sectionRef}\r\n      className=\"py-20 bg-white\" \r\n      role=\"region\" \r\n      aria-label=\"Dental services\"\r\n    >\r\n      <div className=\"container mx-auto px-4\">\r\n        {/* Section Header */}\r\n        <div className={`text-center mb-16 transition-all duration-1000 ${\r\n          isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'\r\n        }`}>\r\n          <Badge className=\"bg-blue-100 text-blue-800 px-4 py-2 rounded-full mb-4\">\r\n            Our Services\r\n          </Badge>\r\n          <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-6\">\r\n            Comprehensive Dental Care\r\n          </h2>\r\n          <p className=\"text-xl text-gray-600 max-w-3xl mx-auto\">\r\n            From routine cleanings to advanced procedures, we offer complete dental solutions using the latest technology and techniques.\r\n          </p>\r\n        </div>\r\n\r\n        {/* Search and Filter Controls */}\r\n        {showFilters && (\r\n          <div className={`mb-12 transition-all duration-1000 delay-200 ${\r\n            isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'\r\n          }`}>\r\n            <div className=\"flex flex-col md:flex-row gap-4 max-w-4xl mx-auto\">\r\n              {/* Search Bar */}\r\n              <div className=\"relative flex-1\">\r\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Search services...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  onBlur={() => searchTerm && trackEvent('services_search', { query: searchTerm })}\r\n                  className=\"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\"\r\n                />\r\n                {searchTerm && (\r\n                  <button\r\n                    onClick={() => setSearchTerm('')}\r\n                    className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n                  >\r\n                    <X className=\"w-5 h-5\" />\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              {/* Category Filter */}\r\n              <div className=\"relative\">\r\n                <button\r\n                  onClick={() => setShowFiltersDropdown(!showFiltersDropdown)}\r\n                  className=\"flex items-center gap-2 px-6 py-3 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 transition-all min-w-[200px] justify-between\"\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Filter className=\"w-5 h-5 text-gray-500\" />\r\n                    <span className=\"text-gray-700\">\r\n                      {serviceCategories.find(cat => cat.id === selectedCategory)?.name}\r\n                    </span>\r\n                  </div>\r\n                  <ChevronDown className={`w-4 h-4 text-gray-500 transition-transform ${\r\n                    showFiltersDropdown ? 'rotate-180' : ''\r\n                  }`} />\r\n                </button>\r\n\r\n                {showFiltersDropdown && (\r\n                  <div className=\"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-xl shadow-lg z-10\">\r\n                    {serviceCategories.map((category) => (\r\n                      <button\r\n                        key={category.id}\r\n                        onClick={() => {\r\n                          setSelectedCategory(category.id);\r\n                          setShowFiltersDropdown(false);\r\n                          trackEvent('services_category_select', { category: category.id });\r\n                        }}\r\n                        className={`w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors first:rounded-t-xl last:rounded-b-xl ${\r\n                          selectedCategory === category.id ? 'bg-blue-50 text-blue-600' : 'text-gray-700'\r\n                        }`}\r\n                      >\r\n                        {category.icon}\r\n                        <span>{category.name}</span>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Active Filters Display */}\r\n            {(selectedCategory !== 'all' || searchTerm) && (\r\n              <div className=\"flex flex-wrap gap-2 mt-4 max-w-4xl mx-auto\">\r\n                {selectedCategory !== 'all' && (\r\n                  <Badge className=\"bg-blue-100 text-blue-800 px-3 py-1 rounded-full flex items-center gap-2\">\r\n                    {serviceCategories.find(cat => cat.id === selectedCategory)?.name}\r\n                    <button\r\n                      onClick={() => setSelectedCategory('all')}\r\n                      className=\"hover:bg-blue-200 rounded-full p-0.5\"\r\n                    >\r\n                      <X className=\"w-3 h-3\" />\r\n                    </button>\r\n                  </Badge>\r\n                )}\r\n                {searchTerm && (\r\n                  <Badge className=\"bg-gray-100 text-gray-800 px-3 py-1 rounded-full flex items-center gap-2\">\r\n                    Search: \"{searchTerm}\"\r\n                    <button\r\n                      onClick={() => setSearchTerm('')}\r\n                      className=\"hover:bg-gray-200 rounded-full p-0.5\"\r\n                    >\r\n                      <X className=\"w-3 h-3\" />\r\n                    </button>\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Services Grid */}\r\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16\">\r\n          {filteredServices.map((service, index) => (\r\n            <Card \r\n              key={service.id} \r\n              className={`group relative overflow-hidden hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-3 border-0 bg-gradient-to-br from-white to-gray-50 ${\r\n                isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'\r\n              }`}\r\n              data-transition-delay={`${index * 100 + 400}ms`}\r\n            >\r\n              {/* Service Badges */}\r\n              <div className=\"absolute top-4 left-4 z-10 flex gap-2\">\r\n                {service.isPopular && (\r\n                  <Badge className=\"bg-gradient-to-r from-orange-500 to-red-500 text-white px-2 py-1 text-xs\">\r\n                    <Award className=\"w-3 h-3 mr-1\" />\r\n                    Popular\r\n                  </Badge>\r\n                )}\r\n                {service.isNew && (\r\n                  <Badge className=\"bg-gradient-to-r from-green-500 to-emerald-500 text-white px-2 py-1 text-xs\">\r\n                    <Sparkles className=\"w-3 h-3 mr-1\" />\r\n                    New\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n\r\n              {/* Service Image */}\r\n              <div className=\"relative h-48 overflow-hidden\">\r\n                <img\r\n                  src={service.image}\r\n                  alt={service.title}\r\n                  className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\r\n                  loading=\"lazy\"\r\n                  onError={(e) => {\r\n                    const target = e.target as HTMLImageElement;\r\n                    target.src = `data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUNBM0FGIiBmb250LXNpemU9IjE4Ij4ke3NlcnZpY2UudGl0bGV9PC90ZXh0Pgo8L3N2Zz4=`;\r\n                  }}\r\n                />\r\n                <div className=\"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\r\n                \r\n                {/* Quick View Button */}\r\n                <button\r\n                  onClick={() => handleServiceExpand(service.id)}\r\n                  className=\"absolute top-4 right-4 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-white hover:scale-110\"\r\n                >\r\n                  <Eye className=\"w-5 h-5 text-gray-700\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Service Content */}\r\n              <div className=\"p-6\">\r\n                {/* Service Icon and Title */}\r\n                <div className=\"flex items-center gap-4 mb-4\">\r\n                  <div className=\"flex items-center justify-center w-14 h-14 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl text-white group-hover:scale-110 transition-transform duration-300\">\r\n                    {service.icon}\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors\">\r\n                      {service.title}\r\n                    </h3>\r\n                    <div className=\"flex items-center gap-2 mt-1\">\r\n                      <div className=\"flex items-center gap-1\">\r\n                        <Star className=\"w-4 h-4 text-yellow-400 fill-current\" />\r\n                        <span className=\"text-sm text-gray-600\">{service.rating}</span>\r\n                      </div>\r\n                      <span className=\"text-sm text-gray-400\"></span>\r\n                      <span className=\"text-sm text-gray-600\">{service.reviewCount} reviews</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Service Description */}\r\n                <p className=\"text-gray-600 mb-4 leading-relaxed\">\r\n                  {service.shortDescription}\r\n                </p>\r\n\r\n                {/* Service Details */}\r\n                <div className=\"flex items-center justify-between text-sm text-gray-500 mb-6\">\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <Clock className=\"w-4 h-4\" />\r\n                    <span>{service.duration}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <Users className=\"w-4 h-4\" />\r\n                    <span>{service.availableAt.join(', ')}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Expandable Details */}\r\n                {expandedService === service.id && (\r\n                  <div className=\"mb-6 p-4 bg-gray-50 rounded-xl animate-in slide-in-from-top duration-300\">\r\n                    <p className=\"text-gray-700 mb-4\">{service.description}</p>\r\n                    <div className=\"space-y-2\">\r\n                      <h4 className=\"font-semibold text-gray-900\">Key Features:</h4>\r\n                      <ul className=\"space-y-1\">\r\n                        {service.features.map((feature, idx) => (\r\n                          <li key={idx} className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                            <CheckCircle className=\"w-4 h-4 text-green-500 flex-shrink-0\" />\r\n                            {feature}\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Action Buttons */}\r\n                {showBookingIntegration && (\r\n                  <div className=\"flex gap-2\">\r\n                    <Button \r\n                      onClick={() => handleBookAppointment(service)}\r\n                      className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white\"\r\n                    >\r\n                      <Calendar className=\"w-4 h-4 mr-2\" />\r\n                      Book Now\r\n                    </Button>\r\n                    <Button \r\n                      variant=\"outline\" \r\n                      onClick={() => handleContactForService(service)}\r\n                      className=\"px-4\"\r\n                    >\r\n                      <Phone className=\"w-4 h-4\" />\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n\r\n                {!showBookingIntegration && (\r\n                  <div className=\"flex gap-2\">\r\n                    <Button \r\n                      variant=\"outline\" \r\n                      onClick={() => handleServiceExpand(service.id)}\r\n                      className=\"flex-1 group-hover:bg-blue-600 group-hover:text-white group-hover:border-blue-600 transition-all duration-300\"\r\n                    >\r\n                      {expandedService === service.id ? 'Show Less' : 'Learn More'}\r\n                      <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\" />\r\n                    </Button>\r\n                    <Link to={`/services/${service.id}`}>\r\n                      <Button \r\n                        variant=\"outline\"\r\n                        className=\"px-4\"\r\n                        onClick={() => trackEvent('service_view_details', { id: service.id })}\r\n                      >\r\n                        <Eye className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </Link>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n\r\n        {/* No Results Message */}\r\n        {filteredServices.length === 0 && (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center\">\r\n              <Search className=\"w-8 h-8 text-gray-400\" />\r\n            </div>\r\n            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No services found</h3>\r\n            <p className=\"text-gray-600 mb-4\">\r\n              Try adjusting your search terms or filters to find what you're looking for.\r\n            </p>\r\n            <Button \r\n              variant=\"outline\" \r\n              onClick={() => {\r\n                setSearchTerm('');\r\n                setSelectedCategory('all');\r\n              }}\r\n            >\r\n              Clear Filters\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Call to Action */}\r\n        <div className={`text-center transition-all duration-1000 delay-600 ${\r\n          isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'\r\n        }`}>\r\n          <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-8 mb-8\">\r\n            <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">\r\n              Ready to Transform Your Smile?\r\n            </h3>\r\n            <p className=\"text-gray-600 mb-6 max-w-2xl mx-auto\">\r\n              Our experienced team is here to provide you with the highest quality dental care using the latest technology and techniques.\r\n            </p>\r\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\r\n              <Button size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4\" onClick={() => { trackEvent('services_cta_book'); navigate('/appointments/create'); }}>\r\n                <Calendar className=\"w-5 h-5 mr-2\" />\r\n                Book Appointment\r\n              </Button>\r\n              <Button size=\"lg\" variant=\"outline\" className=\"border-2 border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white px-8 py-4\" onClick={() => { trackEvent('services_cta_whatsapp'); window.open('https://wa.me/201017848825?text=Hi%2C%20I%27d%20like%20a%20consultation%20about%20your%20services', '_blank'); }}>\r\n                <MessageCircle className=\"w-5 h-5 mr-2\" />\r\n                WhatsApp Consultation\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {!maxServices && (\r\n            <div className=\"flex justify-center\">\r\n              <Badge className=\"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 px-6 py-3 rounded-full text-lg font-medium\">\r\n                 New Patient Special: 20% Off First Visit\r\n              </Badge>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Service Booking Modal */}\r\n      {selectedServiceForBooking && (\r\n        <ServiceBookingModal\r\n          service={selectedServiceForBooking}\r\n          isOpen={!!selectedServiceForBooking}\r\n          onClose={closeBookingModal}\r\n        />\r\n      )}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default ServicesSection;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\homepage\\TeamSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\inventory\\InventoryDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1341,1344],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1341,1344],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDashboardData'. Either include it or remove the dependency array.","line":54,"column":6,"nodeType":"ArrayExpression","endLine":54,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [clinicId, fetchDashboardData]","fix":{"range":[1637,1647],"text":"[clinicId, fetchDashboardData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n  Package, \n  AlertTriangle, \n  Activity, \n  Plus,\n  Calendar,\n  DollarSign,\n  BarChart3\n} from 'lucide-react';\nimport { Card, Button, Badge, Alert } from '../ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { inventoryService, type InventoryDashboard as DashboardData } from '../../services/inventoryService';\nimport toast from 'react-hot-toast';\nimport { format as formatDate } from 'date-fns';\n\ninterface InventoryDashboardProps {\n  clinicId?: string;\n}\n\nconst InventoryDashboard: React.FC<InventoryDashboardProps> = ({ clinicId }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [dashboardData, setDashboardData] = useState<DashboardData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const canManageInventory = user?.role === 'admin' || user?.role === 'staff';\n\n  const fetchDashboardData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await inventoryService.getInventoryDashboard(clinicId);\n      \n      if (response.success) {\n        setDashboardData(response.data);\n      } else {\n        throw new Error(response.message);\n      }\n    } catch (err: any) {\n      setError(err.message || t('inventory.errors.fetchFailed'));\n      toast.error(t('inventory.errors.fetchFailed'));\n      console.error('Error fetching inventory dashboard:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchDashboardData();\n  }, [clinicId]);\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(amount);\n  };\n\n\n  const getMovementTypeColor = (type: string) => {\n    return inventoryService.getMovementTypeColor(type);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center py-12\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-3 text-gray-600\">{t('inventory.loading')}</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <Alert variant=\"error\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        {error}\n      </Alert>\n    );\n  }\n\n  if (!dashboardData) {\n    return (\n      <Alert variant=\"warning\">\n        <Package className=\"h-4 w-4\" />\n        {t('inventory.noDashboardData')}\n      </Alert>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center gap-2\">\n            <Package className=\"h-6 w-6\" />\n            {t('inventory.title')}\n          </h2>\n          <p className=\"text-gray-600\">{t('inventory.subtitle')}</p>\n        </div>\n        {canManageInventory && (\n          <div className=\"flex gap-3\">\n            <Button variant=\"outline\" onClick={fetchDashboardData}>\n              {t('common.refresh')}\n            </Button>\n            <Button variant=\"primary\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              {t('inventory.addItem')}\n            </Button>\n          </div>\n        )}\n      </div>\n\n      {/* Key Metrics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">{t('inventory.totalItems')}</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{dashboardData.totalItems}</p>\n            </div>\n            <div className=\"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center\">\n              <Package className=\"h-6 w-6 text-blue-600\" />\n            </div>\n          </div>\n        </Card>\n\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">{t('inventory.totalValue')}</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{formatCurrency(dashboardData.totalValue)}</p>\n            </div>\n            <div className=\"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center\">\n              <DollarSign className=\"h-6 w-6 text-green-600\" />\n            </div>\n          </div>\n        </Card>\n\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">{t('inventory.lowStockItems')}</p>\n              <p className=\"text-2xl font-bold text-yellow-600\">{dashboardData.lowStockItems.count}</p>\n            </div>\n            <div className=\"h-12 w-12 bg-yellow-100 rounded-lg flex items-center justify-center\">\n              <AlertTriangle className=\"h-6 w-6 text-yellow-600\" />\n            </div>\n          </div>\n        </Card>\n\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">{t('inventory.expiringItems')}</p>\n              <p className=\"text-2xl font-bold text-red-600\">{dashboardData.expiringItems.count}</p>\n            </div>\n            <div className=\"h-12 w-12 bg-red-100 rounded-lg flex items-center justify-center\">\n              <Calendar className=\"h-6 w-6 text-red-600\" />\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Stock Summary by Category */}\n      <Card className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\n            <BarChart3 className=\"h-5 w-5\" />\n            {t('inventory.stockByCategory')}\n          </h3>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {dashboardData.stockSummary.map((category) => (\n            <div key={category._id} className=\"border rounded-lg p-4\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <h4 className=\"font-medium text-gray-900 capitalize\">\n                  {t(`inventory.categories.${category._id}`, category._id)}\n                </h4>\n                <Badge className=\"bg-gray-100 text-gray-800\">{category.totalItems} {t('inventory.items')}</Badge>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600\">{t('inventory.totalValue')}:</span>\n                  <span className=\"font-medium\">{formatCurrency(category.totalValue)}</span>\n                </div>\n                \n                {category.lowStockItems > 0 && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-yellow-600\">{t('inventory.lowStock')}:</span>\n                    <span className=\"font-medium text-yellow-600\">{category.lowStockItems}</span>\n                  </div>\n                )}\n                \n                {category.outOfStockItems > 0 && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-red-600\">{t('inventory.outOfStock')}:</span>\n                    <span className=\"font-medium text-red-600\">{category.outOfStockItems}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </Card>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Low Stock Items */}\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\n              <AlertTriangle className=\"h-5 w-5 text-yellow-500\" />\n              {t('inventory.lowStockAlert')}\n            </h3>\n            {dashboardData.lowStockItems.count > 0 && (\n              <Badge className=\"bg-yellow-100 text-yellow-800\">\n                {dashboardData.lowStockItems.count}\n              </Badge>\n            )}\n          </div>\n\n          <div className=\"space-y-3\">\n            {dashboardData.lowStockItems.items.slice(0, 5).map((item) => (\n              <div key={item.id} className=\"flex items-center justify-between p-3 bg-yellow-50 rounded-lg\">\n                <div className=\"flex-1\">\n                  <p className=\"font-medium text-gray-900\">{item.name}</p>\n                  <p className=\"text-sm text-gray-600\">{item.sku}</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-sm font-medium text-yellow-700\">\n                    {item.currentStock} {item.unit}\n                  </p>\n                  <p className=\"text-xs text-yellow-600\">\n                    {t('inventory.minStock')}: {item.minimumStock}\n                  </p>\n                </div>\n              </div>\n            ))}\n            \n            {dashboardData.lowStockItems.count === 0 && (\n              <div className=\"text-center py-8 text-gray-500\">\n                <AlertTriangle className=\"h-8 w-8 mx-auto mb-2\" />\n                <p>{t('inventory.noLowStockItems')}</p>\n              </div>\n            )}\n\n            {dashboardData.lowStockItems.count > 5 && (\n              <div className=\"text-center\">\n                <Button variant=\"outline\" size=\"sm\">\n                  {t('inventory.viewAllLowStock')} ({dashboardData.lowStockItems.count - 5} {t('inventory.more')})\n                </Button>\n              </div>\n            )}\n          </div>\n        </Card>\n\n        {/* Recent Stock Movements */}\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\n              <Activity className=\"h-5 w-5 text-blue-500\" />\n              {t('inventory.recentMovements')}\n            </h3>\n          </div>\n\n          <div className=\"space-y-3\">\n            {dashboardData.recentMovements.map((movement) => (\n              <div key={movement.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                <div className=\"flex-1\">\n                  <p className=\"font-medium text-gray-900\">{movement.inventoryItem.name}</p>\n                  <p className=\"text-sm text-gray-600\">{movement.description || movement.reason}</p>\n                  <p className=\"text-xs text-gray-500\">\n                    {formatDate(new Date(movement.createdAt), 'MMM dd, yyyy HH:mm')}\n                  </p>\n                </div>\n                <div className=\"text-right\">\n                  <Badge className={getMovementTypeColor(movement.type)}>\n                    {movement.type === 'in' ? '+' : movement.type === 'out' ? '-' : ''}{movement.quantity}\n                  </Badge>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    {movement.performedBy.firstName} {movement.performedBy.lastName}\n                  </p>\n                </div>\n              </div>\n            ))}\n            \n            {dashboardData.recentMovements.length === 0 && (\n              <div className=\"text-center py-8 text-gray-500\">\n                <Activity className=\"h-8 w-8 mx-auto mb-2\" />\n                <p>{t('inventory.noRecentMovements')}</p>\n              </div>\n            )}\n          </div>\n        </Card>\n      </div>\n\n      {/* Expiring Items */}\n      {dashboardData.expiringItems.count > 0 && (\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\n              <Calendar className=\"h-5 w-5 text-red-500\" />\n              {t('inventory.expiringItemsAlert')}\n            </h3>\n            <Badge className=\"bg-red-100 text-red-800\">\n              {dashboardData.expiringItems.count} {t('inventory.expiringSoon')}\n            </Badge>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {dashboardData.expiringItems.items.map((item) => (\n              <div key={item.id} className=\"p-4 border border-red-200 rounded-lg bg-red-50\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h4 className=\"font-medium text-gray-900\">{item.name}</h4>\n                  <Badge className=\"bg-red-100 text-red-800\">\n                    {item.daysUntilExpiry !== null && item.daysUntilExpiry !== undefined && item.daysUntilExpiry <= 0 \n                      ? t('inventory.expired')\n                      : `${item.daysUntilExpiry || 0} ${t('inventory.daysLeft')}`\n                    }\n                  </Badge>\n                </div>\n                <p className=\"text-sm text-gray-600 mb-1\">{item.sku}</p>\n                <p className=\"text-sm text-gray-600\">\n                  {t('inventory.expiryDate')}: {formatDate(new Date(item.expiryDate!), 'MMM dd, yyyy')}\n                </p>\n                <p className=\"text-sm text-gray-600\">\n                  {t('inventory.currentStock')}: {item.currentStock} {item.unit}\n                </p>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n};\n\nexport default InventoryDashboard;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\layout\\Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\layout\\Header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'navigate' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":31,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'getBreadcrumb'. Either include it or remove the dependency array.","line":337,"column":53,"nodeType":"ArrayExpression","endLine":337,"endColumn":75,"suggestions":[{"desc":"Update the dependencies array to be: [getBreadcrumb]","fix":{"range":[10509,10531],"text":"[getBreadcrumb]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":350,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":350,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10757,10760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10757,10760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":651,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":651,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26602,26605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26602,26605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":654,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":654,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26767,26770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26767,26770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":754,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":754,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33050,33053],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33050,33053],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":757,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":757,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33215,33218],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33215,33218],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback, useMemo, memo } from 'react';\nimport { Link, useLocation, useNavigate } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../../hooks/useAuth';\nimport { useClinic } from '../../hooks/useClinic';\nimport LanguageSwitcher from '../common/LanguageSwitcher';\nimport { NotificationDropdown } from '../notifications';\nimport {\n  Menu,\n  X,\n  ChevronDown,\n  Home,\n  Calendar,\n  Users,\n  FileText,\n  CreditCard,\n  BarChart3,\n  Settings,\n  LogOut,\n  ChevronRight,\n  Stethoscope,\n  Package\n} from 'lucide-react';\nimport { Badge } from '../ui';\nimport { Button } from '../ui';\n\nconst Header = memo(() => {\n  const { t } = useTranslation();\n  const { user, logout } = useAuth();\n  const { clinics, selectedClinic, setSelectedClinicById } = useClinic();\n  const navigate = useNavigate();\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const [isProfileOpen, setIsProfileOpen] = useState(false);\n\n  const [isScrolled, setIsScrolled] = useState(false);\n  const [isMoreMenuOpen, setIsMoreMenuOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const location = useLocation();\n  const moreMenuRef = useRef<HTMLDivElement>(null);\n  const profileRef = useRef<HTMLDivElement>(null);\n\n  const mobileMenuRef = useRef<HTMLDivElement>(null);\n  \n  // Search functionality removed\n\n  // Optimized scroll handler with debouncing for performance\n  useEffect(() => {\n    let ticking = false;\n\n    const handleScroll = () => {\n      if (!ticking) {\n        requestAnimationFrame(() => {\n          setIsScrolled(window.scrollY > 10);\n          ticking = false;\n        });\n        ticking = true;\n      }\n    };\n\n    window.addEventListener('scroll', handleScroll, { passive: true });\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  // Add animation class when component mounts\n  useEffect(() => {\n    const header = document.querySelector('header');\n    if (header) {\n      setTimeout(() => {\n        header.classList.add('header-loaded');\n      }, 100);\n    }\n  }, []);\n\n\n\n  // Optimized click outside handler\n  const handleClickOutside = useCallback((event: MouseEvent) => {\n    const target = event.target as Node;\n\n    // Batch state updates for better performance\n    const updates: (() => void)[] = [];\n\n    if (profileRef.current && !profileRef.current.contains(target)) {\n      updates.push(() => setIsProfileOpen(false));\n    }\n\n    if (mobileMenuRef.current && !mobileMenuRef.current.contains(target)) {\n      updates.push(() => setIsMenuOpen(false));\n      // Restore body scroll when closing mobile menu\n      updates.push(() => {\n        document.body.style.overflow = 'unset';\n      });\n    }\n\n    if (moreMenuRef.current && !moreMenuRef.current.contains(target)) {\n      updates.push(() => setIsMoreMenuOpen(false));\n    }\n\n    // Execute all updates in a single batch\n    if (updates.length > 0) {\n      updates.forEach(update => update());\n    }\n  }, []);\n\n  // Click outside handlers effect\n  useEffect(() => {\n    // Only add listener if any dropdown is open for performance\n    if (isProfileOpen || isMenuOpen || isMoreMenuOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, [isProfileOpen, isMenuOpen, isMoreMenuOpen, handleClickOutside]);\n\n  // Close mobile menu on route change\n  useEffect(() => {\n    setIsMenuOpen(false);\n    setIsProfileOpen(false);\n    setIsMoreMenuOpen(false);\n    // Restore body scroll when route changes\n    document.body.style.overflow = 'unset';\n  }, [location.pathname]);\n\n  // Cleanup body scroll on unmount\n  useEffect(() => {\n    return () => {\n      document.body.style.overflow = 'unset';\n    };\n  }, []);\n\n  const toggleMenu = useCallback(() => {\n    setIsMenuOpen(prev => {\n      const newState = !prev;\n      // Close other dropdowns when opening mobile menu\n      if (newState) {\n        setIsProfileOpen(false);\n        setIsMoreMenuOpen(false);\n        // Prevent body scroll when menu is open\n        document.body.style.overflow = 'hidden';\n      } else {\n        // Restore body scroll when menu is closed\n        document.body.style.overflow = 'unset';\n      }\n      return newState;\n    });\n  }, []);\n\n  const toggleProfile = () => {\n    setIsProfileOpen(!isProfileOpen);\n    // Close other dropdowns\n    if (!isProfileOpen) {\n      setIsMenuOpen(false);\n    }\n  };\n\n\n\n  const _toggleMoreMenu = () => {\n    setIsMoreMenuOpen(!isMoreMenuOpen);\n    // Close other dropdowns\n    if (!isMoreMenuOpen) {\n      setIsProfileOpen(false);\n      setIsMenuOpen(false);\n    }\n  };\n\n  const handleClinicChange = useCallback(async (clinicId: string) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      setSelectedClinicById(clinicId);\n    } catch (err) {\n      setError('Failed to switch clinic. Please try again.');\n      console.error('Clinic change error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [setSelectedClinicById]);\n\n  const handleLogout = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      await logout();\n    } catch (err) {\n      setError('Logout failed. Please try again.');\n      console.error('Logout error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [logout]);\n\n  // Search submit logic removed with search UI cleanup\n\n  // Enhanced keyboard shortcuts and accessibility\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Ctrl/Cmd + K search shortcut removed\n\n      // Escape to close dropdowns and restore focus\n      if (e.key === 'Escape') {\n        setIsProfileOpen(false);\n        setIsMenuOpen(false);\n        setIsMoreMenuOpen(false);\n\n        // Restore focus to the trigger element\n        if (isMenuOpen) {\n          (document.querySelector('[aria-label*=\"Open menu\"]') as HTMLElement)?.focus();\n        }\n        if (isProfileOpen) {\n          (document.querySelector('[aria-label*=\"User menu\"]') as HTMLElement)?.focus();\n        }\n      }\n\n      // Tab navigation enhancement for mobile menu\n      if (e.key === 'Tab' && isMenuOpen) {\n        const mobileMenu = mobileMenuRef.current;\n        if (mobileMenu) {\n          const focusableElements = mobileMenu.querySelectorAll(\n            'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n          );\n          const firstElement = focusableElements[0] as HTMLElement;\n          const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;\n\n          if (e.shiftKey && document.activeElement === firstElement) {\n            e.preventDefault();\n            lastElement?.focus();\n          } else if (!e.shiftKey && document.activeElement === lastElement) {\n            e.preventDefault();\n            firstElement?.focus();\n          }\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isMenuOpen, isProfileOpen]);\n\n  // Enhanced keyboard navigation for dropdowns\n  const handleDropdownKeyDown = (e: React.KeyboardEvent, type: 'profile' | 'more') => {\n    const isProfile = type === 'profile';\n    const isMore = type === 'more';\n    const isOpen = isProfile ? isProfileOpen : isMore ? isMoreMenuOpen : false;\n\n    if (!isOpen) {\n      // Open dropdown on Enter or Space when closed\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        if (isProfile) {\n          setIsProfileOpen(true);\n        } else if (isMore) {\n          setIsMoreMenuOpen(true);\n        }\n      }\n      return;\n    }\n\n    switch (e.key) {\n      case 'Escape':\n        e.preventDefault();\n        if (isProfile) {\n          setIsProfileOpen(false);\n          // Return focus to trigger button\n          (document.querySelector('[aria-label*=\"User menu\"]') as HTMLElement)?.focus();\n        } else if (isMore) {\n          setIsMoreMenuOpen(false);\n          (document.querySelector('[aria-expanded=\"true\"]') as HTMLElement)?.focus();\n        }\n        break;\n      case 'ArrowDown':\n        e.preventDefault();\n        // Focus first menu item\n        const firstMenuItem = document.querySelector(`[role=\"menu\"] a, [role=\"menu\"] button`);\n        (firstMenuItem as HTMLElement)?.focus();\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        // Focus last menu item\n        const menuItems = document.querySelectorAll(`[role=\"menu\"] a, [role=\"menu\"] button`);\n        const lastMenuItem = menuItems[menuItems.length - 1];\n        (lastMenuItem as HTMLElement)?.focus();\n        break;\n      case 'Tab':\n        // Allow natural tab navigation but close dropdown when tabbing out\n        setTimeout(() => {\n          const activeElement = document.activeElement;\n          const dropdown = document.querySelector('[role=\"menu\"]');\n          if (dropdown && !dropdown.contains(activeElement)) {\n            if (isProfile) setIsProfileOpen(false);\n            if (isMore) setIsMoreMenuOpen(false);\n          }\n        }, 0);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const isActive = useCallback((path: string) => {\n    return location.pathname === path;\n  }, [location.pathname]);\n\n  const _hasAccess = useCallback((roles: string[]) => {\n    return user && roles.includes(user.role);\n  }, [user]);\n\n  // Get breadcrumb for current page\n  const getBreadcrumb = () => {\n    const pathSegments = location.pathname.split('/').filter(Boolean);\n    if (pathSegments.length === 0) return null;\n\n    const breadcrumbMap: { [key: string]: string } = {\n      dashboard: t('dashboard'),\n      appointments: t('appointments'),\n      patients: t('patients'),\n      medications: t('medications'),\n      prescriptions: t('prescriptions'),\n      billing: t('billing'),\n      reports: t('reports'),\n      'staff-scheduling': t('staffScheduling'),\n      clinics: t('clinics'),\n      search: t('search', 'Search'),\n      profile: t('profile'),\n      settings: t('settings'),\n      admin: t('admin', 'Admin'),\n      'multi-clinic': t('multiClinic', 'Multi-Clinic Dashboard'),\n    };\n\n    return pathSegments.map((segment, index) => ({\n      name: breadcrumbMap[segment] || segment,\n      path: '/' + pathSegments.slice(0, index + 1).join('/'),\n      isLast: index === pathSegments.length - 1\n    }));\n  };\n\n  const breadcrumb = useMemo(() => getBreadcrumb(), [location.pathname, t]);\n\n  // Memoized navigation link component for performance\n  const _NavigationLink = memo(({\n    to,\n    icon: Icon,\n    label,\n    shortLabel,\n    color,\n    variant = 'desktop',\n    onClick\n  }: {\n    to: string;\n    icon: any;\n    label: string;\n    shortLabel?: string;\n    color: string;\n    variant?: 'desktop' | 'tablet' | 'mobile';\n    onClick?: () => void;\n  }) => {\n    const active = isActive(to);\n\n    if (variant === 'mobile') {\n      return (\n        <Link\n          to={to}\n          className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${active ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'\n            }`}\n          onClick={onClick}\n        >\n          <div className={`flex items-center justify-center w-10 h-10 rounded-lg bg-${color}-50 mr-4 flex-shrink-0`}>\n            {typeof Icon === 'string' ? (\n              Icon === 'medication' ? (\n                <svg className={`w-5 h-5 text-${color}-600`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n                </svg>\n              ) : (\n                <svg className={`w-5 h-5 text-${color}-600`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                </svg>\n              )\n            ) : (\n              <Icon className={`w-5 h-5 text-${color}-600`} />\n            )}\n          </div>\n          <span className=\"flex-1\">{label}</span>\n          <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n        </Link>\n      );\n    }\n\n    if (variant === 'tablet') {\n      return (\n        <Link\n          to={to}\n          className={`inline-flex items-center p-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${active ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'\n            }`}\n          title={label}\n        >\n          {typeof Icon === 'string' ? (\n            Icon === 'medication' ? (\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n              </svg>\n            ) : (\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n              </svg>\n            )\n          ) : (\n            <Icon className=\"w-5 h-5\" />\n          )}\n        </Link>\n      );\n    }\n\n    // Desktop variant\n    return (\n      <Link\n        to={to}\n        className={`inline-flex items-center px-3 xl:px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${active ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'\n          }`}\n      >\n        {typeof Icon === 'string' ? (\n          Icon === 'medication' ? (\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n            </svg>\n          ) : (\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n            </svg>\n          )\n        ) : (\n          <Icon className=\"w-4 h-4 mr-2\" />\n        )}\n        <span className=\"hidden xl:inline\">{label}</span>\n        <span className=\"xl:hidden\">{shortLabel || label}</span>\n      </Link>\n    );\n  });\n\n  // Memoized navigation items for performance\n  const _navigationItems = useMemo(() => [\n    {\n      path: '/dashboard',\n      icon: Home,\n      label: t('dashboard'),\n      shortLabel: 'Dashboard',\n      color: 'blue',\n      roles: ['dentist', 'staff', 'admin', 'patient']\n    },\n    {\n      path: '/appointments',\n      icon: Calendar,\n      label: t('appointments'),\n      shortLabel: 'Appointments',\n      color: 'green',\n      roles: ['dentist', 'staff', 'admin', 'patient']\n    },\n    {\n      path: '/patients',\n      icon: Users,\n      label: t('patients'),\n      shortLabel: 'Patients',\n      color: 'purple',\n      roles: ['dentist', 'staff', 'admin']\n    },\n    {\n      path: '/medications',\n      icon: 'medication',\n      label: t('medications'),\n      shortLabel: 'Meds',\n      color: 'orange',\n      roles: ['dentist', 'admin']\n    },\n    {\n      path: '/prescriptions',\n      icon: FileText,\n      label: t('prescriptions'),\n      shortLabel: 'Scripts',\n      color: 'indigo',\n      roles: ['dentist', 'staff', 'admin', 'patient']\n    }\n  ], [t]);\n\n  const _moreNavigationItems = useMemo(() => [\n    {\n      path: '/billing',\n      icon: CreditCard,\n      label: t('billing'),\n      color: 'emerald',\n      roles: ['dentist', 'staff', 'admin']\n    },\n    {\n      path: '/inventory',\n      icon: Package,\n      label: t('inventory'),\n      color: 'cyan',\n      roles: ['dentist', 'staff', 'admin']\n    },\n    {\n      path: '/reports',\n      icon: BarChart3,\n      label: t('reports'),\n      color: 'pink',\n      roles: ['dentist', 'staff', 'admin', 'patient']\n    },\n    {\n      path: '/staff-scheduling',\n      icon: Calendar,\n      label: t('staffScheduling'),\n      color: 'yellow',\n      roles: ['dentist', 'staff', 'admin']\n    },\n    {\n      path: '/treatments',\n      icon: Stethoscope,\n      label: t('treatments'),\n      color: 'violet',\n      roles: ['dentist', 'staff', 'admin']\n    },\n    {\n      path: '/clinics',\n      icon: 'building',\n      label: t('clinics'),\n      color: 'red',\n      roles: ['admin']\n    }\n  ], [t]);\n\n  return (\n    <>\n      {/* Skip Links for Accessibility */}\n      <div className=\"sr-only focus-within:not-sr-only\">\n        <a\n          href=\"#main-content\"\n          className=\"absolute top-0 left-0 bg-blue-600 text-white px-4 py-2 rounded-br-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 z-[100]\"\n        >\n          Skip to main content\n        </a>\n        <a\n          href=\"#main-navigation\"\n          className=\"absolute top-0 left-32 bg-blue-600 text-white px-4 py-2 rounded-br-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 z-[100]\"\n        >\n          Skip to navigation\n        </a>\n      </div>\n\n      <header className={`bg-gradient-to-r from-blue-50/95 via-white/98 to-blue-50/95 backdrop-blur-lg ${isScrolled ? 'shadow-lg border-b border-blue-100/80' : 'border-b border-gray-100/60'} sticky top-0 z-50 transition-all duration-300`} role=\"banner\">\n        <div className=\"w-full px-4 sm:px-6 lg:px-8 transition-all duration-300\">\n          <div className={`flex justify-between items-center transition-all duration-300 ${isScrolled ? 'h-14' : 'h-16'}`}>\n            {/* Logo and Navigation */}\n            <div className=\"flex items-center\">\n              <div className=\"flex-shrink-0 flex items-center space-x-3\">\n                <Link to=\"/\" className=\"flex items-center group\">\n                  <div className=\"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 text-white rounded-2xl mr-4 shadow-lg group-hover:shadow-blue-200/50 transition-all duration-300 group-hover:scale-105 group-active:scale-95 ring-2 ring-blue-100/50 animate-pulse-subtle\">\n                    <Stethoscope className=\"w-7 h-7 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-6\" />\n                  </div>\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-700 bg-clip-text text-transparent transition-all duration-300\">\n                      DentalPro\n                    </span>\n                    <span className=\"text-xs text-blue-500 font-semibold -mt-1 tracking-wide\">MANAGER</span>\n                  </div>\n                </Link>\n              </div>\n\n              {/* Search removed for a cleaner professional header */}\n            </div>\n\n            {/* Desktop Navigation */}\n            {user && (\n              <nav id=\"main-navigation\" className=\"hidden lg:flex lg:items-center lg:space-x-2\" role=\"navigation\" aria-label=\"Main navigation\">\n                <Link\n                  to=\"/dashboard\"\n                  className={`inline-flex items-center px-4 xl:px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 hover:scale-105 ${isActive('/dashboard') ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-200/50' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600 hover:shadow-md'}`}\n                >\n                  <Home className=\"w-4 h-4 mr-2\" />\n                  <span className=\"hidden xl:inline\">{t('navigation.dashboard', 'Dashboard')}</span>\n                  <span className=\"xl:hidden\">{t('navigation.dashboard_short', 'Dashboard')}</span>\n                </Link>\n                <Link\n                  to=\"/appointments\"\n                  className={`inline-flex items-center px-4 xl:px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 hover:scale-105 ${isActive('/appointments') ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-200/50' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600 hover:shadow-md'}`}\n                >\n                  <Calendar className=\"w-4 h-4 mr-2\" />\n                  <span className=\"hidden xl:inline\">{t('navigation.appointments', 'Appointments')}</span>\n                  <span className=\"xl:hidden\">{t('navigation.appointments_short', 'Appointments')}</span>\n                </Link>\n                {(user?.role === 'dentist' || user?.role === 'staff' || user?.role === 'admin') && (\n                  <Link\n                    to=\"/patients\"\n                    className={`inline-flex items-center px-4 xl:px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 hover:scale-105 ${isActive('/patients') ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-200/50' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600 hover:shadow-md'}`}\n                  >\n                    <Users className=\"w-4 h-4 mr-2\" />\n                    <span className=\"hidden xl:inline\">{t('Patients')}</span>\n                    <span className=\"xl:hidden\">Patients</span>\n                  </Link>\n                )}\n                {(user?.role === 'dentist' || user?.role === 'admin') && (\n                  <Link\n                    to=\"/medications\"\n                    className={`inline-flex items-center px-4 xl:px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 hover:scale-105 ${isActive('/medications') ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-200/50' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600 hover:shadow-md'}`}\n                  >\n                    <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n                    </svg>\n                    <span className=\"hidden xl:inline\">{t('medications')}</span>\n                    <span className=\"xl:hidden\">Meds</span>\n                  </Link>\n                )}\n                <Link\n                  to=\"/prescriptions\"\n                  className={`inline-flex items-center px-4 xl:px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 hover:scale-105 ${isActive('/prescriptions') ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-200/50' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600 hover:shadow-md'}`}\n                >\n                  <FileText className=\"w-4 h-4 mr-2\" />\n                  <span className=\"hidden xl:inline\">{t('prescriptions')}</span>\n                  <span className=\"xl:hidden\">Scripts</span>\n                </Link>\n\n                {/* More dropdown */}\n                <div className=\"relative\" ref={moreMenuRef}>\n                  <button\n                    onClick={_toggleMoreMenu}\n                    onKeyDown={(e) => handleDropdownKeyDown(e, 'more')}\n                    className={`inline-flex items-center px-4 xl:px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 hover:scale-105 ${isMoreMenuOpen ? 'bg-blue-100 text-blue-700' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600 hover:shadow-md'}`}\n                    aria-expanded={isMoreMenuOpen}\n                    aria-haspopup=\"true\"\n                    aria-label=\"More navigation options\"\n                  >\n                    <Menu className=\"w-4 h-4 mr-2\" />\n                    <span className=\"hidden xl:inline\">More</span>\n                    <span className=\"xl:hidden\">More</span>\n                    <ChevronDown className={`w-4 h-4 ml-1 transition-transform duration-200 ${isMoreMenuOpen ? 'rotate-180' : ''}`} />\n                  </button>\n\n                  {isMoreMenuOpen && (\n                    <div className=\"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 focus:outline-none z-50\">\n                      <div className=\"py-2\" role=\"menu\">\n                        {_moreNavigationItems.filter(item => _hasAccess(item.roles)).map((item) => (\n                          <Link\n                            key={item.path}\n                            to={item.path}\n                            className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150\"\n                            onClick={() => setIsMoreMenuOpen(false)}\n                            role=\"menuitem\"\n                          >\n                            {typeof item.icon === 'string' ? (\n                              item.icon === 'building' ? (\n                                <svg className=\"w-4 h-4 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                                </svg>\n                              ) : (\n                                React.createElement(item.icon as any, { className: 'w-4 h-4 mr-3' })\n                              )\n                            ) : (\n                              React.createElement(item.icon as any, { className: 'w-4 h-4 mr-3' })\n                            )}\n                            {item.label}\n                          </Link>\n                        ))}\n                        {user?.role === 'admin' && (\n                          <Link\n                            to=\"/multi-clinic\"\n                            className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150\"\n                            onClick={() => setIsMoreMenuOpen(false)}\n                            role=\"menuitem\"\n                          >\n                            <BarChart3 className=\"w-4 h-4 mr-3\" />\n                            {t('multiClinic', 'Multi-Clinic Dashboard')}\n                          </Link>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </nav>\n            )}\n\n            {/* Tablet Navigation - Condensed */}\n            {user && (\n              <nav className=\"hidden md:flex lg:hidden md:items-center md:space-x-1\" role=\"navigation\" aria-label=\"Tablet navigation\">\n                <Link\n                  to=\"/dashboard\"\n                  className={`inline-flex items-center p-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${isActive('/dashboard') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'}`}\n                  title={t('dashboard')}\n                >\n                  <Home className=\"w-5 h-5\" />\n                </Link>\n                <Link\n                  to=\"/appointments\"\n                  className={`inline-flex items-center p-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${isActive('/appointments') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'}`}\n                  title={t('appointments')}\n                >\n                  <Calendar className=\"w-5 h-5\" />\n                </Link>\n                {(user.role === 'dentist' || user.role === 'staff' || user.role === 'admin') && (\n                  <Link\n                    to=\"/patients\"\n                    className={`inline-flex items-center p-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${isActive('/patients') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'}`}\n                    title={t('patients')}\n                  >\n                    <Users className=\"w-5 h-5\" />\n                  </Link>\n                )}\n                <Link\n                  to=\"/prescriptions\"\n                  className={`inline-flex items-center p-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${isActive('/prescriptions') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'}`}\n                  title={t('prescriptions')}\n                >\n                  <FileText className=\"w-5 h-5\" />\n                </Link>\n\n                {/* Tablet More Menu */}\n                <div className=\"relative\" ref={moreMenuRef}>\n                  <button\n                    onClick={_toggleMoreMenu}\n                    onKeyDown={(e) => handleDropdownKeyDown(e, 'more')}\n                    className={`inline-flex items-center p-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${isMoreMenuOpen ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-100 hover:text-blue-600'}`}\n                    title=\"More options\"\n                    aria-expanded={isMoreMenuOpen}\n                    aria-haspopup=\"true\"\n                  >\n                    <Menu className=\"w-5 h-5\" />\n                  </button>\n\n                  {isMoreMenuOpen && (\n                    <div className=\"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 focus:outline-none z-50\">\n                      <div className=\"py-2\" role=\"menu\">\n                        {(user.role === 'dentist' || user.role === 'admin') && (\n                          <Link\n                            to=\"/medications\"\n                            className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150\"\n                            onClick={() => setIsMoreMenuOpen(false)}\n                            role=\"menuitem\"\n                          >\n                            <svg className=\"w-4 h-4 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n                            </svg>\n                            {t('medications')}\n                          </Link>\n                        )}\n                        {_moreNavigationItems.filter(item => _hasAccess(item.roles)).map((item) => (\n                          <Link\n                            key={item.path}\n                            to={item.path}\n                            className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150\"\n                            onClick={() => setIsMoreMenuOpen(false)}\n                            role=\"menuitem\"\n                          >\n                            {typeof item.icon === 'string' ? (\n                              item.icon === 'building' ? (\n                                <svg className=\"w-4 h-4 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                                </svg>\n                              ) : (\n                                React.createElement(item.icon as any, { className: 'w-4 h-4 mr-3' })\n                              )\n                            ) : (\n                              React.createElement(item.icon as any, { className: 'w-4 h-4 mr-3' })\n                            )}\n                            {item.label}\n                          </Link>\n                        ))}\n                        {user?.role === 'admin' && (\n                          <Link\n                            to=\"/multi-clinic\"\n                            className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150\"\n                            onClick={() => setIsMoreMenuOpen(false)}\n                            role=\"menuitem\"\n                          >\n                            <BarChart3 className=\"w-4 h-4 mr-3\" />\n                            {t('multiClinic', 'Multi-Clinic Dashboard')}\n                          </Link>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </nav>\n            )}\n\n            {/* Right side controls */}\n            <div className=\"flex items-center space-x-3 sm:space-x-4\">\n              {/* Quick Actions - Desktop Only removed for streamlined header */}\n\n              {/* Loading indicator */}\n              {isLoading && (\n                <div className=\"flex items-center justify-center w-8 h-8\">\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-blue-500 border-t-transparent\"></div>\n                </div>\n              )}\n\n              {/* Error indicator */}\n              {error && (\n                <div className=\"flex items-center\">\n                  <button\n                    onClick={() => setError(null)}\n                    className=\"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-50 transition-colors duration-200\"\n                    title={error}\n                    aria-label={`Error: ${error}. Click to dismiss.`}\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                  </button>\n                </div>\n              )}\n              {/* Online status and time display removed for simplicity */}\n\n              {/* Enhanced Notifications */}\n              {user && (\n                <div className=\"flex items-center\">\n                  <div className=\"relative\">\n                    <NotificationDropdown />\n                  </div>\n                </div>\n              )}\n\n              {/* Language Switcher - Hidden on mobile, visible on tablet+ */}\n              <div className=\"hidden sm:flex items-center\">\n                <LanguageSwitcher variant=\"menu\" showIcon={true} showLabel={false} />\n              </div>\n\n              {/* Clinic Selector - Only for staff/admin/dentist - Hidden on mobile, visible on tablet+ */}\n              {user && user.role !== 'patient' && clinics.length > 1 && (\n                <div className=\"hidden lg:block\">\n                  <div className=\"relative inline-block\">\n                    <select\n                      className=\"appearance-none pl-3 pr-9 py-2 text-sm border border-gray-200 bg-white rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer hover:border-gray-300 transition-colors duration-200 min-h-[44px]\"\n                      value={selectedClinic?.id || ''}\n                      onChange={(e) => handleClinicChange(e.target.value)}\n                      aria-label={`Select clinic. Currently selected: ${selectedClinic?.name || 'None'}`}\n                      aria-describedby=\"clinic-selector-help\"\n                    >\n                      {clinics.map((clinic) => (\n                        <option key={clinic.id} value={clinic.id}>\n                          {clinic.name}\n                        </option>\n                      ))}\n                    </select>\n                    <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-400\">\n                      <ChevronDown className=\"h-4 w-4\" aria-hidden=\"true\" />\n                    </div>\n                    <span id=\"clinic-selector-help\" className=\"sr-only\">\n                      Choose which clinic location to manage\n                    </span>\n                  </div>\n                </div>\n              )}\n\n              {/* User Profile */}\n              {user ? (\n                <div className=\"relative\" ref={profileRef}>\n                  <button\n                    onClick={toggleProfile}\n                    onKeyDown={(e) => handleDropdownKeyDown(e, 'profile')}\n                    className=\"flex items-center space-x-3 sm:space-x-4 p-3 rounded-2xl hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 min-h-[48px] min-w-[48px] hover:shadow-md group\"\n                    aria-label={`User menu for ${user.firstName} ${user.lastName}. Role: ${user.role}`}\n                    aria-expanded={isProfileOpen}\n                    aria-haspopup=\"true\"\n                    aria-describedby=\"user-menu-help\"\n                  >\n                    <span className=\"sr-only\">Open user menu</span>\n                    <div className=\"relative\">\n                      <div className=\"h-12 w-12 rounded-full bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800 flex items-center justify-center text-white shadow-lg ring-2 ring-white/50 transition-all duration-200 group-hover:ring-4 group-hover:ring-blue-100 group-hover:scale-105\">\n                        <span className=\"text-base font-bold\">\n                          {user.firstName.charAt(0)}{user.lastName.charAt(0)}\n                        </span>\n                      </div>\n                      {user.role === 'admin' && (\n                        <div className=\"absolute -top-1 -right-1 h-5 w-5 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center shadow-lg\">\n                          <span className=\"text-xs text-white font-bold\">A</span>\n                        </div>\n                      )}\n                      {user.role === 'dentist' && (\n                        <div className=\"absolute -top-1 -right-1 h-5 w-5 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center shadow-lg\">\n                          <Stethoscope className=\"h-3 w-3 text-white\" />\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"hidden lg:block text-left ml-4\">\n                      <p className=\"text-sm font-bold text-gray-800\">{user.firstName} {user.lastName}</p>\n                      <p className=\"text-xs text-gray-500 capitalize flex items-center font-medium\">\n                        {user.role}\n                        {selectedClinic && (\n                          <>\n                            <span className=\"mx-1\"></span>\n                            <span className=\"truncate max-w-24\">{selectedClinic.name}</span>\n                          </>\n                        )}\n                      </p>\n                    </div>\n                    <ChevronDown className={`hidden lg:block h-4 w-4 text-gray-400 transition-transform duration-200 ${isProfileOpen ? 'rotate-180' : ''}`} aria-hidden=\"true\" />\n                    <span id=\"user-menu-help\" className=\"sr-only\">\n                      Access profile settings, account preferences, and sign out\n                    </span>\n                  </button>\n\n                  {/* Profile dropdown */}\n                  {isProfileOpen && (\n                    <div\n                      className=\"absolute right-0 mt-3 w-72 sm:w-80 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 focus:outline-none z-50 transform transition-all duration-200 ease-out\"\n                      role=\"menu\"\n                      aria-orientation=\"vertical\"\n                      aria-labelledby=\"user-menu\"\n                    >\n                      <div className=\"p-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50\">\n                        <div className=\"flex items-center space-x-3\">\n                          <div className=\"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700 flex items-center justify-center text-white shadow-lg\">\n                            <span className=\"text-lg font-semibold\">\n                              {user.firstName.charAt(0)}{user.lastName.charAt(0)}\n                            </span>\n                          </div>\n                          <div className=\"flex-1\">\n                            <p className=\"font-semibold text-gray-900\">{user.firstName} {user.lastName}</p>\n                            <p className=\"text-sm text-gray-600 truncate\">{user.email}</p>\n                            <Badge variant={user.role === 'admin' ? 'danger' : user.role === 'dentist' ? 'success' : 'primary'} size=\"sm\" className=\"mt-1\">\n                              {user.role.charAt(0).toUpperCase() + user.role.slice(1)}\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"py-2\">\n                        <Link\n                          to=\"/profile\"\n                          className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150 min-h-[44px] active:bg-blue-100\"\n                          onClick={() => setIsProfileOpen(false)}\n                        >\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                            <svg className=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                            </svg>\n                          </div>\n                          <div>\n                            <p className=\"font-medium\">{t('profile')}</p>\n                            <p className=\"text-xs text-gray-500\">Manage your account</p>\n                          </div>\n                        </Link>\n                        <Link\n                          to=\"/settings\"\n                          className=\"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150 min-h-[44px] active:bg-blue-100\"\n                          onClick={() => setIsProfileOpen(false)}\n                        >\n                          <div className=\"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                            <Settings className=\"w-4 h-4 text-gray-600\" />\n                          </div>\n                          <div>\n                            <p className=\"font-medium\">{t('settings')}</p>\n                            <p className=\"text-xs text-gray-500\">Preferences & privacy</p>\n                          </div>\n                        </Link>\n                      </div>\n                      <div className=\"border-t border-gray-100 py-2\">\n                        <button\n                          onClick={handleLogout}\n                          className=\"flex items-center w-full px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors duration-150 min-h-[44px] active:bg-red-100\"\n                        >\n                          <div className=\"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                            <LogOut className=\"w-4 h-4 text-red-600\" />\n                          </div>\n                          <div className=\"text-left\">\n                            <p className=\"font-medium\">{t('auth.signOut')}</p>\n                            <p className=\"text-xs text-red-500\">Sign out of your account</p>\n                          </div>\n                        </button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ) : (\n                <div className=\"flex space-x-3\">\n                  <Link to=\"/login\">\n                    <Button variant=\"outline\" size=\"sm\">\n                      {t('auth.login')}\n                    </Button>\n                  </Link>\n                  <Link to=\"/register\">\n                    <Button variant=\"primary\" size=\"sm\">\n                      {t('auth.signUp')}\n                    </Button>\n                  </Link>\n                </div>\n              )}\n\n              {/* Mobile menu button */}\n              {user && (\n                <div className=\"flex items-center md:hidden\">\n                  <button\n                    onClick={toggleMenu}\n                    className=\"inline-flex items-center justify-center p-3 rounded-2xl text-gray-500 hover:text-blue-600 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 transition-all duration-300 min-h-[52px] min-w-[52px] active:bg-blue-100 active:scale-95 hover:scale-105 hover:shadow-md\"\n                    aria-label={isMenuOpen ? 'Close menu' : 'Open menu'}\n                    aria-expanded={isMenuOpen}\n                  >\n                    <span className=\"sr-only\">{isMenuOpen ? 'Close main menu' : 'Open main menu'}</span>\n                    <div className=\"relative\">\n                      <div className={`transform transition-all duration-300 ease-in-out ${isMenuOpen ? 'rotate-180 scale-90' : 'rotate-0 scale-100'}`}>\n                        <div className={`absolute inset-0 transition-opacity duration-300 ${isMenuOpen ? 'opacity-0' : 'opacity-100'}`}>\n                          <Menu className=\"block h-6 w-6\" />\n                        </div>\n                        <div className={`transition-opacity duration-300 ${isMenuOpen ? 'opacity-100' : 'opacity-0'}`}>\n                          <X className=\"block h-6 w-6\" />\n                        </div>\n                      </div>\n                    </div>\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Mobile menu overlay */}\n        {isMenuOpen && user && (\n          <>\n            {/* Backdrop */}\n            <div\n              className=\"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden transition-opacity duration-300 ease-in-out\"\n              onClick={() => setIsMenuOpen(false)}\n              aria-hidden=\"true\"\n            />\n\n            {/* Slide-out menu */}\n            <div className={`fixed top-0 right-0 h-full w-80 max-w-[85vw] bg-white shadow-2xl z-50 md:hidden transform transition-transform duration-300 ease-in-out ${isMenuOpen ? 'translate-x-0' : 'translate-x-full'\n              }`}>\n              {/* Menu header */}\n              <div className=\"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700 flex items-center justify-center text-white shadow-lg\">\n                    <span className=\"text-sm font-semibold\">\n                      {user?.firstName?.charAt(0)}{user?.lastName?.charAt(0)}\n                    </span>\n                  </div>\n                  <div>\n                    <p className=\"font-semibold text-gray-900 text-sm\">{user?.firstName} {user?.lastName}</p>\n                    <Badge variant={user?.role === 'admin' ? 'danger' : user?.role === 'dentist' ? 'success' : 'primary'} size=\"sm\">\n                      {user?.role?.charAt(0).toUpperCase() + user?.role?.slice(1)}\n                    </Badge>\n                  </div>\n                </div>\n                <button\n                  onClick={() => setIsMenuOpen(false)}\n                  className=\"p-2 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors duration-200\"\n                  aria-label=\"Close menu\"\n                >\n                  <X className=\"h-6 w-6\" />\n                </button>\n              </div>\n\n              {/* Menu content */}\n              <div className=\"flex-1 overflow-y-auto\">\n                <div className=\"pt-2 pb-3 space-y-1 px-2\">\n                  {/* Mobile search removed */}\n\n                  {/* Clinic Selector - Mobile */}\n                  {user?.role !== 'patient' && clinics?.length > 1 && (\n                    <div className=\"px-3 py-2\">\n                      <label htmlFor=\"mobile-clinic-selector\" className=\"block text-xs font-medium text-blue-600 mb-1 px-1\">\n                        {t('common.selectClinic', 'Select Clinic')}\n                      </label>\n                      <div className=\"relative\">\n                        <select\n                          id=\"mobile-clinic-selector\"\n                          className=\"appearance-none w-full pl-4 pr-10 py-3 text-sm border border-blue-200 bg-white rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer hover:border-blue-300 transition-colors duration-200 min-h-[44px]\"\n                          value={selectedClinic?.id || ''}\n                          onChange={(e) => handleClinicChange(e.target.value)}\n                          aria-label={`Select clinic. Currently selected: ${selectedClinic?.name || 'None'}`}\n                          aria-describedby=\"mobile-clinic-help\"\n                        >\n                          {clinics.map((clinic) => (\n                            <option key={clinic.id} value={clinic.id}>\n                              {clinic.name}\n                            </option>\n                          ))}\n                        </select>\n                        <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-400\">\n                          <ChevronDown className=\"h-4 w-4\" aria-hidden=\"true\" />\n                        </div>\n                        <span id=\"mobile-clinic-help\" className=\"sr-only\">\n                          Choose which clinic location to manage\n                        </span>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Language Switcher - Mobile */}\n                  <div className=\"px-3 py-2 sm:hidden\">\n                    <LanguageSwitcher variant=\"menu\" showIcon={true} showLabel={true} />\n                  </div>\n\n                  <div className=\"border-t border-gray-200 my-2\" role=\"separator\" aria-hidden=\"true\"></div>\n\n                  {/* Mobile Navigation Links */}\n                  <nav role=\"navigation\" aria-label=\"Mobile navigation\" className=\"space-y-1 px-2\">\n\n                    <Link\n                      to=\"/dashboard\"\n                      className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/dashboard') ? 'bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                      onClick={() => setIsMenuOpen(false)}\n                    >\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-blue-100 mr-4 flex-shrink-0 shadow-sm transition-all duration-300 group-hover:scale-110\">\n                        <Home className=\"w-5 h-5 text-blue-600\" />\n                      </div>\n                      <span className=\"flex-1\">{t('dashboard')}</span>\n                      <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                    </Link>\n                    <Link\n                      to=\"/appointments\"\n                      className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/appointments') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                      onClick={() => setIsMenuOpen(false)}\n                    >\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-green-50 mr-4 flex-shrink-0\">\n                        <Calendar className=\"w-5 h-5 text-green-600\" />\n                      </div>\n                      <span className=\"flex-1\">{t('appointments')}</span>\n                      <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                    </Link>\n                    {(user.role === 'dentist' || user.role === 'staff' || user.role === 'admin') && (\n                      <Link\n                        to=\"/patients\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/patients') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-purple-50 mr-4 flex-shrink-0\">\n                          <Users className=\"w-5 h-5 text-purple-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('patients')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n                    {(user.role === 'dentist' || user.role === 'admin') && (\n                      <Link\n                        to=\"/medications\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/medications') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-orange-50 mr-4 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-orange-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n                          </svg>\n                        </div>\n                        <span className=\"flex-1\">{t('medications')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n\n                    <Link\n                      to=\"/prescriptions\"\n                      className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/prescriptions') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                      onClick={() => setIsMenuOpen(false)}\n                    >\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-indigo-50 mr-4 flex-shrink-0\">\n                        <FileText className=\"w-5 h-5 text-indigo-600\" />\n                      </div>\n                      <span className=\"flex-1\">{t('prescriptions')}</span>\n                      <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                    </Link>\n\n                    {(user.role === 'dentist' || user.role === 'staff' || user.role === 'admin') && (\n                      <Link\n                        to=\"/billing\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/billing') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-emerald-50 mr-4 flex-shrink-0\">\n                          <CreditCard className=\"w-5 h-5 text-emerald-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('billing')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n\n                    <Link\n                      to=\"/inventory\"\n                      className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/inventory') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                      onClick={() => setIsMenuOpen(false)}\n                    >\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-cyan-50 mr-4 flex-shrink-0\">\n                        <Package className=\"w-5 h-5 text-cyan-600\" />\n                      </div>\n                      <span className=\"flex-1\">{t('inventory')}</span>\n                      <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                    </Link>\n\n                    <Link\n                      to=\"/reports\"\n                      className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/reports') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                      onClick={() => setIsMenuOpen(false)}\n                    >\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-pink-50 mr-4 flex-shrink-0\">\n                        <BarChart3 className=\"w-5 h-5 text-pink-600\" />\n                      </div>\n                      <span className=\"flex-1\">{t('reports')}</span>\n                      <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                    </Link>\n\n                    {(user.role === 'dentist' || user.role === 'staff' || user.role === 'admin') && (\n                      <Link\n                        to=\"/staff-scheduling\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/staff-scheduling') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-yellow-50 mr-4 flex-shrink-0\">\n                          <Calendar className=\"w-5 h-5 text-yellow-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('staffScheduling')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n\n                    {(user.role === 'dentist' || user.role === 'staff' || user.role === 'admin') && (\n                      <Link\n                        to=\"/treatments\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/treatments') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-violet-50 mr-4 flex-shrink-0\">\n                          <Stethoscope className=\"w-5 h-5 text-violet-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('treatments')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n\n                    {user.role === 'admin' && (\n                      <Link\n                        to=\"/clinics\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/clinics') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-red-50 mr-4 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                          </svg>\n                        </div>\n                        <span className=\"flex-1\">{t('clinics')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n\n                    {user.role === 'admin' && (\n                      <Link\n                        to=\"/multi-clinic\"\n                        className={`flex items-center px-4 py-4 rounded-xl text-base font-medium transition-all duration-200 min-h-[56px] active:bg-blue-200 active:scale-95 ${isActive('/multi-clinic') ? 'bg-blue-100 text-blue-700 shadow-sm' : 'text-gray-600 hover:bg-gray-50 hover:text-blue-600 hover:translate-x-1'}`}\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-indigo-50 mr-4 flex-shrink-0\">\n                          <BarChart3 className=\"w-5 h-5 text-indigo-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('multiClinic', 'Multi-Clinic Dashboard')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                    )}\n                  </nav>\n\n                  <div className=\"pt-4 pb-3 border-t border-gray-200 mt-2\" role=\"separator\">\n                    <div className=\"flex items-center px-3 py-2\">\n                      <div className=\"flex-shrink-0\">\n                        <div className=\"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-blue-700 flex items-center justify-center text-white shadow-lg\">\n                          <span className=\"text-base font-semibold\">\n                            {user.firstName.charAt(0)}{user.lastName.charAt(0)}\n                          </span>\n                        </div>\n                      </div>\n                      <div className=\"ml-3 flex-1 min-w-0\">\n                        <div className=\"text-base font-medium text-gray-800 truncate\">{user.firstName} {user.lastName}</div>\n                        <div className=\"text-sm font-medium text-gray-500 truncate\">{user.email}</div>\n                        <Badge variant={user.role === 'admin' ? 'danger' : user.role === 'dentist' ? 'success' : 'primary'} size=\"sm\" className=\"mt-1\">\n                          {user.role.charAt(0).toUpperCase() + user.role.slice(1)}\n                        </Badge>\n                      </div>\n                    </div>\n                    <div className=\"mt-3 space-y-1 px-2\">\n                      <Link\n                        to=\"/profile\"\n                        className=\"flex items-center px-4 py-4 rounded-xl text-base font-medium text-gray-600 hover:bg-gray-50 hover:text-blue-600 transition-all duration-200 min-h-[56px] active:bg-blue-100 active:scale-95 hover:translate-x-1\"\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-blue-50 mr-4 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                          </svg>\n                        </div>\n                        <span className=\"flex-1\">{t('profile')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                      <Link\n                        to=\"/settings\"\n                        className=\"flex items-center px-4 py-4 rounded-xl text-base font-medium text-gray-600 hover:bg-gray-50 hover:text-blue-600 transition-all duration-200 min-h-[56px] active:bg-blue-100 active:scale-95 hover:translate-x-1\"\n                        onClick={() => setIsMenuOpen(false)}\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-gray-50 mr-4 flex-shrink-0\">\n                          <Settings className=\"w-5 h-5 text-gray-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('settings')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </Link>\n                      <button\n                        onClick={() => {\n                          handleLogout();\n                          setIsMenuOpen(false);\n                        }}\n                        className=\"flex items-center w-full text-left px-4 py-4 rounded-xl text-base font-medium text-red-600 hover:bg-red-50 transition-all duration-200 min-h-[56px] active:bg-red-100 active:scale-95 hover:translate-x-1\"\n                      >\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-red-50 mr-4 flex-shrink-0\">\n                          <LogOut className=\"w-5 h-5 text-red-600\" />\n                        </div>\n                        <span className=\"flex-1\">{t('auth.signOut')}</span>\n                        <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </>\n        )}\n      </header>\n\n      {/* Enhanced Breadcrumb bar */}\n      {user && breadcrumb && breadcrumb.length > 0 && (\n        <div className=\"bg-gradient-to-r from-gray-50/90 via-white/95 to-gray-50/90 backdrop-blur-sm border-b border-gray-100/80\">\n          <div className=\"w-full px-4 sm:px-6 lg:px-8 py-2\">\n            <nav className=\"flex items-center text-sm text-gray-600 overflow-x-auto scrollbar-hide\" aria-label=\"Breadcrumb navigation\">\n              <Link to=\"/dashboard\" className=\"hover:text-blue-600 whitespace-nowrap transition-colors min-h-[32px] flex items-center font-medium hover:bg-blue-50 px-2 py-1 rounded-lg\">\n                {t('navigation.dashboard')}\n              </Link>\n              {breadcrumb.map((item) => (\n                <div key={item.path} className=\"flex items-center flex-shrink-0\">\n                  <ChevronRight className=\"mx-1 sm:mx-2 h-4 w-4 text-gray-400 flex-shrink-0\" aria-hidden=\"true\" />\n                  {item.isLast ? (\n                    <span\n                      className=\"text-gray-700 font-medium truncate max-w-[120px] sm:max-w-[200px] lg:max-w-none\"\n                      aria-current=\"page\"\n                    >\n                      {item.name}\n                    </span>\n                  ) : (\n                    <Link\n                      to={item.path}\n                      className=\"hover:text-blue-600 whitespace-nowrap transition-colors min-h-[32px] flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded\"\n                      aria-label={`Navigate to ${item.name}`}\n                    >\n                      {item.name}\n                    </Link>\n                  )}\n                </div>\n              ))}\n            </nav>\n          </div>\n        </div>\n      )}\n    </>\n  );\n});\n\nHeader.displayName = 'Header';\n\nexport default Header;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\layout\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\layout\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\medications\\MedicationForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5391,5394],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5391,5394],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { Plus, X } from 'lucide-react';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport Textarea from '../ui/Textarea';\nimport Checkbox from '../ui/Checkbox';\nimport { medicationService } from '../../services/medicationService';\nimport { toast } from 'react-hot-toast';\n\nconst T_PREFIX = 'medicationForm.validation';\n\nconst medicationSchema = (t: (key: string) => string) => z.object({\n  name: z.string().min(1, t(`${T_PREFIX}.medicationNameRequired`)),\n  genericName: z.string().optional(),\n  dosage: z.string().min(1, t(`${T_PREFIX}.dosageRequired`)),\n  frequency: z.string().min(1, t(`${T_PREFIX}.frequencyRequired`)),\n  duration: z.string().min(1, t(`${T_PREFIX}.durationRequired`)),\n  instructions: z.string().optional(),\n  sideEffects: z.array(z.object({\n    effect: z.string().min(1, t(`${T_PREFIX}.sideEffectRequired`))\n  })),\n  contraindications: z.array(z.object({\n    contraindication: z.string().min(1, t(`${T_PREFIX}.contraindicationRequired`))\n  })),\n  category: z.enum(['antibiotic', 'painkiller', 'anti-inflammatory', 'anesthetic', 'antiseptic', 'other']),\n  isActive: z.boolean()\n});\n\ntype MedicationFormData = z.infer<ReturnType<typeof medicationSchema>>;\n\ninterface Medication {\n  id: string;\n  name: string;\n  genericName?: string;\n  dosage: string;\n  frequency: string;\n  duration: string;\n  instructions?: string;\n  sideEffects: string[];\n  contraindications: string[];\n  category: 'antibiotic' | 'painkiller' | 'anti-inflammatory' | 'anesthetic' | 'antiseptic' | 'other';\n  isActive: boolean;\n}\n\ninterface MedicationFormProps {\n  medication?: Medication | null;\n  onSave: () => void;\n  onCancel: () => void;\n}\n\nexport const MedicationForm: React.FC<MedicationFormProps> = ({\n  medication,\n  onSave,\n  onCancel\n}) => {\n  const { t } = useTranslation();\n  const [loading, setLoading] = useState(false);\n\n  const {\n    register,\n    control,\n    handleSubmit,\n    formState: { errors },\n    reset\n  } = useForm<MedicationFormData>({\n    resolver: zodResolver(medicationSchema(t)),\n    defaultValues: {\n      name: '',\n      genericName: '',\n      dosage: '',\n      frequency: '',\n      duration: '',\n      instructions: '',\n      sideEffects: [{ effect: '' }],\n      contraindications: [{ contraindication: '' }],\n      category: 'other',\n      isActive: true\n    }\n  });\n\n  const {\n    fields: sideEffectFields,\n    append: appendSideEffect,\n    remove: removeSideEffect\n  } = useFieldArray({\n    control,\n    name: 'sideEffects'\n  });\n\n  const {\n    fields: contraindicationFields,\n    append: appendContraindication,\n    remove: removeContraindication\n  } = useFieldArray({\n    control,\n    name: 'contraindications'\n  });\n\n  const categories = [\n    { value: 'antibiotic', label: t('medicationForm.categories.antibiotic') },\n    { value: 'painkiller', label: t('medicationForm.categories.painkiller') },\n    { value: 'anti-inflammatory', label: t('medicationForm.categories.anti-inflammatory') },\n    { value: 'anesthetic', label: t('medicationForm.categories.anesthetic') },\n    { value: 'antiseptic', label: t('medicationForm.categories.antiseptic') },\n    { value: 'other', label: t('medicationForm.categories.other') }\n  ];\n\n  useEffect(() => {\n    if (medication) {\n      reset({\n        name: medication.name,\n        genericName: medication.genericName || '',\n        dosage: medication.dosage,\n        frequency: medication.frequency,\n        duration: medication.duration,\n        instructions: medication.instructions || '',\n        sideEffects: medication.sideEffects.length > 0 \n          ? medication.sideEffects.map(effect => ({ effect }))\n          : [{ effect: '' }],\n        contraindications: medication.contraindications.length > 0\n          ? medication.contraindications.map(contraindication => ({ contraindication }))\n          : [{ contraindication: '' }],\n        category: medication.category,\n        isActive: medication.isActive\n      });\n    }\n  }, [medication, reset]);\n\n  const onSubmit = async (data: MedicationFormData) => {\n    try {\n      setLoading(true);\n      \n      // Transform data for API\n      const medicationData = {\n        name: data.name,\n        genericName: data.genericName || undefined,\n        dosage: data.dosage,\n        frequency: data.frequency,\n        duration: data.duration,\n        instructions: data.instructions || undefined,\n        sideEffects: data.sideEffects\n          .filter(item => item.effect.trim() !== '')\n          .map(item => item.effect),\n        contraindications: data.contraindications\n          .filter(item => item.contraindication.trim() !== '')\n          .map(item => item.contraindication),\n        category: data.category,\n        isActive: data.isActive\n      };\n\n      if (medication) {\n        console.log('medication',medication,medication.id);\n        await medicationService.updateMedication(medication.id, medicationData);\n        toast.success(t('medicationForm.successUpdate'));\n      } else {\n        await medicationService.createMedication(medicationData);\n        toast.success(t('medicationForm.successCreate'));\n      }\n      \n      onSave();\n    } catch (_error: any) {\n              toast.error(_error.response?.data?.message || t('medicationForm.errorSave'));\n      console.error('Error saving medication:', _error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n      {/* Basic Information */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('medicationForm.medicationName')} *\n          </label>\n          <Input\n            {...register('name')}\n            placeholder={t('medicationForm.medicationNamePlaceholder')}\n            error={errors.name?.message}\n          />\n        </div>\n        \n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('medicationForm.genericName')}\n          </label>\n          <Input\n            {...register('genericName')}\n            placeholder={t('medicationForm.genericNamePlaceholder')}\n            error={errors.genericName?.message}\n          />\n        </div>\n      </div>\n\n      {/* Dosage Information */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('medicationForm.dosage')} *\n          </label>\n          <Input\n            {...register('dosage')}\n            placeholder={t('medicationForm.dosagePlaceholder')}\n            error={errors.dosage?.message}\n          />\n        </div>\n        \n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('medicationForm.frequency')} *\n          </label>\n          <Input\n            {...register('frequency')}\n            placeholder={t('medicationForm.frequencyPlaceholder')}\n            error={errors.frequency?.message}\n          />\n        </div>\n        \n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('medicationForm.duration')} *\n          </label>\n          <Input\n            {...register('duration')}\n            placeholder={t('medicationForm.durationPlaceholder')}\n            error={errors.duration?.message}\n          />\n        </div>\n      </div>\n\n      {/* Category and Status */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('medicationForm.category')} *\n          </label>\n          <Select\n            {...register('category')}\n            options={categories}\n            error={errors.category?.message}\n          />\n        </div>\n        \n        <div className=\"flex items-center space-x-2 pt-6\">\n          <Checkbox\n            {...register('isActive')}\n            id=\"isActive\"\n          />\n          <label htmlFor=\"isActive\" className=\"text-sm font-medium text-gray-700\">\n            {t('medicationForm.activeMedication')}\n          </label>\n        </div>\n      </div>\n\n      {/* Instructions */}\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n          {t('medicationForm.instructions')}\n        </label>\n        <Textarea\n          {...register('instructions')}\n          placeholder={t('medicationForm.instructionsPlaceholder')}\n          rows={3}\n          error={errors.instructions?.message}\n        />\n      </div>\n\n      {/* Side Effects */}\n      <div>\n        <div className=\"flex justify-between items-center mb-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">\n            {t('medicationForm.sideEffects')}\n          </label>\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => appendSideEffect({ effect: '' })}\n            className=\"flex items-center gap-1\"\n          >\n            <Plus className=\"h-4 w-4\" />\n            {t('medicationForm.addSideEffect')}\n          </Button>\n        </div>\n        <div className=\"space-y-2\">\n          {sideEffectFields.map((field, index) => (\n            <div key={field.id} className=\"flex gap-2\">\n              <Input\n                {...register(`sideEffects.${index}.effect`)}\n                placeholder={t('medicationForm.sideEffectPlaceholder')}\n                error={errors.sideEffects?.[index]?.effect?.message}\n              />\n              {sideEffectFields.length > 1 && (\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => removeSideEffect(index)}\n                  className=\"text-red-600 hover:text-red-700\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Contraindications */}\n      <div>\n        <div className=\"flex justify-between items-center mb-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">\n            {t('medicationForm.contraindications')}\n          </label>\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => appendContraindication({ contraindication: '' })}\n            className=\"flex items-center gap-1\"\n          >\n            <Plus className=\"h-4 w-4\" />\n            {t('medicationForm.addContraindication')}\n          </Button>\n        </div>\n        <div className=\"space-y-2\">\n          {contraindicationFields.map((field, index) => (\n            <div key={field.id} className=\"flex gap-2\">\n              <Input\n                {...register(`contraindications.${index}.contraindication`)}\n                placeholder={t('medicationForm.contraindicationPlaceholder')}\n                error={errors.contraindications?.[index]?.contraindication?.message}\n              />\n              {contraindicationFields.length > 1 && (\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => removeContraindication(index)}\n                  className=\"text-red-600 hover:text-red-700\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Form Actions */}\n      <div className=\"flex justify-end gap-3 pt-6 border-t\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          disabled={loading}\n        >\n          {t('medicationForm.cancel')}\n        </Button>\n        <Button\n          type=\"submit\"\n          isLoading={loading}\n          disabled={loading}\n        >\n          {medication ? t('medicationForm.updateMedication') : t('medicationForm.createMedication')}\n        </Button>\n      </div>\n    </form>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\medications\\MedicationList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\notifications\\NotificationBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\notifications\\NotificationDropdown.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":54,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1735,1738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1735,1738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1928,1931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1928,1931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2172,2175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2172,2175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refreshNotifications'. Either include it or remove the dependency array.","line":49,"column":6,"nodeType":"ArrayExpression","endLine":49,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, refreshNotifications]","fix":{"range":[1587,1595],"text":"[isOpen, refreshNotifications]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Bell, X, Check, CheckCheck, Trash2, Eye, Clock, Calendar, AlertCircle, Info } from 'lucide-react';\r\nimport { Button, Badge } from '../ui';\r\nimport { useNotifications } from '../../context/NotificationContext';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { enUS, ar } from 'date-fns/locale';\r\n\r\ninterface NotificationDropdownProps {\r\n  className?: string;\r\n}\r\n\r\nconst NotificationDropdown: React.FC<NotificationDropdownProps> = ({ className = '' }) => {\r\n  const { t, i18n } = useTranslation();\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  \r\n  const {\r\n    notifications,\r\n    unreadCount,\r\n    loading,\r\n    error,\r\n    refreshNotifications,\r\n    markAsRead,\r\n    markAllAsRead,\r\n    deleteNotification\r\n  } = useNotifications();\r\n\r\n  const locale = i18n.language === 'ar' ? ar : enUS;\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  // Refresh notifications when dropdown opens\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      refreshNotifications();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isOpen]);\r\n\r\n  const handleMarkAsRead = async (notificationId: string) => {\r\n    try {\r\n      await markAsRead(notificationId);\r\n    } catch (err: any) {\r\n      console.error('Error marking notification as read:', err);\r\n    }\r\n  };\r\n\r\n  const handleMarkAllAsRead = async () => {\r\n    try {\r\n      await markAllAsRead();\r\n    } catch (err: any) {\r\n      console.error('Error marking all notifications as read:', err);\r\n    }\r\n  };\r\n\r\n  const handleDeleteNotification = async (notificationId: string) => {\r\n    try {\r\n      await deleteNotification(notificationId);\r\n    } catch (err: any) {\r\n      console.error('Error deleting notification:', err);\r\n    }\r\n  };\r\n\r\n  const getNotificationIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'appointment_reminder':\r\n        return <Clock className=\"w-4 h-4 text-blue-600\" />;\r\n      case 'appointment_confirmation':\r\n        return <Calendar className=\"w-4 h-4 text-green-600\" />;\r\n      case 'appointment_cancellation':\r\n        return <AlertCircle className=\"w-4 h-4 text-red-600\" />;\r\n      case 'system':\r\n        return <Info className=\"w-4 h-4 text-purple-600\" />;\r\n      default:\r\n        return <Bell className=\"w-4 h-4 text-gray-600\" />;\r\n    }\r\n  };\r\n\r\n  const formatNotificationTime = (dateString: string) => {\r\n    try {\r\n      return formatDistanceToNow(new Date(dateString), { \r\n        addSuffix: true, \r\n        locale \r\n      });\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`relative ${className}`} ref={dropdownRef}>\r\n      {/* Notification Bell Button */}\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200\"\r\n        aria-label={t('notifications.title')}\r\n      >\r\n        <Bell className=\"w-5 h-5\" />\r\n        {unreadCount > 0 && (\r\n          <Badge className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs min-w-[18px] h-[18px] flex items-center justify-center rounded-full border-2 border-white\">\r\n            {unreadCount > 99 ? '99+' : unreadCount}\r\n          </Badge>\r\n        )}\r\n      </button>\r\n\r\n      {/* Dropdown */}\r\n      {isOpen && (\r\n        <div className=\"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50 max-h-96 overflow-hidden\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Bell className=\"w-5 h-5 text-gray-600\" />\r\n              <h3 className=\"font-semibold text-gray-900\">\r\n                {t('notifications.title')}\r\n              </h3>\r\n              {unreadCount > 0 && (\r\n                <Badge className=\"bg-red-100 text-red-800 text-xs\">\r\n                  {unreadCount}\r\n                </Badge>\r\n              )}\r\n            </div>\r\n            <div className=\"flex items-center gap-1\">\r\n              {unreadCount > 0 && (\r\n                <button\r\n                  onClick={handleMarkAllAsRead}\r\n                  className=\"p-1 text-gray-500 hover:text-blue-600 rounded\"\r\n                  title={t('notifications.markAllRead')}\r\n                >\r\n                  <CheckCheck className=\"w-4 h-4\" />\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={() => setIsOpen(false)}\r\n                className=\"p-1 text-gray-500 hover:text-gray-700 rounded\"\r\n              >\r\n                <X className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"max-h-80 overflow-y-auto\">\r\n            {loading ? (\r\n              <div className=\"flex items-center justify-center p-8\">\r\n                <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\r\n              </div>\r\n            ) : error ? (\r\n              <div className=\"p-4 text-center text-red-600\">\r\n                <AlertCircle className=\"w-6 h-6 mx-auto mb-2\" />\r\n                <p className=\"text-sm\">{error}</p>\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={refreshNotifications}\r\n                  className=\"mt-2\"\r\n                >\r\n                  {t('common.retry')}\r\n                </Button>\r\n              </div>\r\n            ) : notifications.length === 0 ? (\r\n              <div className=\"p-8 text-center text-gray-500\">\r\n                <Bell className=\"w-8 h-8 mx-auto mb-2 text-gray-400\" />\r\n                <p className=\"text-sm\">{t('notifications.noNotifications')}</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"divide-y divide-gray-100\">\r\n                {notifications.map((notification) => (\r\n                  <div\r\n                    key={notification._id}\r\n                    className={`p-4 hover:bg-gray-50 transition-colors ${\r\n                      !notification.isRead ? 'bg-blue-50/50' : ''\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-start gap-3\">\r\n                      <div className=\"flex-shrink-0 mt-1\">\r\n                        {getNotificationIcon(notification.type)}\r\n                      </div>\r\n                      \r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-start justify-between gap-2\">\r\n                          <div className=\"flex-1\">\r\n                            <h4 className={`text-sm font-medium ${\r\n                              !notification.isRead ? 'text-gray-900' : 'text-gray-700'\r\n                            }`}>\r\n                              {notification.title}\r\n                            </h4>\r\n                            <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">\r\n                              {notification.message}\r\n                            </p>\r\n                            <p className=\"text-xs text-gray-500 mt-2\">\r\n                              {formatNotificationTime(notification.createdAt)}\r\n                            </p>\r\n                          </div>\r\n                          \r\n                          <div className=\"flex items-center gap-1 flex-shrink-0\">\r\n                            {!notification.isRead && (\r\n                              <button\r\n                                onClick={() => handleMarkAsRead(notification._id)}\r\n                                className=\"p-1 text-gray-400 hover:text-blue-600 rounded\"\r\n                                title={t('notifications.markAsRead')}\r\n                              >\r\n                                <Check className=\"w-3 h-3\" />\r\n                              </button>\r\n                            )}\r\n                            <button\r\n                              onClick={() => handleDeleteNotification(notification._id)}\r\n                              className=\"p-1 text-gray-400 hover:text-red-600 rounded\"\r\n                              title={t('notifications.delete')}\r\n                            >\r\n                              <Trash2 className=\"w-3 h-3\" />\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        {!notification.isRead && (\r\n                          <div className=\"w-2 h-2 bg-blue-600 rounded-full absolute left-2 top-4\"></div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          {notifications.length > 0 && (\r\n            <div className=\"p-3 border-t border-gray-200 bg-gray-50\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"w-full\"\r\n                onClick={() => {\r\n                  setIsOpen(false);\r\n                  // Navigate to notifications page if it exists\r\n                  // You can implement this based on your routing\r\n                }}\r\n              >\r\n                <Eye className=\"w-4 h-4 mr-2\" />\r\n                {t('notifications.viewAll')}\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationDropdown;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\notifications\\NotificationTest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\notifications\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\patient\\PatientCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\patient\\PatientFileUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[338,341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[338,341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":144,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4346,4349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4346,4349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react';\nimport { Upload, X, File, Image, FileText, CheckCircle, AlertCircle, Loader } from 'lucide-react';\nimport api from '../../services/api';\nimport { toast } from 'react-hot-toast';\n\ninterface PatientFileUploadProps {\n  patientId: string;\n  appointmentId?: string;\n  onUploadComplete?: (file: any) => void;\n  onClose?: () => void;\n}\n\nconst PatientFileUpload: React.FC<PatientFileUploadProps> = ({\n  patientId,\n  appointmentId,\n  onUploadComplete,\n  onClose\n}) => {\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [dragActive, setDragActive] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Form data\n  const [fileType, setFileType] = useState<string>('x-ray');\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [category, setCategory] = useState('');\n  const [tags, setTags] = useState('');\n  const [captureDate, setCaptureDate] = useState('');\n  const [metadata, setMetadata] = useState({\n    device: '',\n    technician: '',\n    notes: ''\n  });\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === 'dragenter' || e.type === 'dragover') {\n      setDragActive(true);\n    } else if (e.type === 'dragleave') {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFileSelect(e.dataTransfer.files[0]);\n    }\n  };\n\n  const handleFileSelect = (file: File) => {\n    // Validate file type\n    const allowedTypes = [\n      'image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/bmp', 'image/tiff',\n      'application/pdf',\n      'text/plain',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n    ];\n\n    if (!allowedTypes.includes(file.type)) {\n      toast.error('File type not allowed. Please upload images, PDFs, or documents only.');\n      return;\n    }\n\n    // Validate file size (50MB)\n    if (file.size > 50 * 1024 * 1024) {\n      toast.error('File size exceeds 50MB limit.');\n      return;\n    }\n\n    setSelectedFile(file);\n    \n    // Auto-fill title with filename if empty\n    if (!title) {\n      setTitle(file.name.replace(/\\.[^/.]+$/, '')); // Remove extension\n    }\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFileSelect(e.target.files[0]);\n    }\n  };\n\n  const handleUpload = async () => {\n    if (!selectedFile) {\n      toast.error('Please select a file to upload');\n      return;\n    }\n\n    if (!title.trim()) {\n      toast.error('Please provide a title for the file');\n      return;\n    }\n\n    setUploading(true);\n    setUploadProgress(0);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', selectedFile);\n      formData.append('fileType', fileType);\n      formData.append('title', title);\n      if (description) formData.append('description', description);\n      if (category) formData.append('category', category);\n      if (tags) formData.append('tags', tags);\n      if (captureDate) formData.append('captureDate', captureDate);\n      if (appointmentId) formData.append('appointmentId', appointmentId);\n      if (metadata.device || metadata.technician || metadata.notes) {\n        formData.append('metadata', JSON.stringify(metadata));\n      }\n\n      const response = await api.post(\n        `/patients/${patientId}/files`,\n        formData,\n        {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          },\n          onUploadProgress: (progressEvent) => {\n            const progress = progressEvent.total \n              ? Math.round((progressEvent.loaded * 100) / progressEvent.total)\n              : 0;\n            setUploadProgress(progress);\n          }\n        }\n      );\n\n      if (response.data.success) {\n        toast.success('File uploaded successfully');\n        if (onUploadComplete) {\n          onUploadComplete(response.data.data);\n        }\n        resetForm();\n      }\n    } catch (error: any) {\n      console.error('Upload error:', error);\n      toast.error(error.response?.data?.message || 'Failed to upload file');\n    } finally {\n      setUploading(false);\n      setUploadProgress(0);\n    }\n  };\n\n  const resetForm = () => {\n    setSelectedFile(null);\n    setTitle('');\n    setDescription('');\n    setCategory('');\n    setTags('');\n    setCaptureDate('');\n    setMetadata({ device: '', technician: '', notes: '' });\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const getFileIcon = (file: File) => {\n    if (file.type.startsWith('image/')) {\n      return <Image className=\"w-8 h-8 text-blue-600\" />;\n    } else if (file.type === 'application/pdf') {\n      return <FileText className=\"w-8 h-8 text-red-600\" />;\n    } else {\n      return <File className=\"w-8 h-8 text-gray-600\" />;\n    }\n  };\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n  };\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm p-6\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"text-xl font-semibold text-gray-900\">Upload Patient File</h3>\n        {onClose && (\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            disabled={uploading}\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        )}\n      </div>\n\n      {/* File Drop Zone */}\n      <div\n        className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\n          dragActive \n            ? 'border-blue-500 bg-blue-50' \n            : 'border-gray-300 hover:border-blue-400 hover:bg-gray-50'\n        } ${selectedFile ? 'bg-green-50 border-green-300' : ''}`}\n        onDragEnter={handleDrag}\n        onDragLeave={handleDrag}\n        onDragOver={handleDrag}\n        onDrop={handleDrop}\n      >\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          onChange={handleInputChange}\n          className=\"hidden\"\n          accept=\"image/*,application/pdf,.doc,.docx,.txt\"\n          disabled={uploading}\n        />\n\n        {!selectedFile ? (\n          <>\n            <Upload className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n            <p className=\"text-lg font-medium text-gray-700 mb-2\">\n              Drop files here or click to browse\n            </p>\n            <p className=\"text-sm text-gray-500 mb-4\">\n              Supported: Images (JPG, PNG, GIF, TIFF), PDF, Documents\n            </p>\n            <p className=\"text-xs text-gray-400\">\n              Maximum file size: 50MB\n            </p>\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              className=\"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n              disabled={uploading}\n            >\n              Select File\n            </button>\n          </>\n        ) : (\n          <div className=\"flex items-center justify-center space-x-4\">\n            {getFileIcon(selectedFile)}\n            <div className=\"text-left\">\n              <p className=\"font-medium text-gray-900\">{selectedFile.name}</p>\n              <p className=\"text-sm text-gray-600\">{formatFileSize(selectedFile.size)}</p>\n            </div>\n            <CheckCircle className=\"w-6 h-6 text-green-600\" />\n            <button\n              onClick={() => setSelectedFile(null)}\n              className=\"p-2 hover:bg-red-50 rounded-lg transition-colors\"\n              disabled={uploading}\n            >\n              <X className=\"w-5 h-5 text-red-600\" />\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Upload Form */}\n      {selectedFile && (\n        <div className=\"mt-6 space-y-4\">\n          {/* File Type */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              File Type *\n            </label>\n            <select\n              value={fileType}\n              onChange={(e) => setFileType(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={uploading}\n            >\n              <option value=\"x-ray\">X-Ray</option>\n              <option value=\"scan\">Scan (CT/MRI)</option>\n              <option value=\"note\">Clinical Note</option>\n              <option value=\"lab-result\">Lab Result</option>\n              <option value=\"consent-form\">Consent Form</option>\n              <option value=\"other\">Other</option>\n            </select>\n          </div>\n\n          {/* Title */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Title *\n            </label>\n            <input\n              type=\"text\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              placeholder=\"e.g., Panoramic X-Ray\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={uploading}\n              required\n            />\n          </div>\n\n          {/* Description */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Description\n            </label>\n            <textarea\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              placeholder=\"Additional details about this file...\"\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n              disabled={uploading}\n            />\n          </div>\n\n          {/* Row: Category and Capture Date */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Category\n              </label>\n              <input\n                type=\"text\"\n                value={category}\n                onChange={(e) => setCategory(e.target.value)}\n                placeholder=\"e.g., Orthodontics\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                disabled={uploading}\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Capture Date\n              </label>\n              <input\n                type=\"date\"\n                value={captureDate}\n                onChange={(e) => setCaptureDate(e.target.value)}\n                max={new Date().toISOString().split('T')[0]}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                disabled={uploading}\n              />\n            </div>\n          </div>\n\n          {/* Tags */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Tags (comma-separated)\n            </label>\n            <input\n              type=\"text\"\n              value={tags}\n              onChange={(e) => setTags(e.target.value)}\n              placeholder=\"e.g., pre-treatment, panoramic, wisdom-teeth\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              disabled={uploading}\n            />\n          </div>\n\n          {/* Metadata (Collapsible) */}\n          <details className=\"border border-gray-200 rounded-lg p-4\">\n            <summary className=\"cursor-pointer font-medium text-gray-700\">\n              Additional Metadata (Optional)\n            </summary>\n            <div className=\"mt-4 space-y-3\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Device/Equipment\n                </label>\n                <input\n                  type=\"text\"\n                  value={metadata.device}\n                  onChange={(e) => setMetadata({ ...metadata, device: e.target.value })}\n                  placeholder=\"e.g., Sirona ORTHOPHOS XG 3D\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  disabled={uploading}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Technician/Operator\n                </label>\n                <input\n                  type=\"text\"\n                  value={metadata.technician}\n                  onChange={(e) => setMetadata({ ...metadata, technician: e.target.value })}\n                  placeholder=\"Name of technician\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  disabled={uploading}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Technical Notes\n                </label>\n                <textarea\n                  value={metadata.notes}\n                  onChange={(e) => setMetadata({ ...metadata, notes: e.target.value })}\n                  placeholder=\"Technical notes about the capture...\"\n                  rows={2}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n                  disabled={uploading}\n                />\n              </div>\n            </div>\n          </details>\n\n          {/* Upload Progress */}\n          {uploading && (\n            <div className=\"mt-4\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium text-gray-700\">Uploading...</span>\n                <span className=\"text-sm font-medium text-blue-600\">{uploadProgress}%</span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                <div\n                  className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${uploadProgress}%` }}\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-end gap-3 pt-4\">\n            <button\n              onClick={resetForm}\n              className=\"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n              disabled={uploading}\n            >\n              Reset\n            </button>\n            <button\n              onClick={handleUpload}\n              disabled={uploading || !selectedFile || !title.trim()}\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center\"\n            >\n              {uploading ? (\n                <>\n                  <Loader className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Uploading...\n                </>\n              ) : (\n                <>\n                  <Upload className=\"w-4 h-4 mr-2\" />\n                  Upload File\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Security Notice */}\n      <div className=\"mt-6 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n        <div className=\"flex items-start\">\n          <AlertCircle className=\"w-5 h-5 text-blue-600 mr-2 flex-shrink-0 mt-0.5\" />\n          <div>\n            <p className=\"text-sm font-medium text-blue-900\">HIPAA Compliance</p>\n            <p className=\"text-xs text-blue-700 mt-1\">\n              All uploaded files are encrypted at rest and access is logged for audit purposes. \n              Only authorized personnel can view patient files.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PatientFileUpload;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\patient\\PatientMedicalHistory.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":329,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":329,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13967,13970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13967,13970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, Button, Badge, Modal, Input, Textarea } from '../ui';\nimport type { Patient } from '../../types';\nimport { formatDate } from '../../utils';\nimport { useLanguage } from '../../context/LanguageContext';\n\ninterface MedicalRecord {\n  id: string;\n  date: Date;\n  type: 'diagnosis' | 'treatment' | 'prescription' | 'note';\n  title: string;\n  description: string;\n  provider: string;\n  attachments?: string[];\n}\n\ninterface PatientMedicalHistoryProps {\n  patient: Patient;\n  onUpdate?: (patientId: string, updates: Partial<Patient>) => void;\n  readOnly?: boolean;\n}\n\nconst PatientMedicalHistory: React.FC<PatientMedicalHistoryProps> = ({\n  patient,\n  onUpdate,\n  readOnly = false\n}) => {\n  const { t } = useLanguage();\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingAllergy, setEditingAllergy] = useState<string | null>(null);\n  const [editingCondition, setEditingCondition] = useState<string | null>(null);\n  const [newAllergy, setNewAllergy] = useState('');\n  const [newCondition, setNewCondition] = useState('');\n  const [newRecord, setNewRecord] = useState<Partial<MedicalRecord>>({\n    type: 'note',\n    title: '',\n    description: '',\n    provider: ''\n  });\n\n  // Mock medical records - in real app, this would come from API\n  const [medicalRecords] = useState<MedicalRecord[]>([\n    {\n      id: '1',\n      date: new Date('2024-01-15'),\n      type: 'diagnosis',\n      title: 'Routine Dental Cleaning',\n      description: 'Regular cleaning and examination. No issues found.',\n      provider: 'Dr. Smith'\n    },\n    {\n      id: '2',\n      date: new Date('2023-12-10'),\n      type: 'treatment',\n      title: 'Cavity Filling',\n      description: 'Filled cavity in upper right molar. Used composite filling.',\n      provider: 'Dr. Johnson'\n    },\n    {\n      id: '3',\n      date: new Date('2023-11-05'),\n      type: 'prescription',\n      title: 'Antibiotic Prescription',\n      description: 'Prescribed amoxicillin for infection prevention post-procedure.',\n      provider: 'Dr. Smith'\n    }\n  ]);\n\n  const handleAddAllergy = () => {\n    if (newAllergy.trim() && onUpdate) {\n      const updatedAllergies = [...(patient.medicalHistory?.allergies || []), newAllergy.trim()];\n      const updatedMedicalHistory = { ...patient.medicalHistory, allergies: updatedAllergies };\n      onUpdate(patient.id, { medicalHistory: updatedMedicalHistory });\n      setNewAllergy('');\n      setEditingAllergy(null);\n    }\n  };\n\n  const handleRemoveAllergy = (allergy: string) => {\n    if (onUpdate) {\n      const updatedAllergies = (patient.medicalHistory?.allergies || []).filter(a => a !== allergy);\n      const updatedMedicalHistory = { ...patient.medicalHistory, allergies: updatedAllergies };\n      onUpdate(patient.id, { medicalHistory: updatedMedicalHistory });\n    }\n  };\n\n  const handleAddCondition = () => {\n    if (newCondition.trim() && onUpdate) {\n      const updatedConditions = [...(patient.medicalHistory?.conditions || []), newCondition.trim()];\n      const updatedMedicalHistory = { ...patient.medicalHistory, conditions: updatedConditions };\n      onUpdate(patient.id, { medicalHistory: updatedMedicalHistory });\n      setNewCondition('');\n      setEditingCondition(null);\n    }\n  };\n\n  const handleRemoveCondition = (condition: string) => {\n    if (onUpdate) {\n      const updatedConditions = (patient.medicalHistory?.conditions || []).filter(c => c !== condition);\n      const updatedMedicalHistory = { ...patient.medicalHistory, conditions: updatedConditions };\n      onUpdate(patient.id, { medicalHistory: updatedMedicalHistory });\n    }\n  };\n\n  const handleAddRecord = () => {\n    if (newRecord.title && newRecord.description) {\n      // In real app, this would call an API\n      console.log('Adding medical record:', newRecord);\n      setNewRecord({\n        type: 'note',\n        title: '',\n        description: '',\n        provider: ''\n      });\n      setShowAddModal(false);\n    }\n  };\n\n  const getRecordTypeVariant = (type: string) => {\n    switch (type) {\n      case 'diagnosis': return 'info';\n      case 'treatment': return 'success';\n      case 'prescription': return 'warning';\n      case 'note': return 'gray';\n      default: return 'gray';\n    }\n  };\n\n  const getRecordTypeIcon = (type: string) => {\n    switch (type) {\n      case 'diagnosis':\n        return (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>\n        );\n      case 'treatment':\n        return (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n          </svg>\n        );\n      case 'prescription':\n        return (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\n          </svg>\n        );\n      default:\n        return (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n          </svg>\n        );\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Allergies Section */}\n      <Card title=\"Allergies\" className=\"p-6\">\n        <div className=\"space-y-3\">\n          {patient.medicalHistory && patient.medicalHistory.allergies && patient.medicalHistory.allergies.length > 0 ? (\n            <div className=\"flex flex-wrap gap-2\">\n              {patient.medicalHistory.allergies.map((allergy, index) => (\n                <div key={index} className=\"flex items-center gap-1\">\n                  <Badge variant=\"danger\">{allergy}</Badge>\n                  {!readOnly && (\n                    <button\n                      onClick={() => handleRemoveAllergy(allergy)}\n                      className=\"text-red-500 hover:text-red-700 ml-1\"\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                      </svg>\n                    </button>\n                  )}\n                </div>\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-500 text-sm\">No known allergies</p>\n          )}\n          \n          {!readOnly && (\n            <div className=\"mt-3\">\n              {editingAllergy ? (\n                <div className=\"flex gap-2\">\n                  <Input\n                    type=\"text\"\n                    placeholder=\"Enter allergy\"\n                    value={newAllergy}\n                    onChange={(e) => setNewAllergy(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && handleAddAllergy()}\n                    className=\"flex-1\"\n                  />\n                  <Button size=\"sm\" onClick={handleAddAllergy}>{t('patientSettings.medical.addAllergy')}</Button>\n                  <Button size=\"sm\" variant=\"outline\" onClick={() => setEditingAllergy(null)}>{t('patientSettings.buttons.cancel')}</Button>\n                </div>\n              ) : (\n                <Button size=\"sm\" variant=\"outline\" onClick={() => setEditingAllergy('new')}>\n                  <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                  </svg>\n                  Add Allergy\n                </Button>\n              )}\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Medical Conditions Section */}\n      <Card title=\"Medical History\" className=\"p-6\">\n        <div className=\"space-y-3\">\n          {patient.medicalHistory && patient.medicalHistory.conditions && patient.medicalHistory.conditions.length > 0 ? (\n            <div className=\"flex flex-wrap gap-2\">\n              {patient.medicalHistory.conditions.map((condition, index) => (\n                <div key={index} className=\"flex items-center gap-1\">\n                  <Badge variant=\"info\">{condition}</Badge>\n                  {!readOnly && (\n                    <button\n                      onClick={() => handleRemoveCondition(condition)}\n                      className=\"text-red-500 hover:text-red-700 ml-1\"\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                      </svg>\n                    </button>\n                  )}\n                </div>\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-500 text-sm\">No medical history recorded</p>\n          )}\n          \n          {!readOnly && (\n            <div className=\"mt-3\">\n              {editingCondition ? (\n                <div className=\"flex gap-2\">\n                  <Input\n                    type=\"text\"\n                    placeholder=\"Enter medical condition\"\n                    value={newCondition}\n                    onChange={(e) => setNewCondition(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && handleAddCondition()}\n                    className=\"flex-1\"\n                  />\n                  <Button size=\"sm\" onClick={handleAddCondition}>{t('patientSettings.medical.addCondition')}</Button>\n                  <Button size=\"sm\" variant=\"outline\" onClick={() => setEditingCondition(null)}>{t('patientSettings.buttons.cancel')}</Button>\n                </div>\n              ) : (\n                <Button size=\"sm\" variant=\"outline\" onClick={() => setEditingCondition('new')}>\n                  <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                  </svg>\n                  Add Condition\n                </Button>\n              )}\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Medical Records Section */}\n      <Card title=\"Medical Records\" className=\"p-6\">\n        <div className=\"space-y-4\">\n          <div className=\"flex justify-between items-center\">\n            <h4 className=\"text-lg font-medium text-gray-900\">Recent Records</h4>\n            {!readOnly && (\n              <Button size=\"sm\" onClick={() => setShowAddModal(true)}>\n                <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                </svg>\n                Add Record\n              </Button>\n            )}\n          </div>\n          \n          {medicalRecords.length > 0 ? (\n            <div className=\"space-y-3\">\n              {medicalRecords.map(record => (\n                <div key={record.id} className=\"border border-gray-200 rounded-lg p-4\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex items-start gap-3 flex-1\">\n                      <div className={`p-2 rounded-full bg-${getRecordTypeVariant(record.type)}-100 text-${getRecordTypeVariant(record.type)}-600`}>\n                        {getRecordTypeIcon(record.type)}\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <h5 className=\"font-medium text-gray-900\">{record.title}</h5>\n                          <Badge variant={getRecordTypeVariant(record.type)} size=\"sm\">\n                            {record.type.charAt(0).toUpperCase() + record.type.slice(1)}\n                          </Badge>\n                        </div>\n                        <p className=\"text-sm text-gray-600 mb-2\">{record.description}</p>\n                        <div className=\"flex items-center gap-4 text-xs text-gray-500\">\n                          <span>{formatDate(record.date)}</span>\n                          <span></span>\n                          <span>{record.provider}</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-500 text-sm\">No medical records found</p>\n          )}\n        </div>\n      </Card>\n\n      {/* Add Record Modal */}\n      <Modal\n        isOpen={showAddModal}\n        onClose={() => setShowAddModal(false)}\n        title=\"Add Medical Record\"\n        size=\"lg\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Record Type\n            </label>\n            <select\n              value={newRecord.type}\n              onChange={(e) => setNewRecord(prev => ({ ...prev, type: e.target.value as any }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"note\">Note</option>\n              <option value=\"diagnosis\">Diagnosis</option>\n              <option value=\"treatment\">Treatment</option>\n              <option value=\"prescription\">Prescription</option>\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Title\n            </label>\n            <Input\n              type=\"text\"\n              value={newRecord.title || ''}\n              onChange={(e) => setNewRecord(prev => ({ ...prev, title: e.target.value }))}\n              placeholder=\"Enter record title\"\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Description\n            </label>\n            <Textarea\n              value={newRecord.description || ''}\n              onChange={(e) => setNewRecord(prev => ({ ...prev, description: e.target.value }))}\n              placeholder=\"Enter detailed description\"\n              rows={4}\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Provider\n            </label>\n            <Input\n              type=\"text\"\n              value={newRecord.provider || ''}\n              onChange={(e) => setNewRecord(prev => ({ ...prev, provider: e.target.value }))}\n              placeholder=\"Enter provider name\"\n            />\n          </div>\n          \n          <div className=\"flex gap-3 pt-4\">\n            <Button onClick={handleAddRecord} className=\"flex-1\">\n              Add Record\n            </Button>\n            <Button variant=\"outline\" onClick={() => setShowAddModal(false)} className=\"flex-1\">\n              Cancel\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n};\n\nexport default PatientMedicalHistory;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\patient\\PatientSearch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\patient\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\prescriptions\\MedicationSafetyModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\prescriptions\\PrescriptionDetails.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2742,2745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2742,2745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { User, Pill, FileText, RefreshCw, Plus } from 'lucide-react';\nimport Button from '../ui/Button';\nimport Card from '../ui/Card';\nimport Badge from '../ui/Badge';\nimport Textarea from '../ui/Textarea';\nimport Modal from '../ui/Modal';\nimport { useAuth } from '../../hooks/useAuth';\nimport { prescriptionService } from '../../services/prescriptionService';\nimport { toast } from 'react-hot-toast';\nimport { format } from 'date-fns';\n\ninterface Prescription {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n  };\n  dentist: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  clinic: {\n    _id: string;\n    name: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n  };\n  medications: Array<{\n    medication: {\n      _id: string;\n      name: string;\n      genericName?: string;\n    };\n    dosage: string;\n    frequency: string;\n    duration: string;\n    instructions?: string;\n  }>;\n  diagnosis: string;\n  notes?: string;\n  status: 'active' | 'completed' | 'cancelled';\n  issuedDate: string;\n  expiryDate: string;\n  refills: Array<{\n    date: string;\n    refillNumber: number;\n    notes?: string;\n  }>;\n  maxRefills: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface PrescriptionDetailsProps {\n  prescription: Prescription;\n  onClose: () => void;\n  onRefresh: () => void;\n}\n\nexport const PrescriptionDetails: React.FC<PrescriptionDetailsProps> = ({\n  prescription,\n  onClose,\n  onRefresh\n}) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [isRefillModalOpen, setIsRefillModalOpen] = useState(false);\n  const [refillNotes, setRefillNotes] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const isExpired = new Date(prescription.expiryDate) < new Date();\n  const canRefill = prescription.refills.length < prescription.maxRefills && !isExpired && prescription.status === 'active';\n  const canManageRefills = user?.role === 'dentist' || user?.role === 'admin';\n\n  const getStatusColor = (status: string) => {\n    const colors = {\n      active: 'bg-green-100 text-green-800',\n      completed: 'bg-blue-100 text-blue-800',\n      cancelled: 'bg-red-100 text-red-800'\n    };\n    return colors[status as keyof typeof colors] || colors.active;\n  };\n\n  const handleAddRefill = async () => {\n    try {\n      setLoading(true);\n      await prescriptionService.addRefill(prescription._id, {\n        notes: refillNotes || undefined\n      });\n      toast.success(t('prescriptionDetails.toasts.refillSuccess'));\n      setIsRefillModalOpen(false);\n      setRefillNotes('');\n      onRefresh();\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('prescriptionDetails.toasts.refillError'));\n      console.error('Error adding refill:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-start\">\n          <div>\n            <h3 className=\"text-xl font-semibold text-gray-900\">\n              {t('prescriptionDetails.title', { id: prescription._id.slice(-8) })}\n            </h3>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <Badge className={getStatusColor(prescription.status)}>\n                {t(`prescriptionDetails.status.${prescription.status}`)}\n              </Badge>\n              {isExpired && (\n                <Badge className=\"bg-red-100 text-red-800\">\n                  {t('prescriptionDetails.expired')}\n                </Badge>\n              )}\n            </div>\n          </div>\n          {canManageRefills && canRefill && (\n            <Button\n              onClick={() => setIsRefillModalOpen(true)}\n              className=\"flex items-center gap-2\"\n              size=\"sm\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              {t('prescriptionDetails.addRefill')}\n            </Button>\n          )}\n        </div>\n\n        {/* Patient Information */}\n        <Card className=\"p-4\">\n          <h4 className=\"text-lg font-medium text-gray-900 mb-3 flex items-center gap-2\">\n            <User className=\"h-5 w-5\" />\n            {t('prescriptionDetails.patientInfo')}\n          </h4>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.name')}</p>\n              <p className=\"font-medium\">\n                {prescription.patient.firstName} {prescription.patient.lastName}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.email')}</p>\n              <p className=\"font-medium\">{prescription.patient.email}</p>\n            </div>\n          </div>\n        </Card>\n\n        {/* Prescription Information */}\n        <Card className=\"p-4\">\n          <h4 className=\"text-lg font-medium text-gray-900 mb-3 flex items-center gap-2\">\n            <FileText className=\"h-5 w-5\" />\n            {t('prescriptionDetails.prescriptionInfo')}\n          </h4>\n          <div className=\"space-y-4\">\n            <div>\n              <p className=\"text-sm text-gray-600 mb-1\">{t('prescriptionDetails.diagnosis')}</p>\n              <p className=\"text-gray-900\">{prescription.diagnosis}</p>\n            </div>\n            \n            {prescription.notes && (\n              <div>\n                <p className=\"text-sm text-gray-600 mb-1\">{t('prescriptionDetails.notes')}</p>\n                <p className=\"text-gray-900\">{prescription.notes}</p>\n              </div>\n            )}\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.issuedDate')}</p>\n                <p className=\"font-medium\">\n                  {format(new Date(prescription.issuedDate), 'MMM dd, yyyy')}\n                </p>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.expiryDate')}</p>\n                <p className=\"font-medium\">\n                  {format(new Date(prescription.expiryDate), 'MMM dd, yyyy')}\n                </p>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.maxRefills')}</p>\n                <p className=\"font-medium\">{prescription.maxRefills}</p>\n              </div>\n            </div>\n          </div>\n        </Card>\n\n        {/* Medications */}\n        <Card className=\"p-4\">\n          <h4 className=\"text-lg font-medium text-gray-900 mb-3 flex items-center gap-2\">\n            <Pill className=\"h-5 w-5\" />\n            {t('prescriptionDetails.medications')}\n          </h4>\n          <div className=\"space-y-4\">\n            {prescription.medications.map((med, index) => (\n              <div key={med.medication._id || `med-${index}`} className=\"border border-gray-200 rounded-lg p-4\">\n                <div className=\"flex justify-between items-start mb-2\">\n                  <div>\n                    <h5 className=\"font-medium text-gray-900\">{med.medication.name}</h5>\n                    {med.medication.genericName && (\n                      <p className=\"text-sm text-gray-600\">\n                        {t('prescriptionDetails.genericName', { name: med.medication.genericName })}\n                      </p>\n                    )}\n                  </div>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-3\">\n                  <div>\n                    <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.dosage')}</p>\n                    <p className=\"font-medium\">{med.dosage}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.frequency')}</p>\n                    <p className=\"font-medium\">{med.frequency}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.duration')}</p>\n                    <p className=\"font-medium\">{med.duration}</p>\n                  </div>\n                </div>\n                \n                {med.instructions && (\n                  <div className=\"mt-3\">\n                    <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.instructions')}</p>\n                    <p className=\"text-gray-900\">{med.instructions}</p>\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        </Card>\n\n        {/* Refill History */}\n        <Card className=\"p-4\">\n          <h4 className=\"text-lg font-medium text-gray-900 mb-3 flex items-center gap-2\">\n            <RefreshCw className=\"h-5 w-5\" />\n            {t('prescriptionDetails.refillHistory', { count: prescription.refills.length, max: prescription.maxRefills })}\n          </h4>\n          \n          {prescription.refills.length > 0 ? (\n            <div className=\"space-y-3\">\n              {prescription.refills.map((refill, _index) => (\n                <div key={`refill-${refill.refillNumber}-${refill.date}`} className=\"border border-gray-200 rounded-lg p-3\">\n                  <div className=\"flex justify-between items-start\">\n                    <div>\n                      <p className=\"font-medium text-gray-900\">\n                        {t('prescriptionDetails.refillTitle', { number: refill.refillNumber })}\n                      </p>\n                      <p className=\"text-sm text-gray-600\">\n                        {format(new Date(refill.date), 'MMM dd, yyyy HH:mm')}\n                      </p>\n                    </div>\n                  </div>\n                  {refill.notes && (\n                    <div className=\"mt-2\">\n                      <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.notes')}</p>\n                      <p className=\"text-sm text-gray-900\">{refill.notes}</p>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-600 text-center py-4\">\n              {t('prescriptionDetails.noRefills')}\n            </p>\n          )}\n        </Card>\n\n        {/* Provider Information */}\n        <Card className=\"p-4\">\n          <h4 className=\"text-lg font-medium text-gray-900 mb-3\">{t('prescriptionDetails.providerInfo')}</h4>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.prescribingDentist')}</p>\n              <p className=\"font-medium\">\n                {t('prescriptionDetails.dentistPrefix')} {prescription.dentist.firstName} {prescription.dentist.lastName}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.clinic')}</p>\n              <p className=\"font-medium\">{prescription.clinic.name}</p>\n            </div>\n            {prescription.appointment && (\n              <div className=\"md:col-span-2\">\n                <p className=\"text-sm text-gray-600\">{t('prescriptionDetails.relatedAppointment')}</p>\n                <p className=\"font-medium\">\n                  {format(new Date(prescription.appointment.date), 'MMM dd, yyyy')}\n                </p>\n              </div>\n            )}\n          </div>\n        </Card>\n\n        {/* Actions */}\n        <div className=\"flex justify-end\">\n          <Button onClick={onClose} variant=\"outline\">\n            {t('prescriptionDetails.close')}\n          </Button>\n        </div>\n      </div>\n\n      {/* Add Refill Modal */}\n      <Modal\n        isOpen={isRefillModalOpen}\n        onClose={() => {\n          setIsRefillModalOpen(false);\n          setRefillNotes('');\n        }}\n        title={t('prescriptionDetails.modal.title')}\n        size=\"lg\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <p className=\"text-sm text-gray-600 mb-2\">\n              {t('prescriptionDetails.modal.addingRefill', { count: prescription.refills.length + 1, max: prescription.maxRefills })}\n            </p>\n            <p className=\"text-sm text-gray-800\">\n              {t('prescriptionDetails.modal.patient', { name: `${prescription.patient.firstName} ${prescription.patient.lastName}` })}\n            </p>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('prescriptionDetails.modal.notesLabel')}\n            </label>\n            <Textarea\n              value={refillNotes}\n              onChange={(e) => setRefillNotes(e.target.value)}\n              placeholder={t('prescriptionDetails.modal.notesPlaceholder')}\n              rows={3}\n            />\n          </div>\n          \n          <div className=\"flex justify-end gap-3\">\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setIsRefillModalOpen(false);\n                setRefillNotes('');\n              }}\n              disabled={loading}\n            >\n              {t('prescriptionDetails.modal.cancel')}\n            </Button>\n            <Button\n              onClick={handleAddRefill}\n              isLoading={loading}\n              disabled={loading}\n            >\n              {t('prescriptionDetails.modal.submit')}\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\prescriptions\\PrescriptionForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5734,5737],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5734,5737],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5757,5760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5757,5760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5916,5919],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5916,5919],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":194,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":194,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5976,5979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5976,5979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'patients'. Either include it or remove the dependency array.","line":220,"column":6,"nodeType":"ArrayExpression","endLine":220,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [patients, selectedPatient]","fix":{"range":[6806,6823],"text":"[patients, selectedPatient]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":272,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":272,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8485,8488],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8485,8488],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":378,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":378,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12328,12331],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12328,12331],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":378,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":378,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12351,12354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12351,12354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":420,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":420,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13871,13874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13871,13874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":430,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":430,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14266,14269],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14266,14269],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":430,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":430,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14289,14292],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14289,14292],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { Plus, X, Search } from 'lucide-react';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport Textarea from '../ui/Textarea';\nimport Modal from '../ui/Modal';\nimport { MedicationList } from '../medications/MedicationList';\nimport { prescriptionService } from '../../services/prescriptionService';\nimport { patientService } from '../../services/patientService';\nimport { appointmentService } from '../../services/appointmentService';\nimport { toast } from 'react-hot-toast';\nimport { format } from 'date-fns';\nimport { useTranslation } from 'react-i18next';\nimport { useClinic } from '../../context/ClinicContext';\n\nconst getPrescriptionSchema = (t: (key: string) => string) => z.object({\n  patient: z.string().min(1, t('prescriptionForm.validation.patientRequired')),\n  appointment: z.string().optional(),\n  medications: z.array(z.object({\n    medication: z.string().min(1, t('prescriptionForm.validation.medicationRequired')),\n    medicationName: z.string().optional(),\n    dosage: z.string().min(1, t('prescriptionForm.validation.dosageRequired')),\n    frequency: z.string().min(1, t('prescriptionForm.validation.frequencyRequired')),\n    duration: z.string().min(1, t('prescriptionForm.validation.durationRequired')),\n    instructions: z.string().optional()\n  })).min(1, t('prescriptionForm.validation.atLeastOneMedication')),\n  diagnosis: z.string().min(1, t('prescriptionForm.validation.diagnosisRequired')),\n  notes: z.string().optional(),\n  expiryDate: z.string().min(1, t('prescriptionForm.validation.expiryDateRequired')),\n  maxRefills: z.number().min(0).max(10, t('prescriptionForm.validation.maxRefillsExceeded'))\n});\n\ntype PrescriptionFormData = z.infer<ReturnType<typeof getPrescriptionSchema>>;\n\ninterface Patient {\n  id: string;\n  firstName: string;\n  lastName: string;\n  email: string;\n}\n\ninterface Appointment {\n  _id: string;\n  date: string;\n  time: string;\n  type: string;\n}\n\n\ninterface Prescription {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n  };\n  medications: Array<{\n    medication: {\n      _id: string;\n      name: string;\n    };\n    dosage: string;\n    frequency: string;\n    duration: string;\n    instructions?: string;\n  }>;\n  diagnosis: string;\n  notes?: string;\n  expiryDate: string;\n  maxRefills: number;\n}\n\ninterface PrescriptionFormProps {\n  prescription?: Prescription | null;\n  patientId: string;\n  appointmentId?: string;\n  onSave: () => void;\n  onCancel: () => void;\n}\n\nexport const PrescriptionForm: React.FC<PrescriptionFormProps> = ({\n  prescription,\n  patientId,\n  appointmentId,\n  onSave,\n  onCancel\n}) => {\n  const { t } = useTranslation();\n  const { selectedClinic } = useClinic();\n  const prescriptionSchema = getPrescriptionSchema(t);\n  // const { user } = useAuth(); // Commented out as not currently used\n  const [loading, setLoading] = useState(false);\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [isMedicationModalOpen, setIsMedicationModalOpen] = useState(false);\n  const [selectedMedicationIndex, setSelectedMedicationIndex] = useState<number | null>(null);\n\n  const {\n    register,\n    control,\n    handleSubmit,\n    formState: { errors, isSubmitted },\n    reset,\n    watch,\n    setValue,\n    clearErrors,\n    trigger\n  } = useForm<PrescriptionFormData>({\n    resolver: zodResolver(prescriptionSchema),\n    mode: 'onChange',\n    reValidateMode: 'onChange',\n    defaultValues: {\n      patient: patientId || '',\n      appointment: '',\n      medications: [{\n        medication: '',\n        medicationName: '',\n        dosage: '',\n        frequency: '',\n        duration: '',\n        instructions: ''\n      }],\n      diagnosis: '',\n      notes: '',\n      expiryDate: '',\n      maxRefills: 3\n    }\n  });\n\n  const {\n    fields: medicationFields,\n    append: appendMedication,\n    remove: removeMedication\n  } = useFieldArray({\n    control,\n    name: 'medications'\n  });\n\n  const selectedPatient = watch('patient');\n\n\n  // Fetch patients\n  useEffect(() => {\n    const fetchPatients = async () => {\n      try {\n        const response = await patientService.getPatients({ limit: 100 });\n        setPatients((response.data as unknown) as Patient[]);\n      } catch (_error) {\n        console.error('Error fetching patients:', _error);\n      }\n    };\n\n    if (!patientId) {\n      fetchPatients();\n    }\n  }, [patientId]);\n\n  // Fetch appointments for selected patient\n  useEffect(() => {\n    const fetchAppointments = async () => {\n      if (!selectedPatient) {\n        setAppointments([]);\n        return;\n      }\n\n      console.log('Fetching appointments for patient:', selectedPatient);\n      console.log('Patient type:', typeof selectedPatient);\n\n      // Check if selectedPatient is a patient ID or patient name\n      let patientId = selectedPatient;\n      \n      // If it's a patient name (contains @), try to find the patient ID\n      if (typeof selectedPatient === 'string' && selectedPatient.includes('@')) {\n        console.log('Looking for patient:', selectedPatient);\n        console.log('Available patients:', patients.length);\n        console.log('Patients list:', patients.map(p => `${p.firstName} ${p.lastName} (${p.email})`));\n        \n        const patient = patients.find(p => \n          `${p.firstName} ${p.lastName} (${p.email})` === selectedPatient\n        );\n        if (patient) {\n          patientId = (patient as any).id || (patient as any)._id;\n          console.log('Found patient:', patient);\n          console.log('Patient ID:', patientId);\n          console.log('Patient _id:', (patient as any)._id);\n          console.log('Patient id:', (patient as any).id);\n        } else {\n          console.log('Patient not found in patients list, skipping appointment fetch');\n          console.log('Expected format:', selectedPatient);\n          setAppointments([]);\n          return;\n        }\n      }\n\n      try {\n        const response = await appointmentService.getAppointments({\n          patientId: patientId,\n          status: 'completed',\n          limit: 50\n        });\n        \n        // Ensure response is an array before setting\n        const appointmentData = Array.isArray(response) ? response : [];\n        setAppointments(appointmentData as unknown as Appointment[]);\n      } catch (_error) {\n        console.error('Error fetching appointments:', _error);\n        setAppointments([]); // Ensure appointments is always an array\n      }\n    };\n\n    fetchAppointments();\n  }, [selectedPatient]);\n\n  // Set default expiry date (30 days from now)\n  useEffect(() => {\n    if (!prescription) {\n      const defaultExpiryDate = new Date();\n      defaultExpiryDate.setDate(defaultExpiryDate.getDate() + 30);\n      setValue('expiryDate', defaultExpiryDate.toISOString().split('T')[0]);\n    }\n  }, [prescription, setValue]);\n\n  // Pre-fill patient when patientId is provided\n  useEffect(() => {\n    if (patientId && !prescription) {\n      setValue('patient', patientId, {\n        shouldValidate: true,\n        shouldDirty: true,\n        shouldTouch: true\n      });\n      clearErrors('patient');\n    }\n  }, [patientId, prescription, setValue, clearErrors]);\n\n  // Pre-fill appointment when appointmentId is provided\n  useEffect(() => {\n    if (appointmentId && !prescription) {\n      setValue('appointment', appointmentId);\n    }\n  }, [appointmentId, prescription, setValue]);\n\n  // Load prescription data for editing\n  useEffect(() => {\n    if (prescription) {\n      reset({\n        patient: prescription.patient._id,\n        appointment: prescription.appointment?._id || '',\n        medications: prescription.medications.map(med => ({\n          medication: med.medication._id,\n          medicationName: med.medication.name,\n          dosage: med.dosage,\n          frequency: med.frequency,\n          duration: med.duration,\n          instructions: med.instructions || ''\n        })),\n        diagnosis: prescription.diagnosis,\n        notes: prescription.notes || '',\n        expiryDate: prescription.expiryDate.split('T')[0],\n        maxRefills: prescription.maxRefills\n      });\n    }\n  }, [prescription, reset]);\n\n  const handleSelectMedication = (medication: any) => {\n    if (selectedMedicationIndex !== null) {\n      console.log('Selected medication:', medication);\n      console.log('Setting medication ID for index:', selectedMedicationIndex);\n      \n      // Set medication ID first and foremost (use id or _id)\n      const medicationId = medication._id || medication.id;\n      setValue(`medications.${selectedMedicationIndex}.medication`, medicationId, {\n        shouldValidate: true,\n        shouldDirty: true,\n        shouldTouch: true\n      });\n      \n      // Set other fields\n      setValue(`medications.${selectedMedicationIndex}.medicationName`, medication.name, {\n        shouldValidate: true,\n        shouldDirty: true\n      });\n      setValue(`medications.${selectedMedicationIndex}.dosage`, medication.dosage || '', {\n        shouldValidate: true\n      });\n      setValue(`medications.${selectedMedicationIndex}.frequency`, medication.frequency || '', {\n        shouldValidate: true\n      });\n      setValue(`medications.${selectedMedicationIndex}.duration`, medication.duration || '', {\n        shouldValidate: true\n      });\n      setValue(`medications.${selectedMedicationIndex}.instructions`, medication.instructions || '', {\n        shouldValidate: true\n      });\n      \n      // Clear validation errors for this medication\n      clearErrors(`medications.${selectedMedicationIndex}.medication`);\n      clearErrors(`medications.${selectedMedicationIndex}.dosage`);\n      clearErrors(`medications.${selectedMedicationIndex}.frequency`);\n      clearErrors(`medications.${selectedMedicationIndex}.duration`);\n      \n      // Force validation trigger with multiple attempts\n      setTimeout(() => {\n        console.log('Triggering validation for medication ID:', medicationId);\n        setValue(`medications.${selectedMedicationIndex}.medication`, medicationId, {\n          shouldValidate: true,\n          shouldDirty: true,\n          shouldTouch: true\n        });\n        trigger(`medications.${selectedMedicationIndex}.medication`);\n      }, 100);\n      \n      setTimeout(() => {\n        console.log('Second validation trigger');\n        setValue(`medications.${selectedMedicationIndex}.medication`, medicationId, {\n          shouldValidate: true,\n          shouldDirty: true,\n          shouldTouch: true\n        });\n        trigger(`medications.${selectedMedicationIndex}.medication`);\n      }, 200);\n      \n      console.log('Medication field updated with ID:', medicationId);\n    }\n    setIsMedicationModalOpen(false);\n    setSelectedMedicationIndex(null);\n  };\n\n  const handleAddMedication = () => {\n    appendMedication({\n      medication: '',\n      medicationName: '',\n      dosage: '',\n      frequency: '',\n      duration: '',\n      instructions: ''\n    });\n  };\n\n  const handleSelectMedicationFromList = (index: number) => {\n    setSelectedMedicationIndex(index);\n    setIsMedicationModalOpen(true);\n  };\n\n  const onSubmit = async (data: PrescriptionFormData) => {\n    try {\n      setLoading(true);\n      \n      // Get the clinic ID from the clinic context\n      const clinicId = selectedClinic?.id;\n      console.log('Clinic from context:', selectedClinic);\n      console.log('Clinic ID found:', clinicId);\n\n      if (!clinicId) {\n        console.log('Clinic not available in context');\n        toast.error('Clinic information is missing. Please contact support.');\n        setLoading(false);\n        return;\n      }\n      \n      // Log form data for debugging\n      console.log('Form data before processing:', data);\n      \n      // Convert patient name to patient ID if needed\n      let patientId = data.patient;\n      if (typeof data.patient === 'string' && data.patient.includes('@')) {\n        const patient = patients.find(p => \n          `${p.firstName} ${p.lastName} (${p.email})` === data.patient\n        );\n        if (patient) {\n          patientId = (patient as any).id || (patient as any)._id;\n          console.log('Converted patient name to ID:', patientId);\n        } else {\n          console.error('Patient not found for prescription creation');\n          toast.error('Patient not found. Please try again.');\n          setLoading(false);\n          return;\n        }\n      }\n      \n      const prescriptionData = {\n        patientId: patientId,\n        clinicId: clinicId,\n        appointmentId: data.appointment || undefined,\n        medications: data.medications.map(med => ({\n          medicationId: med.medication,\n          dosage: med.dosage,\n          frequency: med.frequency,\n          duration: med.duration,\n          instructions: med.instructions || undefined,\n          startDate: new Date().toISOString(),\n          endDate: undefined\n        })),\n        diagnosis: data.diagnosis,\n        notes: data.notes || undefined,\n        expiryDate: data.expiryDate,\n        refillsAllowed: data.maxRefills\n      };\n\n      console.log('Prescription data to send:', prescriptionData);\n\n      if (prescription) {\n        console.log('Updating prescription:', prescription._id);\n        await prescriptionService.updatePrescription(prescription._id, prescriptionData);\n        toast.success(t('prescriptionForm.messages.successUpdate'));\n      } else {\n        console.log('Creating new prescription');\n        await prescriptionService.createPrescription(prescriptionData);\n        toast.success(t('prescriptionForm.messages.successCreate'));\n      }\n      \n      onSave();\n    } catch (_error: any) {\n      const errorMessage = _error.response?.data?.message || _error.response?.data?.error || t('prescriptionForm.messages.errorSave');\n      toast.error(errorMessage);\n      console.error('Error saving prescription:', _error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const patientOptions = (Array.isArray(patients) ? patients : []).map(patient => ({\n    value: (patient as any).id || (patient as any)._id,\n    label: `${patient.firstName} ${patient.lastName} (${patient.email})`\n  }));\n\n  const appointmentOptions = [\n    { value: '', label: t('prescriptionForm.appointment.noSpecificAppointment') },\n    ...(Array.isArray(appointments) ? appointments.map(appointment => ({\n      value: appointment._id,\n      label: `${format(new Date(appointment.date), 'MMM dd, yyyy')} - ${appointment.type}`\n    })) : [])\n  ];\n\n  return (\n    <>\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n        {/* Patient Selection */}\n        {!patientId && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('prescriptionForm.fields.patient')}\n            </label>\n            <Select\n              {...register('patient', {\n                onChange: () => {\n                  // Clear patient error when a selection is made\n                  if (isSubmitted) {\n                    clearErrors('patient');\n                  }\n                }\n              })}\n              options={patientOptions}\n              error={errors.patient?.message}\n            />\n          </div>\n        )}\n\n        {/* Appointment Selection */}\n        {selectedPatient && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('prescriptionForm.fields.relatedAppointment')}\n            </label>\n            <Select\n              {...register('appointment')}\n              options={appointmentOptions}\n              error={errors.appointment?.message}\n            />\n          </div>\n        )}\n\n        {/* Diagnosis */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('prescriptionForm.fields.diagnosis')}\n          </label>\n          <Textarea\n            {...register('diagnosis')}\n            placeholder={t('prescriptionForm.placeholders.diagnosis')}\n            rows={3}\n            error={errors.diagnosis?.message}\n          />\n        </div>\n\n        {/* Medications */}\n        <div>\n          <div className=\"flex justify-between items-center mb-3\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              {t('prescriptionForm.fields.medications')}\n            </label>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleAddMedication}\n              className=\"flex items-center gap-1\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              {t('prescriptionForm.actions.addMedication')}\n            </Button>\n          </div>\n          \n          <div className=\"space-y-4\">\n            {medicationFields.map((field, index) => (\n              <div key={field.id} className=\"border border-gray-200 rounded-lg p-4\">\n                <div className=\"flex justify-between items-center mb-3\">\n                  <h4 className=\"text-sm font-medium text-gray-700\">\n                    {t('prescriptionForm.medicationItem', { index: index + 1 })}\n                  </h4>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleSelectMedicationFromList(index)}\n                      className=\"flex items-center gap-1\"\n                    >\n                      <Search className=\"h-4 w-4\" />\n                      {t('prescriptionForm.actions.selectMedication')}\n                    </Button>\n                    {medicationFields.length > 1 && (\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => removeMedication(index)}\n                        className=\"text-red-600 hover:text-red-700\"\n                      >\n                        <X className=\"h-4 w-4\" />\n                      </Button>\n                    )}\n                  </div>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"md:col-span-2\">\n                    <label className=\"block text-xs text-gray-600 mb-1\">{t('prescriptionForm.fields.medication')}</label>\n                    <div className=\"relative\">\n                      <Input\n                        {...register(`medications.${index}.medicationName`)}\n                        placeholder={t('prescriptionForm.placeholders.medicationName')}\n                        \n                        className={`bg-gray-50 cursor-pointer ${\n                          errors.medications?.[index]?.medication ? 'border-red-300' : ''\n                        }`}\n                        error={errors.medications?.[index]?.medication?.message}\n                        onClick={() => handleSelectMedicationFromList(index)}\n                      />\n                      {!watch(`medications.${index}.medicationName`) ? (\n                        <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                          <Search className=\"h-4 w-4 text-gray-400\" />\n                        </div>\n                      ) : (\n                        <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                          <div className=\"h-4 w-4 bg-green-500 rounded-full flex items-center justify-center\">\n                            <svg className=\"h-2 w-2 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                            </svg>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                    {/* Hidden field for medication ID */}\n                    <input\n                      type=\"hidden\"\n                      {...register(`medications.${index}.medication`)}\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs text-gray-600 mb-1\">{t('prescriptionForm.fields.dosage')}</label>\n                    <Input\n                      {...register(`medications.${index}.dosage`)}\n                      placeholder={t('prescriptionForm.placeholders.dosage')}\n                      error={errors.medications?.[index]?.dosage?.message}\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs text-gray-600 mb-1\">{t('prescriptionForm.fields.frequency')}</label>\n                    <Input\n                      {...register(`medications.${index}.frequency`)}\n                      placeholder={t('prescriptionForm.placeholders.frequency')}\n                      error={errors.medications?.[index]?.frequency?.message}\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs text-gray-600 mb-1\">{t('prescriptionForm.fields.duration')}</label>\n                    <Input\n                      {...register(`medications.${index}.duration`)}\n                      placeholder={t('prescriptionForm.placeholders.duration')}\n                      error={errors.medications?.[index]?.duration?.message}\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs text-gray-600 mb-1\">{t('prescriptionForm.fields.instructions')}</label>\n                    <Input\n                      {...register(`medications.${index}.instructions`)}\n                      placeholder={t('prescriptionForm.placeholders.instructions')}\n                      error={errors.medications?.[index]?.instructions?.message}\n                    />\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n          \n          {errors.medications && (\n            <p className=\"text-sm text-red-600 mt-1\">{errors.medications.message}</p>\n          )}\n        </div>\n\n        {/* Prescription Details */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('prescriptionForm.fields.expiryDate')}\n            </label>\n            <Input\n              type=\"date\"\n              {...register('expiryDate')}\n              error={errors.expiryDate?.message}\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {t('prescriptionForm.fields.maxRefills')}\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              max=\"10\"\n              {...register('maxRefills', { valueAsNumber: true })}\n              error={errors.maxRefills?.message}\n            />\n          </div>\n        </div>\n\n        {/* Notes */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {t('prescriptionForm.fields.additionalNotes')}\n          </label>\n          <Textarea\n            {...register('notes')}\n            placeholder={t('prescriptionForm.placeholders.notes')}\n            rows={3}\n            error={errors.notes?.message}\n          />\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end gap-3 pt-6 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onCancel}\n            disabled={loading}\n          >\n            {t('prescriptionForm.actions.cancel')}\n          </Button>\n          <Button\n            type=\"submit\"\n            isLoading={loading}\n            disabled={loading}\n          >\n            {prescription ? t('prescriptionForm.actions.update') : t('prescriptionForm.actions.create')}\n          </Button>\n        </div>\n      </form>\n\n      {/* Medication Selection Modal */}\n      <Modal\n        isOpen={isMedicationModalOpen}\n        onClose={() => {\n          setIsMedicationModalOpen(false);\n          setSelectedMedicationIndex(null);\n        }}\n        title={t('prescriptionForm.selectMedicationTitle')}\n        size=\"lg\"\n      >\n        <MedicationList\n          onSelectMedication={handleSelectMedication}\n          selectionMode={true}\n        />\n      </Modal>\n    </>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\prescriptions\\PrescriptionList.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPrescriptions'. Either include it or remove the dependency array.","line":133,"column":6,"nodeType":"ArrayExpression","endLine":133,"endColumn":56,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, searchTerm, statusFilter, patientId, fetchPrescriptions]","fix":{"range":[4390,4440],"text":"[currentPage, searchTerm, statusFilter, patientId, fetchPrescriptions]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Search, Plus, Eye, Edit, Trash2, Calendar, User, Pill } from 'lucide-react';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport Card from '../ui/Card';\nimport Badge from '../ui/Badge';\nimport Modal from '../ui/Modal';\nimport { PrescriptionForm } from './PrescriptionForm';\nimport { PrescriptionDetails } from './PrescriptionDetails';\nimport { useAuth } from '../../hooks/useAuth';\nimport { prescriptionService } from '../../services/prescriptionService';\nimport { toast } from 'react-hot-toast';\nimport { format } from 'date-fns';\nimport { useTranslation } from 'react-i18next';\n\ninterface Prescription {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n  };\n  dentist: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  clinic: {\n    _id: string;\n    name: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n  };\n  medications: Array<{\n    medication: {\n      _id: string;\n      name: string;\n      genericName?: string;\n    };\n    dosage: string;\n    frequency: string;\n    duration: string;\n    instructions?: string;\n  }>;\n  diagnosis: string;\n  notes?: string;\n  status: 'active' | 'completed' | 'cancelled';\n  issuedDate: string;\n  expiryDate: string;\n  refills: Array<{\n    date: string;\n    refillNumber: number;\n    notes?: string;\n  }>;\n  maxRefills: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface PrescriptionListProps {\n  patientId?: string;\n}\n\nexport const PrescriptionList: React.FC<PrescriptionListProps> = ({ patientId }) => {\n  const { t, i18n } = useTranslation();\n  const { user } = useAuth();\n  const [prescriptions, setPrescriptions] = useState<Prescription[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [isFormModalOpen, setIsFormModalOpen] = useState(false);\n  const [isDetailsModalOpen, setIsDetailsModalOpen] = useState(false);\n  const [editingPrescription, setEditingPrescription] = useState<Prescription | null>(null);\n  const [viewingPrescription, setViewingPrescription] = useState<Prescription | null>(null);\n\n  const statusOptions = [\n    { value: 'all', label: t('prescriptionList.filters.allStatus') },\n    { value: 'active', label: t('prescriptionList.filters.active') },\n    { value: 'completed', label: t('prescriptionList.filters.completed') },\n    { value: 'cancelled', label: t('prescriptionList.filters.cancelled') }\n  ];\n\n  const fetchPrescriptions = async () => {\n    try {\n      setLoading(true);\n      const params = {\n        page: currentPage,\n        limit: 10,\n        search: searchTerm,\n        status: statusFilter !== 'all' ? statusFilter : undefined,\n        patient: patientId\n      };\n      \n      let response;\n      \n      // Use role-based endpoint selection\n      if (user?.role === 'patient') {\n        // Patients use the my-prescriptions endpoint\n        response = await prescriptionService.getMyPrescriptions(params);\n      } else if (patientId) {\n        // Staff/dentists can view specific patient prescriptions\n        response = await prescriptionService.getPrescriptionsByPatient(patientId, params);\n      } else {\n        // Staff/dentists view all prescriptions (filtered by their role)\n        response = await prescriptionService.getPrescriptions(params);\n      }\n      \n      // Ensure prescriptions is always an array\n      const prescriptionsData = response?.data?.prescriptions || response?.data?.data || [];\n      const totalPagesData = response?.data?.totalPages || response?.data?.pagination?.pages || 1;\n      \n      setPrescriptions(Array.isArray(prescriptionsData) ? prescriptionsData : []);\n      setTotalPages(typeof totalPagesData === 'number' ? totalPagesData : 1);\n    } catch (_error) {\n      toast.error(t('prescriptionList.messages.fetchError'));\n      console.error('Error fetching prescriptions:', _error);\n      // Set empty array on error to prevent undefined access\n      setPrescriptions([]);\n      setTotalPages(1);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchPrescriptions();\n  }, [currentPage, searchTerm, statusFilter, patientId]);\n\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchTerm(e.target.value);\n    setCurrentPage(1);\n  };\n\n  const handleStatusFilter = (status: string) => {\n    setStatusFilter(status);\n    setCurrentPage(1);\n  };\n\n  const handleAddPrescription = () => {\n    setEditingPrescription(null);\n    setIsFormModalOpen(true);\n  };\n\n  const handleEditPrescription = (prescription: Prescription) => {\n    setEditingPrescription(prescription);\n    setIsFormModalOpen(true);\n  };\n\n  const handleViewPrescription = (prescription: Prescription) => {\n    setViewingPrescription(prescription);\n    setIsDetailsModalOpen(true);\n  };\n\n  const handleDeletePrescription = async (prescriptionId: string) => {\n    if (!window.confirm(t('prescriptionList.messages.deleteConfirmation'))) {\n      return;\n    }\n\n    try {\n      await prescriptionService.deletePrescription(prescriptionId);\n      toast.success(t('prescriptionList.messages.deleteSuccess'));\n      fetchPrescriptions();\n    } catch (_error) {\n      toast.error(t('prescriptionList.messages.deleteError'));\n      console.error('Error deleting prescription:', _error);\n    }\n  };\n\n  const handlePrescriptionSaved = () => {\n    setIsFormModalOpen(false);\n    setEditingPrescription(null);\n    fetchPrescriptions();\n  };\n\n  const getStatusColor = (status: string) => {\n    const colors = {\n      active: 'bg-green-100 text-green-800',\n      completed: 'bg-blue-100 text-blue-800',\n      cancelled: 'bg-red-100 text-red-800'\n    };\n    return colors[status as keyof typeof colors] || colors.active;\n  };\n\n  const isExpired = (expiryDate: string) => {\n    return new Date(expiryDate) < new Date();\n  };\n\n  const canManagePrescriptions = user?.role === 'dentist' || user?.role === 'admin';\n  // const canViewAll = user?.role === 'dentist' || user?.role === 'admin' || user?.role === 'staff'; // Commented out as not currently used\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold text-gray-900\">\n          {patientId ? t('prescriptionList.header.patientPrescriptions') : t('prescriptionList.header.title')}\n        </h2>\n        {canManagePrescriptions && (\n          <Button onClick={handleAddPrescription} className=\"flex items-center gap-2\">\n            <Plus className=\"h-4 w-4\" />\n            {t('prescriptionList.actions.newPrescription')}\n          </Button>\n        )}\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"flex-1\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n            <Input\n              type=\"text\"\n              placeholder={t('prescriptionList.search.placeholder')}\n              value={searchTerm}\n              onChange={handleSearch}\n              className=\"pl-10\"\n            />\n          </div>\n        </div>\n        <div className=\"sm:w-48\">\n          <Select\n            value={statusFilter}\n            onChange={(e) => handleStatusFilter(e.target.value)}\n            options={statusOptions}\n          />\n        </div>\n      </div>\n\n      {/* Prescriptions List */}\n      <div className=\"space-y-4\">\n        {prescriptions.map((prescription) => (\n          <Card key={prescription._id} className=\"p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"space-y-4\">\n              {/* Header */}\n              <div className=\"flex justify-between items-start\">\n                <div className=\"space-y-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">\n                      {t('prescriptionList.card.prescriptionNumber', { id: prescription._id.slice(-8) })}\n                    </h3>\n                    <Badge className={getStatusColor(prescription.status)}>\n                      {t(`prescriptionList.status.${prescription.status}`)}\n                    </Badge>\n                    {isExpired(prescription.expiryDate) && (\n                      <Badge className=\"bg-red-100 text-red-800\">\n                        {t('prescriptionList.status.expired')}\n                      </Badge>\n                    )}\n                  </div>\n                  {!patientId && (\n                    <div className=\"flex items-center gap-1 text-sm text-gray-600\">\n                      <User className=\"h-4 w-4\" />\n                      {prescription.patient.firstName} {prescription.patient.lastName}\n                    </div>\n                  )}\n                  <div className=\"flex items-center gap-1 text-sm text-gray-600\">\n                    <Calendar className=\"h-4 w-4\" />\n                    {t('prescriptions.issued', { date: format(new Date(prescription.issuedDate), 'MMM dd, yyyy', { locale: i18n.language === 'ar' ? require('date-fns/locale/ar') : undefined }) })}\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => handleViewPrescription(prescription)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  {canManagePrescriptions && (\n                    <>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleEditPrescription(prescription)}\n                      >\n                        <Edit className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleDeletePrescription(prescription._id)}\n                        className=\"text-red-600 hover:text-red-700\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </>\n                  )}\n                </div>\n              </div>\n\n              {/* Diagnosis */}\n              <div>\n                <p className=\"text-sm text-gray-600 mb-1\">{t('prescriptionList.card.diagnosis')}</p>\n                <p className=\"text-sm text-gray-800\">{prescription.diagnosis}</p>\n              </div>\n\n              {/* Medications */}\n              <div>\n                <p className=\"text-sm text-gray-600 mb-2\">{t('prescriptionList.card.medications')}</p>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\n                  {prescription.medications.map((med, index) => (\n                    <div key={med.medication._id || `med-${index}`} className=\"bg-gray-50 p-3 rounded-lg\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Pill className=\"h-4 w-4 text-blue-600\" />\n                        <span className=\"font-medium text-sm\">{med.medication.name}</span>\n                      </div>\n                      <div className=\"space-y-1 text-xs text-gray-600\">\n                        <div>{t('prescriptions.dosage', { dosage: med.dosage })}</div>\n                        <div>{t('prescriptions.frequency', { frequency: med.frequency })}</div>\n                        <div>{t('prescriptions.duration', { duration: med.duration })}</div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Additional Info */}\n              <div className=\"flex justify-between items-center text-sm text-gray-600\">\n                <div className=\"flex items-center gap-4\">\n                  <span>{t('prescriptionList.card.doctor', { firstName: prescription.dentist.firstName, lastName: prescription.dentist.lastName })}</span>\n                  <span>{t('common.separator')}</span>\n                  <span>{prescription.clinic.name}</span>\n                </div>\n                <div className=\"flex items-center gap-4\">\n                  <span>{t('prescriptionList.card.refills', { current: prescription.refills.length, max: prescription.maxRefills })}</span>\n                  <span>{t('common.separator')}</span>\n                  <span>{t('prescriptionList.card.expires', { date: format(new Date(prescription.expiryDate), 'MMM dd, yyyy', { locale: i18n.language === 'ar' ? require('date-fns/locale/ar') : undefined }) })}</span>\n                </div>\n              </div>\n            </div>\n          </Card>\n        ))}\n      </div>\n\n      {/* Empty State */}\n      {prescriptions.length === 0 && (\n        <div className=\"text-center py-12\">\n          <Pill className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{t('prescriptionList.emptyState.noPrescriptionsFound')}</h3>\n          <p className=\"text-gray-600 mb-4\">\n            {patientId \n              ? t('prescriptionList.emptyState.noPatientPrescriptions')\n              : t('prescriptionList.emptyState.noFilteredPrescriptions')}\n          </p>\n          {canManagePrescriptions && (\n            <Button onClick={handleAddPrescription}>\n              {t('prescriptionList.emptyState.createFirstPrescription')}\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex justify-center items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}\n            disabled={currentPage === 1}\n          >\n            {t('prescriptionList.pagination.previous')}\n          </Button>\n          <span className=\"text-sm text-gray-600\">\n            {t('prescriptionList.pagination.pageOf', { currentPage, totalPages })}\n          </span>\n          <Button\n            variant=\"outline\"\n            onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}\n            disabled={currentPage === totalPages}\n          >\n            {t('prescriptionList.pagination.next')}\n          </Button>\n        </div>\n      )}\n\n      {/* Form Modal */}\n      <Modal\n        isOpen={isFormModalOpen}\n        onClose={() => {\n          setIsFormModalOpen(false);\n          setEditingPrescription(null);\n        }}\n        title={editingPrescription ? t('prescriptionList.modal.editPrescription') : t('prescriptionList.modal.newPrescription')}\n        size=\"lg\"\n      >\n        <PrescriptionForm\n          prescription={editingPrescription}\n          patientId={patientId || ''}\n          onSave={handlePrescriptionSaved}\n          onCancel={() => {\n            setIsFormModalOpen(false);\n            setEditingPrescription(null);\n          }}\n        />\n      </Modal>\n\n      {/* Details Modal */}\n      <Modal\n        isOpen={isDetailsModalOpen}\n        onClose={() => {\n          setIsDetailsModalOpen(false);\n          setViewingPrescription(null);\n        }}\n        title={t('prescriptionList.modal.prescriptionDetails')}\n        size=\"lg\"\n      >\n        {viewingPrescription && (\n          <PrescriptionDetails\n            prescription={viewingPrescription}\n            onClose={() => {\n              setIsDetailsModalOpen(false);\n              setViewingPrescription(null);\n            }}\n            onRefresh={fetchPrescriptions}\n          />\n        )}\n      </Modal>\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\reminders\\ReminderManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\reports\\ReportsDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1043,1046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1043,1046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDashboardData'. Either include it or remove the dependency array.","line":69,"column":6,"nodeType":"ArrayExpression","endLine":69,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [selectedPeriod, dateRange, fetchDashboardData]","fix":{"range":[2634,2661],"text":"[selectedPeriod, dateRange, fetchDashboardData]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4400,4403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4400,4403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5274,5277],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5274,5277],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":214,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7832,7835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7832,7835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n  BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, \n  Tooltip, Legend, ResponsiveContainer, AreaChart, Area \n} from 'recharts';\nimport { \n  Calendar, TrendingUp, Users, DollarSign, Activity, Download, \n  Filter, RefreshCw, ChevronDown, ChevronUp \n} from 'lucide-react';\nimport { Card, Button, Select, Input } from '../ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { reportsService, type ReportFilters } from '../../services/reportsService';\nimport toast from 'react-hot-toast';\nimport { format, startOfMonth, endOfMonth, subMonths } from 'date-fns';\n\ninterface DashboardSummary {\n  totalRevenue: number;\n  totalAppointments: number;\n  totalPatients: number;\n  activeDentists: number;\n  revenueGrowth: number;\n  appointmentGrowth: number;\n  patientGrowth: number;\n}\n\ninterface ChartData {\n  name: string;\n  value: number;\n  revenue?: number;\n  appointments?: number;\n  patients?: number;\n  [key: string]: any;\n}\n\nconst COLORS = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899', '#6B7280'];\n\nexport const ReportsDashboard: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedPeriod, setSelectedPeriod] = useState<'daily' | 'weekly' | 'monthly' | 'yearly'>('monthly');\n  const [dateRange, setDateRange] = useState<{ start: string; end: string }>({\n    start: format(startOfMonth(subMonths(new Date(), 11)), 'yyyy-MM-dd'),\n    end: format(endOfMonth(new Date()), 'yyyy-MM-dd')\n  });\n\n  // Data states\n  const [dashboardSummary, setDashboardSummary] = useState<DashboardSummary | null>(null);\n  const [revenueData, setRevenueData] = useState<ChartData[]>([]);\n  const [appointmentData, setAppointmentData] = useState<ChartData[]>([]);\n  const [treatmentData, setTreatmentData] = useState<ChartData[]>([]);\n  const [dentistPerformanceData, setDentistPerformanceData] = useState<ChartData[]>([]);\n  const [paymentMethodData, setPaymentMethodData] = useState<ChartData[]>([]);\n\n  // UI states\n  const [expandedSections, setExpandedSections] = useState<Set<string>>(new Set(['summary', 'revenue']));\n\n  const periodOptions = [\n    { value: 'daily', label: t('reports.periods.daily') },\n    { value: 'weekly', label: t('reports.periods.weekly') },\n    { value: 'monthly', label: t('reports.periods.monthly') },\n    { value: 'yearly', label: t('reports.periods.yearly') }\n  ];\n\n  useEffect(() => {\n    fetchDashboardData();\n  }, [selectedPeriod, dateRange]);\n\n  const buildFilters = (): ReportFilters => ({\n    startDate: dateRange.start,\n    endDate: dateRange.end,\n    period: selectedPeriod,\n    ...(user?.assignedClinics?.length === 1 ? { clinicId: user.assignedClinics[0] } : {})\n  });\n\n  const fetchDashboardData = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const filters = buildFilters();\n\n      // Fetch all data in parallel\n        const [\n          summaryResponse,\n          revenueResponse,\n          appointmentResponse,\n          treatmentResponse,\n          dentistResponse\n        ] = await Promise.all([\n        reportsService.getDashboardSummary(filters),\n        reportsService.getRevenueAnalytics(filters),\n        reportsService.getAppointmentAnalytics(filters),\n        reportsService.getTreatmentAnalytics(filters),\n        reportsService.getAllDentistPerformance(filters)\n      ]);\n\n      // Process summary data\n      setDashboardSummary({\n        totalRevenue: summaryResponse.totalRevenue || 0,\n        totalAppointments: summaryResponse.totalAppointments || 0,\n        totalPatients: summaryResponse.totalPatients || 0,\n        activeDentists: summaryResponse.activeDentists || 0,\n        revenueGrowth: summaryResponse.revenueGrowth || 0,\n        appointmentGrowth: summaryResponse.appointmentGrowth || 0,\n        patientGrowth: summaryResponse.patientGrowth || 0\n      });\n\n      // Process chart data\n      setRevenueData(revenueResponse.chartData || []);\n      setAppointmentData(appointmentResponse.chartData || []);\n      setTreatmentData(treatmentResponse.chartData || []);\n      setDentistPerformanceData(dentistResponse.chartData || []);\n      setPaymentMethodData(revenueResponse.paymentMethods || []);\n\n    } catch (err: any) {\n      setError(err.message || t('reports.errors.fetchFailed'));\n      toast.error(t('reports.errors.fetchFailed'));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleExportReport = async (exportFormat: 'pdf' | 'csv' | 'xlsx') => {\n    try {\n      const filters = buildFilters();\n      const blob = await reportsService.exportReport('dashboard', filters, exportFormat);\n      \n      // Create download link\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `clinic-report-${exportFormat}-${format(new Date(), 'yyyy-MM-dd')}.${exportFormat}`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success(t('reports.exportSuccess'));\n    } catch (_err: any) {\n      toast.error(t('reports.errors.exportFailed'));\n    }\n  };\n\n  const toggleSection = (section: string) => {\n    const newExpanded = new Set(expandedSections);\n    if (newExpanded.has(section)) {\n      newExpanded.delete(section);\n    } else {\n      newExpanded.add(section);\n    }\n    setExpandedSections(newExpanded);\n  };\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0\n    }).format(value);\n  };\n\n  const formatPercentage = (value: number) => {\n    return `${value > 0 ? '+' : ''}${value.toFixed(1)}%`;\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-3 text-gray-600\">{t('reports.loading')}</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">{t('reports.dashboard.title')}</h1>\n          <p className=\"text-gray-600\">{t('reports.dashboard.subtitle')}</p>\n        </div>\n        <div className=\"mt-4 sm:mt-0 flex flex-wrap gap-3\">\n          <Button variant=\"outline\" onClick={() => fetchDashboardData()}>\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            {t('common.refresh')}\n          </Button>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={() => handleExportReport('csv')}>\n              {t('reports.export.csv')}\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={() => handleExportReport('xlsx')}>\n              {t('reports.export.xlsx')}\n            </Button>\n            <Button size=\"sm\" onClick={() => handleExportReport('pdf')}>\n              <Download className=\"h-4 w-4 mr-2\" />\n              {t('reports.export.pdf')}\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <Card className=\"p-6\">\n        <div className=\"flex flex-wrap items-center gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <Filter className=\"h-4 w-4 text-gray-600\" />\n            <span className=\"text-sm font-medium text-gray-700\">{t('reports.filters.title')}</span>\n          </div>\n          <Select\n            value={selectedPeriod}\n            onChange={(e) => setSelectedPeriod(e.target.value as any)}\n            options={periodOptions}\n          />\n          <div className=\"flex items-center gap-2\">\n            <Input\n              type=\"date\"\n              value={dateRange.start}\n              onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n              className=\"w-40\"\n            />\n            <span className=\"text-gray-500\">-</span>\n            <Input\n              type=\"date\"\n              value={dateRange.end}\n              onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n              className=\"w-40\"\n            />\n          </div>\n        </div>\n      </Card>\n\n      {error && (\n        <Card className=\"p-4 bg-red-50 border-red-200\">\n          <p className=\"text-red-600\">{error}</p>\n        </Card>\n      )}\n\n      {/* Summary Cards */}\n      {dashboardSummary && (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <Card className=\"p-6 bg-gradient-to-br from-blue-500 to-blue-600 text-white\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-blue-100\">{t('reports.dashboard.metrics.totalRevenue')}</p>\n                <p className=\"text-2xl font-bold\">{formatCurrency(dashboardSummary.totalRevenue)}</p>\n                <p className=\"text-sm text-blue-100\">\n                  {formatPercentage(dashboardSummary.revenueGrowth)} {t('reports.dashboard.fromLastPeriod')}\n                </p>\n              </div>\n              <DollarSign className=\"h-8 w-8 text-blue-200\" />\n            </div>\n          </Card>\n\n          <Card className=\"p-6 bg-gradient-to-br from-green-500 to-green-600 text-white\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-green-100\">{t('reports.dashboard.metrics.totalAppointments')}</p>\n                <p className=\"text-2xl font-bold\">{dashboardSummary.totalAppointments.toLocaleString()}</p>\n                <p className=\"text-sm text-green-100\">\n                  {formatPercentage(dashboardSummary.appointmentGrowth)} {t('reports.dashboard.fromLastPeriod')}\n                </p>\n              </div>\n              <Calendar className=\"h-8 w-8 text-green-200\" />\n            </div>\n          </Card>\n\n          <Card className=\"p-6 bg-gradient-to-br from-purple-500 to-purple-600 text-white\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-purple-100\">{t('reports.dashboard.metrics.totalPatients')}</p>\n                <p className=\"text-2xl font-bold\">{dashboardSummary.totalPatients.toLocaleString()}</p>\n                <p className=\"text-sm text-purple-100\">\n                  {formatPercentage(dashboardSummary.patientGrowth)} {t('reports.dashboard.fromLastPeriod')}\n                </p>\n              </div>\n              <Users className=\"h-8 w-8 text-purple-200\" />\n            </div>\n          </Card>\n\n          <Card className=\"p-6 bg-gradient-to-br from-orange-500 to-orange-600 text-white\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-orange-100\">{t('reports.dashboard.metrics.activeDentists')}</p>\n                <p className=\"text-2xl font-bold\">{dashboardSummary.activeDentists}</p>\n                <p className=\"text-sm text-orange-100\">{t('reports.dashboard.currentlyActive')}</p>\n              </div>\n              <Activity className=\"h-8 w-8 text-orange-200\" />\n            </div>\n          </Card>\n        </div>\n      )}\n\n      {/* Revenue Analytics */}\n      <Card>\n        <div \n          className=\"flex items-center justify-between p-6 border-b cursor-pointer\"\n          onClick={() => toggleSection('revenue')}\n        >\n          <h2 className=\"text-lg font-semibold flex items-center\">\n            <TrendingUp className=\"h-5 w-5 mr-2\" />\n            {t('reports.dashboard.sections.revenueAnalytics')}\n          </h2>\n          {expandedSections.has('revenue') ? \n            <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />\n          }\n        </div>\n        {expandedSections.has('revenue') && (\n          <div className=\"p-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-2\">\n                <h3 className=\"text-sm font-medium text-gray-700 mb-4\">\n                  {t('reports.dashboard.charts.revenueOverTime')}\n                </h3>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <AreaChart data={revenueData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"name\" />\n                    <YAxis tickFormatter={formatCurrency} />\n                    <Tooltip formatter={(value: number) => [formatCurrency(value), t('reports.dashboard.revenue')]} />\n                    <Area \n                      type=\"monotone\" \n                      dataKey=\"value\" \n                      stroke=\"#3B82F6\" \n                      fill=\"#3B82F6\"\n                      fillOpacity={0.3}\n                    />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </div>\n              <div>\n                <h3 className=\"text-sm font-medium text-gray-700 mb-4\">\n                  {t('reports.dashboard.charts.paymentMethods')}\n                </h3>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <PieChart>\n                    <Pie\n                      data={paymentMethodData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      innerRadius={60}\n                      outerRadius={100}\n                      paddingAngle={5}\n                      dataKey=\"value\"\n                    >\n                      {paymentMethodData.map((_, index) => (\n                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                      ))}\n                    </Pie>\n                    <Tooltip formatter={(value: number) => [formatCurrency(value), '']} />\n                    <Legend />\n                  </PieChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          </div>\n        )}\n      </Card>\n\n      {/* Appointment Analytics */}\n      <Card>\n        <div \n          className=\"flex items-center justify-between p-6 border-b cursor-pointer\"\n          onClick={() => toggleSection('appointments')}\n        >\n          <h2 className=\"text-lg font-semibold flex items-center\">\n            <Calendar className=\"h-5 w-5 mr-2\" />\n            {t('reports.dashboard.sections.appointmentAnalytics')}\n          </h2>\n          {expandedSections.has('appointments') ? \n            <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />\n          }\n        </div>\n        {expandedSections.has('appointments') && (\n          <div className=\"p-6\">\n            <ResponsiveContainer width=\"100%\" height={400}>\n              <BarChart data={appointmentData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"name\" />\n                <YAxis />\n                <Tooltip />\n                <Legend />\n                <Bar dataKey=\"completed\" fill=\"#10B981\" name={t('appointments.status.completed')} />\n                <Bar dataKey=\"cancelled\" fill=\"#EF4444\" name={t('appointments.status.cancelled')} />\n                <Bar dataKey=\"scheduled\" fill=\"#3B82F6\" name={t('appointments.status.scheduled')} />\n              </BarChart>\n            </ResponsiveContainer>\n          </div>\n        )}\n      </Card>\n\n      {/* Treatment Analytics */}\n      <Card>\n        <div \n          className=\"flex items-center justify-between p-6 border-b cursor-pointer\"\n          onClick={() => toggleSection('treatments')}\n        >\n          <h2 className=\"text-lg font-semibold flex items-center\">\n            <Activity className=\"h-5 w-5 mr-2\" />\n            {t('reports.dashboard.sections.treatmentAnalytics')}\n          </h2>\n          {expandedSections.has('treatments') ? \n            <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />\n          }\n        </div>\n        {expandedSections.has('treatments') && (\n          <div className=\"p-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <div>\n                <h3 className=\"text-sm font-medium text-gray-700 mb-4\">\n                  {t('reports.dashboard.charts.treatmentsByType')}\n                </h3>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <PieChart>\n                    <Pie\n                      data={treatmentData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      outerRadius={100}\n                      dataKey=\"value\"\n                      label={(entry) => entry.name}\n                    >\n                      {treatmentData.map((_, index) => (\n                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                      ))}\n                    </Pie>\n                    <Tooltip />\n                  </PieChart>\n                </ResponsiveContainer>\n              </div>\n              <div>\n                <h3 className=\"text-sm font-medium text-gray-700 mb-4\">\n                  {t('reports.dashboard.charts.treatmentRevenue')}\n                </h3>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <BarChart data={treatmentData} layout=\"horizontal\">\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis type=\"number\" tickFormatter={formatCurrency} />\n                    <YAxis dataKey=\"name\" type=\"category\" width={100} />\n                    <Tooltip formatter={(value: number) => [formatCurrency(value), t('reports.dashboard.revenue')]} />\n                    <Bar dataKey=\"revenue\" fill=\"#8B5CF6\" />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n            </div>\n          </div>\n        )}\n      </Card>\n\n      {/* Dentist Performance */}\n      {user?.role !== 'patient' && (\n        <Card>\n          <div \n            className=\"flex items-center justify-between p-6 border-b cursor-pointer\"\n            onClick={() => toggleSection('performance')}\n          >\n            <h2 className=\"text-lg font-semibold flex items-center\">\n              <Users className=\"h-5 w-5 mr-2\" />\n              {t('reports.dashboard.sections.dentistPerformance')}\n            </h2>\n            {expandedSections.has('performance') ? \n              <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />\n            }\n          </div>\n          {expandedSections.has('performance') && (\n            <div className=\"p-6\">\n              <ResponsiveContainer width=\"100%\" height={400}>\n                <BarChart data={dentistPerformanceData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"name\" />\n                  <YAxis yAxisId=\"left\" orientation=\"left\" />\n                  <YAxis yAxisId=\"right\" orientation=\"right\" tickFormatter={formatCurrency} />\n                  <Tooltip />\n                  <Legend />\n                  <Bar yAxisId=\"left\" dataKey=\"appointments\" fill=\"#3B82F6\" name={t('appointments.title')} />\n                  <Bar yAxisId=\"right\" dataKey=\"revenue\" fill=\"#10B981\" name={t('reports.dashboard.revenue')} />\n                </BarChart>\n              </ResponsiveContainer>\n            </div>\n          )}\n        </Card>\n      )}\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\services\\ServiceBookingModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\services\\ServiceDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\services\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\treatment\\SimpleTreatmentList.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTreatmentRecords'. Either include it or remove the dependency array.","line":63,"column":6,"nodeType":"ArrayExpression","endLine":63,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [searchTerm, statusFilter, patientId, fetchTreatmentRecords]","fix":{"range":[2188,2225],"text":"[searchTerm, statusFilter, patientId, fetchTreatmentRecords]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Search, Plus, Eye, Calendar, User, Clock, CheckCircle, AlertCircle } from 'lucide-react';\nimport { Button, Input, Select, Card, Badge } from '../ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { treatmentService, type TreatmentRecord } from '../../services/treatmentService';\nimport toast from 'react-hot-toast';\nimport { format as formatDate } from 'date-fns';\n\ninterface SimpleTreatmentListProps {\n  patientId?: string;\n  showPatientColumn?: boolean;\n}\n\nexport const SimpleTreatmentList: React.FC<SimpleTreatmentListProps> = ({ \n  patientId, \n  showPatientColumn = true \n}) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [treatmentRecords, setTreatmentRecords] = useState<TreatmentRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n\n  const statusOptions = [\n    { value: 'all', label: t('treatments.status.all') },\n    { value: 'planned', label: t('treatments.status.planned') },\n    { value: 'in_progress', label: t('treatments.status.inProgress') },\n    { value: 'completed', label: t('treatments.status.completed') },\n    { value: 'cancelled', label: t('treatments.status.cancelled') }\n  ];\n\n  const fetchTreatmentRecords = async () => {\n    try {\n      setLoading(true);\n      const params = {\n        page: 1,\n        limit: 50,\n        search: searchTerm,\n        status: statusFilter !== 'all' ? statusFilter : undefined,\n        patient: patientId\n      };\n      \n      const response = await treatmentService.getTreatmentRecords(params);\n      \n      if (response.success && response.data) {\n        setTreatmentRecords(response.data.treatmentRecords || []);\n      } else {\n        setTreatmentRecords([]);\n      }\n    } catch (error) {\n      toast.error(t('treatments.errors.fetchFailed'));\n      console.error('Error fetching treatment records:', error);\n      setTreatmentRecords([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchTreatmentRecords();\n  }, [searchTerm, statusFilter, patientId]);\n\n  const getStatusColor = (status: string) => {\n    const colors = {\n      planned: 'bg-yellow-100 text-yellow-800',\n      in_progress: 'bg-blue-100 text-blue-800',\n      completed: 'bg-green-100 text-green-800',\n      cancelled: 'bg-red-100 text-red-800'\n    };\n    return colors[status as keyof typeof colors] || colors.planned;\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle className=\"h-4 w-4\" />;\n      case 'in_progress':\n        return <Clock className=\"h-4 w-4\" />;\n      case 'cancelled':\n        return <AlertCircle className=\"h-4 w-4\" />;\n      default:\n        return <Calendar className=\"h-4 w-4\" />;\n    }\n  };\n\n  const canManageRecords = user?.role === 'dentist' || user?.role === 'admin' || user?.role === 'staff';\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-3 text-gray-600\">{t('treatments.loading')}</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900\">\n            {patientId ? t('treatments.patientTreatments') : t('treatments.title')}\n          </h2>\n          <p className=\"text-gray-600\">{t('treatments.subtitle')}</p>\n        </div>\n        {canManageRecords && (\n          <Button onClick={() => toast('Treatment form will be implemented soon')}>\n            <Plus className=\"h-4 w-4 mr-2\" />\n            {t('treatments.addRecord')}\n          </Button>\n        )}\n      </div>\n\n      {/* Filters */}\n      <Card className=\"p-6\">\n        <div className=\"flex flex-wrap items-center gap-4\">\n          <div className=\"flex-1 max-w-md\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n              <Input\n                type=\"text\"\n                placeholder={t('treatments.searchPlaceholder')}\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n          </div>\n          <div className=\"sm:w-48\">\n            <Select\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n              options={statusOptions}\n            />\n          </div>\n        </div>\n      </Card>\n\n      {/* Treatment Records List */}\n      <div className=\"space-y-4\">\n        {treatmentRecords.map((record) => (\n          <Card key={record._id} className=\"p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"space-y-4\">\n              {/* Header */}\n              <div className=\"flex justify-between items-start\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-3\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">\n                      {record.treatment}\n                    </h3>\n                    <Badge className={getStatusColor(record.status)}>\n                      <div className=\"flex items-center gap-1\">\n                        {getStatusIcon(record.status)}\n                        {t(`treatments.status.${record.status}`)}\n                      </div>\n                    </Badge>\n                  </div>\n                  {showPatientColumn && (\n                    <div className=\"flex items-center gap-1 text-sm text-gray-600\">\n                      <User className=\"h-4 w-4\" />\n                      {record.patient.firstName} {record.patient.lastName}\n                    </div>\n                  )}\n                  <div className=\"flex items-center gap-1 text-sm text-gray-600\">\n                    <Calendar className=\"h-4 w-4\" />\n                    {formatDate(new Date(record.startDate), 'MMM dd, yyyy')}\n                    {record.endDate && ` - ${formatDate(new Date(record.endDate), 'MMM dd, yyyy')}`}\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => toast('Treatment details will be implemented soon')}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n\n              {/* Details */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-700\">{t('treatments.diagnosis')}</p>\n                  <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{record.diagnosis}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-gray-700\">{t('treatments.dentist')}</p>\n                  <p className=\"text-sm text-gray-600 mt-1\">\n                    Dr. {record.dentist.firstName} {record.dentist.lastName}\n                  </p>\n                </div>\n                {record.cost && (\n                  <div>\n                    <p className=\"text-sm font-medium text-gray-700\">{t('treatments.cost')}</p>\n                    <p className=\"text-sm font-semibold text-green-600 mt-1\">\n                      {t('common.currency')}{record.cost.toFixed(2)}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              {/* Notes Preview */}\n              {record.notes && (\n                <div className=\"border-t pt-4\">\n                  <p className=\"text-sm font-medium text-gray-700 mb-1\">{t('treatments.notes')}</p>\n                  <p className=\"text-sm text-gray-600 line-clamp-2\">{record.notes}</p>\n                </div>\n              )}\n            </div>\n          </Card>\n        ))}\n      </div>\n\n      {/* Empty State */}\n      {treatmentRecords.length === 0 && (\n        <div className=\"text-center py-12\">\n          <Calendar className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {t('treatments.noRecordsFound')}\n          </h3>\n          <p className=\"text-gray-600 mb-4\">\n            {patientId \n              ? t('treatments.noPatientRecords')\n              : t('treatments.noFilteredRecords')\n            }\n          </p>\n          {canManageRecords && (\n            <Button onClick={() => toast('Treatment form will be implemented soon')}>\n              <Plus className=\"h-4 w-4 mr-2\" />\n              {t('treatments.createFirstRecord')}\n            </Button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\DatePicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\ErrorFallback.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\LazyImage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\LoadingSpinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\LoadingStates.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\OptimizedImage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Radio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\ResponsiveImage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Spinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\Textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\config\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\AppProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\AuthContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1967,1970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1967,1970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable react-refresh/only-export-components */\nimport { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport type { ReactNode } from 'react';\nimport type { AuthUser } from '../types';\nimport type { LoginCredentials } from '../types';\nimport type { RegisterData } from '../types';\n// No need to import RefreshTokenResponse as we're handling the response directly\nimport { loginUser, registerUser, logoutUser, getCurrentUser, changePassword as changePasswordService, validateToken, refreshToken } from '../services/authService';\nimport { AuthContext } from './AuthContextDefinition';\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider = ({ children }: AuthProviderProps) => {\n  const [user, setUser] = useState<AuthUser | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isInitialized, setIsInitialized] = useState<boolean>(false);\n  const initializingRef = useRef<boolean>(false);\n  const refreshingRef = useRef<boolean>(false);\n\n  const validateAndSetUser = useCallback(async (token: string) => {\n    try {\n      // First try lightweight token validation\n      const isValid = await validateToken();\n      if (!isValid) {\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        setUser(null);\n        return false;\n      }\n      \n      // If token is valid, get full user data\n      const currentUser = await getCurrentUser();\n      setUser({ ...currentUser, token });\n      return true;\n    } catch (err) {\n      try {\n        // Try to refresh token if validation fails\n        const refreshResult = await refreshToken();\n        if (refreshResult?.token) {\n          // Store the new token\n          localStorage.setItem('token', refreshResult.token);\n          // Handle refresh token if available in the response\n          const refreshTokenValue = (refreshResult as any).refreshToken;\n          if (refreshTokenValue) {\n            localStorage.setItem('refreshToken', refreshTokenValue);\n          }\n          setUser({ ...refreshResult.user, token: refreshResult.token });\n          return true;\n        }\n      } catch (refreshErr) {\n        console.error('Token refresh failed:', refreshErr);\n      }\n      \n      // If refresh also fails, clear everything\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      setUser(null);\n      console.error('Token validation failed:', err);\n      return false;\n    }\n  }, []);\n\n  useEffect(() => {\n    const initAuth = async () => {\n      // Prevent multiple initialization attempts\n      if (initializingRef.current || isInitialized) {\n        return;\n      }\n      \n      initializingRef.current = true;\n      \n      try {\n        setLoading(true);\n        const token = localStorage.getItem('token');\n        if (token) {\n          await validateAndSetUser(token);\n        }\n      } catch (err) {\n        console.error('Failed to initialize auth:', err);\n        // Clear tokens on initialization failure\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        setUser(null);\n      } finally {\n        setLoading(false);\n        setIsInitialized(true);\n        initializingRef.current = false;\n      }\n    };\n\n    initAuth();\n  }, [validateAndSetUser, isInitialized]);\n\n  const login = useCallback(async (credentials: LoginCredentials) => {\n    try {\n      setLoading(true);\n      setError(null);\n      const response = await loginUser(credentials);\n      \n      // Handle nested response structure from backend\n      const userData = ('user' in response ? response.user : response) as AuthUser;\n      const token = response.token;\n      const refreshTokenValue = response.refreshToken;\n      \n      if (token) {\n        localStorage.setItem('token', token);\n        if (refreshTokenValue) {\n          localStorage.setItem('refreshToken', refreshTokenValue);\n        }\n        setUser({ ...userData, token, refreshToken: refreshTokenValue });\n      } else {\n        throw new Error('No token received from server');\n      }\n    } catch (err: unknown) {\n      const errorMessage = err instanceof Error ? err.message : 'Login failed. Please check your credentials and try again.';\n      setError(errorMessage);\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      setUser(null);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const register = useCallback(async (data: RegisterData) => {\n    try {\n      setLoading(true);\n      setError(null);\n      const response = await registerUser(data);\n      \n      // Handle nested response structure from backend\n      const userData = ('user' in response ? response.user : response) as AuthUser;\n      const token = response.token;\n      const refreshTokenValue = response.refreshToken;\n      \n      if (token) {\n        localStorage.setItem('token', token);\n        if (refreshTokenValue) {\n          localStorage.setItem('refreshToken', refreshTokenValue);\n        }\n        setUser({ ...userData, token, refreshToken: refreshTokenValue });\n      } else {\n        throw new Error('No token received from server');\n      }\n    } catch (err: unknown) {\n      const errorMessage = err instanceof Error ? err.message : 'Registration failed. Please try again.';\n      setError(errorMessage);\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      setUser(null);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const logout = useCallback(async () => {\n    try {\n      setLoading(true);\n      await logoutUser();\n    } catch (err: unknown) {\n      console.error('Logout error:', err);\n    } finally {\n      // Always clear tokens and user state, even if logout request fails\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      setUser(null);\n      setLoading(false);\n    }\n  }, []);\n\n  const changePassword = useCallback(async (currentPassword: string, newPassword: string) => {\n    try {\n      setLoading(true);\n      setError(null);\n      await changePasswordService(currentPassword, newPassword);\n    } catch (err: unknown) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to change password';\n      setError(errorMessage);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const clearError = useCallback(() => setError(null), []);\n\n  const refreshUser = useCallback(async () => {\n    // Prevent multiple refresh attempts\n    if (refreshingRef.current) {\n      return;\n    }\n    \n    refreshingRef.current = true;\n    \n    try {\n      const token = localStorage.getItem('token');\n      if (token && user) {\n        await validateAndSetUser(token);\n      }\n    } catch (err) {\n      console.error('Failed to refresh user:', err);\n      // If refresh fails, try to get a new token\n      const refreshResult = await refreshToken();\n      if (refreshResult?.token) {\n        setUser({ ...refreshResult.user, token: refreshResult.token });\n      } else {\n        // If all fails, logout user\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        setUser(null);\n      }\n    } finally {\n      refreshingRef.current = false;\n    }\n  }, [user, validateAndSetUser]);\n\n  // Memoize the context value to prevent unnecessary re-renders\n  const value = useMemo(() => ({\n    user,\n    loading,\n    error,\n    isInitialized,\n    login,\n    register,\n    logout,\n    changePassword,\n    clearError,\n    refreshUser,\n  }), [user, loading, error, isInitialized, login, register, logout, changePassword, clearError, refreshUser]);\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\AuthContextDefinition.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\ClinicContext.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":67,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":67,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\ClinicContextDefinition.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\LanguageContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[327,330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[327,330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":14,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":14,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable react-refresh/only-export-components */\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\n\ninterface LanguageContextType {\n  language: string;\n  isRTL: boolean;\n  changeLanguage: (lang: string) => void;\n  t: (key: string, options?: any) => string;\n}\n\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\n\nexport const useLanguage = () => {\n  const context = useContext(LanguageContext);\n  if (!context) {\n    throw new Error('useLanguage must be used within a LanguageProvider');\n  }\n  return context;\n};\n\ninterface LanguageProviderProps {\n  children: React.ReactNode;\n}\n\nexport const LanguageProvider: React.FC<LanguageProviderProps> = ({ children }) => {\n  const { i18n, t } = useTranslation();\n  const [language, setLanguage] = useState(i18n.language || 'en');\n  const [isRTL, setIsRTL] = useState(false);\n\n  const changeLanguage = async (lang: string) => {\n    try {\n      await i18n.changeLanguage(lang);\n      setLanguage(lang);\n      localStorage.setItem('language', lang);\n      \n      // Update RTL state\n      const rtlLanguages = ['ar', 'he', 'fa', 'ur'];\n      const isRightToLeft = rtlLanguages.includes(lang);\n      setIsRTL(isRightToLeft);\n      \n      // Update document direction and language\n      document.documentElement.dir = isRightToLeft ? 'rtl' : 'ltr';\n      document.documentElement.lang = lang;\n      \n      // Update body class for RTL styling\n      if (isRightToLeft) {\n        document.body.classList.add('rtl');\n      } else {\n        document.body.classList.remove('rtl');\n      }\n    } catch (_error) {\n      console.error('Error changing language:', _error);\n    }\n  };\n\n  useEffect(() => {\n    // Initialize RTL state based on current language\n    const rtlLanguages = ['ar', 'he', 'fa', 'ur'];\n    const isRightToLeft = rtlLanguages.includes(language);\n    setIsRTL(isRightToLeft);\n    \n    // Set initial document direction\n    document.documentElement.dir = isRightToLeft ? 'rtl' : 'ltr';\n    document.documentElement.lang = language;\n    \n    if (isRightToLeft) {\n      document.body.classList.add('rtl');\n    } else {\n      document.body.classList.remove('rtl');\n    }\n  }, [language]);\n\n  useEffect(() => {\n    // Listen for language changes from i18n\n    const handleLanguageChange = (lng: string) => {\n      setLanguage(lng);\n    };\n\n    i18n.on('languageChanged', handleLanguageChange);\n    \n    return () => {\n      i18n.off('languageChanged', handleLanguageChange);\n    };\n  }, [i18n]);\n\n  const value: LanguageContextType = {\n    language,\n    isRTL,\n    changeLanguage,\n    t\n  };\n\n  return (\n    <LanguageContext.Provider value={value}>\n      {children}\n    </LanguageContext.Provider>\n  );\n};\n\nexport default LanguageContext;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\NotificationContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1744,1747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1744,1747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4544,4547],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4544,4547],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5260,5263],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5260,5263],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6341,6344],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6341,6344],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refreshNotifications'. Either include it or remove the dependency array.","line":185,"column":6,"nodeType":"ArrayExpression","endLine":185,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [refreshNotifications, user]","fix":{"range":[6697,6703],"text":"[refreshNotifications, user]"}}]}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":216,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":216,"endColumn":30,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable react-refresh/only-export-components */\r\nimport React, { createContext, useContext, useState, useEffect, useCallback, type ReactNode } from 'react';\r\nimport { notificationService, type Notification } from '../services/notificationService';\r\nimport { useAuth } from '../hooks/useAuth';\r\n\r\ninterface NotificationContextType {\r\n  notifications: Notification[];\r\n  unreadCount: number;\r\n  loading: boolean;\r\n  error: string | null;\r\n  refreshNotifications: () => Promise<void>;\r\n  markAsRead: (id: string) => Promise<void>;\r\n  markAllAsRead: () => Promise<void>;\r\n  deleteNotification: (id: string) => Promise<void>;\r\n}\r\n\r\nconst NotificationContext = createContext<NotificationContextType | undefined>(undefined);\r\n\r\ninterface NotificationProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const NotificationProvider: React.FC<NotificationProviderProps> = ({ children }) => {\r\n  const { user } = useAuth();\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const refreshNotifications = useCallback(async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const [notificationsResponse, countResponse] = await Promise.all([\r\n        notificationService.getRecentNotifications(10),\r\n        notificationService.getUnreadCount()\r\n      ]);\r\n\r\n      if (notificationsResponse.success) {\r\n        setNotifications(notificationsResponse.data.notifications);\r\n      }\r\n\r\n      if (countResponse.success) {\r\n        setUnreadCount(countResponse.data.count);\r\n      }\r\n    } catch (err: any) {\r\n      // Check if it's a 404 error (notification endpoints not implemented)\r\n      if (err.response?.status === 404) {\r\n        console.warn('Notification endpoints not available, using mock data');\r\n        // Use mock data for development\r\n        setNotifications([\r\n          {\r\n            _id: 'mock-1',\r\n            userId: user.id,\r\n            title: 'Welcome to the Clinic System',\r\n            message: 'Your account has been successfully created. You can now book appointments and manage your health records.',\r\n            type: 'general',\r\n            isRead: false,\r\n            createdAt: new Date().toISOString(),\r\n            updatedAt: new Date().toISOString()\r\n          },\r\n          {\r\n            _id: 'mock-2',\r\n            userId: user.id,\r\n            title: 'Appointment Reminder',\r\n            message: 'You have an upcoming appointment tomorrow at 2:00 PM. Please arrive 15 minutes early.',\r\n            type: 'appointment_reminder',\r\n            isRead: false,\r\n            createdAt: new Date(Date.now() - 3600000).toISOString(), // 1 hour ago\r\n            updatedAt: new Date(Date.now() - 3600000).toISOString()\r\n          },\r\n          {\r\n            _id: 'mock-3',\r\n            userId: user.id,\r\n            title: 'System Maintenance',\r\n            message: 'The system will undergo maintenance this weekend from 2:00 AM to 4:00 AM.',\r\n            type: 'system',\r\n            isRead: true,\r\n            createdAt: new Date(Date.now() - 86400000).toISOString(), // 1 day ago\r\n            updatedAt: new Date(Date.now() - 86400000).toISOString()\r\n          }\r\n        ]);\r\n        setUnreadCount(2);\r\n        setError(null);\r\n      } else if (err.code === 'ERR_NETWORK' || err.code === 'ECONNREFUSED') {\r\n        // Network errors - silently fail and use empty state\r\n        console.warn('Network error fetching notifications, will retry later');\r\n        setNotifications([]);\r\n        setUnreadCount(0);\r\n        setError(null);\r\n      } else {\r\n        setError(err.message || 'Failed to fetch notifications');\r\n        console.error('Error fetching notifications:', err);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  const markAsRead = async (id: string) => {\r\n    try {\r\n      // Check if it's a mock notification\r\n      if (id.startsWith('mock-')) {\r\n        // Handle mock data locally\r\n        setNotifications(prev => \r\n          prev.map(n => n._id === id ? { ...n, isRead: true } : n)\r\n        );\r\n        setUnreadCount(prev => Math.max(0, prev - 1));\r\n        return;\r\n      }\r\n\r\n      await notificationService.markAsRead(id);\r\n      setNotifications(prev => \r\n        prev.map(n => n._id === id ? { ...n, isRead: true } : n)\r\n      );\r\n      setUnreadCount(prev => Math.max(0, prev - 1));\r\n    } catch (err: any) {\r\n      console.error('Error marking notification as read:', err);\r\n      // Don't throw error, just log it to prevent UI crashes\r\n    }\r\n  };\r\n\r\n  const markAllAsRead = async () => {\r\n    try {\r\n      // Check if we have mock notifications\r\n      const hasMockNotifications = notifications.some(n => n._id.startsWith('mock-'));\r\n      \r\n      if (hasMockNotifications) {\r\n        // Handle mock data locally\r\n        setNotifications(prev => prev.map(n => ({ ...n, isRead: true })));\r\n        setUnreadCount(0);\r\n        return;\r\n      }\r\n\r\n      await notificationService.markAllAsRead();\r\n      setNotifications(prev => prev.map(n => ({ ...n, isRead: true })));\r\n      setUnreadCount(0);\r\n    } catch (err: any) {\r\n      console.error('Error marking all notifications as read:', err);\r\n      // Don't throw error, just log it to prevent UI crashes\r\n    }\r\n  };\r\n\r\n  const deleteNotification = async (id: string) => {\r\n    try {\r\n      const deletedNotification = notifications.find(n => n._id === id);\r\n      \r\n      // Check if it's a mock notification\r\n      if (id.startsWith('mock-')) {\r\n        // Handle mock data locally\r\n        setNotifications(prev => prev.filter(n => n._id !== id));\r\n        \r\n        // Update unread count if the deleted notification was unread\r\n        if (deletedNotification && !deletedNotification.isRead) {\r\n          setUnreadCount(prev => Math.max(0, prev - 1));\r\n        }\r\n        return;\r\n      }\r\n\r\n      await notificationService.deleteNotification(id);\r\n      setNotifications(prev => prev.filter(n => n._id !== id));\r\n      \r\n      // Update unread count if the deleted notification was unread\r\n      if (deletedNotification && !deletedNotification.isRead) {\r\n        setUnreadCount(prev => Math.max(0, prev - 1));\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error deleting notification:', err);\r\n      // Don't throw error, just log it to prevent UI crashes\r\n    }\r\n  };\r\n\r\n  // Initial fetch when user changes\r\n  useEffect(() => {\r\n    if (user) {\r\n      refreshNotifications();\r\n    } else {\r\n      setNotifications([]);\r\n      setUnreadCount(0);\r\n      setError(null);\r\n    }\r\n  }, [user]);\r\n\r\n  // Periodic refresh every 30 seconds\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    const interval = setInterval(() => {\r\n      refreshNotifications();\r\n    }, 30000); // 30 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [user, refreshNotifications]);\r\n\r\n  const value: NotificationContextType = {\r\n    notifications,\r\n    unreadCount,\r\n    loading,\r\n    error,\r\n    refreshNotifications,\r\n    markAsRead,\r\n    markAllAsRead,\r\n    deleteNotification\r\n  };\r\n\r\n  return (\r\n    <NotificationContext.Provider value={value}>\r\n      {children}\r\n    </NotificationContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNotifications = (): NotificationContextType => {\r\n  const context = useContext(NotificationContext);\r\n  if (context === undefined) {\r\n    throw new Error('useNotifications must be used within a NotificationProvider');\r\n  }\r\n  return context;\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\context\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useApi.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useAsyncEffect.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","line":29,"column":6,"nodeType":"Identifier","endLine":29,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'asyncFn'. Either include it or remove the dependency array. If 'asyncFn' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":29,"column":6,"nodeType":"Identifier","endLine":29,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [asyncFn]","fix":{"range":[782,786],"text":"[asyncFn]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","line":103,"column":6,"nodeType":"Identifier","endLine":103,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'asyncFn' and 'isMounted'. Either include them or remove the dependency array. If 'asyncFn' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":103,"column":6,"nodeType":"Identifier","endLine":103,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [asyncFn, isMounted]","fix":{"range":[2292,2296],"text":"[asyncFn, isMounted]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback, useState } from 'react';\nimport type { DependencyList } from 'react';\n\n/**\n * Custom hook to handle async operations in useEffect safely\n * Prevents memory leaks and handles cleanup properly\n */\nexport const useAsyncEffect = (\n  asyncFn: () => Promise<void> | void,\n  deps: DependencyList,\n  cleanup?: () => void\n) => {\n  const isMountedRef = useRef(true);\n  const cleanupRef = useRef<(() => void) | undefined>(cleanup);\n\n  // Update cleanup function ref\n  cleanupRef.current = cleanup;\n\n  const safeAsyncFn = useCallback(async () => {\n    try {\n      if (isMountedRef.current) {\n        await asyncFn();\n      }\n    } catch (error) {\n      if (isMountedRef.current) {\n        console.error('Async effect error:', error);\n      }\n    }\n  }, deps);\n\n  useEffect(() => {\n    safeAsyncFn();\n\n    return () => {\n      isMountedRef.current = false;\n      if (cleanupRef.current) {\n        cleanupRef.current();\n      }\n    };\n  }, [safeAsyncFn]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n};\n\n/**\n * Hook to safely check if component is still mounted\n */\nexport const useIsMounted = () => {\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  return useCallback(() => isMountedRef.current, []);\n};\n\n/**\n * Hook to handle async operations with loading and error states\n */\nexport const useAsyncOperation = <T>(\n  asyncFn: () => Promise<T>,\n  deps: DependencyList = []\n) => {\n  const [state, setState] = useState<{\n    data: T | null;\n    loading: boolean;\n    error: Error | null;\n  }>({\n    data: null,\n    loading: false,\n    error: null\n  });\n\n  const isMounted = useIsMounted();\n\n  const execute = useCallback(async () => {\n    if (!isMounted()) return;\n\n    setState(prev => ({ ...prev, loading: true, error: null }));\n\n    try {\n      const result = await asyncFn();\n      if (isMounted()) {\n        setState({ data: result, loading: false, error: null });\n      }\n    } catch (error) {\n      if (isMounted()) {\n        setState(prev => ({ \n          ...prev, \n          loading: false, \n          error: error instanceof Error ? error : new Error(String(error))\n        }));\n      }\n    }\n  }, deps);\n\n  useEffect(() => {\n    execute();\n  }, [execute]);\n\n  return { ...state, refetch: execute };\n};\n\nexport default {\n  useAsyncEffect,\n  useIsMounted,\n  useAsyncOperation\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useAsyncOperation.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":12,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[313,316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[313,316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[486,489],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[486,489],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":143,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3340,3343],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3340,3343],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3466,3469],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3466,3469],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'asyncOp'. Either include it or remove the dependency array.","line":162,"column":6,"nodeType":"ArrayExpression","endLine":162,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [asyncOp, autoFetch]","fix":{"range":[3866,3894],"text":"[asyncOp, autoFetch]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a spread element in its dependency array. This means we can't statically verify whether you've passed the correct dependencies.","line":162,"column":18,"nodeType":"SpreadElement","endLine":162,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3989,3992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3989,3992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4021,4024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4021,4024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4111,4114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4111,4114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":181,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4360,4363],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4360,4363],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { logError, logInfo } from '../utils/logger';\r\n\r\ninterface AsyncOperationState<T> {\r\n  data: T | null;\r\n  loading: boolean;\r\n  error: Error | null;\r\n  lastUpdated: Date | null;\r\n}\r\n\r\ninterface AsyncOperationOptions {\r\n  onSuccess?: (data: any) => void;\r\n  onError?: (error: Error) => void;\r\n  retryCount?: number;\r\n  retryDelay?: number;\r\n  logOperationName?: string;\r\n}\r\n\r\nexport function useAsyncOperation<T = any>(\r\n  operation: () => Promise<T>,\r\n  options: AsyncOperationOptions = {}\r\n) {\r\n  const {\r\n    onSuccess,\r\n    onError,\r\n    retryCount = 0,\r\n    retryDelay = 1000,\r\n    logOperationName = 'async operation'\r\n  } = options;\r\n\r\n  const [state, setState] = useState<AsyncOperationState<T>>({\r\n    data: null,\r\n    loading: false,\r\n    error: null,\r\n    lastUpdated: null\r\n  });\r\n\r\n  const retryCountRef = useRef(0);\r\n  const isMountedRef = useRef(true);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      isMountedRef.current = false;\r\n    };\r\n  }, []);\r\n\r\n  const execute = useCallback(async (): Promise<T | null> => {\r\n    if (!isMountedRef.current) return null;\r\n\r\n    setState(prev => ({\r\n      ...prev,\r\n      loading: true,\r\n      error: null\r\n    }));\r\n\r\n    const startTime = Date.now();\r\n    logInfo(`Starting ${logOperationName}`);\r\n\r\n    try {\r\n      const result = await operation();\r\n      \r\n      if (!isMountedRef.current) return null;\r\n\r\n      const duration = Date.now() - startTime;\r\n      logInfo(`${logOperationName} completed successfully`, { duration });\r\n\r\n      setState({\r\n        data: result,\r\n        loading: false,\r\n        error: null,\r\n        lastUpdated: new Date()\r\n      });\r\n\r\n      retryCountRef.current = 0;\r\n      onSuccess?.(result);\r\n      \r\n      return result;\r\n    } catch (error) {\r\n      if (!isMountedRef.current) return null;\r\n\r\n      const duration = Date.now() - startTime;\r\n      const errorObj = error instanceof Error ? error : new Error(String(error));\r\n      \r\n      logError(`${logOperationName} failed`, errorObj, { \r\n        duration,\r\n        retryAttempt: retryCountRef.current,\r\n        maxRetries: retryCount\r\n      });\r\n\r\n      // Retry logic\r\n      if (retryCountRef.current < retryCount) {\r\n        retryCountRef.current++;\r\n        logInfo(`Retrying ${logOperationName}`, { \r\n          attempt: retryCountRef.current, \r\n          maxRetries: retryCount \r\n        });\r\n        \r\n        setTimeout(() => {\r\n          if (isMountedRef.current) {\r\n            execute();\r\n          }\r\n        }, retryDelay);\r\n        \r\n        return null;\r\n      }\r\n\r\n      setState(prev => ({\r\n        ...prev,\r\n        loading: false,\r\n        error: errorObj\r\n      }));\r\n\r\n      onError?.(errorObj);\r\n      return null;\r\n    }\r\n  }, [operation, onSuccess, onError, retryCount, retryDelay, logOperationName]);\r\n\r\n  const retry = useCallback(() => {\r\n    retryCountRef.current = 0;\r\n    execute();\r\n  }, [execute]);\r\n\r\n  const reset = useCallback(() => {\r\n    setState({\r\n      data: null,\r\n      loading: false,\r\n      error: null,\r\n      lastUpdated: null\r\n    });\r\n    retryCountRef.current = 0;\r\n  }, []);\r\n\r\n  return {\r\n    ...state,\r\n    execute,\r\n    retry,\r\n    reset,\r\n    isRetrying: retryCountRef.current > 0\r\n  };\r\n}\r\n\r\n// Specialized hook for data fetching\r\nexport function useAsyncData<T = any>(\r\n  fetchFunction: () => Promise<T>,\r\n  options: AsyncOperationOptions & {\r\n    autoFetch?: boolean;\r\n    dependencies?: any[];\r\n  } = {}\r\n) {\r\n  const { autoFetch = true, dependencies = [], ...operationOptions } = options;\r\n  \r\n  const asyncOp = useAsyncOperation(fetchFunction, {\r\n    ...operationOptions,\r\n    logOperationName: operationOptions.logOperationName || 'data fetch'\r\n  });\r\n\r\n  // Auto-fetch on mount and dependency changes\r\n  useEffect(() => {\r\n    if (autoFetch) {\r\n      asyncOp.execute();\r\n    }\r\n  }, [autoFetch, ...dependencies]);\r\n\r\n  return asyncOp;\r\n}\r\n\r\n// Hook for form submissions\r\nexport function useAsyncSubmit<T = any>(\r\n  submitFunction: (data: any) => Promise<T>,\r\n  options: AsyncOperationOptions = {}\r\n) {\r\n  const dataRef = useRef<any>(null);\r\n  const asyncOp = useAsyncOperation(\r\n    () => submitFunction(dataRef.current),\r\n    {\r\n      ...options,\r\n      logOperationName: options.logOperationName || 'form submission'\r\n    }\r\n  );\r\n\r\n  const submit = useCallback(async (data: any): Promise<T | null> => {\r\n    dataRef.current = data;\r\n    return asyncOp.execute();\r\n  }, [asyncOp]);\r\n\r\n  return {\r\n    ...asyncOp,\r\n    submit\r\n  };\r\n}\r\n\r\nexport default useAsyncOperation;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useAuth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useClinic.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useDebounce.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useForm.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useMediaQuery.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useNotifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\usePagination.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\usePerformance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\usePerformanceMonitor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[144,147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[144,147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2603,2606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2603,2606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3580,3583],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3580,3583],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef } from 'react';\r\n\r\n// Extend Window interface for gtag\r\ndeclare global {\r\n  interface Window {\r\n    gtag?: (...args: any[]) => void;\r\n  }\r\n}\r\n\r\nexport const usePerformanceMonitor = (componentName: string) => {\r\n  const startTimeRef = useRef<number>(performance.now());\r\n  const renderTimeRef = useRef<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    // Mark render complete\r\n    renderTimeRef.current = performance.now();\r\n    \r\n    // Log performance metrics\r\n    const loadTime = renderTimeRef.current - startTimeRef.current;\r\n    \r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(`${componentName} Performance:`, {\r\n        loadTime: `${loadTime.toFixed(2)}ms`,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n    }\r\n\r\n    // Report to performance monitoring service (if available)\r\n    if (window.gtag) {\r\n      window.gtag('event', 'timing_complete', {\r\n        name: componentName,\r\n        value: Math.round(loadTime)\r\n      });\r\n    }\r\n  }, [componentName]);\r\n\r\n  const measureInteraction = (interactionName: string) => {\r\n    const interactionTime = performance.now();\r\n    \r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(`${componentName} - ${interactionName}:`, {\r\n        time: `${(interactionTime - startTimeRef.current).toFixed(2)}ms`\r\n      });\r\n    }\r\n  };\r\n\r\n  return { measureInteraction };\r\n};\r\n\r\n// Core Web Vitals monitoring\r\nexport const useCoreWebVitals = () => {\r\n  useEffect(() => {\r\n    // Largest Contentful Paint (LCP)\r\n    const observeLCP = () => {\r\n      if ('PerformanceObserver' in window) {\r\n        const observer = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          const lastEntry = entries[entries.length - 1];\r\n          \r\n          if (process.env.NODE_ENV === 'development') {\r\n            console.log('LCP:', lastEntry.startTime);\r\n          }\r\n          \r\n          // Report to analytics\r\n          if (window.gtag) {\r\n            window.gtag('event', 'web_vital', {\r\n              name: 'LCP',\r\n              value: Math.round(lastEntry.startTime),\r\n              event_category: 'Web Vitals'\r\n            });\r\n          }\r\n        });\r\n        \r\n        observer.observe({ entryTypes: ['largest-contentful-paint'] });\r\n      }\r\n    };\r\n\r\n    // First Input Delay (FID)\r\n    const observeFID = () => {\r\n      if ('PerformanceObserver' in window) {\r\n        const observer = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          entries.forEach((entry) => {\r\n            const fidEntry = entry as any; // Type assertion for FID entry\r\n            if (process.env.NODE_ENV === 'development') {\r\n              console.log('FID:', fidEntry.processingStart - fidEntry.startTime);\r\n            }\r\n            \r\n            // Report to analytics\r\n            if (window.gtag) {\r\n              window.gtag('event', 'web_vital', {\r\n                name: 'FID',\r\n                value: Math.round(fidEntry.processingStart - fidEntry.startTime),\r\n                event_category: 'Web Vitals'\r\n              });\r\n            }\r\n          });\r\n        });\r\n        \r\n        observer.observe({ entryTypes: ['first-input'] });\r\n      }\r\n    };\r\n\r\n    // Cumulative Layout Shift (CLS)\r\n    const observeCLS = () => {\r\n      if ('PerformanceObserver' in window) {\r\n        let clsValue = 0;\r\n        \r\n        const observer = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          entries.forEach((entry) => {\r\n            const clsEntry = entry as any; // Type assertion for CLS entry\r\n            if (!clsEntry.hadRecentInput) {\r\n              clsValue += clsEntry.value;\r\n            }\r\n          });\r\n          \r\n          if (process.env.NODE_ENV === 'development') {\r\n            console.log('CLS:', clsValue);\r\n          }\r\n          \r\n          // Report to analytics\r\n          if (window.gtag) {\r\n            window.gtag('event', 'web_vital', {\r\n              name: 'CLS',\r\n              value: Math.round(clsValue * 1000),\r\n              event_category: 'Web Vitals'\r\n            });\r\n          }\r\n        });\r\n        \r\n        observer.observe({ entryTypes: ['layout-shift'] });\r\n      }\r\n    };\r\n\r\n    observeLCP();\r\n    observeFID();\r\n    observeCLS();\r\n  }, []);\r\n};\r\n\r\n// Resource loading monitoring\r\nexport const useResourceMonitor = () => {\r\n  useEffect(() => {\r\n    const observer = new PerformanceObserver((list) => {\r\n      const entries = list.getEntries();\r\n      \r\n      entries.forEach((entry) => {\r\n        if (entry.entryType === 'resource') {\r\n          const resourceEntry = entry as PerformanceResourceTiming;\r\n          \r\n          // Monitor slow resources\r\n          if (resourceEntry.duration > 1000) {\r\n            if (process.env.NODE_ENV === 'development') {\r\n              console.warn('Slow resource detected:', {\r\n                name: resourceEntry.name,\r\n                duration: `${resourceEntry.duration.toFixed(2)}ms`,\r\n                size: resourceEntry.transferSize\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n    \r\n    observer.observe({ entryTypes: ['resource'] });\r\n    \r\n    return () => observer.disconnect();\r\n  }, []);\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useResponsive.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useSearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useSectionImpression.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useServiceBooking.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\hooks\\useWebSocket.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":12,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[338,341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[338,341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":28,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[672,675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[672,675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5605,5608],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5605,5608],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":181,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5653,5656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5653,5656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from 'react';\nimport { toast } from 'react-hot-toast';\nimport webSocketService from '../services/websocketService';\nimport { useAuth } from './useAuth';\n\ninterface NotificationData {\n  id: string;\n  title: string;\n  message: string;\n  type: string;\n  link?: string;\n  metadata?: Record<string, any>;\n  createdAt: string;\n}\n\n// These interfaces are used by the webSocketService for type safety\ninterface AppointmentData {\n  id: string;\n  date: string;\n  time: string;\n  patientName?: string;\n  dentistName?: string;\n  status: string;\n}\n\ninterface InventoryAlert {\n  type: 'low_stock' | 'out_of_stock' | 'expiring_soon';\n  items: any[];\n  message: string;\n}\n\ninterface SystemAnnouncement {\n  title: string;\n  message: string;\n  type: string;\n  createdAt: string;\n}\n\n// Add a local type for unsubscribe callbacks\ntype Unsubscribe = (() => void) | undefined;\n\nexport const useWebSocket = () => {\n  const [isConnected, setIsConnected] = useState(false);\n  const { user } = useAuth();\n\n  // Move helpers above useEffect and memoize them so they are safe to use in dependencies\n  const handleNotificationReceived = useCallback((notification: NotificationData) => {\n    // Custom handling based on notification type\n    switch (notification.type) {\n      case 'appointment_confirmation':\n        // Update appointment list if visible\n        break;\n      case 'payment_success':\n        // Update billing/payment status\n        break;\n      case 'low_stock':\n        // Update inventory status\n        break;\n      default:\n        break;\n    }\n\n    // Trigger a custom event for other components to listen to\n    window.dispatchEvent(\n      new CustomEvent('newNotification', {\n        detail: notification,\n      }),\n    );\n  }, []);\n\n  const getNotificationIcon = useCallback((type: string): string => {\n    switch (type) {\n      case 'appointment_reminder':\n        return '';\n      case 'appointment_confirmation':\n        return '';\n      case 'appointment_cancellation':\n        return '';\n      case 'payment_success':\n        return '';\n      case 'payment_failed':\n        return '';\n      case 'inventory_alert':\n      case 'low_stock':\n        return '';\n      case 'system':\n        return '';\n      default:\n        return '';\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!user) {\n      webSocketService.disconnect();\n      return;\n    }\n\n    // Listen for custom connection events from the websocketService\n    const handleConnectionChange = (event: Event) => {\n      const ev = event as CustomEvent<boolean>;\n      const connected = !!ev.detail;\n      setIsConnected(connected);\n\n      if (connected) {\n        toast.success('Real-time notifications connected', {\n          duration: 2000,\n          position: 'bottom-right',\n        });\n      } else {\n        toast.error('Real-time notifications disconnected', {\n          duration: 2000,\n          position: 'bottom-right',\n        });\n      }\n    };\n\n    window.addEventListener('websocket:connection', handleConnectionChange);\n\n    // Cast the return of webSocketService.on to Unsubscribe so TS knows these may be functions\n    const unsubscribeNotification = webSocketService.on('notification', (notification: NotificationData) => {\n      // Show toast notification\n      toast(notification.message, {\n        duration: 5000,\n        position: 'top-right',\n        icon: getNotificationIcon(notification.type),\n      });\n\n      // You can add custom handling here based on notification type\n      handleNotificationReceived(notification);\n    }) as unknown as Unsubscribe;\n\n    const unsubscribeAppointmentReminder = webSocketService.on('appointment_reminder', (appointment: AppointmentData) => {\n      toast(`Appointment Reminder: You have an appointment on ${appointment.date} at ${appointment.time}`, {\n        duration: 10000,\n        position: 'top-right',\n        icon: '',\n      });\n    }) as unknown as Unsubscribe;\n\n    const unsubscribeAppointmentUpdate = webSocketService.on('appointment_update', (appointment: AppointmentData) => {\n      toast(`Appointment updated: ${appointment.status}`, {\n        duration: 5000,\n        position: 'top-right',\n        icon: '',\n      });\n    }) as unknown as Unsubscribe;\n\n    const unsubscribeInventoryAlert = webSocketService.on('inventory_alert', (alert: InventoryAlert) => {\n      toast.error(alert.message, {\n        duration: 8000,\n        position: 'top-right',\n      });\n    }) as unknown as Unsubscribe;\n\n    const unsubscribeSystemAnnouncement = webSocketService.on('system_announcement', (announcement: SystemAnnouncement) => {\n      toast(`${announcement.title}: ${announcement.message}`, {\n        duration: 15000,\n        position: 'top-right',\n        icon: '',\n      });\n    }) as unknown as Unsubscribe;\n\n    // Clean up on unmount\n    return () => {\n      window.removeEventListener('websocket:connection', handleConnectionChange);\n      // Use optional chaining to call unsubscribers if they exist\n      unsubscribeNotification?.();\n      unsubscribeAppointmentReminder?.();\n      unsubscribeAppointmentUpdate?.();\n      unsubscribeInventoryAlert?.();\n      unsubscribeSystemAnnouncement?.();\n    };\n  }, [user, handleNotificationReceived, getNotificationIcon]);\n\n  // Public methods\n  // Small helper to safely call methods on the webSocketService.\n  // It first tries to call a named method if present, otherwise it falls back to an `emit` call\n  // (useful if the underlying implementation exposes an emit API but not specific typed methods).\n  const callIfExists = useCallback((methodName: string, ...args: any[]) => {\n    const svc = webSocketService as any;\n    const fn = svc?.[methodName];\n    if (typeof fn === 'function') {\n      try {\n        fn(...args);\n      } catch (err) {\n        // Avoid throwing from this hook; log for debugging.\n        // eslint-disable-next-line no-console\n        console.warn(`webSocketService.${methodName} threw an error`, err);\n      }\n      return;\n    }\n\n    // Fallback: try an `emit` style API if available\n    if (typeof svc?.emit === 'function') {\n      try {\n        svc.emit(methodName, ...args);\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.warn(`webSocketService.emit fallback for ${methodName} threw`, err);\n      }\n      return;\n    }\n\n    // If neither exists, log a warning (safe no-op)\n    // eslint-disable-next-line no-console\n    console.warn(`webSocketService does not implement ${methodName} and no emit fallback available`);\n  }, []);\n\n  const joinAppointmentRoom = useCallback((appointmentId: string) => {\n    callIfExists('joinAppointmentRoom', appointmentId);\n  }, [callIfExists]);\n\n  const leaveAppointmentRoom = useCallback((appointmentId: string) => {\n    callIfExists('leaveAppointmentRoom', appointmentId);\n  }, [callIfExists]);\n\n  const joinClinicRoom = useCallback((clinicId: string) => {\n    callIfExists('joinClinicRoom', clinicId);\n  }, [callIfExists]);\n\n  const markNotificationAsRead = useCallback((notificationId: string) => {\n    callIfExists('markNotificationAsRead', notificationId);\n  }, [callIfExists]);\n\n  const reconnect = useCallback(() => {\n    // The underlying service exposes `connect`, not `reconnect`.\n    // Use the safe caller so it falls back cleanly if needed.\n    callIfExists('connect');\n  }, [callIfExists]);\n\n  return {\n    isConnected,\n    joinAppointmentRoom,\n    leaveAppointmentRoom,\n    joinClinicRoom,\n    markNotificationAsRead,\n    reconnect,\n  };\n};\n\nexport default useWebSocket;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\i18n\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\About.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\Contact.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\Home.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'footerRef' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":213,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":213,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'newsletterEmail' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":214,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":214,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setNewsletterEmail' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":214,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":214,"endColumn":45}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Button, Card, Badge } from '../components/ui';\r\nimport HeroSection from '../components/homepage/HeroSection';\r\nimport ServicesSection from '../components/homepage/ServicesSection';\r\nimport {\r\n  Phone,\r\n  MapPin,\r\n  Clock,\r\n  Star,\r\n  Shield,\r\n  Award,\r\n  Users,\r\n  Calendar,\r\n  Smile,\r\n  CheckCircle,\r\n  Mail,\r\n  Facebook,\r\n  Twitter,\r\n  Instagram,\r\n  MessageCircle,\r\n  ArrowRight,\r\n  Heart,\r\n  Zap,\r\n\r\n} from 'lucide-react';\r\n\r\nimport { getUsersByRole } from '../services/userService';\r\nimport type { User as UserType } from '../types';\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { useSectionImpression } from '../hooks/useSectionImpression'\r\nimport { trackEvent } from '../utils/analytics'\r\n\r\nconst Home: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const [dentists, setDentists] = useState<UserType[]>([]);\r\n  const [, setLoading] = useState(true);\r\n\r\n  // Fetch real data on component mount\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const [dentistsResponse] = await Promise.all([\r\n          getUsersByRole('dentist', { limit: 6 })\r\n        ]);\r\n\r\n        if (dentistsResponse.success) {\r\n          setDentists(dentistsResponse.data);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const clinicLocations = {\r\n    attsa: {\r\n      name: 'Dr. Gamal Abdel Nasser Center for Laser Dental Implants and Aesthetics',\r\n      address: 'In front of Attsa Preparatory School, Attsa, Fayoum, Egypt',\r\n      phone: '+201017848825',\r\n      hours: {\r\n        weekdays: 'Sunday - Thursday: 12:00 PM - 11:00 PM',\r\n        friday: 'Friday: Closed',\r\n        saturday: 'Saturday: 12:00 PM - 11:00 PM',\r\n        emergency: '24/7 Emergency Care Available'\r\n      },\r\n      mapUrl: 'https://maps.google.com/?q=Attsa+Preparatory+School+Attsa+Fayoum+Egypt',\r\n      services: [\r\n        'Dental treatment',\r\n        'Laser filling',\r\n        'Root canal filling',\r\n        'Children\\'s filling',\r\n        'Regular filling',\r\n        'Regular and surgical extraction',\r\n        'Implants',\r\n        'Installation',\r\n        'Teeth whitening services'\r\n      ]\r\n    },\r\n    fayoum: {\r\n      name: 'Center for Laser Dental Implants and Aesthetics',\r\n      address: 'Al-Nabawi Street, in front of General Hospital, Fayoum, Egypt',\r\n      phone: '+201017848825',\r\n      hours: {\r\n        weekdays: 'Sunday - Thursday: 12:00 PM - 11:00 PM',\r\n        friday: 'Friday: Closed',\r\n        saturday: 'Saturday: 12:00 PM - 11:00 PM',\r\n        emergency: '24/7 Emergency Care Available'\r\n      },\r\n      mapUrl: 'https://maps.google.com/?q=Al-Nabawi+Street+General+Hospital+Fayoum+Egypt',\r\n      services: [\r\n        'Dental treatment',\r\n        'Laser filling',\r\n        'Root canal filling',\r\n        'Children\\'s filling',\r\n        'Regular filling',\r\n        'Regular and surgical extraction',\r\n        'Implants',\r\n        'Installation',\r\n        'Teeth whitening services'\r\n      ]\r\n    }\r\n  };\r\n\r\n  const _services = [\r\n    {\r\n      icon: <Zap className=\"w-8 h-8\" />,\r\n      title: 'Laser Dental Treatment',\r\n      description: 'Advanced laser technology for precise, comfortable, and minimally invasive dental procedures with faster healing times.'\r\n    },\r\n    {\r\n      icon: <Shield className=\"w-8 h-8\" />,\r\n      title: 'Dental Implants',\r\n      description: 'State-of-the-art dental implants to replace missing teeth with natural-looking, permanent solutions.'\r\n    },\r\n    {\r\n      icon: <Star className=\"w-8 h-8\" />,\r\n      title: 'Cosmetic Dentistry',\r\n      description: 'Professional teeth whitening, veneers, and aesthetic treatments to give you the perfect smile.'\r\n    },\r\n    {\r\n      icon: <Heart className=\"w-8 h-8\" />,\r\n      title: 'Root Canal Treatment',\r\n      description: 'Pain-free root canal procedures using modern techniques to save your natural teeth.'\r\n    },\r\n    {\r\n      icon: <Smile className=\"w-8 h-8\" />,\r\n      title: 'Pediatric Dentistry',\r\n      description: 'Specialized dental care for children in a comfortable, child-friendly environment.'\r\n    },\r\n    {\r\n      icon: <CheckCircle className=\"w-8 h-8\" />,\r\n      title: 'Oral Surgery',\r\n      description: 'Expert surgical procedures including extractions, wisdom teeth removal, and advanced oral surgery.'\r\n    }\r\n  ];\r\n\r\n  const testimonials = [\r\n    {\r\n      name: 'Ahmed Hassan',\r\n      rating: 5,\r\n      text: 'Dr. Gamal and his team provided exceptional care during my dental implant procedure. The laser technology made the process virtually painless, and the results exceeded my expectations.',\r\n      treatment: 'Dental Implants'\r\n    },\r\n    {\r\n      name: 'Fatima Al-Zahra',\r\n      rating: 5,\r\n      text: 'I was amazed by the professionalism and modern equipment at the clinic. My root canal treatment was completed efficiently with minimal discomfort. Highly recommended!',\r\n      treatment: 'Root Canal Treatment'\r\n    },\r\n    {\r\n      name: 'Mohamed Abdel Rahman',\r\n      rating: 5,\r\n      text: 'The teeth whitening service transformed my smile completely. The staff was friendly and the clinic environment was very clean and comfortable.',\r\n      treatment: 'Teeth Whitening'\r\n    },\r\n    {\r\n      name: 'Nour El-Din',\r\n      rating: 5,\r\n      text: 'Excellent pediatric care for my children. Dr. Moamen was patient and gentle, making the dental visit a positive experience for my kids.',\r\n      treatment: 'Pediatric Dentistry'\r\n    }\r\n  ];\r\n\r\n  // Use real dentist data or fallback to static data\r\n  const teamMembers = dentists.length > 0 ? dentists.slice(0, 2).map(dentist => {\r\n    // Map real doctor images based on their names\r\n    let doctorImage = '/images/dr-placeholder.jpg';\r\n    if (dentist.firstName?.toLowerCase().includes('gamal')) {\r\n      doctorImage = '/images/Dr.Gamal.jpg';\r\n    } else if (dentist.firstName?.toLowerCase().includes('moamen')) {\r\n      doctorImage = '/images/Dr.Momen.jpg';\r\n    }\r\n\r\n    return {\r\n      name: `${dentist.firstName} ${dentist.lastName}`,\r\n      title: 'Dentist',\r\n      credentials: dentist.specialization || 'General Dentistry',\r\n      image: dentist.profileImage || doctorImage,\r\n      phone: dentist.phone\r\n    };\r\n  }) : [\r\n    {\r\n      name: 'Dr. Gamal Abdel Nasser Khattab',\r\n      title: 'Lead Dentist & Practice Owner',\r\n      credentials: 'Oral and Dental Medicine and Surgery Specialist',\r\n      image: '/images/Dr.Gamal.jpg',\r\n      phone: '+201070721469'\r\n    },\r\n    {\r\n      name: 'Dr. Moamen Al-Banna',\r\n      title: 'Senior Dentist',\r\n      credentials: 'Oral and Dental Medicine and Surgery Specialist',\r\n      image: '/images/Dr.Momen.jpg',\r\n      phone: '+201070721470'\r\n    }\r\n  ];\r\n\r\n  const [currentTestimonialIndex, setCurrentTestimonialIndex] = useState(0);\r\n  const navigate = useNavigate()\r\n  const statsRef = useSectionImpression('home.stats')\r\n  const newPatientRef = useSectionImpression('home.new_patient')\r\n  const clinicsRef = useSectionImpression('home.clinics')\r\n  const testimonialsRef = useSectionImpression('home.testimonials')\r\n  const teamRef = useSectionImpression('home.team')\r\n  const whyUsRef = useSectionImpression('home.why_us')\r\n  const newsletterRef = useSectionImpression('home.newsletter')\r\n  const footerRef = useSectionImpression('home.footer')\r\n  const [newsletterEmail, setNewsletterEmail] = useState('')\r\n\r\n  const handleNextTestimonial = () => {\r\n    setCurrentTestimonialIndex((prevIndex) => (prevIndex + 1) % testimonials.length);\r\n  };\r\n\r\n  const handlePrevTestimonial = () => {\r\n    setCurrentTestimonialIndex((prevIndex) => (prevIndex - 1 + testimonials.length) % testimonials.length);\r\n  };\r\n\r\n  // Clinic Locations - Updated to focus on single location without selection\r\n  return (\r\n    <div className=\"min-h-screen\">\r\n\r\n      {/* Enhanced Hero Section */}\r\n      <HeroSection />\r\n\r\n      {/* Quick Stats Section */}\r\n      <section className=\"py-16 bg-white\" role=\"region\" aria-label=\"Practice statistics\" ref={statsRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 max-w-4xl mx-auto\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-4xl md:text-5xl font-bold text-blue-600 mb-2\">10K+</div>\r\n              <div className=\"text-gray-600 font-medium\">Happy Patients</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-4xl md:text-5xl font-bold text-green-600 mb-2\">15+</div>\r\n              <div className=\"text-gray-600 font-medium\">Years Experience</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-4xl md:text-5xl font-bold text-purple-600 mb-2\">24/7</div>\r\n              <div className=\"text-gray-600 font-medium\">Emergency Care</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-4xl md:text-5xl font-bold text-orange-600 mb-2\">4.9</div>\r\n              <div className=\"text-gray-600 font-medium\">Patient Rating</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* New Patient CTA Section */}\r\n      <section className=\"py-16 bg-gradient-to-r from-blue-50 to-indigo-50\" role=\"region\" aria-label=\"New patient information\" ref={newPatientRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"max-w-6xl mx-auto\">\r\n            <div className=\"text-center mb-12\">\r\n              <Badge className=\"bg-blue-100 text-blue-800 px-4 py-2 rounded-full mb-4\">\r\n                New Patient Special - 20% Off First Visit\r\n              </Badge>\r\n              <h2 className=\"text-3xl md:text-4xl font-bold text-gray-900 mb-4\">\r\n                Start Your Journey to Perfect Oral Health\r\n              </h2>\r\n              <p className=\"text-xl text-gray-600 max-w-3xl mx-auto\">\r\n                Join our growing family of satisfied patients across Fayoum and Attsa. Experience the difference of modern laser dentistry.\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"grid md:grid-cols-3 gap-8 mb-12\">\r\n              <Card className=\"p-8 text-center hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 border-0 bg-white/80 backdrop-blur-sm\">\r\n                <div className=\"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center\">\r\n                  <Users className=\"w-8 h-8 text-white\" />\r\n                </div>\r\n                <h3 className=\"text-xl font-bold text-gray-900 mb-3\">Create Account</h3>\r\n                <p className=\"text-gray-600 mb-6\">\r\n                  Quick 2-minute signup to access our patient portal and manage your care.\r\n                </p>\r\n                <Button className=\"bg-blue-600 hover:bg-blue-700 text-white w-full\" onClick={() => { trackEvent('cta_card_click', { card: 'sign_up' }); navigate('/register') }}>\r\n                  Sign Up Free\r\n                  <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                </Button>\r\n              </Card>\r\n\r\n              <Card className=\"p-8 text-center hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 border-0 bg-white/80 backdrop-blur-sm\">\r\n                <div className=\"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-green-500 to-green-600 rounded-2xl flex items-center justify-center\">\r\n                  <Calendar className=\"w-8 h-8 text-white\" />\r\n                </div>\r\n                <h3 className=\"text-xl font-bold text-gray-900 mb-3\">Book Appointment</h3>\r\n                <p className=\"text-gray-600 mb-6\">\r\n                  Choose your preferred time slot with our easy online booking system.\r\n                </p>\r\n                <Button className=\"bg-green-600 hover:bg-green-700 text-white w-full\" onClick={() => { trackEvent('cta_card_click', { card: 'schedule_now' }); navigate('/appointments/create') }}>\r\n                  Schedule Now\r\n                  <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                </Button>\r\n              </Card>\r\n\r\n              <Card className=\"p-8 text-center hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 border-0 bg-white/80 backdrop-blur-sm\">\r\n                <div className=\"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center\">\r\n                  <Smile className=\"w-8 h-8 text-white\" />\r\n                </div>\r\n                <h3 className=\"text-xl font-bold text-gray-900 mb-3\">Get Treatment</h3>\r\n                <p className=\"text-gray-600 mb-6\">\r\n                  Receive personalized care from our experienced dental professionals.\r\n                </p>\r\n                <Button variant=\"outline\" className=\"border-purple-600 text-purple-600 hover:bg-purple-600 hover:text-white w-full\" onClick={() => { trackEvent('cta_card_click', { card: 'learn_more' }); navigate('/services') }}>\r\n                  Learn More\r\n                  <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                </Button>\r\n              </Card>\r\n            </div>\r\n\r\n            <div className=\"text-center\">\r\n              <div className=\"bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-6 mb-6\">\r\n                <p className=\"text-lg text-gray-700 mb-4\">\r\n                  <strong className=\"text-green-600\"> New Patient Special:</strong> Get 20% off your first consultation and treatment at either location\r\n                </p>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  *Valid for new patients only. Cannot be combined with other offers. Expires December 31, 2024.\r\n                </p>\r\n              </div>\r\n              <div className=\"flex flex-col sm:flex-row justify-center gap-4\">\r\n                <Button size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4\">\r\n                  <Phone className=\"w-5 h-5 mr-2\" />\r\n                  Call Now: +201017848825\r\n                </Button>\r\n                <Button size=\"lg\" variant=\"outline\" className=\"border-2 border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white px-8 py-4\">\r\n                  <MessageCircle className=\"w-5 h-5 mr-2\" />\r\n                  WhatsApp Booking\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Clinic Locations */}\r\n      <section className=\"py-20 bg-white\" role=\"region\" aria-label=\"Clinic locations\" ref={clinicsRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"text-center mb-16\">\r\n            <Badge className=\"bg-green-100 text-green-800 px-4 py-2 rounded-full mb-4\">\r\n              Two Convenient Locations\r\n            </Badge>\r\n            <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-6\">\r\n              Visit Our Modern Clinics\r\n            </h2>\r\n            <p className=\"text-xl text-gray-600 max-w-3xl mx-auto\">\r\n              Choose from our two state-of-the-art locations in Fayoum Governorate, both equipped with the latest laser dental technology.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"grid lg:grid-cols-2 gap-12 max-w-7xl mx-auto\">\r\n            {/* Attsa Location */}\r\n            <Card className=\"p-8 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2\">\r\n              <div className=\"flex items-center mb-6\">\r\n                <div className=\"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4\">\r\n                  <MapPin className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"text-2xl font-bold text-gray-900\">Attsa Branch</h3>\r\n                  <p className=\"text-blue-600 font-medium\">Main Location</p>\r\n                </div>\r\n              </div>\r\n\r\n              <h4 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n                {clinicLocations.attsa.name}\r\n              </h4>\r\n\r\n              <div className=\"space-y-4 mb-6\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <MapPin className=\"w-5 h-5 text-blue-600 mt-1 flex-shrink-0\" />\r\n                  <div>\r\n                    <p className=\"text-gray-700 font-medium\">\r\n                      {clinicLocations.attsa.address}\r\n                    </p>\r\n                    <a\r\n                      href={clinicLocations.attsa.mapUrl}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"text-blue-600 hover:text-blue-700 text-sm font-medium inline-flex items-center mt-1\"\r\n                    >\r\n                      View on Google Maps <ArrowRight className=\"w-3 h-3 ml-1\" />\r\n                    </a>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Phone className=\"w-5 h-5 text-blue-600\" />\r\n                  <a\r\n                    href={`tel:${clinicLocations.attsa.phone}`}\r\n                    className=\"text-gray-700 hover:text-blue-600 font-medium\"\r\n                  >\r\n                    {clinicLocations.attsa.phone}\r\n                  </a>\r\n                </div>\r\n\r\n                <div className=\"flex items-start gap-3\">\r\n                  <Clock className=\"w-5 h-5 text-blue-600 mt-1\" />\r\n                  <div className=\"text-gray-700\">\r\n                    <p className=\"font-medium\">{clinicLocations.attsa.hours.weekdays}</p>\r\n                    <p className=\"text-red-600\">{clinicLocations.attsa.hours.friday}</p>\r\n                    <p className=\"font-medium\">{clinicLocations.attsa.hours.saturday}</p>\r\n                    <p className=\"text-green-600 font-medium text-sm mt-1\">{clinicLocations.attsa.hours.emergency}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex gap-3 mb-6\">\r\n                <Button className=\"flex-1 bg-blue-600 hover:bg-blue-700\">\r\n                  <Calendar className=\"w-4 h-4 mr-2\" />\r\n                  Book Appointment\r\n                </Button>\r\n                <Button variant=\"outline\" className=\"flex-1\">\r\n                  <Phone className=\"w-4 h-4 mr-2\" />\r\n                  Call Now\r\n                </Button>\r\n              </div>\r\n\r\n              <div className=\"border-t pt-4\">\r\n                <p className=\"text-sm text-gray-600 mb-2 font-medium\">Available Services:</p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {clinicLocations.attsa.services.slice(0, 4).map((service, index) => (\r\n                    <Badge key={index} className=\"bg-blue-50 text-blue-700 text-xs\">\r\n                      {service}\r\n                    </Badge>\r\n                  ))}\r\n                  <Badge className=\"bg-gray-100 text-gray-600 text-xs\">\r\n                    +{clinicLocations.attsa.services.length - 4} more\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Fayoum Location */}\r\n            <Card className=\"p-8 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2\">\r\n              <div className=\"flex items-center mb-6\">\r\n                <div className=\"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4\">\r\n                  <MapPin className=\"w-6 h-6 text-green-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"text-2xl font-bold text-gray-900\">Fayoum Branch</h3>\r\n                  <p className=\"text-green-600 font-medium\">City Center</p>\r\n                </div>\r\n              </div>\r\n\r\n              <h4 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n                {clinicLocations.fayoum.name}\r\n              </h4>\r\n\r\n              <div className=\"space-y-4 mb-6\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <MapPin className=\"w-5 h-5 text-green-600 mt-1 flex-shrink-0\" />\r\n                  <div>\r\n                    <p className=\"text-gray-700 font-medium\">\r\n                      {clinicLocations.fayoum.address}\r\n                    </p>\r\n                    <a\r\n                      href={clinicLocations.fayoum.mapUrl}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"text-green-600 hover:text-green-700 text-sm font-medium inline-flex items-center mt-1\"\r\n                    >\r\n                      View on Google Maps <ArrowRight className=\"w-3 h-3 ml-1\" />\r\n                    </a>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Phone className=\"w-5 h-5 text-green-600\" />\r\n                  <a\r\n                    href={`tel:${clinicLocations.fayoum.phone}`}\r\n                    className=\"text-gray-700 hover:text-green-600 font-medium\"\r\n                  >\r\n                    {clinicLocations.fayoum.phone}\r\n                  </a>\r\n                </div>\r\n\r\n                <div className=\"flex items-start gap-3\">\r\n                  <Clock className=\"w-5 h-5 text-green-600 mt-1\" />\r\n                  <div className=\"text-gray-700\">\r\n                    <p className=\"font-medium\">{clinicLocations.fayoum.hours.weekdays}</p>\r\n                    <p className=\"text-red-600\">{clinicLocations.fayoum.hours.friday}</p>\r\n                    <p className=\"font-medium\">{clinicLocations.fayoum.hours.saturday}</p>\r\n                    <p className=\"text-green-600 font-medium text-sm mt-1\">{clinicLocations.fayoum.hours.emergency}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex gap-3 mb-6\">\r\n                <Button className=\"flex-1 bg-green-600 hover:bg-green-700\">\r\n                  <Calendar className=\"w-4 h-4 mr-2\" />\r\n                  Book Appointment\r\n                </Button>\r\n                <Button variant=\"outline\" className=\"flex-1\">\r\n                  <Phone className=\"w-4 h-4 mr-2\" />\r\n                  Call Now\r\n                </Button>\r\n              </div>\r\n\r\n              <div className=\"border-t pt-4\">\r\n                <p className=\"text-sm text-gray-600 mb-2 font-medium\">Available Services:</p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {clinicLocations.fayoum.services.slice(0, 4).map((service, index) => (\r\n                    <Badge key={index} className=\"bg-green-50 text-green-700 text-xs\">\r\n                      {service}\r\n                    </Badge>\r\n                  ))}\r\n                  <Badge className=\"bg-gray-100 text-gray-600 text-xs\">\r\n                    +{clinicLocations.fayoum.services.length - 4} more\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          </div>\r\n\r\n          <div className=\"text-center mt-12\">\r\n            <p className=\"text-gray-600 mb-4\">\r\n              <strong>Both locations offer:</strong> Free parking  Wheelchair accessible  Modern equipment  Sterilized environment\r\n            </p>\r\n            <Button size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white px-8 py-4\" onClick={() => { trackEvent('clinic_cta_click', { action: 'book_either_location' }); navigate('/appointments/create') }}>\r\n              <Calendar className=\"w-5 h-5 mr-2\" />\r\n              Book at Either Location\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Enhanced Dental Services Section */}\r\n      <ServicesSection \r\n        showFilters={false} \r\n        maxServices={6} \r\n        showBookingIntegration={true}\r\n      />\r\n\r\n      {/* Patient Testimonials Section */}\r\n      <section className=\"py-16 bg-white\" role=\"region\" aria-label=\"Patient testimonials\" ref={testimonialsRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"text-center mb-12\">\r\n            <h2 className=\"text-3xl md:text-4xl font-bold text-gray-900 mb-4\">\r\n              {t('home.testimonials.title')}\r\n            </h2>\r\n            <p className=\"text-xl text-gray-600\">\r\n              {t('home.testimonials.description')}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"relative max-w-4xl mx-auto\">\r\n            <div className=\"flex overflow-hidden\">\r\n              {testimonials.map((testimonial, index) => (\r\n                <div key={index} className=\"w-full flex-shrink-0 transition-transform duration-500\" style={{ transform: `translateX(-${currentTestimonialIndex * 100}%)` }}>\r\n                  <Card className=\"p-6 mx-auto max-w-md\">\r\n                    <div className=\"flex items-center mb-4\">\r\n                      <div className=\"flex text-yellow-400 mr-2\">\r\n                        {[...Array(testimonial.rating)].map((_, i) => (\r\n                          <Star key={i} className=\"w-4 h-4 fill-current\" />\r\n                        ))}\r\n                      </div>\r\n                      <Badge className=\"bg-blue-100 text-blue-800 text-xs\">\r\n                        {testimonial.treatment}\r\n                      </Badge>\r\n                    </div>\r\n                    <p className=\"text-gray-600 mb-4 italic\">\r\n                      \"{testimonial.text}\"\r\n                    </p>\r\n                    <div className=\"flex items-center\">\r\n                      <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3\">\r\n                        <Smile className=\"w-5 h-5 text-blue-600\" />\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"font-semibold text-gray-900\">{testimonial.name}</p>\r\n                        <p className=\"text-sm text-gray-500\">{t('home.testimonials.verifiedPatient')}</p>\r\n                      </div>\r\n                    </div>\r\n                  </Card>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <div className=\"flex justify-center mt-6 gap-2\">\r\n              {testimonials.map((_, index) => (\r\n                <button\r\n                  key={index}\r\n                  onClick={() => { trackEvent('testimonial_dot_click', { index }); setCurrentTestimonialIndex(index) }}\r\n                  className={`w-3 h-3 rounded-full ${currentTestimonialIndex === index ? 'bg-blue-600' : 'bg-gray-300'} transition-colors`}\r\n                  aria-label={`View testimonial ${index + 1}`}\r\n                />\r\n              ))}\r\n            </div>\r\n            <button\r\n              onClick={() => { trackEvent('testimonial_nav', { direction: 'prev' }); handlePrevTestimonial() }}\r\n              className=\"absolute left-0 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-md hover:bg-gray-100\"\r\n              aria-label=\"Previous testimonial\"\r\n            >\r\n              \r\n            </button>\r\n            <button\r\n              onClick={() => { trackEvent('testimonial_nav', { direction: 'next' }); handleNextTestimonial() }}\r\n              className=\"absolute right-0 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-md hover:bg-gray-100\"\r\n              aria-label=\"Next testimonial\"\r\n            >\r\n              \r\n            </button>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Meet Our Team Section */}\r\n      <section className=\"py-20 bg-gradient-to-br from-gray-50 to-blue-50\" role=\"region\" aria-label=\"Meet our team\" ref={teamRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"text-center mb-16\">\r\n            <Badge className=\"bg-blue-100 text-blue-800 px-4 py-2 rounded-full mb-4\">\r\n              Expert Team\r\n            </Badge>\r\n            <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-6\">\r\n              Meet Our Dental Specialists\r\n            </h2>\r\n            <p className=\"text-xl text-gray-600 max-w-3xl mx-auto\">\r\n              Our experienced team of dental professionals is dedicated to providing you with the highest quality care using the latest techniques and technology.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"grid md:grid-cols-2 gap-12 max-w-5xl mx-auto\">\r\n            {teamMembers.map((member, index) => (\r\n              <Card key={index} className=\"p-8 text-center hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-3 bg-white/80 backdrop-blur-sm\">\r\n                <div className=\"relative mb-6\">\r\n                  <div className=\"w-32 h-32 mx-auto rounded-full overflow-hidden bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center\">\r\n                    <img\r\n                      src={member.image}\r\n                      alt={member.name}\r\n                      className=\"w-full h-full object-cover\"\r\n                      onError={(e) => {\r\n                        const target = e.target as HTMLImageElement;\r\n                        target.src = `data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjNGNEY2IiByeD0iNjQiLz4KPHN2ZyB4PSIzMiIgeT0iMzIiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOUNBM0FGIj4KICA8cGF0aCBkPSJNMTIgMTJjMi4yMSAwIDQtMS43OSA0LTRzLTEuNzktNC00LTQtNCAxLjc5LTQgNCAxLjc5IDQgNCA0em0wIDJjLTIuNjcgMC04IDEuMzQtOCA0djJoMTZ2LTJjMC0yLjY2LTUuMzMtNC04LTR6Ii8+Cjwvc3ZnPgo8L3N2Zz4K`;\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div className=\"absolute -bottom-2 -right-2 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center\">\r\n                    <Award className=\"w-4 h-4 text-white\" />\r\n                  </div>\r\n                </div>\r\n\r\n                <h3 className=\"text-2xl font-bold text-gray-900 mb-2\">\r\n                  {member.name}\r\n                </h3>\r\n                <p className=\"text-blue-600 font-semibold mb-3\">\r\n                  {member.title}\r\n                </p>\r\n                <p className=\"text-gray-600 mb-4 leading-relaxed\">\r\n                  {member.credentials}\r\n                </p>\r\n\r\n                {member.phone && (\r\n                  <div className=\"flex items-center justify-center gap-2 text-gray-600 mb-6\">\r\n                    <Phone className=\"w-4 h-4\" />\r\n                    <a\r\n                      href={`tel:${member.phone}`}\r\n                      className=\"hover:text-blue-600 transition-colors\"\r\n                    >\r\n                      {member.phone}\r\n                    </a>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"flex justify-center gap-3\">\r\n                  <Button size=\"sm\" className=\"bg-blue-600 hover:bg-blue-700\">\r\n                    <Calendar className=\"w-4 h-4 mr-2\" />\r\n                    Book with {member.name.split(' ')[1]}\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"mt-6 pt-6 border-t border-gray-100\">\r\n                  <div className=\"flex justify-center gap-4 text-sm text-gray-500\">\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Star className=\"w-4 h-4 text-yellow-400 fill-current\" />\r\n                      <span>15+ Years</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Users className=\"w-4 h-4 text-blue-400\" />\r\n                      <span>1000+ Patients</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"text-center mt-12\">\r\n            <p className=\"text-gray-600 mb-6\">\r\n              Both doctors are available at both locations. Schedule your appointment at your preferred clinic.\r\n            </p>\r\n            <Button size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4\" onClick={() => { trackEvent('team_cta_click'); navigate('/about') }}>\r\n              <Users className=\"w-5 h-5 mr-2\" />\r\n              Meet Our Full Team\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Why Choose Us Section */}\r\n      <section className=\"py-16 md:py-24 bg-white\" role=\"region\" aria-label=\"Why choose us\" ref={whyUsRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"text-center max-w-3xl mx-auto mb-16\">\r\n            <Badge className=\"bg-purple-100 text-purple-800 px-4 py-2 rounded-full mb-4\">\r\n              Why Choose Clear Dental Centers\r\n            </Badge>\r\n            <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-6\">\r\n              Advanced Care, Exceptional Results\r\n            </h2>\r\n            <p className=\"text-xl text-gray-600\">\r\n              Experience the difference of modern laser dentistry combined with personalized care and years of expertise.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"grid md:grid-cols-3 gap-8 mb-12\">\r\n            <Card className=\"p-8 text-center hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-3\">\r\n              <div className=\"mb-6\">\r\n                <img\r\n                  src=\"/images/laser-technology.jpg\"\r\n                  alt=\"Laser Technology\"\r\n                  className=\"w-full h-48 object-cover rounded-2xl mx-auto\"\r\n                  onError={(e) => {\r\n                    const target = e.target as HTMLImageElement;\r\n                    target.src = `data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUNBM0FGIiBmb250LXNpemU9IjE4Ij5MYXNlciBUZWNobm9sb2d5PC90ZXh0Pgo8L3N2Zz4K`;\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center\">\r\n                <Zap className=\"w-8 h-8 text-white\" />\r\n              </div>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">Advanced Laser Technology</h3>\r\n              <p className=\"text-gray-600 leading-relaxed\">\r\n                State-of-the-art laser equipment for precise, minimally invasive procedures with faster healing and reduced discomfort.\r\n              </p>\r\n            </Card>\r\n\r\n            <Card className=\"p-8 text-center hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-3\">\r\n              <div className=\"mb-6\">\r\n                <img\r\n                  src=\"/images/experienced-doctors.jpg\"\r\n                  alt=\"Experienced Doctors\"\r\n                  className=\"w-full h-48 object-cover rounded-2xl mx-auto\"\r\n                  onError={(e) => {\r\n                    const target = e.target as HTMLImageElement;\r\n                    target.src = `data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUNBM0FGIiBmb250LXNpemU9IjE4Ij5FeHBlcmllbmNlZCBEb2N0b3JzPC90ZXh0Pgo8L3N2Zz4K`;\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-green-500 to-green-600 rounded-2xl flex items-center justify-center\">\r\n                <Users className=\"w-8 h-8 text-white\" />\r\n              </div>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">Expert Specialists</h3>\r\n              <p className=\"text-gray-600 leading-relaxed\">\r\n                Highly qualified oral and dental medicine specialists with over 15 years of experience in advanced dental procedures.\r\n              </p>\r\n            </Card>\r\n\r\n            <Card className=\"p-8 text-center hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-3\">\r\n              <div className=\"mb-6\">\r\n                <img\r\n                  src=\"/images/patient-comfort.jpg\"\r\n                  alt=\"Patient Comfort\"\r\n                  className=\"w-full h-48 object-cover rounded-2xl mx-auto\"\r\n                  onError={(e) => {\r\n                    const target = e.target as HTMLImageElement;\r\n                    target.src = `data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUNBM0FGIiBmb250LXNpemU9IjE4Ij5QYXRpZW50IENvbWZvcnQ8L3RleHQ+Cjwvc3ZnPgo=`;\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center\">\r\n                <Heart className=\"w-8 h-8 text-white\" />\r\n              </div>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">Patient-Centered Care</h3>\r\n              <p className=\"text-gray-600 leading-relaxed\">\r\n                Comfortable, modern facilities with a focus on patient comfort, safety, and personalized treatment plans for every individual.\r\n              </p>\r\n            </Card>\r\n          </div>\r\n\r\n          <div className=\"text-center\">\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 max-w-4xl mx-auto mb-8\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-3xl font-bold text-blue-600 mb-2\">15+</div>\r\n                <div className=\"text-gray-600\">Years Experience</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-3xl font-bold text-green-600 mb-2\">5000+</div>\r\n                <div className=\"text-gray-600\">Happy Patients</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-3xl font-bold text-purple-600 mb-2\">2</div>\r\n                <div className=\"text-gray-600\">Modern Locations</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-3xl font-bold text-orange-600 mb-2\">24/7</div>\r\n                <div className=\"text-gray-600\">Emergency Care</div>\r\n              </div>\r\n            </div>\r\n\r\n            <Button size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-4\" onClick={() => { trackEvent('why_us_cta_click'); navigate('/services') }}>\r\n              <Calendar className=\"w-5 h-5 mr-2\" />\r\n              Experience the Difference\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Newsletter & Contact Section */}\r\n      <section className=\"py-16 bg-blue-600 text-white\" role=\"region\" aria-label=\"Newsletter signup\" ref={newsletterRef}>\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"max-w-4xl mx-auto text-center\">\r\n            <h2 className=\"text-3xl md:text-4xl font-bold mb-4\">\r\n              {t('home.newsletter.title')}\r\n            </h2>\r\n            <p className=\"text-xl mb-8 opacity-90\">\r\n              {t('home.newsletter.description')}\r\n            </p>\r\n\r\n            <div className=\"flex flex-col sm:flex-row gap-4 max-w-md mx-auto mb-8\">\r\n              <input\r\n                type=\"email\"\r\n                placeholder={t('home.newsletter.emailPlaceholder')}\r\n                className=\"flex-1 px-4 py-3 rounded-lg text-gray-900 placeholder-gray-500\"\r\n              />\r\n              <Button className=\"bg-white text-blue-600 hover:bg-gray-100 px-6 py-3\">\r\n                <Mail className=\"w-4 h-4 mr-2\" />\r\n                {t('home.newsletter.subscribe')}\r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"flex justify-center gap-6\">\r\n              <a href=\"#\" className=\"text-white hover:text-blue-200 transition-colors\">\r\n                <Facebook className=\"w-6 h-6\" />\r\n              </a>\r\n              <a href=\"#\" className=\"text-white hover:text-blue-200 transition-colors\">\r\n                <Twitter className=\"w-6 h-6\" />\r\n              </a>\r\n              <a href=\"#\" className=\"text-white hover:text-blue-200 transition-colors\">\r\n                <Instagram className=\"w-6 h-6\" />\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Footer */}\r\n      <footer className=\"bg-gray-900 text-white py-12\" role=\"contentinfo\">\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"grid md:grid-cols-4 gap-8 mb-8\">\r\n            {/* Company Info */}\r\n            <div>\r\n              <h3 className=\"text-xl font-bold mb-4\">Clear Dental Centers</h3>\r\n              <p className=\"text-gray-400 mb-4\">\r\n                Advanced laser dental care with expert specialists serving the Fayoum community since 2015. Your smile is our priority.\r\n              </p>\r\n              <div className=\"flex gap-4\">\r\n                <a href=\"#\" className=\"text-gray-400 hover:text-white transition-colors\">\r\n                  <Facebook className=\"w-5 h-5\" />\r\n                </a>\r\n                <a href=\"#\" className=\"text-gray-400 hover:text-white transition-colors\">\r\n                  <Twitter className=\"w-5 h-5\" />\r\n                </a>\r\n                <a href=\"#\" className=\"text-gray-400 hover:text-white transition-colors\">\r\n                  <Instagram className=\"w-5 h-5\" />\r\n                </a>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Quick Links */}\r\n            <div>\r\n              <h4 className=\"text-lg font-semibold mb-4\">{t('home.footer.quickLinks.title')}</h4>\r\n              <ul className=\"space-y-2 text-gray-400\">\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.quickLinks.aboutUs')}</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.quickLinks.ourServices')}</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.quickLinks.ourTeam')}</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.quickLinks.patientPortal')}</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.quickLinks.insurance')}</a></li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Services */}\r\n            <div>\r\n              <h4 className=\"text-lg font-semibold mb-4\">Our Services</h4>\r\n              <ul className=\"space-y-2 text-gray-400\">\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">Laser Dental Treatment</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">Dental Implants</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">Root Canal Treatment</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">Teeth Whitening</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">Pediatric Dentistry</a></li>\r\n                <li><a href=\"#\" className=\"hover:text-white transition-colors\">Oral Surgery</a></li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Contact Info */}\r\n            <div>\r\n              <h4 className=\"text-lg font-semibold mb-4\">Contact Information</h4>\r\n              <div className=\"space-y-3 text-gray-400\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Phone className=\"w-4 h-4\" />\r\n                  <a href=\"tel:+201017848825\" className=\"hover:text-white transition-colors\">\r\n                    +201017848825\r\n                  </a>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Mail className=\"w-4 h-4\" />\r\n                  <a href=\"mailto:info@cleardentalcenters.com\" className=\"hover:text-white transition-colors\">\r\n                    info@cleardentalcenters.com\r\n                  </a>\r\n                </div>\r\n                <div className=\"flex items-start gap-2\">\r\n                  <MapPin className=\"w-4 h-4 mt-1\" />\r\n                  <div>\r\n                    <p className=\"mb-2\">Attsa Branch: In front of Attsa Preparatory School, Attsa, Fayoum</p>\r\n                    <p>Fayoum Branch: Al-Nabawi Street, in front of General Hospital, Fayoum</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Clock className=\"w-4 h-4\" />\r\n                  <div>\r\n                    <p>Sun-Thu: 12:00 PM - 11:00 PM</p>\r\n                    <p>Sat: 12:00 PM - 11:00 PM</p>\r\n                    <p className=\"text-red-400\">Friday: Closed</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"border-t border-gray-800 pt-8\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-center gap-4\">\r\n              <p className=\"text-gray-400 text-sm\">\r\n                 2024 Clear Dental Centers. All rights reserved. | Dr. Gamal Abdel Nasser Center for Laser Dental Implants and Aesthetics\r\n              </p>\r\n              <div className=\"flex gap-6 text-sm text-gray-400\">\r\n                <a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.privacyPolicy')}</a>\r\n                <a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.termsOfService')}</a>\r\n                <a href=\"#\" className=\"hover:text-white transition-colors\">{t('home.footer.hipaaNotice')}</a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </footer>\r\n\r\n      {/* Chat Widget */}\r\n      <div className=\"fixed bottom-6 right-6 z-50\">\r\n        <Button className=\"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg\">\r\n          <MessageCircle className=\"w-6 h-6\" />\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\MultiClinicDashboard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\MultiClinicDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\Privacy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\ServiceDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\Services.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":207,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":207,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7851,7854],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7851,7854],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { Button, Badge } from '../components/ui';\nimport ServicesSection from '../components/homepage/ServicesSection';\nimport { servicesService } from '../services/servicesService';\nimport type { Service, ServiceCategory } from '../types/services';\nimport {\n  Search,\n  Grid,\n  List,\n  TrendingUp,\n  Sparkles,\n  Calendar,\n  Phone,\n  MessageCircle\n} from 'lucide-react';\n\nconst Services: React.FC = () => {\n  const [searchParams, setSearchParams] = useSearchParams();\n  \n  // State for filters and view\n  const [selectedCategory, setSelectedCategory] = useState(searchParams.get('category') || 'all');\n  const [searchTerm, setSearchTerm] = useState(searchParams.get('search') || '');\n  const [selectedLocation, setSelectedLocation] = useState(searchParams.get('location') || '');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  const [sortBy, setSortBy] = useState<'name' | 'rating' | 'price' | 'popular'>('popular');\n  \n  // Get data from service\n  const [_services, setServices] = useState<Service[]>([]);\n  const [categories, setCategories] = useState<ServiceCategory[]>([]);\n  const [stats, setStats] = useState(servicesService.getServiceStats());\n  const [loading, setLoading] = useState(true);\n\n  // Load data on component mount\n  useEffect(() => {\n    setLoading(true);\n    try {\n      const allServices = servicesService.getAllServices();\n      const allCategories = servicesService.getAllCategories();\n      \n      setServices(allServices);\n      setCategories(allCategories);\n      setStats(servicesService.getServiceStats());\n    } catch (error) {\n      console.error('Error loading services:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // Update URL params when filters change\n  useEffect(() => {\n    const params = new URLSearchParams();\n    if (selectedCategory !== 'all') params.set('category', selectedCategory);\n    if (searchTerm) params.set('search', searchTerm);\n    if (selectedLocation) params.set('location', selectedLocation);\n    \n    setSearchParams(params);\n  }, [selectedCategory, searchTerm, selectedLocation, setSearchParams]);\n\n  // Filter and sort services\n  const filteredAndSortedServices = React.useMemo(() => {\n    const filtered = servicesService.filterServices({\n      category: selectedCategory,\n      searchTerm,\n      location: selectedLocation\n    });\n\n    // Sort services\n    switch (sortBy) {\n      case 'name':\n        filtered.sort((a, b) => a.title.localeCompare(b.title));\n        break;\n      case 'rating':\n        filtered.sort((a, b) => b.rating - a.rating);\n        break;\n      case 'price':\n        // Simple price sorting (would need more sophisticated logic for real pricing)\n        filtered.sort((a, b) => {\n          const priceA = parseInt(a.price.replace(/[^0-9]/g, '')) || 0;\n          const priceB = parseInt(b.price.replace(/[^0-9]/g, '')) || 0;\n          return priceA - priceB;\n        });\n        break;\n      case 'popular':\n      default:\n        filtered.sort((a, b) => {\n          if (a.isPopular && !b.isPopular) return -1;\n          if (!a.isPopular && b.isPopular) return 1;\n          return b.rating - a.rating;\n        });\n        break;\n    }\n\n    return filtered;\n  }, [selectedCategory, searchTerm, selectedLocation, sortBy]);\n\n  const handleCategoryChange = (categoryId: string) => {\n    setSelectedCategory(categoryId);\n  };\n\n  const handleLocationChange = (location: string) => {\n    setSelectedLocation(location);\n  };\n\n  const clearAllFilters = () => {\n    setSelectedCategory('all');\n    setSearchTerm('');\n    setSelectedLocation('');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading services...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Hero Section */}\n      <section className=\"bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-16\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <h1 className=\"text-4xl md:text-5xl font-bold mb-6\">\n              Our Dental Services\n            </h1>\n            <p className=\"text-xl mb-8 opacity-90\">\n              Comprehensive dental care with modern technology and expert professionals\n            </p>\n            \n            {/* Quick Stats */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6 mt-12\">\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold mb-2\">{stats.totalServices}</div>\n                <div className=\"text-blue-200\">Services</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold mb-2\">{stats.averageRating}</div>\n                <div className=\"text-blue-200\">Avg Rating</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold mb-2\">{stats.totalReviews}</div>\n                <div className=\"text-blue-200\">Reviews</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold mb-2\">2</div>\n                <div className=\"text-blue-200\">Locations</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Filters and Controls */}\n      <section className=\"bg-white border-b sticky top-0 z-40 shadow-sm\">\n        <div className=\"container mx-auto px-4 py-6\">\n          <div className=\"flex flex-col lg:flex-row gap-4 items-center justify-between\">\n            {/* Search and Filters */}\n            <div className=\"flex flex-col md:flex-row gap-4 flex-1\">\n              {/* Search */}\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n                <input\n                  type=\"text\"\n                  placeholder=\"Search services...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n\n              {/* Category Filter */}\n              <select\n                value={selectedCategory}\n                onChange={(e) => handleCategoryChange(e.target.value)}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              >\n                {categories.map((category) => (\n                  <option key={category.id} value={category.id}>\n                    {category.name}\n                  </option>\n                ))}\n              </select>\n\n              {/* Location Filter */}\n              <select\n                value={selectedLocation}\n                onChange={(e) => handleLocationChange(e.target.value)}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              >\n                <option value=\"\">All Locations</option>\n                <option value=\"Fayoum\">Fayoum</option>\n                <option value=\"Attsa\">Attsa</option>\n              </select>\n            </div>\n\n            {/* View Controls */}\n            <div className=\"flex items-center gap-4\">\n              {/* Sort */}\n              <select\n                value={sortBy}\n                onChange={(e) => setSortBy(e.target.value as any)}\n                className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\n              >\n                <option value=\"popular\">Most Popular</option>\n                <option value=\"name\">Name A-Z</option>\n                <option value=\"rating\">Highest Rated</option>\n                <option value=\"price\">Price Low-High</option>\n              </select>\n\n              {/* View Mode Toggle */}\n              <div className=\"flex border border-gray-300 rounded-lg overflow-hidden\">\n                <button\n                  onClick={() => setViewMode('grid')}\n                  className={`p-2 ${viewMode === 'grid' ? 'bg-blue-600 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}\n                >\n                  <Grid className=\"w-4 h-4\" />\n                </button>\n                <button\n                  onClick={() => setViewMode('list')}\n                  className={`p-2 ${viewMode === 'list' ? 'bg-blue-600 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}\n                >\n                  <List className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Active Filters */}\n          {(selectedCategory !== 'all' || searchTerm || selectedLocation) && (\n            <div className=\"flex flex-wrap gap-2 mt-4\">\n              {selectedCategory !== 'all' && (\n                <Badge className=\"bg-blue-100 text-blue-800 px-3 py-1 rounded-full flex items-center gap-2\">\n                  {categories.find(cat => cat.id === selectedCategory)?.name}\n                  <button\n                    onClick={() => setSelectedCategory('all')}\n                    className=\"hover:bg-blue-200 rounded-full p-0.5\"\n                  >\n                    \n                  </button>\n                </Badge>\n              )}\n              {searchTerm && (\n                <Badge className=\"bg-gray-100 text-gray-800 px-3 py-1 rounded-full flex items-center gap-2\">\n                  Search: \"{searchTerm}\"\n                  <button\n                    onClick={() => setSearchTerm('')}\n                    className=\"hover:bg-gray-200 rounded-full p-0.5\"\n                  >\n                    \n                  </button>\n                </Badge>\n              )}\n              {selectedLocation && (\n                <Badge className=\"bg-green-100 text-green-800 px-3 py-1 rounded-full flex items-center gap-2\">\n                  Location: {selectedLocation}\n                  <button\n                    onClick={() => setSelectedLocation('')}\n                    className=\"hover:bg-green-200 rounded-full p-0.5\"\n                  >\n                    \n                  </button>\n                </Badge>\n              )}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={clearAllFilters}\n                className=\"text-xs\"\n              >\n                Clear All\n              </Button>\n            </div>\n          )}\n        </div>\n      </section>\n\n      {/* Services Content */}\n      <section className=\"py-12\">\n        <div className=\"container mx-auto px-4\">\n          {/* Results Header */}\n          <div className=\"flex items-center justify-between mb-8\">\n            <div>\n              <h2 className=\"text-2xl font-bold text-gray-900\">\n                {filteredAndSortedServices.length} Services Found\n              </h2>\n              <p className=\"text-gray-600 mt-1\">\n                {selectedCategory !== 'all' && `in ${categories.find(cat => cat.id === selectedCategory)?.name}`}\n                {selectedLocation && ` at ${selectedLocation}`}\n              </p>\n            </div>\n\n            {/* Popular and New Services Quick Links */}\n            <div className=\"hidden md:flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => {\n                  setSelectedCategory('all');\n                  setSortBy('popular');\n                }}\n                className=\"flex items-center gap-2\"\n              >\n                <TrendingUp className=\"w-4 h-4\" />\n                Popular\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => {\n                  setSelectedCategory('all');\n                  setSearchTerm('');\n                  // Filter to show only new services\n                }}\n                className=\"flex items-center gap-2\"\n              >\n                <Sparkles className=\"w-4 h-4\" />\n                New\n              </Button>\n            </div>\n          </div>\n\n          {/* Services Grid/List */}\n          {filteredAndSortedServices.length > 0 ? (\n            <ServicesSection \n              showFilters={false}\n              showBookingIntegration={true}\n            />\n          ) : (\n            <div className=\"text-center py-16\">\n              <div className=\"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center\">\n                <Search className=\"w-8 h-8 text-gray-400\" />\n              </div>\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No services found</h3>\n              <p className=\"text-gray-600 mb-6\">\n                Try adjusting your search terms or filters to find what you're looking for.\n              </p>\n              <Button onClick={clearAllFilters}>\n                Clear All Filters\n              </Button>\n            </div>\n          )}\n        </div>\n      </section>\n\n      {/* Call to Action */}\n      <section className=\"py-16 bg-gradient-to-r from-blue-600 to-indigo-700 text-white\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <h2 className=\"text-3xl font-bold mb-6\">Ready to Book Your Appointment?</h2>\n          <p className=\"text-xl mb-8 max-w-3xl mx-auto opacity-90\">\n            Our experienced team is ready to provide you with the highest quality dental care.\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <Button size=\"lg\" className=\"bg-white text-blue-600 hover:bg-gray-100 px-8 py-4\">\n              <Calendar className=\"w-5 h-5 mr-2\" />\n              Book Appointment\n            </Button>\n            <Button size=\"lg\" variant=\"outline\" className=\"border-white text-white hover:bg-white hover:text-blue-600 px-8 py-4\">\n              <Phone className=\"w-5 h-5 mr-2\" />\n              Call Now: +201017848825\n            </Button>\n            <Button size=\"lg\" variant=\"outline\" className=\"border-white text-white hover:bg-white hover:text-blue-600 px-8 py-4\">\n              <MessageCircle className=\"w-5 h-5 mr-2\" />\n              WhatsApp\n            </Button>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n};\n\nexport default Services;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\Terms.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\admin\\AdminClinicDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1018,1021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1018,1021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchClinicsWithData'. Either include it or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":58,"suggestions":[{"desc":"Update the dependencies array to be: [isAdmin, currentPage, searchTerm, filterBy, sortBy, fetchClinicsWithData]","fix":{"range":[2342,2394],"text":"[isAdmin, currentPage, searchTerm, filterBy, sortBy, fetchClinicsWithData]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentPage' and 'fetchClinicsWithData'. Either include them or remove the dependency array.","line":99,"column":6,"nodeType":"ArrayExpression","endLine":99,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, fetchClinicsWithData, searchTerm]","fix":{"range":[2662,2674],"text":"[currentPage, fetchClinicsWithData, searchTerm]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3298,3301],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3298,3301],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4039,4042],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4039,4042],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'error'. Either include it or remove the dependency array.","line":173,"column":6,"nodeType":"ArrayExpression","endLine":173,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [error]","fix":{"range":[5133,5135],"text":"[error]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Card, Button, Input, Alert, Select } from '../../components/ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport adminService from '../../services/adminService';\nimport { \n  BarChart3, \n  Users, \n  DollarSign, \n  Calendar, \n  Search, \n  Filter, \n  Eye, \n  RefreshCw,\n  TrendingUp,\n  TrendingDown,\n  Activity,\n  CheckCircle,\n  Clock,\n  Building2,\n  Plus,\n  Settings,\n  Download,\n} from 'lucide-react';\nimport type { Clinic } from '../../types';\nimport { useTranslation } from 'react-i18next';\n\ninterface ClinicStatistics {\n  totalPatients: number;\n  totalAppointments: number;\n  totalRevenue: number;\n  activePatients: number;\n  completedAppointments: number;\n  cancelledAppointments: number;\n  averageRating: number;\n}\n\ninterface ClinicData {\n  clinic: Clinic;\n  statistics: ClinicStatistics | null;\n  patientCount: number;\n  appointmentCount: number;\n  revenue: number;\n  detailedData?: any;\n}\n\ninterface PaginationData {\n  currentPage: number;\n  totalPages: number;\n  totalItems: number;\n  itemsPerPage: number;\n}\n\ntype SortOption = 'name' | 'patients' | 'revenue' | 'appointments';\ntype FilterOption = 'all' | 'active' | 'inactive';\n\nconst AdminClinicDashboard: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [clinicData, setClinicData] = useState<ClinicData[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [sortBy, setSortBy] = useState<SortOption>('name');\n  const [filterBy, setFilterBy] = useState<FilterOption>('all');\n  const [showDetailModal, setShowDetailModal] = useState(false);\n  const [selectedClinicDetail, setSelectedClinicDetail] = useState<ClinicData | null>(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pagination, setPagination] = useState<PaginationData>({\n    currentPage: 1,\n    totalPages: 1,\n    totalItems: 0,\n    itemsPerPage: 10\n  });\n  const [refreshing, setRefreshing] = useState(false);\n\n  const isAdmin = useMemo(() => \n    user?.role === 'admin' || user?.role === 'super_admin', \n    [user?.role]\n  );\n\n  useEffect(() => {\n    if (isAdmin) {\n      fetchClinicsWithData();\n    }\n  }, [isAdmin, currentPage, searchTerm, filterBy, sortBy]);\n\n  // Debounced search effect\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      if (currentPage !== 1) {\n        setCurrentPage(1);\n      } else {\n        fetchClinicsWithData();\n      }\n    }, 300);\n\n    return () => clearTimeout(timeoutId);\n  }, [searchTerm]);\n\n  const fetchClinicsWithData = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const params = {\n        page: currentPage,\n        limit: pagination.itemsPerPage,\n        search: searchTerm.trim(),\n        status: filterBy,\n        sortBy: sortBy\n      };\n      \n      const response = await adminService.getAdminClinicOverview(params);\n      \n      if (response.success && response.data) {\n        const clinicsArray = response.data.data || [];\n        \n        // Transform data to match ClinicData interface\n        const transformedData = clinicsArray.map((clinicData: any) => ({\n          clinic: clinicData.clinic,\n          statistics: clinicData.statistics,\n          patientCount: clinicData.statistics?.patients?.total || 0,\n          appointmentCount: clinicData.statistics?.appointments?.total || 0,\n          revenue: clinicData.statistics?.billing?.totalRevenue || 0\n        }));\n        \n        setClinicData(transformedData);\n        setPagination({\n          currentPage: response.data.currentPage || 1,\n          totalPages: response.data.totalPages || 1,\n          totalItems: response.data.totalItems || 0,\n          itemsPerPage: response.data.itemsPerPage || 10\n        });\n      } else {\n        throw new Error(response.message || 'Failed to fetch clinic data');\n      }\n    } catch (err: any) {\n      console.error('Error fetching clinic data:', err);\n      setError(err.message || 'Failed to fetch clinic data. Please try again.');\n      setClinicData([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [currentPage, searchTerm, filterBy, sortBy, pagination.itemsPerPage]);\n\n  const handleRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await fetchClinicsWithData();\n    setRefreshing(false);\n  }, [fetchClinicsWithData]);\n\n\n\n  const viewClinicDetails = useCallback(async (clinicData: ClinicData) => {\n    try {\n      setError(null);\n      const response = await adminService.getClinicDetailedData(clinicData.clinic.id);\n      \n      if (response.success && response.data) {\n        setSelectedClinicDetail({\n          ...clinicData,\n          detailedData: response.data\n        });\n        setShowDetailModal(true);\n      } else {\n        setError('Failed to fetch clinic details');\n      }\n    } catch (_error) {\n      console.error('Error fetching clinic details:', error);\n      setError('Failed to fetch clinic details. Please try again.');\n    }\n  }, []);\n\n  const filteredAndSortedClinics = useMemo(() => {\n    return clinicData\n      .filter(data => {\n        const searchLower = searchTerm.toLowerCase().trim();\n        if (!searchLower) return true;\n        \n        const matchesSearch = \n          data.clinic.name.toLowerCase().includes(searchLower) ||\n          data.clinic.address?.city?.toLowerCase().includes(searchLower) ||\n          data.clinic.address?.state?.toLowerCase().includes(searchLower) ||\n          data.clinic.email?.toLowerCase().includes(searchLower) ||\n          data.clinic.phone?.includes(searchTerm.trim());\n        \n        const matchesFilter = filterBy === 'all' || \n                             (filterBy === 'active' && data.clinic.isActive) ||\n                             (filterBy === 'inactive' && !data.clinic.isActive);\n        \n        return matchesSearch && matchesFilter;\n      })\n      .sort((a, b) => {\n        switch (sortBy) {\n          case 'name':\n            return a.clinic.name.localeCompare(b.clinic.name);\n          case 'patients':\n            return b.patientCount - a.patientCount;\n          case 'revenue':\n            return b.revenue - a.revenue;\n          case 'appointments':\n            return b.appointmentCount - a.appointmentCount;\n          default:\n            return 0;\n        }\n      });\n  }, [clinicData, searchTerm, filterBy, sortBy]);\n\n  const totalStats = useMemo(() => {\n    return clinicData.reduce(\n      (acc, data) => ({\n        totalClinics: acc.totalClinics + 1,\n        totalPatients: acc.totalPatients + (data.patientCount || 0),\n        totalRevenue: acc.totalRevenue + (data.revenue || 0),\n        totalAppointments: acc.totalAppointments + (data.appointmentCount || 0)\n      }),\n      { totalClinics: 0, totalPatients: 0, totalRevenue: 0, totalAppointments: 0 }\n    );\n  }, [clinicData]);\n\n  const handlePageChange = useCallback((newPage: number) => {\n    setCurrentPage(newPage);\n  }, []);\n\n  const handleSortChange = useCallback((newSort: SortOption) => {\n    setSortBy(newSort);\n    setCurrentPage(1);\n  }, []);\n\n  const handleFilterChange = useCallback((newFilter: FilterOption) => {\n    setFilterBy(newFilter);\n    setCurrentPage(1);\n  }, []);\n\n  const handleSearchChange = useCallback((value: string) => {\n    setSearchTerm(value);\n  }, []);\n\n  if (!isAdmin) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <div className=\"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center\">\n            <svg className=\"w-8 h-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n            </svg>\n          </div>\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('admin_dashboard.access_denied')}</h1>\n          <p className=\"text-gray-600 mb-6\">{t('admin_dashboard.access_denied_message')}</p>\n          <div className=\"space-y-3\">\n            <Link to=\"/dashboard\" className=\"block\">\n              <Button variant=\"primary\" className=\"w-full\">{t('admin_dashboard.go_to_dashboard')}</Button>\n            </Link>\n            <Link to=\"/\" className=\"block\">\n              <Button variant=\"outline\" className=\"w-full\">{t('admin_dashboard.go_to_home')}</Button>\n            </Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (loading && clinicData.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <h2 className=\"text-xl font-semibold text-gray-700 mb-2\">{t('admin_dashboard.loading_clinics')}</h2>\n          <p className=\"text-gray-500\">{t('admin_dashboard.failed_to_fetch_clinic_data')}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error && clinicData.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <div className=\"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center\">\n            <svg className=\"w-8 h-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </div>\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('admin_dashboard.error_loading_data')}</h1>\n          <p className=\"text-gray-600 mb-6\">{error}</p>\n          <div className=\"space-y-3\">\n            <Button \n              onClick={handleRefresh} \n              variant=\"primary\" \n              className=\"w-full flex items-center justify-center gap-2\"\n              disabled={refreshing}\n            >\n              <RefreshCw className={refreshing ? 'animate-spin' : ''} />\n              {refreshing ? t('admin_dashboard.retrying') : t('admin_dashboard.try_again')}\n            </Button>\n            <Link to=\"/dashboard\" className=\"block\">\n              <Button variant=\"outline\" className=\"w-full\">{t('admin_dashboard.go_to_dashboard')}</Button>\n            </Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n      {/* Enhanced Header */}\n      <div className=\"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 shadow-xl border-b border-blue-800/50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex flex-col lg:flex-row lg:justify-between lg:items-center space-y-4 lg:space-y-0\">\n            {/* Left Section */}\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"relative\">\n                <div className=\"p-3 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-xl shadow-lg\">\n                  <BarChart3 className=\"w-8 h-8 text-white\" />\n                </div>\n                <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white animate-pulse\"></div>\n              </div>\n              <div>\n                <h1 className=\"text-2xl lg:text-3xl font-bold text-white\">{t('admin_dashboard.title')}</h1>\n                <p className=\"text-blue-100/80 text-sm lg:text-base\">Comprehensive clinic management and analytics</p>\n                <div className=\"flex items-center space-x-4 mt-2 text-xs text-blue-200/70\">\n                  <span className=\"flex items-center space-x-1\">\n                    <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n                    <span>System Online</span>\n                  </span>\n                  <span className=\"flex items-center space-x-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    <span>Last updated: {new Date().toLocaleTimeString()}</span>\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Right Section */}\n            <div className=\"flex items-center space-x-3\">\n              <Button \n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={refreshing}\n                className=\"bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30\"\n              >\n                <RefreshCw className={`w-4 h-4 mr-2 ${refreshing ? 'animate-spin' : ''}`} />\n                {refreshing ? t('admin_dashboard.refreshing') : t('admin_dashboard.refresh_data')}\n              </Button>\n              <Link to=\"/admin/multi-clinic\">\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  className=\"bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30\"\n                >\n                  <Activity className=\"w-4 h-4 mr-2\" />\n                  {t('admin_dashboard.multi_clinic_dashboard')}\n                </Button>\n              </Link>\n              <Link to=\"/clinics\">\n                <Button \n                  variant=\"primary\" \n                  size=\"sm\"\n                  className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200\"\n                >\n                  <Building2 className=\"w-4 h-4 mr-2\" />\n                  {t('admin_dashboard.manage_clinics')}\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n\n      {error && (\n        <Alert variant=\"error\" className=\"mb-4\">\n          {error}\n        </Alert>\n      )}\n\n        {/* Overall Statistics */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"p-6 hover:shadow-xl transition-all duration-300 border-0 bg-gradient-to-br from-white to-blue-50/50 backdrop-blur-sm group\">\n            <div className=\"text-center\">\n              <div className=\"flex justify-center mb-4\">\n                <div className=\"p-4 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-lg group-hover:shadow-xl transition-shadow\">\n                  <Building2 className=\"w-8 h-8 text-white\" />\n                </div>\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">{t('admin_dashboard.total_clinics')}</h3>\n              <p className=\"text-3xl font-bold text-blue-600 mb-2\">\n                {loading ? (\n                  <div className=\"animate-pulse bg-gray-200 h-8 w-16 rounded mx-auto\"></div>\n                ) : (\n                  totalStats.totalClinics.toLocaleString()\n                )}\n              </p>\n              <div className=\"flex items-center justify-center space-x-1 text-sm text-green-600\">\n                <TrendingUp className=\"w-4 h-4\" />\n                <span>+12% this month</span>\n              </div>\n            </div>\n          </Card>\n          <Card className=\"p-6 hover:shadow-xl transition-all duration-300 border-0 bg-gradient-to-br from-white to-green-50/50 backdrop-blur-sm group\">\n            <div className=\"text-center\">\n              <div className=\"flex justify-center mb-4\">\n                <div className=\"p-4 bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg group-hover:shadow-xl transition-shadow\">\n                  <Users className=\"w-8 h-8 text-white\" />\n                </div>\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">{t('admin_dashboard.total_patients')}</h3>\n              <p className=\"text-3xl font-bold text-green-600 mb-2\">\n                {loading ? (\n                  <div className=\"animate-pulse bg-gray-200 h-8 w-20 rounded mx-auto\"></div>\n                ) : (\n                  totalStats.totalPatients.toLocaleString()\n                )}\n              </p>\n              <div className=\"flex items-center justify-center space-x-1 text-sm text-green-600\">\n                <TrendingUp className=\"w-4 h-4\" />\n                <span>+8% this month</span>\n              </div>\n            </div>\n          </Card>\n          <Card className=\"p-6 hover:shadow-xl transition-all duration-300 border-0 bg-gradient-to-br from-white to-purple-50/50 backdrop-blur-sm group\">\n            <div className=\"text-center\">\n              <div className=\"flex justify-center mb-4\">\n                <div className=\"p-4 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow-lg group-hover:shadow-xl transition-shadow\">\n                  <DollarSign className=\"w-8 h-8 text-white\" />\n                </div>\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">{t('admin_dashboard.total_revenue')}</h3>\n              <p className=\"text-3xl font-bold text-purple-600 mb-2\">\n                {loading ? (\n                  <div className=\"animate-pulse bg-gray-200 h-8 w-24 rounded mx-auto\"></div>\n                ) : (\n                  `$${totalStats.totalRevenue.toLocaleString()}`\n                )}\n              </p>\n              <div className=\"flex items-center justify-center space-x-1 text-sm text-green-600\">\n                <TrendingUp className=\"w-4 h-4\" />\n                <span>+15% this month</span>\n              </div>\n            </div>\n          </Card>\n          <Card className=\"p-6 hover:shadow-xl transition-all duration-300 border-0 bg-gradient-to-br from-white to-orange-50/50 backdrop-blur-sm group\">\n            <div className=\"text-center\">\n              <div className=\"flex justify-center mb-4\">\n                <div className=\"p-4 bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl shadow-lg group-hover:shadow-xl transition-shadow\">\n                  <Calendar className=\"w-8 h-8 text-white\" />\n                </div>\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">{t('admin_dashboard.total_appointments')}</h3>\n              <p className=\"text-3xl font-bold text-orange-600 mb-2\">\n                {loading ? (\n                  <div className=\"animate-pulse bg-gray-200 h-8 w-20 rounded mx-auto\"></div>\n                ) : (\n                  totalStats.totalAppointments.toLocaleString()\n                )}\n              </p>\n              <div className=\"flex items-center justify-center space-x-1 text-sm text-red-600\">\n                <TrendingDown className=\"w-4 h-4\" />\n                <span>-3% this month</span>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Enhanced Filters and Search */}\n        <Card className=\"p-6 mb-8 border-0 shadow-lg bg-gradient-to-br from-white to-gray-50/50\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-xl font-bold text-gray-900 flex items-center gap-2\">\n              <Search className=\"w-5 h-5 text-blue-600\" />\n              Search & Filter Clinics\n            </h2>\n            <div className=\"flex items-center space-x-2 text-sm text-gray-600\">\n              <span>Total: {filteredAndSortedClinics.length} clinics</span>\n            </div>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n              <Input\n                type=\"text\"\n                placeholder={t('admin_dashboard.search_placeholder')}\n                value={searchTerm}\n                onChange={(e) => handleSearchChange(e.target.value)}\n                className=\"pl-10 h-12 border-gray-200 focus:border-blue-500 focus:ring-blue-500 rounded-xl\"\n              />\n            </div>\n            <div className=\"relative\">\n              <Filter className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n              <Select\n                value={sortBy}\n                onChange={(e) => handleSortChange(e.target.value as SortOption)}\n                className=\"pl-10 h-12 border-gray-200 focus:border-blue-500 focus:ring-blue-500 rounded-xl appearance-none\"\n                options={[\n                  { value: 'name', label: t('admin_dashboard.sort_by_name') },\n                  { value: 'patients', label: t('admin_dashboard.sort_by_patients') },\n                  { value: 'revenue', label: t('admin_dashboard.sort_by_revenue') },\n                  { value: 'appointments', label: t('admin_dashboard.sort_by_appointments') }\n                ]}\n              />\n            </div>\n            <div className=\"relative\">\n              <Activity className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n              <Select\n                value={filterBy}\n                onChange={(e) => handleFilterChange(e.target.value as FilterOption)}\n                className=\"pl-10 h-12 border-gray-200 focus:border-blue-500 focus:ring-blue-500 rounded-xl appearance-none\"\n                options={[\n                  { value: 'all', label: t('admin_dashboard.all_clinics') },\n                  { value: 'active', label: t('admin_dashboard.active_only') },\n                  { value: 'inactive', label: t('admin_dashboard.inactive_only') }\n                ]}\n              />\n            </div>\n          </div>\n        </Card>\n\n        {/* Enhanced Clinics Table */}\n        <Card className=\"overflow-hidden border-0 shadow-lg bg-gradient-to-br from-white to-gray-50/50\">\n          <div className=\"p-6 border-b border-gray-100\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-xl font-bold text-gray-900 flex items-center gap-2\">\n                <Building2 className=\"w-5 h-5 text-blue-600\" />\n                Clinic Management\n              </h2>\n              <div className=\"flex items-center space-x-3\">\n                <Link to=\"/clinics/create\">\n                  <Button \n                    variant=\"primary\" \n                    size=\"sm\"\n                    className=\"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200\"\n                  >\n                    <Plus className=\"w-4 h-4 mr-2\" />\n                    Add Clinic\n                  </Button>\n                </Link>\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  onClick={() => console.log('Export clicked')}\n                  className=\"border-gray-200 hover:border-blue-500 hover:text-blue-600\"\n                >\n                  <Download className=\"w-4 h-4 mr-2\" />\n                  Export\n                </Button>\n              </div>\n            </div>\n          </div>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead className=\"bg-gradient-to-r from-gray-50 to-blue-50/50\">\n                <tr>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <Building2 className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.clinic')}</span>\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <Activity className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.location')}</span>\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <Users className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.patients')}</span>\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <Calendar className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.appointments')}</span>\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <DollarSign className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.revenue')}</span>\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.status')}</span>\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">\n                    <div className=\"flex items-center space-x-1\">\n                      <Settings className=\"w-4 h-4\" />\n                      <span>{t('admin_dashboard.actions')}</span>\n                    </div>\n                  </th>\n                </tr>\n              </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {filteredAndSortedClinics.length === 0 ? (\n                <tr>\n                  <td colSpan={7} className=\"px-6 py-8 text-center text-gray-500\">\n                    {loading ? (\n                      <div className=\"flex items-center justify-center\">\n                        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                        {t('admin_dashboard.loading_clinics')}\n                      </div>\n                    ) : searchTerm || filterBy !== 'all' ? (\n                      <div>\n                        <p className=\"text-lg font-medium\">{t('admin_dashboard.no_clinics_found')}</p>\n                        <p className=\"text-sm mt-1\">{t('admin_dashboard.try_again')}</p>\n                      </div>\n                    ) : (\n                      <div>\n                        <p className=\"text-lg font-medium\">{t('admin_dashboard.no_clinics_available')}</p>\n                        <p className=\"text-sm mt-1\">{t('admin_dashboard.failed_to_fetch_clinic_data')}</p>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ) : (\n                filteredAndSortedClinics.map((data) => (\n                  <tr key={data.clinic.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">{data.clinic.name}</div>\n                      <div className=\"text-sm text-gray-500\">{data.clinic.email}</div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-900\">\n                      {data.clinic.address.city}, {data.clinic.address.state}\n                    </div>\n                    <div className=\"text-sm text-gray-500\">{data.clinic.phone}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {data.patientCount}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {data.appointmentCount}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    ${data.revenue.toLocaleString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                      data.clinic.isActive \n                        ? 'bg-green-100 text-green-800' \n                        : 'bg-red-100 text-red-800'\n                    }`}>\n                      {data.clinic.isActive ? t('admin_dashboard.active') : t('admin_dashboard.inactive')}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    <div className=\"flex space-x-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => viewClinicDetails(data)}\n                        className=\"flex items-center gap-1\"\n                      >\n                        <Eye /> {t('admin_dashboard.view_details')}\n                      </Button>\n                      <Link to={`/clinics/${data.clinic.id}/dashboard`}>\n                        <Button variant=\"outline\" size=\"sm\">\n                          {t('admin_dashboard.dashboard')}\n                        </Button>\n                      </Link>\n                    </div>\n                  </td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n        \n        {/* Pagination */}\n        {pagination.totalPages > 1 && (\n          <div className=\"flex justify-between items-center mt-6 px-6 py-4 bg-gray-50\">\n            <div className=\"text-sm text-gray-600\">\n              Showing {((pagination.currentPage - 1) * pagination.itemsPerPage) + 1} to{' '}\n              {Math.min(pagination.currentPage * pagination.itemsPerPage, pagination.totalItems)} of{' '}\n              {pagination.totalItems} clinics\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <Button\n                onClick={() => handlePageChange(Math.max(pagination.currentPage - 1, 1))}\n                disabled={pagination.currentPage === 1 || loading}\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                {t('admin_dashboard.previous')}\n              </Button>\n              \n              {/* Page numbers */}\n              <div className=\"flex items-center space-x-1\">\n                {Array.from({ length: Math.min(5, pagination.totalPages) }, (_, i) => {\n                  let pageNum;\n                  if (pagination.totalPages <= 5) {\n                    pageNum = i + 1;\n                  } else if (pagination.currentPage <= 3) {\n                    pageNum = i + 1;\n                  } else if (pagination.currentPage >= pagination.totalPages - 2) {\n                    pageNum = pagination.totalPages - 4 + i;\n                  } else {\n                    pageNum = pagination.currentPage - 2 + i;\n                  }\n                  \n                  return (\n                    <Button\n                      key={pageNum}\n                      onClick={() => handlePageChange(pageNum)}\n                      variant={pageNum === pagination.currentPage ? 'primary' : 'outline'}\n                      size=\"sm\"\n                      className=\"w-8 h-8 p-0\"\n                      disabled={loading}\n                    >\n                      {pageNum}\n                    </Button>\n                  );\n                })}\n              </div>\n              \n              <Button\n                onClick={() => handlePageChange(Math.min(pagination.currentPage + 1, pagination.totalPages))}\n                disabled={pagination.currentPage === pagination.totalPages || loading}\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                {t('admin_dashboard.next')}\n              </Button>\n            </div>\n          </div>\n        )}\n      </Card>\n\n      {/* Clinic Detail Modal */}\n      {showDetailModal && selectedClinicDetail && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden\">\n            {/* Modal Header */}\n            <div className=\"flex justify-between items-center p-6 border-b border-gray-200\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-gray-900\">\n                  {selectedClinicDetail.clinic.name}\n                </h2>\n                <p className=\"text-sm text-gray-500 mt-1\">{t('admin_dashboard.detailed_clinic_overview')}</p>\n              </div>\n              <Button\n                onClick={() => setShowDetailModal(false)}\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"text-gray-400 hover:text-gray-600 border-none\"\n              >\n                \n              </Button>\n            </div>\n\n            {/* Modal Content */}\n            <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-140px)]\">\n              {/* Statistics Cards */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\n                <div className=\"bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200\">\n                  <h3 className=\"text-sm font-medium text-blue-800 mb-1\">{t('admin_dashboard.total_patients')}</h3>\n                  <p className=\"text-2xl font-bold text-blue-600\">\n                    {selectedClinicDetail.patientCount?.toLocaleString() || 0}\n                  </p>\n                </div>\n                <div className=\"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200\">\n                  <h3 className=\"text-sm font-medium text-green-800 mb-1\">{t('admin_dashboard.total_revenue')}</h3>\n                  <p className=\"text-2xl font-bold text-green-600\">\n                    ${(selectedClinicDetail.revenue || 0).toLocaleString()}\n                  </p>\n                </div>\n                <div className=\"bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200\">\n                  <h3 className=\"text-sm font-medium text-purple-800 mb-1\">{t('admin_dashboard.appointments')}</h3>\n                  <p className=\"text-2xl font-bold text-purple-600\">\n                    {selectedClinicDetail.appointmentCount?.toLocaleString() || 0}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Clinic Information */}\n                <div className=\"bg-gray-50 p-6 rounded-lg border\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-4 flex items-center\">\n                    <span className=\"w-2 h-2 bg-blue-500 rounded-full mr-2\"></span>\n                    {t('admin_dashboard.clinic_information')}\n                  </h3>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-xs font-medium text-gray-500 uppercase tracking-wide\">{t('common.email')}</span>\n                      <span className=\"text-sm text-gray-900\">{selectedClinicDetail.clinic.email || t('admin_dashboard.not_provided')}</span>\n                    </div>\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-xs font-medium text-gray-500 uppercase tracking-wide\">{t('common.phone')}</span>\n                      <span className=\"text-sm text-gray-900\">{selectedClinicDetail.clinic.phone || t('admin_dashboard.not_provided')}</span>\n                    </div>\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-xs font-medium text-gray-500 uppercase tracking-wide\">{t('common.address')}</span>\n                      <span className=\"text-sm text-gray-900\">\n                        {selectedClinicDetail.clinic.address ? (\n                          `${selectedClinicDetail.clinic.address.street || ''}, ${selectedClinicDetail.clinic.address.city || ''}, ${selectedClinicDetail.clinic.address.state || ''} ${selectedClinicDetail.clinic.address.zipCode || ''}`.trim().replace(/^,\\s*|,\\s*$/g, '')\n                        ) : (\n                          t('admin_dashboard.not_provided')\n                        )}\n                      </span>\n                    </div>\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-xs font-medium text-gray-500 uppercase tracking-wide\">{t('admin_dashboard.status')}</span>\n                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mt-1 w-fit ${\n                        selectedClinicDetail.clinic.isActive \n                          ? 'bg-green-100 text-green-800' \n                          : 'bg-red-100 text-red-800'\n                      }`}>\n                        <span className={`w-1.5 h-1.5 rounded-full mr-1.5 ${\n                          selectedClinicDetail.clinic.isActive ? 'bg-green-400' : 'bg-red-400'\n                        }`}></span>\n                        {selectedClinicDetail.clinic.isActive ? t('admin_dashboard.active') : t('admin_dashboard.inactive')}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Performance Metrics */}\n                <div className=\"bg-gray-50 p-6 rounded-lg border\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-4 flex items-center\">\n                    <span className=\"w-2 h-2 bg-green-500 rounded-full mr-2\"></span>\n                    {t('admin_dashboard.performance_metrics')}\n                  </h3>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center p-3 bg-white rounded border\">\n                      <span className=\"text-sm text-gray-600\">{t('admin_dashboard.avg_revenue_per_patient')}</span>\n                      <span className=\"text-sm font-semibold text-gray-900\">\n                        ${(selectedClinicDetail.patientCount && selectedClinicDetail.patientCount > 0) \n                          ? ((selectedClinicDetail.revenue || 0) / selectedClinicDetail.patientCount).toFixed(2)\n                          : '0.00'\n                        }\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 bg-white rounded border\">\n                      <span className=\"text-sm text-gray-600\">{t('admin_dashboard.appointments_per_patient')}</span>\n                      <span className=\"text-sm font-semibold text-gray-900\">\n                        {(selectedClinicDetail.patientCount && selectedClinicDetail.patientCount > 0) \n                          ? ((selectedClinicDetail.appointmentCount || 0) / selectedClinicDetail.patientCount).toFixed(1)\n                          : '0.0'\n                        }\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 bg-white rounded border\">\n                      <span className=\"text-sm text-gray-600\">{t('admin_dashboard.revenue_per_appointment')}</span>\n                      <span className=\"text-sm font-semibold text-gray-900\">\n                        ${(selectedClinicDetail.appointmentCount && selectedClinicDetail.appointmentCount > 0) \n                          ? ((selectedClinicDetail.revenue || 0) / selectedClinicDetail.appointmentCount).toFixed(2)\n                          : '0.00'\n                        }\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Additional Details */}\n              {selectedClinicDetail.detailedData && (\n                <div className=\"mt-6 bg-blue-50 p-6 rounded-lg border border-blue-200\">\n                  <h3 className=\"text-lg font-semibold text-blue-800 mb-4\">{t('admin_dashboard.additional_details')}</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                    {Object.entries(selectedClinicDetail.detailedData).map(([key, value]) => (\n                      <div key={key} className=\"flex justify-between\">\n                        <span className=\"text-blue-600 capitalize\">{key.replace(/([A-Z])/g, ' $1').trim()}:</span>\n                        <span className=\"text-blue-800 font-medium\">\n                          {typeof value === 'number' ? value.toLocaleString() : String(value)}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Action Buttons */}\n              <div className=\"flex flex-wrap justify-end gap-3 pt-6 border-t border-gray-200 mt-6\">\n                <Link to={`/patients?clinic=${selectedClinicDetail.clinic.id}`}>\n                  <Button variant=\"outline\" size=\"sm\">{t('admin_dashboard.view_patients')}</Button>\n                </Link>\n                <Link to={`/appointments?clinic=${selectedClinicDetail.clinic.id}`}>\n                  <Button variant=\"outline\" size=\"sm\">{t('admin_dashboard.view_appointments')}</Button>\n                </Link>\n                <Link to={`/billing?clinic=${selectedClinicDetail.clinic.id}`}>\n                  <Button variant=\"outline\" size=\"sm\">{t('admin_dashboard.view_billing')}</Button>\n                </Link>\n                <Link to={`/clinics/${selectedClinicDetail.clinic.id}/edit`}>\n                  <Button variant=\"primary\" size=\"sm\">{t('admin_dashboard.edit_clinic')}</Button>\n                </Link>\n              </div>\n            </div>\n\n            {/* Modal Footer */}\n            <div className=\"flex justify-end p-6 border-t border-gray-200 bg-gray-50\">\n              <Button\n                onClick={() => setShowDetailModal(false)}\n                variant=\"primary\"\n              >\n                {t('admin_dashboard.close')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n    </div>\n  );\n};\n\nexport default AdminClinicDashboard;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\admin\\HomepageContentManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\admin\\ImprovedAdminDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1324,1327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1324,1327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Card, Button, Badge } from '../../components/ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { useTranslation } from 'react-i18next';\nimport { \n  BarChart3, \n  RefreshCw,\n  Plus,\n  Settings,\n  Shield,\n  Activity,\n  TrendingUp,\n  AlertTriangle,\n  CheckCircle,\n  Clock,\n  Database,\n  Server,\n  Wifi,\n  FileText,\n  Download,\n  Code,\n  LifeBuoy,\n  Zap,\n  Globe,\n  Lock,\n  Users as UserManagement,\n  Building2,\n  CreditCard,\n  Mail,\n  MessageSquare,\n  Cloud,\n  Bell,\n  ChevronRight,\n  Home,\n  Menu,\n  X\n} from 'lucide-react';\n\ninterface SystemHealth {\n  uptime: number;\n  responseTime: number;\n  errorRate: number;\n  activeSessions: number;\n  databaseHealth: 'excellent' | 'good' | 'warning' | 'critical';\n  serverLoad: number;\n  memoryUsage: number;\n  diskUsage: number;\n  networkTraffic: number;\n}\n\ninterface SecurityStatus {\n  firewallStatus: 'active' | 'inactive';\n  sslCertificate: 'valid' | 'expired' | 'missing';\n  encryptionStatus: 'enabled' | 'disabled';\n  twoFactorAuth: 'enabled' | 'disabled';\n  failedLogins: number;\n  suspiciousActivity: number;\n  securityEvents: number;\n}\n\ninterface QuickAction {\n  id: string;\n  title: string;\n  description: string;\n  icon: React.ComponentType<any>;\n  action: () => void;\n  variant: 'primary' | 'secondary' | 'outline';\n  badge?: string;\n}\n\ninterface RecentActivity {\n  id: string;\n  type: 'clinic_created' | 'user_registered' | 'appointment_booked' | 'payment_received' | 'system_alert' | 'backup_completed';\n  title: string;\n  description: string;\n  timestamp: Date;\n  severity: 'info' | 'warning' | 'error' | 'success';\n  clinicId?: string;\n  userId?: string;\n}\n\nconst ImprovedAdminDashboard: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  // Mock data - in real app, fetch from API\n  const [systemHealth] = useState<SystemHealth>({\n    uptime: 99.9,\n    responseTime: 245,\n    errorRate: 0.02,\n    activeSessions: 1247,\n    databaseHealth: 'excellent',\n    serverLoad: 45,\n    memoryUsage: 67,\n    diskUsage: 23,\n    networkTraffic: 89\n  });\n\n  const [securityStatus] = useState<SecurityStatus>({\n    firewallStatus: 'active',\n    sslCertificate: 'valid',\n    encryptionStatus: 'enabled',\n    twoFactorAuth: 'enabled',\n    failedLogins: 12,\n    suspiciousActivity: 3,\n    securityEvents: 8\n  });\n\n  const [recentActivity] = useState<RecentActivity[]>([\n    {\n      id: '1',\n      type: 'clinic_created',\n      title: 'New clinic registered',\n      description: 'Dental Care Plus has been registered',\n      timestamp: new Date(Date.now() - 1000 * 60 * 30), // 30 minutes ago\n      severity: 'info'\n    },\n    {\n      id: '2',\n      type: 'payment_received',\n      title: 'Payment received',\n      description: '$2,450 received from Smile Dental Clinic',\n      timestamp: new Date(Date.now() - 1000 * 60 * 60 * 2), // 2 hours ago\n      severity: 'success'\n    },\n    {\n      id: '3',\n      type: 'system_alert',\n      title: 'High server load detected',\n      description: 'Server load reached 85%',\n      timestamp: new Date(Date.now() - 1000 * 60 * 60 * 4), // 4 hours ago\n      severity: 'warning'\n    },\n    {\n      id: '4',\n      type: 'backup_completed',\n      title: 'Backup completed successfully',\n      description: 'Daily backup completed at 2:00 AM',\n      timestamp: new Date(Date.now() - 1000 * 60 * 60 * 6), // 6 hours ago\n      severity: 'success'\n    }\n  ]);\n\n  const isAdmin = useMemo(() => \n    user?.role === 'admin' || user?.role === 'super_admin', \n    [user?.role]\n  );\n\n  useEffect(() => {\n    if (isAdmin) {\n      // Simulate loading\n      setTimeout(() => setLoading(false), 1000);\n    }\n  }, [isAdmin]);\n\n  const handleRefresh = useCallback(async () => {\n    setRefreshing(true);\n    // Simulate refresh\n    setTimeout(() => setRefreshing(false), 2000);\n  }, []);\n\n  const quickActions: QuickAction[] = useMemo(() => [\n    {\n      id: 'add-clinic',\n      title: t('admin_dashboard.add_clinic'),\n      description: 'Register a new clinic',\n      icon: Plus,\n      action: () => window.location.href = '/clinics/create',\n      variant: 'primary'\n    },\n    {\n      id: 'manage-users',\n      title: t('admin_dashboard.manage_users'),\n      description: 'Manage system users',\n      icon: UserManagement,\n      action: () => window.location.href = '/admin/users',\n      variant: 'secondary'\n    },\n    {\n      id: 'system-settings',\n      title: t('admin_dashboard.system_settings'),\n      description: 'Configure system settings',\n      icon: Settings,\n      action: () => window.location.href = '/admin/settings',\n      variant: 'outline'\n    },\n    {\n      id: 'reports-center',\n      title: t('admin_dashboard.reports_center'),\n      description: 'Generate and view reports',\n      icon: FileText,\n      action: () => window.location.href = '/reports',\n      variant: 'outline'\n    },\n    {\n      id: 'backup-restore',\n      title: t('admin_dashboard.backup_restore'),\n      description: 'Manage backups and restores',\n      icon: Download,\n      action: () => window.location.href = '/admin/backup',\n      variant: 'outline'\n    },\n    {\n      id: 'support-center',\n      title: t('admin_dashboard.support_center'),\n      description: 'Get help and support',\n      icon: LifeBuoy,\n      action: () => window.location.href = '/support',\n      variant: 'outline'\n    }\n  ], [t]);\n\n  const getHealthColor = (health: string) => {\n    switch (health) {\n      case 'excellent': return 'text-green-600 bg-green-100';\n      case 'good': return 'text-blue-600 bg-blue-100';\n      case 'warning': return 'text-yellow-600 bg-yellow-100';\n      case 'critical': return 'text-red-600 bg-red-100';\n      default: return 'text-gray-600 bg-gray-100';\n    }\n  };\n\n  const getSeverityIcon = (severity: string) => {\n    switch (severity) {\n      case 'success': return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'warning': return <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />;\n      case 'error': return <AlertTriangle className=\"w-4 h-4 text-red-500\" />;\n      default: return <Activity className=\"w-4 h-4 text-blue-500\" />;\n    }\n  };\n\n\n\n  if (!isAdmin) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <div className=\"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center\">\n            <Shield className=\"w-8 h-8 text-red-600\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('admin_dashboard.access_denied')}</h1>\n          <p className=\"text-gray-600 mb-6\">{t('admin_dashboard.access_denied_message')}</p>\n          <div className=\"space-y-3\">\n            <Link to=\"/dashboard\" className=\"block\">\n              <Button variant=\"primary\" className=\"w-full\">{t('admin_dashboard.go_to_dashboard')}</Button>\n            </Link>\n            <Link to=\"/\" className=\"block\">\n              <Button variant=\"outline\" className=\"w-full\">{t('admin_dashboard.go_to_home')}</Button>\n            </Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <h2 className=\"text-xl font-semibold text-gray-700 mb-2\">Loading Admin Dashboard...</h2>\n          <p className=\"text-gray-500\">Preparing your comprehensive system overview</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Enhanced Header */}\n      <div className=\"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 shadow-lg border-b border-blue-800/50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          {/* Top Bar - Breadcrumbs & Mobile Menu */}\n          <div className=\"flex items-center justify-between py-3 border-b border-blue-800/30\">\n            <div className=\"flex items-center space-x-2 text-sm text-blue-200/70\">\n              <Link to=\"/\" className=\"flex items-center space-x-1 hover:text-blue-300 transition-colors\">\n                <Home className=\"w-4 h-4\" />\n                <span className=\"hidden sm:inline\">Home</span>\n              </Link>\n              <ChevronRight className=\"w-4 h-4\" />\n              <span className=\"text-blue-300 font-medium\">Admin Dashboard</span>\n            </div>\n            \n            {/* Mobile Menu Button */}\n            <button\n              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n              className=\"lg:hidden p-2 rounded-lg bg-white/10 border border-white/20 text-white hover:bg-white/20 transition-colors\"\n            >\n              {mobileMenuOpen ? <X className=\"w-5 h-5\" /> : <Menu className=\"w-5 h-5\" />}\n            </button>\n          </div>\n\n          {/* Main Header Content */}\n          <div className=\"flex flex-col lg:flex-row lg:justify-between lg:items-center py-6 lg:py-8 space-y-4 lg:space-y-0\">\n            {/* Left Section - Brand & Title */}\n            <div className=\"flex items-center space-x-4 lg:space-x-6\">\n              <div className=\"relative\">\n                <div className=\"p-3 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-xl shadow-lg flex-shrink-0 transform hover:scale-105 transition-transform duration-200\">\n                  <BarChart3 className=\"w-7 h-7 lg:w-9 lg:h-9 text-white\" />\n                </div>\n                <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white animate-pulse\"></div>\n              </div>\n              <div className=\"min-w-0 flex-1\">\n                <div className=\"flex items-center space-x-3 mb-1\">\n                  <h1 className=\"text-xl sm:text-2xl lg:text-4xl font-bold text-white truncate\">\n                    {t('admin_dashboard.title')}\n                  </h1>\n                  <div className=\"hidden sm:flex items-center space-x-2\">\n                    <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"></div>\n                    <span className=\"text-green-400 text-sm font-medium\">Live</span>\n                  </div>\n                </div>\n                <p className=\"text-sm lg:text-base text-blue-100/80 hidden sm:block\">\n                  Comprehensive system management and monitoring dashboard\n                </p>\n                <div className=\"flex items-center space-x-4 mt-2 text-xs text-blue-200/70\">\n                  <span className=\"flex items-center space-x-1\">\n                    <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n                    <span>System Online</span>\n                  </span>\n                  <span className=\"flex items-center space-x-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    <span>Last updated: {new Date().toLocaleTimeString()}</span>\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Right Section - Actions & Stats */}\n            <div className=\"flex items-center space-x-3 lg:space-x-4 flex-shrink-0\">\n              {/* Quick Stats */}\n              <div className=\"hidden lg:flex items-center space-x-4 text-white/80\">\n                <div className=\"text-center\">\n                  <div className=\"text-lg font-bold text-green-400\">{systemHealth.uptime}%</div>\n                  <div className=\"text-xs\">Uptime</div>\n                </div>\n                <div className=\"w-px h-8 bg-blue-700\"></div>\n                <div className=\"text-center\">\n                  <div className=\"text-lg font-bold text-blue-400\">{systemHealth.activeSessions.toLocaleString()}</div>\n                  <div className=\"text-xs\">Sessions</div>\n                </div>\n                <div className=\"w-px h-8 bg-blue-700\"></div>\n                <div className=\"text-center\">\n                  <div className=\"text-lg font-bold text-purple-400\">{systemHealth.responseTime}ms</div>\n                  <div className=\"text-xs\">Response</div>\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex items-center space-x-2 lg:space-x-3\">\n                {/* Notifications */}\n                <Button \n                  variant=\"outline\"\n                  className=\"relative flex items-center gap-2 text-sm lg:text-base px-3 lg:px-4 py-2 bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all duration-200\"\n                >\n                  <Bell className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\">Notifications</span>\n                  <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white animate-pulse\"></div>\n                </Button>\n\n                <Button \n                  onClick={handleRefresh} \n                  variant=\"outline\"\n                  disabled={refreshing}\n                  className=\"flex items-center gap-2 text-sm lg:text-base px-3 lg:px-4 py-2 bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all duration-200\"\n                >\n                  <RefreshCw className={`w-4 h-4 ${refreshing ? 'animate-spin' : ''}`} />\n                  <span className=\"hidden sm:inline\">{refreshing ? 'Refreshing...' : 'Refresh'}</span>\n                </Button>\n                \n                <Link to=\"/admin/clinics\">\n                  <Button \n                    variant=\"primary\" \n                    className=\"flex items-center gap-2 text-sm lg:text-base px-4 lg:px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200\"\n                  >\n                    <Building2 className=\"w-4 h-4\" />\n                    <span className=\"hidden sm:inline\">Manage Clinics</span>\n                  </Button>\n                </Link>\n\n                {/* User Profile Dropdown */}\n                <div className=\"relative\">\n                  <Button \n                    variant=\"outline\"\n                    className=\"flex items-center gap-2 text-sm lg:text-base px-3 lg:px-4 py-2 bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all duration-200\"\n                  >\n                    <div className=\"w-6 h-6 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center\">\n                      <span className=\"text-white text-xs font-bold\">\n                        {user?.firstName?.charAt(0) || user?.email?.charAt(0) || 'A'}\n                      </span>\n                    </div>\n                    <span className=\"hidden sm:inline\">{user?.firstName || 'Admin'}</span>\n                    <div className=\"w-4 h-4 border-2 border-white/50 border-t-transparent rounded-full animate-spin\"></div>\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Mobile Menu */}\n          {mobileMenuOpen && (\n            <div className=\"lg:hidden py-4 border-t border-blue-800/30\">\n              <div className=\"grid grid-cols-2 gap-3\">\n                <Button \n                  onClick={handleRefresh} \n                  variant=\"outline\"\n                  disabled={refreshing}\n                  className=\"flex items-center justify-center gap-2 text-sm px-3 py-2 bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all duration-200\"\n                >\n                  <RefreshCw className={`w-4 h-4 ${refreshing ? 'animate-spin' : ''}`} />\n                  <span>{refreshing ? 'Refreshing...' : 'Refresh'}</span>\n                </Button>\n                \n                <Link to=\"/admin/clinics\">\n                  <Button \n                    variant=\"primary\" \n                    className=\"w-full flex items-center justify-center gap-2 text-sm px-3 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-200\"\n                  >\n                    <Building2 className=\"w-4 h-4\" />\n                    <span>Manage Clinics</span>\n                  </Button>\n                </Link>\n\n                <Button \n                  variant=\"outline\"\n                  className=\"flex items-center justify-center gap-2 text-sm px-3 py-2 bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all duration-200\"\n                >\n                  <Bell className=\"w-4 h-4\" />\n                  <span>Notifications</span>\n                </Button>\n\n                <Button \n                  variant=\"outline\"\n                  className=\"flex items-center justify-center gap-2 text-sm px-3 py-2 bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all duration-200\"\n                >\n                  <Settings className=\"w-4 h-4\" />\n                  <span>Settings</span>\n                </Button>\n              </div>\n\n              {/* Mobile Stats */}\n              <div className=\"mt-4 grid grid-cols-3 gap-4 text-center text-white/80\">\n                <div>\n                  <div className=\"text-lg font-bold text-green-400\">{systemHealth.uptime}%</div>\n                  <div className=\"text-xs\">Uptime</div>\n                </div>\n                <div>\n                  <div className=\"text-lg font-bold text-blue-400\">{systemHealth.activeSessions.toLocaleString()}</div>\n                  <div className=\"text-xs\">Sessions</div>\n                </div>\n                <div>\n                  <div className=\"text-lg font-bold text-purple-400\">{systemHealth.responseTime}ms</div>\n                  <div className=\"text-xs\">Response</div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8\">\n\n        {/* System Overview Cards */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6 lg:mb-8\">\n          {/* System Health */}\n          <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"p-3 bg-gradient-to-r from-green-100 to-green-200 rounded-lg\">\n                <Activity className=\"text-2xl text-green-600\" />\n              </div>\n              <Badge className={getHealthColor(systemHealth.databaseHealth)}>\n                {systemHealth.databaseHealth}\n              </Badge>\n            </div>\n            <h3 className=\"text-base lg:text-lg font-semibold text-gray-900 mb-2\">{t('admin_dashboard.system_health')}</h3>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">{t('admin_dashboard.uptime')}</span>\n                <span className=\"font-semibold\">{systemHealth.uptime}%</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">{t('admin_dashboard.response_time')}</span>\n                <span className=\"font-semibold\">{systemHealth.responseTime}ms</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">{t('admin_dashboard.active_sessions')}</span>\n                <span className=\"font-semibold\">{systemHealth.activeSessions.toLocaleString()}</span>\n              </div>\n            </div>\n          </Card>\n\n          {/* Security Status */}\n          <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"p-3 bg-gradient-to-r from-red-100 to-red-200 rounded-lg\">\n                <Shield className=\"text-2xl text-red-600\" />\n              </div>\n              <Badge className=\"text-green-600 bg-green-100\">\n                Secure\n              </Badge>\n            </div>\n            <h3 className=\"text-base lg:text-lg font-semibold text-gray-900 mb-2\">Security Status</h3>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">Firewall</span>\n                <span className=\"font-semibold text-green-600\">Active</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">SSL Certificate</span>\n                <span className=\"font-semibold text-green-600\">Valid</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">2FA</span>\n                <span className=\"font-semibold text-green-600\">Enabled</span>\n              </div>\n            </div>\n          </Card>\n\n          {/* Performance Metrics */}\n          <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"p-3 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg\">\n                <TrendingUp className=\"text-2xl text-blue-600\" />\n              </div>\n              <Badge className=\"text-blue-600 bg-blue-100\">\n                Optimal\n              </Badge>\n            </div>\n            <h3 className=\"text-base lg:text-lg font-semibold text-gray-900 mb-2\">{t('admin_dashboard.performance_metrics')}</h3>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">{t('admin_dashboard.server_load')}</span>\n                <span className=\"font-semibold\">{systemHealth.serverLoad}%</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">{t('admin_dashboard.memory_usage')}</span>\n                <span className=\"font-semibold\">{systemHealth.memoryUsage}%</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">{t('admin_dashboard.disk_usage')}</span>\n                <span className=\"font-semibold\">{systemHealth.diskUsage}%</span>\n              </div>\n            </div>\n          </Card>\n\n          {/* Network Status */}\n          <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"p-3 bg-gradient-to-r from-purple-100 to-purple-200 rounded-lg\">\n                <Wifi className=\"text-2xl text-purple-600\" />\n              </div>\n              <Badge className=\"text-purple-600 bg-purple-100\">\n                Stable\n              </Badge>\n            </div>\n            <h3 className=\"text-base lg:text-lg font-semibold text-gray-900 mb-2\">{t('admin_dashboard.network_traffic')}</h3>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">Traffic</span>\n                <span className=\"font-semibold\">{systemHealth.networkTraffic}%</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">Error Rate</span>\n                <span className=\"font-semibold\">{systemHealth.errorRate}%</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">CDN Status</span>\n                <span className=\"font-semibold text-green-600\">Online</span>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8\">\n          {/* Quick Actions */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"p-4 lg:p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-lg lg:text-xl font-bold text-gray-900 flex items-center gap-2\">\n                  <Zap className=\"w-5 h-5 text-blue-600\" />\n                  {t('admin_dashboard.quick_actions')}\n                </h2>\n                <Link to=\"/admin/actions\" className=\"text-blue-600 hover:text-blue-700 text-sm font-medium\">\n                  View All\n                </Link>\n              </div>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4\">\n                {quickActions.map((action) => {\n                  const IconComponent = action.icon;\n                  return (\n                    <Button\n                      key={action.id}\n                      variant={action.variant}\n                      onClick={action.action}\n                      className=\"h-auto p-4 justify-start text-left\"\n                    >\n                      <IconComponent className=\"w-5 h-5 mr-3\" />\n                      <div>\n                        <div className=\"font-medium\">{action.title}</div>\n                        <div className=\"text-sm opacity-75\">{action.description}</div>\n                      </div>\n                    </Button>\n                  );\n                })}\n              </div>\n            </Card>\n          </div>\n\n          {/* Recent Activity */}\n          <div>\n            <Card className=\"p-4 lg:p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-lg lg:text-xl font-bold text-gray-900 flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5 text-blue-600\" />\n                  {t('admin_dashboard.recent_activity')}\n                </h2>\n                <Link to=\"/admin/activity\" className=\"text-blue-600 hover:text-blue-700 text-sm font-medium\">\n                  View All\n                </Link>\n              </div>\n              <div className=\"space-y-4\">\n                {recentActivity.map((activity) => (\n                  <div key={activity.id} className=\"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg\">\n                    {getSeverityIcon(activity.severity)}\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-sm font-medium text-gray-900\">{activity.title}</p>\n                      <p className=\"text-sm text-gray-600\">{activity.description}</p>\n                      <p className=\"text-xs text-gray-500 mt-1\">\n                        {activity.timestamp.toLocaleTimeString()}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </Card>\n          </div>\n        </div>\n\n        {/* System Monitoring Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 mt-6 lg:mt-8\">\n          {/* System Services Status */}\n          <Card className=\"p-4 lg:p-6\">\n            <h2 className=\"text-lg lg:text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n              <Server className=\"w-5 h-5 text-blue-600\" />\n              System Services\n            </h2>\n            <div className=\"space-y-4\">\n              {[\n                { name: 'Database', status: 'online', icon: Database, color: 'green' },\n                { name: 'Email Service', status: 'online', icon: Mail, color: 'green' },\n                { name: 'Payment Gateway', status: 'online', icon: CreditCard, color: 'green' },\n                { name: 'File Storage', status: 'online', icon: Cloud, color: 'green' },\n                { name: 'SMS Service', status: 'warning', icon: MessageSquare, color: 'yellow' },\n                { name: 'CDN', status: 'online', icon: Globe, color: 'green' }\n              ].map((service) => {\n                const IconComponent = service.icon;\n                return (\n                  <div key={service.name} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                    <div className=\"flex items-center space-x-3\">\n                      <IconComponent className={`w-5 h-5 text-${service.color}-600`} />\n                      <span className=\"font-medium\">{service.name}</span>\n                    </div>\n                    <Badge className={`text-${service.color}-600 bg-${service.color}-100`}>\n                      {service.status}\n                    </Badge>\n                  </div>\n                );\n              })}\n            </div>\n          </Card>\n\n          {/* Security Overview */}\n          <Card className=\"p-4 lg:p-6\">\n            <h2 className=\"text-lg lg:text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n              <Lock className=\"w-5 h-5 text-blue-600\" />\n              Security Overview\n            </h2>\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4\">\n                <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n                  <div className=\"text-2xl font-bold text-green-600\">{securityStatus.failedLogins}</div>\n                  <div className=\"text-sm text-gray-600\">Failed Logins</div>\n                </div>\n                <div className=\"text-center p-4 bg-yellow-50 rounded-lg\">\n                  <div className=\"text-2xl font-bold text-yellow-600\">{securityStatus.suspiciousActivity}</div>\n                  <div className=\"text-sm text-gray-600\">Suspicious Activity</div>\n                </div>\n              </div>\n              <div className=\"space-y-3\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-gray-600\">Firewall Status</span>\n                  <span className=\"text-sm font-semibold text-green-600\">Active</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-gray-600\">SSL Certificate</span>\n                  <span className=\"text-sm font-semibold text-green-600\">Valid (30 days)</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-gray-600\">Encryption</span>\n                  <span className=\"text-sm font-semibold text-green-600\">AES-256</span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-gray-600\">2FA Enabled</span>\n                  <span className=\"text-sm font-semibold text-green-600\">Yes</span>\n                </div>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Additional Features Grid */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mt-6 lg:mt-8\">\n          <Link to=\"/admin/backup\" className=\"block\">\n            <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow cursor-pointer\">\n              <div className=\"text-center\">\n                <div className=\"p-3 bg-blue-100 rounded-lg inline-block mb-4\">\n                  <Download className=\"w-6 h-6 text-blue-600\" />\n                </div>\n                <h3 className=\"font-semibold text-gray-900 mb-2\">{t('admin_dashboard.backup_restore')}</h3>\n                <p className=\"text-sm text-gray-600\">Manage system backups and restores</p>\n              </div>\n            </Card>\n          </Link>\n\n          <Link to=\"/admin/audit\" className=\"block\">\n            <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow cursor-pointer\">\n              <div className=\"text-center\">\n                <div className=\"p-3 bg-purple-100 rounded-lg inline-block mb-4\">\n                  <FileText className=\"w-6 h-6 text-purple-600\" />\n                </div>\n                <h3 className=\"font-semibold text-gray-900 mb-2\">{t('admin_dashboard.audit_logs')}</h3>\n                <p className=\"text-sm text-gray-600\">View system audit trails and logs</p>\n              </div>\n            </Card>\n          </Link>\n\n          <Link to=\"/admin/api\" className=\"block\">\n            <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow cursor-pointer\">\n              <div className=\"text-center\">\n                <div className=\"p-3 bg-green-100 rounded-lg inline-block mb-4\">\n                  <Code className=\"w-6 h-6 text-green-600\" />\n                </div>\n                <h3 className=\"font-semibold text-gray-900 mb-2\">{t('admin_dashboard.api_documentation')}</h3>\n                <p className=\"text-sm text-gray-600\">Access API documentation and tools</p>\n              </div>\n            </Card>\n          </Link>\n\n          <Link to=\"/admin/support\" className=\"block\">\n            <Card className=\"p-4 lg:p-6 hover:shadow-lg transition-shadow cursor-pointer\">\n              <div className=\"text-center\">\n                <div className=\"p-3 bg-orange-100 rounded-lg inline-block mb-4\">\n                  <LifeBuoy className=\"w-6 h-6 text-orange-600\" />\n                </div>\n                <h3 className=\"font-semibold text-gray-900 mb-2\">{t('admin_dashboard.support_center')}</h3>\n                <p className=\"text-sm text-gray-600\">Get help and support resources</p>\n              </div>\n            </Card>\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ImprovedAdminDashboard;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\appointment\\AppointmentDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3131,3134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3131,3134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5078,5081],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5078,5081],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8614,8617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8614,8617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":259,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":259,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9627,9630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9627,9630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10623,10626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10623,10626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport { Button, Card, Badge, Modal } from '../../components/ui';\nimport { appointmentService } from '../../services/appointmentService';\nimport { PrescriptionForm } from '../../components/prescriptions/PrescriptionForm';\nimport { toast } from 'react-hot-toast';\nimport { useAuth } from '../../hooks/useAuth';\n\ninterface Appointment {\n  _id: string;\n  id: string;\n  patientId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone: string;\n  } | string;\n  dentistId?: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    specialization?: string;\n  } | string;\n  clinicId: {\n    _id: string;\n    name: string;\n    address?: string;\n    phone?: string;\n  } | string;\n  date: string;\n  timeSlot: string;\n  duration: number;\n  serviceType: string;\n  status: 'scheduled' | 'confirmed' | 'in-progress' | 'completed' | 'cancelled' | 'no-show' | 'urgent';\n  notes?: string;\n  emergency?: boolean;\n  createdAt: string;\n  updatedAt: string;\n  \n  // Computed properties for backward compatibility\n  patientName?: string;\n  patientEmail?: string;\n  patientPhone?: string;\n  dentistName?: string;\n  clinicName?: string;\n  time?: string;\n  type?: string;\n  doctorName?: string;\n  doctorId?: string;\n}\n\nconst AppointmentDetail: React.FC = () => {\n  const { t, i18n } = useTranslation();\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [isLoading, setIsLoading] = useState(true);\n  const [appointment, setAppointment] = useState<Appointment | null>(null);\n  const [actionLoading, setActionLoading] = useState<{ [key: string]: boolean }>({});\n  const [showPrescriptionModal, setShowPrescriptionModal] = useState(false);\n  const [showConfirmModal, setShowConfirmModal] = useState<{\n    show: boolean;\n    action: 'cancel' | 'complete' | 'no-show' | null;\n    title: string;\n    message: string;\n    confirmText: string;\n    variant: 'danger' | 'primary' | 'warning';\n  }>({ \n    show: false, \n    action: null, \n    title: '', \n    message: '', \n    confirmText: '', \n    variant: 'primary' \n  });\n  \n  // Fetch appointment data on component mount\n  useEffect(() => {\n    const fetchAppointment = async () => {\n      // Don't try to fetch data if the ID is a route keyword\n      if (!id || ['new', 'create', 'edit'].includes(id.toLowerCase())) {\n        if (id && ['new', 'create', 'edit'].includes(id.toLowerCase())) {\n          // Redirect to the correct route if someone manually enters an invalid URL\n          navigate('/appointments/create', { replace: true });\n        }\n        return;\n      }\n      \n      try {\n        setIsLoading(true);\n        console.log('Fetching appointment with ID:', id);\n        \n        const response = await appointmentService.getAppointment(id);\n        console.log('Appointment response:', response);\n        \n        // Handle the response structure from backend\n        let appointmentData = response as any;\n        if (appointmentData.data && appointmentData.data.appointment) {\n          appointmentData = appointmentData.data.appointment;\n        } else if (appointmentData.data) {\n          appointmentData = appointmentData.data;\n        }\n        \n        console.log('Processed appointment data:', appointmentData);\n        \n        // Transform populated fields to flat structure for backward compatibility\n        const transformedAppointment = {\n          ...appointmentData,\n          id: appointmentData._id || appointmentData.id,\n          patientName: typeof appointmentData.patientId === 'object' \n            ? `${appointmentData.patientId.firstName} ${appointmentData.patientId.lastName}`\n            : undefined,\n          patientEmail: typeof appointmentData.patientId === 'object' \n            ? appointmentData.patientId.email \n            : undefined,\n          patientPhone: typeof appointmentData.patientId === 'object' \n            ? appointmentData.patientId.phone \n            : undefined,\n          dentistName: typeof appointmentData.dentistId === 'object' \n            ? `${appointmentData.dentistId.firstName} ${appointmentData.dentistId.lastName}`\n            : 'Auto-assigned',\n          clinicName: typeof appointmentData.clinicId === 'object' \n            ? appointmentData.clinicId.name \n            : undefined,\n          time: appointmentData.timeSlot,\n          type: appointmentData.serviceType,\n          doctorName: typeof appointmentData.dentistId === 'object' \n            ? `${appointmentData.dentistId.firstName} ${appointmentData.dentistId.lastName}`\n            : 'Auto-assigned',\n          doctorId: typeof appointmentData.dentistId === 'object' \n            ? appointmentData.dentistId._id \n            : appointmentData.dentistId\n        };\n        \n        console.log('Final transformed appointment:', transformedAppointment);\n        setAppointment(transformedAppointment);\n      } catch (error: any) {\n        console.error('Error fetching appointment:', error);\n        console.error('Error details:', {\n          message: error.message,\n          status: error.response?.status,\n          statusText: error.response?.statusText,\n          data: error.response?.data\n        });\n        \n        // Provide more specific error messages\n        if (error.response?.status === 403) {\n          toast.error(t('appointmentDetail.accessDenied') || 'Access denied. You can only view your own appointments.');\n        } else if (error.response?.status === 404) {\n          toast.error(t('appointmentDetail.notFound') || 'Appointment not found.');\n        } else if (error.response?.status === 401) {\n          toast.error(t('appointmentDetail.unauthorized') || 'Please log in to view appointment details.');\n        } else {\n          toast.error(t('appointmentDetail.errorFetching') || 'Failed to fetch appointment details');\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchAppointment();\n  }, [id, t, navigate]);\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString(i18n.language, {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const formatTime = useCallback((timeString: string) => {\n    const [hours, minutes] = timeString.split(':');\n    const hour = parseInt(hours, 10);\n    const ampm = hour >= 12 ? t('common.time.pm') || 'PM' : t('common.time.am') || 'AM';\n    const hour12 = hour % 12 || 12;\n    return `${hour12}:${minutes} ${ampm}`;\n  }, [t]);\n\n  const formatDateTime = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleString(i18n.language, {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: 'numeric',\n      hour12: true\n    });\n  };\n\n  const getStatusBadge = useCallback((status: Appointment['status']) => {\n    const variants: Record<Appointment['status'], 'primary' | 'success' | 'gray' | 'danger' | 'warning'> = {\n      'scheduled': 'primary',\n      'confirmed': 'primary',\n      'in-progress': 'warning',\n      'completed': 'success',\n      'cancelled': 'gray',\n      'no-show': 'danger',\n      'urgent': 'danger'\n    };\n    \n    const labels: Record<Appointment['status'], string> = {\n      'scheduled': t('appointments.scheduled'),\n      'confirmed': t('appointments.confirmed'),\n      'in-progress': t('appointments.inProgress') || 'In Progress',\n      'completed': t('appointments.completed'),\n      'cancelled': t('appointments.cancelled'),\n      'no-show': t('appointments.noShow'),\n      'urgent': t('appointments.urgent') || 'Urgent'\n    };\n    \n    return (\n      <Badge variant={variants[status] as 'primary' | 'success' | 'gray' | 'danger'} rounded={true} className=\"text-sm\">\n        {labels[status]}\n      </Badge>\n    );\n  }, [t]);\n\n  const handleCancelAppointment = useCallback(async () => {\n    if (!appointment) return;\n    \n    try {\n      setActionLoading(prev => ({ ...prev, cancel: true }));\n      await appointmentService.updateAppointment(appointment._id || appointment.id, { status: 'cancelled' });\n      toast.success(t('appointmentDetail.cancelSuccess') || 'Appointment cancelled successfully');\n      \n      // Update local state\n      setAppointment(prev => prev ? { ...prev, status: 'cancelled' } : null);\n      \n      // Navigate back after a short delay\n      setTimeout(() => navigate('/appointments'), 1500);\n    } catch (error: any) {\n      toast.error(t('appointmentDetail.cancelError') || 'Failed to cancel appointment');\n      console.error('Error cancelling appointment:', error);\n    } finally {\n      setActionLoading(prev => ({ ...prev, cancel: false }));\n      setShowConfirmModal({ show: false, action: null, title: '', message: '', confirmText: '', variant: 'primary' });\n    }\n  }, [appointment, navigate, t]);\n\n  const handleCompleteAppointment = useCallback(async () => {\n    if (!appointment) return;\n    \n    try {\n      setActionLoading(prev => ({ ...prev, complete: true }));\n      await appointmentService.updateAppointment(appointment._id || appointment.id, { status: 'completed' });\n      toast.success(t('appointmentDetail.completeSuccess') || 'Appointment marked as completed');\n      \n      // Update local state\n      setAppointment(prev => prev ? { ...prev, status: 'completed' } : null);\n      \n      // Navigate back after a short delay\n      setTimeout(() => navigate('/appointments'), 1500);\n    } catch (error: any) {\n      toast.error(t('appointmentDetail.completeError') || 'Failed to complete appointment');\n      console.error('Error completing appointment:', error);\n    } finally {\n      setActionLoading(prev => ({ ...prev, complete: false }));\n      setShowConfirmModal({ show: false, action: null, title: '', message: '', confirmText: '', variant: 'primary' });\n    }\n  }, [appointment, navigate, t]);\n\n  const handleNoShow = useCallback(async () => {\n    if (!appointment) return;\n    \n    try {\n      setActionLoading(prev => ({ ...prev, noShow: true }));\n      await appointmentService.updateAppointment(appointment._id || appointment.id, { status: 'no-show' });\n      toast.success(t('appointmentDetail.noShowSuccess') || 'Appointment marked as no-show');\n      \n      // Update local state\n      setAppointment(prev => prev ? { ...prev, status: 'no-show' } : null);\n      \n      // Navigate back after a short delay\n      setTimeout(() => navigate('/appointments'), 1500);\n    } catch (error: any) {\n      toast.error(t('appointmentDetail.noShowError') || 'Failed to mark appointment as no-show');\n      console.error('Error marking appointment as no-show:', error);\n    } finally {\n      setActionLoading(prev => ({ ...prev, noShow: false }));\n      setShowConfirmModal({ show: false, action: null, title: '', message: '', confirmText: '', variant: 'primary' });\n    }\n  }, [appointment, navigate, t]);\n\n  // Helper functions for confirmation modals\n  const showCancelConfirmation = useCallback(() => {\n    setShowConfirmModal({\n      show: true,\n      action: 'cancel',\n      title: t('appointmentDetail.cancelConfirmTitle') || 'Cancel Appointment',\n      message: t('appointmentDetail.cancelConfirmMessage') || 'Are you sure you want to cancel this appointment? This action cannot be undone.',\n      confirmText: t('appointmentDetail.yesCancel') || 'Yes, Cancel',\n      variant: 'danger'\n    });\n  }, [t]);\n\n  const showCompleteConfirmation = useCallback(() => {\n    setShowConfirmModal({\n      show: true,\n      action: 'complete',\n      title: t('appointmentDetail.completeConfirmTitle') || 'Complete Appointment',\n      message: t('appointmentDetail.completeConfirmMessage') || 'Are you sure you want to mark this appointment as completed?',\n      confirmText: t('appointmentDetail.yesComplete') || 'Yes, Complete',\n      variant: 'primary'\n    });\n  }, [t]);\n\n  const showNoShowConfirmation = useCallback(() => {\n    setShowConfirmModal({\n      show: true,\n      action: 'no-show',\n      title: t('appointmentDetail.noShowConfirmTitle') || 'Mark as No-Show',\n      message: t('appointmentDetail.noShowConfirmMessage') || 'Are you sure you want to mark this appointment as no-show?',\n      confirmText: t('appointmentDetail.yesNoShow') || 'Yes, Mark as No-Show',\n      variant: 'warning'\n    });\n  }, [t]);\n\n  const handleConfirmAction = useCallback(() => {\n    if (showConfirmModal.action === 'cancel') {\n      handleCancelAppointment();\n    } else if (showConfirmModal.action === 'complete') {\n      handleCompleteAppointment();\n    } else if (showConfirmModal.action === 'no-show') {\n      handleNoShow();\n    }\n  }, [showConfirmModal.action, handleCancelAppointment, handleCompleteAppointment, handleNoShow]);\n\n  const handleCreatePrescription = useCallback(() => {\n    setShowPrescriptionModal(true);\n  }, []);\n\n  const handlePrescriptionSaved = useCallback(() => {\n    setShowPrescriptionModal(false);\n    toast.success(t('appointmentDetail.prescriptionCreated') || 'Prescription created successfully');\n  }, [t]);\n\n  const handlePrescriptionCancel = useCallback(() => {\n    setShowPrescriptionModal(false);\n  }, []);\n\n  // Check if user is a dentist\n  const canCreatePrescription = user?.role === 'dentist' || user?.role === 'admin' || user?.role === 'super_admin';\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50\">\n        <div className=\"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-white py-8 px-6 rounded-b-3xl shadow-lg mb-8\">\n          <div className=\"max-w-7xl mx-auto\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-8 bg-white/20 rounded w-1/3 mb-2\"></div>\n              <div className=\"h-4 bg-white/10 rounded w-1/4\"></div>\n            </div>\n          </div>\n        </div>\n        <div className=\"max-w-7xl mx-auto px-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {Array.from({ length: 4 }).map((_, index) => (\n              <Card key={index} className=\"animate-pulse\">\n                <div className=\"space-y-4\">\n                  <div className=\"h-6 bg-gray-200 rounded w-1/2\"></div>\n                  <div className=\"space-y-3\">\n                    <div className=\"h-4 bg-gray-200 rounded\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded w-1/2\"></div>\n                  </div>\n                </div>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (!appointment) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-red-50 via-white to-pink-50\">\n        <div className=\"bg-gradient-to-r from-red-600 via-pink-600 to-red-600 text-white py-8 px-6 rounded-b-3xl shadow-lg mb-8\">\n          <div className=\"max-w-7xl mx-auto\">\n            <div className=\"flex items-center space-x-3\">\n              <svg className=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n              </svg>\n              <div>\n                <h1 className=\"text-2xl font-bold\">\n                  {t('appointmentDetail.error') || 'Error'}\n                </h1>\n                <p className=\"text-red-100\">\n                  {t('appointmentDetail.appointmentNotFound') || 'Appointment not found'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"max-w-7xl mx-auto px-6\">\n          <Card className=\"max-w-md mx-auto text-center\">\n            <div className=\"p-8\">\n              <div className=\"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-6\">\n                <svg className=\"h-8 w-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </div>\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n          {t('appointmentDetail.appointmentNotFound')}\n              </h3>\n              <p className=\"text-gray-500 mb-6\">\n                {t('appointmentDetail.appointmentNotFoundDesc') || 'The appointment you are looking for does not exist or has been removed.'}\n              </p>\n              <div className=\"space-x-3\">\n          <Link to=\"/appointments\">\n                  <Button \n                    variant=\"primary\"\n                    className=\"bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 font-bold shadow-lg transition-all duration-200 transform hover:scale-105\"\n                  >\n                    <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\n                    </svg>\n                    <span className=\"font-bold\">{t('appointmentDetail.backToAppointments')}</span>\n            </Button>\n          </Link>\n                <Button \n                  variant=\"outline\" \n                  onClick={() => window.location.reload()}\n                  className=\"bg-slate-500/10 border-slate-300 text-slate-700 hover:bg-slate-500/20 font-medium shadow-md transition-all duration-200 transform hover:scale-105\"\n                >\n                  <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                  </svg>\n                  <span className=\"font-medium\">{t('common.refresh') || 'Refresh'}</span>\n                </Button>\n              </div>\n            </div>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50\">\n      {/* Enhanced Header with Gradient */}\n      <div className=\"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-white py-6 sm:py-8 px-4 sm:px-6 rounded-b-3xl shadow-lg mb-6 sm:mb-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between\">\n            <div className=\"space-y-2\">\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:space-x-3 space-y-2 sm:space-y-0\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"p-2 bg-white/20 rounded-lg\">\n                    <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                  <h1 className=\"text-2xl sm:text-3xl font-bold\">\n                    {t('appointmentDetail.title')}\n                  </h1>\n                </div>\n                <div>\n                  {getStatusBadge(appointment.status)}\n                </div>\n              </div>\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-2 sm:space-y-0 text-blue-100 text-sm\">\n                <div className=\"flex items-center space-x-2\">\n                  <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-6a1 1 0 00-1-1H9a1 1 0 00-1 1v6a1 1 0 01-1 1H4a1 1 0 110-2V4z\" clipRule=\"evenodd\" />\n                  </svg>\n                  <span className=\"truncate\">{t('appointmentDetail.appointmentId')}: #{appointment.id}</span>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                  </svg>\n                  <span className=\"truncate\">{appointment.patientName}</span>\n                </div>\n              </div>\n            </div>\n            \n            {/* Action Buttons */}\n            <div className=\"mt-4 md:mt-0 flex flex-col sm:flex-row flex-wrap gap-2 sm:gap-3\">\n              {/* Create Prescription Button - Available for dentists */}\n              {canCreatePrescription && (appointment.status === 'scheduled' || appointment.status === 'confirmed' || appointment.status === 'in-progress' || appointment.status === 'completed') && (\n                <Button \n                  variant=\"primary\"\n                  onClick={handleCreatePrescription}\n                  className=\"w-full sm:w-auto bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 border-0 text-white font-bold shadow-lg transition-all duration-200 transform hover:scale-105 min-h-[44px] touch-manipulation\"\n                >\n                  <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z\" />\n                  </svg>\n                  <span className=\"font-bold\">{t('appointmentDetail.createPrescription') || 'Create Prescription'}</span>\n                </Button>\n              )}\n              \n              {(appointment.status === 'scheduled' || appointment.status === 'confirmed') && (\n            <>\n              <Link to={`/appointments/${id}/edit`} className=\"w-full sm:w-auto\">\n                <Button \n                  variant=\"outline\"\n                      className=\"w-full bg-blue-500/20 border-blue-300 text-blue-100 hover:bg-blue-500/30 font-medium shadow-lg backdrop-blur-sm transition-all duration-200 transform hover:scale-105 min-h-[44px] touch-manipulation\"\n                >\n                      <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n                  </svg>\n                      <span className=\"font-semibold\">{t('appointmentDetail.edit')}</span>\n                </Button>\n              </Link>\n              <Button \n                variant=\"primary\"\n                    onClick={showCompleteConfirmation}\n                    disabled={actionLoading.complete}\n                    className=\"w-full sm:w-auto bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 border-0 text-white font-bold shadow-lg transition-all duration-200 transform hover:scale-105 disabled:transform-none min-h-[44px] touch-manipulation\"\n                  >\n                    {actionLoading.complete ? (\n                      <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                        <span className=\"font-medium\">{t('common.processing')}</span>\n                      </div>\n                    ) : (\n                      <>\n                        <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                </svg>\n                        <span className=\"font-bold\">{t('appointmentDetail.markAsCompleted')}</span>\n                      </>\n                    )}\n              </Button>\n              <Button \n                variant=\"outline\"\n                    onClick={showCancelConfirmation}\n                    disabled={actionLoading.cancel}\n                    className=\"w-full sm:w-auto bg-gradient-to-r from-red-500/20 to-pink-500/20 border-red-300 text-red-100 hover:from-red-500/30 hover:to-pink-500/30 font-medium shadow-lg backdrop-blur-sm transition-all duration-200 transform hover:scale-105 disabled:transform-none min-h-[44px] touch-manipulation\"\n                  >\n                    {actionLoading.cancel ? (\n                      <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-4 h-4 border-2 border-red-300 border-t-transparent rounded-full animate-spin\" />\n                        <span className=\"font-medium\">{t('common.processing')}</span>\n                      </div>\n                    ) : (\n                      <>\n                        <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n                        <span className=\"font-semibold\">{t('appointmentDetail.cancelAppointment')}</span>\n                      </>\n                    )}\n              </Button>\n              <Button \n                variant=\"outline\"\n                    onClick={showNoShowConfirmation}\n                    disabled={actionLoading.noShow}\n                    className=\"w-full sm:w-auto bg-gradient-to-r from-amber-500/20 to-orange-500/20 border-amber-300 text-amber-100 hover:from-amber-500/30 hover:to-orange-500/30 font-medium shadow-lg backdrop-blur-sm transition-all duration-200 transform hover:scale-105 disabled:transform-none min-h-[44px] touch-manipulation\"\n                  >\n                    {actionLoading.noShow ? (\n                      <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-4 h-4 border-2 border-amber-300 border-t-transparent rounded-full animate-spin\" />\n                        <span className=\"font-medium\">{t('common.processing')}</span>\n                      </div>\n                    ) : (\n                      <>\n                        <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                </svg>\n                        <span className=\"font-semibold\">{t('appointmentDetail.markAsNoShow')}</span>\n                      </>\n                    )}\n              </Button>\n            </>\n          )}\n          <Link to=\"/appointments\" className=\"w-full sm:w-auto\">\n            <Button \n              variant=\"outline\"\n                  className=\"w-full bg-slate-500/20 border-slate-300 text-slate-100 hover:bg-slate-500/30 font-medium shadow-lg backdrop-blur-sm transition-all duration-200 transform hover:scale-105 min-h-[44px] touch-manipulation\"\n            >\n                  <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\n                  </svg>\n                  <span className=\"font-medium\">{t('appointmentDetail.backToList')}</span>\n            </Button>\n          </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-6\">\n\n      {/* Modern Confirmation Modal */}\n      {showConfirmModal.show && (\n        <div \n          className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"confirm-modal-title\"\n        >\n          <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full p-6 transform transition-all\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className={`p-3 rounded-full ${\n                showConfirmModal.variant === 'danger' \n                  ? 'bg-red-100' \n                  : showConfirmModal.variant === 'warning' \n                  ? 'bg-yellow-100' \n                  : 'bg-green-100'\n              }`}>\n                {showConfirmModal.variant === 'danger' ? (\n                  <svg className=\"w-6 h-6 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                  </svg>\n                ) : showConfirmModal.variant === 'warning' ? (\n                  <svg className=\"w-6 h-6 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                  </svg>\n                ) : (\n                  <svg className=\"w-6 h-6 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                  </svg>\n                )}\n              </div>\n              <h3 id=\"confirm-modal-title\" className=\"text-lg font-semibold text-gray-900\">\n                {showConfirmModal.title}\n              </h3>\n            </div>\n            \n            <p className=\"text-gray-600 mb-6 leading-relaxed\">\n              {showConfirmModal.message}\n            </p>\n            \n            <div className=\"flex space-x-3 justify-end\">\n              <Button \n                variant=\"outline\"\n                onClick={() => setShowConfirmModal({ \n                  show: false, \n                  action: null, \n                  title: '', \n                  message: '', \n                  confirmText: '', \n                  variant: 'primary' \n                })}\n                disabled={actionLoading[showConfirmModal.action || '']}\n                className=\"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200 font-medium shadow-sm transition-all duration-200\"\n              >\n                <span className=\"font-medium\">{t('common.cancel')}</span>\n              </Button>\n              <Button \n                variant={showConfirmModal.variant === 'danger' ? 'danger' : 'primary'}\n                onClick={handleConfirmAction}\n                disabled={actionLoading[showConfirmModal.action || '']}\n                autoFocus\n                className={`font-bold shadow-lg transition-all duration-200 transform hover:scale-105 disabled:transform-none ${\n                  showConfirmModal.variant === 'danger' \n                    ? 'bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 border-0' \n                    : showConfirmModal.variant === 'warning' \n                    ? 'bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-700 hover:to-orange-700 border-0 text-white' \n                    : 'bg-gradient-to-r from-emerald-600 to-green-700 hover:from-emerald-700 hover:to-green-800 border-0'\n                }`}\n              >\n                {actionLoading[showConfirmModal.action || ''] ? (\n                  <div className=\"flex items-center space-x-2\">\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    <span className=\"font-medium\">{t('common.processing')}</span>\n                  </div>\n                ) : (\n                  <span className=\"font-bold\">{showConfirmModal.confirmText}</span>\n                )}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Enhanced Cards Layout */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8\">\n        {/* Quick Info Card */}\n        <div className=\"lg:col-span-3\">\n          <Card className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 shadow-lg\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6\">\n              <div className=\"text-center sm:text-left\">\n                <div className=\"inline-flex items-center justify-center w-12 h-12 bg-blue-100 rounded-xl mb-3\">\n                  <svg className=\"w-6 h-6 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                  </svg>\n                </div>\n                <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.date')}</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{formatDate(appointment.date)}</p>\n              </div>\n              \n              <div className=\"text-center md:text-left\">\n                <div className=\"inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-xl mb-3\">\n                  <svg className=\"w-6 h-6 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\" />\n                  </svg>\n                </div>\n                <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.time')}</p>\n                <p className=\"text-lg font-semibold text-gray-900\">\n                  {formatTime(appointment.timeSlot)}\n                  <span className=\"text-sm text-gray-500 ml-1\">({appointment.duration} min)</span>\n                </p>\n              </div>\n              \n              <div className=\"text-center md:text-left\">\n                <div className=\"inline-flex items-center justify-center w-12 h-12 bg-purple-100 rounded-xl mb-3\">\n                  <svg className=\"w-6 h-6 text-purple-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                  </svg>\n                </div>\n                <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.doctor')}</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{appointment.dentistName || 'Auto-assigned'}</p>\n              </div>\n              \n              <div className=\"text-center md:text-left\">\n                <div className=\"inline-flex items-center justify-center w-12 h-12 bg-indigo-100 rounded-xl mb-3\">\n                  <svg className=\"w-6 h-6 text-indigo-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z\" clipRule=\"evenodd\" />\n                  </svg>\n                </div>\n                <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.status')}</p>\n                <div className=\"mt-1\">{getStatusBadge(appointment.status)}</div>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Appointment Details */}\n        <Card className=\"lg:col-span-2 shadow-lg hover:shadow-xl transition-shadow duration-200\">\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-blue-100 rounded-lg\">\n              <svg className=\"w-5 h-5 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-6a1 1 0 00-1-1H9a1 1 0 00-1 1v6a1 1 0 01-1 1H4a1 1 0 110-2V4z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">{t('appointmentDetail.appointmentInfo')}</h2>\n          </div>\n          \n          <div className=\"space-y-6\">\n            <div className=\"bg-gray-50 rounded-lg p-4\">\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n            <div>\n                  <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.type')}</p>\n                  <p className=\"mt-1 text-base font-medium text-gray-900\">{appointment.serviceType}</p>\n            </div>\n            <div>\n                  <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.clinic')}</p>\n                  <p className=\"mt-1 text-base font-medium text-gray-900\">{appointment.clinicName}</p>\n                </div>\n              </div>\n            </div>\n            \n            <div>\n              <p className=\"text-sm font-medium text-gray-500 mb-2\">{t('appointmentDetail.appointmentId')}</p>\n              <div className=\"bg-gradient-to-r from-gray-100 to-gray-200 rounded-lg p-3 font-mono text-sm\">\n                #{appointment._id || appointment.id}\n              </div>\n            </div>\n          </div>\n        </Card>\n\n        {/* Patient Information */}\n        <Card className=\"shadow-lg hover:shadow-xl transition-shadow duration-200\">\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-green-100 rounded-lg\">\n              <svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">{t('appointmentDetail.patientInfo')}</h2>\n          </div>\n          \n          <div className=\"space-y-4\">\n            <div className=\"text-center pb-4 border-b border-gray-200\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full text-white font-bold text-xl mb-3\">\n                {appointment.patientName?.split(' ').map(name => name[0]).join('') || 'PA'}\n              </div>\n                <Link \n                to={`/patients/${typeof appointment.patientId === 'object' ? appointment.patientId._id : appointment.patientId}`}\n                className=\"text-lg font-semibold text-indigo-600 hover:text-indigo-800 transition-colors duration-200 block\"\n                >\n                  {appointment.patientName}\n                </Link>\n            </div>\n            \n            <div className=\"space-y-3\">\n              <div className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\n                <svg className=\"w-5 h-5 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path d=\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\" />\n                  <path d=\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\" />\n                </svg>\n            <div>\n                  <p className=\"text-sm text-gray-500\">{t('appointmentDetail.email')}</p>\n                  <p className=\"font-medium\">{appointment.patientEmail}</p>\n                </div>\n            </div>\n              \n              <div className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\n                <svg className=\"w-5 h-5 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path d=\"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z\" />\n                </svg>\n            <div>\n                  <p className=\"text-sm text-gray-500\">{t('appointmentDetail.phone')}</p>\n                  <p className=\"font-medium\">{appointment.patientPhone}</p>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"pt-4 border-t border-gray-200\">\n              <Link to={`/patients/${typeof appointment.patientId === 'object' ? appointment.patientId._id : appointment.patientId}`}>\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  className=\"w-full bg-gradient-to-r from-indigo-500/10 to-purple-500/10 border-indigo-300 text-indigo-700 hover:from-indigo-500/20 hover:to-purple-500/20 font-medium shadow-md transition-all duration-200 transform hover:scale-105\"\n                >\n                  <svg className=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                  </svg>\n                  <span className=\"font-semibold\">{t('appointmentDetail.viewPatientProfile')}</span>\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </Card>\n\n        {/* Notes Section */}\n        <Card className=\"lg:col-span-3 shadow-lg hover:shadow-xl transition-shadow duration-200\">\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-yellow-100 rounded-lg\">\n              <svg className=\"w-5 h-5 text-yellow-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">{t('appointmentDetail.notes')}</h2>\n          </div>\n          \n          {appointment.notes ? (\n            <div className=\"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-6\">\n            <div className=\"prose max-w-none\">\n                <p className=\"text-gray-700 leading-relaxed\">{appointment.notes}</p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-12\">\n              <svg className=\"mx-auto h-12 w-12 text-gray-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n              </svg>\n              <p className=\"mt-4 text-gray-500 italic\">{t('appointmentDetail.noNotes')}</p>\n            </div>\n          )}\n        </Card>\n\n        {/* History Section */}\n        <Card className=\"lg:col-span-3 shadow-lg hover:shadow-xl transition-shadow duration-200\">\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-indigo-100 rounded-lg\">\n              <svg className=\"w-5 h-5 text-indigo-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">{t('appointmentDetail.appointmentHistory')}</h2>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\">\n              <div className=\"flex items-center space-x-3 mb-2\">\n                <div className=\"w-3 h-3 bg-green-500 rounded-full\"></div>\n                <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.created')}</p>\n              </div>\n              <p className=\"text-lg font-semibold text-gray-900\">{formatDateTime(appointment.createdAt)}</p>\n            </div>\n            \n            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\">\n              <div className=\"flex items-center space-x-3 mb-2\">\n                <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\n                <p className=\"text-sm font-medium text-gray-500\">{t('appointmentDetail.lastUpdated')}</p>\n              </div>\n              <p className=\"text-lg font-semibold text-gray-900\">{formatDateTime(appointment.updatedAt)}</p>\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Prescription Creation Modal */}\n      {showPrescriptionModal && appointment && typeof appointment.patientId === 'object' && (\n        <Modal\n          isOpen={showPrescriptionModal}\n          onClose={handlePrescriptionCancel}\n          title={t('appointmentDetail.createPrescriptionTitle') || 'Create Prescription'}\n          size=\"xl\"\n        >\n          <PrescriptionForm\n            patientId={appointment.patientId._id}\n            appointmentId={appointment._id || appointment.id}\n            onSave={handlePrescriptionSaved}\n            onCancel={handlePrescriptionCancel}\n          />\n        </Modal>\n      )}\n      </div>\n    </div>\n  );\n};\n\nexport default AppointmentDetail;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\appointment\\AppointmentForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2274,2277],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2274,2277],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4297,4300],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4297,4300],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":158,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6770,6773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6770,6773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9188,9191],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9188,9191],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'fetchTimeSlotsImmediate' and 'services'. Either include them or remove the dependency array.","line":364,"column":6,"nodeType":"ArrayExpression","endLine":364,"endColumn":58,"suggestions":[{"desc":"Update the dependencies array to be: [formData.clinicId, formData.date, formData.service, services, fetchTimeSlotsImmediate]","fix":{"range":[13595,13647],"text":"[formData.clinicId, formData.date, formData.service, services, fetchTimeSlotsImmediate]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'memoizedFormData.hasClinic' and 'memoizedFormData.hasDate'. Either include them or remove the dependency array.","line":396,"column":6,"nodeType":"ArrayExpression","endLine":396,"endColumn":53,"suggestions":[{"desc":"Update the dependencies array to be: [memoizedFormData.stabilityKey, fetchTimeSlots, memoizedFormData.hasDate, memoizedFormData.hasClinic]","fix":{"range":[14941,14988],"text":"[memoizedFormData.stabilityKey, fetchTimeSlots, memoizedFormData.hasDate, memoizedFormData.hasClinic]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":544,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":544,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20392,20395],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20392,20395],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'availableDoctors'. Either include it or remove the dependency array.","line":555,"column":6,"nodeType":"ArrayExpression","endLine":555,"endColumn":50,"suggestions":[{"desc":"Update the dependencies array to be: [formData.clinicId, formData.date, apiError, availableDoctors]","fix":{"range":[20750,20794],"text":"[formData.clinicId, formData.date, apiError, availableDoctors]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":582,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":582,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21705,21708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21705,21708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":585,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":585,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21972,21975],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21972,21975],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":845,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":845,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31810,31813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31810,31813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchInitialData'. Either include it or remove the dependency array.","line":855,"column":6,"nodeType":"ArrayExpression","endLine":855,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [isEditMode, isPatientUser, user, id, t, fetchInitialData]","fix":{"range":[32041,32081],"text":"[isEditMode, isPatientUser, user, id, t, fetchInitialData]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setSmartDefaults'. Either include it or remove the dependency array.","line":872,"column":6,"nodeType":"ArrayExpression","endLine":872,"endColumn":60,"suggestions":[{"desc":"Update the dependencies array to be: [isPatientUser, user, formData.patientId, patients, t, setSmartDefaults]","fix":{"range":[32791,32845],"text":"[isPatientUser, user, formData.patientId, patients, t, setSmartDefaults]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1074,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1074,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[40594,40597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[40594,40597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1131,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1131,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42951,42954],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42951,42954],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1158,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1158,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[44031,44034],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[44031,44034],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1229,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1229,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[47925,47928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[47925,47928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { Calendar, Clock, User, CheckCircle, AlertTriangle, Stethoscope, ArrowRight, ArrowLeft, Info, Check as CheckIcon, ClipboardCheck, Mail, Phone, FileText, MapPin } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport type { Toast } from 'react-hot-toast';\n\n// Extend toast with warning method\ninterface CustomToast {\n  warning: (message: string, options?: Partial<Pick<Toast, \"id\" | \"className\" | \"style\" | \"icon\" | \"duration\" | \"ariaProps\" | \"position\" | \"iconTheme\" | \"removeDelay\">>) => string;\n}\n\n// Add warning method to toast\nconst customToast = toast as typeof toast & CustomToast;\nif (!customToast.warning) {\n  customToast.warning = (message, options) => toast(message, {\n    icon: <AlertTriangle className=\"text-amber-500\" />,\n    ...options\n  });\n}\n\nimport { Alert } from '../../components/ui';\nimport { useAuth} from '../../hooks';\nimport { appointmentService, patientService } from '../../services';\nimport type { TimeSlot } from '../../services/appointmentService';\nimport { getBranches, getAllClinics } from '../../services/clinicService';\nimport { getAvailableDoctorsForDay } from '../../services/doctorScheduleService';\nimport type { Clinic } from '../../types';\nimport type { DoctorSchedule } from '../../services/doctorScheduleService';\n\nimport { validateAppointmentForm, validateTimeSlotAvailability } from '../../utils/appointmentValidationUtils';\nimport { \n  generateTimeSlotsFromMultipleSchedules, \n  formatTime12Hour, \n  getFirstAvailableSlot\n} from '../../utils/timeSlotUtils';\n\n\ninterface Patient {\n  id: string;\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone: string;\n}\n\ninterface ServiceOption {\n  value: string;\n  label: string;\n  icon: string;\n  duration: number;\n  description: string;\n}\n\ntype FormStep = 'patient' | 'service' | 'datetime' | 'details' | 'review';\ntype StepType = FormStep;\n\n// Define step order for navigation\nconst stepOrder: StepType[] = ['patient', 'service', 'datetime', 'details', 'review'];\n\n// Define step interface\ninterface Step {\n  id: StepType;\n  label: string;\n  icon: React.ComponentType<any>;\n  completed: boolean;\n}\n\nconst AppointmentForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  // const { selectedClinic } = useClinic();\n  const navigate = useNavigate();\n  const { id } = useParams();\n  const isEditMode = Boolean(id);\n  const isPatientUser = user?.role === 'patient';\n\n  // Form state\n  const [currentStep, setCurrentStep] = useState<FormStep>(isPatientUser ? 'service' : 'patient');\n  const [isLoading, setIsLoading] = useState(false);\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [filteredPatients, setFilteredPatients] = useState<Patient[]>([]);\n  // Use the actual clinic ID from the database (Clear - Fayoum Branch with schedules)\n  const [fieldErrors, setFieldErrors] = useState<Record<string, string>>({});\n  const [apiError, setApiError] = useState<string>('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  \n  // Enhanced debouncing and circuit breaker refs\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const fetchRequestRef = useRef<AbortController | null>(null);\n  const lastFetchParamsRef = useRef<string>('');\n  const circuitBreakerRef = useRef<{\n    failureCount: number;\n    lastFailureTime: number;\n    isOpen: boolean;\n  }>({ failureCount: 0, lastFailureTime: 0, isOpen: false });\n  const [formData, setFormData] = useState({\n    patientId: '',\n    dentistId: '',\n    service: '',\n    date: new Date().toISOString().split('T')[0], // Default to today's date\n    timeSlot: '',\n    notes: '',\n    emergency: false,\n    patientSearch: '',\n    clinicId: '' // Let user select clinic via branch selection\n  });\n  \n  // Multi-branch state\n  const [selectedBranch, setSelectedBranch] = useState<string>('');\n  const [branches, setBranches] = useState<string[]>([]);\n  const [filteredClinics, setFilteredClinics] = useState<Clinic[]>([]);\n  const [allClinics, setAllClinics] = useState<Clinic[]>([]);\n  \n  // Doctor availability state\n  const [availableDoctors, setAvailableDoctors] = useState<any[]>([]);\n  const [isLoadingDoctors, setIsLoadingDoctors] = useState(false);\n  \n  // Time slot state (align with service TimeSlot type so dentistId is available)\n  const [generatedTimeSlots, setGeneratedTimeSlots] = useState<TimeSlot[]>([]);\n  \n  // Get the form's selected clinic (not the global one from context)\n  const formSelectedClinic = useMemo(() => {\n    if (!formData.clinicId) return null;\n    return allClinics.find(clinic => clinic.id === formData.clinicId) || null;\n  }, [formData.clinicId, allClinics]);\n  const [isLoadingTimeSlots, setIsLoadingTimeSlots] = useState(false);\n  \n  // Services data\n  const services: ServiceOption[] = [\n    { value: 'consultation', label: t('appointments.services.consultation'), icon: '', duration: 30, description: t('appointments.services.consultationDesc') || 'Initial consultation and examination' },\n    { value: 'cleaning', label: t('appointments.services.cleaning'), icon: '', duration: 60, description: t('appointments.services.cleaningDesc') || 'Professional teeth cleaning' },\n    { value: 'filling', label: t('appointments.services.filling'), icon: '', duration: 90, description: t('appointments.services.fillingDesc') || 'Dental filling procedure' },\n    { value: 'crown', label: t('appointments.services.crown'), icon: '', duration: 120, description: t('appointments.services.crownDesc') || 'Crown placement procedure' },\n    { value: 'orthodontics', label: t('appointments.services.orthodontics'), icon: '', duration: 45, description: t('appointments.services.orthodonticsDesc') || 'Orthodontic treatment' },\n    { value: 'emergency', label: t('appointments.services.emergency'), icon: '', duration: 60, description: t('appointments.services.emergencyDesc') || 'Emergency dental care' }\n  ];\n\n\n  // Fetch user's appointment history for smart defaults\n  const fetchUserAppointmentHistory = async (patientId: string) => {\n    try {\n      const history = await appointmentService.getUserAppointmentHistory(patientId);\n      return history;\n    } catch (error) {\n      console.error('Error fetching user appointment history:', error);\n      return { data: [] };\n    }\n  };\n  \n  // Set smart defaults based on user's appointment history\n  const setSmartDefaults = async (patientId: string) => {\n    try {\n      setIsLoading(true);\n      const history = await fetchUserAppointmentHistory(patientId);\n      \n      // Type assertion to handle history data\n      const historyData = history as { data?: any[] };\n      \n      if (historyData && historyData.data && Array.isArray(historyData.data) && historyData.data.length > 0) {\n        // Get the most recent appointment\n        const recentAppointment = historyData.data[0];\n        \n        // Set service based on most frequently used service\n        if (recentAppointment.serviceType) {\n          setFormData(prev => ({\n            ...prev,\n            service: recentAppointment.serviceType\n          }));\n        }\n        \n        // Set default date to tomorrow\n        const tomorrow = new Date();\n        tomorrow.setDate(tomorrow.getDate() + 1);\n        setFormData(prev => ({\n          ...prev,\n          date: tomorrow.toISOString().split('T')[0]\n        }));\n        \n        // Show a toast notification that defaults were set\n        toast.success(t('appointmentForm.smartDefaultsApplied'), {\n          position: \"top-center\",\n          duration: 3000\n        });\n      }\n    } catch (error) {\n      console.error('Error setting smart defaults:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  // Sync clinicId with selectedClinic to ensure consistency\n  \n  // Enhanced function to fetch available time slots with better error handling\n  const fetchTimeSlotsImmediate = useCallback(async ({\n    date,\n    clinicId, \n    duration,\n    dentistId\n  }: {\n    date: string;\n    clinicId: string;\n    duration: number;\n    dentistId?: string;\n  }) => {\n    // Clear any previous error states\n    setApiError('');\n    // Removed: setIsDentistError(false);\n    \n    // Cancel any existing request to prevent race conditions\n    if (fetchRequestRef.current) {\n      fetchRequestRef.current.abort();\n    }\n    \n    // Create new abort controller\n    fetchRequestRef.current = new AbortController();\n    \n    setIsLoading(true);\n    \n    try {\n      // Use parameters for logging/debugging (fixes linter warning)\n      console.debug(`Fetching time slots for clinic ${clinicId} on ${date} with duration ${duration}${dentistId ? ` and dentist ${dentistId}` : ''}`);\n      \n      // Clear the request ref since it completed successfully\n      fetchRequestRef.current = null;\n      \n      \n      // Success! Reset circuit breaker\n      const circuitBreaker = circuitBreakerRef.current;\n      circuitBreaker.failureCount = 0;\n      circuitBreaker.isOpen = false;\n      \n      setApiError(''); // Clear any previous errors\n      \n    } catch (error: any) {\n      console.error('Error fetching time slots:', error);\n      \n      // Clear the request ref\n      fetchRequestRef.current = null;\n      \n      // Update circuit breaker on any error\n      const circuitBreaker = circuitBreakerRef.current;\n      circuitBreaker.failureCount++;\n      circuitBreaker.lastFailureTime = Date.now();\n      \n      // Open circuit breaker after 3 consecutive failures\n      if (circuitBreaker.failureCount >= 3) {\n        circuitBreaker.isOpen = true;\n      }\n      \n      // Handle specific error cases based on enhanced error messages\n      if (error.message && error.message.includes('dentist')) {\n        // Removed: setIsDentistError(true);\n        // More specific error message based on the type of dentist issue\n        if (error.message.includes('No dentists are scheduled')) {\n          setApiError('No dentists are scheduled to work on this day. Please select a different date or contact the clinic to confirm availability.');\n        } else {\n          setApiError('No dentists are available for this clinic. Please contact administration to assign dentists or select a different clinic.');\n        }\n        \n        // Don't show fallback slots for dentist availability issues\n        // setAvailableTimeSlots([]);\n        \n        // Reduce toast frequency when circuit breaker is active\n        if (circuitBreaker.failureCount < 3) {\n          toast.error(error.message, {\n        position: \"top-center\",\n            duration: 5000,\n        className: 'toast-error',\n      });\n        }\n      } else if (error.message && error.message.includes('Authentication')) {\n        setApiError('Session expired. Please log in again.');\n        // setAvailableTimeSlots([]);\n        \n        toast.error('Session expired. Please log in again.', {\n          position: \"top-center\",\n          duration: 4000,\n          className: 'toast-error',\n        });\n      } else {\n        // Other errors - show appropriate message\n        const errorMessage = error.message || 'Unable to load available time slots.';\n        setApiError(errorMessage);\n        // setAvailableTimeSlots([]);\n        \n        // Reduce toast frequency when circuit breaker is active\n        if (circuitBreaker.failureCount < 3) {\n          toast.error(errorMessage, {\n            position: \"top-center\",\n            duration: 4000,\n            className: 'toast-error',\n          });\n        }\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const fetchTimeSlots = useCallback(() => {\n    const clinicId = formData.clinicId;\n    \n    if (!formData.date) {\n      return;\n    }\n    \n    if (!clinicId) {\n      console.warn('Cannot fetch time slots - missing clinic ID');\n      return;\n    }\n    \n    // Validate date format\n    if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(formData.date)) {\n      console.error('Invalid date format:', formData.date);\n      return;\n    }\n    \n    // Get the selected service duration or default to 60 minutes\n    const selectedService = services.find(s => s.value === formData.service);\n    const duration = selectedService?.duration || 60;\n    \n    // Create unique request signature to prevent duplicate calls\n    const requestSignature = `${formData.date}-${duration}-${clinicId}`;\n    \n    // Skip if this exact request was just made\n    if (lastFetchParamsRef.current === requestSignature) {\n        return;\n    }\n      \n    // Circuit breaker logic for repeated failures\n    const now = Date.now();\n    const circuitBreaker = circuitBreakerRef.current;\n    \n    if (circuitBreaker.isOpen) {\n      // Check if circuit breaker should reset (after 30 seconds)\n      if (now - circuitBreaker.lastFailureTime > 30000) {\n        circuitBreaker.isOpen = false;\n        circuitBreaker.failureCount = 0;\n        } else {\n        return;\n      }\n    }\n    \n    // Clear existing timer to prevent overlapping requests\n    if (debounceTimerRef.current) {\n      clearTimeout(debounceTimerRef.current);\n    }\n    \n    // Update request signature and set debounced timer\n    lastFetchParamsRef.current = requestSignature;\n    \n    debounceTimerRef.current = setTimeout(() => {\n      const params = {\n        date: formData.date,\n        duration: duration,\n        dentistId: '', // Backend handles dentist availability\n        clinicId: clinicId\n      };\n      \n      fetchTimeSlotsImmediate(params);\n    }, 500); // Increased to 500ms for better debouncing\n  }, [formData.date, formData.service, formData.clinicId]);\n\n  // Enhanced memoized form data to prevent unnecessary fetchTimeSlots calls\n  const memoizedFormData = useMemo(() => {\n    const effectiveClinicId = formData.clinicId;\n    // Get service duration or default to 60 (services array is static)\n    const duration = formData.service === 'cleaning' ? 60 : formData.service === 'examination' ? 30 : 60;\n    \n    return {\n      date: formData.date,\n      service: formData.service,\n      clinicId: effectiveClinicId,\n      duration,\n      hasDate: !!formData.date && formData.date !== '',\n      hasService: !!formData.service && formData.service !== '',\n      hasClinic: !!effectiveClinicId,\n      // Include a stability key to prevent unnecessary changes - only include essential fields\n      stabilityKey: `${formData.date}-${duration}-${effectiveClinicId}`\n    };\n  }, [formData.date, formData.service, formData.clinicId]);\n\n  // Simplified useEffect - debouncing is now handled in fetchTimeSlots\n  useEffect(() => {\n    // Minimal logging in development mode\n    \n    // Only trigger fetch if we have required data - fetchTimeSlots handles all validation\n    if (memoizedFormData.hasDate && memoizedFormData.hasClinic) {\n      fetchTimeSlots();\n    } else {\n      // Clear time slots if missing required data\n      setApiError('');\n    }\n  }, [memoizedFormData.stabilityKey, fetchTimeSlots]);\n  \n  // Removed unused fetchAvailableTimeSlots function - now using optimized fetchTimeSlots with circuit breaker\n  \n  // Fallback slot generation removed - using proper error handling instead\n\n  // Save form data to session storage when it changes\n  useEffect(() => {\n    if (!isEditMode) { // Don't persist for edit mode\n      sessionStorage.setItem('appointmentFormData', JSON.stringify(formData));\n      sessionStorage.setItem('appointmentFormStep', currentStep);\n    }\n  }, [formData, currentStep, isEditMode]);\n\n  // Load saved form data on initial load\n  useEffect(() => {\n    if (!isEditMode) { // Don't load saved data in edit mode\n      const savedFormData = sessionStorage.getItem('appointmentFormData');\n      const savedStep = sessionStorage.getItem('appointmentFormStep');\n      \n      if (savedFormData) {\n        try {\n          const parsedData = JSON.parse(savedFormData);\n          // Only restore if we have meaningful data\n          if (parsedData.service || parsedData.date || parsedData.patientId) {\n            setFormData(parsedData);\n          }\n        } catch (e) {\n          console.error('Error parsing saved form data', e);\n        }\n      }\n      \n      if (savedStep && ['patient', 'service', 'datetime', 'details', 'review'].includes(savedStep)) {\n        setCurrentStep(savedStep as FormStep);\n      }\n    }\n  }, [isEditMode]);\n\n  // Load branches on mount\n  useEffect(() => {\n    const loadBranches = async () => {\n      try {\n        console.log(' Loading branches...');\n        const response = await getBranches();\n        console.log(' Branches response:', response);\n        if (response.success && response.data) {\n          setBranches(response.data);\n          console.log(' Branches loaded:', response.data);\n          // Auto-select first branch if only one exists\n          if (response.data.length === 1) {\n            setSelectedBranch(response.data[0]);\n            console.log(' Auto-selected branch:', response.data[0]);\n          }\n        } else {\n          console.warn(' No branches found in response');\n        }\n      } catch (error) {\n        console.error(' Error loading branches:', error);\n      }\n    };\n    loadBranches();\n  }, []);\n\n  // Load and filter clinics when branch changes\n  useEffect(() => {\n    const loadClinics = async () => {\n      try {\n        const response = await getAllClinics();\n        console.log(' Clinics response:', response);\n        if (response.success && response.data) {\n          // Store all clinics for lookup\n          setAllClinics(response.data);\n          \n          // Filter by selected branch\n          if (selectedBranch) {\n            const filtered = response.data.filter(\n              (c: Clinic) => c.branchName === selectedBranch\n            );\n            setFilteredClinics(filtered);\n            \n            // Auto-select clinic if only one in branch\n            if (filtered.length === 1) {\n              console.log(' Auto-selecting clinic for branch:', filtered[0].id);\n              setFormData(prev => ({\n                ...prev,\n                clinicId: filtered[0].id,\n              }));\n\n              console.log(' Auto-selected clinic:', filtered[0]);\n              // setSelectedClinic(filtered[0]);\n            } else if (filtered.length === 0) {\n              // Reset clinic ID if no clinics in branch\n              setFormData(prev => ({\n                ...prev,\n                clinicId: ''\n              }));\n            }\n          } else {\n            // Show all clinics if no branch selected\n            setFilteredClinics(response.data);\n          }\n        }\n      } catch (error) {\n        console.error('Error loading clinics:', error);\n      }\n    };\n    loadClinics();\n  }, [selectedBranch]);\n\n  // Load available doctors when clinic and date are selected\n  useEffect(() => {\n    const loadAvailableDoctors = async () => {\n      const clinicId = formData.clinicId;\n      \n      console.log(' loadAvailableDoctors - Clinic ID:', clinicId, 'Date:', formData.date);\n      console.log(' formData.clinicId:', formData.clinicId);\n      console.log(' selectedClinic?.id:');\n      \n      if (!clinicId || !formData.date) {\n        console.log(' Missing clinic or date, clearing doctors');\n        setAvailableDoctors([]);\n        return;\n      }\n      \n      try {\n        setIsLoadingDoctors(true);\n        const selectedDate = new Date(formData.date);\n        \n        console.log(` Calling getAvailableDoctorsForDay(${clinicId}, ${selectedDate})`);\n        const response = await getAvailableDoctorsForDay(clinicId, selectedDate);\n        console.log(' Doctor availability response:', response);\n        \n        if (response.success && response.data) {\n          setAvailableDoctors(response.data);\n          console.log(' Available Doctors:', response.data);\n  \n          console.log(` Loaded ${response.data.length} available doctors for ${formData.date}`);\n          \n          // If no doctors available, show helpful message\n          if (response.data.length === 0) {\n            setApiError('No doctors are scheduled for this date at the selected clinic. Please choose a different date or contact the clinic.');\n          } else {\n            // Clear error if doctors are available\n            if (apiError.includes('No doctors')) {\n              setApiError('');\n            }\n          }\n        }\n      } catch (error: any) {\n        console.error(' Error loading available doctors:', error);\n        setAvailableDoctors([]);\n        setApiError('Unable to load doctor availability. Please try again.');\n      } finally {\n        setIsLoadingDoctors(false);\n      }\n    };\n    \n    loadAvailableDoctors();\n    console.log('Available doctors updated:', availableDoctors);\n  }, [formData.clinicId, formData.date, apiError]);\n\n  // Generate time slots when doctor is selected\n  useEffect(() => {\n    const generateTimeSlots = async () => {\n      // Need date and either a selected doctor or available doctors for auto-assign\n      if (!formData.date) {\n        setGeneratedTimeSlots([]);\n        return;\n      }\n\n      const clinicId = formData.clinicId;\n      if (!clinicId) {\n        setGeneratedTimeSlots([]);\n        return;\n      }\n\n      try {\n        setIsLoadingTimeSlots(true);\n\n        let schedulesToUse: DoctorSchedule[] = [];\n\n        // Auto-assignment: Use all available doctors' schedules\n        if (availableDoctors.length > 0) {\n          console.log(' Available doctors data structure:', availableDoctors);\n          // Extract schedules from the API response structure\n          // The API returns objects with {doctor, clinic, schedules: [...]}\n          schedulesToUse = availableDoctors.flatMap((doctorData: any) => {\n            if (doctorData.schedules && Array.isArray(doctorData.schedules)) {\n              console.log(' Processing schedules for doctor:', doctorData.doctor, 'Schedules:', doctorData.schedules);\n              return doctorData.schedules.map((schedule: any) => ({\n                ...schedule,\n                doctorId: doctorData.doctor,\n                clinicId: doctorData.clinic\n              }));\n            }\n            console.log(' No schedules found for doctor:', doctorData);\n            return [];\n          });\n          console.log(' Extracted schedules:', schedulesToUse);\n        }\n\n        if (schedulesToUse.length === 0) {\n          setGeneratedTimeSlots([]);\n          return;\n        }\n\n        // Fetch actually booked slots from backend\n        console.log(' Fetching booked slots for:', { date: formData.date, clinicId, doctorId: formData.dentistId });\n        const bookedSlots = await appointmentService.getBookedSlots(\n          formData.date,\n          clinicId,\n          formData.dentistId || undefined\n        );\n        \n        console.log(` Found ${bookedSlots.length} booked slots:`, bookedSlots);\n\n        // Generate time slots\n        const slots = generateTimeSlotsFromMultipleSchedules(schedulesToUse, bookedSlots);\n        \n        setGeneratedTimeSlots(slots);\n        \n        const availableCount = slots.filter(s => s.available).length;\n        console.log(` Generated ${slots.length} time slots (${availableCount} available, ${bookedSlots.length} booked) for ${formData.date}`);\n        \n      } catch (error) {\n        console.error('Error generating time slots:', error);\n        setGeneratedTimeSlots([]);\n      } finally {\n        setIsLoadingTimeSlots(false);\n      }\n    };\n\n    generateTimeSlots();\n  }, [formData.date, formData.dentistId, formData.clinicId, availableDoctors]);\n\n  // Sync clinicId when selectedClinic changes - Removed as we're hardcoding the clinic ID\n  /* useEffect(() => {\n    if (selectedClinic?.id && !formData.clinicId) {\n      setFormData(prev => ({\n        ...prev,\n        clinicId: selectedClinic.id\n      }));\n    }\n  }, [selectedClinic?.id, formData.clinicId]); */\n  // Set clinic ID to hardcoded value\n  \n  // Remove redundant useEffect - time slot fetching is now handled by the optimized fetchTimeSlots function\n  // with debouncing in the memoized form data useEffect above\n  \n  // State for step transition animations\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const [transitionDirection, setTransitionDirection] = useState('next');\n  \n  // Track completed steps for navigation and visual indicators\n  const [completedSteps, setCompletedSteps] = useState<FormStep[]>([]);\n  \n  // Step navigation functions with transition effects\n  const goToNextStep = () => {\n    if (currentStep === 'patient' && (isPatientUser || formData.patientId)) {\n      setTransitionDirection('next');\n      setIsTransitioning(true);\n      setCompletedSteps(prev => [...new Set([...prev, 'patient' as FormStep])]);\n      \n      setTimeout(() => {\n        setCurrentStep('service');\n        setIsTransitioning(false);\n      }, 300);\n    } else if (currentStep === 'service') {\n      if (!formData.service) {\n        toast.error(t('appointmentForm.error_selectService'));\n        return;\n      }\n      setTransitionDirection('next');\n      setIsTransitioning(true);\n      setCompletedSteps(prev => [...new Set([...prev, 'service' as FormStep])]);\n      \n      setTimeout(() => {\n        setCurrentStep('datetime');\n        setIsTransitioning(false);\n      }, 300);\n    } else if (currentStep === 'datetime' && formData.date && formData.timeSlot) {\n      setTransitionDirection('next');\n      setIsTransitioning(true);\n      setCompletedSteps(prev => [...new Set([...prev, 'datetime' as FormStep])]);\n      \n      setTimeout(() => {\n        setCurrentStep('details');\n        setIsTransitioning(false);\n      }, 300);\n    } else if (currentStep === 'details') {\n      setTransitionDirection('next');\n      setIsTransitioning(true);\n      setCompletedSteps(prev => [...new Set([...prev, 'details' as FormStep])]);\n      \n      setTimeout(() => {\n        setCurrentStep('review');\n        setIsTransitioning(false);\n      }, 300);\n    } else {\n      // Show validation error if required fields are missing\n      toast.error(t('appointmentForm.error_requiredFields'));\n    }\n  };\n\n  const goToPreviousStep = () => {\n    setTransitionDirection('prev');\n    setIsTransitioning(true);\n    \n    setTimeout(() => {\n      if (currentStep === 'service' && !isPatientUser) {\n        setCurrentStep('patient');\n      } else if (currentStep === 'datetime') {\n        setCurrentStep('service');\n      } else if (currentStep === 'details') {\n        setCurrentStep('datetime');\n      } else if (currentStep === 'review') {\n        setCurrentStep('details');\n      }\n      setIsTransitioning(false);\n    }, 300);\n  };\n  \n  // Function to jump to a specific step (if allowed)\n  const jumpToStep = (step: StepType) => {\n    // Only allow jumping to steps that are already completed\n    if (completedSteps.includes(step) || step === currentStep) {\n      setTransitionDirection(stepOrder.indexOf(step) < stepOrder.indexOf(currentStep) ? 'prev' : 'next');\n      setIsTransitioning(true);\n      \n      setTimeout(() => {\n        setCurrentStep(step);\n        setIsTransitioning(false);\n      }, 300);\n    }\n  };\n\n  // Filter patients based on search input\n  useEffect(() => {\n    if (formData.patientSearch.trim() === '') {\n      setFilteredPatients(patients);\n    } else {\n      const searchTerm = formData.patientSearch.toLowerCase();\n      const filtered = patients.filter(patient => {\n        const fullName = `${patient.firstName} ${patient.lastName}`.toLowerCase();\n        return fullName.includes(searchTerm) || \n               patient.email.toLowerCase().includes(searchTerm) || \n               patient.phone.includes(searchTerm);\n      });\n      setFilteredPatients(filtered);\n    }\n  }, [formData.patientSearch, patients]);\n\n  const fetchInitialData = async () => {\n    try {\n      setIsLoading(true);\n\n      // Fetch patients based on user type\n      // Note: Dentists are auto-assigned by backend, no need to fetch them for selection\n      if (!isPatientUser) {\n        // For staff/admin users: fetch all patients for selection\n        try {\n          const patientsData = await patientService.getPatients();\n          setPatients(patientsData.data);\n          setFilteredPatients(patientsData.data);\n        } catch (error) {\n          console.error('Error fetching patients:', error);\n          setPatients([]);\n          setFilteredPatients([]);\n        }\n      } else if (isPatientUser && user?.id) {\n        // For patient users: fetch their patient record using userId\n        try {\n          const patientsData = await patientService.getPatientsByUserId(user.id);\n          \n          let patientRecord = patientsData.data.length > 0 ? patientsData.data[0] : null;\n          \n          if (!patientRecord) {\n            // Create a patient record for this user if it doesn't exist\n            const newPatientData = {\n              firstName: user.firstName || user.email.split('@')[0],\n              lastName: user.lastName || '',\n              email: user.email,\n              phone: user.phone || '0000000000', // Provide default phone if not available\n              dateOfBirth: user.dateOfBirth ? new Date(user.dateOfBirth) : new Date('1990-01-01'), // Provide default DOB\n              gender: 'male' as const, // Default gender\n              address: {\n                street: '',\n                city: '',\n                state: '',\n                zipCode: '',\n                country: ''\n              },\n              medicalHistory: {\n                allergies: [],\n                medications: [],\n                conditions: [],\n                notes: ''\n              },\n              treatmentRecords: [], // Add required treatment records property\n              preferredClinicId: formData.clinicId, // Use fallback clinic\n              userId: user.id, // Link to user account\n            };\n            \n            const createdPatient = await patientService.createPatient(newPatientData);\n            patientRecord = createdPatient; // createPatient returns the patient data directly\n          }\n          \n          // Set the patient in the array and pre-select it\n          setPatients([patientRecord]);\n          setFilteredPatients([patientRecord]);\n          setFormData(prev => ({ ...prev, patientId: patientRecord.id }));\n          \n        } catch (error) {\n          console.error('Error fetching/creating patient record for logged-in user:', error);\n          // Show error message - patient record is required\n          customToast.error(t('appointmentForm.error_patientRecordRequired') || 'Patient record is required. Please contact support to create your patient profile.');\n          setPatients([]);\n          setFilteredPatients([]);\n        }\n      }\n\n      // If editing, fetch appointment data\n      if (isEditMode && id) {\n        try {\n          const appointment = await appointmentService.getAppointment(id);\n          setFormData({\n            patientId: appointment.patientId,\n            dentistId: appointment.dentistId || '',\n            service: appointment.serviceType,\n            date: typeof appointment.date === 'string' ? appointment.date : appointment.date.toISOString().split('T')[0],\n            timeSlot: appointment.timeSlot,\n            notes: appointment.notes || '',\n            emergency: false,\n            patientSearch: '',\n            clinicId: appointment.clinicId\n          });\n        } catch (error) {\n          console.error('Error fetching appointment:', error);\n          toast.error(t('appointmentForm.error_failedToLoad'));\n        }\n      } else {\n        // Set default date to tomorrow\n        const tomorrow = new Date();\n        tomorrow.setDate(tomorrow.getDate() + 1);\n        setFormData(prev => ({\n          ...prev,\n          date: tomorrow.toISOString().split('T')[0]\n        }));\n      }\n    } catch (error: any) {\n      console.error('Error fetching initial data:', error);\n      toast.error(t('appointmentForm.error_failedToLoad'));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchInitialData();\n  }, [isEditMode, isPatientUser, user, id, t]); // Removed appointmentService to prevent circular dependency\n\n  // Patient record selection is now handled in fetchInitialData\n  // This useEffect applies smart defaults once the patient record is loaded\n  useEffect(() => {\n    if (isPatientUser && user && formData.patientId && patients.length > 0) {\n      console.log('Applying smart defaults for patient user with patientId:', formData.patientId);\n        \n        // Apply smart defaults based on patient's appointment history\n      setSmartDefaults(formData.patientId);\n      \n      // Clear any previous patient selection errors\n      setFieldErrors(prev => ({\n        ...prev,\n        patientId: '' // Clear any previous errors\n      }));\n    }\n  }, [isPatientUser, user, formData.patientId, patients, t]);\n\n  const validateCurrentStep = async (): Promise<boolean> => {\n    // Create a copy of formData to ensure we have the latest data\n    const currentFormData = { ...formData };\n    \n    // For patient users, patient ID should already be set by fetchInitialData\n    // If not set, there was an error during initialization\n    if (currentStep === 'datetime' && isPatientUser && user && !formData.patientId) {\n      // Patient ID should have been set during initialization\n      // Show error and suggest refreshing\n      customToast.error(t('appointmentForm.error_patientRecordNotLoaded') || 'Patient record not loaded. Please refresh the page and try again.');\n        return false;\n    }\n    \n    \n    // Use the centralized validation utility with the current form data\n    console.log(' DEBUG - Validating step:', currentStep, 'with data:', currentFormData);\n    const validationResult = validateAppointmentForm(currentFormData, t, currentStep);\n    \n    \n    // Display all errors for the current step\n    if (!validationResult.isValid) {\n      console.log(' DEBUG - VALIDATION FAILED - Specific errors:', validationResult.errors);\n      // Show the first error message as a warning instead of error\n      const firstError = Object.values(validationResult.errors)[0];\n      customToast.warning(firstError, {\n        position: \"top-center\",\n        duration: 3000\n      });\n      \n      // For datetime step, allow proceeding despite warnings if date and timeSlot are set\n      if (currentStep === 'datetime' && formData.date && formData.timeSlot) {\n        console.log(' DEBUG - Allowing datetime step to proceed despite validation warnings');\n        console.log(' DEBUG - Date:', formData.date, 'TimeSlot:', formData.timeSlot);\n        console.log(' DEBUG - PatientId status:', formData.patientId);\n        \n        // For non-patient users, patientId validation should happen in the patient step, not datetime step\n        if (!isPatientUser && !formData.patientId) {\n          console.log(' DEBUG - Non-patient user without patientId - this might be the issue');\n          // Show specific error for non-patient users\n          customToast.error(t('appointmentForm.error_selectPatientFirst') || 'Please go back and select a patient first.');\n          return false;\n        }\n        \n        return true;\n      }\n      \n      return false;\n    }\n    \n    // Less strict validation for time slot availability\n    if (currentStep === 'datetime' && formData.date && formData.timeSlot) {\n      const clinicId = formData.clinicId;\n      // Run validation in background but don't block UI\n      setTimeout(async () => {\n        const timeSlotValidation = await validateTimeSlotAvailability(\n          appointmentService,\n          { date: formData.date, timeSlot: formData.timeSlot },\n          clinicId,\n          isEditMode ? id : undefined\n        );\n        \n        if (!timeSlotValidation.isValid) {\n          // Show as warning instead of error\n          customToast.warning(timeSlotValidation.errors.timeSlot || t('appointmentForm.warning_timeSlotConflict'), {\n            position: \"top-center\",\n            duration: 3000\n          });\n        }\n      }, 100);\n    }\n    \n    console.log(' DEBUG - Validation passed, returning true');\n    return true;\n  };\n\n  const handleStepSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    console.log('Form step submit:', currentStep);\n    \n    const isValid = await validateCurrentStep();\n    if (!isValid) {\n      console.log('Validation failed for step:', currentStep);\n      return;\n    }\n    \n    if (currentStep === 'review') {\n      await handleFinalSubmit();\n    } else {\n      goToNextStep();\n    }\n  };\n\n  // This function is replaced by handleFinalSubmit and handleStepSubmit\n  // Removing commented code to fix syntax errors\n\n  // Handle auto-booking functionality - assigns next slot after last booking\n  // Temporarily commented out to fix build error - kept for future use\n  /* const handleAssignFirstAvailableSlot = async () => {\n    setIsLoading(true);\n    setApiimage.pngError('');\n\n    try {\n        // Validation for patient is important for the whole form, but for slots we just need date/service/clinic\n        if (!formData.service || !formData.date) {\n            toast.error(t('appointmentForm.error_fillRequiredFieldsForSlot') || 'Please select a service and date first.');\n        setIsLoading(false);\n        return;\n      }\n\n      const clinicId = FALLBACK_CLINIC_ID;\n        const selectedServiceDetails = services.find(s => s.value === formData.service);\n        const duration = selectedServiceDetails?.duration || 45;\n\n        // Get the next available slot after the last booked appointment\n        const nextSlot = await appointmentService.getNextSlotAfterLastBooking({\n            date: formData.date,\n            clinicId,\n            duration,\n        });\n\n        if (nextSlot && nextSlot.time) {\n            console.log('Assigning time slot:', nextSlot.time);\n            handleInputChange('timeSlot', nextSlot.time);\n            toast.success(`${t('appointmentForm.success_slotAssigned')} ${nextSlot.time}`);\n      } else {\n            const errorMessage = t('appointmentForm.error_noSlotsFound') || 'No available time slots found after last booking for the selected date.';\n            setApiError(errorMessage);\n            toast.error(errorMessage);\n        }\n\n    } catch (error: any) {\n        console.error('Error assigning next available slot:', error);\n        const errorMessage = error.message || t('appointmentForm.error_failedToGetSlots') || 'Failed to get next available slot.';\n        setApiError(errorMessage);\n        toast.error(errorMessage);\n    } finally {\n      setIsLoading(false);\n    }\n  }; */\n\n  const handleFinalSubmit = async () => {\n    setIsLoading(true);\n    setIsSubmitting(true);\n    \n    // Create a loading toast\n    const loadingToast = customToast.loading(t('appointmentForm.creatingAppointment', 'Creating your appointment...'));\n\n    try {\n      // Debug authentication status\n      const token = localStorage.getItem('token');\n      console.log(' Final Submit Authentication Check:', {\n        hasToken: !!token,\n        tokenLength: token?.length || 0,\n        userLoggedIn: !!user,\n        userEmail: user?.email,\n        userRole: user?.role,\n        userId: user?.id\n      });\n      \n      // Validate required fields before submission\n      if (!formData.patientId) {\n        toast.error(t('appointmentForm.error_noPatientRecord') || 'No patient record found. Please contact support to create a patient profile.');\n        setIsLoading(false);\n        return;\n      }\n\n      if (!formData.service) {\n        toast.error(t('appointmentForm.error_serviceRequired') || 'Please select a service.');\n        setIsLoading(false);\n        return;\n      }\n\n      if (!formData.date) {\n        toast.error(t('appointmentForm.error_dateRequired') || 'Please select a date.');\n        setIsLoading(false);\n        return;\n      }\n\n      if (!formData.timeSlot) {\n        toast.error(t('appointmentForm.error_timeSlotRequired') || 'Please select a time slot.');\n        setIsLoading(false);\n        return;\n      }\n\n      // Ensure clinicId is set to hardcoded value\n      const clinicId = formData.clinicId;\n      if (!clinicId) {\n        toast.error(t('appointmentForm.error_clinicRequired') || 'No clinic selected. Please select a clinic.');\n        setIsLoading(false);\n        return;\n      }\n\n      // Ensure date is in correct format (YYYY-MM-DD)\n      let formattedDate = formData.date;\n      if (formData.date.includes('T')) {\n        formattedDate = formData.date.split('T')[0];\n      }\n\n      // Create appointment data with all required fields\n      const appointmentData: any = {\n        patientId: formData.patientId,\n        serviceType: formData.service, // Fixed: use 'serviceType' to match backend expectation\n        date: formattedDate,\n        timeSlot: formData.timeSlot,\n        notes: formData.notes || '',\n        emergency: formData.emergency || false,\n        clinicId: clinicId\n      };\n\n      console.log(' Appointment data before dentist assignment:', appointmentData);\n      console.log(' Form data dentistId:', formData.dentistId);\n\n      // Include dentistId if it was auto-assigned or explicitly selected\n      if (formData.dentistId && formData.dentistId.trim() !== '') {\n        appointmentData.dentistId = formData.dentistId;\n        console.log('Dentist assigned:', formData.dentistId, 'for user type:', isPatientUser ? 'patient' : 'staff/admin');\n      } else {\n        // Backend will auto-assign the best available dentist\n        console.log('No dentist specified - backend will auto-assign based on availability and clinic');\n      }\n\n      console.log(' Final appointment data being sent:', appointmentData);\n\n\n\n      // Validate appointment data before submission\n      const validation = validateAppointmentData(appointmentData);\n      if (!validation.isValid) {\n        const errorMessage = validation.errors.join('; ');\n        console.error('Client-side validation failed:', validation.errors);\n        toast.error(`Validation failed: ${errorMessage}`);\n        setIsLoading(false);\n        return;\n      }\n\n      // Check for time slot conflicts before creating appointment\n      try {\n        console.log('Checking time slot conflict for:', {\n          date: appointmentData.date,\n          timeSlot: appointmentData.timeSlot,\n          clinicId: appointmentData.clinicId\n        });\n        \n        const hasConflict = await appointmentService.checkTimeSlotConflict({\n          date: appointmentData.date,\n          timeSlot: appointmentData.timeSlot,\n          clinicId: appointmentData.clinicId,\n          dentistId: appointmentData.dentistId,\n          excludeAppointmentId: isEditMode ? id : undefined\n        });\n        \n        if (hasConflict) {\n          toast.error(t('appointmentForm.error_timeSlotConflict') || 'This time slot is no longer available. Please select another time.');\n          setIsLoading(false);\n          return;\n        }\n      } catch (conflictError: any) {\n        console.error('Conflict check failed:', conflictError);\n        toast.error(conflictError.message || 'Failed to verify time slot availability. Please try again.');\n        setIsLoading(false);\n        return;\n      }\n\n      // Log the exact data being sent for debugging\n      console.log('Submitting appointment data:', appointmentData);\n\n      // Create or update appointment\n      if (isEditMode && id) {\n        await appointmentService.updateAppointment(id, appointmentData);\n        toast.dismiss(loadingToast);\n        customToast.success(t('appointmentForm.success_updated'));\n      } else {\n        await appointmentService.createAppointment(appointmentData);\n        toast.dismiss(loadingToast);\n        customToast.success(t('appointmentForm.success_created'));\n        \n        // Clear saved form data after successful submission\n        sessionStorage.removeItem('appointmentFormData');\n        sessionStorage.removeItem('appointmentFormStep');\n      }\n\n      // Navigate back to appointments list\n      navigate('/appointments');\n    } catch (error: any) {\n      // Dismiss loading toast on error\n      toast.dismiss(loadingToast);\n      console.error('Error saving appointment:', error);\n      \n      // Ensure clinicId is accessible in this scope\n      const clinicId = formData.clinicId;\n      \n      // Provide more specific error messages based on error type\n      if (error.response) {\n        const { status, data } = error.response;\n        \n        if (status === 403) {\n          toast.error(t('appointmentForm.error_permissionDenied') || 'Access denied. You don\\'t have permission for this action.');\n        } else if (status === 422 && data?.errors) {\n          // Show validation errors\n          const firstError = Object.values(data.errors)[0];\n          toast.error(firstError as string || t('appointmentForm.error_validationFailed'));\n        } else if (status === 409) {\n          toast.error(t('appointmentForm.error_timeSlotConflict') || 'This time slot is no longer available. Please select another time.');\n        } else if (status === 404) {\n          // Check if the error is specifically about /appointments endpoint\n          if (data?.message && data.message.includes('/appointments')) {\n            toast.error('The appointment service is currently unavailable. Please try again later.');\n          } else {\n            toast.error(t('appointmentForm.error_resourceNotFound') || 'Resource not found. Please try again later.');\n          }\n        } else if (status === 500) {\n          toast.error(t('appointmentForm.error_serverError') || 'Server error occurred. Please try again later.');\n        } else if (status === 400) {\n          toast.error(t('appointmentForm.error_badRequest') || 'Invalid data provided. Please check all fields and try again.');\n          // Log the specific data that caused the error for debugging\n          console.log('Bad Request Data:', {\n            patientId: formData.patientId,\n            serviceType: formData.service,\n            date: formData.date,\n            timeSlot: formData.timeSlot,\n            clinicId: clinicId,\n            dentistId: '6879369cf9594e20abb3d14e',\n            notes: formData.notes || '',\n            emergency: formData.emergency || false\n          });\n          // If the response contains specific error details, log and display them\n          if (data && data.message) {\n            console.log('Server Error Details:', data.message);\n            toast.error(`${t('appointmentForm.error_badRequest')}: ${data.message}`);\n          } else if (data && data.errors) {\n            // Handle detailed validation errors if provided\n            const errorMessages = Object.values(data.errors).join(', ');\n            console.log('Validation Errors:', errorMessages);\n            toast.error(`${t('appointmentForm.error_badRequest')}: ${errorMessages}`);\n          }\n        } else {\n          toast.error(`${t('appointmentForm.error_failedToSave')}: ${data?.message || ''}` || 'Failed to save appointment. Please try again.');\n        }\n      } else if (error.message && error.message.includes('permission')) {\n        toast.error(t('appointmentForm.error_permissionDenied') || 'Access denied. Insufficient permissions.');\n      } else if (error.code === 'ECONNREFUSED' || error.code === 'ERR_CONNECTION_RESET') {\n        toast.error(t('appointmentForm.error_connectionFailed') || 'Connection to server failed. Please check your internet connection.');\n      } else if (error.code === 'ETIMEDOUT') {\n        toast.error(t('appointmentForm.error_requestTimeout') || 'Request timed out. Please try again.');\n      } else {\n        toast.error(`${t('appointmentForm.error_failedToSave')}: ${error.message || ''}` || 'Failed to save appointment. Please try again.');\n      }\n    } finally {\n      setIsLoading(false);\n      setIsSubmitting(false);\n    }\n  };\n\n  // Comprehensive client-side validation function\n  const validateAppointmentData = (data: any): { isValid: boolean; errors: string[] } => {\n    const errors: string[] = [];\n    \n    // Validate required fields\n    if (!data.patientId) {\n      errors.push('Patient ID is required');\n    }\n    \n    if (!data.service && !data.serviceType) {\n      errors.push('Service is required');\n    }\n    \n    if (!data.clinicId) {\n      errors.push('Clinic ID is required');\n    }\n    \n    // Dentist ID is optional - backend can auto-assign if not provided\n    \n    // Validate date format (YYYY-MM-DD)\n    if (!data.date) {\n      errors.push('Date is required');\n    } else if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(data.date)) {\n      errors.push('Date must be in YYYY-MM-DD format');\n    }\n    \n    // Validate time slot format (HH:mm)\n    if (!data.timeSlot) {\n      errors.push('Time slot is required');\n    } else if (!/^\\d{2}:\\d{2}$/.test(data.timeSlot)) {\n      errors.push('Time slot must be in HH:mm format');\n    }\n    \n    // Validate service against allowed values\n    const allowedServices = ['consultation', 'cleaning', 'filling', 'crown', 'extraction', 'whitening', 'emergency'];\n    if (data.service && !allowedServices.includes(data.service)) {\n      errors.push(`Service must be one of: ${allowedServices.join(', ')}`);\n    }\n    \n    // Validate MongoDB ObjectID format for IDs\n    const objectIdRegex = /^[0-9a-fA-F]{24}$/;\n    if (data.patientId && !objectIdRegex.test(data.patientId)) {\n      errors.push('Patient ID must be a valid MongoDB ObjectID');\n    }\n    \n    if (data.clinicId && !objectIdRegex.test(data.clinicId)) {\n      errors.push('Clinic ID must be a valid MongoDB ObjectID');\n    }\n    \n    // Only validate dentist ID format if provided (it's optional)\n    if (data.dentistId && !objectIdRegex.test(data.dentistId)) {\n      errors.push('Dentist ID must be a valid MongoDB ObjectID');\n    }\n    \n    // Validate date is not in the past (except for today)\n    const selectedDate = new Date(data.date);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    if (selectedDate < today) {\n      errors.push('Cannot schedule appointments for past dates');\n    }\n    \n    // Validate notes length\n    if (data.notes && data.notes.length > 500) {\n      errors.push('Notes cannot exceed 500 characters');\n    }\n    \n    return {\n      isValid: errors.length === 0,\n      errors\n    };\n  };\n\n  // Get the selected service details\n  const selectedService = services.find(s => s.value === formData.service);\n\n  // Get the selected patient details\n  const selectedPatient = patients.find(p => p.id === formData.patientId);\n\n  // Add this function after the other utility functions\n  const validateField = (fieldName: keyof FormFields, value: FormFields[keyof FormFields]): void => {\n    // Create a partial form data object with just this field\n    const fieldData = {\n      ...formData,\n      [fieldName]: value\n    };\n    \n    // Use the existing validation utility to validate just this field\n    const validationResult = validateAppointmentForm(fieldData, t, currentStep);\n    \n    // Update the field errors state\n    if (!validationResult.isValid && validationResult.errors[fieldName]) {\n      setFieldErrors(prev => ({\n        ...prev,\n        [fieldName]: validationResult.errors[fieldName]\n      }));\n    } else {\n      // Clear the error if the field is now valid\n      setFieldErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[fieldName];\n        return newErrors;\n      });\n    }\n  };\n\n  // Modify the handleInputChange function to clear errors when a field changes\ninterface FormFields {\n  patientId: string;\n  dentistId: string;\n  service: string;\n  date: string;\n  timeSlot: string;\n  notes: string;\n  emergency: boolean;\n  patientSearch: string;\n  clinicId: string;\n}\n\nconst handleInputChange = (field: keyof FormFields, value: FormFields[keyof FormFields]) => {\n  console.log(` handleInputChange called: field=\"${field}\", value=`, value);\n  setFormData(prev => {\n    const newData = {\n      ...prev,\n      [field]: value,\n    };\n    console.log(` Updated formData.${field}:`, newData[field]);\n    return newData;\n  });    // Clear error when user starts typing\n    if (fieldErrors[field]) {\n      setFieldErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  // Progress steps\n  const steps: Step[] = [\n    { id: 'patient', label: t('appointmentForm.step_patient'), icon: User, completed: isPatientUser || Boolean(formData.patientId) },\n    { id: 'service', label: t('appointmentForm.step_service'), icon: Stethoscope, completed: Boolean(formData.service) },\n    { id: 'datetime', label: t('appointmentForm.step_datetime'), icon: Calendar, completed: Boolean(formData.date) },\n    { id: 'details', label: t('appointmentForm.step_details'), icon: AlertTriangle, completed: true },\n    { id: 'review', label: t('appointmentForm.step_review'), icon: CheckCircle, completed: false }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50\">\n      {/* Header Section */}\n      <div className=\"bg-white shadow-sm border-b border-gray-100\">\n        <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900 flex items-center\">\n                <div className=\"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center mr-4\">\n                  <Calendar className=\"h-5 w-5 text-white\" />\n                </div>\n          {isEditMode ? t('appointmentForm.title_edit') : t('appointmentForm.title_new')}\n        </h1>\n              <p className=\"mt-2 text-lg text-gray-600\">\n          {t('appointmentForm.subtitle')}\n        </p>\n            </div>\n            <div className=\"hidden lg:flex items-center space-x-2 text-sm text-gray-500\">\n              <div className=\"flex items-center\">\n                <div className=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></div>\n                {t('appointmentForm.quickEasy')}\n              </div>\n              <div className=\"flex items-center\">\n                <div className=\"w-2 h-2 bg-blue-400 rounded-full mr-2\"></div>\n                {t('appointmentForm.secureBooking')}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8\">\n        <div className=\"flex flex-col lg:grid lg:grid-cols-4 gap-6 lg:gap-8\">\n          {/* Progress Sidebar */}\n          <div className=\"order-2 lg:order-1 lg:col-span-1\">\n            <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-4 sm:p-6 lg:sticky lg:top-8\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4 lg:mb-6 text-center lg:text-left\">{t('appointmentForm.bookingProgress')}</h3>\n\n              <div className=\"flex lg:flex-col lg:space-y-4 lg:space-x-0 space-x-3 lg:space-x-0 overflow-x-auto lg:overflow-x-visible pb-4 lg:pb-0 scrollbar-hide\">\n              {steps.map((step, stepIdx) => {\n                const isCurrent = step.id === currentStep;\n                const isCompleted = completedSteps.includes(step.id) || stepOrder.indexOf(step.id) < stepOrder.indexOf(currentStep);\n                const isClickable = isCompleted || step.id === currentStep;\n                \n                return (\n                    <div key={step.id} className=\"relative\">\n                    <button\n                      type=\"button\"\n                      onClick={() => isClickable && jumpToStep(step.id)}\n                      disabled={!isClickable}\n                        className={`w-full lg:w-auto min-w-[120px] lg:min-w-0 flex flex-col lg:flex-row items-center p-3 lg:p-4 rounded-xl border transition-all duration-300 ${\n                          isCurrent \n                            ? 'bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 shadow-md transform scale-105' \n                            : isCompleted\n                              ? 'bg-green-50 border-green-200 hover:shadow-md hover:scale-105'\n                              : 'bg-gray-50 border-gray-200 cursor-not-allowed'\n                        }`}\n                    >\n                      {isCompleted ? (\n                          <div className=\"w-10 h-10 bg-gradient-to-r from-green-400 to-green-500 rounded-xl flex items-center justify-center\">\n                            <CheckIcon className=\"h-5 w-5 text-white\" />\n                          </div>\n                      ) : isCurrent ? (\n                          <div className=\"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl flex items-center justify-center animate-pulse\">\n                            <step.icon className=\"h-5 w-5 text-white\" />\n                          </div>\n                        ) : (\n                          <div className=\"w-10 h-10 bg-gray-300 rounded-xl flex items-center justify-center\">\n                            <step.icon className=\"h-5 w-5 text-gray-500\" />\n                          </div>\n                        )}\n                        \n                        <div className=\"mt-2 lg:mt-0 lg:ml-4 text-center lg:text-left\">\n                          <p className={`font-semibold text-xs lg:text-sm ${\n                            isCurrent ? 'text-blue-700' : isCompleted ? 'text-green-700' : 'text-gray-500'\n                          }`}>\n                        {step.label}\n                          </p>\n                          <p className={`text-xs hidden lg:block ${\n                            isCurrent ? 'text-blue-600' : isCompleted ? 'text-green-600' : 'text-gray-400'\n                          }`}>\n                            {isCurrent ? t('appointmentForm.stepStatus_inProgress') : isCompleted ? t('appointmentForm.stepStatus_completed') : t('appointmentForm.stepStatus_pending')}\n                          </p>\n                        </div>\n                        \n                        {isCurrent && (\n                          <div className=\"ml-auto\">\n                            <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-ping\"></div>\n                          </div>\n                        )}\n                    </button>\n                    \n                    {stepIdx !== steps.length - 1 && (\n                        <div className=\"flex justify-center py-2\">\n                          <div className={`w-0.5 h-8 ${isCompleted ? 'bg-green-300' : 'bg-gray-200'} transition-all duration-500`}></div>\n                      </div>\n                    )}\n                    </div>\n                );\n              })}\n              </div>\n        </div>\n\n            {/* Help Card */}\n            <div className=\"mt-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white\">\n              <div className=\"flex items-center mb-4\">\n                <div className=\"w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center mr-3\">\n                  <Phone className=\"h-4 w-4\" />\n                </div>\n                <h4 className=\"font-semibold\">{t('appointmentForm.needHelp')}</h4>\n              </div>\n              <p className=\"text-blue-100 text-sm mb-4\">\n                {t('appointmentForm.supportMessage')}\n              </p>\n              <button className=\"bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200\">\n                {t('appointmentForm.contactSupport')}\n              </button>\n            </div>\n          </div>\n\n          {/* Main Form Content */}\n          <div className=\"order-1 lg:order-2 lg:col-span-3\">\n            <form onSubmit={handleStepSubmit} className=\"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden\">\n              {/* Step Header */}\n              <div className=\"bg-gradient-to-r from-blue-500 to-indigo-600 p-4 sm:p-6 text-white\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h2 className=\"text-xl font-bold flex items-center\">\n                      {steps.find(s => s.id === currentStep)?.icon && (\n                        <div className=\"w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center mr-3\">\n                          {React.createElement(steps.find(s => s.id === currentStep)?.icon || Calendar, { className: \"h-4 w-4\" })}\n                        </div>\n                      )}\n                      {steps.find(s => s.id === currentStep)?.label}\n                    </h2>\n                    <p className=\"text-blue-100 mt-1\">\n                      {currentStep === 'patient' && t('appointmentForm.stepDescription_patient')}\n                      {currentStep === 'service' && t('appointmentForm.stepDescription_service')}  \n                      {currentStep === 'datetime' && t('appointmentForm.stepDescription_datetime')}\n                      {currentStep === 'details' && t('appointmentForm.stepDescription_details')}\n                      {currentStep === 'review' && t('appointmentForm.stepDescription_review')}\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-blue-100 text-sm\">{t('appointmentForm.stepCounter', { current: stepOrder.indexOf(currentStep) + 1, total: steps.length })}</p>\n                    <div className=\"w-20 bg-white bg-opacity-20 rounded-full h-2 mt-2\">\n                      <div \n                        className=\"bg-white h-2 rounded-full transition-all duration-500\"\n                        style={{ width: `${((stepOrder.indexOf(currentStep) + 1) / steps.length) * 100}%` }}\n                      ></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n          {/* Form content wrapper with transition effects */}\n              <div className={`p-6 md:p-8 transition-all duration-500 transform ${isTransitioning ? (transitionDirection === 'next' ? 'translate-x-full opacity-0' : '-translate-x-full opacity-0') : 'translate-x-0 opacity-100'}`}>\n          {/* Patient Selection Step */}\n          {currentStep === 'patient' && !isPatientUser && (\n            <div className=\"space-y-6\">\n              <div>\n                <h2 className=\"text-lg font-medium text-gray-900\">{t('appointmentForm.title_selectPatient')}</h2>\n                <p className=\"mt-1 text-sm text-gray-500\">{t('appointmentForm.subtitle_selectPatient')}</p>\n              </div>\n\n              {/* Clinic Selection */}\n\n              {/* <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Select Clinic\n                </label>\n                 <ClinicSelector\n                  selectedClinicId=\"687468107e70478314c346be\"\n                  onClinicSelect={(clinic) => {\n                    setFormData(prev => ({ ...prev, clinicId: clinic.id }));\n                    // Clear time slots when clinic changes\n                    setApiError('');\n                  }}\n                  error={fieldErrors.clinicId}\n                /> \n                {fieldErrors.clinicId && (\n                  <p className=\"text-red-500 text-sm mt-1\">{fieldErrors.clinicId}</p>\n                )}\n              </div>\n              */}\n\n              <div>\n                <label htmlFor=\"patientSearch\" className=\"block text-sm font-medium text-gray-700\">\n                  {t('appointmentForm.label_patientSearch')}\n                </label>\n                <div className=\"mt-1\">\n                  <input\n                      type=\"text\"\n                      id=\"patientSearch\"\n                      className={`shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md ${fieldErrors.patientSearch ? 'border-red-500' : ''}`}\n                      placeholder={t('appointmentForm.placeholder_patientSearch')}\n                      value={formData.patientSearch}\n                      onChange={(e) => handleInputChange('patientSearch', e.target.value)}\n                      onBlur={(e) => validateField('patientSearch', e.target.value)}\n                    />\n                    {fieldErrors.patientSearch && (\n                      <div className=\"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg flex items-start\">\n                        <AlertTriangle className=\"h-4 w-4 text-red-500 mt-0.5 mr-2 flex-shrink-0\" />\n                        <p className=\"text-red-700 text-sm\" role=\"alert\" aria-live=\"polite\">{fieldErrors.patientSearch}</p>\n                      </div>\n                    )}\n                </div>\n              </div>\n              \n              {fieldErrors.service && (\n                <p className=\"text-red-500 text-sm mt-1\">{fieldErrors.service}</p>\n              )}\n              \n              <div className=\"grid grid-cols-1 gap-3 sm:gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n                {/* Loading skeleton */}\n                {isLoading && filteredPatients.length === 0 && (\n                  <>\n                    {[...Array(3)].map((_, index) => (\n                      <div key={`skeleton-${index}`} className=\"border border-gray-200 rounded-lg p-4 animate-pulse\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\n                          <div className=\"h-5 w-5 bg-gray-200 rounded-full\"></div>\n                        </div>\n                        <div className=\"mt-2 space-y-2\">\n                          <div key={`line1-${index}`} className=\"h-3 bg-gray-200 rounded w-2/3\"></div>\n                          <div key={`line2-${index}`} className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n                        </div>\n                      </div>\n                    ))}\n                  </>\n                )}\n                \n                {/* Actual patient list */}\n                {!isLoading && filteredPatients.map((patient, index) => (\n                  <div \n                    key={patient.id || `patient-${index}`} \n                    className={`border rounded-lg p-4 cursor-pointer transition-all duration-200 transform active:scale-95 touch-manipulation ${formData.patientId === patient.id ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300 hover:shadow-sm'}`}\n                    onClick={() => {\n\n                      \n                      // Use the patient ID\n                      const patientId = patient.id;\n\n                      handleInputChange('patientId', patientId);\n                      \n                      // Apply smart defaults based on selected patient's appointment history\n                      if (patientId) {\n                        setSmartDefaults(patientId);\n                      }\n                    }}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"font-medium\">{patient.firstName} {patient.lastName}</div>\n                      {formData.patientId === patient.id && (\n                        <CheckCircle className=\"h-5 w-5 text-blue-500\" />\n                      )}\n                    </div>\n                    <div className=\"mt-2 text-sm text-gray-500\">\n                      <div>{patient.email}</div>\n                      <div>{patient.phone}</div>\n                    </div>\n                  </div>\n                ))}\n                \n                {!isLoading && filteredPatients.length === 0 && (\n                  <div className=\"col-span-full text-center py-4 text-gray-500\">\n                    {t('appointmentForm.no_patients_found')}\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n\n\n          {/* Service Selection Step */}\n          {currentStep === 'service' && (\n            <div className=\"space-y-8\">\n              <div className=\"text-center\">\n                <h3 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('appointmentForm.selectYourService')}</h3>\n                <p className=\"text-gray-600\">{t('appointmentForm.serviceSelectionDescription')}</p>\n              </div>\n              \n              {/* Branch Selection - Always show if branches exist */}\n              {branches.length > 0 && (\n                <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200\">\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <MapPin className=\"h-5 w-5 text-blue-600\" />\n                    <label className=\"block text-sm font-semibold text-gray-900\">\n                      {t('appointmentForm.selectBranch') || 'Select Clinic Branch'}\n                    </label>\n                  </div>\n                  <select\n                    value={selectedBranch}\n                    onChange={(e) => {\n                      setSelectedBranch(e.target.value);\n                      // Reset clinic selection when branch changes\n                      setFormData(prev => ({ ...prev, clinicId: '' }));\n                    }}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white\"\n                  >\n                    {/* <option value=\"\">{t('appointmentForm.selectBranchPlaceholder') || 'Choose a branch...'}</option> */}\n                    {branches.map(branch => (\n                      <option key={branch} value={branch}>{branch}</option>\n                    ))}\n                  </select>\n                  {selectedBranch && filteredClinics.length > 0 && (\n                    <div className=\"mt-3 text-sm text-gray-600\">\n                       {filteredClinics.length} clinic{filteredClinics.length > 1 ? 's' : ''} available in {selectedBranch}\n                    </div>\n                  )}\n                  {selectedBranch && filteredClinics.length === 0 && (\n                    <div className=\"mt-3 text-sm text-amber-600\">\n                       {t('appointmentForm.noClinicsInBranch') || 'No clinics available in this branch'}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Clinic Selection - Show when branch is selected and clinics available */}\n              {selectedBranch && filteredClinics.length > 0 && (\n                <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200\">\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <MapPin className=\"h-5 w-5 text-green-600\" />\n                    <label className=\"block text-sm font-semibold text-gray-900\">\n                      {t('appointmentForm.selectClinic') || 'Select Clinic'}\n                    </label>\n                  </div>\n                  <div className=\"grid grid-cols-1 gap-3\">\n                    {filteredClinics.map(clinic => (\n                      <div\n                        key={clinic.id}\n                        onClick={() => handleInputChange('clinicId', clinic.id)}\n                        className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${\n                          formData.clinicId === clinic.id\n                            ? 'border-green-500 bg-green-100'\n                            : 'border-gray-200 hover:border-green-300 bg-white'\n                        }`}\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <h4 className=\"font-semibold text-gray-900\">{clinic.name}</h4>\n                            <p className=\"text-sm text-gray-600\">{clinic.address.street}, {clinic.address.city}</p>\n                            {clinic.phone && <p className=\"text-xs text-gray-500\"> {clinic.phone}</p>}\n                          </div>\n                          {formData.clinicId === clinic.id && (\n                            <CheckCircle className=\"h-6 w-6 text-green-500\" />\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n              \n              <div className=\"grid grid-cols-1 gap-4 sm:gap-6 sm:grid-cols-2 lg:grid-cols-3\">\n                {services.map((service, index) => (\n                  <div \n                    key={service.value || `service-${index}`} \n                    className={`group relative border-2 rounded-2xl p-4 sm:p-6 cursor-pointer transition-all duration-300 transform active:scale-95 hover:scale-105 hover:shadow-xl touch-manipulation ${\n                      formData.service === service.value \n                        ? 'border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg' \n                        : 'border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50'\n                    } ${fieldErrors.service ? 'border-red-500' : ''}`}\n                    onClick={() => {\n                      handleInputChange('service', service.value);\n                      validateField('service', service.value);\n                    }}\n                  >\n                    {/* Selection Indicator */}\n                      {formData.service === service.value && (\n                      <div className=\"absolute -top-2 -right-2 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\">\n                        <CheckIcon className=\"h-4 w-4 text-white\" />\n                      </div>\n                    )}\n                    \n                    {/* Service Icon */}\n                    <div className={`w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center text-3xl transition-all duration-300 ${\n                      formData.service === service.value\n                        ? 'bg-gradient-to-br from-blue-400 to-indigo-500 text-white shadow-lg'\n                        : 'bg-gray-100 group-hover:bg-blue-100'\n                    }`}>\n                      {service.icon}\n                    </div>\n                    \n                    {/* Service Info */}\n                    <div className=\"text-center\">\n                      <h4 className={`font-bold text-lg mb-2 transition-colors ${\n                        formData.service === service.value ? 'text-blue-700' : 'text-gray-900 group-hover:text-blue-600'\n                      }`}>\n                        {service.label}\n                      </h4>\n                      <p className=\"text-gray-600 text-sm mb-4 leading-relaxed\">\n                        {service.description}\n                      </p>\n                      \n                      {/* Duration Badge */}\n                      <div className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n                        formData.service === service.value\n                          ? 'bg-blue-100 text-blue-700'\n                          : 'bg-gray-100 text-gray-600 group-hover:bg-blue-50 group-hover:text-blue-600'\n                      }`}>\n                        <Clock className=\"h-4 w-4 mr-1\" />\n                        {service.duration} {t('appointmentForm.minutes')}\n                      </div>\n                    </div>\n                    \n                    {/* Hover Effect */}\n                    <div className=\"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-500 opacity-0 group-hover:opacity-5 transition-opacity duration-300\"></div>\n                  </div>\n                ))}\n              </div>\n              \n              {fieldErrors.service && (\n                <div className=\"flex items-center justify-center mt-4\">\n                  <p className=\"text-red-500 text-sm bg-red-50 px-4 py-2 rounded-lg border border-red-200\">\n                    {fieldErrors.service}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Date & Time Selection Step */}\n          {currentStep === 'datetime' && (\n            <div className=\"space-y-8\">\n              <div className=\"text-center\">\n                <h3 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('appointmentForm.chooseDateAndTime')}</h3>\n                <p className=\"text-gray-600\">{t('appointmentForm.dateTimeSelectionDescription')}</p>\n              </div>\n\n              {/* Clinic Selection and Display */}\n              <div className=\"space-y-4\">\n                {/* Current Clinic Display */}\n                {formData.clinicId ? (\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex-shrink-0\">\n                        <MapPin className=\"h-5 w-5 text-blue-600\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium text-blue-900\">\n                          Selected Clinic: {formSelectedClinic?.name || 'Loading...'}\n                        </p>\n                        {formSelectedClinic?.address && (\n                          <p className=\"text-sm text-blue-700\">\n                            {formSelectedClinic.address.street}, {formSelectedClinic.address.city}\n                          </p>\n                        )}\n                        {formSelectedClinic?.phone && (\n                          <p className=\"text-xs text-blue-600\"> {formSelectedClinic.phone}</p>\n                        )}\n                        {!formSelectedClinic && (\n                          <p className=\"text-xs text-gray-500\">Clinic ID: {formData.clinicId}</p>\n                        )}\n                      </div>\n                      <div className=\"flex-shrink-0\">\n                        <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                          {t('appointmentForm.active')}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n                    <p className=\"text-sm text-red-600\">\n                       No clinic selected. Please go back and select a branch and clinic.\n                    </p>\n                  </div>\n                )}\n\n                {/* Clinic Selector for changing clinic */}\n{/*                 \n                <div>\n                  <label htmlFor=\"clinic-selector\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    {t('appointmentForm.changeClinic')}\n                  </label>\n                   <ClinicSelector\n                    selectedClinicId={formData.clinicId}\n                    onClinicSelect={(clinic) => {\n                      handleInputChange('clinicId', clinic.id);\n                      // Clear time slots when clinic changes\n                      setApiError('');\n                      toast.success(`Switched to ${clinic.name}`);\n                    }}\n                    disabled={isLoading || isSubmitting}\n                    placeholder={t('common.placeholders.selectClinic')}\n                    className=\"w-full\"\n                  /> \n                </div> */}\n              </div>\n              \n              {/* Date Selection */}\n              <div className=\"bg-gray-50 p-6 rounded-2xl border border-gray-200\">\n                <label htmlFor=\"date\" className=\"block text-lg font-semibold text-gray-900 mb-3\">\n                   {t('appointmentForm.label_date')}\n                </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"date\"\n                      id=\"date\"\n                      className={`w-full px-4 py-3 text-lg border-2 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 hover:border-blue-300 ${fieldErrors.date ? 'border-red-500 focus:ring-red-500' : 'border-gray-300'}`}\n                      value={formData.date}\n                      onChange={(e) => {\n                        // Reset time slot when date changes using single update\n                        handleInputChange('date', e.target.value);\n                        handleInputChange('timeSlot', ''); // Clear time slot when date changes\n                        // Validate date is not in the past\n                        if (e.target.value) {\n                          const today = new Date().toISOString().split('T')[0];\n                          if (e.target.value < today) {\n                            toast.error(t('appointmentForm.error_pastDate'));\n                          }\n                        }\n                      }}\n                      onBlur={(e) => validateField('date', e.target.value)}\n                      min={new Date().toISOString().split('T')[0]}\n                      required\n                      aria-describedby=\"date-description\"\n                      disabled={isLoading || isSubmitting}\n                    />\n                  </div>\n                  {fieldErrors.date && (\n                    <div className=\"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg flex items-start\">\n                      <AlertTriangle className=\"h-4 w-4 text-red-500 mt-0.5 mr-2 flex-shrink-0\" />\n                      <p className=\"text-red-700 text-sm\" role=\"alert\" aria-live=\"polite\">{fieldErrors.date}</p>\n                    </div>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500\" id=\"date-description\">\n                    {t('appointmentForm.selectDate')}\n                  </p>\n                </div>\n                \n                {/* Doctor Selection - Shows available doctors based on schedule */}\n                {/* Doctor selection hidden for auto-assignment */}\n                {false && formData.date && (\n                  <div className=\"bg-gradient-to-br from-purple-50 to-indigo-50 p-6 rounded-2xl border-2 border-purple-200 shadow-sm\">\n                    <label className=\"block text-lg font-semibold text-gray-900 mb-3\">\n                       {t('appointmentForm.label_doctor', 'Available Doctors')}\n                    </label>\n                    \n                    {isLoadingDoctors ? (\n                      <div className=\"flex items-center justify-center py-8\">\n                        <div className=\"animate-spin w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full mr-3\"></div>\n                        <p className=\"text-purple-700\">Loading available doctors...</p>\n                      </div>\n                    ) : availableDoctors.length === 0 ? (\n                      <div className=\"p-4 bg-yellow-50 border border-yellow-200 rounded-xl\">\n                        <div className=\"flex items-center\">\n                          <AlertTriangle className=\"h-5 w-5 text-yellow-600 mr-2\" />\n                          <p className=\"text-yellow-800 text-sm font-medium\">\n                            No doctors scheduled for this date. Please select another date.\n                          </p>\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-3\">\n                        <div className=\"grid grid-cols-1 gap-3\">\n                          {/* Show unique doctors (not individual schedules) */}\n                        \n                          {Array.from(new Map(\n                            availableDoctors\n                              .filter(schedule => schedule.doctorId && schedule.doctorId._id)\n                              .map(schedule => [\n                                schedule.doctorId._id,\n                                schedule\n                              ])\n                          ).values()).map((schedule) => {\n                            const doctorId = schedule.doctorId._id;\n                            return (\n                            <button\n                              key={doctorId}\n                              type=\"button\"\n                              onClick={() => {\n                                handleInputChange('dentistId', doctorId);\n                                // Clear time slot when doctor changes\n                                handleInputChange('timeSlot', '');\n                              }}\n                              className={`p-4 rounded-xl border-2 transition-all duration-200 text-left ${\n                                formData.dentistId === doctorId\n                                  ? 'bg-purple-100 border-purple-500 shadow-md'\n                                  : 'bg-white border-gray-200 hover:border-purple-300 hover:bg-purple-50'\n                              }`}\n                            >\n                              <div className=\"flex items-center justify-between\">\n                                <div className=\"flex items-center space-x-3\">\n                                  <div className={`w-10 h-10 rounded-full flex items-center justify-center ${\n                                    formData.dentistId === doctorId\n                                      ? 'bg-purple-500'\n                                      : 'bg-gray-300'\n                                  }`}>\n                                    <User className=\"h-5 w-5 text-white\" />\n                                  </div>\n                                  <div>\n                                    <p className=\"font-semibold text-gray-900\">\n                                      Dr. {schedule.doctorId?.firstName || 'Unknown'} {schedule.doctorId?.lastName || 'Doctor'}\n                                    </p>\n                                    <p className=\"text-sm text-gray-600\">\n                                      Available: {schedule.startTime} - {schedule.endTime}\n                                    </p>\n                                  </div>\n                                </div>\n                                {formData.dentistId === doctorId && (\n                                  <CheckCircle className=\"h-6 w-6 text-purple-500\" />\n                                )}\n                              </div>\n                            </button>\n                          );\n                        })}\n                        </div>\n                        <div className=\"pt-2 border-t border-purple-200\">\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              handleInputChange('dentistId', '');\n                              handleInputChange('timeSlot', '');\n                            }}\n                            className=\"text-sm text-purple-600 hover:text-purple-800 font-medium\"\n                          >\n                            Or let us auto-assign a doctor for you\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )}\n              \n              {/* Time Slot Selection */}\n              {formData.date && availableDoctors.length > 0 && (\n                <div className=\"bg-gradient-to-br from-blue-50 to-cyan-50 p-6 rounded-2xl border-2 border-blue-200 shadow-sm\">\n                    <label className=\"block text-lg font-semibold text-gray-900 mb-3\">\n                       {t('appointmentForm.label_timeSlot', 'Select Time Slot')}\n                    </label>\n                    <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-xl\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center mr-2\">\n                          <span className=\"text-white text-xs\"></span>\n                        </div>\n                        <p className=\"text-blue-800 text-sm font-medium\">\n                          A doctor will be automatically assigned based on your selected time slot.\n                        </p>\n                      </div>\n                    </div>\n                    \n                    {fieldErrors.timeSlot && (\n                      <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl\">\n                        <p className=\"text-red-600 text-sm\">{fieldErrors.timeSlot}</p>\n                      </div>\n                    )}\n                    \n                    {isLoadingTimeSlots ? (\n                      <div className=\"flex items-center justify-center py-8\">\n                        <div className=\"animate-spin w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full mr-3\"></div>\n                        <p className=\"text-blue-700\">Loading available time slots...</p>\n                      </div>\n                    ) : formData.timeSlot ? (\n                      <div className=\"p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl shadow-sm\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center\">\n                            <div className=\"w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center mr-3\">\n                              <CheckIcon className=\"h-5 w-5 text-white\" />\n                            </div>\n                            <div>\n                              <p className=\"font-semibold text-green-800\">Time slot confirmed</p>\n                              <p className=\"text-2xl font-bold text-green-700\">{formatTime12Hour(formData.timeSlot)}</p>\n                              {formData.dentistId && (\n                                <p className=\"text-sm text-green-600 mt-1\">\n                                  Doctor: {availableDoctors.find(d => d.doctorId?._id === formData.dentistId)?.doctorId?.firstName} {availableDoctors.find(d => d.doctorId?._id === formData.dentistId)?.doctorId?.lastName}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              handleInputChange('timeSlot', '');\n                              handleInputChange('dentistId', '');\n                            }}\n                            className=\"px-4 py-2 bg-white hover:bg-gray-50 border border-gray-300 text-gray-700 rounded-xl transition-all duration-200 font-medium\"\n                          >\n                            {t('common.change', 'Change')}\n                          </button>\n                        </div>\n                      </div>\n                    ) : generatedTimeSlots.length === 0 ? (\n                      <div className=\"p-4 bg-yellow-50 border border-yellow-200 rounded-xl\">\n                        <div className=\"flex items-center\">\n                          <AlertTriangle className=\"h-5 w-5 text-yellow-600 mr-2\" />\n                          <p className=\"text-yellow-800 text-sm font-medium\">\n                            No available time slots for this date. Please select another date.\n                          </p>\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-4\">\n                        {/* Time slot grid */}\n                        <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2\">\n                          {generatedTimeSlots.slice(0, 20).map((slot) => (\n                            <button\n                              key={slot.time}\n                              type=\"button\"\n                              onClick={() => {\n                                if (slot.available) {\n                                  console.log(' Time slot selected:', slot.time);\n                                  handleInputChange('timeSlot', slot.time);\n                                  // Auto-assign doctor based on selected time slot\n                                  if (slot.dentistId) {\n                                    console.log(' Auto-assigning dentist:', slot.dentistId);\n                                    handleInputChange('dentistId', slot.dentistId);\n                                  } else {\n                                    console.log(' No dentistId found in time slot');\n                                  }\n                                }\n                              }}\n                              disabled={!slot.available}\n                              className={`p-3 rounded-lg border-2 transition-all duration-200 font-medium text-sm ${\n                                !slot.available\n                                  ? 'bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed'\n                                  : slot.isPeak\n                                  ? 'bg-amber-50 border-amber-300 text-amber-800 hover:bg-amber-100 hover:border-amber-400'\n                                  : 'bg-white border-blue-200 text-blue-800 hover:bg-blue-50 hover:border-blue-400'\n                              }`}\n                            >\n                              <div className=\"flex flex-col items-center\">\n                                <Clock className=\"h-4 w-4 mb-1\" />\n                                <span>{formatTime12Hour(slot.time)}</span>\n                                {slot.isPeak && <span className=\"text-xs mt-1\"> Peak</span>}\n                                {!slot.available && <span className=\"text-xs mt-1\">Booked</span>}\n                              </div>\n                            </button>\n                          ))}\n                        </div>\n                        \n                        {generatedTimeSlots.length > 20 && (\n                          <p className=\"text-sm text-gray-600 text-center\">\n                            Showing first 20 slots. {generatedTimeSlots.length - 20} more available.\n                          </p>\n                        )}\n                        \n                        {/* Quick select first available */}\n                        <div className=\"pt-4 border-t border-blue-200\">\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              const firstAvailable = getFirstAvailableSlot(generatedTimeSlots);\n                              if (firstAvailable) {\n                                const dentistId = (firstAvailable as TimeSlot).dentistId;\n                                console.log(' First available slot selected:', firstAvailable.time, 'with dentistId:', dentistId);\n                                handleInputChange('timeSlot', firstAvailable.time);\n                                // Auto-assign doctor based on selected time slot\n                                if ((firstAvailable as TimeSlot).dentistId) {\n                                  console.log(' Auto-assigning dentist from first available:', (firstAvailable as TimeSlot).dentistId);\n                                  handleInputChange('dentistId', (firstAvailable as TimeSlot).dentistId as string);\n                                } else {\n                                  console.log(' No dentistId found in first available slot');\n                                }\n                              }\n                            }}\n                            className=\"w-full p-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors\"\n                          >\n                            <div className=\"flex items-center justify-center\">\n                              <Calendar className=\"h-5 w-5 mr-2\" />\n                              Select First Available ({formatTime12Hour(getFirstAvailableSlot(generatedTimeSlots)?.time || '00:00')})\n                            </div>\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Additional Details Step */}\n          {currentStep === 'details' && (\n            <div className=\"space-y-6\">\n              <div>\n                <h2 className=\"text-lg font-medium text-gray-900\">{t('appointmentForm.title_additionalDetails')}</h2>\n                <p className=\"mt-1 text-sm text-gray-500\">{t('appointmentForm.subtitle_additionalDetails')}</p>\n              </div>\n              \n              {/* Notes */}\n              <div>\n                <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700\">\n                  {t('appointmentForm.label_notes')}\n                </label>\n                <textarea\n                  id=\"notes\"\n                  rows={4}\n                  className={`shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md ${fieldErrors.notes ? 'border-red-500' : ''}`}\n                  placeholder={t('appointmentForm.placeholder_notes')}\n                  value={formData.notes}\n                  onChange={(e) => handleInputChange('notes', e.target.value)}\n                  onBlur={(e) => validateField('notes', e.target.value)}\n                />\n                {fieldErrors.notes && (\n                  <div className=\"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg flex items-start\">\n                    <AlertTriangle className=\"h-4 w-4 text-red-500 mt-0.5 mr-2 flex-shrink-0\" />\n                    <p className=\"text-red-700 text-sm\" role=\"alert\" aria-live=\"polite\">{fieldErrors.notes}</p>\n                  </div>\n                )}\n              </div>\n\n              {/* Emergency Flag */}\n              <div>\n                <div className=\"flex items-center\">\n                  <input\n                    id=\"emergency\"\n                    type=\"checkbox\"\n                    className=\"h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                    checked={formData.emergency}\n                    onChange={(e) => handleInputChange('emergency', e.target.checked)}\n                    onBlur={(e) => validateField('emergency', e.target.checked)}\n                  />\n                  <label htmlFor=\"emergency\" className=\"ml-3 block text-sm font-medium text-gray-700\">\n                    {t('appointmentForm.label_emergency')}\n                  </label>\n                </div>\n                {formData.emergency && (\n                  <div className=\"mt-2\">\n                    <Alert variant=\"warning\" title={t('appointmentForm.emergency_alert_title')}>\n                      {t('appointmentForm.emergency_alert_message')}\n                    </Alert>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Review Step */}\n          {currentStep === 'review' && (\n            <div className=\"space-y-6\">\n              <div>\n                <h2 className=\"text-lg font-medium text-gray-900\">{t('appointmentForm.title_review')}</h2>\n                <p className=\"mt-1 text-sm text-gray-500\">{t('appointmentForm.subtitle_review')}</p>\n              </div>\n              \n              <div className=\"bg-white rounded-lg border border-gray-200 overflow-hidden shadow-md\">\n                {/* Summary Header */}\n                <div className=\"bg-blue-50 p-4 border-b border-gray-200\">\n                  <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n                    <ClipboardCheck className=\"h-5 w-5 text-blue-500 mr-2\" />\n                    {t('appointmentForm.appointment_summary')}\n                  </h3>\n                </div>\n                \n                <div className=\"p-5 space-y-6\">\n                  {/* Patient Info */}\n                  {selectedPatient && (\n                    <div className=\"bg-gray-50 rounded-lg p-4 border border-gray-100 transition-all duration-300 hover:shadow-sm\">\n                      <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                        <User className=\"h-4 w-4 text-blue-500 mr-2\" />\n                        {t('appointmentForm.label_patient')}\n                      </h4>\n                      <div className=\"ml-6\">\n                        <p className=\"text-sm font-medium text-gray-900\">{selectedPatient.firstName} {selectedPatient.lastName}</p>\n                        <div className=\"mt-1 text-sm text-gray-500 flex items-center\">\n                          <Mail className=\"h-3 w-3 mr-1\" />\n                          {selectedPatient.email}\n                        </div>\n                        <div className=\"mt-1 text-sm text-gray-500 flex items-center\">\n                          <Phone className=\"h-3 w-3 mr-1\" />\n                          {selectedPatient.phone}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  \n                  {/* Service Info */}\n                  {selectedService && (\n                    <div className=\"bg-gray-50 rounded-lg p-4 border border-gray-100 transition-all duration-300 hover:shadow-sm\">\n                      <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                        <Stethoscope className=\"h-4 w-4 text-blue-500 mr-2\" />\n                        {t('appointmentForm.label_service')}\n                      </h4>\n                      <div className=\"ml-6\">\n                        <div className=\"flex items-center\">\n                          <span className=\"text-lg mr-2\">{selectedService.icon}</span>\n                          <span className=\"text-sm font-medium text-gray-900\">{selectedService.label}</span>\n                        </div>\n                        <p className=\"text-sm text-gray-500 mt-2\">{selectedService.description}</p>\n                        <div className=\"mt-2 text-sm text-gray-500 flex items-center\">\n                          <Clock className=\"h-3 w-3 mr-1\" />\n                          {t('appointmentForm.duration')}: {selectedService.duration} {t('appointmentForm.minutes')}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  \n                  {/* Date & Time */}\n                  <div className=\"bg-gray-50 rounded-lg p-4 border border-gray-100 transition-all duration-300 hover:shadow-sm\">\n                    <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                      <Calendar className=\"h-4 w-4 text-blue-500 mr-2\" />\n                      {t('appointmentForm.label_datetime')}\n                    </h4>\n                    <div className=\"ml-6\">\n                      <div className=\"flex items-center\">\n                        <Calendar className=\"h-4 w-4 text-gray-400 mr-2\" />\n                        <span className=\"text-sm font-medium text-gray-900\">\n                          {formData.date && new Date(formData.date).toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center mt-2\">\n                        <Clock className=\"h-4 w-4 text-gray-400 mr-2\" />\n                        <span className=\"text-sm font-medium text-gray-900\">{formData.timeSlot}</span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  {/* Dentist Assignment Info for Patients */}\n                  {isPatientUser && (\n                    <div className=\"bg-blue-50 rounded-lg p-4 border border-blue-100 transition-all duration-300 hover:shadow-sm\">\n                      <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                        <User className=\"h-4 w-4 text-blue-500 mr-2\" />\n                        {t('appointmentForm.label_dentist')}\n                      </h4>\n                      <div className=\"ml-6\">\n                        <p className=\"text-sm text-blue-700\">\n                          {t('appointmentForm.auto_assign_dentist')}\n                        </p>\n                      </div>\n                    </div>\n                  )}\n                  \n                  {/* Additional Details Section */}\n                  <div className=\"bg-gray-50 rounded-lg p-4 border border-gray-100 transition-all duration-300 hover:shadow-sm\">\n                    <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                      <FileText className=\"h-4 w-4 text-blue-500 mr-2\" />\n                      {t('appointmentForm.title_additionalDetails')}\n                    </h4>\n                    <div className=\"ml-6\">\n                      {/* Notes */}\n                      {formData.notes ? (\n                        <div className=\"mb-3\">\n                          <h5 className=\"text-xs font-medium text-gray-500 mb-1\">{t('appointmentForm.label_notes')}</h5>\n                          <p className=\"text-sm text-gray-900 p-2 bg-white rounded border border-gray-100\">{formData.notes}</p>\n                        </div>\n                      ) : (\n                        <div className=\"mb-3\">\n                          <p className=\"text-sm text-gray-500 italic\">{t('appointmentForm.no_notes')}</p>\n                        </div>\n                      )}\n                      \n                      {/* Emergency */}\n                      {formData.emergency && (\n                        <div className=\"mb-3 p-2 bg-red-50 border border-red-100 rounded-md\">\n                          <div className=\"flex items-center\">\n                            <AlertTriangle className=\"h-4 w-4 text-red-500 mr-2\" />\n                            <span className=\"text-sm font-medium text-red-600\">{t('appointmentForm.emergency_flag')}</span>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  \n                  {/* Clinic */}\n                  {/* Removed clinic selection UI as we now have a single clinic */}\n                  {/* {selectedClinic && (\n                    <div className=\"bg-gray-50 rounded-lg p-4 border border-gray-100 transition-all duration-300 hover:shadow-sm\">\n                      <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                        <MapPin className=\"h-4 w-4 text-blue-500 mr-2\" />\n                        {t('appointmentForm.label_clinic')}\n                      </h4>\n                      <div className=\"ml-6\">\n                        <p className=\"text-sm font-medium text-gray-900\">{selectedClinic.name}</p>\n                        <div className=\"mt-1 text-sm text-gray-500 flex items-center\">\n                          <MapPin className=\"h-3 w-3 mr-1\" />\n                          {`${selectedClinic.address.street}, ${selectedClinic.address.city}, ${selectedClinic.address.state} ${selectedClinic.address.zipCode}`}\n                        </div>\n                      </div>\n                    </div>\n                  )} */}\n                </div>\n                \n                {/* Confirmation Message */}\n                <div className=\"bg-blue-50 p-4 border-t border-gray-200\">\n                  <div className=\"flex items-start\">\n                    <div className=\"flex-shrink-0\">\n                      <Info className=\"h-5 w-5 text-blue-400\" aria-hidden=\"true\" />\n                    </div>\n                    <div className=\"ml-3\">\n                      <h3 className=\"text-sm font-medium text-blue-800\">\n                        {isEditMode ? t('appointmentForm.confirm_update') : t('appointmentForm.confirm_create')}\n                      </h3>\n                      <div className=\"mt-2 text-sm text-blue-700\">\n                        <p>\n                          {isEditMode \n                            ? t('appointmentForm.update_confirmation_message')\n                            : t('appointmentForm.create_confirmation_message')}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          </div>\n          \n              {/* Form Actions - Modern Footer */}\n              <div className=\"bg-gray-50 px-4 sm:px-6 py-4 sm:py-6 border-t border-gray-200\">\n                <div className=\"flex flex-col-reverse sm:flex-row items-center justify-between gap-3 sm:gap-0\">\n            {currentStep !== (isPatientUser ? 'service' : 'patient') ? (\n              <button\n                type=\"button\"\n                onClick={goToPreviousStep}\n                      className=\"w-full sm:w-auto inline-flex items-center justify-center px-6 py-3 border-2 border-gray-300 rounded-xl text-base font-semibold text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 hover:shadow-md touch-manipulation\"\n              >\n                      <ArrowLeft className=\"w-5 h-5 mr-2\" />\n                {t('common.back')}\n              </button>\n            ) : (\n              <button\n                type=\"button\"\n                onClick={() => navigate('/appointments')}\n                      className=\"w-full sm:w-auto inline-flex items-center justify-center px-6 py-3 border-2 border-gray-300 rounded-xl text-base font-semibold text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 hover:shadow-md touch-manipulation\"\n              >\n                {t('common.cancel')}\n              </button>\n            )}\n            \n            <button\n              type=\"submit\"\n              disabled={isLoading || isSubmitting}\n                    className={`w-full sm:w-auto inline-flex items-center justify-center px-8 py-4 border-2 border-transparent rounded-xl text-lg font-bold shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-300 touch-manipulation ${\n                      isLoading || isSubmitting\n                        ? 'bg-gray-400 cursor-not-allowed' \n                        : 'bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white hover:shadow-xl transform hover:scale-105'\n                    }`}\n            >\n              {isLoading || isSubmitting ? (\n                      <div className=\"flex items-center\">\n                        <div className=\"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-3\"></div>\n                        {isSubmitting ? t('appointmentForm.creatingAppointment') : t('common.loading')}\n                      </div>\n              ) : currentStep === 'review' ? (\n                      <div className=\"flex items-center\">\n                        {isEditMode ? (\n                          <>\n                            <CheckIcon className=\"w-5 h-5 mr-2\" />\n                            {t('common.update')}\n                          </>\n              ) : (\n                <>\n                            <Calendar className=\"w-5 h-5 mr-2\" />\n                            {t('common.create')}\n                          </>\n                        )}\n                      </div>\n                    ) : (\n                      <div className=\"flex items-center\">\n                        {t('common.next')}\n                        <ArrowRight className=\"w-5 h-5 ml-2\" />\n                      </div>\n              )}\n            </button>\n                </div>\n          </div>\n        </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AppointmentForm;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\appointment\\Appointments.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has an unnecessary dependency: 'patientService'. Either exclude it or remove the dependency array. Outer scope values like 'patientService' aren't valid dependencies because mutating them doesn't re-render the component.","line":61,"column":6,"nodeType":"ArrayExpression","endLine":61,"endColumn":31,"suggestions":[{"desc":"Update the dependencies array to be: [user, t]","fix":{"range":[2647,2672],"text":"[user, t]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2849,2852],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2849,2852],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4328,4331],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4328,4331],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4457,4460],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4457,4460],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":109,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4518,4521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4518,4521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":165,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7672,7675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7672,7675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":211,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9597,9600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9597,9600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":238,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11307,11310],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11307,11310],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Button, Input, Card, Table, Pagination, Badge, Select, DatePicker } from '../../components/ui';\nimport { appointmentService } from '../../services/appointmentService';\nimport { patientService } from '../../services/patientService';\nimport { useAuth } from '../../hooks/useAuth';\nimport type { Appointment, AppointmentStatus } from '../../types';\nimport { toast } from 'react-hot-toast';\n\ninterface AppointmentWithNames extends Appointment {\n  patientName?: string;\n  dentistName?: string;\n  clinicName?: string;\n}\n\nconst Appointments: React.FC = () => {\n  const { t, i18n } = useTranslation();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [searchTerm, setSearchTerm] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [isLoading, setIsLoading] = useState(false);\n  const [appointments, setAppointments] = useState<AppointmentWithNames[]>([]);\n  const [totalPages, setTotalPages] = useState(1);\n  const [totalCount, setTotalCount] = useState(0);\n  const [patientId, setPatientId] = useState<string | null>(null);\n\n  const [selectedAppointments, setSelectedAppointments] = useState<string[]>([]);\n  const [statusFilter, setStatusFilter] = useState<AppointmentStatus | 'all'>('all');\n  const [dateFilter, setDateFilter] = useState<Date | null>(null);\n  const [actionLoading, setActionLoading] = useState<{ [key: string]: boolean }>({});\n  const [showConfirmModal, setShowConfirmModal] = useState<{\n    show: boolean;\n    action: 'cancel' | 'complete' | null;\n    appointmentIds: string[];\n    message: string;\n  }>({ show: false, action: null, appointmentIds: [], message: '' });\n\n  // Get patient ID for patient users\n  useEffect(() => {\n    const getPatientId = async () => {\n      if (user?.role === 'patient') {\n        try {\n          // Get patient records linked to this user\n          const response = await patientService.getPatientsByUserId(user.id, { page: 1, limit: 1 });\n          if (response.data && response.data.length > 0) {\n            setPatientId(response.data[0].id);\n          } else {\n            // No patient record found - handle gracefully without console warnings\n            // This is expected for new users or users without patient records\n          }\n        } catch (_error) {\n          // Error handled gracefully - no need for console errors in production\n          // The patientService handles API errors appropriately\n        }\n      }\n    };\n    \n    getPatientId();\n  }, [user, t, patientService]); // Added missing dependencies\n\n  // Fetch appointments from API\n  const fetchAppointments = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      const params: any = {\n        page: currentPage,\n        limit: 10\n      };\n\n      // Add filters\n      if (statusFilter !== 'all') {\n        params.status = statusFilter;\n      }\n\n      // Add date filter\n      if (dateFilter) {\n        const startOfDay = new Date(dateFilter);\n        startOfDay.setHours(0, 0, 0, 0);\n        params.startDate = startOfDay.toISOString();\n        const endOfDay = new Date(dateFilter);\n        endOfDay.setHours(23, 59, 59, 999);\n        params.endDate = endOfDay.toISOString();\n      }\n\n      let response;\n      if (user?.role === 'patient' && patientId) {\n        // For patients, use the general endpoint with patientId parameter\n        params.patientId = patientId;\n        response = await appointmentService.getAppointments(params);\n      } else if (user?.role === 'dentist') {\n        // For dentists, filter by their dentist ID (using user ID as dentist ID)\n        params.dentistId = user.id;\n        console.log(' Filtering appointments for dentist:', user.id, 'with params:', params);\n        response = await appointmentService.getAppointments(params);\n      } else if (user?.role && ['staff', 'admin', 'super_admin'].includes(user.role)) {\n        // For staff/admin, use the general appointments endpoint\n        response = await appointmentService.getAppointments(params);\n      } else {\n        throw new Error(t('common.errors.unauthorized'));\n      }\n\n      // Handle different response structures\n      const responseData = response as any;\n      \n      // Transform appointments to ensure consistent structure\n      const transformAppointments = (rawAppointments: any[]) => {\n        return rawAppointments.map((appointment: any) => ({\n          ...appointment,\n          id: appointment._id || appointment.id, // Ensure id field exists\n          patientName: typeof appointment.patientId === 'object' && appointment.patientId\n            ? `${appointment.patientId.firstName || ''} ${appointment.patientId.lastName || ''}`.trim() || 'Unknown Patient'\n            : appointment.patientName || 'Unknown Patient',\n          dentistName: typeof appointment.dentistId === 'object' && appointment.dentistId\n            ? `${appointment.dentistId.firstName || ''} ${appointment.dentistId.lastName || ''}`.trim() || 'Auto-assigned'\n            : appointment.dentistName || 'Auto-assigned',\n          clinicName: typeof appointment.clinicId === 'object' && appointment.clinicId\n            ? appointment.clinicId.name || 'Unknown Clinic'\n            : appointment.clinicName || 'Unknown Clinic',\n        }));\n      };\n\n      // Check if response follows the ApiResponse pattern {success: true, data: ...}\n      if (responseData && responseData.success && responseData.data) {\n        // Handle structured response from apiService wrapper\n        if (Array.isArray(responseData.data.appointments)) {\n          // Backend returns { success: true, data: { appointments: [...], totalPages: X, total: Y } }\n          setAppointments(transformAppointments(responseData.data.appointments));\n          setTotalPages(responseData.data.totalPages || 1);\n          setTotalCount(responseData.data.total || responseData.data.appointments.length);\n        } else if (Array.isArray(responseData.data.data) && responseData.data.pagination) {\n          // Backend returns { success: true, data: { data: [...], pagination: {...} } }\n          setAppointments(transformAppointments(responseData.data.data));\n          setTotalPages(responseData.data.pagination.totalPages || 1);\n          setTotalCount(responseData.data.pagination.total || responseData.data.data.length);\n        } else if (Array.isArray(responseData.data)) {\n          // Backend returns { success: true, data: [...] }\n          setAppointments(transformAppointments(responseData.data));\n          setTotalPages(1);\n          setTotalCount(responseData.data.length);\n        } else {\n          // Unexpected data structure - handle gracefully\n          setAppointments([]);\n          setTotalPages(1);\n          setTotalCount(0);\n        }\n      } else if (responseData && Array.isArray(responseData.data)) {\n        // Handle direct response format (legacy)\n        setAppointments(transformAppointments(responseData.data));\n        setTotalPages(responseData.totalPages || 1);\n        setTotalCount(responseData.total || 0);\n      } else if (responseData && Array.isArray(responseData)) {\n        // Handle direct array response\n        setAppointments(transformAppointments(responseData));\n        setTotalPages(1);\n        setTotalCount(responseData.length);\n      } else {\n        // Invalid response format - handle gracefully\n        setAppointments([]);\n        setTotalPages(1);\n        setTotalCount(0);\n        toast.error(t('appointments.invalidResponse') || 'Invalid response format received');\n      }\n    } catch (error: any) {\n      // API error handled with user-friendly message\n      toast.error(error.message || t('appointments.errorFetching'));\n    } finally {\n      setIsLoading(false);\n    }\n  }, [currentPage, statusFilter, dateFilter, user, patientId, t]);\n\n  useEffect(() => {\n    if (user && (user.role !== 'patient' || patientId)) {\n      fetchAppointments();\n    }\n  }, [currentPage, statusFilter, dateFilter, user, patientId, fetchAppointments]);\n\n  // Filter appointments based on search term (client-side filtering for search) - optimized with useMemo\n  const filteredAppointments = useMemo(() => {\n    if (!searchTerm) return appointments;\n    \n    const searchLower = searchTerm.toLowerCase();\n    return appointments.filter(appointment => \n      appointment.patientName?.toLowerCase().includes(searchLower) ||\n      appointment.dentistName?.toLowerCase().includes(searchLower) ||\n      appointment.serviceType?.toLowerCase().includes(searchLower) ||\n      appointment.clinicName?.toLowerCase().includes(searchLower)\n    );\n  }, [appointments, searchTerm]);\n\n  // Use filtered appointments for display\n  const displayAppointments = filteredAppointments;\n\n  const handlePageChange = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  const handleRowClick = (appointment: AppointmentWithNames) => {\n    navigate(`/appointments/${appointment.id}`);\n  };\n\n  const handleCancelAppointment = useCallback(async (appointmentIds: string[]) => {\n    const loadingKey = appointmentIds.join(',');\n    try {\n      setActionLoading(prev => ({ ...prev, [`cancel-${loadingKey}`]: true }));\n      await Promise.all(appointmentIds.map(id => appointmentService.updateAppointment(id, { status: 'cancelled' })));\n      toast.success(t('appointments.appointmentCancelledSuccess') || 'Appointment(s) cancelled successfully');\n      fetchAppointments(); // Refresh the list\n      setSelectedAppointments([]); // Clear selection\n    } catch (error: any) {\n      // Provide more specific error messages based on status code\n      if (error.response?.status === 500) {\n        toast.error(t('appointments.errors.serverError') || 'Server error occurred while cancelling appointment. Please try again later.');\n      } else if (error.response?.status === 404) {\n        toast.error(t('appointments.errors.notFound') || 'Appointment not found. It may have already been cancelled or deleted.');\n      } else if (error.response?.status === 403) {\n        toast.error(t('appointments.errors.unauthorized') || 'You do not have permission to cancel this appointment.');\n      } else if (error.response?.status === 400) {\n        toast.error(t('appointments.errors.badRequest') || 'Invalid request. Please check the appointment details.');\n      } else {\n        toast.error(error.message || t('appointments.errorCancelling') || 'Failed to cancel appointment');\n      }\n    } finally {\n      setActionLoading(prev => ({ ...prev, [`cancel-${loadingKey}`]: false }));\n      setShowConfirmModal({ show: false, action: null, appointmentIds: [], message: '' });\n    }\n  }, [fetchAppointments, t]);\n\n  const handleCompleteAppointment = useCallback(async (appointmentIds: string[]) => {\n    const loadingKey = appointmentIds.join(',');\n    try {\n      setActionLoading(prev => ({ ...prev, [`complete-${loadingKey}`]: true }));\n      await Promise.all(appointmentIds.map(id => appointmentService.updateAppointment(id, { status: 'completed' })));\n      toast.success(t('appointments.appointmentCompletedSuccess') || 'Appointment(s) completed successfully');\n      fetchAppointments(); // Refresh the list\n      setSelectedAppointments([]); // Clear selection\n    } catch (error: any) {\n      // Provide more specific error messages based on status code\n      if (error.response?.status === 500) {\n        toast.error(t('appointments.errors.serverError') || 'Server error occurred while completing appointment. Please try again later.');\n      } else if (error.response?.status === 404) {\n        toast.error(t('appointments.errors.notFound') || 'Appointment not found. It may have already been completed or deleted.');\n      } else if (error.response?.status === 403) {\n        toast.error(t('appointments.errors.unauthorized') || 'You do not have permission to complete this appointment.');\n      } else if (error.response?.status === 400) {\n        toast.error(t('appointments.errors.badRequest') || 'Invalid request. Please check the appointment details.');\n      } else {\n        toast.error(error.message || t('appointments.errorCompleting') || 'Failed to complete appointment');\n      }\n    } finally {\n      setActionLoading(prev => ({ ...prev, [`complete-${loadingKey}`]: false }));\n      setShowConfirmModal({ show: false, action: null, appointmentIds: [], message: '' });\n    }\n  }, [fetchAppointments, t]);\n\n\n\n  const formatDate = (date: Date | string) => {\n    const dateObj = typeof date === 'string' ? new Date(date) : date;\n    return dateObj.toLocaleDateString(i18n?.language || 'en', {\n      weekday: 'short',\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  const formatTime = useCallback((timeString: string) => {\n    const [hours, minutes] = timeString.split(':');\n    const hour = parseInt(hours, 10);\n    const ampm = hour >= 12 ? t('common.time.pm') || 'PM' : t('common.time.am') || 'AM';\n    const hour12 = hour % 12 || 12;\n    return `${hour12}:${minutes} ${ampm}`;\n  }, [t]);\n\n  const getStatusBadge = useCallback((status: AppointmentStatus) => {\n    const variants: Record<AppointmentStatus, 'primary' | 'success' | 'gray' | 'danger'> = {\n      'scheduled': 'primary',\n      'confirmed': 'primary',\n      'completed': 'success',\n      'cancelled': 'gray',\n      'no-show': 'danger'\n    };\n    \n    return (\n      <Badge variant={variants[status]} rounded={true}>\n        {t(`appointments.${status.replace('-', '')}`)}\n      </Badge>\n    );\n  }, [t]);\n\n  // Helper functions for confirmation modal\n  const showCancelConfirmation = useCallback((appointmentIds: string[]) => {\n    const count = appointmentIds.length;\n    const message = count === 1 \n      ? t('appointments.confirmCancel.single') || 'Are you sure you want to cancel this appointment?'\n      : t('appointments.confirmCancel.multiple', { count }) || `Are you sure you want to cancel ${count} appointments?`;\n    \n    setShowConfirmModal({\n      show: true,\n      action: 'cancel',\n      appointmentIds,\n      message\n    });\n  }, [t]);\n\n  const showCompleteConfirmation = useCallback((appointmentIds: string[]) => {\n    const count = appointmentIds.length;\n    const message = count === 1 \n      ? t('appointments.confirmComplete.single') || 'Are you sure you want to mark this appointment as completed?'\n      : t('appointments.confirmComplete.multiple', { count }) || `Are you sure you want to mark ${count} appointments as completed?`;\n    \n    setShowConfirmModal({\n      show: true,\n      action: 'complete',\n      appointmentIds,\n      message\n    });\n  }, [t]);\n\n  const handleConfirmAction = useCallback(() => {\n    if (showConfirmModal.action === 'cancel') {\n      handleCancelAppointment(showConfirmModal.appointmentIds);\n    } else if (showConfirmModal.action === 'complete') {\n      handleCompleteAppointment(showConfirmModal.appointmentIds);\n    }\n  }, [showConfirmModal, handleCancelAppointment, handleCompleteAppointment]);\n\n  const columns = [\n    {\n      header: t('appointments.patient'),\n      accessor: (appointment: AppointmentWithNames) => (\n        <div>\n          <div className=\"font-medium text-gray-900\">{appointment.patientName || t('appointments.unknownPatient')}</div>\n        </div>\n      ),\n    },\n    {\n      header: t('appointments.dateTime'),\n      accessor: (appointment: AppointmentWithNames) => (\n        <div>\n          <div className=\"font-medium text-gray-900\">{formatDate(appointment.date)}</div>\n          <div className=\"text-sm text-gray-500\">{formatTime(appointment.timeSlot)} ({appointment.duration} min)</div>\n        </div>\n      ),\n    },\n    {\n      header: t('appointments.service'),\n      accessor: (appointment: AppointmentWithNames) => (\n        <div>\n          <div className=\"font-medium text-gray-900\">{appointment.serviceType}</div>\n          <div className=\"text-sm text-gray-500\">{appointment.clinicName}</div>\n        </div>\n      ),\n    },\n    {\n      header: t('appointments.dentist'),\n      accessor: (appointment: AppointmentWithNames) => appointment.dentistName || t('appointments.unknownDentist'),\n    },\n    {\n      header: t('appointments.status'),\n      accessor: (appointment: AppointmentWithNames) => getStatusBadge(appointment.status),\n    },\n    {\n      header: t('appointments.actions'),\n      accessor: (appointment: AppointmentWithNames) => {\n        const isCancelLoading = actionLoading[`cancel-${appointment.id}`];\n        const isCompleteLoading = actionLoading[`complete-${appointment.id}`];\n        \n        return (\n          <div className=\"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2\">\n            <Button \n              variant=\"outline\" \n              size=\"sm\"\n              onClick={(e) => {\n                e.stopPropagation();\n                navigate(`/appointments/${appointment.id}`);\n              }}\n              aria-label={t('appointments.viewDetails', { patient: appointment.patientName })}\n              className=\"bg-gradient-to-r from-indigo-500/10 to-purple-500/10 border-indigo-300 text-indigo-700 hover:from-indigo-500/20 hover:to-purple-500/20 font-medium shadow-sm transition-all duration-200 transform hover:scale-105 min-h-[44px] touch-manipulation\"\n            >\n              <span className=\"font-medium\">{t('appointments.view')}</span>\n            </Button>\n            {(appointment.status === 'scheduled' || appointment.status === 'confirmed') && (\n              <>\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    showCompleteConfirmation([appointment.id]);\n                  }}\n                  disabled={isCompleteLoading || isCancelLoading}\n                  aria-label={t('appointments.completeAppointment', { patient: appointment.patientName })}\n                  className=\"bg-gradient-to-r from-emerald-500/10 to-green-500/10 border-emerald-400 text-emerald-700 hover:from-emerald-500/20 hover:to-green-500/20 font-medium shadow-sm transition-all duration-200 transform hover:scale-105 disabled:transform-none min-h-[44px] touch-manipulation\"\n                >\n                  {isCompleteLoading ? (\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin\" />\n                      <span className=\"font-medium\">{t('common.processing')}</span>\n                    </div>\n                  ) : (\n                    <span className=\"font-medium\">{t('appointments.complete')}</span>\n                  )}\n                </Button>\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  className=\"bg-gradient-to-r from-red-500/10 to-pink-500/10 border-red-400 text-red-700 hover:from-red-500/20 hover:to-pink-500/20 font-medium shadow-sm transition-all duration-200 transform hover:scale-105 disabled:transform-none min-h-[44px] touch-manipulation\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    showCancelConfirmation([appointment.id]);\n                  }}\n                  disabled={isCompleteLoading || isCancelLoading}\n                  aria-label={t('appointments.cancelAppointment', { patient: appointment.patientName })}\n                >\n                  {isCancelLoading ? (\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin\" />\n                      <span className=\"font-medium\">{t('common.processing')}</span>\n                    </div>\n                  ) : (\n                    <span className=\"font-medium\">{t('appointments.cancel')}</span>\n                  )}\n                </Button>\n              </>\n            )}\n          </div>\n        );\n      },\n    },\n  ];\n\n  // Mobile card view component\n  const MobileAppointmentCard = ({ appointment }: { appointment: AppointmentWithNames }) => {\n    const isCancelLoading = actionLoading[`cancel-${appointment.id}`];\n    const isCompleteLoading = actionLoading[`complete-${appointment.id}`];\n    \n    return (\n      <div \n        className=\"bg-white rounded-lg shadow-md border border-gray-200 p-4 mb-4 hover:shadow-lg transition-shadow cursor-pointer\"\n        onClick={() => handleRowClick(appointment)}\n      >\n        <div className=\"flex justify-between items-start mb-3\">\n          <div className=\"flex-1\">\n            <h3 className=\"font-semibold text-gray-900 text-lg\">{appointment.patientName || t('appointments.unknownPatient')}</h3>\n            <p className=\"text-sm text-gray-500\">{appointment.serviceType}</p>\n          </div>\n          {getStatusBadge(appointment.status)}\n        </div>\n        \n        <div className=\"space-y-2 mb-4\">\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n            </svg>\n            <span>{formatDate(appointment.date)}</span>\n          </div>\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\" />\n            </svg>\n            <span>{formatTime(appointment.timeSlot)} ({appointment.duration} min)</span>\n          </div>\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n            </svg>\n            <span>{appointment.dentistName || t('appointments.unknownDentist')}</span>\n          </div>\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-6a1 1 0 00-1-1H9a1 1 0 00-1 1v6a1 1 0 01-1 1H4a1 1 0 110-2V4z\" clipRule=\"evenodd\" />\n            </svg>\n            <span>{appointment.clinicName}</span>\n          </div>\n        </div>\n        \n        <div className=\"flex flex-col space-y-2 pt-3 border-t border-gray-200\">\n          <Button \n            variant=\"outline\" \n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              navigate(`/appointments/${appointment.id}`);\n            }}\n            className=\"w-full bg-gradient-to-r from-indigo-500/10 to-purple-500/10 border-indigo-300 text-indigo-700 hover:from-indigo-500/20 hover:to-purple-500/20 font-medium shadow-sm min-h-[44px] touch-manipulation\"\n          >\n            {t('appointments.view')}\n          </Button>\n          {(appointment.status === 'scheduled' || appointment.status === 'confirmed') && (\n            <div className=\"flex space-x-2\">\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  showCompleteConfirmation([appointment.id]);\n                }}\n                disabled={isCompleteLoading || isCancelLoading}\n                className=\"flex-1 bg-gradient-to-r from-emerald-500/10 to-green-500/10 border-emerald-400 text-emerald-700 hover:from-emerald-500/20 hover:to-green-500/20 font-medium shadow-sm min-h-[44px] touch-manipulation\"\n              >\n                {isCompleteLoading ? (\n                  <div className=\"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin\" />\n                ) : (\n                  t('appointments.complete')\n                )}\n              </Button>\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                className=\"flex-1 bg-gradient-to-r from-red-500/10 to-pink-500/10 border-red-400 text-red-700 hover:from-red-500/20 hover:to-pink-500/20 font-medium shadow-sm min-h-[44px] touch-manipulation\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  showCancelConfirmation([appointment.id]);\n                }}\n                disabled={isCompleteLoading || isCancelLoading}\n              >\n                {isCancelLoading ? (\n                  <div className=\"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin\" />\n                ) : (\n                  t('appointments.cancel')\n                )}\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50\">\n      {/* Header Section with Enhanced Gradient */}\n      <div className=\"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-white py-6 sm:py-8 px-4 sm:px-6 rounded-b-3xl shadow-lg mb-6 sm:mb-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between\">\n            <div className=\"space-y-2\">\n              <h1 className=\"text-2xl sm:text-3xl font-bold text-white\">\n                {t('appointments.title')}\n              </h1>\n              <p className=\"text-blue-100 text-base sm:text-lg\">\n                {user?.role === 'dentist' \n                  ? t('appointments.descriptionDoctor') || 'Your scheduled appointments'\n                  : t('appointments.description')\n                }\n              </p>\n              <div className=\"flex flex-wrap items-center gap-2 text-xs sm:text-sm\">\n                <div className=\"flex items-center space-x-2 bg-white/20 rounded-full px-3 py-1\">\n                  <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                  </svg>\n                  <span>{totalCount} {t('appointments.total')}</span>\n                </div>\n                {user?.role === 'dentist' && (\n                  <div className=\"flex items-center space-x-2 bg-green-400/20 text-green-100 rounded-full px-3 py-1\">\n                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                    </svg>\n                    <span>{t('appointments.myAppointments') || 'My Appointments'}</span>\n                  </div>\n                )}\n                {selectedAppointments.length > 0 && (\n                  <div className=\"flex items-center space-x-2 bg-yellow-400/20 text-yellow-100 rounded-full px-3 py-1\">\n                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                    </svg>\n                    <span>{selectedAppointments.length} {t('appointments.selected')}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className=\"mt-4 md:mt-0\">\n            <Link to=\"/appointments/create\">\n              <Button \n                variant=\"primary\"\n                className=\"w-full sm:w-auto bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 font-bold min-h-[44px] touch-manipulation\"\n                size=\"lg\"\n              >\n                <svg className=\"-ml-1 mr-2 h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2.5}>\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                </svg>\n                <span className=\"font-bold\">{t('appointments.newAppointment')}</span>\n              </Button>\n            </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6\">\n\n      <Card className=\"shadow-lg border-0 bg-white/80 backdrop-blur-sm\">\n        {/* Enhanced Search and Filter Section */}\n        <div className=\"mb-6 p-4 bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg border border-blue-100\">\n          <div className=\"flex flex-col space-y-4 lg:flex-row lg:items-center lg:justify-between lg:space-y-0\">\n            <div className=\"flex-1 max-w-md\">\n              <Input\n                placeholder={t('appointments.searchPlaceholder')}\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"shadow-sm\"\n                leftIcon={\n                  <svg className=\"h-5 w-5 text-gray-400\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                  </svg>\n                }\n                aria-label={t('appointments.searchLabel')}\n              />\n            </div>\n            <div className=\"flex flex-col space-y-2 sm:flex-row sm:items-center sm:space-x-3 sm:space-y-0\">\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-sm font-medium text-gray-700\">{t('common.status')}:</span>\n                <Select\n                  value={statusFilter}\n                  onChange={(e) => setStatusFilter(e.target.value as AppointmentStatus | 'all')}\n                  className=\"w-full sm:w-40\"\n                  options={[\n                    { value: 'all', label: t('appointments.allStatuses') },\n                    { value: 'scheduled', label: t('appointments.scheduled') },\n                    { value: 'confirmed', label: t('appointments.confirmed') },\n                    { value: 'completed', label: t('appointments.completed') },\n                    { value: 'cancelled', label: t('appointments.cancelled') },\n                    { value: 'no-show', label: t('appointments.noShow') }\n                  ]}\n                  aria-label={t('appointments.filterByStatus')}\n                />\n              </div>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-sm font-medium text-gray-700\">{t('common.date')}:</span>\n                <DatePicker\n                  value={dateFilter ? dateFilter : undefined}\n                  onChange={(date) => setDateFilter(date as Date | null)}\n                  className=\"w-full sm:w-40\"\n                  placeholder={t('appointments.selectDate')}\n                  aria-label={t('appointments.filterByDate')}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"mb-4 flex items-center space-x-2\">\n          {selectedAppointments.length > 0 && (\n            <div className=\"flex items-center space-x-2 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg\">\n              <span className=\"text-sm font-medium text-blue-800 mr-2\">\n                {t('appointments.selectedCount', { count: selectedAppointments.length })}\n              </span>\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={() => showCompleteConfirmation(selectedAppointments)}\n                disabled={actionLoading[`complete-${selectedAppointments.join(',')}`]}\n                aria-label={t('appointments.completeSelectedLabel', { count: selectedAppointments.length })}\n                className=\"bg-gradient-to-r from-emerald-500/10 to-green-500/10 border-emerald-400 text-emerald-700 hover:from-emerald-500/20 hover:to-green-500/20 font-semibold shadow-md transition-all duration-200 transform hover:scale-105 disabled:transform-none\"\n              >\n                <svg className=\"-ml-1 mr-2 h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2.5}>\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n                </svg>\n                {actionLoading[`complete-${selectedAppointments.join(',')}`] ? (\n                  <div className=\"flex items-center space-x-1\">\n                    <div className=\"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin\" />\n                    <span className=\"font-medium\">{t('common.processing')}</span>\n                  </div>\n                ) : (\n                  <span className=\"font-semibold\">{t('appointments.completeSelected')}</span>\n                )}\n              </Button>\n\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                className=\"bg-gradient-to-r from-red-500/10 to-pink-500/10 border-red-400 text-red-700 hover:from-red-500/20 hover:to-pink-500/20 font-semibold shadow-md transition-all duration-200 transform hover:scale-105 disabled:transform-none\" \n                onClick={() => showCancelConfirmation(selectedAppointments)}\n                disabled={actionLoading[`cancel-${selectedAppointments.join(',')}`]}\n                aria-label={t('appointments.cancelSelectedLabel', { count: selectedAppointments.length })}\n              >\n                <svg className=\"-ml-1 mr-2 h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2.5}>\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                </svg>\n                {actionLoading[`cancel-${selectedAppointments.join(',')}`] ? (\n                  <div className=\"flex items-center space-x-1\">\n                    <div className=\"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin\" />\n                    <span className=\"font-medium\">{t('common.processing')}</span>\n                  </div>\n                ) : (\n                  <span className=\"font-semibold\">{t('appointments.cancel')}</span>\n                )}\n              </Button>\n            </div>\n          )}\n        </div>\n\n        {/* Mobile Card View (< 768px) */}\n        <div className=\"block md:hidden\">\n          {isLoading ? (\n            <div className=\"flex justify-center items-center py-12\">\n              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n            </div>\n          ) : displayAppointments.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n              </svg>\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">{t('appointments.noAppointments')}</h3>\n              <p className=\"mt-1 text-sm text-gray-500\">{t('appointments.noAppointmentsDesc')}</p>\n            </div>\n          ) : (\n            displayAppointments.map((appointment) => (\n              <MobileAppointmentCard key={appointment.id} appointment={appointment} />\n            ))\n          )}\n        </div>\n        \n        {/* Desktop Table View (>= 768px) */}\n        <div className=\"hidden md:block overflow-x-auto\">\n          <Table\n            columns={columns}\n            data={displayAppointments}\n            keyExtractor={(appointment) => appointment.id}\n            isLoading={isLoading}\n            emptyMessage={t('appointments.noAppointmentsFound')}\n            onRowClick={handleRowClick}\n            isSelectable\n            selectedIds={selectedAppointments}\n            onSelectionChange={(selectedIds) => setSelectedAppointments(selectedIds as string[])}\n          />\n        </div>\n\n        {totalPages > 1 && (\n          <div className=\"mt-6 flex justify-center\">\n            <Pagination\n              currentPage={currentPage}\n              totalPages={totalPages}\n              onPageChange={handlePageChange}\n            />\n          </div>\n        )}\n      </Card>\n\n      {/* Confirmation Modal */}\n      {showConfirmModal.show && (\n        <div \n          className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"confirm-modal-title\"\n        >\n          <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full p-6\">\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <div className={`p-2 rounded-full ${showConfirmModal.action === 'cancel' ? 'bg-red-100' : 'bg-green-100'}`}>\n                {showConfirmModal.action === 'cancel' ? (\n                  <svg className=\"w-6 h-6 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                  </svg>\n                ) : (\n                  <svg className=\"w-6 h-6 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                  </svg>\n                )}\n              </div>\n              <h3 id=\"confirm-modal-title\" className=\"text-lg font-medium text-gray-900\">\n                {showConfirmModal.action === 'cancel' \n                  ? t('appointments.confirmCancel.title') || 'Cancel Appointment'\n                  : t('appointments.confirmComplete.title') || 'Complete Appointment'\n                }\n              </h3>\n            </div>\n            \n            <p className=\"text-gray-600 mb-6\">\n              {showConfirmModal.message}\n            </p>\n            \n            <div className=\"flex space-x-3 justify-end\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowConfirmModal({ show: false, action: null, appointmentIds: [], message: '' })}\n                disabled={actionLoading[`${showConfirmModal.action}-${showConfirmModal.appointmentIds.join(',')}`]}\n                className=\"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200 font-medium shadow-sm transition-all duration-200\"\n              >\n                <span className=\"font-medium\">{t('common.cancel')}</span>\n              </Button>\n              <Button\n                variant={showConfirmModal.action === 'cancel' ? 'danger' : 'primary'}\n                onClick={handleConfirmAction}\n                disabled={actionLoading[`${showConfirmModal.action}-${showConfirmModal.appointmentIds.join(',')}`]}\n                autoFocus\n                className={`font-bold shadow-lg transition-all duration-200 transform hover:scale-105 disabled:transform-none ${\n                  showConfirmModal.action === 'cancel' \n                    ? 'bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 border-0' \n                    : 'bg-gradient-to-r from-emerald-600 to-green-700 hover:from-emerald-700 hover:to-green-800 border-0'\n                }`}\n              >\n                {actionLoading[`${showConfirmModal.action}-${showConfirmModal.appointmentIds.join(',')}`] ? (\n                  <div className=\"flex items-center space-x-2\">\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    <span className=\"font-medium\">{t('common.processing')}</span>\n                  </div>\n                ) : (\n                  <span className=\"font-bold\">\n                    {showConfirmModal.action === 'cancel' \n                      ? t('appointments.confirmCancel.action') || 'Yes, Cancel'\n                      : t('appointments.confirmComplete.action') || 'Yes, Complete'\n                    }\n                  </span>\n                )}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      </div>\n    </div>\n  );\n};\n\nexport default Appointments;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\appointment\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\auth\\ForgotPassword.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[972,975],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[972,975],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link } from 'react-router-dom';\nimport { Button, Input, Alert, Card } from '../../components/ui';\nimport { requestPasswordReset } from '../../services/authService';\n\nconst ForgotPassword: React.FC = () => {\n  const { t } = useTranslation();\n  const [email, setEmail] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    if (!email) {\n      setError(t('forgotPassword.emailRequired'));\n      return;\n    }\n\n    if (!/\\S+@\\S+\\.\\S+/.test(email)) {\n      setError(t('forgotPassword.emailInvalid'));\n      return;\n    }\n\n    setIsSubmitting(true);\n\n    try {\n      await requestPasswordReset(email);\n      setSuccess(true);\n    } catch (error: any) {\n      setError(error.message || t('forgotPassword.error'));\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center\">\n          <h2 className=\"mt-6 text-3xl font-extrabold text-gray-900\">{t('forgotPassword.title')}</h2>\n          <p className=\"mt-2 text-sm text-gray-600\">{t('forgotPassword.description')}</p>\n        </div>\n\n        <Card>\n          {error && (\n            <Alert variant=\"error\" onClose={() => setError(null)} className=\"mb-4\">\n              {error}\n            </Alert>\n          )}\n\n          {success ? (\n            <div className=\"text-center py-4\">\n              <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4\">\n                <svg\n                  className=\"h-6 w-6 text-green-600\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                  aria-hidden=\"true\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth=\"2\"\n                    d=\"M5 13l4 4L19 7\"\n                  />\n                </svg>\n              </div>\n              <h3 className=\"text-lg font-medium text-gray-900\">{t('forgotPassword.successTitle')}</h3>\n              <p className=\"mt-2 text-sm text-gray-600\">{t('forgotPassword.successDescription', { email })}</p>\n              <div className=\"mt-6\">\n                <Link to=\"/login\">\n                  <Button variant=\"primary\">{t('forgotPassword.returnToLogin')}</Button>\n                </Link>\n              </div>\n            </div>\n          ) : (\n            <form className=\"space-y-6\" onSubmit={handleSubmit}>\n              <div>\n                <Input\n                  label={t('forgotPassword.emailLabel')}\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  placeholder={t('forgotPassword.emailPlaceholder')}\n                  required\n                  autoComplete=\"email\"\n                />\n              </div>\n\n              <div>\n                <Button type=\"submit\" variant=\"primary\" className=\"w-full\" isLoading={isSubmitting}>{t('forgotPassword.sendResetLink')}</Button>\n              </div>\n\n              <div className=\"text-sm text-center\">\n                <Link to=\"/login\" className=\"font-medium text-blue-600 hover:text-blue-500\">{t('forgotPassword.backToLogin')}</Link>\n              </div>\n            </form>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default ForgotPassword;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\auth\\Login.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\auth\\Register.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\auth\\ResetPassword.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 't'. Either include it or remove the dependency array.","line":28,"column":6,"nodeType":"ArrayExpression","endLine":28,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [location, t]","fix":{"range":[1062,1072],"text":"[location, t]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1942,1945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1942,1945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { Button, Input, Alert, Card } from '../../components/ui';\nimport { resetPassword } from '../../services/authService';\nimport { useTranslation } from 'react-i18next';\n\nconst ResetPassword: React.FC = () => {\n  const { t } = useTranslation();\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [token, setToken] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  useEffect(() => {\n    // Extract token from URL query parameters\n    const queryParams = new URLSearchParams(location.search);\n    const tokenParam = queryParams.get('token');\n    \n    if (tokenParam) {\n      setToken(tokenParam);\n    } else {\n      setError(t('resetPassword.invalidToken'));\n    }\n  }, [location]);\n\n  const validateForm = () => {\n    if (!password) {\n      setError(t('resetPassword.passwordRequired'));\n      return false;\n    }\n    \n    if (password.length < 8) {\n      setError(t('resetPassword.passwordTooShort'));\n      return false;\n    }\n    \n    if (password !== confirmPassword) {\n      setError(t('resetPassword.passwordsDoNotMatch'));\n      return false;\n    }\n    \n    return true;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    if (!validateForm()) {\n      return;\n    }\n\n    setIsSubmitting(true);\n\n    try {\n      await resetPassword(token, password);\n      setSuccess(true);\n      \n      // Redirect to login after 3 seconds\n      setTimeout(() => {\n        navigate('/login', { state: { message: t('resetPassword.passwordResetSuccessMessage') } });\n      }, 3000);\n    } catch (error: any) {\n      setError(error.message || t('resetPassword.genericError'));\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center\">\n          <h2 className=\"mt-6 text-3xl font-extrabold text-gray-900\">{t('resetPassword.title')}</h2>\n          <p className=\"mt-2 text-sm text-gray-600\">\n            {t('resetPassword.description')}\n          </p>\n        </div>\n\n        <Card>\n          {error && (\n            <Alert variant=\"error\" onClose={() => setError(null)} className=\"mb-4\">\n              {error}\n            </Alert>\n          )}\n\n          {success ? (\n            <div className=\"text-center py-4\">\n              <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4\">\n                <svg\n                  className=\"h-6 w-6 text-green-600\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                  aria-hidden=\"true\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth=\"2\"\n                    d=\"M5 13l4 4L19 7\"\n                  />\n                </svg>\n              </div>\n              <h3 className=\"text-lg font-medium text-gray-900\">{t('resetPassword.successTitle')}</h3>\n              <p className=\"mt-2 text-sm text-gray-600\">\n                {t('resetPassword.successDescription')}\n              </p>\n            </div>\n          ) : (\n            <form className=\"space-y-6\" onSubmit={handleSubmit}>\n              <div>\n                <Input\n                  label={t('resetPassword.newPassword')}\n                  type=\"password\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  placeholder={t('common.placeholders.password')}\n                  required\n                  autoComplete=\"new-password\"\n                />\n              </div>\n\n              <div>\n                <Input\n                  label={t('resetPassword.confirmNewPassword')}\n                  type=\"password\"\n                  value={confirmPassword}\n                  onChange={(e) => setConfirmPassword(e.target.value)}\n                  placeholder={t('common.placeholders.password')}\n                  required\n                  autoComplete=\"new-password\"\n                />\n              </div>\n\n              <div>\n                <Button \n                  type=\"submit\" \n                  variant=\"primary\" \n                  className=\"w-full\" \n                  isLoading={isSubmitting}\n                  disabled={!token}\n                >\n                  {t('resetPassword.resetPasswordButton')}\n                </Button>\n              </div>\n\n              <div className=\"text-sm text-center\">\n                <Link to=\"/login\" className=\"font-medium text-blue-600 hover:text-blue-500\">\n                  {t('resetPassword.backToLogin')}\n                </Link>\n              </div>\n            </form>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default ResetPassword;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\billing\\Billing.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\clinics\\Clinics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1771,1774],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1771,1774],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7140,7143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7140,7143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7172,7175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7172,7175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":111,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":114,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7211,7214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7211,7214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { Card, Button, Input, Alert, Modal } from '../../components/ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { getClinic } from '../../services/clinicService';\nimport type { Clinic } from '../../types';\n\ninterface ClinicFormData {\n  name: string;\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n  };\n  phone: string;\n  email: string;\n  description?: string;\n}\n\nconst Clinics: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [clinic, setClinic] = useState<Clinic | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [formData, setFormData] = useState<ClinicFormData>({\n    name: '',\n    address: {\n      street: '',\n      city: '',\n      state: '',\n      zipCode: '',\n      country: ''\n    },\n    phone: '',\n    email: '',\n    description: ''\n  });\n\n  // Check if user has admin privileges\n  const isAdmin = user?.role === 'admin' || user?.role === 'super_admin';\n\n  useEffect(() => {\n    if (!isAdmin) {\n      setError('Access denied. Admin privileges required.');\n      setLoading(false);\n      return;\n    }\n    fetchClinic();\n  }, [isAdmin]);\n\n  const fetchClinic = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const response = await getClinic();\n      if (response.success && response.data) {\n        setClinic(response.data);\n      } else {\n        setError(response.message || 'Failed to fetch clinic');\n      }\n    } catch (err: any) {\n      setError(err.message || 'Failed to fetch clinic');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    if (name.startsWith('address.')) {\n      const addressField = name.split('.')[1];\n      setFormData(prev => ({\n        ...prev,\n        address: {\n          ...prev.address,\n          [addressField]: value\n        }\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n  };\n\n  const handleEdit = (clinic: Clinic) => {\n    setFormData({\n      name: clinic.name,\n      address: {\n        street: clinic.address.street || '',\n        city: clinic.address.city || '',\n        state: clinic.address.state || '',\n        zipCode: clinic.address.zipCode || '',\n        country: clinic.address.country || ''\n      },\n      phone: clinic.phone,\n      email: clinic.email,\n      description: clinic.description || ''\n    });\n    setShowEditModal(true);\n  };\n\n  const resetForm = () => {\n    setFormData({\n      name: '',\n      address: {\n        street: '',\n        city: '',\n        state: '',\n        zipCode: '',\n        country: ''\n      },\n      phone: '',\n      email: '',\n      description: ''\n    });\n    setShowEditModal(false);\n  };\n\n  if (!isAdmin) {\n    return (\n      <div className=\"container mx-auto px-4 py-8\">\n        <Alert variant=\"error\">\n          Access denied. You need admin privileges to manage clinic settings.\n        </Alert>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (!clinic) {\n    return (\n      <div className=\"container mx-auto px-4 py-8\">\n        <Alert variant=\"error\">\n          No clinic found. Please contact system administrator.\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-2xl font-bold\">Clinic Information</h1>\n        <Button\n          variant=\"primary\"\n          onClick={() => handleEdit(clinic)}\n        >\n          Edit Clinic\n        </Button>\n      </div>\n\n      {error && (\n        <Alert variant=\"error\" className=\"mb-4\">\n          {error}\n        </Alert>\n      )}\n\n      {/* Single Clinic Display */}\n      <div className=\"max-w-4xl mx-auto\">\n        <Card className=\"p-6\">\n          <div className=\"flex justify-between items-start mb-6\">\n            <h3 className=\"text-2xl font-semibold\">{clinic.name}</h3>\n            <div className=\"flex space-x-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => handleEdit(clinic)}\n              >\n                Edit\n              </Button>\n            </div>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Address</h4>\n                <p className=\"text-gray-900\">\n                  {clinic.address.street}, {clinic.address.city}, {clinic.address.state} {clinic.address.zipCode}\n                </p>\n                <p className=\"text-gray-600\">{clinic.address.country}</p>\n              </div>\n              \n              <div>\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Contact Information</h4>\n                <p className=\"text-gray-900\">\n                  <strong>Phone:</strong> {clinic.phone}\n                </p>\n                <p className=\"text-gray-900\">\n                  <strong>Email:</strong> {clinic.email}\n                </p>\n                {clinic.website && (\n                  <p className=\"text-gray-900\">\n                    <strong>Website:</strong> {clinic.website}\n                  </p>\n                )}\n              </div>\n            </div>\n            \n            <div className=\"space-y-4\">\n              {clinic.description && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Description</h4>\n                  <p className=\"text-gray-900\">{clinic.description}</p>\n                </div>\n              )}\n              \n              <div>\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Status</h4>\n                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                  clinic.isActive \n                    ? 'bg-green-100 text-green-800' \n                    : 'bg-red-100 text-red-800'\n                }`}>\n                  {clinic.isActive ? 'Active' : 'Inactive'}\n                </span>\n              </div>\n              \n              <div>\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Operating Hours</h4>\n                {clinic.operatingHours && clinic.operatingHours.length > 0 ? (\n                  <div className=\"space-y-1\">\n                    {clinic.operatingHours.map((hours, index) => (\n                      <p key={index} className=\"text-sm text-gray-900\">\n                        {typeof hours === 'object' ? \n                          `${(hours as any).day || 'Day'}: ${(hours as any).openTime || '9:00'} - ${(hours as any).closeTime || '17:00'}` : \n                          String(hours)\n                        }\n                      </p>\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-sm text-gray-500\">No operating hours set</p>\n                )}\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"mt-6 pt-6 border-t\">\n            <Link\n              to={`/settings/clinic/${clinic.id}`}\n              className=\"text-blue-600 hover:text-blue-700 text-sm\"\n            >\n              View Detailed Settings \n            </Link>\n          </div>\n        </Card>\n      </div>\n\n      {/* Edit Modal */}\n      <Modal\n        isOpen={showEditModal}\n        onClose={resetForm}\n        title={t('clinics.editClinicInfo')}\n        size=\"lg\"\n      >\n        <div className=\"p-4\">\n          <Alert variant=\"info\" className=\"mb-4\">\n            Note: Clinic updates are currently disabled in single clinic mode. \n            Please contact system administrator for any changes.\n          </Alert>\n          \n          <div className=\"space-y-4\">\n            <Input\n              label={t('clinics.name')}\n              name=\"name\"\n              value={formData.name}\n              onChange={handleInputChange}\n              disabled\n            />\n            \n            <div className=\"space-y-3\">\n              <h4 className=\"text-sm font-medium text-gray-700\">Address</h4>\n              <Input\n                label={t('clinics.address')}\n                name=\"address.street\"\n                value={formData.address.street}\n                onChange={handleInputChange}\n                disabled\n              />\n              <div className=\"grid grid-cols-2 gap-3\">\n                <Input\n                  label=\"City\"\n                  name=\"address.city\"\n                  value={formData.address.city}\n                  onChange={handleInputChange}\n                  disabled\n                />\n                <Input\n                  label=\"State\"\n                  name=\"address.state\"\n                  value={formData.address.state}\n                  onChange={handleInputChange}\n                  disabled\n                />\n              </div>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <Input\n                  label=\"ZIP Code\"\n                  name=\"address.zipCode\"\n                  value={formData.address.zipCode}\n                  onChange={handleInputChange}\n                  disabled\n                />\n                <Input\n                  label=\"Country\"\n                  name=\"address.country\"\n                  value={formData.address.country}\n                  onChange={handleInputChange}\n                  disabled\n                />\n              </div>\n            </div>\n            \n            <Input\n              label=\"Phone\"\n              name=\"phone\"\n              type=\"tel\"\n              value={formData.phone}\n              onChange={handleInputChange}\n              disabled\n            />\n            \n            <Input\n              label=\"Email\"\n              name=\"email\"\n              type=\"email\"\n              value={formData.email}\n              onChange={handleInputChange}\n              disabled\n            />\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Description (Optional)\n              </label>\n              <textarea\n                name=\"description\"\n                value={formData.description}\n                onChange={handleInputChange}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50\"\n                placeholder={t('common.placeholders.description')}\n                disabled\n              />\n            </div>\n          </div>\n          \n          <div className=\"flex justify-end space-x-3 pt-4\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={resetForm}\n            >\n              Close\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n};\n\nexport default Clinics;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\clinics\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dashboard\\ClinicDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 't'. Either include it or remove the dependency array.","line":244,"column":6,"nodeType":"ArrayExpression","endLine":244,"endColumn":82,"suggestions":[{"desc":"Update the dependencies array to be: [selectedClinic, user?.role, user?.preferredClinicId, user?.assignedClinics, t]","fix":{"range":[8583,8659],"text":"[selectedClinic, user?.role, user?.preferredClinicId, user?.assignedClinics, t]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 't'. Either include it or remove the dependency array.","line":305,"column":6,"nodeType":"ArrayExpression","endLine":305,"endColumn":82,"suggestions":[{"desc":"Update the dependencies array to be: [user?.role, user?.preferredClinicId, user?.assignedClinics, selectedClinic?.id, t]","fix":{"range":[10680,10756],"text":"[user?.role, user?.preferredClinicId, user?.assignedClinics, selectedClinic?.id, t]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":833,"column":96,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":833,"endColumn":99,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35129,35132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35129,35132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { Card, Button, Badge } from '../../components/ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { useClinic } from '../../hooks/useClinic';\nimport { getDashboardStats, getRecentActivities, type DashboardStats, type RecentActivity } from '../../services/dashboardService';\nimport {\n  Calendar,\n  Users,\n  DollarSign,\n  FileText,\n  TrendingUp,\n  TrendingDown,\n  Clock,\n  Activity,\n  AlertCircle,\n  CheckCircle,\n  Plus,\n  RefreshCw,\n  Download,\n  ArrowUpRight,\n  ArrowDownRight,\n  BarChart3,\n  UserCheck,\n  CalendarCheck,\n  CreditCard,\n  ChevronRight,\n  Zap,\n  Building2,\n  Stethoscope\n} from 'lucide-react';\n\ninterface StatCardProps {\n  title: string;\n  value: string | number;\n  icon: React.ReactNode;\n  change?: string;\n  isPositive?: boolean;\n  linkTo?: string;\n  loading?: boolean;\n  gradient?: string;\n  description?: string;\n  trend?: number;\n}\n\ninterface QuickActionProps {\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n  linkTo: string;\n  color: string;\n  badge?: string;\n}\n\ninterface MetricCardProps {\n  title: string;\n  value: string | number;\n  change: number;\n  icon: React.ReactNode;\n  color: string;\n  loading?: boolean;\n}\n\nconst StatCard: React.FC<StatCardProps> = ({ \n  title, \n  value, \n  icon, \n  change, \n  isPositive = true,\n  linkTo,\n  loading = false,\n  gradient = 'from-blue-500 to-purple-600',\n  description,\n  trend\n}) => {\n  const { t } = useTranslation();\n  return (\n    <Card className=\"h-full hover:shadow-lg transition-all duration-300 border-0 bg-gradient-to-br from-white to-gray-50/50 backdrop-blur-sm\">\n      <div className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className={`p-3 rounded-xl bg-gradient-to-r ${gradient} shadow-lg`}>\n            <div className=\"text-white\">{icon}</div>\n          </div>\n          {trend !== undefined && (\n            <div className={`flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ${\n              trend > 0 ? 'bg-green-100 text-green-700' : trend < 0 ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-700'\n            }`}>\n              {trend > 0 ? <TrendingUp className=\"w-3 h-3\" /> : trend < 0 ? <TrendingDown className=\"w-3 h-3\" /> : <Activity className=\"w-3 h-3\" />}\n              <span>{Math.abs(trend)}%</span>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"space-y-1\">\n          <p className=\"text-sm font-medium text-gray-600\">{title}</p>\n          {loading ? (\n            <div className=\"h-8 flex items-center\">\n              <div className=\"animate-pulse bg-gray-200 h-6 w-20 rounded\"></div>\n            </div>\n          ) : (\n            <p className=\"text-2xl font-bold text-gray-900\">{value}</p>\n          )}\n          {description && (\n            <p className=\"text-xs text-gray-500\">{description}</p>\n          )}\n          {change && (\n            <p className={`text-sm font-medium flex items-center space-x-1 ${\n              isPositive ? 'text-green-600' : 'text-red-600'\n            }`}>\n              {isPositive ? <ArrowUpRight className=\"w-4 h-4\" /> : <ArrowDownRight className=\"w-4 h-4\" />}\n              <span>{change}</span>\n            </p>\n          )}\n        </div>\n        \n        {linkTo && (\n          <div className=\"mt-4 pt-4 border-t border-gray-100\">\n            <Link \n              to={linkTo} \n              className=\"inline-flex items-center space-x-2 text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors group\"\n            >\n              <span>{t('dashboard.viewDetails')}</span>\n              <ChevronRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n            </Link>\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n};\n\nconst MetricCard: React.FC<MetricCardProps & { fromLastMonthText?: string }> = ({ title, value, change, icon, color, loading, fromLastMonthText }) => {\n  return (\n    <div className={`p-4 rounded-xl bg-gradient-to-r ${color} text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105`}>\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex-1\">\n          <p className=\"text-sm font-medium text-white/80\">{title}</p>\n          {loading ? (\n            <div className=\"animate-pulse bg-white/20 h-6 w-16 rounded mt-1\"></div>\n          ) : (\n            <p className=\"text-2xl font-bold mt-1\">{value}</p>\n          )}\n        </div>\n        <div className=\"p-2 bg-white/20 rounded-lg\">\n          {icon}\n        </div>\n      </div>\n      {change !== 0 && (\n        <div className=\"flex items-center mt-2 space-x-1\">\n          {change > 0 ? <TrendingUp className=\"w-4 h-4\" /> : <TrendingDown className=\"w-4 h-4\" />}\n          <span className=\"text-sm font-medium\">\n            {change > 0 ? '+' : ''}{change}% {fromLastMonthText || 'from last month'}\n          </span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst QuickActionCard: React.FC<QuickActionProps> = ({ title, description, icon, linkTo, color, badge }) => {\n  return (\n    <Link to={linkTo} className=\"block group\">\n      <Card className=\"h-full p-6 hover:shadow-lg transition-all duration-300 border-0 bg-gradient-to-br from-white to-gray-50/50 group-hover:from-gray-50 group-hover:to-white\">\n        <div className=\"flex items-center space-x-4\">\n          <div className={`p-3 rounded-xl bg-gradient-to-r ${color} shadow-lg group-hover:shadow-xl transition-shadow`}>\n            <div className=\"text-white\">{icon}</div>\n          </div>\n          <div className=\"flex-1\">\n            <div className=\"flex items-center space-x-2\">\n              <h3 className=\"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors\">{title}</h3>\n              {badge && (\n                <Badge className=\"bg-blue-100 text-blue-700 text-xs\">{badge}</Badge>\n              )}\n            </div>\n            <p className=\"text-sm text-gray-600 mt-1\">{description}</p>\n          </div>\n          <ChevronRight className=\"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all\" />\n        </div>\n      </Card>\n    </Link>\n  );\n};\n\nconst ClinicDashboard: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const { selectedClinic } = useClinic();\n  const [isLoading, setIsLoading] = useState(true);\n  const [dashboardStats, setDashboardStats] = useState<DashboardStats | null>(null);\n  const [recentActivities, setRecentActivities] = useState<RecentActivity[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [refreshing, setRefreshing] = useState(false);\n\n  useEffect(() => {\n    const fetchDashboardData = async () => {\n      // For doctors/dentists, allow dashboard access even without selected clinic\n      // They can view their personal statistics across all assigned clinics\n      if (!selectedClinic?.id && user?.role !== 'admin' && user?.role !== 'super_admin' && user?.role !== 'dentist') {\n        setError(t('errors.selectClinicFirst'));\n        setIsLoading(false);\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        setError(null);\n        \n        // For doctors, use their assigned clinic or selected clinic\n        const clinicId = user?.role === 'dentist' ? \n          (selectedClinic?.id || user?.preferredClinicId || user?.assignedClinics?.[0]) : \n          selectedClinic?.id;\n        \n        const [statsResponse, activitiesResponse] = await Promise.all([\n          getDashboardStats(clinicId),\n          getRecentActivities(10, clinicId)\n        ]);\n        \n        if (statsResponse.success && statsResponse.data) {\n          setDashboardStats(statsResponse.data);\n        } else {\n          // For doctors, show a more helpful error message\n          if (user?.role === 'dentist') {\n            setError(t('dashboard.errors.noAssignedClinic'));\n          } else {\n            setError(statsResponse.message || t('dashboard.errors.failedToFetchStats'));\n          }\n        }\n        \n        if (activitiesResponse.success && activitiesResponse.data) {\n          setRecentActivities(activitiesResponse.data);\n        } else {\n          console.warn('Failed to fetch recent activities');\n        }\n      } catch (err) {\n        console.error('Error fetching dashboard data:', err);\n        setError(t('errors.failedToLoadData'));\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchDashboardData();\n  }, [selectedClinic, user?.role, user?.preferredClinicId, user?.assignedClinics]);\n\n  const formatCurrency = (amount: number): string => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2\n    }).format(amount);\n  };\n\n  const getInitials = (name: string): string => {\n    return name\n      .split(' ')\n      .map(n => n[0])\n      .join('')\n      .toUpperCase();\n  };\n\n  const formatTimeAgo = (timestamp: string): string => {\n    const now = new Date();\n    const time = new Date(timestamp);\n    const diffInMinutes = Math.floor((now.getTime() - time.getTime()) / (1000 * 60));\n\n    if (diffInMinutes < 60) {\n      return t(diffInMinutes === 1 ? 'dashboard.minuteAgo' : 'dashboard.minutesAgo', { count: diffInMinutes });\n    } else if (diffInMinutes < 1440) {\n      const hours = Math.floor(diffInMinutes / 60);\n      return t(hours === 1 ? 'dashboard.hourAgo' : 'dashboard.hoursAgo', { count: hours });\n    } else {\n      const days = Math.floor(diffInMinutes / 1440);\n      return t(days === 1 ? 'dashboard.dayAgo' : 'dashboard.daysAgo', { count: days });\n    }\n  };\n\n  const handleRefresh = useCallback(async () => {\n    setRefreshing(true);\n    try {\n      // For doctors, use their assigned clinic or selected clinic\n      const clinicId = user?.role === 'dentist' ? \n        (selectedClinic?.id || user?.preferredClinicId || user?.assignedClinics?.[0]) : \n        selectedClinic?.id;\n        \n      const [statsResponse, activitiesResponse] = await Promise.all([\n        getDashboardStats(clinicId),\n        getRecentActivities(10, clinicId)\n      ]);\n      \n      if (statsResponse.success && statsResponse.data) {\n        setDashboardStats(statsResponse.data);\n        setError(null);\n      }\n      \n      if (activitiesResponse.success && activitiesResponse.data) {\n        setRecentActivities(activitiesResponse.data);\n      }\n    } catch (err) {\n      console.error('Error refreshing dashboard data:', err);\n      setError(t('dashboard.errors.failedToRefresh'));\n    } finally {\n      setRefreshing(false);\n    }\n  }, [selectedClinic, user?.role, user?.preferredClinicId, user?.assignedClinics]);\n\n  const quickActions = useMemo(() => {\n    // Doctor-specific quick actions\n    if (user?.role === 'dentist') {\n      return [\n        {\n          title: t('appointments.newAppointment'),\n          description: t('dashboard.quickActions.scheduleAppointmentDesc'),\n          icon: <Plus className=\"w-5 h-5\" />,\n          linkTo: '/appointments/create',\n          color: 'from-blue-500 to-blue-600',\n          badge: 'Quick'\n        },\n        {\n          title: t('dashboard.quickActions.myAppointments'),\n          description: t('dashboard.quickActions.viewAppointmentsDesc'),\n          icon: <Calendar className=\"w-5 h-5\" />,\n          linkTo: '/appointments',\n          color: 'from-indigo-500 to-indigo-600'\n        },\n        {\n          title: t('prescriptions.create'),\n          description: t('dashboard.quickActions.createPrescriptionDesc'),\n          icon: <FileText className=\"w-5 h-5\" />,\n          linkTo: '/prescriptions/create',\n          color: 'from-purple-500 to-purple-600'\n        },\n        {\n          title: t('dashboard.quickActions.patientRecords'),\n          description: t('dashboard.quickActions.accessRecordsDesc'),\n          icon: <UserCheck className=\"w-5 h-5\" />,\n          linkTo: '/patients',\n          color: 'from-green-500 to-green-600'\n        }\n      ];\n    }\n    \n    // Default actions for admin/staff\n    return [\n      {\n        title: t('appointments.newAppointment'),\n        description: 'Schedule a new patient appointment',\n        icon: <Plus className=\"w-5 h-5\" />,\n        linkTo: '/appointments/create',\n        color: 'from-blue-500 to-blue-600',\n        badge: 'Quick'\n      },\n      {\n        title: t('patients.addPatient'),\n        description: t('dashboard.quickActions.registerPatientDesc'),\n        icon: <UserCheck className=\"w-5 h-5\" />,\n        linkTo: '/patients/create',\n        color: 'from-green-500 to-green-600'\n      },\n      {\n        title: t('prescriptions.create'),\n        description: 'Create new prescription',\n        icon: <FileText className=\"w-5 h-5\" />,\n        linkTo: '/prescriptions/create',\n        color: 'from-purple-500 to-purple-600'\n      },\n      {\n        title: t('reports.generate'),\n        description: 'Generate clinic reports',\n        icon: <BarChart3 className=\"w-5 h-5\" />,\n        linkTo: '/reports',\n        color: 'from-orange-500 to-orange-600'\n      }\n    ];\n  }, [t, user?.role]);\n\n  // Only show clinic selection for non-doctor roles\n  if (!selectedClinic && user?.role !== 'admin' && user?.role !== 'super_admin' && user?.role !== 'dentist') {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-8\">\n          <div className=\"w-20 h-20 mx-auto mb-6 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg\">\n            <Stethoscope className=\"w-10 h-10 text-white\" />\n          </div>\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Select a Clinic</h2>\n          <p className=\"text-gray-600 mb-6\">{t('dashboard.selectClinicMessage')}</p>\n          <Link to=\"/clinics\">\n            <Button variant=\"primary\" className=\"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700\">\n              <Building2 className=\"w-4 h-4 mr-2\" />\n              Browse Clinics\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n      {/* Enhanced Header */}\n      <div className=\"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 shadow-xl border-b border-blue-800/50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6\">\n          <div className=\"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 lg:gap-0\">\n            {/* Left Section */}\n            <div className=\"flex items-center space-x-3 sm:space-x-4 min-w-0 flex-1\">\n              <div className=\"relative flex-shrink-0\">\n                <div className=\"p-2 sm:p-3 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-xl shadow-lg\">\n                  <Stethoscope className=\"w-6 h-6 sm:w-8 sm:h-8 text-white\" />\n                </div>\n                <div className=\"absolute -top-1 -right-1 w-2.5 h-2.5 sm:w-3 sm:h-3 bg-green-400 rounded-full border-2 border-white animate-pulse\"></div>\n              </div>\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"text-xl sm:text-2xl lg:text-3xl font-bold text-white truncate\">\n                  {user?.role === 'dentist' ? 'Doctor Dashboard' : t('navigation.dashboard')}\n                </h1>\n                <p className=\"text-blue-100/80 text-xs sm:text-sm lg:text-base truncate\">\n                  {user?.role === 'dentist'\n                    ? `Welcome back, Dr. ${user?.firstName || 'Doctor'}${selectedClinic ? ` - ${selectedClinic.name}` : ''}`\n                    : selectedClinic\n                      ? t('dashboard.welcome_clinic', { name: user?.firstName || 'User', clinicName: selectedClinic.name })\n                      : (user?.role === 'admin' || user?.role === 'super_admin')\n                        ? t('dashboard.welcome_admin', { name: user?.firstName || 'User' })\n                        : t('dashboard.welcome_select_clinic', { name: user?.firstName || 'User' })\n                  }\n                </p>\n                <div className=\"hidden sm:flex items-center space-x-2 sm:space-x-4 mt-2 text-xs text-blue-200/70\">\n                  <span className=\"flex items-center space-x-1\">\n                    <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n                    <span>System Online</span>\n                  </span>\n                  <span className=\"flex items-center space-x-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    <span>Last updated: {new Date().toLocaleTimeString()}</span>\n                  </span>\n                  {user?.role === 'dentist' && user?.specialization && (\n                    <span className=\"flex items-center space-x-1\">\n                      <UserCheck className=\"w-3 h-3\" />\n                      <span>{user.specialization}</span>\n                    </span>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            {/* Right Section */}\n            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 w-full sm:w-auto\">\n              <Button \n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={isLoading || refreshing}\n                className=\"bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 min-h-[44px] sm:min-h-0\"\n              >\n                <RefreshCw className={`w-4 h-4 mr-2 flex-shrink-0 ${isLoading || refreshing ? 'animate-spin' : ''}`} />\n                <span className=\"truncate\">{isLoading || refreshing ? 'Refreshing...' : t('dashboard.refresh')}</span>\n              </Button>\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={() => console.log('Export clicked')}\n                className=\"hidden sm:flex bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30\"\n              >\n                <Download className=\"w-4 h-4 mr-2\" />\n                {t('dashboard.export')}\n              </Button>\n              <Link to=\"/appointments/create\" className=\"w-full sm:w-auto\">\n                <Button \n                  variant=\"primary\" \n                  size=\"sm\"\n                  className=\"w-full sm:w-auto bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 min-h-[44px] sm:min-h-0\"\n                >\n                  <Plus className=\"w-4 h-4 mr-2 flex-shrink-0\" />\n                  <span className=\"truncate\">{t('appointments.newAppointment')}</span>\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\n\n        {error && (\n          <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl shadow-sm\">\n            <div className=\"flex items-center\">\n              <div className=\"flex-shrink-0\">\n                <AlertCircle className=\"h-5 w-5 text-red-400\" />\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm font-medium text-red-800\">{error}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {user?.role === 'patient' ? (\n          // Patient Dashboard Stats\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n            <StatCard\n              title={t('dashboard.Appointments')}\n              value={t('dashboard.viewAll')}\n              icon={<Calendar className=\"w-6 h-6\" />}\n              linkTo=\"/appointments\"\n              loading={isLoading}\n              gradient=\"from-blue-500 to-blue-600\"\n            />\n            <StatCard\n              title={t('dashboard.Prescriptions')}\n              value={t('dashboard.viewAll')}\n              icon={<FileText className=\"w-6 h-6\" />}\n              linkTo=\"/prescriptions\"\n              loading={isLoading}\n              gradient=\"from-green-500 to-green-600\"\n            />\n            <StatCard\n              title={t('dashboard.Billing')}\n              value={t('dashboard.viewAll')}\n              icon={<CreditCard className=\"w-6 h-6\" />}\n              linkTo=\"/billing\"\n              loading={isLoading}\n              gradient=\"from-purple-500 to-purple-600\"\n            />\n            <StatCard \n              title={t('dashboard.Reports')}\n              value={t('dashboard.viewAll')}\n              icon={<BarChart3 className=\"w-6 h-6\" />}\n              linkTo=\"/reports\"\n              loading={isLoading}\n              gradient=\"from-orange-500 to-orange-600\"\n            />\n          </div>\n        ) : user?.role === 'dentist' ? (\n          // Doctor/Dentist Dashboard Stats\n          <>\n            {/* Doctor Key Metrics Row */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n              <MetricCard\n                title=\"Today's Appointments\"\n                value={dashboardStats?.appointments.today || 0}\n                change={12}\n                icon={<Calendar className=\"w-6 h-6\" />}\n                color=\"from-blue-500 to-blue-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n              <MetricCard\n                title=\"My Patients\"\n                value={dashboardStats?.patients.total || 0}\n                change={8}\n                icon={<Users className=\"w-6 h-6\" />}\n                color=\"from-green-500 to-green-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n              <MetricCard\n                title=\"Completed Today\"\n                value={dashboardStats?.appointments.completed || 0}\n                change={5}\n                icon={<CheckCircle className=\"w-6 h-6\" />}\n                color=\"from-purple-500 to-purple-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n              <MetricCard\n                title=\"Upcoming\"\n                value={dashboardStats?.appointments.upcoming || 0}\n                change={-2}\n                icon={<Clock className=\"w-6 h-6\" />}\n                color=\"from-orange-500 to-orange-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n            </div>\n\n            {/* Doctor Detailed Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n              <StatCard\n                title=\"Today's Schedule\"\n                value={dashboardStats?.appointments.today || 0}\n                icon={<Calendar className=\"w-6 h-6\" />}\n                linkTo=\"/appointments\"\n                loading={isLoading}\n                gradient=\"from-blue-500 to-blue-600\"\n                description=\"Appointments scheduled for today\"\n                trend={12}\n              />\n              <StatCard\n                title=\"Active Patients\"\n                value={dashboardStats?.patients.active || 0}\n                icon={<Users className=\"w-6 h-6\" />}\n                linkTo=\"/patients\"\n                loading={isLoading}\n                gradient=\"from-green-500 to-green-600\"\n                description=\"Patients under your care\"\n                trend={8}\n              />\n              <StatCard\n                title=\"Prescriptions\"\n                value={dashboardStats?.activities?.recentAppointments?.length || 0}\n                icon={<FileText className=\"w-6 h-6\" />}\n                linkTo=\"/prescriptions\"\n                loading={isLoading}\n                gradient=\"from-purple-500 to-purple-600\"\n                description=\"Recent prescriptions\"\n                trend={15}\n              />\n              <StatCard\n                title=\"Treatment Records\"\n                value={dashboardStats?.appointments.completed || 0}\n                icon={<Activity className=\"w-6 h-6\" />}\n                linkTo=\"/treatments\"\n                loading={isLoading}\n                gradient=\"from-indigo-500 to-indigo-600\"\n                description=\"Completed treatments\"\n                trend={10}\n              />\n            </div>\n          </>\n        ) : (\n          // Staff/Admin Dashboard Stats\n          <>\n            {/* Key Metrics Row */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n              <MetricCard\n                title={t('dashboard.todayAppointments')}\n                value={dashboardStats?.appointments.today || 0}\n                change={12}\n                icon={<Calendar className=\"w-6 h-6\" />}\n                color=\"from-blue-500 to-blue-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n              <MetricCard\n                title={t('dashboard.totalPatients')}\n                value={dashboardStats?.patients.total || 0}\n                change={8}\n                icon={<Users className=\"w-6 h-6\" />}\n                color=\"from-green-500 to-green-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n              <MetricCard\n                title={t('dashboard.monthlyRevenue')}\n                value={dashboardStats ? formatCurrency(dashboardStats.revenue.thisMonth) : '$0'}\n                change={15}\n                icon={<DollarSign className=\"w-6 h-6\" />}\n                color=\"from-purple-500 to-purple-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n              <MetricCard\n                title={t('dashboard.upcomingAppointments')}\n                value={dashboardStats?.appointments.upcoming || 0}\n                change={-3}\n                icon={<Clock className=\"w-6 h-6\" />}\n                color=\"from-orange-500 to-orange-600\"\n                loading={isLoading}\n                fromLastMonthText={t('dashboard.fromLastMonth')}\n              />\n            </div>\n\n            {/* Detailed Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n              <StatCard\n                title={t('dashboard.todayAppointments')}\n                value={dashboardStats?.appointments.today || 0}\n                icon={<Calendar className=\"w-6 h-6\" />}\n                linkTo=\"/appointments\"\n                loading={isLoading}\n                gradient=\"from-blue-500 to-blue-600\"\n                description=\"Scheduled for today\"\n                trend={12}\n              />\n              <StatCard\n                title={t('dashboard.totalPatients')}\n                value={dashboardStats?.patients.total || 0}\n                icon={<Users className=\"w-6 h-6\" />}\n                linkTo=\"/patients\"\n                loading={isLoading}\n                gradient=\"from-green-500 to-green-600\"\n                description=\"Registered patients\"\n                trend={8}\n              />\n              <StatCard\n                title={t('dashboard.monthlyRevenue')}\n                value={dashboardStats ? formatCurrency(dashboardStats.revenue.thisMonth) : '$0'}\n                icon={<DollarSign className=\"w-6 h-6\" />}\n                linkTo=\"/reports/financial\"\n                loading={isLoading}\n                gradient=\"from-purple-500 to-purple-600\"\n                description=\"This month's earnings\"\n                trend={15}\n              />\n              <StatCard\n                title={t('dashboard.upcomingAppointments')}\n                value={dashboardStats?.appointments.upcoming || 0}\n                icon={<Clock className=\"w-6 h-6\" />}\n                linkTo=\"/appointments\"\n                loading={isLoading}\n                gradient=\"from-orange-500 to-orange-600\"\n                description=\"Next 7 days\"\n                trend={-3}\n              />\n            </div>\n          </>\n        )}\n\n        {/* Quick Actions Section */}\n        <div className=\"mb-6 sm:mb-8\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6 gap-2\">\n            <h2 className=\"text-xl sm:text-2xl font-bold text-gray-900 flex items-center gap-2\">\n              <Zap className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600 flex-shrink-0\" />\n              <span className=\"truncate\">{user?.role === 'dentist' ? 'Doctor Quick Actions' : 'Quick Actions'}</span>\n            </h2>\n            {user?.role === 'dentist' && (\n              <div className=\"text-xs sm:text-sm text-gray-600\">\n                Access your most used tools quickly\n              </div>\n            )}\n          </div>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6\">\n            {quickActions.map((action, index) => (\n              <QuickActionCard\n                key={index}\n                title={action.title}\n                description={action.description}\n                icon={action.icon}\n                linkTo={action.linkTo}\n                color={action.color}\n                badge={action.badge}\n              />\n            ))}\n          </div>\n        </div>\n\n        {/* Main Content Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8\">\n          {/* Recent Activity */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"p-6 border-0 shadow-lg bg-gradient-to-br from-white to-gray-50/50\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-xl font-bold text-gray-900 flex items-center gap-2\">\n                  <Activity className=\"w-5 h-5 text-blue-600\" />\n                  {user?.role === 'dentist' ? 'Recent Patient Activities' : t('dashboard.recentActivity')}\n                </h2>\n                <Link \n                  to={user?.role === 'dentist' ? '/appointments' : '/activity'}\n                  className=\"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center gap-1 group\"\n                >\n                  View All\n                  <ChevronRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n                </Link>\n              </div>\n              <div className=\"space-y-4\">\n                {isLoading ? (\n                  <div className=\"flex justify-center py-8\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                  </div>\n                ) : recentActivities.length > 0 ? (\n                  recentActivities.slice(0, 5).map((activity) => {\n                    const getActivityIcon = (type: string, status?: string) => {\n                      switch (type) {\n                        case 'patient':\n                          return (\n                            <div className=\"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center text-white shadow-lg\">\n                              <Users className=\"h-5 w-5\" />\n                            </div>\n                          );\n                        case 'appointment':\n                          const bgColor = status === 'completed' ? 'from-green-500 to-green-600' : status === 'cancelled' ? 'from-red-500 to-red-600' : 'from-yellow-500 to-yellow-600';\n                          return (\n                            <div className={`h-10 w-10 rounded-full bg-gradient-to-r ${bgColor} flex items-center justify-center text-white shadow-lg`}>\n                              <Calendar className=\"h-5 w-5\" />\n                            </div>\n                          );\n                        default:\n                          return (\n                            <div className=\"h-10 w-10 rounded-full bg-gradient-to-r from-gray-500 to-gray-600 flex items-center justify-center text-white shadow-lg\">\n                              <Activity className=\"h-5 w-5\" />\n                            </div>\n                          );\n                      }\n                    };\n\n                    return (\n                      <div key={activity.id} className=\"flex items-start p-4 hover:bg-blue-50/50 rounded-xl transition-all duration-200 group\">\n                        <div className=\"flex-shrink-0\">\n                          {getActivityIcon(activity.type, activity.status)}\n                        </div>\n                        <div className=\"ml-4 flex-1\">\n                          <p className=\"text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors\">{activity.title}</p>\n                          <p className=\"text-sm text-gray-600\">{activity.description}</p>\n                          <p className=\"text-xs text-gray-500 mt-1 flex items-center gap-1\">\n                            <Clock className=\"w-3 h-3\" />\n                            {formatTimeAgo(activity.timestamp)}\n                          </p>\n                        </div>\n                      </div>\n                    );\n                  })\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <Activity className=\"w-12 h-12 text-gray-300 mx-auto mb-4\" />\n                    <p className=\"text-gray-500\">{t('dashboard.noRecentActivity')}</p>\n                  </div>\n                )}\n              </div>\n            </Card>\n          </div>\n\n          {/* Upcoming Appointments */}\n          <div>\n            <Card className=\"p-6 border-0 shadow-lg bg-gradient-to-br from-white to-gray-50/50\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-xl font-bold text-gray-900 flex items-center gap-2\">\n                  <CalendarCheck className=\"w-5 h-5 text-blue-600\" />\n                  {user?.role === 'dentist' ? 'My Upcoming Appointments' : t('dashboard.upcomingAppointments')}\n                </h2>\n                <Link \n                  to=\"/appointments\" \n                  className=\"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center gap-1 group\"\n                >\n                  {user?.role === 'dentist' ? 'View Schedule' : 'View All'}\n                  <ChevronRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n                </Link>\n              </div>\n              <div className=\"space-y-4\">\n                {isLoading ? (\n                  <div className=\"flex justify-center py-8\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                  </div>\n                ) : dashboardStats?.activities?.upcomingAppointments && dashboardStats.activities.upcomingAppointments.length > 0 ? (\n                  dashboardStats.activities.upcomingAppointments.slice(0, 5).map((appointment: any) => {\n                    const appointmentDate = new Date(appointment.startTime);\n                    const isToday = appointmentDate.toDateString() === new Date().toDateString();\n                    const isTomorrow = appointmentDate.toDateString() === new Date(Date.now() + 24 * 60 * 60 * 1000).toDateString();\n                    \n                    const formatDate = () => {\n                      if (isToday) return t('dashboard.today');\n                      if (isTomorrow) return t('dashboard.tomorrow');\n                      return appointmentDate.toLocaleDateString(navigator.language, { month: 'short', day: 'numeric' });\n                    };\n\n                    const formatTime = () => {\n                      return appointmentDate.toLocaleTimeString('en-US', { \n                        hour: 'numeric', \n                        minute: '2-digit',\n                        hour12: true \n                      });\n                    };\n\n                    return (\n                      <div key={appointment._id} className=\"flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl hover:from-blue-100 hover:to-purple-100 transition-all duration-200 group\">\n                        <div className=\"flex items-center\">\n                          <div className=\"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm shadow-lg\">\n                            {getInitials(appointment.patient?.firstName ? `${appointment.patient.firstName} ${appointment.patient.lastName}` : 'Patient')}\n                          </div>\n                          <div className=\"ml-3\">\n                            <p className=\"text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors\">\n                              {appointment.patient?.firstName ? `${appointment.patient.firstName} ${appointment.patient.lastName}` : 'Patient'}\n                            </p>\n                            <p className=\"text-sm text-gray-600\">{appointment.treatmentType || t('appointments.appointment')}</p>\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <p className=\"text-sm font-semibold text-gray-900\">{formatTime()}</p>\n                          <p className=\"text-sm text-gray-600\">{formatDate()}</p>\n                        </div>\n                      </div>\n                    );\n                  })\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <CalendarCheck className=\"w-12 h-12 text-gray-300 mx-auto mb-4\" />\n                    <p className=\"text-gray-500\">\n                      {user?.role === 'dentist' \n                        ? 'No upcoming appointments scheduled' \n                        : t('dashboard.noUpcomingAppointments')\n                      }\n                    </p>\n                    {user?.role === 'dentist' && (\n                      <Link to=\"/appointments/create\">\n                        <Button \n                          variant=\"outline\" \n                          size=\"sm\" \n                          className=\"mt-4 border-blue-200 text-blue-600 hover:bg-blue-50\"\n                        >\n                          <Plus className=\"w-4 h-4 mr-2\" />\n                          Schedule Appointment\n                        </Button>\n                      </Link>\n                    )}\n                  </div>\n                )}\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ClinicDashboard;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dashboard\\Dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dashboard\\PatientDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2565,2568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2565,2568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3283,3286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3283,3286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3588,3591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3588,3591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3949,3952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3949,3952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4172,4175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4172,4175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { Card, Button, Badge } from '../../components/ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { appointmentService } from '../../services/appointmentService';\nimport { patientService } from '../../services/patientService';\n\n// Patient Dashboard Interfaces\ninterface PatientDashboardStats {\n  upcomingAppointments: number;\n  recentVisits: number;\n  pendingBills: number;\n  totalTreatments: number;\n}\n\ninterface UpcomingAppointment {\n  _id: string;\n  date: string;\n  timeSlot: string;\n  serviceType: string;\n  dentistId?: {\n    firstName: string;\n    lastName: string;\n    specialization?: string;\n  };\n  clinicId?: {\n    name: string;\n  };\n  status: string;\n}\n\ninterface RecentActivity {\n  id: string;\n  type: 'appointment' | 'treatment' | 'billing' | 'prescription';\n  title: string;\n  description: string;\n  date: string;\n  status?: string;\n}\n\nconst PatientDashboard: React.FC = () => {\n  const { t, i18n } = useTranslation();\n  const { user } = useAuth();\n  const [isLoading, setIsLoading] = useState(true);\n  const [dashboardStats, setDashboardStats] = useState<PatientDashboardStats>({\n    upcomingAppointments: 0,\n    recentVisits: 0,\n    pendingBills: 0,\n    totalTreatments: 0\n  });\n  const [upcomingAppointments, setUpcomingAppointments] = useState<UpcomingAppointment[]>([]);\n  const [recentActivities, setRecentActivities] = useState<RecentActivity[]>([]);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchPatientDashboardData = useCallback(async () => {\n    if (!user?.id) return;\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Get patient record linked to user\n      let patientId = null;\n      try {\n        const patientsResponse = await patientService.getPatientsByUserId(user.id, { page: 1, limit: 1 });\n        if (patientsResponse.data && patientsResponse.data.length > 0) {\n          patientId = patientsResponse.data[0].id;\n          // Patient profile data stored in patientId for other uses\n        }\n      } catch (_patientError) {\n        console.warn('No patient record found for user');\n      }\n\n      if (patientId) {\n        // Fetch upcoming appointments\n        try {\n          const appointmentsResponse = await appointmentService.getAppointments({\n            patientId,\n            limit: 5,\n            sort: 'date',\n            order: 'asc'\n          });\n\n          const responseData = appointmentsResponse as any;\n          let appointments = [];\n\n          // Handle different response structures\n          if (responseData?.success && responseData.data) {\n            if (Array.isArray(responseData.data.data)) {\n              appointments = responseData.data.data;\n            } else if (Array.isArray(responseData.data.appointments)) {\n              appointments = responseData.data.appointments;\n            } else if (Array.isArray(responseData.data)) {\n              appointments = responseData.data;\n            }\n          }\n\n          // Filter for upcoming appointments (today or future)\n          const today = new Date();\n          today.setHours(0, 0, 0, 0);\n\n          const upcoming = appointments.filter((apt: any) => {\n            const aptDate = new Date(apt.date);\n            return aptDate >= today && ['scheduled', 'confirmed'].includes(apt.status);\n          }).slice(0, 3);\n\n          setUpcomingAppointments(upcoming);\n\n          // Calculate stats\n          const recentVisits = appointments.filter((apt: any) =>\n            apt.status === 'completed' &&\n            new Date(apt.date) >= new Date(Date.now() - 30 * 24 * 60 * 60 * 1000) // Last 30 days\n          ).length;\n\n          setDashboardStats(prev => ({\n            ...prev,\n            upcomingAppointments: upcoming.length,\n            recentVisits,\n            totalTreatments: appointments.filter((apt: any) => apt.status === 'completed').length\n          }));\n\n          // Create recent activities from appointments\n          const activities: RecentActivity[] = appointments\n            .slice(0, 5)\n            .map((apt: any) => ({\n              id: apt._id || apt.id,\n              type: 'appointment' as const,\n              title: `${t('patientDashboard.appointment')} - ${apt.serviceType}`,\n              description: apt.status === 'completed'\n                ? t('patientDashboard.completedAppointment', { service: apt.serviceType })\n                : t('patientDashboard.scheduledAppointment', { service: apt.serviceType }),\n              date: apt.date,\n              status: apt.status\n            }));\n\n          setRecentActivities(activities);\n\n        } catch (appointmentError) {\n          console.warn('Error fetching appointments:', appointmentError);\n        }\n\n        // Fetch billing information\n        try {\n          // This would require a patient billing endpoint\n          // For now, set placeholder\n          setDashboardStats(prev => ({ ...prev, pendingBills: 0 }));\n        } catch (billingError) {\n          console.warn('Error fetching billing info:', billingError);\n        }\n      }\n\n    } catch (err) {\n      console.error('Error fetching patient dashboard data:', err);\n      setError(t('patientDashboard.errorLoading') || 'Failed to load dashboard data');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user?.id, t]);\n\n  useEffect(() => {\n    fetchPatientDashboardData();\n  }, [fetchPatientDashboardData]);\n\n  const formatDate = useCallback((dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString(i18n.language, {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  }, [i18n.language]);\n\n  const formatTime = useCallback((timeString: string) => {\n    const [hours, minutes] = timeString.split(':');\n    const hour = parseInt(hours, 10);\n    const ampm = hour >= 12 ? (t('common.time.pm') || 'PM') : (t('common.time.am') || 'AM');\n    const hour12 = hour % 12 || 12;\n    return `${hour12}:${minutes} ${ampm}`;\n  }, [t]);\n\n  const getStatusBadge = useCallback((status: string) => {\n    const statusConfig = {\n      'scheduled': { variant: 'primary' as const, label: t('appointments.scheduled') },\n      'confirmed': { variant: 'success' as const, label: t('appointments.confirmed') },\n      'completed': { variant: 'success' as const, label: t('appointments.completed') },\n      'cancelled': { variant: 'gray' as const, label: t('appointments.cancelled') },\n    };\n\n    const config = statusConfig[status as keyof typeof statusConfig] ||\n      { variant: 'gray' as const, label: status };\n\n    return (\n      <Badge variant={config.variant} size=\"sm\">\n        {config.label}\n      </Badge>\n    );\n  }, [t]);\n\n  const getActivityIcon = (type: string) => {\n    switch (type) {\n      case 'appointment':\n        return (\n          <div className=\"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center\">\n            <svg className=\"w-5 h-5 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n        );\n      case 'treatment':\n        return (\n          <div className=\"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center\">\n            <svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </div>\n        );\n      case 'billing':\n        return (\n          <div className=\"w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center\">\n            <svg className=\"w-5 h-5 text-yellow-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path d=\"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z\" />\n            </svg>\n          </div>\n        );\n      default:\n        return (\n          <div className=\"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center\">\n            <svg className=\"w-5 h-5 text-gray-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n        );\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50\">\n        <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\n          {/* Loading Skeleton */}\n          <div className=\"animate-pulse space-y-4 sm:space-y-6\">\n            <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4\">\n              <div className=\"space-y-2\">\n                <div className=\"h-6 sm:h-8 bg-gray-300 rounded w-48 sm:w-64\"></div>\n                <div className=\"h-3 sm:h-4 bg-gray-300 rounded w-32 sm:w-48\"></div>\n              </div>\n              <div className=\"h-10 bg-gray-300 rounded w-full sm:w-40\"></div>\n            </div>\n\n            <div className=\"grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n              {[...Array(4)].map((_, i) => (\n                <div key={i} className=\"bg-white rounded-lg shadow-lg p-4 sm:p-6\">\n                  <div className=\"h-5 sm:h-6 bg-gray-300 rounded w-20 sm:w-24 mb-2\"></div>\n                  <div className=\"h-6 sm:h-8 bg-gray-300 rounded w-12 sm:w-16\"></div>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"grid gap-4 sm:gap-6 lg:gap-8 grid-cols-1 lg:grid-cols-2\">\n              <div className=\"bg-white rounded-lg shadow-lg p-4 sm:p-6\">\n                <div className=\"h-5 sm:h-6 bg-gray-300 rounded w-36 sm:w-48 mb-4\"></div>\n                <div className=\"space-y-3\">\n                  {[...Array(3)].map((_, i) => (\n                    <div key={i} className=\"flex space-x-3\">\n                      <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-gray-300 rounded-lg flex-shrink-0\"></div>\n                      <div className=\"flex-1 space-y-2 min-w-0\">\n                        <div className=\"h-4 bg-gray-300 rounded w-3/4\"></div>\n                        <div className=\"h-3 bg-gray-300 rounded w-1/2\"></div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"bg-white rounded-lg shadow-lg p-4 sm:p-6\">\n                <div className=\"h-5 sm:h-6 bg-gray-300 rounded w-24 sm:w-32 mb-4\"></div>\n                <div className=\"space-y-3\">\n                  {[...Array(4)].map((_, i) => (\n                    <div key={i} className=\"flex space-x-3\">\n                      <div className=\"w-8 h-8 sm:w-10 sm:h-10 bg-gray-300 rounded-full flex-shrink-0\"></div>\n                      <div className=\"flex-1 space-y-2 min-w-0\">\n                        <div className=\"h-4 bg-gray-300 rounded w-3/4\"></div>\n                        <div className=\"h-3 bg-gray-300 rounded w-1/2\"></div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50\">\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\n        {/* Header */}\n        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 sm:mb-8 gap-4\">\n          <div className=\"flex-1 min-w-0\">\n            <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-1 sm:mb-2 truncate\">\n              {t('patientDashboard.welcome', { name: user?.firstName || 'Patient' })}\n            </h1>\n            <p className=\"text-gray-600 text-sm sm:text-base lg:text-lg\">\n              {t('patientDashboard.subtitle')}\n            </p>\n          </div>\n\n          <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto\">\n            <Link to=\"/appointments/create\" className=\"w-full sm:w-auto\">\n              <Button\n                variant=\"primary\"\n                className=\"w-full sm:w-auto bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 min-h-[44px]\"\n                size=\"lg\"\n              >\n                <svg className=\"-ml-1 mr-2 h-5 w-5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                </svg>\n                <span className=\"font-semibold\">{t('patientDashboard.bookAppointment')}</span>\n              </Button>\n            </Link>\n\n            <Link to=\"/appointments\" className=\"w-full sm:w-auto\">\n              <Button\n                variant=\"outline\"\n                className=\"w-full sm:w-auto border-2 border-indigo-300 text-indigo-700 hover:bg-indigo-50 shadow-md transition-all duration-200 min-h-[44px]\"\n                size=\"lg\"\n              >\n                <svg className=\"-ml-1 mr-2 h-5 w-5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-8 4h8a2 2 0 012 2v8a2 2 0 01-2 2H6a2 2 0 01-2-2v-8a2 2 0 012-2z\" />\n                </svg>\n                <span className=\"truncate\">{t('patientDashboard.viewAppointments')}</span>\n              </Button>\n            </Link>\n          </div>\n        </div>\n\n        {error && (\n          <div className=\"mb-6 p-4 bg-red-50 border-l-4 border-red-400 text-red-700\">\n            <div className=\"flex\">\n              <div className=\"flex-shrink-0\">\n                <svg className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm\">{error}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Stats Cards */}\n        <div className=\"grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 mb-6 sm:mb-8\">\n          <Card className=\"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg hover:shadow-xl transition-shadow duration-200 border-0\">\n            <div className=\"p-4 sm:p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center\">\n                    <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                </div>\n                <div className=\"ml-3 sm:ml-4 min-w-0 flex-1\">\n                  <p className=\"text-xs sm:text-sm font-medium text-blue-100 truncate\">{t('patientDashboard.upcomingAppointments')}</p>\n                  <p className=\"text-xl sm:text-2xl font-bold\">{dashboardStats.upcomingAppointments}</p>\n                </div>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg hover:shadow-xl transition-shadow duration-200 border-0\">\n            <div className=\"p-4 sm:p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center\">\n                    <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                  </div>\n                </div>\n                <div className=\"ml-3 sm:ml-4 min-w-0 flex-1\">\n                  <p className=\"text-xs sm:text-sm font-medium text-green-100 truncate\">{t('patientDashboard.recentVisits')}</p>\n                  <p className=\"text-xl sm:text-2xl font-bold\">{dashboardStats.recentVisits}</p>\n                </div>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg hover:shadow-xl transition-shadow duration-200 border-0\">\n            <div className=\"p-4 sm:p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center\">\n                    <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path d=\"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z\" />\n                    </svg>\n                  </div>\n                </div>\n                <div className=\"ml-3 sm:ml-4 min-w-0 flex-1\">\n                  <p className=\"text-xs sm:text-sm font-medium text-purple-100 truncate\">{t('patientDashboard.pendingBills')}</p>\n                  <p className=\"text-xl sm:text-2xl font-bold\">{dashboardStats.pendingBills}</p>\n                </div>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white shadow-lg hover:shadow-xl transition-shadow duration-200 border-0\">\n            <div className=\"p-4 sm:p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center\">\n                    <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                </div>\n                <div className=\"ml-3 sm:ml-4 min-w-0 flex-1\">\n                  <p className=\"text-xs sm:text-sm font-medium text-indigo-100 truncate\">{t('patientDashboard.totalTreatments')}</p>\n                  <p className=\"text-xl sm:text-2xl font-bold\">{dashboardStats.totalTreatments}</p>\n                </div>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Main Content Grid */}\n        <div className=\"grid gap-4 sm:gap-6 lg:gap-8 grid-cols-1 lg:grid-cols-2\">\n          {/* Upcoming Appointments */}\n          <Card className=\"shadow-lg hover:shadow-xl transition-shadow duration-200 border-0 bg-white/80 backdrop-blur-sm\">\n            <div className=\"p-4 sm:p-6\">\n              <div className=\"flex items-center justify-between mb-4 sm:mb-6 gap-2\">\n                <h2 className=\"text-lg sm:text-xl font-semibold text-gray-900 flex items-center min-w-0\">\n                  <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600 mr-2 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                  </svg>\n                  <span className=\"truncate\">{t('patientDashboard.upcomingAppointments')}</span>\n                </h2>\n                <Link\n                  to=\"/appointments\"\n                  className=\"text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap flex-shrink-0\"\n                >\n                  {t('patientDashboard.viewAll')} \n                </Link>\n              </div>\n\n              {upcomingAppointments.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                    <svg className=\"w-8 h-8 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                  <p className=\"text-gray-500 text-lg\">{t('patientDashboard.noUpcomingAppointments')}</p>\n                  <Link to=\"/appointments/create\">\n                    <Button variant=\"primary\" className=\"mt-4\" size=\"sm\">\n                      {t('patientDashboard.bookAppointment')}\n                    </Button>\n                  </Link>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {upcomingAppointments.map((appointment) => (\n                    <div key={appointment._id} className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-3 sm:p-4 border border-blue-100 hover:shadow-md transition-all duration-200\">\n                      <div className=\"flex flex-col sm:flex-row sm:items-start gap-2\">\n                        <div className=\"flex-1 min-w-0\">\n                          <h3 className=\"font-semibold text-gray-900 mb-1 text-sm sm:text-base\">{appointment.serviceType}</h3>\n                          <p className=\"text-xs sm:text-sm text-gray-600 mb-2\">{formatDate(appointment.date)} at {formatTime(appointment.timeSlot)}</p>\n                          {appointment.dentistId && (\n                            <p className=\"text-xs sm:text-sm text-blue-700 font-medium\">\n                              Dr. {appointment.dentistId.firstName} {appointment.dentistId.lastName}\n                              {appointment.dentistId.specialization && (\n                                <span className=\"text-gray-500 font-normal\"> - {appointment.dentistId.specialization}</span>\n                              )}\n                            </p>\n                          )}\n                          {appointment.clinicId && (\n                            <p className=\"text-xs sm:text-sm text-gray-600 mt-1\"> {appointment.clinicId.name}</p>\n                          )}\n                        </div>\n                        <div className=\"flex sm:flex-col items-center sm:items-end gap-2\">\n                          {getStatusBadge(appointment.status)}\n                          <Link to={`/appointments/${appointment._id}`}>\n                            <Button variant=\"outline\" size=\"sm\" className=\"text-xs whitespace-nowrap\">\n                              {t('patientDashboard.viewDetails')}\n                            </Button>\n                          </Link>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </Card>\n\n          {/* Recent Activities */}\n          <Card className=\"shadow-lg hover:shadow-xl transition-shadow duration-200 border-0 bg-white/80 backdrop-blur-sm\">\n            <div className=\"p-4 sm:p-6\">\n              <div className=\"flex items-center justify-between mb-4 sm:mb-6\">\n                <h2 className=\"text-xl font-semibold text-gray-900 flex items-center\">\n                  <svg className=\"w-6 h-6 text-green-600 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\" />\n                  </svg>\n                  {t('patientDashboard.recentActivity')}\n                </h2>\n              </div>\n\n              {recentActivities.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                    <svg className=\"w-8 h-8 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                  <p className=\"text-gray-500\">{t('patientDashboard.noRecentActivity')}</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {recentActivities.map((activity) => (\n                    <div key={activity.id} className=\"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200\">\n                      {getActivityIcon(activity.type)}\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium text-gray-900 truncate\">{activity.title}</p>\n                        <p className=\"text-sm text-gray-600 mt-1\">{activity.description}</p>\n                        <div className=\"flex items-center mt-2 space-x-2\">\n                          <p className=\"text-xs text-gray-500\">{formatDate(activity.date)}</p>\n                          {activity.status && getStatusBadge(activity.status)}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </Card>\n        </div>\n\n        {/* Quick Actions */}\n        <Card className=\"mt-6 sm:mt-8 shadow-lg border-0 bg-gradient-to-r from-gray-50 to-blue-50\">\n          <div className=\"p-4 sm:p-6\">\n            <h2 className=\"text-lg sm:text-xl font-semibold text-gray-900 mb-4 sm:mb-6 flex items-center\">\n              <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-purple-600 mr-2 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clipRule=\"evenodd\" />\n              </svg>\n              <span className=\"truncate\">{t('patientDashboard.quickActions')}</span>\n            </h2>\n\n            <div className=\"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n              <Link to=\"/appointments/create\" className=\"group block\">\n                <div className=\"bg-white p-3 sm:p-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 transform group-hover:scale-105 border-2 border-transparent group-hover:border-blue-200 min-h-[80px] sm:min-h-0\">\n                  <div className=\"flex items-center\">\n                    <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                      <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                      </svg>\n                    </div>\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"text-sm sm:text-base font-semibold text-gray-900 truncate\">{t('patientDashboard.bookAppointment')}</p>\n                      <p className=\"text-xs sm:text-sm text-gray-600 truncate\">{t('patientDashboard.scheduleVisit')}</p>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n\n              <Link to=\"/appointments\" className=\"group block\">\n                <div className=\"bg-white p-3 sm:p-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 transform group-hover:scale-105 border-2 border-transparent group-hover:border-green-200 min-h-[80px] sm:min-h-0\">\n                  <div className=\"flex items-center\">\n                    <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                      <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z\" clipRule=\"evenodd\" />\n                      </svg>\n                    </div>\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"text-sm sm:text-base font-semibold text-gray-900 truncate\">{t('patientDashboard.myAppointments')}</p>\n                      <p className=\"text-xs sm:text-sm text-gray-600 truncate\">{t('patientDashboard.viewHistory')}</p>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n\n              <Link to=\"/profile\" className=\"group block\">\n                <div className=\"bg-white p-3 sm:p-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 transform group-hover:scale-105 border-2 border-transparent group-hover:border-purple-200 min-h-[80px] sm:min-h-0\">\n                  <div className=\"flex items-center\">\n                    <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                      <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-purple-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                      </svg>\n                    </div>\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"text-sm sm:text-base font-semibold text-gray-900 truncate\">{t('patientDashboard.myProfile')}</p>\n                      <p className=\"text-xs sm:text-sm text-gray-600 truncate\">{t('patientDashboard.updateInfo')}</p>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n\n              <Link to=\"/billing\" className=\"group block\">\n                <div className=\"bg-white p-3 sm:p-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 transform group-hover:scale-105 border-2 border-transparent group-hover:border-yellow-200 min-h-[80px] sm:min-h-0\">\n                  <div className=\"flex items-center\">\n                    <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-yellow-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                      <svg className=\"w-5 h-5 sm:w-6 sm:h-6 text-yellow-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path d=\"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z\" />\n                      </svg>\n                    </div>\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"text-sm sm:text-base font-semibold text-gray-900 truncate\">{t('patientDashboard.billing')}</p>\n                      <p className=\"text-xs sm:text-sm text-gray-600 truncate\">{t('patientDashboard.viewBills')}</p>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n            </div>\n          </div>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default PatientDashboard;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dashboard\\UnifiedAppointmentDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2597,2600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2597,2600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4385,4388],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4385,4388],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAppointments'. Either include it or remove the dependency array.","line":139,"column":6,"nodeType":"ArrayExpression","endLine":139,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [pagination.page, filters, fetchAppointments]","fix":{"range":[4638,4664],"text":"[pagination.page, filters, fetchAppointments]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5116,5119],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5116,5119],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5916,5919],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5916,5919],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6701,6704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6701,6704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport { useAuth } from '../../hooks/useAuth';\nimport api from '../../services/api';\nimport { Calendar, List, Filter, Clock, MapPin, User, Phone, Mail, Edit2, Trash2, RotateCcw, AlertCircle, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { format, startOfWeek, endOfWeek, eachDayOfInterval, isSameDay, parseISO, addDays, subDays } from 'date-fns';\nimport { toast } from 'react-hot-toast';\nimport AppointmentFilterPanel from '../../components/appointment/AppointmentFilterPanel';\nimport QuickEditModal from '../../components/appointment/QuickEditModal';\nimport RescheduleModal from '../../components/appointment/RescheduleModal';\nimport CancelConfirmDialog from '../../components/appointment/CancelConfirmDialog';\n\ninterface Appointment {\n  _id: string;\n  patientId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone: string;\n    dateOfBirth: string;\n  };\n  dentistId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n  };\n  clinicId: {\n    _id: string;\n    name: string;\n    address: {\n      street: string;\n      city: string;\n      state: string;\n    };\n    phone: string;\n  };\n  date: string;\n  timeSlot: string;\n  duration: number;\n  serviceType: string;\n  status: 'scheduled' | 'confirmed' | 'in-progress' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  emergency?: boolean;\n  cancellationReason?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface AppointmentsByClinic {\n  [clinicName: string]: {\n    clinic: Appointment['clinicId'];\n    appointments: Appointment[];\n    count: number;\n  };\n}\n\ninterface Filters {\n  startDate: string;\n  endDate: string;\n  clinicId: string;\n  patientName: string;\n  status: string;\n  sortBy: 'date' | 'createdAt' | 'status';\n  sortOrder: 'asc' | 'desc';\n}\n\ntype ViewMode = 'calendar' | 'list' | 'grouped';\n\nconst UnifiedAppointmentDashboard: React.FC = () => {\n  const { user } = useAuth();\n  const isAdmin = user?.role === 'admin';\n\n  // State management\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [appointmentsByClinic, setAppointmentsByClinic] = useState<AppointmentsByClinic>({});\n  const [loading, setLoading] = useState(true);\n  const [viewMode, setViewMode] = useState<ViewMode>('list');\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [showFilters, setShowFilters] = useState(false);\n  const [pagination, setPagination] = useState({ page: 1, limit: 20, total: 0, totalPages: 0 });\n  const [stats, setStats] = useState<any>(null);\n\n  // Modal states\n  const [selectedAppointment, setSelectedAppointment] = useState<Appointment | null>(null);\n  const [showQuickEdit, setShowQuickEdit] = useState(false);\n  const [showReschedule, setShowReschedule] = useState(false);\n  const [showCancelConfirm, setShowCancelConfirm] = useState(false);\n\n  // Filters\n  const [filters, setFilters] = useState<Filters>({\n    startDate: format(startOfWeek(new Date()), 'yyyy-MM-dd'),\n    endDate: format(endOfWeek(new Date()), 'yyyy-MM-dd'),\n    clinicId: '',\n    patientName: '',\n    status: '',\n    sortBy: 'date',\n    sortOrder: 'asc'\n  });\n\n  // Fetch appointments\n  const fetchAppointments = async () => {\n    try {\n      setLoading(true);\n      const endpoint = isAdmin ? '/appointments/unified/admin' : '/appointments/unified/doctor';\n      \n      const params = new URLSearchParams({\n        page: pagination.page.toString(),\n        limit: pagination.limit.toString(),\n        ...(filters.startDate && { startDate: filters.startDate }),\n        ...(filters.endDate && { endDate: filters.endDate }),\n        ...(filters.clinicId && { clinicId: filters.clinicId }),\n        ...(filters.patientName && { patientName: filters.patientName }),\n        ...(filters.status && { status: filters.status }),\n        sortBy: filters.sortBy,\n        sortOrder: filters.sortOrder\n      });\n\n      const response = await api.get(`${endpoint}?${params}`);\n      \n      if (response.data.success) {\n        setAppointments(response.data.data.appointments);\n        if (!isAdmin && response.data.data.appointmentsByClinic) {\n          setAppointmentsByClinic(response.data.data.appointmentsByClinic);\n        }\n        setPagination(response.data.data.pagination);\n        setStats(response.data.data.stats);\n      }\n    } catch (error: any) {\n      console.error('Error fetching appointments:', error);\n      toast.error(error.response?.data?.message || 'Failed to load appointments');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchAppointments();\n  }, [pagination.page, filters]);\n\n  // Handle quick edit\n  const handleQuickEdit = async (appointmentId: string, updates: { timeSlot?: string; notes?: string; duration?: number }) => {\n    try {\n      const response = await api.patch(`/appointments/${appointmentId}/quick-update`, updates);\n      \n      if (response.data.success) {\n        toast.success('Appointment updated successfully');\n        fetchAppointments();\n        setShowQuickEdit(false);\n      }\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Failed to update appointment');\n    }\n  };\n\n  // Handle cancel with notification\n  const handleCancelAppointment = async (appointmentId: string, cancellationReason: string, notifyPatient: boolean) => {\n    try {\n      const response = await api.post(`/appointments/${appointmentId}/cancel-notify`, {\n        cancellationReason,\n        notifyPatient\n      });\n      \n      if (response.data.success) {\n        const notifications = response.data.data.notificationsSent;\n        toast.success(\n          `Appointment cancelled${notifyPatient ? ` (Email: ${notifications.email ? '' : ''}, SMS: ${notifications.sms ? '' : ''})` : ''}`\n        );\n        fetchAppointments();\n        setShowCancelConfirm(false);\n      }\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Failed to cancel appointment');\n    }\n  };\n\n  // Handle reschedule\n  const handleReschedule = async (appointmentId: string, newDate: string, newTimeSlot: string, newDuration: number, reason: string) => {\n    try {\n      const response = await api.post(`/appointments/${appointmentId}/reschedule-enhanced`, {\n        newDate,\n        newTimeSlot,\n        newDuration,\n        reason\n      });\n      \n      if (response.data.success) {\n        const notifications = response.data.data.notificationsSent;\n        toast.success(`Appointment rescheduled (Email: ${notifications.email ? '' : ''}, SMS: ${notifications.sms ? '' : ''})`);\n        fetchAppointments();\n        setShowReschedule(false);\n      }\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Failed to reschedule appointment');\n    }\n  };\n\n  // Filter appointments by selected date for calendar view\n  const appointmentsForSelectedDate = useMemo(() => {\n    return appointments.filter(apt => \n      isSameDay(parseISO(apt.date), selectedDate)\n    );\n  }, [appointments, selectedDate]);\n\n  // Get week days for calendar view\n  const weekDays = useMemo(() => {\n    const start = startOfWeek(selectedDate);\n    const end = endOfWeek(selectedDate);\n    return eachDayOfInterval({ start, end });\n  }, [selectedDate]);\n\n  // Status badge colors\n  const getStatusColor = (status: string) => {\n    const colors = {\n      scheduled: 'bg-blue-100 text-blue-800',\n      confirmed: 'bg-green-100 text-green-800',\n      'in-progress': 'bg-yellow-100 text-yellow-800',\n      completed: 'bg-gray-100 text-gray-800',\n      cancelled: 'bg-red-100 text-red-800',\n      'no-show': 'bg-orange-100 text-orange-800'\n    };\n    return colors[status as keyof typeof colors] || 'bg-gray-100 text-gray-800';\n  };\n\n  // Render appointment card\n  const renderAppointmentCard = (appointment: Appointment) => (\n    <div\n      key={appointment._id}\n      className={`bg-white rounded-lg shadow-sm border-l-4 p-3 sm:p-4 mb-3 hover:shadow-md transition-shadow ${\n        appointment.emergency ? 'border-red-500' : 'border-blue-500'\n      }`}\n    >\n      <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-3\">\n        <div className=\"flex-1 min-w-0\">\n          {/* Patient Info */}\n          <div className=\"flex flex-wrap items-center gap-2 mb-2\">\n            <User className=\"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0\" />\n            <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 truncate\">\n              {appointment.patientId.firstName} {appointment.patientId.lastName}\n            </h3>\n            {appointment.emergency && (\n              <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 whitespace-nowrap\">\n                EMERGENCY\n              </span>\n            )}\n          </div>\n\n          {/* Appointment Details */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-3\">\n            <div className=\"flex items-center text-xs sm:text-sm text-gray-600\">\n              <Clock className=\"w-4 h-4 mr-2 flex-shrink-0\" />\n              <span className=\"truncate\">{format(parseISO(appointment.date), 'MMM dd, yyyy')} at {appointment.timeSlot} ({appointment.duration} min)</span>\n            </div>\n            <div className=\"flex items-center text-xs sm:text-sm text-gray-600\">\n              <MapPin className=\"w-4 h-4 mr-2 flex-shrink-0\" />\n              <span className=\"truncate\">{appointment.clinicId.name}</span>\n            </div>\n            <div className=\"flex items-center text-xs sm:text-sm text-gray-600\">\n              <Phone className=\"w-4 h-4 mr-2 flex-shrink-0\" />\n              <span className=\"truncate\">{appointment.patientId.phone}</span>\n            </div>\n            <div className=\"flex items-center text-xs sm:text-sm text-gray-600\">\n              <Mail className=\"w-4 h-4 mr-2 flex-shrink-0\" />\n              <span className=\"truncate\">{appointment.patientId.email}</span>\n            </div>\n          </div>\n\n          {/* Service Type & Status */}\n          <div className=\"flex items-center gap-2 mb-2\">\n            <span className=\"px-3 py-1 text-sm font-medium rounded-full bg-blue-50 text-blue-700\">\n              {appointment.serviceType}\n            </span>\n            <span className={`px-3 py-1 text-sm font-medium rounded-full ${getStatusColor(appointment.status)}`}>\n              {appointment.status.replace('-', ' ').toUpperCase()}\n            </span>\n          </div>\n\n          {/* Notes */}\n          {appointment.notes && (\n            <p className=\"text-sm text-gray-600 mt-2\">\n              <span className=\"font-medium\">Notes:</span> {appointment.notes}\n            </p>\n          )}\n\n          {/* Cancellation Reason */}\n          {appointment.cancellationReason && (\n            <div className=\"mt-2 p-2 bg-red-50 rounded-md\">\n              <p className=\"text-sm text-red-700\">\n                <AlertCircle className=\"w-4 h-4 inline mr-1\" />\n                <span className=\"font-medium\">Cancelled:</span> {appointment.cancellationReason}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Action Buttons */}\n        {appointment.status !== 'completed' && appointment.status !== 'cancelled' && (\n          <div className=\"flex sm:flex-col gap-2 sm:ml-4 w-full sm:w-auto\">\n            <button\n              onClick={() => {\n                setSelectedAppointment(appointment);\n                setShowQuickEdit(true);\n              }}\n              className=\"flex-1 sm:flex-none p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors min-h-[44px] sm:min-h-0\"\n              title=\"Quick Edit\"\n            >\n              <Edit2 className=\"w-5 h-5 mx-auto\" />\n            </button>\n            <button\n              onClick={() => {\n                setSelectedAppointment(appointment);\n                setShowReschedule(true);\n              }}\n              className=\"flex-1 sm:flex-none p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors min-h-[44px] sm:min-h-0\"\n              title=\"Reschedule\"\n            >\n              <RotateCcw className=\"w-5 h-5 mx-auto\" />\n            </button>\n            <button\n              onClick={() => {\n                setSelectedAppointment(appointment);\n                setShowCancelConfirm(true);\n              }}\n              className=\"flex-1 sm:flex-none p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors min-h-[44px] sm:min-h-0\"\n              title=\"Cancel\"\n            >\n              <Trash2 className=\"w-5 h-5 mx-auto\" />\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n\n  if (loading && appointments.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4 sm:p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-4 sm:mb-6\">\n          <h1 className=\"text-2xl sm:text-3xl font-bold text-gray-900 mb-2\">\n            {isAdmin ? 'All Appointments' : 'My Appointments'}\n          </h1>\n          <p className=\"text-sm sm:text-base text-gray-600\">\n            {isAdmin ? 'Manage all appointments across all clinics' : 'View and manage your appointments across all assigned clinics'}\n          </p>\n        </div>\n\n        {/* Stats Cards */}\n        {stats && (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6\">\n            <div className=\"bg-white rounded-lg shadow-sm p-3 sm:p-4\">\n              <p className=\"text-xs sm:text-sm text-gray-600 mb-1 truncate\">Total Appointments</p>\n              <p className=\"text-xl sm:text-2xl font-bold text-gray-900\">{stats.totalAppointments || 0}</p>\n            </div>\n            {!isAdmin && (\n              <div className=\"bg-white rounded-lg shadow-sm p-3 sm:p-4\">\n                <p className=\"text-xs sm:text-sm text-gray-600 mb-1 truncate\">Clinics</p>\n                <p className=\"text-xl sm:text-2xl font-bold text-blue-600\">{stats.clinicsCount || 0}</p>\n              </div>\n            )}\n            <div className=\"bg-white rounded-lg shadow-sm p-3 sm:p-4\">\n              <p className=\"text-xs sm:text-sm text-gray-600 mb-1 truncate\">Today</p>\n              <p className=\"text-xl sm:text-2xl font-bold text-green-600\">{stats.todayCount || stats.todayAppointments || 0}</p>\n            </div>\n            {isAdmin && stats.byStatus && (\n              <div className=\"bg-white rounded-lg shadow-sm p-3 sm:p-4\">\n                <p className=\"text-xs sm:text-sm text-gray-600 mb-1 truncate\">Confirmed</p>\n                <p className=\"text-xl sm:text-2xl font-bold text-green-600\">{stats.byStatus.confirmed || 0}</p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Toolbar */}\n        <div className=\"bg-white rounded-lg shadow-sm p-3 sm:p-4 mb-4 sm:mb-6\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4\">\n            {/* View Mode Toggles */}\n            <div className=\"flex gap-2 overflow-x-auto pb-2 sm:pb-0\">\n              <button\n                onClick={() => setViewMode('list')}\n                className={`px-3 sm:px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap min-h-[44px] sm:min-h-0 ${\n                  viewMode === 'list'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                <List className=\"w-4 h-4 sm:w-5 sm:h-5 inline mr-1 sm:mr-2\" />\n                <span className=\"text-sm sm:text-base\">List</span>\n              </button>\n              <button\n                onClick={() => setViewMode('calendar')}\n                className={`px-3 sm:px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap min-h-[44px] sm:min-h-0 ${\n                  viewMode === 'calendar'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                <Calendar className=\"w-4 h-4 sm:w-5 sm:h-5 inline mr-1 sm:mr-2\" />\n                <span className=\"text-sm sm:text-base\">Calendar</span>\n              </button>\n              {!isAdmin && (\n                <button\n                  onClick={() => setViewMode('grouped')}\n                  className={`px-3 sm:px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap min-h-[44px] sm:min-h-0 ${\n                    viewMode === 'grouped'\n                      ? 'bg-blue-600 text-white'\n                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                  }`}\n                >\n                  <MapPin className=\"w-4 h-4 sm:w-5 sm:h-5 inline mr-1 sm:mr-2\" />\n                  <span className=\"text-sm sm:text-base\">By Clinic</span>\n                </button>\n              )}\n            </div>\n\n            {/* Filter Toggle */}\n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              className=\"px-3 sm:px-4 py-2 rounded-lg font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors whitespace-nowrap min-h-[44px] sm:min-h-0 w-full sm:w-auto\"\n            >\n              <Filter className=\"w-4 h-4 sm:w-5 sm:h-5 inline mr-1 sm:mr-2\" />\n              <span className=\"text-sm sm:text-base\">Filters</span>\n              {(filters.clinicId || filters.patientName || filters.status) && (\n                <span className=\"ml-2 px-2 py-0.5 text-xs bg-blue-600 text-white rounded-full\">\n                  Active\n                </span>\n              )}\n            </button>\n          </div>\n\n          {/* Filter Panel */}\n          {showFilters && (\n            <AppointmentFilterPanel\n              filters={filters}\n              onFiltersChange={setFilters}\n              isAdmin={isAdmin}\n            />\n          )}\n        </div>\n\n        {/* Content */}\n        {viewMode === 'list' && (\n          <div>\n            {appointments.length === 0 ? (\n              <div className=\"bg-white rounded-lg shadow-sm p-12 text-center\">\n                <Calendar className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No appointments found</h3>\n                <p className=\"text-gray-600\">Try adjusting your filters or date range</p>\n              </div>\n            ) : (\n              <>\n                {appointments.map(renderAppointmentCard)}\n                \n                {/* Pagination */}\n                {pagination.totalPages > 1 && (\n                  <div className=\"flex items-center justify-between mt-6\">\n                    <button\n                      onClick={() => setPagination(prev => ({ ...prev, page: prev.page - 1 }))}\n                      disabled={pagination.page === 1}\n                      className=\"px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50\"\n                    >\n                      <ChevronLeft className=\"w-5 h-5 inline mr-1\" />\n                      Previous\n                    </button>\n                    <span className=\"text-gray-600\">\n                      Page {pagination.page} of {pagination.totalPages}\n                    </span>\n                    <button\n                      onClick={() => setPagination(prev => ({ ...prev, page: prev.page + 1 }))}\n                      disabled={pagination.page === pagination.totalPages}\n                      className=\"px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50\"\n                    >\n                      Next\n                      <ChevronRight className=\"w-5 h-5 inline ml-1\" />\n                    </button>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n        )}\n\n        {viewMode === 'calendar' && (\n          <div className=\"bg-white rounded-lg shadow-sm p-6\">\n            {/* Calendar Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <h2 className=\"text-xl font-semibold text-gray-900\">\n                {format(selectedDate, 'MMMM yyyy')}\n              </h2>\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={() => setSelectedDate(subDays(selectedDate, 7))}\n                  className=\"p-2 hover:bg-gray-100 rounded-lg\"\n                >\n                  <ChevronLeft className=\"w-5 h-5\" />\n                </button>\n                <button\n                  onClick={() => setSelectedDate(new Date())}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n                >\n                  Today\n                </button>\n                <button\n                  onClick={() => setSelectedDate(addDays(selectedDate, 7))}\n                  className=\"p-2 hover:bg-gray-100 rounded-lg\"\n                >\n                  <ChevronRight className=\"w-5 h-5\" />\n                </button>\n              </div>\n            </div>\n\n            {/* Week Days */}\n            <div className=\"grid grid-cols-7 gap-4 mb-4\">\n              {weekDays.map(day => (\n                <div\n                  key={day.toString()}\n                  onClick={() => setSelectedDate(day)}\n                  className={`p-4 rounded-lg cursor-pointer transition-colors ${\n                    isSameDay(day, selectedDate)\n                      ? 'bg-blue-600 text-white'\n                      : 'bg-gray-50 hover:bg-gray-100'\n                  }`}\n                >\n                  <div className=\"text-center\">\n                    <p className=\"text-xs font-medium mb-1\">{format(day, 'EEE')}</p>\n                    <p className=\"text-2xl font-bold\">{format(day, 'd')}</p>\n                    <p className=\"text-xs mt-1\">\n                      {appointments.filter(apt => isSameDay(parseISO(apt.date), day)).length} appts\n                    </p>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Selected Day Appointments */}\n            <div className=\"mt-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n                {format(selectedDate, 'EEEE, MMMM d, yyyy')}\n              </h3>\n              {appointmentsForSelectedDate.length === 0 ? (\n                <p className=\"text-gray-600 text-center py-8\">No appointments for this day</p>\n              ) : (\n                appointmentsForSelectedDate.map(renderAppointmentCard)\n              )}\n            </div>\n          </div>\n        )}\n\n        {viewMode === 'grouped' && !isAdmin && (\n          <div>\n            {Object.entries(appointmentsByClinic).map(([clinicName, data]) => (\n              <div key={clinicName} className=\"mb-8\">\n                <div className=\"bg-white rounded-lg shadow-sm p-4 mb-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <h2 className=\"text-xl font-semibold text-gray-900\">{clinicName}</h2>\n                      <p className=\"text-sm text-gray-600\">\n                        {data.clinic.address.city}, {data.clinic.address.state}  {data.clinic.phone}\n                      </p>\n                    </div>\n                    <span className=\"px-4 py-2 bg-blue-100 text-blue-800 rounded-full font-semibold\">\n                      {data.count} appointments\n                    </span>\n                  </div>\n                </div>\n                {data.appointments.map(renderAppointmentCard)}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Modals */}\n      {showQuickEdit && selectedAppointment && (\n        <QuickEditModal\n          appointment={selectedAppointment}\n          onClose={() => setShowQuickEdit(false)}\n          onSave={handleQuickEdit}\n        />\n      )}\n\n      {showReschedule && selectedAppointment && (\n        <RescheduleModal\n          appointment={selectedAppointment}\n          onClose={() => setShowReschedule(false)}\n          onReschedule={handleReschedule}\n        />\n      )}\n\n      {showCancelConfirm && selectedAppointment && (\n        <CancelConfirmDialog\n          appointment={selectedAppointment}\n          onClose={() => setShowCancelConfirm(false)}\n          onConfirm={handleCancelAppointment}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default UnifiedAppointmentDashboard;\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dentist\\DentistProfile.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3667,3670],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3667,3670],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":140,"column":6,"nodeType":"ArrayExpression","endLine":140,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, measureAsync, mark, user]","fix":{"range":[4669,4699],"text":"[user.id, measureAsync, mark, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Card, Button, Badge, Avatar, Alert } from '../../components/ui';\r\nimport { useAuth } from '../../hooks/useAuth';\r\nimport { usePerformance } from '../../hooks/usePerformance';\r\nimport { dentistService, type Dentist, type DentistClinic } from '../../services/dentistService';\r\nimport type { Appointment } from '../../types';\r\nimport {\r\n  User,\r\n  Calendar,\r\n  Briefcase,\r\n  Phone,\r\n  Mail,\r\n  MapPin,\r\n  Clock,\r\n\r\n  Edit3,\r\n  Settings,\r\n  Camera,\r\n  Award,\r\n  GraduationCap,\r\n  Building2,\r\n  Star,\r\n  CheckCircle,\r\n  XCircle,\r\n  AlertTriangle\r\n} from 'lucide-react';\r\n\r\nconst DentistProfile: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { measureAsync, mark } = usePerformance('DentistProfile');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [dentist, setDentist] = useState<Dentist | null>(null);\r\n  const [clinics, setClinics] = useState<DentistClinic[]>([]);\r\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [clinicsLoading, setClinicsLoading] = useState(false);\r\n  const [appointmentsLoading, setAppointmentsLoading] = useState(false);\r\n\r\n  // Navigation handlers\r\n  const handleEditProfile = () => {\r\n    navigate('/settings');\r\n  };\r\n\r\n  const handleManageSchedule = () => {\r\n    navigate('/schedule');\r\n  };\r\n\r\n  const handleViewAppointments = () => {\r\n    navigate('/appointments');\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchDentistData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        mark('fetchStart');\r\n\r\n        if (!user?.id) {\r\n          setError('User not found');\r\n          return;\r\n        }\r\n\r\n        // Fetch dentist profile data with performance monitoring (disable cache for debugging)\r\n        const dentistData = await measureAsync('fetchDentistProfile', () => {\r\n          const response = dentistService.getDentistById(user.id, false); // Disable cache\r\n          console.log('response', response);\r\n          return response;\r\n        }\r\n          \r\n        );\r\n        console.log('dentist', dentistData);\r\n        console.log('user.id', user.id);\r\n        console.log('user object:', user);\r\n        console.log('dentistData.result', dentistData.result);\r\n        setDentist(dentistData.result);\r\n        mark('profileLoaded');\r\n\r\n        // Fetch associated clinics\r\n        try {\r\n          setClinicsLoading(true);\r\n          const { result: clinicsData } = await measureAsync('fetchClinics', () =>\r\n            dentistService.getDentistClinics(user.id)\r\n          );\r\n          setClinics(Array.isArray(clinicsData) ? clinicsData : []);\r\n        } catch (clinicErr) {\r\n          console.warn('Failed to fetch clinics:', clinicErr);\r\n          setClinics([]);\r\n        } finally {\r\n          setClinicsLoading(false);\r\n        }\r\n\r\n        // Fetch appointments\r\n        try {\r\n          setAppointmentsLoading(true);\r\n          const { result: appointmentsData } = await measureAsync('fetchAppointments', () =>\r\n            dentistService.getDentistAppointments(user.id, { limit: 50 })\r\n          );\r\n          setAppointments(Array.isArray(appointmentsData?.data) ? appointmentsData.data : []);\r\n        } catch (appointmentErr) {\r\n          console.warn('Failed to fetch appointments:', appointmentErr);\r\n          setAppointments([]);\r\n        } finally {\r\n          setAppointmentsLoading(false);\r\n        }\r\n\r\n        mark('allDataLoaded');\r\n      } catch (err: any) {\r\n        console.error('Error fetching dentist data:', err);\r\n        console.error('Error details:', {\r\n          status: err.response?.status,\r\n          message: err.message,\r\n          response: err.response?.data\r\n        });\r\n\r\n        if (err.response?.status === 401) {\r\n          setError('Your session has expired. Please log in again.');\r\n          setTimeout(() => {\r\n            window.location.href = '/login';\r\n          }, 2000);\r\n        } else if (err.response?.status === 403) {\r\n          setError('You do not have permission to view this profile.');\r\n        } else if (err.response?.status === 404) {\r\n          setError('Dentist profile not found. The user may not exist in the database.');\r\n        } else {\r\n          setError(err.message || 'Failed to load dentist data. Please try again later.');\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n        mark('renderComplete');\r\n      }\r\n    };\r\n\r\n    if (user?.id) {\r\n      fetchDentistData();\r\n    }\r\n  }, [user?.id, measureAsync, mark]);\r\n\r\n  const getAppointmentStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'scheduled':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'confirmed':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'completed':\r\n        return 'bg-gray-100 text-gray-800';\r\n      case 'cancelled':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'no-show':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getAppointmentStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'scheduled':\r\n        return <Clock className=\"w-4 h-4\" />;\r\n      case 'confirmed':\r\n        return <CheckCircle className=\"w-4 h-4\" />;\r\n      case 'completed':\r\n        return <CheckCircle className=\"w-4 h-4\" />;\r\n      case 'cancelled':\r\n        return <XCircle className=\"w-4 h-4\" />;\r\n      case 'no-show':\r\n        return <AlertTriangle className=\"w-4 h-4\" />;\r\n      default:\r\n        return <Clock className=\"w-4 h-4\" />;\r\n    }\r\n  };\r\n\r\n  const upcomingAppointments = Array.isArray(appointments) && appointments.length > 0 ? appointments.filter(apt =>\r\n    apt?.date && new Date(apt.date) > new Date() && apt.status !== 'cancelled'\r\n  ).sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime()) : [];\r\n\r\n  const completedAppointments = Array.isArray(appointments) && appointments.length > 0 ? appointments.filter(apt =>\r\n    apt?.status === 'completed'\r\n  ).length : 0;\r\n\r\n  const tabs = [\r\n    { id: 'overview', label: 'Overview', icon: <User className=\"w-4 h-4\" /> },\r\n    { id: 'appointments', label: 'Appointments', icon: <Calendar className=\"w-4 h-4\" /> },\r\n    { id: 'clinics', label: 'Clinics', icon: <Building2 className=\"w-4 h-4\" /> },\r\n    { id: 'availability', label: 'Availability', icon: <Clock className=\"w-4 h-4\" /> },\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n        <div className=\"text-center\" role=\"status\" aria-live=\"polite\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\" aria-hidden=\"true\"></div>\r\n          <p className=\"text-gray-600\">Loading dentist profile...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !dentist) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n        <div role=\"alert\" className=\"max-w-md\">\r\n          <Alert variant=\"error\" className=\"w-full\">\r\n            {error || 'Dentist profile not found'}\r\n          </Alert>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50\">\r\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          {/* Header */}\r\n          <div className=\"mb-6 sm:mb-8\">\r\n            <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 sm:gap-6\">\r\n              <div>\r\n                <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-1 sm:mb-2\">Professional Profile</h1>\r\n                <p className=\"text-base sm:text-lg lg:text-xl text-gray-600\">\r\n                  Manage your professional information and appointments\r\n                </p>\r\n              </div>\r\n              <div className=\"flex gap-3\">\r\n                <Button\r\n                  size=\"sm\"\r\n                  onClick={handleEditProfile}\r\n                  className=\"min-h-[44px] min-w-[44px] sm:min-h-0 sm:min-w-0\"\r\n                >\r\n                  <Edit3 className=\"w-4 h-4 sm:mr-2\" />\r\n                  <span className=\"hidden sm:inline\">Edit Profile</span>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Profile Header Card */}\r\n          <Card className=\"p-4 sm:p-6 lg:p-8 mb-6 sm:mb-8 bg-gradient-to-r from-white to-blue-50 border-0 shadow-xl\">\r\n            <div className=\"flex flex-col lg:flex-row items-center lg:items-start gap-6 sm:gap-8\">\r\n              <div className=\"relative flex-shrink-0\">\r\n                <div className=\"relative\">\r\n                  <Avatar\r\n                    src={dentist?.profileImage}\r\n                    alt={`Dr. ${dentist?.firstName || ''} ${dentist?.lastName || ''}`}\r\n                    size=\"xl\"\r\n                    fallback={`${dentist?.firstName?.[0] || 'D'}${dentist?.lastName?.[0] || 'R'}`}\r\n                    className=\"ring-4 ring-white shadow-2xl w-24 h-24 sm:w-28 sm:h-28 lg:w-32 lg:h-32\"\r\n                    loading=\"eager\"\r\n                  />\r\n                  <button\r\n                    onClick={handleEditProfile}\r\n                    className=\"absolute bottom-1 right-1 sm:bottom-2 sm:right-2 bg-blue-600 text-white rounded-full p-2 sm:p-3 hover:bg-blue-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110 min-h-[44px] min-w-[44px]\"\r\n                    aria-label=\"Change profile picture\"\r\n                  >\r\n                    <Camera className=\"w-4 h-4\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex-1 text-center lg:text-left w-full\">\r\n                <div className=\"mb-4\">\r\n                  <h2 className=\"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-2\">\r\n                    Dr. {dentist?.firstName || 'Unknown'} {dentist?.lastName || 'Dentist'}\r\n                  </h2>\r\n                  <div className=\"flex flex-wrap items-center justify-center lg:justify-start gap-2 sm:gap-3 mb-3\">\r\n                    <Badge className=\"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium\">\r\n                      {dentist?.specialization || 'General Dentistry'}\r\n                    </Badge>\r\n                    <Badge className=\"bg-green-100 text-green-800 px-2 sm:px-3 py-1 text-xs sm:text-sm\">\r\n                      License: {dentist?.licenseNumber || 'N/A'}\r\n                    </Badge>\r\n                    {dentist?.rating && (\r\n                      <Badge className=\"bg-yellow-100 text-yellow-800 px-2 sm:px-3 py-1 text-xs sm:text-sm flex items-center gap-1\">\r\n                        <Star className=\"w-3 h-3 sm:w-4 sm:h-4 fill-current\" />\r\n                        {dentist.rating.toFixed(1)} ({dentist?.reviewCount || 0})\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6\">\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <Mail className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm truncate\">{dentist?.email || 'No email provided'}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <Phone className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm\">{dentist?.phone || 'No phone provided'}</span>\r\n                  </div>\r\n                  {dentist?.yearsOfExperience && (\r\n                    <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                      <Briefcase className=\"w-4 h-4 flex-shrink-0\" />\r\n                      <span className=\"text-xs sm:text-sm\">{dentist.yearsOfExperience} years experience</span>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <Building2 className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm\">{clinics?.length || 0} clinic{(clinics?.length || 0) !== 1 ? 's' : ''}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4 sm:gap-6\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-blue-600 mb-1\">{appointments?.length || 0}</div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">Total</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-green-600 mb-1\">{upcomingAppointments?.length || 0}</div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">Upcoming</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-purple-600 mb-1\">{completedAppointments || 0}</div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">Completed</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-orange-600 mb-1\">{clinics?.length || 0}</div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">Clinics</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n\r\n          {/* Tabs Navigation */}\r\n          <nav className=\"mb-6 sm:mb-8\" aria-label=\"Profile sections\">\r\n            <div className=\"border-b border-gray-200\">\r\n              <div className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto scrollbar-hide\" role=\"tablist\">\r\n                {tabs.map((tab) => (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() => setActiveTab(tab.id)}\r\n                    role=\"tab\"\r\n                    aria-selected={activeTab === tab.id}\r\n                    className={`flex items-center gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap min-h-[44px] ${\r\n                      activeTab === tab.id\r\n                        ? 'border-blue-500 text-blue-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    {tab.icon}\r\n                    <span className=\"hidden sm:inline\">{tab.label}</span>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </nav>\r\n\r\n          {/* Tab Content */}\r\n          <div className=\"space-y-6 sm:space-y-8\">\r\n            {activeTab === 'overview' && (\r\n              <div role=\"tabpanel\">\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8\">\r\n                  <div className=\"lg:col-span-2 space-y-4 sm:space-y-6\">\r\n                    {/* Professional Information */}\r\n                    <Card className=\"p-4 sm:p-6\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6 flex items-center gap-2\">\r\n                        <Briefcase className=\"w-4 h-4 sm:w-5 sm:h-5 text-blue-600\" />\r\n                        Professional Information\r\n                      </h3>\r\n\r\n                      {dentist?.bio && (\r\n                        <div className=\"mb-4 sm:mb-6\">\r\n                          <h4 className=\"text-xs sm:text-sm font-medium text-gray-700 mb-2\">Bio</h4>\r\n                          <p className=\"text-sm sm:text-base text-gray-600\">{dentist.bio}</p>\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6\">\r\n                        {dentist?.yearsOfExperience && (\r\n                          <div>\r\n                            <h4 className=\"text-xs sm:text-sm font-medium text-gray-700 mb-2\">Years of Experience</h4>\r\n                            <p className=\"text-sm sm:text-base text-gray-900 font-semibold\">{dentist.yearsOfExperience} years</p>\r\n                          </div>\r\n                        )}\r\n                        <div>\r\n                          <h4 className=\"text-xs sm:text-sm font-medium text-gray-700 mb-2\">Specialization</h4>\r\n                          <p className=\"text-sm sm:text-base text-gray-900 font-semibold\">{dentist?.specialization || 'General Dentistry'}</p>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {dentist?.education && Array.isArray(dentist.education) && dentist.education.length > 0 && (\r\n                        <div className=\"mt-4 sm:mt-6\">\r\n                          <h4 className=\"text-xs sm:text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\r\n                            <GraduationCap className=\"w-4 h-4\" />\r\n                            Education\r\n                          </h4>\r\n                          <ul className=\"space-y-2\">\r\n                            {dentist.education.map((edu, index) => (\r\n                              <li key={index} className=\"flex items-start gap-2 text-sm sm:text-base text-gray-600\">\r\n                                <span className=\"text-blue-600 mt-1\"></span>\r\n                                <span>{edu || 'N/A'}</span>\r\n                              </li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n                      )}\r\n\r\n                      {dentist?.certifications && Array.isArray(dentist.certifications) && dentist.certifications.length > 0 && (\r\n                        <div className=\"mt-4 sm:mt-6\">\r\n                          <h4 className=\"text-xs sm:text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\r\n                            <Award className=\"w-4 h-4\" />\r\n                            Certifications\r\n                          </h4>\r\n                          <ul className=\"space-y-2\">\r\n                            {dentist.certifications.map((cert, index) => (\r\n                              <li key={index} className=\"flex items-start gap-2 text-sm sm:text-base text-gray-600\">\r\n                                <span className=\"text-green-600 mt-1\"></span>\r\n                                <span>{cert || 'N/A'}</span>\r\n                              </li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n                      )}\r\n                    </Card>\r\n\r\n                    {/* Upcoming Appointments */}\r\n                    <Card className=\"p-4 sm:p-6\">\r\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-0 mb-4 sm:mb-6\">\r\n                        <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n                          <Calendar className=\"w-4 h-4 sm:w-5 sm:h-5 text-blue-600\" />\r\n                          Upcoming Appointments\r\n                        </h3>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          onClick={handleViewAppointments}\r\n                          className=\"min-h-[44px] w-full sm:w-auto\"\r\n                        >\r\n                          View All\r\n                        </Button>\r\n                      </div>\r\n\r\n                      {appointmentsLoading ? (\r\n                        <div className=\"text-center py-6 sm:py-8\">\r\n                          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-3\" aria-hidden=\"true\"></div>\r\n                          <p className=\"text-sm text-gray-600\">Loading appointments...</p>\r\n                        </div>\r\n                      ) : upcomingAppointments && upcomingAppointments.length > 0 ? (\r\n                        <div className=\"space-y-3 sm:space-y-4\">\r\n                          {upcomingAppointments.slice(0, 5).map((appointment) => (\r\n                            <div key={appointment?.id || Math.random()} className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 p-3 sm:p-4 bg-blue-50 rounded-lg\">\r\n                              <div className=\"flex items-start sm:items-center gap-3 sm:gap-4\">\r\n                                <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0\">\r\n                                  <Calendar className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600\" />\r\n                                </div>\r\n                                <div className=\"min-w-0 flex-1\">\r\n                                  <p className=\"font-medium text-sm sm:text-base text-gray-900 truncate\">\r\n                                    {appointment?.date ? new Date(appointment.date).toLocaleDateString('en-US', {\r\n                                      weekday: 'short',\r\n                                      month: 'short',\r\n                                      day: 'numeric'\r\n                                    }) : 'Date not available'}\r\n                                  </p>\r\n                                  <p className=\"text-xs sm:text-sm text-gray-600\">\r\n                                    {appointment?.timeSlot || 'Time not set'}  {appointment?.serviceType || 'Consultation'}\r\n                                  </p>\r\n                                  <p className=\"text-xs sm:text-sm text-gray-500 truncate\">\r\n                                    Patient: {appointment?.patientName || 'N/A'}\r\n                                  </p>\r\n                                </div>\r\n                              </div>\r\n                              <Badge className={`${getAppointmentStatusColor(appointment?.status || 'scheduled')} flex-shrink-0 self-start sm:self-center`}>\r\n                                {getAppointmentStatusIcon(appointment?.status || 'scheduled')}\r\n                                <span className=\"ml-1 capitalize text-xs\">{appointment?.status || 'scheduled'}</span>\r\n                              </Badge>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"text-center py-6 sm:py-8\">\r\n                          <Calendar className=\"w-10 h-10 sm:w-12 sm:h-12 text-gray-600 mx-auto mb-3 sm:mb-4\" />\r\n                          <p className=\"text-sm sm:text-base text-gray-600\">No upcoming appointments</p>\r\n                        </div>\r\n                      )}\r\n                    </Card>\r\n                  </div>\r\n\r\n                  {/* Sidebar */}\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    {/* Quick Actions */}\r\n                    <Card className=\"p-4 sm:p-6\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4\">Quick Actions</h3>\r\n                      <div className=\"space-y-2 sm:space-y-3\">\r\n                        <Button\r\n                          className=\"w-full justify-start min-h-[44px]\"\r\n                          variant=\"outline\"\r\n                          onClick={handleEditProfile}\r\n                        >\r\n                          <Edit3 className=\"w-4 h-4 mr-2\" />\r\n                          Edit Profile\r\n                        </Button>\r\n                        <Button\r\n                          className=\"w-full justify-start min-h-[44px]\"\r\n                          variant=\"outline\"\r\n                          onClick={handleManageSchedule}\r\n                        >\r\n                          <Clock className=\"w-4 h-4 mr-2\" />\r\n                          Manage Schedule\r\n                        </Button>\r\n                        <Button\r\n                          className=\"w-full justify-start min-h-[44px]\"\r\n                          variant=\"outline\"\r\n                          onClick={handleViewAppointments}\r\n                        >\r\n                          <Calendar className=\"w-4 h-4 mr-2\" />\r\n                          View Appointments\r\n                        </Button>\r\n                        <Button\r\n                          className=\"w-full justify-start min-h-[44px]\"\r\n                          variant=\"outline\"\r\n                          onClick={() => navigate('/settings')}\r\n                        >\r\n                          <Settings className=\"w-4 h-4 mr-2\" />\r\n                          Settings\r\n                        </Button>\r\n                      </div>\r\n                    </Card>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'appointments' && (\r\n              <div role=\"tabpanel\">\r\n                <Card className=\"p-4 sm:p-6\">\r\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6\">All Appointments</h3>\r\n                  <div className=\"text-center py-8 sm:py-12\">\r\n                    <Calendar className=\"w-16 h-16 text-gray-600 mx-auto mb-4\" />\r\n                    <p className=\"text-gray-600 mb-4\">Appointment management coming soon</p>\r\n                    <Button onClick={handleViewAppointments}>\r\n                      <Calendar className=\"w-4 h-4 mr-2\" />\r\n                      View Appointments\r\n                    </Button>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'clinics' && (\r\n              <div role=\"tabpanel\">\r\n                <Card className=\"p-4 sm:p-6\">\r\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6\">Clinic Affiliations</h3>\r\n                  {clinicsLoading ? (\r\n                    <div className=\"text-center py-8 sm:py-12\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-3\" aria-hidden=\"true\"></div>\r\n                      <p className=\"text-sm text-gray-600\">Loading clinic information...</p>\r\n                    </div>\r\n                  ) : clinics && clinics.length > 0 ? (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                      {clinics.map((clinic) => (\r\n                        <div key={clinic?.id || clinic?.clinicId || Math.random()} className=\"p-4 sm:p-6 border border-gray-200 rounded-lg hover:shadow-md transition-shadow\">\r\n                          <div className=\"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 mb-4\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                                <Building2 className=\"w-5 h-5 sm:w-6 sm:h-6 text-purple-600\" />\r\n                              </div>\r\n                              <div className=\"min-w-0 flex-1\">\r\n                                <h4 className=\"font-semibold text-sm sm:text-base text-gray-900 truncate\">{clinic?.name || clinic?.clinicName || 'Unnamed Clinic'}</h4>\r\n                                {clinic?.branchName && (\r\n                                  <p className=\"text-xs sm:text-sm text-gray-600 truncate\">{clinic.branchName}</p>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                            {clinic?.isPrimary && (\r\n                              <Badge className=\"bg-green-100 text-green-800 text-xs self-start\">Primary</Badge>\r\n                            )}\r\n                          </div>\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex items-start gap-2 text-xs sm:text-sm text-gray-600\">\r\n                              <MapPin className=\"w-3 h-3 sm:w-4 sm:h-4 mt-0.5 flex-shrink-0\" />\r\n                              <span className=\"break-words\">\r\n                                {clinic?.address?.street || 'N/A'}, {clinic?.address?.city || 'N/A'}, {clinic?.address?.state || 'N/A'} {clinic?.address?.zipCode || ''}\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-xs sm:text-sm text-gray-600\">\r\n                              <Phone className=\"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0\" />\r\n                              <span>{clinic?.phone || 'No phone provided'}</span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center py-8 sm:py-12\">\r\n                      <Building2 className=\"w-16 h-16 text-gray-600 mx-auto mb-4\" />\r\n                      <p className=\"text-gray-600 mb-4\">No clinic affiliations found</p>\r\n                      <Button onClick={() => navigate('/settings')}>\r\n                        <Building2 className=\"w-4 h-4 mr-2\" />\r\n                        Manage Clinics\r\n                      </Button>\r\n                    </div>\r\n                  )}\r\n                </Card>\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'availability' && (\r\n              <div role=\"tabpanel\">\r\n                <Card className=\"p-6\">\r\n                  <div className=\"flex items-center justify-between mb-6\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Availability Schedule</h3>\r\n                    <Button onClick={handleManageSchedule}>\r\n                      <Clock className=\"w-4 h-4 mr-2\" />\r\n                      Manage Schedule\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"text-center py-12\">\r\n                    <Clock className=\"w-16 h-16 text-gray-600 mx-auto mb-4\" />\r\n                    <p className=\"text-gray-600 mb-4\">Availability management coming soon</p>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      You'll be able to set your working hours and availability for each clinic here.\r\n                    </p>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DentistProfile;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dentist\\DentistSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6007,6010],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6007,6010],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":287,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":287,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8964,8967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8964,8967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":386,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":386,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12209,12212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12209,12212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":439,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":439,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14015,14018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14015,14018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport toast from 'react-hot-toast';\r\nimport { Card, Button, Input, Select, Alert, Avatar, Badge, Textarea } from '../../components/ui';\r\nimport { useAuth } from '../../hooks/useAuth';\r\nimport { dentistService, type Dentist, type DentistClinic, type DentistAvailability } from '../../services/dentistService';\r\nimport { userService } from '../../services/userService';\r\nimport {\r\n  User,\r\n  Phone,\r\n  MapPin,\r\n  Shield,\r\n  Save,\r\n  X,\r\n  Check,\r\n  AlertCircle,\r\n  Camera,\r\n  Briefcase,\r\n  Settings,\r\n  Building2,\r\n  Clock,\r\n  Award,\r\n  GraduationCap,\r\n  Globe,\r\n  Bell\r\n} from 'lucide-react';\r\nimport { validateEmail, validatePhone, validateRequired, validateZipCode } from '../../utils/validation';\r\n\r\nconst DentistSettings: React.FC = () => {\r\n  const { user, refreshUser, changePassword } = useAuth();\r\n  const [loading, setLoading] = useState(false);\r\n  const [uploadingImage, setUploadingImage] = useState(false);\r\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  const [activeSection, setActiveSection] = useState('personal');\r\n  const [showPasswordFields, setShowPasswordFields] = useState(false);\r\n  const [dentist, setDentist] = useState<Dentist | null>(null);\r\n  const [clinics, setClinics] = useState<DentistClinic[]>([]);\r\n  const [availability, setAvailability] = useState<DentistAvailability[]>([]);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const [formData, setFormData] = useState({\r\n    firstName: '',\r\n    lastName: '',\r\n    email: '',\r\n    phone: '',\r\n    dateOfBirth: '',\r\n    gender: 'male',\r\n    address: {\r\n      street: '',\r\n      city: '',\r\n      state: '',\r\n      zipCode: '',\r\n      country: 'Egypt'\r\n    },\r\n    specialization: '',\r\n    licenseNumber: '',\r\n    bio: '',\r\n    yearsOfExperience: 0,\r\n    education: [] as string[],\r\n    certifications: [] as string[]\r\n  });\r\n\r\n  const [passwordData, setPasswordData] = useState({\r\n    currentPassword: '',\r\n    newPassword: '',\r\n    confirmPassword: ''\r\n  });\r\n\r\n  const [preferences, setPreferences] = useState({\r\n    emailNotifications: true,\r\n    smsNotifications: true,\r\n    appointmentReminders: true,\r\n    language: 'en',\r\n    timezone: 'Africa/Cairo'\r\n  });\r\n\r\n  const [newEducation, setNewEducation] = useState('');\r\n  const [newCertification, setNewCertification] = useState('');\r\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\r\n\r\n  // Keyboard navigation for tabs\r\n  const handleTabKeyDown = (e: React.KeyboardEvent, sectionId: string) => {\r\n    const sectionIds = sections.map(s => s.id);\r\n    const currentIndex = sectionIds.indexOf(sectionId);\r\n    \r\n    switch (e.key) {\r\n      case 'ArrowLeft':\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        const prevIndex = currentIndex > 0 ? currentIndex - 1 : sectionIds.length - 1;\r\n        setActiveSection(sectionIds[prevIndex]);\r\n        // Focus management - focus the newly selected tab\r\n        setTimeout(() => {\r\n          const newTab = document.getElementById(`${sectionIds[prevIndex]}-tab`);\r\n          newTab?.focus();\r\n        }, 0);\r\n        break;\r\n      case 'ArrowRight':\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        const nextIndex = currentIndex < sectionIds.length - 1 ? currentIndex + 1 : 0;\r\n        setActiveSection(sectionIds[nextIndex]);\r\n        // Focus management - focus the newly selected tab\r\n        setTimeout(() => {\r\n          const newTab = document.getElementById(`${sectionIds[nextIndex]}-tab`);\r\n          newTab?.focus();\r\n        }, 0);\r\n        break;\r\n      case 'Home':\r\n        e.preventDefault();\r\n        setActiveSection(sectionIds[0]);\r\n        setTimeout(() => {\r\n          const newTab = document.getElementById(`${sectionIds[0]}-tab`);\r\n          newTab?.focus();\r\n        }, 0);\r\n        break;\r\n      case 'End':\r\n        e.preventDefault();\r\n        setActiveSection(sectionIds[sectionIds.length - 1]);\r\n        setTimeout(() => {\r\n          const newTab = document.getElementById(`${sectionIds[sectionIds.length - 1]}-tab`);\r\n          newTab?.focus();\r\n        }, 0);\r\n        break;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchDentistData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setMessage(null);\r\n        \r\n        const userId = user?.id;\r\n        if (!userId) {\r\n          toast.error('User not authenticated. Please sign in again.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        const dentistData = await dentistService.getDentistById(userId);\r\n        setDentist(dentistData);\r\n        \r\n        // Populate form data\r\n        setFormData({\r\n          firstName: dentistData.firstName || '',\r\n          lastName: dentistData.lastName || '',\r\n          email: dentistData.email || '',\r\n          phone: dentistData.phone || '',\r\n          dateOfBirth: '',\r\n          gender: 'male',\r\n          address: {\r\n            street: '',\r\n            city: '',\r\n            state: '',\r\n            zipCode: '',\r\n            country: 'Egypt'\r\n          },\r\n          specialization: dentistData.specialization || '',\r\n          licenseNumber: dentistData.licenseNumber || '',\r\n          bio: dentistData.bio || '',\r\n          yearsOfExperience: dentistData.yearsOfExperience || 0,\r\n          education: dentistData.education || [],\r\n          certifications: dentistData.certifications || []\r\n        });\r\n\r\n        // Fetch clinics\r\n        try {\r\n          const clinicsData = await dentistService.getDentistClinics(userId);\r\n          setClinics(clinicsData);\r\n        } catch (err) {\r\n          console.warn('Failed to fetch clinics:', err);\r\n        }\r\n\r\n        // Fetch availability\r\n        try {\r\n          const availabilityData = await dentistService.getDentistAvailability(userId);\r\n          setAvailability(availabilityData);\r\n        } catch (err) {\r\n          console.warn('Failed to fetch availability:', err);\r\n        }\r\n      } catch (err: any) {\r\n        console.error('Error fetching dentist data:', err);\r\n        const errorMsg = err.message || 'Failed to load dentist data';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (user?.id) {\r\n      fetchDentistData();\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const handleInputChange = (field: string, value: string | number) => {\r\n    if (validationErrors[field]) {\r\n      setValidationErrors(prev => {\r\n        const newErrors = { ...prev };\r\n        delete newErrors[field];\r\n        return newErrors;\r\n      });\r\n    }\r\n\r\n    if (field.startsWith('address.')) {\r\n      const addressField = field.split('.')[1];\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        address: {\r\n          ...prev.address,\r\n          [addressField]: value\r\n        }\r\n      }));\r\n    } else {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        [field]: value\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleAddEducation = () => {\r\n    if (newEducation.trim()) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        education: [...prev.education, newEducation.trim()]\r\n      }));\r\n      setNewEducation('');\r\n    }\r\n  };\r\n\r\n  const handleRemoveEducation = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      education: prev.education.filter((_, i) => i !== index)\r\n    }));\r\n  };\r\n\r\n  const handleAddCertification = () => {\r\n    if (newCertification.trim()) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        certifications: [...prev.certifications, newCertification.trim()]\r\n      }));\r\n      setNewCertification('');\r\n    }\r\n  };\r\n\r\n  const handleRemoveCertification = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      certifications: prev.certifications.filter((_, i) => i !== index)\r\n    }));\r\n  };\r\n\r\n  const handleProfilePictureUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      const errorMsg = 'File size must be less than 5MB';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];\r\n    if (!validTypes.includes(file.type)) {\r\n      const errorMsg = 'Please upload a valid image file (JPG, PNG, or GIF)';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setUploadingImage(true);\r\n      setMessage(null);\r\n      \r\n      await userService.uploadProfileImage(file);\r\n      toast.success('Profile picture updated successfully');\r\n      setMessage({ type: 'success', text: 'Profile picture updated successfully' });\r\n      \r\n      if (refreshUser) {\r\n        await refreshUser();\r\n      }\r\n      \r\n      setTimeout(() => setMessage(null), 3000);\r\n    } catch (error: any) {\r\n      console.error('Error uploading profile picture:', error);\r\n      const errorMsg = error.message || 'Failed to upload profile picture';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n    } finally {\r\n      setUploadingImage(false);\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  const validateForm = (): boolean => {\r\n    const errors: Record<string, string> = {};\r\n\r\n    const firstNameValidation = validateRequired(formData.firstName, 'First name');\r\n    if (!firstNameValidation.isValid) {\r\n      errors.firstName = firstNameValidation.error!;\r\n    }\r\n\r\n    const lastNameValidation = validateRequired(formData.lastName, 'Last name');\r\n    if (!lastNameValidation.isValid) {\r\n      errors.lastName = lastNameValidation.error!;\r\n    }\r\n\r\n    const emailValidation = validateEmail(formData.email);\r\n    if (!emailValidation.isValid) {\r\n      errors.email = emailValidation.error!;\r\n    }\r\n\r\n    const phoneValidation = validatePhone(formData.phone);\r\n    if (!phoneValidation.isValid) {\r\n      errors.phone = phoneValidation.error!;\r\n    }\r\n\r\n    const specializationValidation = validateRequired(formData.specialization, 'Specialization');\r\n    if (!specializationValidation.isValid) {\r\n      errors.specialization = specializationValidation.error!;\r\n    }\r\n\r\n    const licenseValidation = validateRequired(formData.licenseNumber, 'License number');\r\n    if (!licenseValidation.isValid) {\r\n      errors.licenseNumber = licenseValidation.error!;\r\n    }\r\n\r\n    const zipValidation = validateZipCode(formData.address.zipCode);\r\n    if (!zipValidation.isValid) {\r\n      errors['address.zipCode'] = zipValidation.error!;\r\n    }\r\n\r\n    setValidationErrors(errors);\r\n    return Object.keys(errors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setMessage(null);\r\n\r\n    if (!validateForm()) {\r\n      const errorMsg = 'Please fix the validation errors before submitting';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    if (!dentist?.id) {\r\n      const errorMsg = 'Dentist ID not found. Please refresh the page and try again.';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const updateData = {\r\n        firstName: formData.firstName,\r\n        lastName: formData.lastName,\r\n        email: formData.email,\r\n        phone: formData.phone,\r\n        address: formData.address,\r\n        specialization: formData.specialization,\r\n        licenseNumber: formData.licenseNumber,\r\n        bio: formData.bio,\r\n        yearsOfExperience: formData.yearsOfExperience,\r\n        education: formData.education,\r\n        certifications: formData.certifications\r\n      };\r\n      \r\n      await dentistService.updateDentist(dentist.id, updateData);\r\n      toast.success('Profile updated successfully!');\r\n      setMessage({ type: 'success', text: 'Profile updated successfully!' });\r\n      \r\n      if (refreshUser) {\r\n        await refreshUser();\r\n      }\r\n      \r\n      setTimeout(() => setMessage(null), 3000);\r\n    } catch (err: any) {\r\n      console.error('Error updating dentist profile:', err);\r\n      const errorMsg = err.message || 'Failed to update profile';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePasswordChange = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setMessage(null);\r\n    \r\n    if (!passwordData.currentPassword) {\r\n      const errorMsg = 'Current password is required';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    if (passwordData.newPassword !== passwordData.confirmPassword) {\r\n      const errorMsg = 'New passwords do not match';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    if (passwordData.newPassword.length < 8) {\r\n      const errorMsg = 'Password must be at least 8 characters long';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    if (passwordData.currentPassword === passwordData.newPassword) {\r\n      const errorMsg = 'New password must be different from current password';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    try {\r\n      await changePassword(passwordData.currentPassword, passwordData.newPassword);\r\n      \r\n      toast.success('Password updated successfully');\r\n      setMessage({ type: 'success', text: 'Password updated successfully' });\r\n      \r\n      setPasswordData({ currentPassword: '', newPassword: '', confirmPassword: '' });\r\n      setShowPasswordFields(false);\r\n      \r\n      setTimeout(() => setMessage(null), 3000);\r\n    } catch (error: any) {\r\n      console.error('Error changing password:', error);\r\n      const errorMsg = error.message || 'Failed to update password';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const genderOptions = [\r\n    { value: 'male', label: 'Male' },\r\n    { value: 'female', label: 'Female' },\r\n    { value: 'other', label: 'Other' }\r\n  ];\r\n\r\n  const stateOptions = [\r\n    { value: '', label: 'Select State/Province' },\r\n    { value: 'Cairo', label: 'Cairo' },\r\n    { value: 'Alexandria', label: 'Alexandria' },\r\n    { value: 'Giza', label: 'Giza' },\r\n    { value: 'Fayoum', label: 'Fayoum' },\r\n    { value: 'Aswan', label: 'Aswan' },\r\n    { value: 'Luxor', label: 'Luxor' },\r\n    { value: 'Minya', label: 'Minya' },\r\n    { value: 'Sohag', label: 'Sohag' },\r\n    { value: 'Qena', label: 'Qena' },\r\n    { value: 'Beni Suef', label: 'Beni Suef' }\r\n  ];\r\n\r\n  const languageOptions = [\r\n    { value: 'en', label: 'English' },\r\n    { value: 'ar', label: 'Arabic' }\r\n  ];\r\n\r\n  const timezoneOptions = [\r\n    { value: 'Africa/Cairo', label: 'Cairo (GMT+2)' },\r\n    { value: 'Europe/London', label: 'London (GMT+0)' },\r\n    { value: 'America/New_York', label: 'New York (GMT-5)' }\r\n  ];\r\n\r\n  const sections = [\r\n    { id: 'personal', label: 'Personal Information', icon: <User className=\"w-4 h-4\" /> },\r\n    { id: 'professional', label: 'Professional Information', icon: <Briefcase className=\"w-4 h-4\" /> },\r\n    { id: 'clinics', label: 'Clinic Associations', icon: <Building2 className=\"w-4 h-4\" /> },\r\n    { id: 'availability', label: 'Availability', icon: <Clock className=\"w-4 h-4\" /> },\r\n    { id: 'security', label: 'Security', icon: <Shield className=\"w-4 h-4\" /> },\r\n    { id: 'preferences', label: 'Preferences', icon: <Settings className=\"w-4 h-4\" /> }\r\n  ];\r\n\r\n  const calculateProfileCompletion = (): number => {\r\n    let completed = 0;\r\n    const total = 10;\r\n\r\n    if (formData.firstName && formData.lastName) completed++;\r\n    if (formData.email) completed++;\r\n    if (formData.phone) completed++;\r\n    if (formData.specialization) completed++;\r\n    if (formData.licenseNumber) completed++;\r\n    if (formData.bio) completed++;\r\n    if (formData.yearsOfExperience > 0) completed++;\r\n    if (formData.education.length > 0) completed++;\r\n    if (formData.certifications.length > 0) completed++;\r\n    if (clinics.length > 0) completed++;\r\n\r\n    return Math.round((completed / total) * 100);\r\n  };\r\n\r\n  if (loading && !dentist) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n        <div className=\"text-center\" role=\"status\" aria-live=\"polite\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\" aria-hidden=\"true\"></div>\r\n          <p className=\"text-gray-600\">Loading settings...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50\">\r\n      {/* Skip links for keyboard users */}\r\n      <div className=\"sr-only focus-within:not-sr-only\">\r\n        <a\r\n          href=\"#main-content\"\r\n          className=\"absolute top-4 left-4 z-50 px-4 py-2 bg-blue-600 text-white rounded-md shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n        >\r\n          Skip to main content\r\n        </a>\r\n        <a\r\n          href=\"#settings-navigation\"\r\n          className=\"absolute top-4 left-40 z-50 px-4 py-2 bg-blue-600 text-white rounded-md shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n        >\r\n          Skip to navigation\r\n        </a>\r\n      </div>\r\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          {/* Header */}\r\n          <div id=\"main-content\" className=\"mb-6 sm:mb-8\">\r\n            <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-1 sm:mb-2\">Dentist Settings</h1>\r\n            <p className=\"text-base sm:text-lg lg:text-xl text-gray-600\">\r\n              Manage your professional profile and preferences\r\n            </p>\r\n          </div>\r\n\r\n          {/* Profile Header Card */}\r\n          <Card className=\"p-4 sm:p-6 lg:p-8 mb-6 sm:mb-8 bg-gradient-to-r from-white to-blue-50 border-0 shadow-xl\">\r\n            <div className=\"flex flex-col lg:flex-row items-center lg:items-start gap-4 sm:gap-6 lg:gap-8\">\r\n              <div className=\"relative\">\r\n                <Avatar\r\n                  src={user?.profileImage}\r\n                  alt={`Dr. ${formData.firstName} ${formData.lastName}`}\r\n                  size=\"xl\"\r\n                  fallback={`${formData.firstName[0] || ''}${formData.lastName[0] || ''}`}\r\n                  className=\"ring-4 ring-white shadow-2xl w-24 h-24 sm:w-28 sm:h-28 lg:w-32 lg:h-32\"\r\n                />\r\n                <input\r\n                  ref={fileInputRef}\r\n                  type=\"file\"\r\n                  accept=\"image/jpeg,image/jpg,image/png,image/gif\"\r\n                  onChange={handleProfilePictureUpload}\r\n                  className=\"hidden\"\r\n                  aria-label=\"Upload profile picture\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => fileInputRef.current?.click()}\r\n                  disabled={uploadingImage || loading}\r\n                  className=\"absolute bottom-1 right-1 sm:bottom-2 sm:right-2 bg-blue-600 text-white rounded-full p-2 sm:p-3 hover:bg-blue-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed min-w-[44px] min-h-[44px] flex items-center justify-center\"\r\n                  aria-label=\"Upload profile picture\"\r\n                >\r\n                  {uploadingImage ? (\r\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n                  ) : (\r\n                    <Camera className=\"w-4 h-4 sm:w-5 sm:h-5\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n              \r\n              <div className=\"flex-1 text-center lg:text-left\">\r\n                <h2 className=\"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-2\">\r\n                  Dr. {formData.firstName} {formData.lastName}\r\n                </h2>\r\n                <div className=\"flex flex-wrap items-center justify-center lg:justify-start gap-2 sm:gap-3 mb-2 sm:mb-3\">\r\n                  <Badge className=\"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium\">\r\n                    {formData.specialization || 'Dentist'}\r\n                  </Badge>\r\n                  <Badge className=\"bg-green-100 text-green-800 px-2 sm:px-3 py-1 text-xs sm:text-sm\">\r\n                    Profile {calculateProfileCompletion()}% Complete\r\n                  </Badge>\r\n                </div>\r\n                <p className=\"text-sm sm:text-base lg:text-lg text-gray-600 break-words\">{formData.email}</p>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n\r\n          {/* Navigation Tabs - Horizontal on tablet/desktop, Vertical on mobile */}\r\n          <div id=\"settings-navigation\" className=\"mb-6 sm:mb-8\">\r\n            {/* Mobile: Vertical tabs */}\r\n            <div className=\"block md:hidden\">\r\n              <div className=\"space-y-2\" role=\"tablist\" aria-label=\"Settings sections\">\r\n                {sections.map((section) => (\r\n                  <button\r\n                    key={section.id}\r\n                    id={`${section.id}-tab-mobile`}\r\n                    onClick={() => setActiveSection(section.id)}\r\n                    onKeyDown={(e) => handleTabKeyDown(e, section.id)}\r\n                    disabled={loading}\r\n                    role=\"tab\"\r\n                    aria-selected={activeSection === section.id}\r\n                    aria-controls={`${section.id}-section`}\r\n                    aria-label={`View ${section.label} settings`}\r\n                    tabIndex={activeSection === section.id ? 0 : -1}\r\n                    className={`w-full flex items-center gap-3 py-3 px-4 rounded-lg font-medium text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${\r\n                      activeSection === section.id\r\n                        ? 'bg-blue-600 text-white shadow-md'\r\n                        : 'bg-white text-gray-700 hover:bg-gray-50 border border-gray-200'\r\n                    }`}\r\n                  >\r\n                    <span aria-hidden=\"true\">{section.icon}</span>\r\n                    <span className=\"flex-1 text-left\">{section.label}</span>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Tablet/Desktop: Horizontal tabs */}\r\n            <div className=\"hidden md:block border-b border-gray-200\">\r\n              <nav className=\"-mb-px flex space-x-4 lg:space-x-8 overflow-x-auto\" role=\"tablist\" aria-label=\"Settings sections\">\r\n                {sections.map((section) => (\r\n                  <button\r\n                    key={section.id}\r\n                    id={`${section.id}-tab`}\r\n                    onClick={() => setActiveSection(section.id)}\r\n                    onKeyDown={(e) => handleTabKeyDown(e, section.id)}\r\n                    disabled={loading}\r\n                    role=\"tab\"\r\n                    aria-selected={activeSection === section.id}\r\n                    aria-controls={`${section.id}-section`}\r\n                    aria-label={`View ${section.label} settings`}\r\n                    tabIndex={activeSection === section.id ? 0 : -1}\r\n                    className={`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap transition-colors disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${\r\n                      activeSection === section.id\r\n                        ? 'border-blue-500 text-blue-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    <span aria-hidden=\"true\">{section.icon}</span>\r\n                    <span className=\"hidden lg:inline\">{section.label}</span>\r\n                    <span className=\"lg:hidden\">{section.label.split(' ')[0]}</span>\r\n                  </button>\r\n                ))}\r\n              </nav>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Messages */}\r\n          {message && (\r\n            <div role=\"alert\" aria-live=\"polite\" className=\"mb-6\">\r\n              <Alert variant={message.type} className=\"w-full\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  {message.type === 'success' ? (\r\n                    <Check className=\"w-4 h-4\" />\r\n                  ) : (\r\n                    <AlertCircle className=\"w-4 h-4\" />\r\n                  )}\r\n                  {message.text}\r\n                </div>\r\n              </Alert>\r\n            </div>\r\n          )}\r\n\r\n          {/* Form Content */}\r\n          <Card className=\"p-4 sm:p-6 lg:p-8\">\r\n            <form onSubmit={handleSubmit} className=\"space-y-6 sm:space-y-8\">\r\n              {/* Personal Information Section */}\r\n              {activeSection === 'personal' && (\r\n                <section \r\n                  id=\"personal-section\" \r\n                  role=\"tabpanel\" \r\n                  aria-labelledby=\"personal-tab\"\r\n                  className=\"space-y-4 sm:space-y-6\"\r\n                >\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\" aria-hidden=\"true\">\r\n                      <User className=\"w-5 h-5 text-blue-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Personal Information</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Update your basic personal details</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                    <div>\r\n                      <Input\r\n                        label=\"First Name\"\r\n                        value={formData.firstName}\r\n                        onChange={(e) => handleInputChange('firstName', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.firstName && (\r\n                        <p className=\"mt-1 text-sm text-red-600\" role=\"alert\" aria-live=\"polite\">{validationErrors.firstName}</p>\r\n                      )}\r\n                    </div>\r\n                    <div>\r\n                      <Input\r\n                        label=\"Last Name\"\r\n                        value={formData.lastName}\r\n                        onChange={(e) => handleInputChange('lastName', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.lastName && (\r\n                        <p className=\"mt-1 text-sm text-red-600\" role=\"alert\" aria-live=\"polite\">{validationErrors.lastName}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                    <div>\r\n                      <Input\r\n                        label=\"Email\"\r\n                        type=\"email\"\r\n                        value={formData.email}\r\n                        onChange={(e) => handleInputChange('email', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.email && (\r\n                        <p className=\"mt-1 text-sm text-red-600\" role=\"alert\" aria-live=\"polite\">{validationErrors.email}</p>\r\n                      )}\r\n                    </div>\r\n                    <div>\r\n                      <Input\r\n                        label=\"Phone\"\r\n                        type=\"tel\"\r\n                        value={formData.phone}\r\n                        onChange={(e) => handleInputChange('phone', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.phone && (\r\n                        <p className=\"mt-1 text-sm text-red-600\" role=\"alert\" aria-live=\"polite\">{validationErrors.phone}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                    <Input\r\n                      label=\"Date of Birth\"\r\n                      type=\"date\"\r\n                      value={formData.dateOfBirth}\r\n                      onChange={(e) => handleInputChange('dateOfBirth', e.target.value)}\r\n                    />\r\n                    <Select\r\n                      label=\"Gender\"\r\n                      options={genderOptions}\r\n                      value={formData.gender}\r\n                      onChange={(e) => handleInputChange('gender', e.target.value)}\r\n                    />\r\n                  </div>\r\n\r\n                  <fieldset className=\"space-y-4\">\r\n                    <legend className=\"text-sm font-medium text-gray-700\">Address</legend>\r\n                    <Input\r\n                      label=\"Street\"\r\n                      value={formData.address.street}\r\n                      onChange={(e) => handleInputChange('address.street', e.target.value)}\r\n                    />\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6\">\r\n                      <Input\r\n                        label=\"City\"\r\n                        value={formData.address.city}\r\n                        onChange={(e) => handleInputChange('address.city', e.target.value)}\r\n                      />\r\n                      <Select\r\n                        label=\"State/Province\"\r\n                        options={stateOptions}\r\n                        value={formData.address.state}\r\n                        onChange={(e) => handleInputChange('address.state', e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6\">\r\n                      <div>\r\n                        <Input\r\n                          label=\"ZIP Code\"\r\n                          value={formData.address.zipCode}\r\n                          onChange={(e) => handleInputChange('address.zipCode', e.target.value)}\r\n                        />\r\n                        {validationErrors['address.zipCode'] && (\r\n                          <p className=\"mt-1 text-sm text-red-600\" role=\"alert\" aria-live=\"polite\">{validationErrors['address.zipCode']}</p>\r\n                        )}\r\n                      </div>\r\n                      <Input\r\n                        label=\"Country\"\r\n                        value={formData.address.country}\r\n                        onChange={(e) => handleInputChange('address.country', e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </fieldset>\r\n\r\n                  <div className=\"flex flex-col sm:flex-row justify-end gap-3 pt-4 sm:pt-6\">\r\n                    <Button type=\"submit\" disabled={loading} className=\"w-full sm:w-auto min-h-[44px]\">\r\n                      {loading ? (\r\n                        <>\r\n                          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                          Saving...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Save className=\"w-4 h-4 mr-2\" />\r\n                          Save Changes\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                </section>\r\n              )}\r\n\r\n              {/* Professional Information Section */}\r\n              {activeSection === 'professional' && (\r\n                <section \r\n                  id=\"professional-section\" \r\n                  role=\"tabpanel\" \r\n                  aria-labelledby=\"professional-tab\"\r\n                  className=\"space-y-4 sm:space-y-6\"\r\n                >\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0\" aria-hidden=\"true\">\r\n                      <Briefcase className=\"w-5 h-5 text-purple-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Professional Information</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Manage your professional credentials and experience</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                    <div>\r\n                      <Input\r\n                        label=\"Specialization\"\r\n                        value={formData.specialization}\r\n                        onChange={(e) => handleInputChange('specialization', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.specialization && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.specialization}</p>\r\n                      )}\r\n                    </div>\r\n                    <div>\r\n                      <Input\r\n                        label=\"License Number\"\r\n                        value={formData.licenseNumber}\r\n                        onChange={(e) => handleInputChange('licenseNumber', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.licenseNumber && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.licenseNumber}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <Input\r\n                      label=\"Years of Experience\"\r\n                      type=\"number\"\r\n                      min=\"0\"\r\n                      value={formData.yearsOfExperience}\r\n                      onChange={(e) => handleInputChange('yearsOfExperience', parseInt(e.target.value) || 0)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <Textarea\r\n                      label=\"Professional Bio\"\r\n                      value={formData.bio}\r\n                      onChange={(e) => handleInputChange('bio', e.target.value)}\r\n                      rows={4}\r\n                      placeholder=\"Tell us about your professional background and expertise...\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\r\n                      <GraduationCap className=\"w-4 h-4\" />\r\n                      Education\r\n                    </label>\r\n                    <div className=\"space-y-3\">\r\n                      {formData.education.map((edu, index) => (\r\n                        <div key={index} className=\"flex items-start sm:items-center gap-2 p-3 bg-blue-50 rounded-lg\">\r\n                          <span className=\"flex-1 text-sm sm:text-base text-gray-700 break-words\">{edu}</span>\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => handleRemoveEducation(index)}\r\n                            className=\"text-red-600 hover:text-red-700 min-w-[44px] min-h-[44px] flex items-center justify-center flex-shrink-0\"\r\n                            aria-label=\"Remove education\"\r\n                          >\r\n                            <X className=\"w-4 h-4\" />\r\n                          </button>\r\n                        </div>\r\n                      ))}\r\n                      <div className=\"flex flex-col sm:flex-row gap-2\">\r\n                        <div className=\"flex-1\">\r\n                          <Input\r\n                            placeholder=\"Add education (e.g., DDS from University of Cairo)\"\r\n                            value={newEducation}\r\n                            onChange={(e) => setNewEducation(e.target.value)}\r\n                            onKeyPress={(e) => {\r\n                              if (e.key === 'Enter') {\r\n                                e.preventDefault();\r\n                                handleAddEducation();\r\n                              }\r\n                            }}\r\n                          />\r\n                        </div>\r\n                        <Button type=\"button\" onClick={handleAddEducation} variant=\"outline\" className=\"w-full sm:w-auto min-h-[44px]\">\r\n                          Add\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\r\n                      <Award className=\"w-4 h-4\" />\r\n                      Certifications\r\n                    </label>\r\n                    <div className=\"space-y-3\">\r\n                      {formData.certifications.map((cert, index) => (\r\n                        <div key={index} className=\"flex items-start sm:items-center gap-2 p-3 bg-green-50 rounded-lg\">\r\n                          <span className=\"flex-1 text-sm sm:text-base text-gray-700 break-words\">{cert}</span>\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => handleRemoveCertification(index)}\r\n                            className=\"text-red-600 hover:text-red-700 min-w-[44px] min-h-[44px] flex items-center justify-center flex-shrink-0\"\r\n                            aria-label=\"Remove certification\"\r\n                          >\r\n                            <X className=\"w-4 h-4\" />\r\n                          </button>\r\n                        </div>\r\n                      ))}\r\n                      <div className=\"flex flex-col sm:flex-row gap-2\">\r\n                        <div className=\"flex-1\">\r\n                          <Input\r\n                            placeholder=\"Add certification (e.g., Board Certified Orthodontist)\"\r\n                            value={newCertification}\r\n                            onChange={(e) => setNewCertification(e.target.value)}\r\n                            onKeyPress={(e) => {\r\n                              if (e.key === 'Enter') {\r\n                                e.preventDefault();\r\n                                handleAddCertification();\r\n                              }\r\n                            }}\r\n                          />\r\n                        </div>\r\n                        <Button type=\"button\" onClick={handleAddCertification} variant=\"outline\" className=\"w-full sm:w-auto min-h-[44px]\">\r\n                          Add\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex flex-col sm:flex-row justify-end gap-3 pt-4 sm:pt-6\">\r\n                    <Button type=\"submit\" disabled={loading} className=\"w-full sm:w-auto min-h-[44px]\">\r\n                      {loading ? (\r\n                        <>\r\n                          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                          Saving...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Save className=\"w-4 h-4 mr-2\" />\r\n                          Save Changes\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                </section>\r\n              )}\r\n\r\n              {/* Clinic Associations Section */}\r\n              {activeSection === 'clinics' && (\r\n                <section \r\n                  id=\"clinics-section\" \r\n                  role=\"tabpanel\" \r\n                  aria-labelledby=\"clinics-tab\"\r\n                  className=\"space-y-4 sm:space-y-6\"\r\n                >\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Building2 className=\"w-5 h-5 text-green-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Clinic Associations</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Manage your clinic affiliations and primary clinic</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {clinics.length > 0 ? (\r\n                    <div className=\"space-y-4\">\r\n                      {clinics.map((clinic) => (\r\n                        <div key={clinic.id} className=\"p-4 sm:p-6 border border-gray-200 rounded-lg hover:shadow-md transition-shadow\">\r\n                          <div className=\"flex flex-col sm:flex-row items-start sm:items-start justify-between mb-4 gap-3\">\r\n                            <div className=\"flex items-start gap-3 flex-1\">\r\n                              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                                <Building2 className=\"w-5 h-5 sm:w-6 sm:h-6 text-green-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1 min-w-0\">\r\n                                <h4 className=\"font-semibold text-gray-900 text-sm sm:text-base break-words\">{clinic.name}</h4>\r\n                                {clinic.branchName && (\r\n                                  <p className=\"text-xs sm:text-sm text-gray-600 break-words\">{clinic.branchName}</p>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                            {clinic.isPrimary && (\r\n                              <Badge className=\"bg-green-100 text-green-800 text-xs sm:text-sm flex-shrink-0\">Primary</Badge>\r\n                            )}\r\n                          </div>\r\n\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex items-start gap-2 text-xs sm:text-sm text-gray-600\">\r\n                              <MapPin className=\"w-4 h-4 mt-0.5 flex-shrink-0\" />\r\n                              <span className=\"break-words\">\r\n                                {clinic.address.street}, {clinic.address.city}, {clinic.address.state} {clinic.address.zipCode}\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-xs sm:text-sm text-gray-600\">\r\n                              <Phone className=\"w-4 h-4 flex-shrink-0\" />\r\n                              <span className=\"break-words\">{clinic.phone}</span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center py-8 sm:py-12 bg-gray-50 rounded-lg px-4\">\r\n                      <Building2 className=\"w-10 h-10 sm:w-12 sm:h-12 text-gray-600 mx-auto mb-3 sm:mb-4\" />\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">No clinic affiliations found</p>\r\n                      <p className=\"text-xs sm:text-sm text-gray-500 mt-2\">Contact your administrator to be assigned to clinics</p>\r\n                    </div>\r\n                  )}\r\n                </section>\r\n              )}\r\n\r\n              {/* Availability Section */}\r\n              {activeSection === 'availability' && (\r\n                <section \r\n                  id=\"availability-section\" \r\n                  role=\"tabpanel\" \r\n                  aria-labelledby=\"availability-tab\"\r\n                  className=\"space-y-4 sm:space-y-6\"\r\n                >\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Clock className=\"w-5 h-5 text-orange-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Availability</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Set your working hours for each clinic</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {availability.length > 0 ? (\r\n                    <div className=\"space-y-4 sm:space-y-6\">\r\n                      {availability.map((avail) => (\r\n                        <div key={avail.clinicId} className=\"p-4 sm:p-6 border border-gray-200 rounded-lg\">\r\n                          <h4 className=\"font-semibold text-gray-900 mb-3 sm:mb-4 text-sm sm:text-base break-words\">{avail.clinicName}</h4>\r\n                          <div className=\"space-y-2 sm:space-y-3\">\r\n                            {Object.entries(avail.schedule).map(([day, slots]) => (\r\n                              <div key={day} className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 bg-orange-50 rounded-lg gap-2\">\r\n                                <span className=\"font-medium text-gray-700 capitalize text-sm sm:text-base\">{day}</span>\r\n                                <div className=\"flex flex-wrap gap-2\">\r\n                                  {slots.map((slot, index) => (\r\n                                    <span key={index} className=\"text-xs sm:text-sm text-gray-600 bg-white px-2 py-1 rounded\">\r\n                                      {slot.start} - {slot.end}\r\n                                    </span>\r\n                                  ))}\r\n                                </div>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center py-8 sm:py-12 bg-gray-50 rounded-lg px-4\">\r\n                      <Clock className=\"w-10 h-10 sm:w-12 sm:h-12 text-gray-600 mx-auto mb-3 sm:mb-4\" />\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">No availability schedule set</p>\r\n                      <p className=\"text-xs sm:text-sm text-gray-500 mt-2\">Contact your administrator to set up your schedule</p>\r\n                    </div>\r\n                  )}\r\n                </section>\r\n              )}\r\n\r\n              {/* Security Section */}\r\n              {activeSection === 'security' && (\r\n                <section \r\n                  id=\"security-section\" \r\n                  role=\"tabpanel\" \r\n                  aria-labelledby=\"security-tab\"\r\n                  className=\"space-y-4 sm:space-y-6\"\r\n                >\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Shield className=\"w-5 h-5 text-red-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Security</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Manage your password and security settings</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 bg-gray-50 rounded-lg gap-3\">\r\n                      <div className=\"flex-1\">\r\n                        <h4 className=\"font-medium text-gray-900 text-sm sm:text-base\">Password</h4>\r\n                        <p className=\"text-xs sm:text-sm text-gray-600\">Change your account password</p>\r\n                      </div>\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        onClick={() => setShowPasswordFields(!showPasswordFields)}\r\n                        className=\"w-full sm:w-auto min-h-[44px]\"\r\n                      >\r\n                        {showPasswordFields ? 'Cancel' : 'Change Password'}\r\n                      </Button>\r\n                    </div>\r\n\r\n                    {showPasswordFields && (\r\n                      <form onSubmit={handlePasswordChange} className=\"space-y-4 p-4 sm:p-6 border border-gray-200 rounded-lg\">\r\n                        <Input\r\n                          label=\"Current Password\"\r\n                          type=\"password\"\r\n                          value={passwordData.currentPassword}\r\n                          onChange={(e) => setPasswordData(prev => ({ ...prev, currentPassword: e.target.value }))}\r\n                          required\r\n                        />\r\n                        <Input\r\n                          label=\"New Password\"\r\n                          type=\"password\"\r\n                          value={passwordData.newPassword}\r\n                          onChange={(e) => setPasswordData(prev => ({ ...prev, newPassword: e.target.value }))}\r\n                          required\r\n                          helperText=\"Must be at least 8 characters long\"\r\n                        />\r\n                        <Input\r\n                          label=\"Confirm New Password\"\r\n                          type=\"password\"\r\n                          value={passwordData.confirmPassword}\r\n                          onChange={(e) => setPasswordData(prev => ({ ...prev, confirmPassword: e.target.value }))}\r\n                          required\r\n                        />\r\n                        <div className=\"flex flex-col sm:flex-row justify-end gap-3 pt-4\">\r\n                          <Button\r\n                            type=\"button\"\r\n                            variant=\"outline\"\r\n                            onClick={() => {\r\n                              setShowPasswordFields(false);\r\n                              setPasswordData({ currentPassword: '', newPassword: '', confirmPassword: '' });\r\n                            }}\r\n                            className=\"w-full sm:w-auto min-h-[44px]\"\r\n                          >\r\n                            Cancel\r\n                          </Button>\r\n                          <Button type=\"submit\" disabled={loading} className=\"w-full sm:w-auto min-h-[44px]\">\r\n                            {loading ? (\r\n                              <>\r\n                                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                                Updating...\r\n                              </>\r\n                            ) : (\r\n                              <>\r\n                                <Save className=\"w-4 h-4 mr-2\" />\r\n                                Update Password\r\n                              </>\r\n                            )}\r\n                          </Button>\r\n                        </div>\r\n                      </form>\r\n                    )}\r\n                  </div>\r\n                </section>\r\n              )}\r\n\r\n              {/* Preferences Section */}\r\n              {activeSection === 'preferences' && (\r\n                <section \r\n                  id=\"preferences-section\" \r\n                  role=\"tabpanel\" \r\n                  aria-labelledby=\"preferences-tab\"\r\n                  className=\"space-y-4 sm:space-y-6\"\r\n                >\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Settings className=\"w-5 h-5 text-indigo-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Preferences</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Customize your notification and display preferences</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    <div>\r\n                      <h4 className=\"text-sm font-medium text-gray-700 mb-3 sm:mb-4 flex items-center gap-2\">\r\n                        <Bell className=\"w-4 h-4\" />\r\n                        Notifications\r\n                      </h4>\r\n                      <div className=\"space-y-3\">\r\n                        <label htmlFor=\"email-notifications\" className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 bg-gray-50 rounded-lg cursor-pointer gap-3 min-h-[44px]\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-medium text-gray-900 text-sm sm:text-base\">Email Notifications</div>\r\n                            <div id=\"email-notifications-desc\" className=\"text-xs sm:text-sm text-gray-600\">Receive notifications via email</div>\r\n                          </div>\r\n                          <input\r\n                            id=\"email-notifications\"\r\n                            type=\"checkbox\"\r\n                            checked={preferences.emailNotifications}\r\n                            onChange={(e) => setPreferences(prev => ({ ...prev, emailNotifications: e.target.checked }))}\r\n                            aria-describedby=\"email-notifications-desc\"\r\n                            className=\"h-6 w-6 text-blue-600 rounded focus:ring-blue-500 flex-shrink-0\"\r\n                          />\r\n                        </label>\r\n                        <label htmlFor=\"sms-notifications\" className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 bg-gray-50 rounded-lg cursor-pointer gap-3 min-h-[44px]\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-medium text-gray-900 text-sm sm:text-base\">SMS Notifications</div>\r\n                            <div id=\"sms-notifications-desc\" className=\"text-xs sm:text-sm text-gray-600\">Receive notifications via SMS</div>\r\n                          </div>\r\n                          <input\r\n                            id=\"sms-notifications\"\r\n                            type=\"checkbox\"\r\n                            checked={preferences.smsNotifications}\r\n                            onChange={(e) => setPreferences(prev => ({ ...prev, smsNotifications: e.target.checked }))}\r\n                            aria-describedby=\"sms-notifications-desc\"\r\n                            className=\"h-6 w-6 text-blue-600 rounded focus:ring-blue-500 flex-shrink-0\"\r\n                          />\r\n                        </label>\r\n                        <label htmlFor=\"appointment-reminders\" className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 bg-gray-50 rounded-lg cursor-pointer gap-3 min-h-[44px]\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-medium text-gray-900 text-sm sm:text-base\">Appointment Reminders</div>\r\n                            <div id=\"appointment-reminders-desc\" className=\"text-xs sm:text-sm text-gray-600\">Get reminders for upcoming appointments</div>\r\n                          </div>\r\n                          <input\r\n                            id=\"appointment-reminders\"\r\n                            type=\"checkbox\"\r\n                            checked={preferences.appointmentReminders}\r\n                            onChange={(e) => setPreferences(prev => ({ ...prev, appointmentReminders: e.target.checked }))}\r\n                            aria-describedby=\"appointment-reminders-desc\"\r\n                            className=\"h-6 w-6 text-blue-600 rounded focus:ring-blue-500 flex-shrink-0\"\r\n                          />\r\n                        </label>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6\">\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2\">\r\n                          <Globe className=\"w-4 h-4\" />\r\n                          Language\r\n                        </label>\r\n                        <Select\r\n                          options={languageOptions}\r\n                          value={preferences.language}\r\n                          onChange={(e) => setPreferences(prev => ({ ...prev, language: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2\">\r\n                          <Clock className=\"w-4 h-4\" />\r\n                          Timezone\r\n                        </label>\r\n                        <Select\r\n                          options={timezoneOptions}\r\n                          value={preferences.timezone}\r\n                          onChange={(e) => setPreferences(prev => ({ ...prev, timezone: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex flex-col sm:flex-row justify-end gap-3 pt-4 sm:pt-6\">\r\n                    <Button type=\"button\" disabled={loading} className=\"w-full sm:w-auto min-h-[44px]\">\r\n                      {loading ? (\r\n                        <>\r\n                          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                          Saving...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Save className=\"w-4 h-4 mr-2\" />\r\n                          Save Preferences\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                </section>\r\n              )}\r\n            </form>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DentistSettings;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dentist\\__tests__\\DentistProfile.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2219,2222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2219,2222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3175,3178],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3175,3178],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":123,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":123,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4318,4321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4318,4321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5331,5334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5331,5334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5415,5418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5415,5418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6540,6543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6540,6543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6653,6656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6653,6656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":227,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7600,7603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7600,7603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":230,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":230,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7801,7804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7801,7804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8822,8825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8822,8825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":270,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":270,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9047,9050],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9047,9050],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":365,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":365,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12253,12256],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12253,12256],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":393,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":393,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13185,13188],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13185,13188],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":425,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":425,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14308,14311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14308,14311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":459,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":459,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15418,15421],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15418,15421],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Tests for DentistProfile component behavior with undefined/null data\r\n * Verifies safe property access and error handling in component\r\n */\r\n\r\nimport React from 'react';\r\nimport { render, screen, waitFor, fireEvent } from '@testing-library/react';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport { I18nextProvider } from 'react-i18next';\r\nimport DentistProfile from '../DentistProfile';\r\nimport { useAuth } from '../../../hooks/useAuth';\r\nimport { usePerformance } from '../../../hooks/usePerformance';\r\nimport { dentistService } from '../../../services/dentistService';\r\nimport i18n from '../../../i18n';\r\n\r\n// Mock dependencies\r\njest.mock('../../../hooks/useAuth');\r\njest.mock('../../../hooks/usePerformance');\r\njest.mock('../../../services/dentistService');\r\n\r\nconst mockUseAuth = useAuth as jest.MockedFunction<typeof useAuth>;\r\nconst mockUsePerformance = usePerformance as jest.MockedFunction<typeof usePerformance>;\r\nconst mockDentistService = dentistService as jest.Mocked<typeof dentistService>;\r\n\r\n// Mock react-router-dom navigate\r\nconst mockNavigate = jest.fn();\r\njest.mock('react-router-dom', () => ({\r\n  ...jest.requireActual('react-router-dom'),\r\n  useNavigate: () => mockNavigate\r\n}));\r\n\r\n// Test wrapper component\r\nconst TestWrapper: React.FC<{ children: React.ReactNode }> = ({ children }) => (\r\n  <BrowserRouter>\r\n    <I18nextProvider i18n={i18n}>\r\n      {children}\r\n    </I18nextProvider>\r\n  </BrowserRouter>\r\n);\r\n\r\ndescribe('DentistProfile Component - Error Handling', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    \r\n    // Default mock implementations\r\n    mockUseAuth.mockReturnValue({\r\n      user: { id: 'test-dentist-id', role: 'dentist' },\r\n      isAuthenticated: true,\r\n      login: jest.fn(),\r\n      logout: jest.fn(),\r\n      loading: false\r\n    });\r\n    \r\n    mockUsePerformance.mockReturnValue({\r\n      measureAsync: jest.fn((name, fn) => fn()),\r\n      mark: jest.fn(),\r\n      measure: jest.fn(),\r\n      getMetrics: jest.fn(() => ({}))\r\n    });\r\n  });\r\n\r\n  describe('Handling undefined/null dentist data', () => {\r\n    it('should handle null dentist profile gracefully', async () => {\r\n      mockDentistService.getDentistProfile.mockResolvedValue(null as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.queryByText(/error/i)).not.toBeInTheDocument();\r\n      });\r\n      \r\n      // Should show loading or empty state, not crash\r\n      expect(screen.getByTestId('dentist-profile') || screen.getByText(/loading/i)).toBeInTheDocument();\r\n    });\r\n\r\n    it('should handle dentist profile with missing properties', async () => {\r\n      const incompleteDentist = {\r\n        _id: 'test-id',\r\n        // Missing firstName, lastName, email, etc.\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(incompleteDentist as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.queryByText(/error/i)).not.toBeInTheDocument();\r\n      });\r\n      \r\n      // Should render without crashing, using fallback values\r\n      expect(screen.getByTestId('dentist-profile') || screen.getByText(/profile/i)).toBeInTheDocument();\r\n    });\r\n\r\n    it('should handle dentist profile with undefined nested properties', async () => {\r\n      const dentistWithUndefinedProps = {\r\n        _id: 'test-id',\r\n        firstName: 'John',\r\n        lastName: 'Doe',\r\n        profile: undefined,\r\n        settings: null,\r\n        preferences: {\r\n          // Some properties missing\r\n          theme: 'light'\r\n        }\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(dentistWithUndefinedProps as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.queryByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Should render name correctly while handling undefined properties safely\r\n      expect(screen.queryByText(/error/i)).not.toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('Handling undefined/null clinics data', () => {\r\n    it('should handle null clinics array', async () => {\r\n      const validDentist = {\r\n        _id: 'test-id',\r\n        firstName: 'John',\r\n        lastName: 'Doe',\r\n        email: 'john@test.com'\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(validDentist as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: null as any, total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Should show 0 clinics instead of crashing\r\n      expect(screen.queryByText(/0.*clinic/i)).toBeInTheDocument();\r\n    });\r\n\r\n    it('should handle clinics with missing properties', async () => {\r\n      const validDentist = {\r\n        _id: 'test-id',\r\n        firstName: 'John',\r\n        lastName: 'Doe',\r\n        email: 'john@test.com'\r\n      };\r\n      \r\n      const clinicsWithMissingProps = [\r\n        {\r\n          _id: 'clinic-1',\r\n          // Missing name, address, etc.\r\n        },\r\n        {\r\n          _id: 'clinic-2',\r\n          name: 'Test Clinic',\r\n          // Missing other properties\r\n        }\r\n      ];\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(validDentist as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ \r\n        data: clinicsWithMissingProps as any, \r\n        total: 2, \r\n        totalPages: 1 \r\n      });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Should render clinics count without crashing\r\n      expect(screen.queryByText(/2.*clinic/i)).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('Handling undefined/null appointments data', () => {\r\n    it('should handle null appointments array', async () => {\r\n      const validDentist = {\r\n        _id: 'test-id',\r\n        firstName: 'John',\r\n        lastName: 'Doe',\r\n        email: 'john@test.com'\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(validDentist as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: null as any, total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Should show 0 appointments instead of crashing\r\n      expect(screen.queryByText(/0.*appointment/i)).toBeInTheDocument();\r\n    });\r\n\r\n    it('should handle appointments with missing properties', async () => {\r\n      const validDentist = {\r\n        _id: 'test-id',\r\n        firstName: 'John',\r\n        lastName: 'Doe',\r\n        email: 'john@test.com'\r\n      };\r\n      \r\n      const appointmentsWithMissingProps = [\r\n        {\r\n          _id: 'apt-1',\r\n          // Missing date, patient, etc.\r\n        },\r\n        {\r\n          _id: 'apt-2',\r\n          date: '2024-01-15',\r\n          // Missing other properties\r\n        }\r\n      ];\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(validDentist as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: appointmentsWithMissingProps as any, \r\n        total: 2, \r\n        page: 1, \r\n        limit: 10, \r\n        totalPages: 1 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Should render appointments count without crashing\r\n      expect(screen.queryByText(/2.*appointment/i)).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('API error handling', () => {\r\n    it('should handle API errors gracefully', async () => {\r\n      mockDentistService.getDentistProfile.mockRejectedValue(new Error('API Error'));\r\n      mockDentistService.getDentistClinics.mockRejectedValue(new Error('Clinics API Error'));\r\n      mockDentistService.getDentistAppointments.mockRejectedValue(new Error('Appointments API Error'));\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        // Should show error state instead of crashing\r\n        expect(screen.getByText(/error/i) || screen.getByText(/something went wrong/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n\r\n    it('should handle network errors', async () => {\r\n      const networkError = new Error('Network Error');\r\n      networkError.name = 'NetworkError';\r\n      \r\n      mockDentistService.getDentistProfile.mockRejectedValue(networkError);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        // Should show network error message\r\n        expect(screen.getByText(/network/i) || screen.getByText(/connection/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n\r\n    it('should handle 404 errors for missing dentist', async () => {\r\n      const error404 = {\r\n        response: { status: 404 },\r\n        message: 'Dentist not found'\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockRejectedValue(error404);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        // Should show not found message\r\n        expect(screen.getByText(/not found/i) || screen.getByText(/404/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Loading states', () => {\r\n    it('should show loading state while fetching data', async () => {\r\n      // Mock delayed responses\r\n      mockDentistService.getDentistProfile.mockImplementation(\r\n        () => new Promise(resolve => setTimeout(() => resolve({\r\n          _id: 'test-id',\r\n          firstName: 'John',\r\n          lastName: 'Doe'\r\n        } as any), 100))\r\n      );\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      // Should show loading state initially\r\n      expect(screen.getByText(/loading/i) || screen.getByTestId('loading-spinner')).toBeInTheDocument();\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n\r\n    it('should handle partial loading states', async () => {\r\n      const validDentist = {\r\n        _id: 'test-id',\r\n        firstName: 'John',\r\n        lastName: 'Doe'\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(validDentist as any);\r\n      // Delay clinics loading\r\n      mockDentistService.getDentistClinics.mockImplementation(\r\n        () => new Promise(resolve => setTimeout(() => resolve({ data: [], total: 0, totalPages: 0 }), 100))\r\n      );\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Should show clinics loading state\r\n      expect(screen.getByText(/loading.*clinic/i) || screen.getByTestId('clinics-loading')).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('User interactions with error states', () => {\r\n    it('should allow retry after error', async () => {\r\n      mockDentistService.getDentistProfile\r\n        .mockRejectedValueOnce(new Error('API Error'))\r\n        .mockResolvedValueOnce({\r\n          _id: 'test-id',\r\n          firstName: 'John',\r\n          lastName: 'Doe'\r\n        } as any);\r\n      \r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.getByText(/error/i)).toBeInTheDocument();\r\n      });\r\n      \r\n      // Click retry button if available\r\n      const retryButton = screen.queryByText(/retry/i) || screen.queryByText(/try again/i);\r\n      if (retryButton) {\r\n        fireEvent.click(retryButton);\r\n        \r\n        await waitFor(() => {\r\n          expect(screen.getByText(/John Doe/i)).toBeInTheDocument();\r\n        });\r\n      }\r\n    });\r\n\r\n    it('should handle navigation when profile is incomplete', async () => {\r\n      const incompleteDentist = {\r\n        _id: 'test-id',\r\n        // Missing required fields\r\n      };\r\n      \r\n      mockDentistService.getDentistProfile.mockResolvedValue(incompleteDentist as any);\r\n      mockDentistService.getDentistClinics.mockResolvedValue({ data: [], total: 0, totalPages: 0 });\r\n      mockDentistService.getDentistAppointments.mockResolvedValue({ \r\n        data: [], total: 0, page: 1, limit: 10, totalPages: 0 \r\n      });\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <DentistProfile />\r\n        </TestWrapper>\r\n      );\r\n      \r\n      await waitFor(() => {\r\n        expect(screen.queryByText(/error/i)).not.toBeInTheDocument();\r\n      });\r\n      \r\n      // Should still allow navigation to settings\r\n      const editButton = screen.queryByText(/edit/i) || screen.queryByText(/settings/i);\r\n      if (editButton) {\r\n        fireEvent.click(editButton);\r\n        expect(mockNavigate).toHaveBeenCalledWith('/settings');\r\n      }\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\dentist\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\inventory\\Inventory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\inventory\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\medications\\Medications.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\PatientDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1211,1214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1211,1214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3275,3278],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3275,3278],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport { Card, Button, Badge, Alert, Tabs } from '../../components/ui';\r\nimport { patientService } from '../../services/patientService';\r\nimport { appointmentService } from '../../services/appointmentService';\r\nimport type { Patient, Appointment } from '../../types';\r\n\r\nconst PatientDetail: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const { id } = useParams<{ id: string }>();\r\n  const navigate = useNavigate();\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [patient, setPatient] = useState<Patient | null>(null);\r\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\r\n\r\n  useEffect(() => {\r\n    const fetchPatientData = async () => {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      try {\r\n        const patientData = await patientService.getPatientById(id!);\r\n        setPatient(patientData as Patient);\r\n        const appts = await appointmentService.getAppointments({ patientId: id });\r\n        setAppointments((appts as any)?.data || []);\r\n      } catch (err) {\r\n        console.error('Error fetching patient data:', err);\r\n        setError('Error fetching patient data');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n    \r\n    if (id && !['new', 'create', 'edit'].includes(id.toLowerCase())) {\r\n      fetchPatientData();\r\n    } else if (id && ['new', 'create', 'edit'].includes(id.toLowerCase())) {\r\n      navigate('/patients/new', { replace: true });\r\n    }\r\n  }, [id, navigate]);\r\n\r\n  const formatDate = (dateString: Date) => {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'long',\r\n      day: 'numeric'\r\n    });\r\n  };\r\n\r\n  const calculateAge = (dateOfBirth: Date) => {\r\n    const today = new Date();\r\n    const birthDate = new Date(dateOfBirth);\r\n    let age = today.getFullYear() - birthDate.getFullYear();\r\n    const monthDiff = today.getMonth() - birthDate.getMonth();\r\n    \r\n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\r\n      age--;\r\n    }\r\n    \r\n    return age;\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    const statusConfig = {\r\n      scheduled: { variant: 'info' as const, label: t('appointmentStatus.scheduled') },\r\n      confirmed: { variant: 'success' as const, label: t('appointmentStatus.confirmed') },\r\n      completed: { variant: 'success' as const, label: t('appointmentStatus.completed') },\r\n      cancelled: { variant: 'danger' as const, label: t('appointmentStatus.cancelled') },\r\n      'no-show': { variant: 'warning' as const, label: t('appointmentStatus.no-show') }\r\n    };\r\n    \r\n    const config = statusConfig[status as keyof typeof statusConfig] || { variant: 'gray' as const, label: status };\r\n    return <Badge variant={config.variant}>{config.label}</Badge>;\r\n  };\r\n\r\n  const handleDeletePatient = async () => {\r\n    if (window.confirm(t('patient_detail.confirm_delete'))) {\r\n      try {\r\n        await patientService.deletePatient(id!);\r\n        navigate('/patients');\r\n      } catch (err: any) {\r\n        setError(err.message || t('errors.delete_patient'));\r\n      }\r\n    }\r\n  };\r\n\r\n  if (isLoading) return <div className=\"flex justify-center items-center h-64\"><div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div></div>;\r\n  if (error) return <Alert variant=\"error\">{error}</Alert>;\r\n  if (!patient) return <Alert variant=\"error\">{t('errors.patient_not_found')}</Alert>;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8\">\r\n        {/* Enhanced Header - Responsive */}\r\n        <div className=\"mb-6 sm:mb-8\">\r\n          <div className=\"flex flex-col space-y-4 lg:flex-row lg:items-center lg:justify-between lg:space-y-0 gap-4 lg:gap-6\">\r\n            <div className=\"flex items-center gap-3 sm:gap-6\">\r\n              <div className=\"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center text-white text-xl sm:text-2xl font-bold shadow-lg flex-shrink-0\">\r\n                {patient.firstName[0]}{patient.lastName[0]}\r\n              </div>\r\n              <div className=\"min-w-0 flex-1\">\r\n                <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-2 truncate\">\r\n                  {patient.firstName} {patient.lastName}\r\n                </h1>\r\n                <div className=\"flex flex-wrap items-center gap-2 sm:gap-3\">\r\n                  <Badge variant={patient.isActive ? 'success' : 'gray'} className=\"px-2 sm:px-3 py-1\">\r\n                    {patient.isActive ? 'Active' : 'Inactive'}\r\n                  </Badge>\r\n                  <Badge className=\"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1\">\r\n                    Age {calculateAge(patient.dateOfBirth)}\r\n                  </Badge>\r\n                  <Badge className=\"bg-purple-100 text-purple-800 px-2 sm:px-3 py-1 capitalize\">\r\n                    {patient.gender}\r\n                  </Badge>\r\n                  <span className=\"text-gray-500 text-xs sm:text-sm hidden sm:inline\">ID: {patient.id}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-2 sm:gap-3\">\r\n              <Link to={`/patients/${patient.id}/edit`} className=\"flex-1 sm:flex-none\">\r\n                <Button variant=\"outline\" className=\"flex items-center justify-center gap-2 w-full min-h-[44px]\">\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\r\n                  </svg>\r\n                  <span className=\"hidden sm:inline\">Edit Patient</span>\r\n                  <span className=\"sm:hidden\">Edit</span>\r\n                </Button>\r\n              </Link>\r\n              <Button \r\n                variant=\"outline\" \r\n                className=\"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center justify-center gap-2 flex-1 sm:flex-none min-h-[44px]\" \r\n                onClick={handleDeletePatient}\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                </svg>\r\n                <span className=\"hidden sm:inline\">Delete Patient</span>\r\n                <span className=\"sm:hidden\">Delete</span>\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <Tabs\r\n          tabs={[\r\n            {\r\n              id: 'overview',\r\n              label: 'Overview',\r\n              content: (\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8\">\r\n                  {/* Main Content */}\r\n                  <div className=\"lg:col-span-2 space-y-4 sm:space-y-6\">\r\n                    <Card className=\"p-4 sm:p-6 bg-gradient-to-r from-white to-blue-50 border-0 shadow-lg\">\r\n                      <h2 className=\"text-lg sm:text-xl font-semibold text-gray-900 mb-4 sm:mb-6 flex items-center gap-2\">\r\n                        <svg className=\"w-5 h-5 text-blue-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                        </svg>\r\n                        Personal Information\r\n                      </h2>\r\n                      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6\">\r\n                        <div className=\"space-y-4\">\r\n                          <div className=\"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm\">\r\n                            <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                              <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium text-gray-500\">Full Name</p>\r\n                              <p className=\"font-semibold text-gray-900\">{patient.firstName} {patient.lastName}</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm\">\r\n                            <div className=\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center\">\r\n                              <svg className=\"w-5 h-5 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a1 1 0 011 1v1a1 1 0 01-1 1H5a1 1 0 01-1-1V8a1 1 0 011-1h3z\" />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium text-gray-500\">Age</p>\r\n                              <p className=\"font-semibold text-gray-900\">{calculateAge(patient.dateOfBirth)} years old</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm\">\r\n                            <div className=\"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center\">\r\n                              <svg className=\"w-5 h-5 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a1 1 0 011 1v1a1 1 0 01-1 1H5a1 1 0 01-1-1V8a1 1 0 011-1h3z\" />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium text-gray-500\">Date of Birth</p>\r\n                              <p className=\"font-semibold text-gray-900\">{formatDate(patient.dateOfBirth)}</p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"space-y-4\">\r\n                          <div className=\"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm\">\r\n                            <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                              <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium text-gray-500\">Email</p>\r\n                              <p className=\"font-semibold text-gray-900\">{patient.email}</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm\">\r\n                            <div className=\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center\">\r\n                              <svg className=\"w-5 h-5 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium text-gray-500\">Phone</p>\r\n                              <p className=\"font-semibold text-gray-900\">{patient.phone}</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm\">\r\n                            <div className=\"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center\">\r\n                              <svg className=\"w-5 h-5 text-orange-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium text-gray-500\">Address</p>\r\n                              <p className=\"font-semibold text-gray-900\">{patient.address.street}</p>\r\n                              <p className=\"text-sm text-gray-600\">{patient.address.city}, {patient.address.state} {patient.address.zipCode}</p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </Card>\r\n\r\n                    {/* Quick Stats */}\r\n                    <Card className=\"p-4 sm:p-6\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2\">\r\n                        <svg className=\"w-5 h-5 text-green-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n                        </svg>\r\n                        Patient Statistics\r\n                      </h3>\r\n                      <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4\">\r\n                        <div className=\"bg-blue-50 rounded-lg p-4 text-center\">\r\n                          <div className=\"text-2xl font-bold text-blue-600 mb-1\">{appointments.length}</div>\r\n                          <div className=\"text-sm text-gray-600\">Total Visits</div>\r\n                        </div>\r\n                        <div className=\"bg-green-50 rounded-lg p-4 text-center\">\r\n                          <div className=\"text-2xl font-bold text-green-600 mb-1\">\r\n                            {appointments.filter(apt => apt.status === 'completed').length}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-600\">Completed</div>\r\n                        </div>\r\n                        <div className=\"bg-purple-50 rounded-lg p-4 text-center\">\r\n                          <div className=\"text-2xl font-bold text-purple-600 mb-1\">\r\n                            {appointments.filter(apt => new Date(apt.date) > new Date() && apt.status !== 'cancelled').length}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-600\">Upcoming</div>\r\n                        </div>\r\n                        <div className=\"bg-orange-50 rounded-lg p-4 text-center\">\r\n                          <div className=\"text-2xl font-bold text-orange-600 mb-1\">\r\n                            {patient.medicalHistory?.allergies?.length || 0}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-600\">Allergies</div>\r\n                        </div>\r\n                      </div>\r\n                    </Card>\r\n                  </div>\r\n\r\n                  {/* Sidebar */}\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    {/* Quick Actions */}\r\n                    <Card className=\"p-4 sm:p-6\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4\">Quick Actions</h3>\r\n                      <div className=\"space-y-2 sm:space-y-3\">\r\n                        <Link to={`/appointments/create?patientId=${patient.id}`}>\r\n                          <Button className=\"w-full justify-start min-h-[44px]\" variant=\"outline\">\r\n                            <svg className=\"w-4 h-4 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a1 1 0 011 1v1a1 1 0 01-1 1H5a1 1 0 01-1-1V8a1 1 0 011-1h3z\" />\r\n                            </svg>\r\n                            Schedule Appointment\r\n                          </Button>\r\n                        </Link>\r\n                        <Button className=\"w-full justify-start min-h-[44px]\" variant=\"outline\">\r\n                          <svg className=\"w-4 h-4 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n                          </svg>\r\n                          View Records\r\n                        </Button>\r\n                        <Button className=\"w-full justify-start min-h-[44px]\" variant=\"outline\">\r\n                          <svg className=\"w-4 h-4 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n                          </svg>\r\n                          Download Reports\r\n                        </Button>\r\n                      </div>\r\n                    </Card>\r\n\r\n                    {/* Emergency Contact */}\r\n                    {patient.emergencyContact && (\r\n                      <Card className=\"p-4 sm:p-6\">\r\n                        <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2\">\r\n                          <svg className=\"w-5 h-5 text-red-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\r\n                          </svg>\r\n                          Emergency Contact\r\n                        </h3>\r\n                        <div className=\"space-y-2\">\r\n                          <p className=\"font-medium\">{patient.emergencyContact.name}</p>\r\n                          <p className=\"text-sm text-gray-600\">{patient.emergencyContact.relationship}</p>\r\n                          <p className=\"text-sm text-gray-600\">{patient.emergencyContact.phone}</p>\r\n                        </div>\r\n                      </Card>\r\n                    )}\r\n\r\n                    {/* Medical Information Cards */}\r\n                    <div className=\"space-y-4 sm:space-y-6\">\r\n                      <Card className=\"p-4 sm:p-6\">\r\n                        <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2\">\r\n                          <svg className=\"w-5 h-5 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                          </svg>\r\n                          Allergies\r\n                        </h3>\r\n                        {patient.medicalHistory?.allergies?.length > 0 ? (\r\n                          <div className=\"space-y-2\">\r\n                            {patient.medicalHistory?.allergies?.map((allergy: string, index: number) => (\r\n                              <div key={index} className=\"flex items-center gap-2 p-2 bg-red-50 rounded-lg\">\r\n                                <svg className=\"w-4 h-4 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                                </svg>\r\n                                <span className=\"text-red-800\">{allergy}</span>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        ) : (\r\n                          <p className=\"text-gray-500\">No known allergies</p>\r\n                        )}\r\n                      </Card>\r\n\r\n                      <Card className=\"p-4 sm:p-6\">\r\n                        <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2\">\r\n                          <svg className=\"w-5 h-5 text-blue-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\r\n                          </svg>\r\n                          Medical Conditions\r\n                        </h3>\r\n                        {patient.medicalHistory?.conditions?.length > 0 ? (\r\n                          <div className=\"space-y-2\">\r\n                            {patient.medicalHistory?.conditions?.map((condition: string, index: number) => (\r\n                              <div key={index} className=\"flex items-center gap-2 p-2 bg-blue-50 rounded-lg\">\r\n                                <svg className=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\r\n                                </svg>\r\n                                <span className=\"text-blue-800\">{condition}</span>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        ) : (\r\n                          <p className=\"text-gray-500\">No medical conditions recorded</p>\r\n                        )}\r\n                      </Card>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )\r\n            },\r\n            {\r\n              id: 'appointments',\r\n              label: 'Appointments',\r\n              content: (\r\n                <Card className=\"p-4 sm:p-6\">\r\n                  <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0 mb-4 sm:mb-6\">\r\n                    <h2 className=\"text-base sm:text-lg font-medium text-gray-900\">Appointments</h2>\r\n                    <Link to={`/appointments/create?patientId=${patient.id}`}>\r\n                      <Button variant=\"outline\" size=\"sm\" className=\"w-full sm:w-auto min-h-[44px]\">Schedule New</Button>\r\n                    </Link>\r\n                  </div>\r\n                  {appointments.length > 0 ? (\r\n                    <div className=\"overflow-x-auto -mx-4 sm:mx-0\">\r\n                      <table className=\"min-w-full divide-y divide-gray-200\">\r\n                        <thead className=\"bg-gray-50\">\r\n                          <tr>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Date</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Time</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Dentist</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                          {appointments.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()).map((appointment) => (\r\n                            <tr key={appointment.id}>\r\n                              <td className=\"px-6 py-4 whitespace-nowrap\">{formatDate(new Date(appointment.date))}</td>\r\n                              <td className=\"px-6 py-4 whitespace-nowrap\">{appointment.timeSlot}</td>\r\n                              <td className=\"px-6 py-4 whitespace-nowrap\">{appointment.dentistName || 'N/A'}</td>\r\n                              <td className=\"px-6 py-4 whitespace-nowrap\">{getStatusBadge(appointment.status)}</td>\r\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                                <Link to={`/appointments/${appointment.id}`} className=\"text-indigo-600 hover:text-indigo-900 mr-4\">View</Link>\r\n                                <Link to={`/appointments/${appointment.id}/edit`} className=\"text-indigo-600 hover:text-indigo-900\">Edit</Link>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  ) : (\r\n                    <p className=\"text-gray-500 text-center py-8\">No appointments scheduled</p>\r\n                  )}\r\n                </Card>\r\n              )\r\n            },\r\n            {\r\n              id: 'medical-history',\r\n              label: 'Medical History',\r\n              content: <div className=\"p-6\">Medical history details coming soon...</div>\r\n            },\r\n            {\r\n              id: 'medications',\r\n              label: 'Medications',\r\n              content: <div className=\"p-6\">Medications list coming soon...</div>\r\n            },\r\n            {\r\n              id: 'notes',\r\n              label: 'Notes',\r\n              content: <div className=\"p-6\">Patient notes coming soon...</div>\r\n            }\r\n          ]}\r\n          defaultTabId=\"overview\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatientDetail;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\PatientDetailNew.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\PatientForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2603,2606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2603,2606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'formData.preferredClinicId'. Either include it or remove the dependency array.","line":91,"column":6,"nodeType":"ArrayExpression","endLine":91,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [formData.preferredClinicId, id, isEditMode]","fix":{"range":[2805,2821],"text":"[formData.preferredClinicId, id, isEditMode]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7686,7689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7686,7689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport { Button, Input, Textarea, Select, Card, Alert } from '../../components/ui';\nimport { patientService } from '../../services';\nimport * as clinicService from '../../services/clinicService';\nimport { useAuth } from '../../hooks/useAuth';\nimport type { Patient as PatientType, Clinic } from '../../types';\n\nconst PatientForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { id } = useParams<{ id: string }>();\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const isEditMode = Boolean(id);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [newAllergy, setNewAllergy] = useState('');\n  const [newCondition, setNewCondition] = useState('');\n  const [availableClinics, setAvailableClinics] = useState<Clinic[]>([]);\n  \n  // Form state\n  const [formData, setFormData] = useState<PatientType>({\n    id: '',\n    firstName: '',\n    lastName: '',\n    email: '',\n    phone: '',\n    dateOfBirth: new Date(),\n    gender: 'male',\n    address: {\n      street: '',\n      city: '',\n      state: '',\n      zipCode: '',\n      country: 'US'\n    },\n    medicalHistory: {\n      allergies: [],\n      conditions: [],\n      medications: [],\n      notes: ''\n    },\n    treatmentRecords: [],\n    preferredClinicId: '',\n    isActive: true,\n    emergencyContact: {\n      name: '',\n      phone: '',\n      relationship: ''\n    },\n    createdAt: new Date(),\n    updatedAt: new Date()\n  });\n\n  // Fetch clinics and patient data\n  useEffect(() => {\n    const fetchInitialData = async () => {\n      try {\n        // Load available clinics\n        const clinicsResponse = await clinicService.getAllClinics();\n        if (clinicsResponse.success && clinicsResponse.data) {\n          setAvailableClinics(clinicsResponse.data);\n          \n          // Set default clinic if no clinic selected and clinics available\n          if (!formData.preferredClinicId && clinicsResponse.data && clinicsResponse.data.length > 0) {\n            setFormData(prev => ({\n              ...prev,\n              preferredClinicId: clinicsResponse.data![0].id\n            }));\n          }\n        }\n\n        // Fetch patient data if in edit mode\n        if (isEditMode) {\n          setIsLoading(true);\n          const data = await patientService.getPatientById(id!);\n          setFormData(data);\n        }\n      } catch (err: any) {\n        setError(err.message || 'Failed to fetch initial data');\n      } finally {\n        if (isEditMode) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    fetchInitialData();\n  }, [id, isEditMode]); // Remove formData dependency to prevent infinite loops\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    \n    if (name.startsWith('emergencyContact.')) {\n      const field = name.split('.')[1];\n      setFormData(prev => ({\n        ...prev,\n        emergencyContact: {\n          ...prev.emergencyContact!,\n          [field]: value\n        }\n      }));\n    } else if (name.startsWith('address.')) {\n      const field = name.split('.')[1];\n      setFormData(prev => ({\n        ...prev,\n        address: {\n          ...prev.address,\n          [field]: value\n        }\n      }));\n    } else if (name === 'medicalHistory.notes') {\n      setFormData(prev => ({\n        ...prev,\n        medicalHistory: {\n          ...prev.medicalHistory,\n          notes: value\n        }\n      }));\n    } else if (name === 'dateOfBirth') {\n      setFormData(prev => ({ ...prev, [name]: new Date(value) }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n  };\n\n  const handleAddAllergy = () => {\n    if (newAllergy.trim()) {\n      setFormData(prev => ({\n        ...prev,\n        medicalHistory: {\n          ...prev.medicalHistory,\n          allergies: [...prev.medicalHistory.allergies, newAllergy.trim()]\n        }\n      }));\n      setNewAllergy('');\n    }\n  };\n\n  const handleRemoveAllergy = (index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      medicalHistory: {\n        ...prev.medicalHistory,\n        allergies: prev.medicalHistory.allergies.filter((_, i) => i !== index)\n      }\n    }));\n  };\n\n  const handleAddCondition = () => {\n    if (newCondition.trim()) {\n      setFormData(prev => ({\n        ...prev,\n        medicalHistory: {\n          ...prev.medicalHistory,\n          conditions: [...prev.medicalHistory.conditions, newCondition.trim()]\n        }\n      }));\n      setNewCondition('');\n    }\n  };\n\n  const handleRemoveCondition = (index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      medicalHistory: {\n        ...prev.medicalHistory,\n        conditions: prev.medicalHistory.conditions.filter((_, i) => i !== index)\n      }\n    }));\n  };\n\n  const validateForm = () => {\n    if (!formData.firstName.trim()) {\n      setError(t('patient_form.first_name_required'));\n      return false;\n    }\n    if (!formData.lastName.trim()) {\n      setError(t('patient_form.last_name_required'));\n      return false;\n    }\n    if (!formData.email.trim()) {\n      setError(t('patient_form.email_required'));\n      return false;\n    }\n    if (!formData.phone.trim()) {\n      setError(t('patient_form.phone_required'));\n      return false;\n    }\n    if (!formData.dateOfBirth) {\n      setError(t('patient_form.date_of_birth_required'));\n      return false;\n    }\n    if (!formData.preferredClinicId) {\n      setError(t('patient_form.clinic_required'));\n      return false;\n    }\n    if (!formData.address.street.trim()) {\n      setError(t('patient_form.street_address_required'));\n      return false;\n    }\n    if (!formData.address.city.trim()) {\n      setError(t('patient_form.city_required'));\n      return false;\n    }\n    if (!formData.address.state.trim()) {\n      setError(t('patient_form.state_required'));\n      return false;\n    }\n    if (!formData.address.zipCode.trim()) {\n      setError(t('patient_form.zip_code_required'));\n      return false;\n    }\n    return true;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      // Prepare data for backend with proper structure\n      const patientData = {\n        ...formData,\n        // Backend expects Date object, not string\n        dateOfBirth: formData.dateOfBirth instanceof Date \n          ? formData.dateOfBirth \n          : new Date(formData.dateOfBirth),\n        // Ensure medical history has proper structure\n        medicalHistory: {\n          allergies: formData.medicalHistory.allergies || [],\n          medications: formData.medicalHistory.medications || [],\n          conditions: formData.medicalHistory.conditions || [],\n          notes: formData.medicalHistory.notes || ''\n        },\n        // Add created by information for new patients\n        ...(isEditMode ? {} : { createdBy: user?.id })\n      };\n\n      if (isEditMode) {\n        await patientService.updatePatient(id!, patientData);\n      } else {\n        await patientService.createPatient(patientData);\n      }\n      \n      setSuccess(isEditMode ? t('patient_form.patient_updated_successfully') : t('patient_form.patient_created_successfully'));\n      \n      setTimeout(() => {\n        if (isEditMode) {\n          navigate(`/patients/${id}`);\n        } else {\n          navigate('/patients');\n        }\n      }, 1500);\n    } catch (err: any) {\n      setError(err.message || t('patient_form.error_saving_patient'));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (isLoading && isEditMode) {\n    return (\n      <div className=\"py-6\">\n        <Card>\n          <div className=\"flex justify-center items-center h-64\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\n          </div>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-4 sm:py-6 px-4 sm:px-0\">\n      <div className=\"flex flex-col space-y-2 mb-4 sm:mb-6\">\n        <div>\n          <h1 className=\"text-xl sm:text-2xl font-semibold text-gray-900\">\n            {isEditMode ? t('patient_form.edit_patient') : t('patient_form.add_new_patient')}\n          </h1>\n          <p className=\"mt-1 text-sm text-gray-600\">\n            {isEditMode ? t('patient_form.update_patient_info') : t('patient_form.create_new_patient_record')}\n          </p>\n        </div>\n      </div>\n\n      {error && (\n        <Alert variant=\"error\" className=\"mb-6\" onClose={() => setError(null)}>\n          {error}\n        </Alert>\n      )}\n\n      {success && (\n        <Alert variant=\"success\" className=\"mb-6\" onClose={() => setSuccess(null)}>\n          {success}\n        </Alert>\n      )}\n\n      <form onSubmit={handleSubmit} className=\"space-y-4 sm:space-y-6\">\n        <Card className=\"p-4 sm:p-6\">\n          <h2 className=\"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4\">{t('patient_form.personal_information')}</h2>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4\">\n            <Input\n              label={t('patient_form.first_name')}\n              name=\"firstName\"\n              value={formData.firstName}\n              onChange={handleInputChange}\n              required\n            />\n            <Input\n              label={t('patient_form.last_name')}\n              name=\"lastName\"\n              value={formData.lastName}\n              onChange={handleInputChange}\n              required\n            />\n            <Input\n              label={t('patient_form.email')}\n              name=\"email\"\n              type=\"email\"\n              value={formData.email}\n              onChange={handleInputChange}\n              required\n            />\n            <Input\n              label={t('patient_form.phone')}\n              name=\"phone\"\n              type=\"tel\"\n              value={formData.phone}\n              onChange={handleInputChange}\n              required\n            />\n            <Input\n               label={t('patient_form.date_of_birth')}\n               name=\"dateOfBirth\"\n               type=\"date\"\n               value={formData.dateOfBirth.toISOString().split('T')[0]}\n               onChange={handleInputChange}\n               required\n             />\n            <Select\n              label={t('patient_form.gender')}\n              name=\"gender\"\n              value={formData.gender}\n              onChange={handleInputChange}\n              options={[\n                { value: 'male', label: t('patient_form.male') },\n                { value: 'female', label: t('patient_form.female') },\n                { value: 'other', label: t('patient_form.other') }\n              ]}\n            />\n          </div>\n          \n          <div className=\"mt-4\">\n            <Select\n              label={t('patient_form.preferred_clinic')}\n              name=\"preferredClinicId\"\n              value={formData.preferredClinicId}\n              onChange={handleInputChange}\n              options={availableClinics.map(clinic => ({\n                value: clinic.id,\n                label: clinic.name\n              }))}\n              required\n            />\n          </div>\n        </Card>\n\n        <Card className=\"p-4 sm:p-6\">\n          <h2 className=\"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4\">{t('patient_form.address_information')}</h2>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4\">\n            <div className=\"sm:col-span-2\">\n             <Input\n               label={t('patient_form.street_address')}\n               name=\"address.street\"\n               value={formData.address.street}\n               onChange={handleInputChange}\n               required\n             />\n             </div>\n             <Input\n               label={t('patient_form.city')}\n               name=\"address.city\"\n               value={formData.address.city}\n               onChange={handleInputChange}\n               required\n             />\n             <Input\n               label={t('patient_form.state')}\n               name=\"address.state\"\n               value={formData.address.state}\n               onChange={handleInputChange}\n               required\n             />\n             <Input\n               label={t('patient_form.zip_code')}\n               name=\"address.zipCode\"\n               value={formData.address.zipCode}\n               onChange={handleInputChange}\n               required\n             />\n             <Input\n               label={t('patient_form.country')}\n               name=\"address.country\"\n               value={formData.address.country}\n               onChange={handleInputChange}\n               required\n             />\n          </div>\n        </Card>\n\n        <Card className=\"p-4 sm:p-6\">\n          <h2 className=\"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4\">{t('patient_form.emergency_contact')}</h2>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4\">\n            <Input\n               label={t('patient_form.contact_name')}\n               name=\"emergencyContact.name\"\n               value={formData.emergencyContact?.name || ''}\n               onChange={handleInputChange}\n             />\n             <Input\n               label={t('patient_form.contact_phone')}\n               name=\"emergencyContact.phone\"\n               type=\"tel\"\n               value={formData.emergencyContact?.phone || ''}\n               onChange={handleInputChange}\n             />\n             <Input\n               label={t('patient_form.relationship')}\n               name=\"emergencyContact.relationship\"\n               value={formData.emergencyContact?.relationship || ''}\n               onChange={handleInputChange}\n             />\n          </div>\n        </Card>\n\n        <Card className=\"p-4 sm:p-6\">\n          <h2 className=\"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4\">{t('patient_form.medical_information')}</h2>\n          \n          <div className=\"space-y-4 sm:space-y-6\">\n            <div>\n              <h3 className=\"text-sm sm:text-md font-medium text-gray-700 mb-2\">{t('patient_form.allergies')}</h3>\n              <div className=\"flex flex-col sm:flex-row gap-2 mb-2\">\n                <Input\n                  placeholder={t('patient_form.add_allergy')}\n                  value={newAllergy}\n                  onChange={(e) => setNewAllergy(e.target.value)}\n                  onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddAllergy())}\n                  className=\"flex-1\"\n                />\n                <Button type=\"button\" onClick={handleAddAllergy} variant=\"outline\" className=\"w-full sm:w-auto min-h-[44px]\">\n                  {t('patient_form.add')}\n                </Button>\n              </div>\n              {formData.medicalHistory.allergies.length > 0 && (\n                <div className=\"space-y-1\">\n                  {formData.medicalHistory.allergies.map((allergy, index) => (\n                    <div key={index} className=\"flex items-center justify-between bg-gray-50 p-2 rounded\">\n                      <span>{allergy}</span>\n                      <Button\n                         type=\"button\"\n                         variant=\"outline\"\n                         size=\"sm\"\n                         onClick={() => handleRemoveAllergy(index)}\n                       >\n                         {t('patient_form.remove')}\n                       </Button>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <h3 className=\"text-sm sm:text-md font-medium text-gray-700 mb-2\">{t('patient_form.medical_conditions')}</h3>\n              <div className=\"flex flex-col sm:flex-row gap-2 mb-2\">\n                <Input\n                  placeholder={t('patient_form.add_medical_condition')}\n                  value={newCondition}\n                  onChange={(e) => setNewCondition(e.target.value)}\n                  onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddCondition())}\n                  className=\"flex-1\"\n                />\n                <Button type=\"button\" onClick={handleAddCondition} variant=\"outline\" className=\"w-full sm:w-auto min-h-[44px]\">\n                  {t('patient_form.add')}\n                </Button>\n              </div>\n              {formData.medicalHistory.conditions.length > 0 && (\n                <div className=\"space-y-1\">\n                  {formData.medicalHistory.conditions.map((condition, index) => (\n                    <div key={index} className=\"flex items-center justify-between bg-gray-50 p-2 rounded\">\n                      <span>{condition}</span>\n                      <Button\n                         type=\"button\"\n                         variant=\"outline\"\n                         size=\"sm\"\n                         onClick={() => handleRemoveCondition(index)}\n                       >\n                         {t('patient_form.remove')}\n                       </Button>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <Textarea\n                label={t('patient_form.medical_notes')}\n                name=\"medicalHistory.notes\"\n                value={formData.medicalHistory.notes}\n                onChange={handleInputChange}\n                rows={4}\n                placeholder={t('patient_form.additional_medical_notes')}\n              />\n            </div>\n          </div>\n        </Card>\n\n        <div className=\"flex flex-col-reverse sm:flex-row justify-end gap-2 sm:gap-3 sticky bottom-0 bg-white py-4 -mx-4 px-4 sm:mx-0 sm:px-0 sm:static border-t sm:border-t-0 border-gray-200\">\n          <Link to=\"/patients\" className=\"flex-1 sm:flex-none\">\n            <Button type=\"button\" variant=\"outline\" className=\"w-full min-h-[44px]\">\n              {t('patient_form.cancel')}\n            </Button>\n          </Link>\n          <Button type=\"submit\" isLoading={isLoading} className=\"flex-1 sm:flex-none min-h-[44px]\">\n            {isEditMode ? t('patient_form.update_patient') : t('patient_form.create_patient')}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default PatientForm;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\PatientProfile.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2976,2979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2976,2979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3456,3459],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3456,3459],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport toast from 'react-hot-toast';\r\nimport { Card, Button, Badge, Avatar, Alert } from '../../components/ui';\r\nimport { useAuth } from '../../hooks/useAuth';\r\nimport { patientService } from '../../services/patientService';\r\nimport { appointmentService } from '../../services/appointmentService';\r\nimport type { Patient, Appointment } from '../../types';\r\nimport {\r\n  User,\r\n  Calendar,\r\n  Heart,\r\n  Phone,\r\n  Mail,\r\n  MapPin,\r\n  Clock,\r\n  FileText,\r\n  Activity,\r\n  Edit3,\r\n  Download,\r\n  Eye,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  XCircle,\r\n  Settings,\r\n  Camera\r\n} from 'lucide-react';\r\n\r\nconst PatientProfile: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [patient, setPatient] = useState<Patient>();\r\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n\r\n  // Navigation handlers\r\n  const handleEditProfile = () => {\r\n    navigate('/settings');\r\n  };\r\n\r\n  const handleBookAppointment = () => {\r\n    navigate('/appointments/create');\r\n  };\r\n\r\n  const handleViewAppointment = (appointmentId: string) => {\r\n    navigate(`/appointments/${appointmentId}`);\r\n  };\r\n\r\n  const handleAccountSettings = () => {\r\n    navigate('/settings');\r\n  };\r\n\r\n  const handleDownloadReports = () => {\r\n    toast('Report download feature coming soon', {\r\n      icon: '',\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchPatientData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        // Fetch patient data based on current user, avoiding non-null assertion after optional chain\r\n        const userId = user?.id;\r\n        if (!userId) {\r\n          console.warn('No authenticated user ID available');\r\n          setError('User not authenticated. Please sign in again.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        const patientData = await patientService.getPatientsByUserId(userId);\r\n        const patientRecord = patientData.data[0];\r\n        \r\n        if (!patientRecord) {\r\n          console.warn('No patient record found for user:', user?.id);\r\n          setError('Patient profile not found. Please contact support.');\r\n          return;\r\n        }\r\n        \r\n        setPatient(patientRecord);\r\n\r\n        // Fetch appointments for this patient using the fetched patient data\r\n        if (patientRecord?.id) {\r\n          try {\r\n            const appointmentsData = await appointmentService.getAppointments({\r\n              patientId: patientRecord.id\r\n            }) as { data: Appointment[] };\r\n            setAppointments(appointmentsData.data || []);\r\n          } catch (appointmentErr: any) {\r\n            // Log appointment fetch error but don't block profile display\r\n            console.error('Failed to fetch appointments:', appointmentErr);\r\n            // Set empty appointments array to allow profile to display\r\n            setAppointments([]);\r\n            // Show a toast notification instead of blocking the entire page\r\n            toast.error('Unable to load appointments. Please try refreshing the page.');\r\n          }\r\n        }\r\n      } catch (err: any) {\r\n        console.error('Error fetching patient data:', {\r\n          error: err,\r\n          message: err.message,\r\n          status: err.response?.status,\r\n          userId: user?.id\r\n        });\r\n        \r\n        // Handle specific error cases\r\n        if (err.response?.status === 401) {\r\n          setError('Your session has expired. Please log in again.');\r\n          // Redirect to login after a short delay\r\n          setTimeout(() => {\r\n            window.location.href = '/login';\r\n          }, 2000);\r\n        } else if (err.response?.status === 403) {\r\n          setError('You do not have permission to view this profile.');\r\n        } else if (err.response?.status === 404) {\r\n          setError('Patient profile not found. Please contact support.');\r\n        } else if (err.code === 'ERR_NETWORK' || err.message.includes('Network Error')) {\r\n          setError('Network error. Please check your internet connection and try again.');\r\n        } else {\r\n          setError(err.message || 'Failed to load patient data. Please try again later.');\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (user?.id) {\r\n      fetchPatientData();\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const calculateAge = (dateOfBirth: Date) => {\r\n    const today = new Date();\r\n    const birthDate = new Date(dateOfBirth);\r\n    let age = today.getFullYear() - birthDate.getFullYear();\r\n    const monthDiff = today.getMonth() - birthDate.getMonth();\r\n\r\n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\r\n      age--;\r\n    }\r\n\r\n    return age;\r\n  };\r\n\r\n  const getAppointmentStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'scheduled':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'confirmed':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'completed':\r\n        return 'bg-gray-100 text-gray-800';\r\n      case 'cancelled':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'no-show':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getAppointmentStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'scheduled':\r\n        return <Clock className=\"w-4 h-4\" />;\r\n      case 'confirmed':\r\n        return <CheckCircle className=\"w-4 h-4\" />;\r\n      case 'completed':\r\n        return <CheckCircle className=\"w-4 h-4\" />;\r\n      case 'cancelled':\r\n        return <XCircle className=\"w-4 h-4\" />;\r\n      case 'no-show':\r\n        return <AlertTriangle className=\"w-4 h-4\" />;\r\n      default:\r\n        return <Clock className=\"w-4 h-4\" />;\r\n    }\r\n  };\r\n\r\n  const upcomingAppointments = Array.isArray(appointments) ? appointments.filter(apt =>\r\n    new Date(apt.date) > new Date() && apt.status !== 'cancelled'\r\n  ).sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime()) : [];\r\n\r\n  const recentAppointments = Array.isArray(appointments) ? appointments.filter(apt =>\r\n    new Date(apt.date) <= new Date()\r\n  ).sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()).slice(0, 5) : [];\r\n\r\n  const tabs = [\r\n    { id: 'overview', label: t('patientProfile.overview'), icon: <User className=\"w-4 h-4\" /> },\r\n    { id: 'appointments', label: t('patientProfile.appointments'), icon: <Calendar className=\"w-4 h-4\" /> },\r\n    { id: 'medical', label: t('patientProfile.medical'), icon: <Heart className=\"w-4 h-4\" /> },\r\n    { id: 'documents', label: t('patientProfile.documents'), icon: <FileText className=\"w-4 h-4\" /> },\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">{t('patientProfile.loading')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !patient) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n        <Alert variant=\"error\" className=\"max-w-md\">\r\n          {error || t('patientProfile.profileNotFound')}\r\n        </Alert>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50\">\r\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          {/* Header */}\r\n          <div className=\"mb-6 sm:mb-8\">\r\n            <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 sm:gap-6\">\r\n              <div>\r\n                <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-2\">{t('patientProfile.title')}</h1>\r\n                <p className=\"text-base sm:text-lg lg:text-xl text-gray-600\">\r\n                  {t('patientProfile.subtitle')}\r\n                </p>\r\n              </div>\r\n              <div className=\"flex gap-3\">\r\n                <Button \r\n                  size=\"sm\" \r\n                  onClick={handleEditProfile} \r\n                  disabled={loading}\r\n                  className=\"min-h-[44px] min-w-[44px] touch-manipulation\"\r\n                >\r\n                  <Edit3 className=\"w-4 h-4 sm:mr-2\" />\r\n                  <span className=\"hidden sm:inline\">{t('patientProfile.editProfile')}</span>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Profile Header Card */}\r\n          <Card className=\"p-4 sm:p-6 lg:p-8 mb-6 sm:mb-8 bg-gradient-to-r from-white to-blue-50 border-0 shadow-xl\">\r\n            <div className=\"flex flex-col lg:flex-row items-center lg:items-start gap-6 sm:gap-8\">\r\n              {/* Avatar Section */}\r\n              <div className=\"relative flex-shrink-0\">\r\n                <div className=\"relative\">\r\n                  <Avatar\r\n                    src={user?.profileImage}\r\n                    alt={`${patient.firstName} ${patient.lastName}`}\r\n                    size=\"xl\"\r\n                    fallback={`${patient.firstName[0]}${patient.lastName[0]}`}\r\n                    className=\"ring-4 ring-white shadow-2xl w-24 h-24 sm:w-28 sm:h-28 lg:w-32 lg:h-32\"\r\n                  />\r\n                  <button \r\n                    onClick={handleEditProfile}\r\n                    className=\"absolute bottom-1 right-1 sm:bottom-2 sm:right-2 bg-blue-600 text-white rounded-full p-2 sm:p-3 hover:bg-blue-700 active:bg-blue-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px] min-w-[44px] touch-manipulation\"\r\n                    disabled={loading}\r\n                    aria-label=\"Edit profile picture\"\r\n                  >\r\n                    <Camera className=\"w-4 h-4\" />\r\n                  </button>\r\n                </div>\r\n                <div className=\"absolute -bottom-2 -right-2 bg-green-500 rounded-full p-1.5 sm:p-2\">\r\n                  <div className=\"w-2.5 h-2.5 sm:w-3 sm:h-3 bg-white rounded-full\"></div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Profile Info */}\r\n              <div className=\"flex-1 text-center lg:text-left w-full\">\r\n                <div className=\"mb-4 sm:mb-6\">\r\n                  <h2 className=\"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-2\">\r\n                    {patient.firstName} {patient.lastName}\r\n                  </h2>\r\n                  <div className=\"flex flex-wrap items-center justify-center lg:justify-start gap-2 sm:gap-3 mb-3\">\r\n                    <Badge className=\"bg-green-100 text-green-800 px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium\">\r\n                      {t('patientProfile.activePatient')}\r\n                    </Badge>\r\n                    <Badge className=\"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1 text-xs sm:text-sm\">\r\n                      {t('common.age')} {calculateAge(patient.dateOfBirth)}\r\n                    </Badge>\r\n                    <Badge className=\"bg-purple-100 text-purple-800 px-2 sm:px-3 py-1 text-xs sm:text-sm\">\r\n                      {patient.gender.charAt(0).toUpperCase() + patient.gender.slice(1)}\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Contact Info */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6\">\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <Mail className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm truncate\">{patient.email}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <Phone className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm\">{patient.phone}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <MapPin className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm\">{patient.address.city}, {patient.address.state}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-center lg:justify-start gap-2 text-gray-600\">\r\n                    <Calendar className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <span className=\"text-xs sm:text-sm\">Patient since {new Date(patient.createdAt).getFullYear()}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Quick Stats */}\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4 sm:gap-6\">\r\n                  <div className=\"text-center p-2 sm:p-0\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-blue-600 mb-1\">{Array.isArray(appointments) ? appointments.length : 0}</div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">{t('patientProfile.totalVisits')}</div>\r\n                  </div>\r\n                  <div className=\"text-center p-2 sm:p-0\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-green-600 mb-1\">{upcomingAppointments.length}</div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">{t('patientProfile.upcoming')}</div>\r\n                  </div>\r\n                  <div className=\"text-center p-2 sm:p-0\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-purple-600 mb-1\">\r\n                      {patient.medicalHistory.allergies.length}\r\n                    </div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">{t('patientProfile.allergies')}</div>\r\n                  </div>\r\n                  <div className=\"text-center p-2 sm:p-0\">\r\n                    <div className=\"text-xl sm:text-2xl font-bold text-orange-600 mb-1\">\r\n                      {patient.medicalHistory.conditions.length}\r\n                    </div>\r\n                    <div className=\"text-xs sm:text-sm text-gray-600\">{t('patientProfile.conditions')}</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n\r\n          {/* Tabs Navigation */}\r\n          <div className=\"mb-6 sm:mb-8\">\r\n            <div className=\"border-b border-gray-200 overflow-x-auto\">\r\n              <nav className=\"-mb-px flex space-x-4 sm:space-x-8 min-w-max sm:min-w-0\">\r\n                {tabs.map((tab) => (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() => setActiveTab(tab.id)}\r\n                    disabled={loading}\r\n                    className={`flex items-center gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px] touch-manipulation whitespace-nowrap ${activeTab === tab.id\r\n                      ? 'border-blue-500 text-blue-600'\r\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                      }`}\r\n                  >\r\n                    {tab.icon}\r\n                    <span className=\"hidden sm:inline\">{tab.label}</span>\r\n                  </button>\r\n                ))}\r\n              </nav>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Tab Content */}\r\n          <div className=\"space-y-6 sm:space-y-8\">\r\n            {activeTab === 'overview' && (\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8\">\r\n                {/* Main Content */}\r\n                <div className=\"lg:col-span-2 space-y-4 sm:space-y-6\">\r\n                  {/* Upcoming Appointments */}\r\n                  <Card className=\"p-4 sm:p-6\">\r\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4 sm:mb-6\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n                        <Calendar className=\"w-5 h-5 text-blue-600\" />\r\n                        Upcoming Appointments\r\n                      </h3>\r\n                      <Button \r\n                        size=\"sm\" \r\n                        onClick={handleBookAppointment} \r\n                        disabled={loading}\r\n                        className=\"min-h-[44px] touch-manipulation w-full sm:w-auto\"\r\n                      >\r\n                        <Calendar className=\"w-4 h-4 mr-2\" />\r\n                        Book New\r\n                      </Button>\r\n                    </div>\r\n\r\n                    {upcomingAppointments.length > 0 ? (\r\n                      <div className=\"space-y-3 sm:space-y-4\">\r\n                        {upcomingAppointments.slice(0, 3).map((appointment) => (\r\n                          <div key={appointment.id} className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 p-3 sm:p-4 bg-blue-50 rounded-lg\">\r\n                            <div className=\"flex items-start sm:items-center gap-3 sm:gap-4\">\r\n                              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0\">\r\n                                <Calendar className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1 min-w-0\">\r\n                                <p className=\"font-medium text-sm sm:text-base text-gray-900 break-words\">\r\n                                  {new Date(appointment.date).toLocaleDateString('en-US', {\r\n                                    weekday: 'short',\r\n                                    year: 'numeric',\r\n                                    month: 'short',\r\n                                    day: 'numeric'\r\n                                  })}\r\n                                </p>\r\n                                <p className=\"text-xs sm:text-sm text-gray-600\">\r\n                                  {appointment.timeSlot}  {appointment.serviceType || 'General Checkup'}\r\n                                </p>\r\n                                <p className=\"text-xs sm:text-sm text-gray-500\">\r\n                                  Dr. {appointment.dentistName || 'TBD'}\r\n                                </p>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 sm:gap-3 flex-wrap sm:flex-nowrap\">\r\n                              <Badge className={`${getAppointmentStatusColor(appointment.status)} text-xs`}>\r\n                                {getAppointmentStatusIcon(appointment.status)}\r\n                                <span className=\"ml-1 capitalize\">{appointment.status}</span>\r\n                              </Badge>\r\n                              <Button \r\n                                size=\"sm\" \r\n                                variant=\"outline\" \r\n                                onClick={() => handleViewAppointment(appointment.id)} \r\n                                disabled={loading}\r\n                                className=\"min-h-[44px] touch-manipulation\"\r\n                              >\r\n                                <Eye className=\"w-4 h-4 sm:mr-1\" />\r\n                                <span className=\"hidden sm:inline\">View</span>\r\n                              </Button>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"text-center py-6 sm:py-8\">\r\n                        <Calendar className=\"w-10 h-10 sm:w-12 sm:h-12 text-gray-400 mx-auto mb-4\" />\r\n                        <p className=\"text-sm sm:text-base text-gray-600 mb-4\">No upcoming appointments</p>\r\n                        <Button \r\n                          onClick={handleBookAppointment} \r\n                          disabled={loading}\r\n                          className=\"min-h-[44px] touch-manipulation\"\r\n                        >\r\n                          <Calendar className=\"w-4 h-4 mr-2\" />\r\n                          Schedule Your Next Visit\r\n                        </Button>\r\n                      </div>\r\n                    )}\r\n                  </Card>\r\n\r\n                  {/* Recent Activity */}\r\n                  <Card className=\"p-4 sm:p-6\">\r\n                    <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6 flex items-center gap-2\">\r\n                      <Activity className=\"w-5 h-5 text-green-600\" />\r\n                      Recent Visits\r\n                    </h3>\r\n\r\n                    {recentAppointments.length > 0 ? (\r\n                      <div className=\"space-y-3 sm:space-y-4\">\r\n                        {recentAppointments.map((appointment) => (\r\n                          <div key={appointment.id} className=\"flex items-center gap-3 sm:gap-4 p-3 bg-gray-50 rounded-lg\">\r\n                            <div className={`w-2 h-2 rounded-full flex-shrink-0 ${appointment.status === 'completed' ? 'bg-green-500' :\r\n                              appointment.status === 'cancelled' ? 'bg-red-500' : 'bg-gray-500'\r\n                              }`}></div>\r\n                            <div className=\"flex-1 min-w-0\">\r\n                              <p className=\"font-medium text-sm sm:text-base text-gray-900 truncate\">\r\n                                {appointment.serviceType || 'Dental Visit'}\r\n                              </p>\r\n                              <p className=\"text-xs sm:text-sm text-gray-600\">\r\n                                {new Date(appointment.date).toLocaleDateString()}  Dr. {appointment.dentistName || 'Unknown'}\r\n                              </p>\r\n                            </div>\r\n                            <Badge className={`${getAppointmentStatusColor(appointment.status)} text-xs flex-shrink-0`}>\r\n                              {appointment.status}\r\n                            </Badge>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    ) : (\r\n                      <p className=\"text-sm sm:text-base text-gray-600 text-center py-4\">No recent visits</p>\r\n                    )}\r\n                  </Card>\r\n                </div>\r\n\r\n                {/* Sidebar */}\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  {/* Quick Actions */}\r\n                  <Card className=\"p-4 sm:p-6\">\r\n                    <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4\">Quick Actions</h3>\r\n                    <div className=\"space-y-2 sm:space-y-3\">\r\n                      <Button \r\n                        className=\"w-full justify-start min-h-[44px] touch-manipulation\" \r\n                        variant=\"outline\" \r\n                        onClick={handleBookAppointment} \r\n                        disabled={loading}\r\n                      >\r\n                        <Calendar className=\"w-4 h-4 mr-2 flex-shrink-0\" />\r\n                        <span className=\"text-sm sm:text-base\">Book Appointment</span>\r\n                      </Button>\r\n                      <Button \r\n                        className=\"w-full justify-start min-h-[44px] touch-manipulation\" \r\n                        variant=\"outline\" \r\n                        onClick={() => setActiveTab('documents')} \r\n                        disabled={loading}\r\n                      >\r\n                        <FileText className=\"w-4 h-4 mr-2 flex-shrink-0\" />\r\n                        <span className=\"text-sm sm:text-base\">View Records</span>\r\n                      </Button>\r\n                      <Button \r\n                        className=\"w-full justify-start min-h-[44px] touch-manipulation\" \r\n                        variant=\"outline\" \r\n                        onClick={handleDownloadReports} \r\n                        disabled={loading}\r\n                      >\r\n                        <Download className=\"w-4 h-4 mr-2 flex-shrink-0\" />\r\n                        <span className=\"text-sm sm:text-base\">Download Reports</span>\r\n                      </Button>\r\n                      <Button \r\n                        className=\"w-full justify-start min-h-[44px] touch-manipulation\" \r\n                        variant=\"outline\" \r\n                        onClick={handleAccountSettings} \r\n                        disabled={loading}\r\n                      >\r\n                        <Settings className=\"w-4 h-4 mr-2 flex-shrink-0\" />\r\n                        <span className=\"text-sm sm:text-base\">Account Settings</span>\r\n                      </Button>\r\n                    </div>\r\n                  </Card>\r\n\r\n                  {/* Health Summary */}\r\n                  <Card className=\"p-4 sm:p-6\">\r\n                    <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4\">Health Summary</h3>\r\n                    <div className=\"space-y-3 sm:space-y-4\">\r\n                      <div className=\"flex items-center justify-between gap-2\">\r\n                        <span className=\"text-xs sm:text-sm text-gray-600\">Last Checkup</span>\r\n                        <span className=\"text-xs sm:text-sm font-medium text-right\">\r\n                          {recentAppointments.length > 0\r\n                            ? new Date(recentAppointments[0].date).toLocaleDateString()\r\n                            : 'No records'\r\n                          }\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"flex items-center justify-between gap-2\">\r\n                        <span className=\"text-xs sm:text-sm text-gray-600\">Next Due</span>\r\n                        <span className=\"text-xs sm:text-sm font-medium text-blue-600 text-right\">\r\n                          {upcomingAppointments.length > 0\r\n                            ? new Date(upcomingAppointments[0].date).toLocaleDateString()\r\n                            : 'Schedule now'\r\n                          }\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"flex items-center justify-between gap-2\">\r\n                        <span className=\"text-xs sm:text-sm text-gray-600\">Allergies</span>\r\n                        <Badge className={`${patient.medicalHistory.allergies.length > 0 ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'} text-xs`}>\r\n                          {patient.medicalHistory.allergies.length > 0 ? `${patient.medicalHistory.allergies.length} recorded` : 'None'}\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n                  </Card>\r\n\r\n                  {/* Emergency Contact */}\r\n                  {patient.emergencyContact && (\r\n                    <Card className=\"p-4 sm:p-6\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4\">Emergency Contact</h3>\r\n                      <div className=\"space-y-2\">\r\n                        <p className=\"font-medium text-sm sm:text-base\">{patient.emergencyContact.name}</p>\r\n                        <p className=\"text-xs sm:text-sm text-gray-600\">{patient.emergencyContact.relationship}</p>\r\n                        <p className=\"text-xs sm:text-sm text-gray-600\">{patient.emergencyContact.phone}</p>\r\n                      </div>\r\n                    </Card>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'appointments' && (\r\n              <Card className=\"p-4 sm:p-6\">\r\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4 sm:mb-6\">\r\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900\">All Appointments</h3>\r\n                  <Button \r\n                    onClick={handleBookAppointment} \r\n                    disabled={loading}\r\n                    className=\"min-h-[44px] touch-manipulation w-full sm:w-auto\"\r\n                  >\r\n                    <Calendar className=\"w-4 h-4 mr-2\" />\r\n                    Book New Appointment\r\n                  </Button>\r\n                </div>\r\n\r\n                {/* Mobile: Card Layout */}\r\n                <div className=\"block md:hidden space-y-3\">\r\n                  {(Array.isArray(appointments) ? appointments : []).sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()).map((appointment) => (\r\n                    <div key={appointment.id} className=\"p-4 bg-gray-50 rounded-lg space-y-2\">\r\n                      <div className=\"flex items-start justify-between gap-2\">\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className=\"font-medium text-sm text-gray-900\">\r\n                            {new Date(appointment.date).toLocaleDateString()}\r\n                          </p>\r\n                          <p className=\"text-xs text-gray-600\">{appointment.timeSlot}</p>\r\n                        </div>\r\n                        <Badge className={`${getAppointmentStatusColor(appointment.status)} text-xs flex-shrink-0`}>\r\n                          {appointment.status}\r\n                        </Badge>\r\n                      </div>\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"text-sm text-gray-900\">{appointment.serviceType || 'General Checkup'}</p>\r\n                        <p className=\"text-xs text-gray-600\">Dr. {appointment.dentistName || 'TBD'}</p>\r\n                      </div>\r\n                      <Button \r\n                        size=\"sm\" \r\n                        variant=\"outline\" \r\n                        onClick={() => handleViewAppointment(appointment.id)} \r\n                        disabled={loading}\r\n                        className=\"w-full min-h-[44px] touch-manipulation\"\r\n                      >\r\n                        <Eye className=\"w-4 h-4 mr-1\" />\r\n                        View Details\r\n                      </Button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Tablet/Desktop: Table Layout */}\r\n                <div className=\"hidden md:block overflow-x-auto\">\r\n                  <table className=\"min-w-full divide-y divide-gray-200\">\r\n                    <thead className=\"bg-gray-50\">\r\n                      <tr>\r\n                        <th className=\"px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Date</th>\r\n                        <th className=\"px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Time</th>\r\n                        <th className=\"px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Service</th>\r\n                        <th className=\"px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Doctor</th>\r\n                        <th className=\"px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\r\n                        <th className=\"px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                      {(Array.isArray(appointments) ? appointments : []).sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()).map((appointment) => (\r\n                        <tr key={appointment.id}>\r\n                          <td className=\"px-4 lg:px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                            {new Date(appointment.date).toLocaleDateString()}\r\n                          </td>\r\n                          <td className=\"px-4 lg:px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                            {appointment.timeSlot}\r\n                          </td>\r\n                          <td className=\"px-4 lg:px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                            {appointment.serviceType || 'General Checkup'}\r\n                          </td>\r\n                          <td className=\"px-4 lg:px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                            Dr. {appointment.dentistName || 'TBD'}\r\n                          </td>\r\n                          <td className=\"px-4 lg:px-6 py-4 whitespace-nowrap\">\r\n                            <Badge className={`${getAppointmentStatusColor(appointment.status)} text-xs`}>\r\n                              {appointment.status}\r\n                            </Badge>\r\n                          </td>\r\n                          <td className=\"px-4 lg:px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                            <Button \r\n                              size=\"sm\" \r\n                              variant=\"outline\" \r\n                              onClick={() => handleViewAppointment(appointment.id)} \r\n                              disabled={loading}\r\n                              className=\"min-h-[44px] touch-manipulation\"\r\n                            >\r\n                              <Eye className=\"w-4 h-4 mr-1\" />\r\n                              View\r\n                            </Button>\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </Card>\r\n            )}\r\n\r\n            {activeTab === 'medical' && (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 lg:gap-8\">\r\n                <Card className=\"p-4 sm:p-6\">\r\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\r\n                    <AlertTriangle className=\"w-5 h-5 text-red-600 flex-shrink-0\" />\r\n                    Allergies\r\n                  </h3>\r\n                  {patient.medicalHistory.allergies.length > 0 ? (\r\n                    <div className=\"space-y-2\">\r\n                      {patient.medicalHistory.allergies.map((allergy, index) => (\r\n                        <div key={index} className=\"flex items-center gap-2 p-2 sm:p-3 bg-red-50 rounded-lg\">\r\n                          <AlertTriangle className=\"w-4 h-4 text-red-600 flex-shrink-0\" />\r\n                          <span className=\"text-xs sm:text-sm text-red-800 break-words\">{allergy}</span>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <p className=\"text-sm sm:text-base text-gray-600\">No known allergies</p>\r\n                  )}\r\n                </Card>\r\n\r\n                <Card className=\"p-4 sm:p-6\">\r\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\r\n                    <Heart className=\"w-5 h-5 text-blue-600 flex-shrink-0\" />\r\n                    Medical Conditions\r\n                  </h3>\r\n                  {patient.medicalHistory.conditions.length > 0 ? (\r\n                    <div className=\"space-y-2\">\r\n                      {patient.medicalHistory.conditions.map((condition, index) => (\r\n                        <div key={index} className=\"flex items-center gap-2 p-2 sm:p-3 bg-blue-50 rounded-lg\">\r\n                          <Heart className=\"w-4 h-4 text-blue-600 flex-shrink-0\" />\r\n                          <span className=\"text-xs sm:text-sm text-blue-800 break-words\">{condition}</span>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <p className=\"text-sm sm:text-base text-gray-600\">No medical conditions recorded</p>\r\n                  )}\r\n                </Card>\r\n\r\n                <Card className=\"p-4 sm:p-6 md:col-span-2\">\r\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\r\n                    <FileText className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\r\n                    Medical Notes\r\n                  </h3>\r\n                  {patient.medicalHistory.notes ? (\r\n                    <div className=\"p-3 sm:p-4 bg-gray-50 rounded-lg\">\r\n                      <p className=\"text-xs sm:text-sm text-gray-700 break-words\">{patient.medicalHistory.notes}</p>\r\n                    </div>\r\n                  ) : (\r\n                    <p className=\"text-sm sm:text-base text-gray-600\">No medical notes available</p>\r\n                  )}\r\n                </Card>\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'documents' && (\r\n              <Card className=\"p-4 sm:p-6\">\r\n                <h3 className=\"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6\">Medical Documents</h3>\r\n                <div className=\"text-center py-8 sm:py-12\">\r\n                  <FileText className=\"w-12 h-12 sm:w-16 sm:h-16 text-gray-400 mx-auto mb-4\" />\r\n                  <p className=\"text-sm sm:text-base text-gray-600 mb-4\">No documents available yet</p>\r\n                  <p className=\"text-xs sm:text-sm text-gray-500 px-4\">\r\n                    Your medical reports, X-rays, and treatment plans will appear here\r\n                  </p>\r\n                </div>\r\n              </Card>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatientProfile;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\PatientSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":136,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4826,4829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4826,4829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":305,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10034,10037],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10034,10037],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":313,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":313,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10346,10349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10346,10349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":438,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":438,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14594,14597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14594,14597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":534,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":534,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18303,18306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18303,18306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport toast from 'react-hot-toast';\r\nimport { Card, Button, Input, Select, Alert, Avatar, Badge } from '../../components/ui';\r\nimport { useAuth } from '../../hooks/useAuth';\r\nimport { patientService } from '../../services/patientService';\r\nimport { userService } from '../../services/userService';\r\nimport type { Patient } from '../../types';\r\nimport {\r\n  User,\r\n  Mail,\r\n  Phone,\r\n  MapPin,\r\n  Shield,\r\n  Save,\r\n  X,\r\n  Check,\r\n  AlertCircle,\r\n  Camera,\r\n  Heart,\r\n  Settings} from 'lucide-react';\r\nimport { validateEmail, validatePhone, validateRequired, validateZipCode, validateDate } from '../../utils/validation';\r\n\r\nconst PatientSettings: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const { user, refreshUser, changePassword } = useAuth();\r\n  const [loading, setLoading] = useState(false);\r\n  const [uploadingImage, setUploadingImage] = useState(false);\r\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  const [activeSection, setActiveSection] = useState('personal');\r\n  const [showPasswordFields, setShowPasswordFields] = useState(false);\r\n  const [patient, setPatient] = useState<Patient | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const [formData, setFormData] = useState({\r\n    firstName: '',\r\n    lastName: '',\r\n    email: '',\r\n    phone: '',\r\n    dateOfBirth: '',\r\n    gender: 'male',\r\n    address: {\r\n      street: '',\r\n      city: '',\r\n      state: '',\r\n      zipCode: '',\r\n      country: 'Egypt'\r\n    },\r\n    emergencyContact: {\r\n      name: '',\r\n      phone: '',\r\n      relationship: ''\r\n    },\r\n    medicalHistory: {\r\n      allergies: [] as string[],\r\n      conditions: [] as string[],\r\n      medications: [] as string[],\r\n      notes: ''\r\n    }\r\n  });\r\n\r\n  const [passwordData, setPasswordData] = useState({\r\n    currentPassword: '',\r\n    newPassword: '',\r\n    confirmPassword: ''\r\n  });\r\n\r\n  const [preferences, setPreferences] = useState({\r\n    emailNotifications: true,\r\n    smsNotifications: true,\r\n    appointmentReminders: true,\r\n    healthTips: false,\r\n    language: 'en',\r\n    timezone: 'Africa/Cairo'\r\n  });\r\n\r\n  const [newAllergy, setNewAllergy] = useState('');\r\n  const [newCondition, setNewCondition] = useState('');\r\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\r\n\r\n  useEffect(() => {\r\n    const fetchPatientData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setMessage(null);\r\n        \r\n        const userId = user?.id;\r\n        if (!userId) {\r\n          console.warn('No authenticated user ID available');\r\n          toast.error('User not authenticated. Please sign in again.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        const patientData = await patientService.getPatientsByUserId(userId);\r\n        const patientRecord = patientData.data?.[0];\r\n        \r\n        if (!patientRecord) {\r\n          console.warn('No patient record found for user:', user?.id);\r\n          const errorMsg = 'Patient profile not found. Please contact support.';\r\n          toast.error(errorMsg);\r\n          setMessage({ type: 'error', text: errorMsg });\r\n          return;\r\n        }\r\n        \r\n        setPatient(patientRecord);\r\n        \r\n        // Populate form data if patient record exists\r\n        if (patientRecord) {\r\n          setFormData({\r\n            firstName: patientRecord.firstName || '',\r\n            lastName: patientRecord.lastName || '',\r\n            email: patientRecord.email || '',\r\n            phone: patientRecord.phone || '',\r\n            dateOfBirth: patientRecord.dateOfBirth ? new Date(patientRecord.dateOfBirth).toISOString().split('T')[0] : '',\r\n            gender: patientRecord.gender || 'male',\r\n            address: {\r\n              street: patientRecord.address?.street || '',\r\n              city: patientRecord.address?.city || '',\r\n              state: patientRecord.address?.state || '',\r\n              zipCode: patientRecord.address?.zipCode || '',\r\n              country: patientRecord.address?.country || 'Egypt'\r\n            },\r\n            emergencyContact: {\r\n              name: patientRecord.emergencyContact?.name || '',\r\n              phone: patientRecord.emergencyContact?.phone || '',\r\n              relationship: patientRecord.emergencyContact?.relationship || ''\r\n            },\r\n            medicalHistory: {\r\n              allergies: patientRecord.medicalHistory?.allergies || [],\r\n              conditions: patientRecord.medicalHistory?.conditions || [],\r\n              medications: patientRecord.medicalHistory?.medications || [],\r\n              notes: patientRecord.medicalHistory?.notes || ''\r\n            }\r\n          });\r\n        }\r\n      } catch (err: any) {\r\n        console.error('Error fetching patient data:', {\r\n          error: err,\r\n          message: err.message,\r\n          status: err.response?.status,\r\n          userId: user?.id\r\n        });\r\n        \r\n        let errorMsg = 'Failed to load patient data';\r\n        \r\n        // Handle specific error cases\r\n        if (err.response?.status === 401) {\r\n          errorMsg = 'Your session has expired. Please log in again.';\r\n          toast.error(errorMsg);\r\n          setMessage({ type: 'error', text: errorMsg });\r\n          // Redirect to login after a short delay\r\n          setTimeout(() => {\r\n            window.location.href = '/login';\r\n          }, 2000);\r\n        } else if (err.response?.status === 403) {\r\n          errorMsg = 'You do not have permission to access this page.';\r\n          toast.error(errorMsg);\r\n          setMessage({ type: 'error', text: errorMsg });\r\n        } else if (err.response?.status === 404) {\r\n          errorMsg = 'Patient profile not found. Please contact support.';\r\n          toast.error(errorMsg);\r\n          setMessage({ type: 'error', text: errorMsg });\r\n        } else if (err.code === 'ERR_NETWORK' || err.message.includes('Network Error')) {\r\n          errorMsg = 'Network error. Please check your internet connection and try again.';\r\n          toast.error(errorMsg);\r\n          setMessage({ type: 'error', text: errorMsg });\r\n        } else {\r\n          errorMsg = err.message || errorMsg;\r\n          toast.error(errorMsg);\r\n          setMessage({ type: 'error', text: errorMsg });\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (user?.id) {\r\n      fetchPatientData();\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const handleInputChange = (field: string, value: string) => {\r\n    // Clear validation error for this field when user starts typing\r\n    if (validationErrors[field]) {\r\n      setValidationErrors(prev => {\r\n        const newErrors = { ...prev };\r\n        delete newErrors[field];\r\n        return newErrors;\r\n      });\r\n    }\r\n\r\n    if (field.startsWith('address.')) {\r\n      const addressField = field.split('.')[1];\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        address: {\r\n          ...prev.address,\r\n          [addressField]: value\r\n        }\r\n      }));\r\n    } else if (field.startsWith('emergencyContact.')) {\r\n      const contactField = field.split('.')[1];\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        emergencyContact: {\r\n          ...prev.emergencyContact,\r\n          [contactField]: value\r\n        }\r\n      }));\r\n    } else if (field === 'medicalHistory.notes') {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        medicalHistory: {\r\n          ...prev.medicalHistory,\r\n          notes: value\r\n        }\r\n      }));\r\n    } else {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        [field]: value\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleAddAllergy = () => {\r\n    if (newAllergy.trim()) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        medicalHistory: {\r\n          ...prev.medicalHistory,\r\n          allergies: [...prev.medicalHistory.allergies, newAllergy.trim()]\r\n        }\r\n      }));\r\n      setNewAllergy('');\r\n    }\r\n  };\r\n\r\n  const handleRemoveAllergy = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      medicalHistory: {\r\n        ...prev.medicalHistory,\r\n        allergies: prev.medicalHistory.allergies.filter((_, i) => i !== index)\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleAddCondition = () => {\r\n    if (newCondition.trim()) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        medicalHistory: {\r\n          ...prev.medicalHistory,\r\n          conditions: [...prev.medicalHistory.conditions, newCondition.trim()]\r\n        }\r\n      }));\r\n      setNewCondition('');\r\n    }\r\n  };\r\n\r\n  const handleRemoveCondition = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      medicalHistory: {\r\n        ...prev.medicalHistory,\r\n        conditions: prev.medicalHistory.conditions.filter((_, i) => i !== index)\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleProfilePictureUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    // Validate file size (5MB limit)\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      const errorMsg = 'File size must be less than 5MB';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    // Validate file type\r\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];\r\n    if (!validTypes.includes(file.type)) {\r\n      const errorMsg = 'Please upload a valid image file (JPG, PNG, or GIF)';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setUploadingImage(true);\r\n      setMessage(null);\r\n      \r\n      await userService.uploadProfileImage(file);\r\n      toast.success('Profile picture updated successfully');\r\n      setMessage({ type: 'success', text: 'Profile picture updated successfully' });\r\n      \r\n      // Refresh user context to show new image\r\n      if (refreshUser) {\r\n        try {\r\n          await refreshUser();\r\n        } catch (refreshErr: any) {\r\n          console.error('Failed to refresh user after image upload:', refreshErr);\r\n          // Don't show error to user as the upload was successful\r\n        }\r\n      }\r\n      \r\n      // Auto-dismiss success message after 3 seconds\r\n      setTimeout(() => setMessage(null), 3000);\r\n    } catch (error: any) {\r\n      console.error('Error uploading profile picture:', {\r\n        error,\r\n        message: error.message,\r\n        status: error.response?.status\r\n      });\r\n      \r\n      let errorMsg = 'Failed to upload profile picture';\r\n      \r\n      // Handle specific error cases\r\n      if (error.response?.status === 401) {\r\n        errorMsg = 'Your session has expired. Please log in again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n        setTimeout(() => {\r\n          window.location.href = '/login';\r\n        }, 2000);\r\n      } else if (error.response?.status === 413) {\r\n        errorMsg = 'File is too large. Please upload a smaller image.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else if (error.code === 'ERR_NETWORK' || error.message.includes('Network Error')) {\r\n        errorMsg = 'Network error. Please check your internet connection and try again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else {\r\n        errorMsg = error.message || errorMsg;\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      }\r\n    } finally {\r\n      setUploadingImage(false);\r\n      // Reset file input\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  const validateForm = (): boolean => {\r\n    const errors: Record<string, string> = {};\r\n\r\n    // Validate required fields\r\n    const firstNameValidation = validateRequired(formData.firstName, 'First name');\r\n    if (!firstNameValidation.isValid) {\r\n      errors.firstName = firstNameValidation.error!;\r\n    }\r\n\r\n    const lastNameValidation = validateRequired(formData.lastName, 'Last name');\r\n    if (!lastNameValidation.isValid) {\r\n      errors.lastName = lastNameValidation.error!;\r\n    }\r\n\r\n    // Validate email\r\n    const emailValidation = validateEmail(formData.email);\r\n    if (!emailValidation.isValid) {\r\n      errors.email = emailValidation.error!;\r\n    }\r\n\r\n    // Validate phone\r\n    const phoneValidation = validatePhone(formData.phone);\r\n    if (!phoneValidation.isValid) {\r\n      errors.phone = phoneValidation.error!;\r\n    }\r\n\r\n    // Validate date of birth\r\n    const dobValidation = validateDate(formData.dateOfBirth, 'Date of birth');\r\n    if (!dobValidation.isValid) {\r\n      errors.dateOfBirth = dobValidation.error!;\r\n    }\r\n\r\n    // Validate ZIP code\r\n    const zipValidation = validateZipCode(formData.address.zipCode);\r\n    if (!zipValidation.isValid) {\r\n      errors['address.zipCode'] = zipValidation.error!;\r\n    }\r\n\r\n    // Validate emergency contact phone if provided\r\n    if (formData.emergencyContact.phone) {\r\n      const emergencyPhoneValidation = validatePhone(formData.emergencyContact.phone);\r\n      if (!emergencyPhoneValidation.isValid) {\r\n        errors['emergencyContact.phone'] = emergencyPhoneValidation.error!;\r\n      }\r\n    }\r\n\r\n    setValidationErrors(errors);\r\n    return Object.keys(errors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setMessage(null);\r\n    console.log(formData);\r\n\r\n    // Validate form before submission\r\n    if (!validateForm()) {\r\n      const errorMsg = 'Please fix the validation errors before submitting';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    if (!patient?.id) {\r\n      const errorMsg = 'Patient ID not found. Please refresh the page and try again.';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const updateData = {\r\n        ...formData,\r\n        dateOfBirth: new Date(formData.dateOfBirth),\r\n        gender: formData.gender as 'male' | 'female' | 'other',\r\n        id: patient?.id\r\n      };\r\n      \r\n      await patientService.updatePatient(patient.id, updateData);\r\n      toast.success('Profile updated successfully!');\r\n      setMessage({ type: 'success', text: 'Profile updated successfully!' });\r\n      \r\n      // Auto-dismiss success message after 3 seconds\r\n      setTimeout(() => setMessage(null), 3000);\r\n    } catch (err: any) {\r\n      console.error('Error updating patient profile:', {\r\n        error: err,\r\n        message: err.message,\r\n        status: err.response?.status,\r\n        patientId: patient?.id\r\n      });\r\n      \r\n      let errorMsg = 'Failed to update profile';\r\n      \r\n      // Handle specific error cases\r\n      if (err.response?.status === 401) {\r\n        errorMsg = 'Your session has expired. Please log in again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n        setTimeout(() => {\r\n          window.location.href = '/login';\r\n        }, 2000);\r\n      } else if (err.response?.status === 403) {\r\n        errorMsg = 'You do not have permission to update this profile.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else if (err.response?.status === 404) {\r\n        errorMsg = 'Patient profile not found. Please refresh the page and try again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else if (err.response?.status === 422) {\r\n        errorMsg = 'Invalid data provided. Please check your inputs and try again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else if (err.code === 'ERR_NETWORK' || err.message.includes('Network Error')) {\r\n        errorMsg = 'Network error. Please check your internet connection and try again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else {\r\n        errorMsg = err.message || errorMsg;\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePasswordChange = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setMessage(null);\r\n    \r\n    // Validation: Check if current password is provided\r\n    if (!passwordData.currentPassword) {\r\n      const errorMsg = 'Current password is required';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    // Validation: Check if passwords match\r\n    if (passwordData.newPassword !== passwordData.confirmPassword) {\r\n      const errorMsg = 'New passwords do not match';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    // Validation: Check password length (min 8 characters)\r\n    if (passwordData.newPassword.length < 8) {\r\n      const errorMsg = 'Password must be at least 8 characters long';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    // Validation: Check if new password is different from current\r\n    if (passwordData.currentPassword === passwordData.newPassword) {\r\n      const errorMsg = 'New password must be different from current password';\r\n      toast.error(errorMsg);\r\n      setMessage({ type: 'error', text: errorMsg });\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    try {\r\n      // Call the changePassword method from useAuth hook\r\n      await changePassword(passwordData.currentPassword, passwordData.newPassword);\r\n      \r\n      toast.success('Password updated successfully');\r\n      setMessage({ type: 'success', text: 'Password updated successfully' });\r\n      \r\n      // Clear password fields on success\r\n      setPasswordData({ currentPassword: '', newPassword: '', confirmPassword: '' });\r\n      \r\n      // Hide password fields on success\r\n      setShowPasswordFields(false);\r\n      \r\n      // Auto-dismiss success message after 3 seconds\r\n      setTimeout(() => setMessage(null), 3000);\r\n    } catch (error: any) {\r\n      console.error('Error changing password:', {\r\n        error,\r\n        message: error.message,\r\n        status: error.response?.status\r\n      });\r\n      \r\n      let errorMsg = 'Failed to update password';\r\n      \r\n      // Handle specific error cases\r\n      if (error.response?.status === 401) {\r\n        errorMsg = 'Current password is incorrect. Please try again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else if (error.response?.status === 403) {\r\n        errorMsg = 'Your session has expired. Please log in again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n        setTimeout(() => {\r\n          window.location.href = '/login';\r\n        }, 2000);\r\n      } else if (error.response?.status === 422) {\r\n        errorMsg = 'Password does not meet security requirements. Please use a stronger password.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else if (error.code === 'ERR_NETWORK' || error.message.includes('Network Error')) {\r\n        errorMsg = 'Network error. Please check your internet connection and try again.';\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      } else {\r\n        errorMsg = error.message || errorMsg;\r\n        toast.error(errorMsg);\r\n        setMessage({ type: 'error', text: errorMsg });\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const genderOptions = [\r\n    { value: 'male', label: 'Male' },\r\n    { value: 'female', label: 'Female' },\r\n    { value: 'other', label: 'Other' }\r\n  ];\r\n\r\n  const stateOptions = [\r\n    { value: '', label: 'Select State/Province' },\r\n    { value: 'Cairo', label: 'Cairo' },\r\n    { value: 'Alexandria', label: 'Alexandria' },\r\n    { value: 'Giza', label: 'Giza' },\r\n    { value: 'Fayoum', label: 'Fayoum' },\r\n    { value: 'Aswan', label: 'Aswan' },\r\n    { value: 'Luxor', label: 'Luxor' },\r\n    { value: 'Minya', label: 'Minya' },\r\n    { value: 'Sohag', label: 'Sohag' },\r\n    { value: 'Qena', label: 'Qena' },\r\n    { value: 'Beni Suef', label: 'Beni Suef' }\r\n  ];\r\n\r\n  const relationshipOptions = [\r\n    { value: '', label: 'Select Relationship' },\r\n    { value: 'spouse', label: 'Spouse' },\r\n    { value: 'parent', label: 'Parent' },\r\n    { value: 'child', label: 'Child' },\r\n    { value: 'sibling', label: 'Sibling' },\r\n    { value: 'friend', label: 'Friend' },\r\n    { value: 'other', label: 'Other' }\r\n  ];\r\n\r\n  const sections = [\r\n    { id: 'personal', label: t('patientSettings.personalInformation'), icon: <User className=\"w-4 h-4\" /> },\r\n    { id: 'contact', label: t('patientSettings.contactDetails'), icon: <Mail className=\"w-4 h-4\" /> },\r\n    { id: 'address', label: t('patientSettings.addressInformation'), icon: <MapPin className=\"w-4 h-4\" /> },\r\n    { id: 'emergency', label: t('patientSettings.emergencyContact'), icon: <Phone className=\"w-4 h-4\" /> },\r\n    { id: 'medical', label: t('patientSettings.medicalInformation'), icon: <Heart className=\"w-4 h-4\" /> },\r\n    { id: 'security', label: t('patientSettings.security'), icon: <Shield className=\"w-4 h-4\" /> },\r\n    { id: 'preferences', label: t('patientSettings.preferences'), icon: <Settings className=\"w-4 h-4\" /> }\r\n  ];\r\n\r\n  if (loading && !patient) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">{t('patientSettings.loading')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50\">\r\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          {/* Header */}\r\n          <div className=\"mb-6 sm:mb-8\">\r\n            <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 sm:gap-6\">\r\n              <div>\r\n                <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-2\">{t('patientSettings.title')}</h1>\r\n                <p className=\"text-base sm:text-lg lg:text-xl text-gray-600\">\r\n                  {t('patientSettings.subtitle')}\r\n                </p>\r\n              </div>\r\n              <div className=\"flex gap-3\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Profile Header Card */}\r\n          <Card className=\"p-4 sm:p-6 lg:p-8 mb-6 sm:mb-8 bg-gradient-to-r from-white to-blue-50 border-0 shadow-xl\">\r\n            <div className=\"flex flex-col lg:flex-row items-center lg:items-start gap-4 sm:gap-6 lg:gap-8\">\r\n              <div className=\"relative\">\r\n                <div className=\"relative\">\r\n                  <Avatar\r\n                    src={user?.profileImage}\r\n                    alt={`${formData.firstName} ${formData.lastName}`}\r\n                    size=\"xl\"\r\n                    fallback={`${formData.firstName[0] || ''}${formData.lastName[0] || ''}`}\r\n                    className=\"ring-4 ring-white shadow-2xl w-24 h-24 sm:w-28 sm:h-28 lg:w-32 lg:h-32\"\r\n                  />\r\n                  <input\r\n                    ref={fileInputRef}\r\n                    type=\"file\"\r\n                    accept=\"image/jpeg,image/jpg,image/png,image/gif\"\r\n                    onChange={handleProfilePictureUpload}\r\n                    className=\"hidden\"\r\n                  />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => fileInputRef.current?.click()}\r\n                    disabled={uploadingImage || loading}\r\n                    className=\"absolute bottom-1 right-1 sm:bottom-2 sm:right-2 bg-blue-600 text-white rounded-full p-2 sm:p-3 hover:bg-blue-700 active:bg-blue-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none min-w-[44px] min-h-[44px] flex items-center justify-center\"\r\n                  >\r\n                    {uploadingImage ? (\r\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n                    ) : (\r\n                      <Camera className=\"w-4 h-4 sm:w-5 sm:h-5\" />\r\n                    )}\r\n                  </button>\r\n                </div>\r\n                <div className=\"absolute -bottom-2 -right-2 bg-green-500 rounded-full p-1.5 sm:p-2\">\r\n                  <div className=\"w-2 h-2 sm:w-3 sm:h-3 bg-white rounded-full\"></div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"flex-1 text-center lg:text-left\">\r\n                <div className=\"mb-4\">\r\n                  <h2 className=\"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-2\">\r\n                    {formData.firstName} {formData.lastName}\r\n                  </h2>\r\n                  <div className=\"flex flex-wrap items-center justify-center lg:justify-start gap-2 sm:gap-3 mb-3\">\r\n                    <Badge className=\"bg-green-100 text-green-800 px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium\">\r\n                      {t('patientProfile.activePatient')}\r\n                    </Badge>\r\n                    <Badge className=\"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1 text-xs sm:text-sm\">\r\n                      {t('patientSettings.profileComplete', { percent: 85 })}\r\n                    </Badge>\r\n                  </div>\r\n                  <p className=\"text-gray-600 text-sm sm:text-base lg:text-lg break-all\">{formData.email}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n\r\n          {/* Navigation Tabs */}\r\n          <div className=\"mb-6 sm:mb-8\">\r\n            {/* Mobile: Dropdown Navigation */}\r\n            <div className=\"block sm:hidden mb-4\">\r\n              <label htmlFor=\"section-select\" className=\"sr-only\">Select Section</label>\r\n              <select\r\n                id=\"section-select\"\r\n                value={activeSection}\r\n                onChange={(e) => setActiveSection(e.target.value)}\r\n                disabled={loading}\r\n                className=\"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-base\"\r\n              >\r\n                {sections.map((section) => (\r\n                  <option key={section.id} value={section.id}>\r\n                    {section.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            {/* Tablet & Desktop: Horizontal Tabs */}\r\n            <div className=\"hidden sm:block border-b border-gray-200\">\r\n              <nav className=\"-mb-px flex space-x-4 lg:space-x-8 overflow-x-auto scrollbar-hide\">\r\n                {sections.map((section) => (\r\n                  <button\r\n                    key={section.id}\r\n                    onClick={() => setActiveSection(section.id)}\r\n                    disabled={loading}\r\n                    className={`flex items-center gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px] ${\r\n                      activeSection === section.id\r\n                        ? 'border-blue-500 text-blue-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    <span className=\"hidden sm:inline\">{section.icon}</span>\r\n                    {section.label}\r\n                  </button>\r\n                ))}\r\n              </nav>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Messages */}\r\n          {message && (\r\n            <Alert\r\n              variant={message.type}\r\n              className=\"mb-6\"\r\n            >\r\n              <div className=\"flex items-center gap-2\">\r\n                {message.type === 'success' ? (\r\n                  <Check className=\"w-4 h-4\" />\r\n                ) : (\r\n                  <AlertCircle className=\"w-4 h-4\" />\r\n                )}\r\n                {message.text}\r\n              </div>\r\n            </Alert>\r\n          )}\r\n\r\n          {/* Form Content */}\r\n          <Card className=\"p-4 sm:p-6 lg:p-8\">\r\n            <form onSubmit={handleSubmit} className=\"space-y-6 sm:space-y-8\">\r\n              {/* Personal Information Section */}\r\n              {activeSection === 'personal' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <User className=\"w-5 h-5 text-blue-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Personal Information</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Update your basic personal details</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                    <div>\r\n                      <Input\r\n                        label=\"First Name\"\r\n                        value={formData.firstName}\r\n                        onChange={(e) => handleInputChange('firstName', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.firstName && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.firstName}</p>\r\n                      )}\r\n                    </div>\r\n                    <div>\r\n                      <Input\r\n                        label=\"Last Name\"\r\n                        value={formData.lastName}\r\n                        onChange={(e) => handleInputChange('lastName', e.target.value)}\r\n                        required\r\n                      />\r\n                      {validationErrors.lastName && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.lastName}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n                    <div>\r\n                      <Input\r\n                        label=\"Date of Birth\"\r\n                        type=\"date\"\r\n                        value={formData.dateOfBirth}\r\n                        onChange={(e) => handleInputChange('dateOfBirth', e.target.value)}\r\n                      />\r\n                      {validationErrors.dateOfBirth && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.dateOfBirth}</p>\r\n                      )}\r\n                    </div>\r\n                    <Select\r\n                      label=\"Gender\"\r\n                      options={genderOptions}\r\n                      value={formData.gender}\r\n                      onChange={(e) => handleInputChange('gender', e.target.value)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Contact Details Section */}\r\n              {activeSection === 'contact' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Mail className=\"w-5 h-5 text-green-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Contact Details</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Manage your contact information</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    <div className=\"relative\">\r\n                      <Input\r\n                        label=\"Email Address\"\r\n                        type=\"email\"\r\n                        value={formData.email}\r\n                        onChange={(e) => handleInputChange('email', e.target.value)}\r\n                        required\r\n                        className=\"pl-10\"\r\n                      />\r\n                      <Mail className=\"w-4 h-4 absolute left-3 top-9 text-gray-400\" />\r\n                      {validationErrors.email && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.email}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"relative\">\r\n                      <Input\r\n                        label=\"Phone Number\"\r\n                        type=\"tel\"\r\n                        value={formData.phone}\r\n                        onChange={(e) => handleInputChange('phone', e.target.value)}\r\n                        placeholder={t('patientSettings.contact.phonePlaceholder')}\r\n                        className=\"pl-10\"\r\n                      />\r\n                      <Phone className=\"w-4 h-4 absolute left-3 top-9 text-gray-400\" />\r\n                      {validationErrors.phone && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors.phone}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Address Section */}\r\n              {activeSection === 'address' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <MapPin className=\"w-5 h-5 text-purple-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Address Information</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Update your address details</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    <Input\r\n                      label=\"Street Address\"\r\n                      value={formData.address.street}\r\n                      onChange={(e) => handleInputChange('address.street', e.target.value)}\r\n                      placeholder={t('patientSettings.address.streetPlaceholder')}\r\n                    />\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6\">\r\n                      <Input\r\n                        label=\"City\"\r\n                        value={formData.address.city}\r\n                        onChange={(e) => handleInputChange('address.city', e.target.value)}\r\n                        placeholder={t('patientSettings.address.cityPlaceholder')}\r\n                      />\r\n                      <Select\r\n                        label=\"State/Province\"\r\n                        options={stateOptions}\r\n                        value={formData.address.state}\r\n                        onChange={(e) => handleInputChange('address.state', e.target.value)}\r\n                      />\r\n                      <div>\r\n                        <Input\r\n                          label=\"ZIP/Postal Code\"\r\n                          value={formData.address.zipCode}\r\n                          onChange={(e) => handleInputChange('address.zipCode', e.target.value)}\r\n                          placeholder={t('patientSettings.address.zipCodePlaceholder')}\r\n                        />\r\n                        {validationErrors['address.zipCode'] && (\r\n                          <p className=\"mt-1 text-sm text-red-600\">{validationErrors['address.zipCode']}</p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <Input\r\n                      label=\"Country\"\r\n                      value={formData.address.country}\r\n                      onChange={(e) => handleInputChange('address.country', e.target.value)}\r\n                      placeholder={t('patientSettings.address.countryPlaceholder')}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Emergency Contact Section */}\r\n              {activeSection === 'emergency' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Phone className=\"w-5 h-5 text-red-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Emergency Contact</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Person to contact in case of emergency</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6\">\r\n                    <Input\r\n                      label=\"Contact Name\"\r\n                      value={formData.emergencyContact.name}\r\n                      onChange={(e) => handleInputChange('emergencyContact.name', e.target.value)}\r\n                      placeholder={t('patientSettings.emergency.namePlaceholder')}\r\n                    />\r\n                    <div>\r\n                      <Input\r\n                        label=\"Phone Number\"\r\n                        type=\"tel\"\r\n                        value={formData.emergencyContact.phone}\r\n                        onChange={(e) => handleInputChange('emergencyContact.phone', e.target.value)}\r\n                        placeholder={t('patientSettings.emergency.phonePlaceholder')}\r\n                      />\r\n                      {validationErrors['emergencyContact.phone'] && (\r\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors['emergencyContact.phone']}</p>\r\n                      )}\r\n                    </div>\r\n                    <Select\r\n                      label=\"Relationship\"\r\n                      options={relationshipOptions}\r\n                      value={formData.emergencyContact.relationship}\r\n                      onChange={(e) => handleInputChange('emergencyContact.relationship', e.target.value)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Medical Information Section */}\r\n              {activeSection === 'medical' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Heart className=\"w-5 h-5 text-orange-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Medical Information</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Update your medical history and conditions</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-6 sm:space-y-8\">\r\n                    {/* Allergies */}\r\n                    <div>\r\n                      <h4 className=\"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4\">Allergies</h4>\r\n                      <div className=\"flex flex-col sm:flex-row gap-2 mb-4\">\r\n                        <div className=\"flex-1\">\r\n                          <Input\r\n                            placeholder={t('patientSettings.medical.allergyPlaceholder')}\r\n                            value={newAllergy}\r\n                            onChange={(e) => setNewAllergy(e.target.value)}\r\n                            onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddAllergy())}\r\n                          />\r\n                        </div>\r\n                        <Button \r\n                          type=\"button\" \r\n                          onClick={handleAddAllergy} \r\n                          variant=\"outline\" \r\n                          disabled={loading || !newAllergy.trim()}\r\n                          className=\"w-full sm:w-auto min-h-[44px]\"\r\n                        >\r\n                          Add\r\n                        </Button>\r\n                      </div>\r\n                      {formData.medicalHistory.allergies.length > 0 && (\r\n                        <div className=\"space-y-2\">\r\n                          {formData.medicalHistory.allergies.map((allergy, index) => (\r\n                            <div key={index} className=\"flex items-center justify-between bg-red-50 p-3 sm:p-4 rounded-lg gap-2\">\r\n                              <span className=\"text-red-800 text-sm sm:text-base break-words flex-1\">{allergy}</span>\r\n                              <Button\r\n                                type=\"button\"\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleRemoveAllergy(index)}\r\n                                disabled={loading}\r\n                                className=\"text-red-600 hover:text-red-700 flex-shrink-0 min-h-[44px] min-w-[44px] sm:min-w-0\"\r\n                              >\r\n                                <span className=\"hidden sm:inline\">Remove</span>\r\n                                <X className=\"w-4 h-4 sm:hidden\" />\r\n                              </Button>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Medical Conditions */}\r\n                    <div>\r\n                      <h4 className=\"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4\">Medical Conditions</h4>\r\n                      <div className=\"flex flex-col sm:flex-row gap-2 mb-4\">\r\n                        <div className=\"flex-1\">\r\n                          <Input\r\n                            placeholder={t('patientSettings.medical.conditionPlaceholder')}\r\n                            value={newCondition}\r\n                            onChange={(e) => setNewCondition(e.target.value)}\r\n                            onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddCondition())}\r\n                          />\r\n                        </div>\r\n                        <Button \r\n                          type=\"button\" \r\n                          onClick={handleAddCondition} \r\n                          variant=\"outline\" \r\n                          disabled={loading || !newCondition.trim()}\r\n                          className=\"w-full sm:w-auto min-h-[44px]\"\r\n                        >\r\n                          Add\r\n                        </Button>\r\n                      </div>\r\n                      {formData.medicalHistory.conditions.length > 0 && (\r\n                        <div className=\"space-y-2\">\r\n                          {formData.medicalHistory.conditions.map((condition, index) => (\r\n                            <div key={index} className=\"flex items-center justify-between bg-blue-50 p-3 sm:p-4 rounded-lg gap-2\">\r\n                              <span className=\"text-blue-800 text-sm sm:text-base break-words flex-1\">{condition}</span>\r\n                              <Button\r\n                                type=\"button\"\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleRemoveCondition(index)}\r\n                                disabled={loading}\r\n                                className=\"text-blue-600 hover:text-blue-700 flex-shrink-0 min-h-[44px] min-w-[44px] sm:min-w-0\"\r\n                              >\r\n                                <span className=\"hidden sm:inline\">Remove</span>\r\n                                <X className=\"w-4 h-4 sm:hidden\" />\r\n                              </Button>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Medical Notes */}\r\n                    <div>\r\n                      <label className=\"block text-base sm:text-lg font-medium text-gray-900 mb-2\">\r\n                        Additional Medical Notes\r\n                      </label>\r\n                      <textarea\r\n                        rows={4}\r\n                        value={formData.medicalHistory.notes}\r\n                        onChange={(e) => handleInputChange('medicalHistory.notes', e.target.value)}\r\n                        className=\"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base\"\r\n                        placeholder={t('patientSettings.medical.notesPlaceholder')}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Security Section */}\r\n              {activeSection === 'security' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Shield className=\"w-5 h-5 text-red-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Security Settings</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Manage your account security</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    <div className=\"bg-gray-50 rounded-lg p-4 sm:p-6\">\r\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4\">\r\n                        <div className=\"flex-1\">\r\n                          <h4 className=\"font-medium text-gray-900 text-sm sm:text-base\">Change Password</h4>\r\n                          <p className=\"text-xs sm:text-sm text-gray-600\">Update your account password</p>\r\n                        </div>\r\n                        <Button\r\n                          type=\"button\"\r\n                          variant=\"outline\"\r\n                          onClick={() => setShowPasswordFields(!showPasswordFields)}\r\n                          disabled={loading}\r\n                          className=\"w-full sm:w-auto min-h-[44px]\"\r\n                        >\r\n                          {showPasswordFields ? 'Cancel' : 'Change Password'}\r\n                        </Button>\r\n                      </div>\r\n\r\n                      {showPasswordFields && (\r\n                        <div className=\"space-y-4 pt-4 border-t border-gray-200\">\r\n                          <Input\r\n                            label=\"Current Password\"\r\n                            type=\"password\"\r\n                            value={passwordData.currentPassword}\r\n                            onChange={(e) => setPasswordData(prev => ({ ...prev, currentPassword: e.target.value }))}\r\n                            required\r\n                          />\r\n                          <Input\r\n                            label=\"New Password\"\r\n                            type=\"password\"\r\n                            value={passwordData.newPassword}\r\n                            onChange={(e) => setPasswordData(prev => ({ ...prev, newPassword: e.target.value }))}\r\n                            required\r\n                          />\r\n                          <Input\r\n                            label=\"Confirm New Password\"\r\n                            type=\"password\"\r\n                            value={passwordData.confirmPassword}\r\n                            onChange={(e) => setPasswordData(prev => ({ ...prev, confirmPassword: e.target.value }))}\r\n                            required\r\n                          />\r\n                          <div className=\"flex flex-col sm:flex-row gap-3\">\r\n                            <Button\r\n                              type=\"button\"\r\n                              onClick={handlePasswordChange}\r\n                              disabled={loading}\r\n                              isLoading={loading}\r\n                              className=\"bg-red-600 hover:bg-red-700 w-full sm:w-auto min-h-[44px]\"\r\n                            >\r\n                              {loading ? 'Updating...' : 'Update Password'}\r\n                            </Button>\r\n                            <Button\r\n                              type=\"button\"\r\n                              variant=\"outline\"\r\n                              onClick={() => {\r\n                                setShowPasswordFields(false);\r\n                                setPasswordData({ currentPassword: '', newPassword: '', confirmPassword: '' });\r\n                              }}\r\n                              disabled={loading}\r\n                              className=\"w-full sm:w-auto min-h-[44px]\"\r\n                            >\r\n                              Cancel\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50 rounded-lg p-4 sm:p-6\">\r\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n                        <div className=\"flex-1\">\r\n                          <h4 className=\"font-medium text-gray-900 text-sm sm:text-base\">Two-Factor Authentication</h4>\r\n                          <p className=\"text-xs sm:text-sm text-gray-600\">Add an extra layer of security to your account</p>\r\n                        </div>\r\n                        <Badge className=\"bg-red-100 text-red-800 self-start sm:self-center\">\r\n                          Disabled\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Preferences Section */}\r\n              {activeSection === 'preferences' && (\r\n                <div className=\"space-y-4 sm:space-y-6\">\r\n                  <div className=\"flex items-start sm:items-center gap-3 mb-4 sm:mb-6\">\r\n                    <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                      <Settings className=\"w-5 h-5 text-green-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900\">Preferences</h3>\r\n                      <p className=\"text-sm sm:text-base text-gray-600\">Customize your experience</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4 sm:space-y-6\">\r\n                    <div className=\"bg-gray-50 rounded-lg p-4 sm:p-6\">\r\n                      <h4 className=\"font-medium text-gray-900 mb-4 text-sm sm:text-base\">Notifications</h4>\r\n                      <div className=\"space-y-4\">\r\n                        <div className=\"flex items-start sm:items-center justify-between gap-4\">\r\n                          <div className=\"flex-1\">\r\n                            <p className=\"font-medium text-gray-900 text-sm sm:text-base\">Email Notifications</p>\r\n                            <p className=\"text-xs sm:text-sm text-gray-600\">Receive updates via email</p>\r\n                          </div>\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={preferences.emailNotifications}\r\n                            onChange={(e) => setPreferences(prev => ({ ...prev, emailNotifications: e.target.checked }))}\r\n                            className=\"h-5 w-5 sm:h-4 sm:w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded flex-shrink-0 mt-1 sm:mt-0\"\r\n                          />\r\n                        </div>\r\n                        <div className=\"flex items-start sm:items-center justify-between gap-4\">\r\n                          <div className=\"flex-1\">\r\n                            <p className=\"font-medium text-gray-900 text-sm sm:text-base\">SMS Notifications</p>\r\n                            <p className=\"text-xs sm:text-sm text-gray-600\">Receive updates via SMS</p>\r\n                          </div>\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={preferences.smsNotifications}\r\n                            onChange={(e) => setPreferences(prev => ({ ...prev, smsNotifications: e.target.checked }))}\r\n                            className=\"h-5 w-5 sm:h-4 sm:w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded flex-shrink-0 mt-1 sm:mt-0\"\r\n                          />\r\n                        </div>\r\n                        <div className=\"flex items-start sm:items-center justify-between gap-4\">\r\n                          <div className=\"flex-1\">\r\n                            <p className=\"font-medium text-gray-900 text-sm sm:text-base\">Appointment Reminders</p>\r\n                            <p className=\"text-xs sm:text-sm text-gray-600\">Get reminded about upcoming appointments</p>\r\n                          </div>\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={preferences.appointmentReminders}\r\n                            onChange={(e) => setPreferences(prev => ({ ...prev, appointmentReminders: e.target.checked }))}\r\n                            className=\"h-5 w-5 sm:h-4 sm:w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded flex-shrink-0 mt-1 sm:mt-0\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50 rounded-lg p-4 sm:p-6\">\r\n                      <h4 className=\"font-medium text-gray-900 mb-4 text-sm sm:text-base\">Language & Region</h4>\r\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        <Select\r\n                          label=\"Language\"\r\n                          options={[\r\n                            { value: 'en', label: 'English' },\r\n                            { value: 'ar', label: 'Arabic' }\r\n                          ]}\r\n                          value={preferences.language}\r\n                          onChange={(e) => setPreferences(prev => ({ ...prev, language: e.target.value }))}\r\n                        />\r\n                        <Select\r\n                          label=\"Timezone\"\r\n                          options={[\r\n                            { value: 'Africa/Cairo', label: 'Cairo (GMT+2)' },\r\n                            { value: 'Africa/Alexandria', label: 'Alexandria (GMT+2)' }\r\n                          ]}\r\n                          value={preferences.timezone}\r\n                          onChange={(e) => setPreferences(prev => ({ ...prev, timezone: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Submit Button */}\r\n              <div className=\"flex flex-col sm:flex-row justify-end gap-3 sm:gap-4 pt-6 sm:pt-8 border-t border-gray-200\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={() => window.location.reload()}\r\n                  disabled={loading}\r\n                  className=\"w-full sm:w-auto min-h-[44px] order-2 sm:order-1\"\r\n                >\r\n                  <X className=\"w-4 h-4 mr-2\" />\r\n                  Cancel\r\n                </Button>\r\n                <Button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  isLoading={loading}\r\n                  className=\"bg-blue-600 hover:bg-blue-700 w-full sm:w-auto sm:min-w-[120px] min-h-[44px] order-1 sm:order-2\"\r\n                >\r\n                  {loading ? 'Saving...' : (\r\n                    <>\r\n                      <Save className=\"w-4 h-4 mr-2\" />\r\n                      Save Changes\r\n                    </>\r\n                  )}\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatientSettings;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\Patients.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2860,2863],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2860,2863],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3774,3777],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3774,3777],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Button, Card, Table, Pagination, Badge } from '../../components/ui';\nimport { AnalyticsWidget } from '../../components/dashboard';\nimport PatientSearch, { type PatientSearchFilters } from '../../components/patient/PatientSearch';\nimport { patientService } from '../../services';\nimport { useAuth } from '../../hooks/useAuth';\nimport { formatLocalizedDate } from '../../utils/dateUtils';\nimport type { PaginatedResponse, Patient } from '../../types';\nimport {\n  Users,\n  UserPlus,\n  UserCheck,\n  UserX,\n  Download,\n  Filter,\n  Grid,\n  List,\n  Plus,\n  Trash2,\n  RefreshCw,\n  CheckCircle,\n  Clock\n} from 'lucide-react';\n\nconst Patients: React.FC = () => {\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [searchFilters, setSearchFilters] = useState<PatientSearchFilters>({\n    search: '',\n    ageRange: 'all',\n    gender: 'all',\n    status: 'all',\n    hasAllergies: 'all',\n    sortBy: 'lastName',\n    sortOrder: 'asc'\n  });\n  const [currentPage, setCurrentPage] = useState(1);\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [patientsData, setPatientsData] = useState<PaginatedResponse<Patient>>({ data: [], total: 0, page: 1, limit: 10, totalPages: 0, success: true });\n  const [selectedPatients, setSelectedPatients] = useState<string[]>([]);\n  const [viewMode, setViewMode] = useState<'table' | 'grid'>('table');\n  const [showFilters, setShowFilters] = useState(false);\n\n  const isPatient = user?.role === 'patient';\n  const isStaffOrAdmin = user?.role === 'staff' || user?.role === 'admin' || user?.role === 'super_admin' || user?.role === 'dentist';\n\n  // Patient statistics\n  const patientStats = useMemo(() => {\n    const patients = patientsData.data;\n    const totalPatients = patientsData.total;\n    const activePatients = patients.filter(p => p.isActive).length;\n    const inactivePatients = patients.filter(p => !p.isActive).length;\n    const newThisMonth = patients.filter(p => {\n      const createdDate = new Date(p.createdAt);\n      const now = new Date();\n      return createdDate.getMonth() === now.getMonth() && createdDate.getFullYear() === now.getFullYear();\n    }).length;\n\n    return {\n      total: totalPatients,\n      active: activePatients,\n      inactive: inactivePatients,\n      newThisMonth,\n      activePercentage: totalPatients > 0 ? Math.round((activePatients / totalPatients) * 100) : 0\n    };\n  }, [patientsData]);\n\n  // Fetch patients with advanced filtering\n  const fetchPatients = useCallback(async (refresh = false) => {\n    if (refresh) setRefreshing(true);\n    else setLoading(true);\n    \n    try {\n      const params: any = { \n        search: searchFilters.search, \n        page: currentPage, \n        limit: 10,\n        sortBy: searchFilters.sortBy,\n        sortOrder: searchFilters.sortOrder\n      };\n      \n      // Add advanced filters\n      if (searchFilters.status !== 'all') {\n        params.status = searchFilters.status;\n      }\n      if (searchFilters.gender !== 'all') {\n        params.gender = searchFilters.gender;\n      }\n      if (searchFilters.ageRange !== 'all') {\n        params.ageRange = searchFilters.ageRange;\n      }\n      if (searchFilters.hasAllergies !== 'all') {\n        params.hasAllergies = searchFilters.hasAllergies === 'yes';\n      }\n      \n      // If user is a patient, only fetch their own data\n      if (isPatient && user?.id) {\n        params.patientId = user.id;\n      }\n      \n      const response = await patientService.getPatients(params);\n      setPatientsData(response);\n    } catch (err: any) {\n      console.error('Failed to fetch patients:', err.message || 'Unknown error');\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  }, [searchFilters, currentPage, user?.id, isPatient]);\n\n  useEffect(() => {\n    fetchPatients();\n  }, [fetchPatients]);\n\n  const filteredPatients = patientsData.data; // Already filtered by API\n  const totalPages = patientsData.totalPages;\n  const paginatedPatients = filteredPatients;\n\n  const handlePageChange = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  const handleRowClick = (patient: Patient) => {\n    navigate(`/patients/${patient.id}`);\n  };\n\n  const handleSelectionChange = (selectedIds: (string | number)[]) => {\n    setSelectedPatients(selectedIds as string[]);\n  };\n\n  const formatDate = (dateString: string) => {\n    // Use the new utility function that handles locale errors gracefully\n    return formatLocalizedDate(dateString, {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  const calculateAge = (dateOfBirth: string) => {\n    const today = new Date();\n    const birthDate = new Date(dateOfBirth);\n    let age = today.getFullYear() - birthDate.getFullYear();\n    const monthDiff = today.getMonth() - birthDate.getMonth();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n      age--;\n    }\n    \n    return age;\n  };\n\n  const columns = [\n    {\n      header: t('patients.name'),\n      accessor: (patient: Patient) => (\n        <div>\n          <div className=\"font-medium text-gray-900\">{patient.firstName} {patient.lastName}</div>\n          <div className=\"text-sm text-gray-500\">{patient.email}</div>\n        </div>\n      ),\n    },\n    {\n      header: t('patients.phone'),\n      accessor: (patient: Patient) => patient.phone,\n    },\n    {\n      header: t('patients.age'),\n      accessor: (patient: Patient) => calculateAge(patient.dateOfBirth.toString()),\n    },\n    {\n      header: t('patients.status'),\n      accessor: (patient: Patient) => (\n        <Badge \n          variant={patient.isActive ? 'success' : 'gray'}\n        >\n          {patient.isActive ? t('patients.active') : t('patients.inactive')}\n        </Badge>\n      ),\n    },\n    {\n      header: t('patients.last_visit'),\n      accessor: (patient: Patient) => patient.updatedAt ? formatDate(patient.updatedAt.toString()) : t('common.not_applicable'),\n    },\n    {\n      header: t('patients.actions'),\n      accessor: (patient: Patient) => (\n        <div className=\"flex space-x-2\">\n          <Button \n            variant=\"outline\" \n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              navigate(`/patients/${patient.id}`);\n            }}\n          >\n            {t('patients.view')}\n          </Button>\n          <Button \n            variant=\"outline\" \n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              navigate(`/patients/${patient.id}/edit`);\n            }}\n          >\n            {t('patients.edit')}\n          </Button>\n        </div>\n      ),\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n      {/* Enhanced Header - Responsive */}\n      <div className=\"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 shadow-xl border-b border-blue-800/50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6\">\n          <div className=\"flex flex-col space-y-4 lg:flex-row lg:justify-between lg:items-center lg:space-y-0\">\n            {/* Left Section - Responsive */}\n            <div className=\"flex items-center space-x-3 sm:space-x-4\">\n              <div className=\"relative flex-shrink-0\">\n                <div className=\"p-2 sm:p-3 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-xl shadow-lg\">\n                  <Users className=\"w-6 h-6 sm:w-8 sm:h-8 text-white\" />\n                </div>\n                <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white animate-pulse\"></div>\n              </div>\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"text-xl sm:text-2xl lg:text-3xl font-bold text-white truncate\">\n                  {isPatient ? t('patients.my_profile') : t('patients.patients')}\n                </h1>\n                <p className=\"text-blue-100/80 text-xs sm:text-sm lg:text-base truncate\">\n                  {isPatient ? t('patients.view_and_manage_personal_information') : t('patients.manage_patient_records')}\n                </p>\n                <div className=\"hidden sm:flex items-center space-x-4 mt-2 text-xs text-blue-200/70\">\n                  <span className=\"flex items-center space-x-1\">\n                    <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n                    <span>System Online</span>\n                  </span>\n                  <span className=\"flex items-center space-x-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    <span>Last updated: {new Date().toLocaleTimeString()}</span>\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Right Section - Responsive */}\n            <div className=\"flex items-center space-x-2 sm:space-x-3 overflow-x-auto\">\n              <Button \n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => fetchPatients(true)}\n                disabled={refreshing}\n                className=\"bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 flex-shrink-0\"\n              >\n                <RefreshCw className={`w-4 h-4 sm:mr-2 ${refreshing ? 'animate-spin' : ''}`} />\n                <span className=\"hidden sm:inline\">{refreshing ? 'Refreshing...' : t('common.refresh')}</span>\n              </Button>\n              \n              {isStaffOrAdmin && (\n                <>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\"\n                    onClick={() => setShowFilters(!showFilters)}\n                    className=\"bg-white/10 border-white/20 text-white hover:bg-white/20 hover:border-white/30 flex-shrink-0\"\n                  >\n                    <Filter className=\"w-4 h-4 sm:mr-2\" />\n                    <span className=\"hidden sm:inline\">Filters</span>\n                  </Button>\n                  \n                  <div className=\"hidden md:flex items-center bg-white/10 rounded-lg p-1 flex-shrink-0\">\n                    <Button\n                      variant={viewMode === 'table' ? 'primary' : 'outline'}\n                      size=\"sm\"\n                      onClick={() => setViewMode('table')}\n                      className=\"px-2 py-1\"\n                    >\n                      <List className=\"w-4 h-4\" />\n                    </Button>\n                    <Button\n                      variant={viewMode === 'grid' ? 'primary' : 'outline'}\n                      size=\"sm\"\n                      onClick={() => setViewMode('grid')}\n                      className=\"px-2 py-1\"\n                    >\n                      <Grid className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                  \n                  <Link to=\"/patients/new\" className=\"flex-shrink-0\">\n                    <Button \n                      variant=\"primary\" \n                      size=\"sm\"\n                      className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200\"\n                    >\n                      <Plus className=\"w-4 h-4 sm:mr-2\" />\n                      <span className=\"hidden sm:inline\">{t('patients.add_patient')}</span>\n                    </Button>\n                  </Link>\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6\">\n        {/* Statistics Cards - Only for staff/admin - Responsive */}\n        {isStaffOrAdmin && (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8\">\n            <AnalyticsWidget\n              title=\"Total Patients\"\n              type=\"metric\"\n              data={[{ label: 'Total', value: patientStats.total }]}\n              icon={<Users className=\"w-5 h-5\" />}\n              gradient=\"from-blue-500 to-blue-600\"\n              height=\"h-32\"\n              showLegend={false}\n            />\n            <AnalyticsWidget\n              title=\"Active Patients\"\n              type=\"metric\"\n              data={[{ label: 'Active', value: patientStats.active }]}\n              trend={{ value: patientStats.activePercentage, isPositive: true, period: 'of total' }}\n              icon={<UserCheck className=\"w-5 h-5\" />}\n              gradient=\"from-green-500 to-green-600\"\n              height=\"h-32\"\n              showLegend={false}\n            />\n            <AnalyticsWidget\n              title=\"Inactive Patients\"\n              type=\"metric\"\n              data={[{ label: 'Inactive', value: patientStats.inactive }]}\n              icon={<UserX className=\"w-5 h-5\" />}\n              gradient=\"from-orange-500 to-orange-600\"\n              height=\"h-32\"\n              showLegend={false}\n            />\n            <AnalyticsWidget\n              title=\"New This Month\"\n              type=\"metric\"\n              data={[{ label: 'New', value: patientStats.newThisMonth }]}\n              trend={{ value: 15, isPositive: true, period: 'vs last month' }}\n              icon={<UserPlus className=\"w-5 h-5\" />}\n              gradient=\"from-purple-500 to-purple-600\"\n              height=\"h-32\"\n              showLegend={false}\n            />\n          </div>\n        )}\n\n        {/* Advanced Search - Only for staff/admin */}\n        {isStaffOrAdmin && showFilters && (\n          <div className=\"mb-6\">\n            <PatientSearch\n              onSearch={setSearchFilters}\n              loading={loading}\n              totalResults={patientsData.total}\n            />\n          </div>\n        )}\n\n        {/* Main Content */}\n        <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-gray-50/50\">\n          {/* Bulk Actions Bar */}\n          {isStaffOrAdmin && selectedPatients.length > 0 && (\n            <div className=\"p-4 bg-blue-50 border-b border-blue-100 rounded-t-xl\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  <CheckCircle className=\"w-5 h-5 text-blue-600\" />\n                  <span className=\"text-sm font-medium text-blue-900\">\n                    {selectedPatients.length} patient{selectedPatients.length !== 1 ? 's' : ''} selected\n                  </span>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <Button variant=\"outline\" size=\"sm\" className=\"text-blue-600 border-blue-200 hover:bg-blue-100\">\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    Export\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"text-red-600 border-red-200 hover:bg-red-50\">\n                    <Trash2 className=\"w-4 h-4 mr-2\" />\n                    Delete\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"p-4 sm:p-6\">\n            {/* Mobile Card View */}\n            <div className=\"block md:hidden space-y-4\">\n              {loading ? (\n                <div className=\"flex justify-center items-center py-12\">\n                  <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n                </div>\n              ) : paginatedPatients.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">\n                  {isPatient ? t('patients.noProfileFound') : t('patients.noPatientsFound')}\n                </div>\n              ) : (\n                paginatedPatients.map((patient) => (\n                  <div\n                    key={patient.id}\n                    onClick={() => handleRowClick(patient)}\n                    className=\"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer\"\n                  >\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex-1 min-w-0\">\n                        <h3 className=\"text-lg font-semibold text-gray-900 truncate\">\n                          {patient.firstName} {patient.lastName}\n                        </h3>\n                        <p className=\"text-sm text-gray-500 truncate\">{patient.email}</p>\n                      </div>\n                      <Badge \n                        variant={patient.isActive ? 'success' : 'gray'}\n                        className=\"ml-2 flex-shrink-0\"\n                      >\n                        {patient.isActive ? t('patients.active') : t('patients.inactive')}\n                      </Badge>\n                    </div>\n                    \n                    <div className=\"space-y-2 mb-3\">\n                      <div className=\"flex items-center text-sm text-gray-600\">\n                        <svg className=\"w-4 h-4 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\n                        </svg>\n                        <span className=\"truncate\">{patient.phone}</span>\n                      </div>\n                      <div className=\"flex items-center text-sm text-gray-600\">\n                        <svg className=\"w-4 h-4 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a1 1 0 011 1v1a1 1 0 01-1 1H5a1 1 0 01-1-1V8a1 1 0 011-1h3z\" />\n                        </svg>\n                        <span>{t('patients.age')}: {calculateAge(patient.dateOfBirth.toString())}</span>\n                      </div>\n                      <div className=\"flex items-center text-sm text-gray-600\">\n                        <svg className=\"w-4 h-4 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                        </svg>\n                        <span className=\"truncate\">{t('patients.last_visit')}: {patient.updatedAt ? formatDate(patient.updatedAt.toString()) : t('common.not_applicable')}</span>\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex space-x-2 pt-3 border-t border-gray-100\">\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          navigate(`/patients/${patient.id}`);\n                        }}\n                        className=\"flex-1 min-h-[44px]\"\n                      >\n                        {t('patients.view')}\n                      </Button>\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          navigate(`/patients/${patient.id}/edit`);\n                        }}\n                        className=\"flex-1 min-h-[44px]\"\n                      >\n                        {t('patients.edit')}\n                      </Button>\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n\n            {/* Desktop Table View */}\n            <div className=\"hidden md:block\">\n              <Table\n                columns={columns}\n                data={paginatedPatients}\n                keyExtractor={(patient) => patient.id}\n                isLoading={loading}\n                emptyMessage={isPatient ? t('patients.noProfileFound') : t('patients.noPatientsFound')}\n                onRowClick={handleRowClick}\n                isSelectable={isStaffOrAdmin}\n                selectedIds={selectedPatients}\n                onSelectionChange={handleSelectionChange}\n              />\n            </div>\n\n            {totalPages > 1 && (\n              <div className=\"mt-4 sm:mt-6 flex justify-center\">\n                <Pagination\n                  currentPage={currentPage}\n                  totalPages={totalPages}\n                  onPageChange={handlePageChange}\n                />\n              </div>\n            )}\n          </div>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default Patients;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\patient\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\prescriptions\\Prescriptions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\prescriptions\\__tests__\\Prescriptions.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3438,3441],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3438,3441],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5226,5229],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5226,5229],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":207,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":207,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6500,6503],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6500,6503],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":232,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7137,7140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7137,7140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":273,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":273,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8325,8328],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8325,8328],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":330,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":330,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9969,9972],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9969,9972],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":379,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":379,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11480,11483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11480,11483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":435,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":435,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13166,13169],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13166,13169],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":460,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":460,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13906,13909],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13906,13909],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":499,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":499,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15011,15014],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15011,15014],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":547,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":547,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16381,16384],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16381,16384],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":599,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":599,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17901,17904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17901,17904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Tests for Prescriptions component React key props and error handling\r\n * Verifies proper key props in medication mapping and safe data handling\r\n */\r\n\r\nimport React from 'react';\r\nimport { render, screen, waitFor } from '@testing-library/react';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport { I18nextProvider } from 'react-i18next';\r\nimport Prescriptions from '../Prescriptions';\r\nimport { useAuth } from '../../../hooks/useAuth';\r\nimport { prescriptionService } from '../../../services/prescriptionService';\r\nimport i18n from '../../../i18n';\r\n\r\n// Mock dependencies\r\njest.mock('../../../hooks/useAuth');\r\njest.mock('../../../services/prescriptionService');\r\n\r\nconst mockUseAuth = useAuth as jest.MockedFunction<typeof useAuth>;\r\nconst mockPrescriptionService = prescriptionService as jest.Mocked<typeof prescriptionService>;\r\n\r\n// Mock console.error to catch React key warnings\r\nconst originalConsoleError = console.error;\r\nconst mockConsoleError = jest.fn();\r\n\r\n// Test wrapper component\r\nconst TestWrapper: React.FC<{ children: React.ReactNode }> = ({ children }) => (\r\n  <BrowserRouter>\r\n    <I18nextProvider i18n={i18n}>\r\n      {children}\r\n    </I18nextProvider>\r\n  </BrowserRouter>\r\n);\r\n\r\ndescribe('Prescriptions Component - Key Props and Error Handling', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    console.error = mockConsoleError;\r\n    \r\n    // Default mock implementations\r\n    mockUseAuth.mockReturnValue({\r\n      user: { id: 'test-patient-id', role: 'patient' },\r\n      isAuthenticated: true,\r\n      login: jest.fn(),\r\n      logout: jest.fn(),\r\n      loading: false\r\n    });\r\n  });\r\n\r\n  afterEach(() => {\r\n    console.error = originalConsoleError;\r\n  });\r\n\r\n  describe('React Key Props', () => {\r\n    it('should not generate React key warnings for prescription list', async () => {\r\n      const mockPrescriptions = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [\r\n            {\r\n              _id: 'med-1',\r\n              medication: { name: 'Medication 1', category: 'Antibiotic' },\r\n              dosage: '500mg',\r\n              frequency: 'Twice daily',\r\n              duration: '7 days'\r\n            },\r\n            {\r\n              _id: 'med-2',\r\n              medication: { name: 'Medication 2', category: 'Painkiller' },\r\n              dosage: '200mg',\r\n              frequency: 'As needed',\r\n              duration: '5 days'\r\n            }\r\n          ],\r\n          prescribedDate: '2024-01-15',\r\n          expiryDate: '2024-02-15',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. John', lastName: 'Doe' },\r\n          clinic: { name: 'Test Clinic' }\r\n        },\r\n        {\r\n          _id: 'prescription-2',\r\n          medications: [\r\n            {\r\n              _id: 'med-3',\r\n              medication: { name: 'Medication 3', category: 'Antiseptic' },\r\n              dosage: '10ml',\r\n              frequency: 'Three times daily',\r\n              duration: '3 days'\r\n            }\r\n          ],\r\n          prescribedDate: '2024-01-10',\r\n          expiryDate: '2024-02-10',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. Jane', lastName: 'Smith' },\r\n          clinic: { name: 'Another Clinic' }\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: mockPrescriptions,\r\n        total: 2,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Medication 1/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Check that no React key warnings were logged\r\n      const keyWarnings = mockConsoleError.mock.calls.filter(call =>\r\n        call.some(arg => \r\n          typeof arg === 'string' && \r\n          (arg.includes('Warning: Each child in a list should have a unique \"key\" prop') ||\r\n           arg.includes('key prop'))\r\n        )\r\n      );\r\n\r\n      expect(keyWarnings).toHaveLength(0);\r\n    });\r\n\r\n    it('should handle medications without _id using index as key', async () => {\r\n      const mockPrescriptions = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [\r\n            {\r\n              // Missing _id - should use index as key\r\n              medication: { name: 'Medication Without ID', category: 'Antibiotic' },\r\n              dosage: '500mg',\r\n              frequency: 'Twice daily',\r\n              duration: '7 days'\r\n            },\r\n            {\r\n              _id: 'med-2',\r\n              medication: { name: 'Medication With ID', category: 'Painkiller' },\r\n              dosage: '200mg',\r\n              frequency: 'As needed',\r\n              duration: '5 days'\r\n            }\r\n          ],\r\n          prescribedDate: '2024-01-15',\r\n          expiryDate: '2024-02-15',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. John', lastName: 'Doe' },\r\n          clinic: { name: 'Test Clinic' }\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: mockPrescriptions,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Medication Without ID/i)).toBeInTheDocument();\r\n        expect(screen.getByText(/Medication With ID/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should not generate key warnings even with missing _id\r\n      const keyWarnings = mockConsoleError.mock.calls.filter(call =>\r\n        call.some(arg => \r\n          typeof arg === 'string' && \r\n          arg.includes('key prop')\r\n        )\r\n      );\r\n\r\n      expect(keyWarnings).toHaveLength(0);\r\n    });\r\n\r\n    it('should handle empty medications array without errors', async () => {\r\n      const mockPrescriptions = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [], // Empty medications array\r\n          prescribedDate: '2024-01-15',\r\n          expiryDate: '2024-02-15',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. John', lastName: 'Doe' },\r\n          clinic: { name: 'Test Clinic' }\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: mockPrescriptions,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Dr. John Doe/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should render without errors\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Undefined/Null Data Handling', () => {\r\n    it('should handle null prescriptions data', async () => {\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: null,\r\n        total: 0,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 0\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/no prescriptions/i) || screen.getByText(/0.*prescription/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should not crash\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle prescriptions with missing properties', async () => {\r\n      const incompletePrescriptions = [\r\n        {\r\n          _id: 'prescription-1',\r\n          // Missing medications array\r\n          prescribedDate: '2024-01-15',\r\n          status: 'active'\r\n          // Missing dentist, clinic, etc.\r\n        },\r\n        {\r\n          _id: 'prescription-2',\r\n          medications: null, // Null medications\r\n          prescribedDate: '2024-01-10',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. Jane' }, // Missing lastName\r\n          clinic: null // Null clinic\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: incompletePrescriptions,\r\n        total: 2,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/prescription-1/i) || screen.getByText(/2.*prescription/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should render without crashing\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle medications with missing properties', async () => {\r\n      const prescriptionsWithIncompleteMeds = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [\r\n            {\r\n              _id: 'med-1',\r\n              // Missing medication object\r\n              dosage: '500mg'\r\n            },\r\n            {\r\n              _id: 'med-2',\r\n              medication: null, // Null medication\r\n              dosage: '200mg',\r\n              frequency: 'As needed'\r\n            },\r\n            {\r\n              _id: 'med-3',\r\n              medication: {\r\n                name: 'Complete Medication'\r\n                // Missing category\r\n              },\r\n              dosage: '100mg',\r\n              frequency: 'Once daily',\r\n              duration: '10 days'\r\n            }\r\n          ],\r\n          prescribedDate: '2024-01-15',\r\n          expiryDate: '2024-02-15',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. John', lastName: 'Doe' },\r\n          clinic: { name: 'Test Clinic' }\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: prescriptionsWithIncompleteMeds,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Complete Medication/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should render available data without crashing\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle undefined prescription properties gracefully', async () => {\r\n      const prescriptionWithUndefinedProps = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [\r\n            {\r\n              _id: 'med-1',\r\n              medication: {\r\n                name: 'Test Medication',\r\n                category: 'Test Category'\r\n              },\r\n              dosage: undefined, // Undefined dosage\r\n              frequency: null, // Null frequency\r\n              duration: '7 days',\r\n              instructions: undefined // Undefined instructions\r\n            }\r\n          ],\r\n          prescribedDate: undefined, // Undefined date\r\n          expiryDate: '2024-02-15',\r\n          status: 'active',\r\n          dentist: undefined, // Undefined dentist\r\n          clinic: { name: 'Test Clinic' },\r\n          diagnosis: null, // Null diagnosis\r\n          notes: undefined // Undefined notes\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: prescriptionWithUndefinedProps,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Test Medication/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should render without errors, using fallback values\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('API Error Scenarios', () => {\r\n    it('should handle API errors gracefully', async () => {\r\n      mockPrescriptionService.getMyPrescriptions.mockRejectedValue(\r\n        new Error('Failed to fetch prescriptions')\r\n      );\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/error/i) || screen.getByText(/failed/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should show error state instead of crashing\r\n      expect(screen.queryByText(/Test Medication/i)).not.toBeInTheDocument();\r\n    });\r\n\r\n    it('should handle network errors', async () => {\r\n      const networkError = new Error('Network Error');\r\n      networkError.name = 'NetworkError';\r\n      \r\n      mockPrescriptionService.getMyPrescriptions.mockRejectedValue(networkError);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/network/i) || screen.getByText(/connection/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n\r\n    it('should handle malformed API response', async () => {\r\n      // Return malformed response structure\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue('invalid response' as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        // Should handle malformed response gracefully\r\n        expect(screen.getByText(/no prescriptions/i) || screen.getByText(/error/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Loading States', () => {\r\n    it('should show loading state while fetching prescriptions', async () => {\r\n      // Mock delayed response\r\n      mockPrescriptionService.getMyPrescriptions.mockImplementation(\r\n        () => new Promise(resolve => setTimeout(() => resolve({\r\n          data: [],\r\n          total: 0,\r\n          page: 1,\r\n          limit: 100,\r\n          totalPages: 0\r\n        } as any), 100))\r\n      );\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      // Should show loading state initially\r\n      expect(screen.getByText(/loading/i) || screen.getByTestId('loading-spinner')).toBeInTheDocument();\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/no prescriptions/i) || screen.getByText(/0.*prescription/i)).toBeInTheDocument();\r\n      });\r\n    });\r\n\r\n    it('should handle loading state with partial data', async () => {\r\n      const partialPrescriptions = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [\r\n            {\r\n              _id: 'med-1',\r\n              medication: { name: 'Loading Medication' },\r\n              // Other properties still loading\r\n            }\r\n          ],\r\n          status: 'active'\r\n          // Other properties still loading\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: partialPrescriptions,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Loading Medication/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should render partial data without errors\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Edge Cases', () => {\r\n    it('should handle extremely large medication lists', async () => {\r\n      const largeMedicationList = Array.from({ length: 100 }, (_, i) => ({\r\n        _id: `med-${i}`,\r\n        medication: { \r\n          name: `Medication ${i}`, \r\n          category: `Category ${i % 5}` \r\n        },\r\n        dosage: `${(i + 1) * 100}mg`,\r\n        frequency: 'Daily',\r\n        duration: `${i + 1} days`\r\n      }));\r\n\r\n      const prescriptionWithManyMeds = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: largeMedicationList,\r\n          prescribedDate: '2024-01-15',\r\n          expiryDate: '2024-02-15',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. John', lastName: 'Doe' },\r\n          clinic: { name: 'Test Clinic' }\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: prescriptionWithManyMeds,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/Medication 0/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should handle large lists without key warnings\r\n      const keyWarnings = mockConsoleError.mock.calls.filter(call =>\r\n        call.some(arg => \r\n          typeof arg === 'string' && \r\n          arg.includes('key prop')\r\n        )\r\n      );\r\n\r\n      expect(keyWarnings).toHaveLength(0);\r\n    });\r\n\r\n    it('should handle duplicate medication IDs gracefully', async () => {\r\n      const prescriptionWithDuplicateIds = [\r\n        {\r\n          _id: 'prescription-1',\r\n          medications: [\r\n            {\r\n              _id: 'duplicate-id',\r\n              medication: { name: 'First Medication', category: 'Antibiotic' },\r\n              dosage: '500mg'\r\n            },\r\n            {\r\n              _id: 'duplicate-id', // Duplicate ID\r\n              medication: { name: 'Second Medication', category: 'Painkiller' },\r\n              dosage: '200mg'\r\n            }\r\n          ],\r\n          prescribedDate: '2024-01-15',\r\n          status: 'active',\r\n          dentist: { firstName: 'Dr. John', lastName: 'Doe' },\r\n          clinic: { name: 'Test Clinic' }\r\n        }\r\n      ];\r\n\r\n      mockPrescriptionService.getMyPrescriptions.mockResolvedValue({\r\n        data: prescriptionWithDuplicateIds,\r\n        total: 1,\r\n        page: 1,\r\n        limit: 100,\r\n        totalPages: 1\r\n      } as any);\r\n\r\n      render(\r\n        <TestWrapper>\r\n          <Prescriptions />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(/First Medication/i)).toBeInTheDocument();\r\n        expect(screen.getByText(/Second Medication/i)).toBeInTheDocument();\r\n      });\r\n\r\n      // Should handle duplicate IDs by falling back to index-based keys\r\n      expect(mockConsoleError).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\profile\\Profile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\prototype\\MultiBranchBookingPrototype.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\prototype\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\reports\\PatientReportDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\reports\\Reports.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPatientReports'. Either include it or remove the dependency array.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPatientReports, isPatient]","fix":{"range":[1244,1255],"text":"[fetchPatientReports, isPatient]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1468,1471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1468,1471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":186,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6562,6565],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6562,6565],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Card, Alert } from '../../components/ui';\nimport { ReportsDashboard } from '../../components/reports/ReportsDashboard';\nimport { useAuth } from '../../hooks/useAuth';\nimport { getPatientReports } from '../../services/patientService';\nimport type { PatientReport } from '../../types';\nimport { useTranslation } from 'react-i18next';\nimport { BarChart3, FileText, Users, TrendingUp, Calendar } from 'lucide-react';\n\ninterface ReportType {\n  id: string;\n  name: string;\n  description: string;\n  icon: React.ReactNode;\n  component?: React.ReactNode;\n}\n\nconst Reports: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [activeView, setActiveView] = useState<'dashboard' | 'custom' | 'patient'>('dashboard');\n  const [patientReports, setPatientReports] = useState<PatientReport[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const isPatient = user?.role === 'patient';\n  const canViewDashboard = ['admin', 'dentist', 'staff'].includes(user?.role || '');\n\n  useEffect(() => {\n    if (isPatient) {\n      setActiveView('patient');\n      fetchPatientReports();\n    }\n  }, [isPatient]);\n\n  const fetchPatientReports = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const reports = await getPatientReports(user?.id);\n      setPatientReports(reports);\n    } catch (err: any) {\n      setError(err.message || t('reports.fetchingReportsError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const reportTypes: ReportType[] = [\n    {\n      id: 'dashboard',\n      name: t('reports.views.dashboard.name'),\n      description: t('reports.views.dashboard.description'),\n      icon: <BarChart3 className=\"h-6 w-6\" />,\n      component: <ReportsDashboard />\n    },\n    {\n      id: 'appointments',\n      name: t('reports.views.appointments.name'),\n      description: t('reports.views.appointments.description'),\n      icon: <Calendar className=\"h-6 w-6\" />\n    },\n    {\n      id: 'revenue',\n      name: t('reports.views.revenue.name'),\n      description: t('reports.views.revenue.description'),\n      icon: <TrendingUp className=\"h-6 w-6\" />\n    },\n    {\n      id: 'patients',\n      name: t('reports.views.patients.name'),\n      description: t('reports.views.patients.description'),\n      icon: <Users className=\"h-6 w-6\" />\n    },\n    {\n      id: 'custom',\n      name: t('reports.views.custom.name'),\n      description: t('reports.views.custom.description'),\n      icon: <FileText className=\"h-6 w-6\" />\n    }\n  ];\n\n\n  const renderPatientReports = () => (\n    <div className=\"space-y-6\">\n      <Card className=\"p-6\">\n        <h2 className=\"text-xl font-semibold mb-4 flex items-center\">\n          <FileText className=\"h-5 w-5 mr-2\" />\n          {t('reports.patient.title')}\n        </h2>\n        <p className=\"text-gray-600 mb-6\">{t('reports.patient.description')}</p>\n        \n        {error && (\n          <Alert variant=\"error\" className=\"mb-4\">\n            {error}\n          </Alert>\n        )}\n        \n        {loading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n            <span className=\"ml-3 text-gray-600\">{t('reports.loading')}</span>\n          </div>\n        ) : patientReports.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            {patientReports.map((report) => (\n              <Card key={report.id} className=\"p-4 hover:shadow-lg transition-shadow\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-medium text-lg\">{report.title}</h3>\n                    <p className=\"text-gray-600 text-sm mt-1\">{report.description}</p>\n                    <div className=\"flex items-center mt-3 text-xs text-gray-500\">\n                      <span>{t('reports.reportDate')}: {new Date(report.createdAt).toLocaleDateString()}</span>\n                    </div>\n                  </div>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => window.open(`/reports/patient/${report.id}`, '_blank')}\n                  >\n                    {t('reports.viewReport')}\n                  </Button>\n                </div>\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{t('reports.patient.noReports')}</h3>\n            <p className=\"text-gray-600\">{t('reports.patient.noReportsDescription')}</p>\n          </div>\n        )}\n      </Card>\n    </div>\n  );\n\n  const renderCustomReports = () => (\n    <div className=\"space-y-6\">\n      <Card className=\"p-6\">\n        <h2 className=\"text-xl font-semibold mb-4\">{t('reports.custom.title')}</h2>\n        <p className=\"text-gray-600 mb-6\">{t('reports.custom.description')}</p>\n        \n        <div className=\"bg-gray-50 rounded-lg p-8 text-center\">\n          <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{t('reports.custom.comingSoon')}</h3>\n          <p className=\"text-gray-600\">{t('reports.custom.comingSoonDescription')}</p>\n        </div>\n      </Card>\n    </div>\n  );\n\n  const renderMainContent = () => {\n    if (isPatient) {\n      return renderPatientReports();\n    }\n\n    switch (activeView) {\n      case 'dashboard':\n        return <ReportsDashboard />;\n      case 'custom':\n        return renderCustomReports();\n      default:\n        return <ReportsDashboard />;\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">{t('reports.title')}</h1>\n          <p className=\"text-gray-600\">{t('reports.subtitle')}</p>\n        </div>\n      </div>\n\n      {/* Navigation for non-patients */}\n      {canViewDashboard && (\n        <Card className=\"p-4\">\n          <div className=\"flex flex-wrap gap-2\">\n            {reportTypes.map((type) => (\n              <Button\n                key={type.id}\n                variant={activeView === type.id ? \"primary\" : \"outline\"}\n                onClick={() => setActiveView(type.id as any)}\n                className=\"flex items-center gap-2\"\n              >\n                {type.icon}\n                <span className=\"hidden sm:inline\">{type.name}</span>\n              </Button>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {/* Main Content */}\n      {renderMainContent()}\n    </div>\n  );\n};\n\nexport default Reports;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\reports\\ReportsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\reports\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\search\\Search.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1503,1506],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1503,1506],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { Search as SearchIcon, Users, Calendar, FileText, Clock, ArrowRight } from 'lucide-react';\nimport SearchBar from '../../components/common/SearchBar';\nimport { Card } from '../../components/ui';\nimport { searchService } from '../../services/searchService';\n\ninterface SearchResult {\n  id: string;\n  type: 'patient' | 'appointment' | 'prescription' | 'medication';\n  title: string;\n  subtitle: string;\n  description?: string;\n  date?: string;\n  status?: string;\n  url: string;\n}\n\nconst Search: React.FC = () => {\n  const { t } = useTranslation();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const [query, setQuery] = useState(searchParams.get('q') || '');\n  const [results, setResults] = useState<SearchResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n\n  // Search function using the search service\n  const performSearch = async (searchQuery: string) => {\n    if (!searchQuery.trim()) {\n      setResults([]);\n      return;\n    }\n\n    setLoading(true);\n    \n    try {\n      const response = await searchService.globalSearch(searchQuery);\n      \n      if (response.success && response.data) {\n        // Transform the API response to match our SearchResult interface\n        const formattedResults = response.data.map((item: any) => ({\n          id: item.id,\n          type: item.type,\n          title: item.title,\n          subtitle: item.subtitle,\n          description: item.description,\n          date: item.date ? new Date(item.date).toLocaleDateString() : undefined,\n          status: item.status,\n          url: item.url\n        }));\n        \n        setResults(formattedResults);\n      } else {\n        console.error('Search failed:', response.message);\n        setResults([]);\n      }\n    } catch (error) {\n      console.error('Error performing search:', error);\n      setResults([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    performSearch(query);\n  }, [query]);\n\n  const handleSearch = (searchQuery: string) => {\n    setQuery(searchQuery);\n    setSelectedIndex(-1);\n    // Update URL with search query\n    if (searchQuery.trim()) {\n      navigate(`/search?q=${encodeURIComponent(searchQuery)}`, { replace: true });\n    } else {\n      navigate('/search', { replace: true });\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (results.length === 0) return;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setSelectedIndex(prev => (prev < results.length - 1 ? prev + 1 : 0));\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setSelectedIndex(prev => (prev > 0 ? prev - 1 : results.length - 1));\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (selectedIndex >= 0 && selectedIndex < results.length) {\n          navigate(results[selectedIndex].url);\n        }\n        break;\n      case 'Escape':\n        setSelectedIndex(-1);\n        break;\n    }\n  };\n\n  const getResultIcon = (type: string) => {\n    switch (type) {\n      case 'patient':\n        return <Users className=\"w-5 h-5 text-blue-600\" />;\n      case 'appointment':\n        return <Calendar className=\"w-5 h-5 text-green-600\" />;\n      case 'prescription':\n        return <FileText className=\"w-5 h-5 text-purple-600\" />;\n      case 'medication':\n        return <Clock className=\"w-5 h-5 text-orange-600\" />;\n      default:\n        return <SearchIcon className=\"w-5 h-5 text-gray-600\" />;\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status?.toLowerCase()) {\n      case 'active':\n        return 'bg-green-100 text-green-800';\n      case 'scheduled':\n        return 'bg-blue-100 text-blue-800';\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'completed':\n        return 'bg-gray-100 text-gray-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-6\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\n          {t('search.title', 'Search')}\n        </h1>\n        <p className=\"text-gray-600\">\n          {t('search.description', 'Search for patients, appointments, prescriptions, and more')}\n        </p>\n      </div>\n\n      <div className=\"mb-8\" onKeyDown={handleKeyDown}>\n        <SearchBar\n          placeholder={t('search.placeholder', 'Search patients, appointments, prescriptions...')}\n          onSearch={handleSearch}\n          initialValue={query}\n          loading={loading}\n          className=\"w-full\"\n        />\n      </div>\n\n      {query && (\n        <div className=\"mb-6\">\n          <p className=\"text-sm text-gray-600\">\n            {loading \n              ? t('search.searching', 'Searching...')\n              : t('search.results_count', `Found ${results.length} results for \"${query}\"`)\n            }\n          </p>\n        </div>\n      )}\n\n      <div className=\"space-y-4\">\n        {results.map((result, index) => (\n          <div\n            key={result.id}\n            className={`cursor-pointer transition-all duration-200 hover:shadow-md ${\n              selectedIndex === index ? 'ring-2 ring-blue-500 bg-blue-50' : ''\n            }`}\n            onClick={() => navigate(result.url)}\n          >\n            <Card className=\"p-4\">\n            <div className=\"flex items-start space-x-4\">\n              <div className=\"flex-shrink-0 mt-1\">\n                {getResultIcon(result.type)}\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h3 className=\"text-lg font-medium text-gray-900 truncate\">\n                    {result.title}\n                  </h3>\n                  {result.status && (\n                    <span className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusColor(result.status)}`}>\n                      {result.status}\n                    </span>\n                  )}\n                </div>\n                <p className=\"text-sm text-gray-600 mb-1\">{result.subtitle}</p>\n                {result.description && (\n                  <p className=\"text-sm text-gray-500 mb-2\">{result.description}</p>\n                )}\n                {result.date && (\n                  <p className=\"text-xs text-gray-400\">{result.date}</p>\n                )}\n              </div>\n              <div className=\"flex-shrink-0\">\n                <ArrowRight className=\"w-5 h-5 text-gray-400\" />\n              </div>\n            </div>\n            </Card>\n          </div>\n        ))}\n      </div>\n\n      {query && !loading && results.length === 0 && (\n        <div className=\"text-center py-12\">\n          <SearchIcon className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {t('search.no_results', 'No results found')}\n          </h3>\n          <p className=\"text-gray-600\">\n            {t('search.no_results_description', 'Try adjusting your search terms or check for typos')}\n          </p>\n        </div>\n      )}\n\n      {!query && (\n        <div className=\"text-center py-12\">\n          <SearchIcon className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {t('search.start_searching', 'Start searching')}\n          </h3>\n          <p className=\"text-gray-600\">\n            {t('search.start_searching_description', 'Enter a search term to find patients, appointments, and more')}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Search;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\BillingSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\ClinicSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1902,1905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1902,1905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2323,2326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2323,2326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Card, Button, Input, Select, Alert, Badge } from '../../components/ui';\nimport { useClinic } from '../../hooks/useClinic';\nimport type { OperatingHours } from '../../types';\n\nconst ClinicSettings: React.FC = () => {\n  const { t } = useTranslation();\n  const { selectedClinic, updateClinic } = useClinic();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\n  const [formData, setFormData] = useState({\n    name: selectedClinic?.name || '',\n    description: selectedClinic?.description || '',\n    phone: selectedClinic?.phone || '',\n    email: selectedClinic?.email || '',\n    website: selectedClinic?.website || '',\n    address: {\n      street: selectedClinic?.address?.street || '',\n      city: selectedClinic?.address?.city || '',\n      state: selectedClinic?.address?.state || '',\n      zipCode: selectedClinic?.address?.zipCode || '',\n      country: selectedClinic?.address?.country || 'US'\n    },\n    operatingHours: selectedClinic?.operatingHours || [\n      { day: 'monday', open: '09:00', close: '17:00', closed: false },\n      { day: 'tuesday', open: '09:00', close: '17:00', closed: false },\n      { day: 'wednesday', open: '09:00', close: '17:00', closed: false },\n      { day: 'thursday', open: '09:00', close: '17:00', closed: false },\n      { day: 'friday', open: '09:00', close: '17:00', closed: false },\n      { day: 'saturday', open: '09:00', close: '13:00', closed: false },\n      { day: 'sunday', open: '09:00', close: '17:00', closed: true }\n    ] as OperatingHours[],\n    services: selectedClinic?.services || [],\n    emergencyContact: selectedClinic?.emergencyContact || ''\n  });\n\n  const [newService, setNewService] = useState('');\n\n  const handleInputChange = (field: string, value: any) => {\n    if (field.startsWith('address.')) {\n      const addressField = field.split('.')[1];\n      setFormData(prev => ({\n        ...prev,\n        address: {\n          ...prev.address,\n          [addressField]: value\n        }\n      }));\n    } else {\n      setFormData(prev => ({\n        ...prev,\n        [field]: value\n      }));\n    }\n  };\n\n  const handleOperatingHoursChange = (day: string, field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      operatingHours: prev.operatingHours.map(hours => \n        hours.day === day \n          ? { ...hours, [field]: value }\n          : hours\n      )\n    }));\n  };\n\n  const handleAddService = () => {\n    if (newService.trim() && !formData.services.includes(newService.trim())) {\n      setFormData(prev => ({\n        ...prev,\n        services: [...prev.services, newService.trim()]\n      }));\n      setNewService('');\n    }\n  };\n\n  const handleRemoveService = (service: string) => {\n    setFormData(prev => ({\n      ...prev,\n      services: prev.services.filter(s => s !== service)\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedClinic) return;\n\n    setLoading(true);\n    setMessage(null);\n\n    try {\n      await updateClinic(selectedClinic.id, formData);\n      setMessage({ type: 'success', text: t('settings.clinic.messages.updateSuccess') });\n    } catch (_error) {\n      setMessage({ type: 'error', text: t('settings.clinic.messages.updateError') });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const stateOptions = [\n    { value: '', label: t('settings.clinic.address.state.select') },\n    { value: 'AL', label: t('settings.clinic.address.state.alabama') },\n    { value: 'AK', label: t('settings.clinic.address.state.alaska') },\n    { value: 'AZ', label: t('settings.clinic.address.state.arizona') },\n    { value: 'AR', label: t('settings.clinic.address.state.arkansas') },\n    { value: 'CA', label: t('settings.clinic.address.state.california') },\n    { value: 'CO', label: t('settings.clinic.address.state.colorado') },\n    { value: 'CT', label: t('settings.clinic.address.state.connecticut') },\n    { value: 'DE', label: t('settings.clinic.address.state.delaware') },\n    { value: 'FL', label: t('settings.clinic.address.state.florida') },\n    { value: 'GA', label: t('settings.clinic.address.state.georgia') },\n    // Add more states as needed\n  ];\n\n  const daysOfWeek = [\n    { key: 'monday', label: t('settings.clinic.operatingHours.days.monday') },\n    { key: 'tuesday', label: t('settings.clinic.operatingHours.days.tuesday') },\n    { key: 'wednesday', label: t('settings.clinic.operatingHours.days.wednesday') },\n    { key: 'thursday', label: t('settings.clinic.operatingHours.days.thursday') },\n    { key: 'friday', label: t('settings.clinic.operatingHours.days.friday') },\n    { key: 'saturday', label: t('settings.clinic.operatingHours.days.saturday') },\n    { key: 'sunday', label: t('settings.clinic.operatingHours.days.sunday') }\n  ];\n\n  if (!selectedClinic) {\n    return (\n      <Card className=\"p-6\">\n        <div className=\"text-center\">\n          <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n          </svg>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">{t('settings.clinic.noClinicSelected.title')}</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            {t('settings.clinic.noClinicSelected.description')}\n          </p>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Clinic Header */}\n      <Card className=\"p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">{selectedClinic.name}</h2>\n            <p className=\"text-gray-600\">{selectedClinic.address.city}, {selectedClinic.address.state}</p>\n          </div>\n          <Badge variant=\"success\">{t('settings.clinic.active')}</Badge>\n        </div>\n      </Card>\n\n      {message && (\n        <Alert\n          variant={message.type}\n          className=\"mb-6\"\n          dismissible\n        >\n          {message.text}\n        </Alert>\n      )}\n\n      {/* Basic Information */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-6\">{t('settings.clinic.basicInfo.title')}</h3>\n        \n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <Input\n              label={t('settings.clinic.basicInfo.clinicName')}\n              value={formData.name}\n              onChange={(e) => handleInputChange('name', e.target.value)}\n              required\n            />\n            <Input\n              label={t('settings.clinic.basicInfo.phone')}\n              type=\"tel\"\n              value={formData.phone}\n              onChange={(e) => handleInputChange('phone', e.target.value)}\n              required\n            />\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <Input\n              label={t('settings.clinic.basicInfo.email')}\n              type=\"email\"\n              value={formData.email}\n              onChange={(e) => handleInputChange('email', e.target.value)}\n              required\n            />\n            <Input\n              label={t('settings.clinic.basicInfo.website')}\n              type=\"url\"\n              value={formData.website}\n              onChange={(e) => handleInputChange('website', e.target.value)}\n              placeholder={t('common.placeholders.website')}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              {t('settings.clinic.basicInfo.description')}\n            </label>\n            <textarea\n              rows={3}\n              value={formData.description}\n              onChange={(e) => handleInputChange('description', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n              placeholder={t('settings.clinic.basicInfo.descriptionPlaceholder')}\n            />\n          </div>\n\n          <Input\n            label={t('settings.clinic.basicInfo.emergencyContact')}\n            type=\"tel\"\n            value={formData.emergencyContact}\n            onChange={(e) => handleInputChange('emergencyContact', e.target.value)}\n            placeholder={t('settings.clinic.basicInfo.emergencyContactPlaceholder')}\n          />\n        </form>\n      </Card>\n\n      {/* Address */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-6\">{t('settings.clinic.address.title')}</h3>\n        \n        <div className=\"space-y-4\">\n          <Input\n            label={t('settings.clinic.address.street')}\n            value={formData.address.street}\n            onChange={(e) => handleInputChange('address.street', e.target.value)}\n            required\n          />\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <Input\n              label={t('settings.clinic.address.city')}\n              value={formData.address.city}\n              onChange={(e) => handleInputChange('address.city', e.target.value)}\n              required\n            />\n            <Select\n              label={t('settings.clinic.address.state.label')}\n              options={stateOptions}\n              value={formData.address.state}\n              onChange={(value) => handleInputChange('address.state', value)}\n              required\n            />\n            <Input\n              label={t('settings.clinic.address.zipCode')}\n              value={formData.address.zipCode}\n              onChange={(e) => handleInputChange('address.zipCode', e.target.value)}\n              required\n            />\n          </div>\n        </div>\n      </Card>\n\n      {/* Operating Hours */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-6\">{t('settings.clinic.operatingHours.title')}</h3>\n        \n        <div className=\"space-y-4\">\n          {daysOfWeek.map((day) => {\n            const hours = formData.operatingHours.find(h => h.day === day.key);\n            if (!hours) return null;\n            return (\n              <div key={day.key} className=\"flex items-center gap-4\">\n                <div className=\"w-24\">\n                  <span className=\"text-sm font-medium text-gray-700\">{day.label}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={!hours.closed}\n                    onChange={(e) => handleOperatingHoursChange(day.key, 'closed', !e.target.checked)}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-600\">{t('settings.clinic.operatingHours.open')}</span>\n                </div>\n                {!hours.closed && (\n                  <>\n                    <Input\n                      type=\"time\"\n                      value={hours.open}\n                      onChange={(e) => handleOperatingHoursChange(day.key, 'open', e.target.value)}\n                      className=\"w-32\"\n                    />\n                    <span className=\"text-gray-500\">{t('settings.clinic.operatingHours.to')}</span>\n                    <Input\n                      type=\"time\"\n                      value={hours.close}\n                      onChange={(e) => handleOperatingHoursChange(day.key, 'close', e.target.value)}\n                      className=\"w-32\"\n                    />\n                  </>\n                )}\n                {hours.closed && (\n                  <span className=\"text-sm text-gray-500 italic\">{t('settings.clinic.operatingHours.closed')}</span>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </Card>\n\n      {/* Services */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-6\">{t('settings.clinic.services.title')}</h3>\n        \n        <div className=\"space-y-4\">\n          <div className=\"flex gap-2\">\n            <Input\n              placeholder={t('settings.clinic.services.addPlaceholder')}\n              value={newService}\n              onChange={(e) => setNewService(e.target.value)}\n              onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddService())}\n              className=\"flex-1\"\n            />\n            <Button\n              type=\"button\"\n              onClick={handleAddService}\n              disabled={!newService.trim()}\n            >\n              {t('settings.clinic.services.addButton')}\n            </Button>\n          </div>\n          \n          <div className=\"flex flex-wrap gap-2\">\n            {formData.services.map((service, index) => (\n              <Badge\n                key={index}\n                variant=\"secondary\"\n                className=\"flex items-center gap-1\"\n              >\n                {service}\n                <button\n                  type=\"button\"\n                  onClick={() => handleRemoveService(service)}\n                  className=\"ml-1 text-gray-400 hover:text-gray-600\"\n                >\n                  <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </Badge>\n            ))}\n          </div>\n        </div>\n      </Card>\n\n      {/* Submit Button */}\n      <div className=\"flex justify-end\">\n        <Button\n          onClick={handleSubmit}\n          isLoading={loading}\n          disabled={loading}\n        >\n          {t('settings.clinic.buttons.saveChanges')}\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default ClinicSettings;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\NotificationSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2554,2557],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2554,2557],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":118,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2902,2905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2902,2905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3137,3140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3137,3140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6385,6388],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6385,6388],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8823,8826],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8823,8826],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":291,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":291,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11358,11361],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11358,11361],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":324,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":324,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12982,12985],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12982,12985],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Bell, Mail, MessageSquare, Smartphone, Clock, CheckCircle, Save, AlertCircle } from 'lucide-react';\nimport api from '../../services/api';\nimport { toast } from 'react-hot-toast';\n\ninterface NotificationPreferences {\n  email: {\n    enabled: boolean;\n    appointments: boolean;\n    reminders: boolean;\n    cancellations: boolean;\n    prescriptions: boolean;\n    messages: boolean;\n  };\n  sms: {\n    enabled: boolean;\n    appointments: boolean;\n    reminders: boolean;\n    cancellations: boolean;\n    prescriptions: boolean;\n  };\n  inApp: {\n    enabled: boolean;\n    appointments: boolean;\n    reminders: boolean;\n    cancellations: boolean;\n    prescriptions: boolean;\n    messages: boolean;\n    system: boolean;\n  };\n  reminderIntervals: {\n    '24h': boolean;\n    '1h': boolean;\n    '15min': boolean;\n  };\n  quietHours: {\n    enabled: boolean;\n    start: string;\n    end: string;\n  };\n}\n\nconst NotificationSettings: React.FC = () => {\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [preferences, setPreferences] = useState<NotificationPreferences>({\n    email: {\n      enabled: true,\n      appointments: true,\n      reminders: true,\n      cancellations: true,\n      prescriptions: true,\n      messages: true\n    },\n    sms: {\n      enabled: false,\n      appointments: false,\n      reminders: false,\n      cancellations: false,\n      prescriptions: false\n    },\n    inApp: {\n      enabled: true,\n      appointments: true,\n      reminders: true,\n      cancellations: true,\n      prescriptions: true,\n      messages: true,\n      system: true\n    },\n    reminderIntervals: {\n      '24h': true,\n      '1h': true,\n      '15min': true\n    },\n    quietHours: {\n      enabled: false,\n      start: '22:00',\n      end: '08:00'\n    }\n  });\n\n  useEffect(() => {\n    fetchPreferences();\n  }, []);\n\n  const fetchPreferences = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get('/users/notification-preferences');\n      if (response.data.success && response.data.data) {\n        setPreferences(response.data.data);\n      }\n    } catch (error) {\n      console.error('Failed to fetch preferences:', error);\n      // Use defaults if fetch fails\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    try {\n      setSaving(true);\n      await api.put('/users/notification-preferences', preferences);\n      toast.success('Notification preferences saved successfully');\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Failed to save preferences');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const updatePreference = (category: keyof NotificationPreferences, key: string, value: boolean | string) => {\n    setPreferences(prev => ({\n      ...prev,\n      [category]: {\n        ...(prev[category] as any),\n        [key]: value\n      }\n    }));\n  };\n\n  const toggleAllInCategory = (category: 'email' | 'sms' | 'inApp', enabled: boolean) => {\n    setPreferences(prev => {\n      const categoryPrefs = prev[category];\n      const updated: any = { enabled };\n      \n      Object.keys(categoryPrefs).forEach(key => {\n        if (key !== 'enabled') {\n          updated[key] = enabled;\n        }\n      });\n      \n      return {\n        ...prev,\n        [category]: updated\n      };\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-6\">\n      {/* Header */}\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">Notification Settings</h1>\n        <p className=\"text-gray-600\">\n          Manage how and when you receive notifications about appointments, prescriptions, and messages.\n        </p>\n      </div>\n\n      {/* Email Notifications */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center\">\n            <div className=\"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3\">\n              <Mail className=\"w-5 h-5 text-blue-600\" />\n            </div>\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900\">Email Notifications</h2>\n              <p className=\"text-sm text-gray-600\">Receive updates via email</p>\n            </div>\n          </div>\n          <label className=\"flex items-center cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={preferences.email.enabled}\n              onChange={(e) => toggleAllInCategory('email', e.target.checked)}\n              className=\"sr-only peer\"\n            />\n            <div className=\"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n          </label>\n        </div>\n\n        {preferences.email.enabled && (\n          <div className=\"space-y-3 pl-13\">\n            {[\n              { key: 'appointments', label: 'Appointment confirmations', icon: CheckCircle },\n              { key: 'reminders', label: 'Appointment reminders', icon: Clock },\n              { key: 'cancellations', label: 'Cancellation notifications', icon: AlertCircle },\n              { key: 'prescriptions', label: 'Prescription updates', icon: Bell },\n              { key: 'messages', label: 'New messages', icon: MessageSquare }\n            ].map(({ key, label, icon: Icon }) => (\n              <label key={key} className=\"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer\">\n                <div className=\"flex items-center\">\n                  <Icon className=\"w-4 h-4 text-gray-400 mr-3\" />\n                  <span className=\"text-sm text-gray-700\">{label}</span>\n                </div>\n                <input\n                  type=\"checkbox\"\n                  checked={(preferences.email as any)[key]}\n                  onChange={(e) => updatePreference('email', key, e.target.checked)}\n                  className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                />\n              </label>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* SMS Notifications */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center\">\n            <div className=\"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mr-3\">\n              <Smartphone className=\"w-5 h-5 text-green-600\" />\n            </div>\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900\">SMS Notifications</h2>\n              <p className=\"text-sm text-gray-600\">Receive text messages for important updates</p>\n            </div>\n          </div>\n          <label className=\"flex items-center cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={preferences.sms.enabled}\n              onChange={(e) => toggleAllInCategory('sms', e.target.checked)}\n              className=\"sr-only peer\"\n            />\n            <div className=\"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600\"></div>\n          </label>\n        </div>\n\n        {preferences.sms.enabled && (\n          <div className=\"space-y-3 pl-13\">\n            {[\n              { key: 'appointments', label: 'Appointment confirmations' },\n              { key: 'reminders', label: 'Appointment reminders' },\n              { key: 'cancellations', label: 'Cancellation notifications' },\n              { key: 'prescriptions', label: 'Prescription ready notifications' }\n            ].map(({ key, label }) => (\n              <label key={key} className=\"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer\">\n                <span className=\"text-sm text-gray-700\">{label}</span>\n                <input\n                  type=\"checkbox\"\n                  checked={(preferences.sms as any)[key]}\n                  onChange={(e) => updatePreference('sms', key, e.target.checked)}\n                  className=\"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500\"\n                />\n              </label>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* In-App Notifications */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center\">\n            <div className=\"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mr-3\">\n              <Bell className=\"w-5 h-5 text-purple-600\" />\n            </div>\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900\">In-App Notifications</h2>\n              <p className=\"text-sm text-gray-600\">Show notifications in the application</p>\n            </div>\n          </div>\n          <label className=\"flex items-center cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={preferences.inApp.enabled}\n              onChange={(e) => toggleAllInCategory('inApp', e.target.checked)}\n              className=\"sr-only peer\"\n            />\n            <div className=\"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600\"></div>\n          </label>\n        </div>\n\n        {preferences.inApp.enabled && (\n          <div className=\"space-y-3 pl-13\">\n            {[\n              { key: 'appointments', label: 'Appointment updates' },\n              { key: 'reminders', label: 'Appointment reminders' },\n              { key: 'cancellations', label: 'Cancellations' },\n              { key: 'prescriptions', label: 'Prescription updates' },\n              { key: 'messages', label: 'New messages' },\n              { key: 'system', label: 'System notifications' }\n            ].map(({ key, label }) => (\n              <label key={key} className=\"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg cursor-pointer\">\n                <span className=\"text-sm text-gray-700\">{label}</span>\n                <input\n                  type=\"checkbox\"\n                  checked={(preferences.inApp as any)[key]}\n                  onChange={(e) => updatePreference('inApp', key, e.target.checked)}\n                  className=\"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500\"\n                />\n              </label>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Reminder Intervals */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n        <div className=\"mb-4\">\n          <div className=\"flex items-center mb-2\">\n            <Clock className=\"w-5 h-5 text-orange-600 mr-2\" />\n            <h2 className=\"text-lg font-semibold text-gray-900\">Appointment Reminder Schedule</h2>\n          </div>\n          <p className=\"text-sm text-gray-600\">Choose when to receive appointment reminders</p>\n        </div>\n\n        <div className=\"space-y-3\">\n          {[\n            { key: '24h', label: '24 hours before', description: 'Day before appointment' },\n            { key: '1h', label: '1 hour before', description: 'Shortly before appointment' },\n            { key: '15min', label: '15 minutes before', description: 'Last minute reminder' }\n          ].map(({ key, label, description }) => (\n            <label key={key} className=\"flex items-center justify-between p-4 hover:bg-gray-50 rounded-lg cursor-pointer border border-gray-200\">\n              <div>\n                <div className=\"text-sm font-medium text-gray-900\">{label}</div>\n                <div className=\"text-xs text-gray-500\">{description}</div>\n              </div>\n              <input\n                type=\"checkbox\"\n                checked={(preferences.reminderIntervals as any)[key]}\n                onChange={(e) => updatePreference('reminderIntervals', key, e.target.checked)}\n                className=\"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500\"\n              />\n            </label>\n          ))}\n        </div>\n      </div>\n\n      {/* Quiet Hours */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <div className=\"flex items-center mb-2\">\n              <Bell className=\"w-5 h-5 text-gray-600 mr-2\" />\n              <h2 className=\"text-lg font-semibold text-gray-900\">Quiet Hours</h2>\n            </div>\n            <p className=\"text-sm text-gray-600\">Don't send notifications during specified hours</p>\n          </div>\n          <label className=\"flex items-center cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={preferences.quietHours.enabled}\n              onChange={(e) => updatePreference('quietHours', 'enabled', e.target.checked)}\n              className=\"sr-only peer\"\n            />\n            <div className=\"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-gray-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-600\"></div>\n          </label>\n        </div>\n\n        {preferences.quietHours.enabled && (\n          <div className=\"grid grid-cols-2 gap-4 pl-7\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Start Time</label>\n              <input\n                type=\"time\"\n                value={preferences.quietHours.start}\n                onChange={(e) => updatePreference('quietHours', 'start', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">End Time</label>\n              <input\n                type=\"time\"\n                value={preferences.quietHours.end}\n                onChange={(e) => updatePreference('quietHours', 'end', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Save Button */}\n      <div className=\"flex justify-end\">\n        <button\n          onClick={handleSave}\n          disabled={saving}\n          className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center font-medium\"\n        >\n          {saving ? (\n            <>\n              <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2\"></div>\n              Saving...\n            </>\n          ) : (\n            <>\n              <Save className=\"w-5 h-5 mr-2\" />\n              Save Preferences\n            </>\n          )}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default NotificationSettings;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\ProfileSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1344,1347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1344,1347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1390,1393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1390,1393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5042,5045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5042,5045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5694,5697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5694,5697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6134,6137],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6134,6137],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":273,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":273,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9182,9185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9182,9185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":280,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":280,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9474,9477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9474,9477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":345,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12659,12662],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12659,12662],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport toast from 'react-hot-toast';\nimport { Card, Button, Input, Select, Alert, Avatar } from '../../components/ui';\nimport { useAuth } from '../../hooks/useAuth';\nimport { validateEmail, validatePhone, validateRequired, validateZipCode, validateDate } from '../../utils/validation';\n\ninterface FormData {\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone: string;\n  dateOfBirth: string;\n  gender: string;\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n  };\n  specialization: string;\n  licenseNumber: string;\n  bio: string;\n}\n\nconst ProfileSettings: React.FC = () => {\n  const { t } = useTranslation();\n  const { user, refreshUser } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [uploadingImage, setUploadingImage] = useState(false);\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\n  const [formData, setFormData] = useState<FormData>({\n    firstName: user?.firstName || '',\n    lastName: user?.lastName || '',\n    email: user?.email || '',\n    phone: user?.phone || '',\n    dateOfBirth: (user as any)?.dateOfBirth || '',\n    gender: (user as any)?.gender || '',\n    address: {\n      street: user?.address?.street || '',\n      city: user?.address?.city || '',\n      state: user?.address?.state || '',\n      zipCode: user?.address?.zipCode || '',\n      country: user?.address?.country || 'US'\n    },\n    specialization: user?.specialization || '',\n    licenseNumber: user?.licenseNumber || '',\n    bio: user?.bio || ''\n  });\n\n  useEffect(() => {\n    if (user) {\n      setFormData({\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        email: user.email || '',\n        phone: user.phone || '',\n        dateOfBirth: user.dateOfBirth || '',\n        gender: user.gender || '',\n        address: {\n          street: user.address?.street || '',\n          city: user.address?.city || '',\n          state: user.address?.state || '',\n          zipCode: user.address?.zipCode || '',\n          country: user.address?.country || 'US'\n        },\n        specialization: user.specialization || '',\n        licenseNumber: user.licenseNumber || '',\n        bio: user.bio || ''\n      });\n    }\n  }, [user]);\n\n  const handleInputChange = (field: string, value: string) => {\n    // Clear validation error for this field when user starts typing\n    if (validationErrors[field]) {\n      setValidationErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n\n    if (field.startsWith('address.')) {\n      const addressField = field.split('.')[1] as keyof typeof formData.address;\n      setFormData(prev => ({\n        ...prev,\n        address: {\n          ...prev.address,\n          [addressField]: value\n        }\n      }));\n    } else {\n      setFormData(prev => ({\n        ...prev,\n        [field]: value\n      }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const errors: Record<string, string> = {};\n\n    // Validate required fields\n    const firstNameValidation = validateRequired(formData.firstName, 'First name');\n    if (!firstNameValidation.isValid) {\n      errors.firstName = firstNameValidation.error!;\n    }\n\n    const lastNameValidation = validateRequired(formData.lastName, 'Last name');\n    if (!lastNameValidation.isValid) {\n      errors.lastName = lastNameValidation.error!;\n    }\n\n    // Validate email\n    const emailValidation = validateEmail(formData.email);\n    if (!emailValidation.isValid) {\n      errors.email = emailValidation.error!;\n    }\n\n    // Validate phone\n    const phoneValidation = validatePhone(formData.phone);\n    if (!phoneValidation.isValid) {\n      errors.phone = phoneValidation.error!;\n    }\n\n    // Validate date of birth\n    const dobValidation = validateDate(formData.dateOfBirth, 'Date of birth');\n    if (!dobValidation.isValid) {\n      errors.dateOfBirth = dobValidation.error!;\n    }\n\n    // Validate ZIP code\n    const zipValidation = validateZipCode(formData.address.zipCode);\n    if (!zipValidation.isValid) {\n      errors['address.zipCode'] = zipValidation.error!;\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    console.log(formData);\n    e.preventDefault();\n    setMessage(null);\n\n    // Validate form before submission\n    if (!validateForm()) {\n      const errorMsg = 'Please fix the validation errors before submitting';\n      toast.error(errorMsg);\n      setMessage({ type: 'error', text: errorMsg });\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const { updateProfile } = await import('../../services/userService');\n      \n      // Prepare update data - only include fields that can be updated\n      const updateData: any = {\n        firstName: formData.firstName,\n        lastName: formData.lastName,\n        phone: formData.phone,\n        dateOfBirth: formData.dateOfBirth,\n        gender: formData.gender,\n        address: formData.address\n      };\n\n      // Add professional fields for dentists\n      if (user?.role === 'dentist') {\n        updateData.specialization = formData.specialization;\n        updateData.licenseNumber = formData.licenseNumber;\n        updateData.bio = formData.bio;\n      }\n\n      await updateProfile(updateData);\n      \n      // Refresh user context to show updated data\n      try {\n        await refreshUser();\n      } catch (refreshErr: any) {\n        console.error('Failed to refresh user after profile update:', refreshErr);\n        // Don't show error to user as the update was successful\n      }\n      \n      toast.success(t('settings.profile.updateSuccess'));\n      setMessage({ type: 'success', text: t('settings.profile.updateSuccess') });\n      \n      // Auto-dismiss success message after 3 seconds\n      setTimeout(() => setMessage(null), 3000);\n    } catch (_error: any) {\n      console.error('Error updating profile:', {\n        error: _error,\n        message: _error.message,\n        status: _error.response?.status\n      });\n      \n      let errorMessage = t('settings.profile.updateError');\n      \n      // Handle specific error cases\n      if (_error.response?.status === 401) {\n        errorMessage = 'Your session has expired. Please log in again.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n        setTimeout(() => {\n          window.location.href = '/login';\n        }, 2000);\n      } else if (_error.response?.status === 403) {\n        errorMessage = 'You do not have permission to update this profile.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      } else if (_error.response?.status === 404) {\n        errorMessage = 'Profile not found. Please refresh the page and try again.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      } else if (_error.response?.status === 422) {\n        errorMessage = 'Invalid data provided. Please check your inputs and try again.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      } else if (_error.code === 'ERR_NETWORK' || _error.message.includes('Network Error')) {\n        errorMessage = 'Network error. Please check your internet connection and try again.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      } else {\n        errorMessage = _error instanceof Error ? _error.message : errorMessage;\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAvatarChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file size (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      const errorMsg = t('settings.profileSettings.messages.avatarSizeLimit');\n      toast.error(errorMsg);\n      setMessage({ type: 'error', text: errorMsg });\n      return;\n    }\n\n    // Validate file type (jpg, jpeg, png, gif)\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];\n    if (!validTypes.includes(file.type)) {\n      const errorMsg = t('settings.profileSettings.messages.avatarInvalidType');\n      toast.error(errorMsg);\n      setMessage({ type: 'error', text: errorMsg });\n      return;\n    }\n\n    try {\n      setUploadingImage(true);\n      setMessage(null);\n      \n      const { uploadProfileImage } = await import('../../services/userService');\n      await uploadProfileImage(file);\n      \n      const successMsg = t('settings.profileSettings.messages.avatarUploadSuccess');\n      toast.success(successMsg);\n      setMessage({ type: 'success', text: successMsg });\n      \n      // Refresh user context after successful upload\n      try {\n        await refreshUser();\n      } catch (refreshErr: any) {\n        console.error('Failed to refresh user after avatar upload:', refreshErr);\n        // Don't show error to user as the upload was successful\n      }\n      \n      // Auto-dismiss success message after 3 seconds\n      setTimeout(() => setMessage(null), 3000);\n    } catch (_error: any) {\n      console.error('Error uploading avatar:', {\n        error: _error,\n        message: _error.message,\n        status: _error.response?.status\n      });\n      \n      let errorMessage = t('settings.profileSettings.messages.avatarUploadError');\n      \n      // Handle specific error cases\n      if (_error.response?.status === 401) {\n        errorMessage = 'Your session has expired. Please log in again.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n        setTimeout(() => {\n          window.location.href = '/login';\n        }, 2000);\n      } else if (_error.response?.status === 413) {\n        errorMessage = 'File is too large. Please upload a smaller image.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      } else if (_error.code === 'ERR_NETWORK' || _error.message.includes('Network Error')) {\n        errorMessage = 'Network error. Please check your internet connection and try again.';\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      } else {\n        errorMessage = _error instanceof Error ? _error.message : errorMessage;\n        toast.error(errorMessage);\n        setMessage({ type: 'error', text: errorMessage });\n      }\n    } finally {\n      setUploadingImage(false);\n    }\n  };\n\n  const genderOptions = [\n    { value: '', label: t('settings.profileSettings.personalInfo.gender.select') },\n    { value: 'male', label: t('settings.profileSettings.personalInfo.gender.male') },\n    { value: 'female', label: t('settings.profileSettings.personalInfo.gender.female') },\n    { value: 'other', label: t('settings.profileSettings.personalInfo.gender.other') },\n    { value: 'prefer-not-to-say', label: t('settings.profileSettings.personalInfo.gender.preferNotToSay') }\n  ];\n\n  const stateOptions = [\n    { value: '', label: t('settings.profileSettings.personalInfo.address.state.select') },\n    { value: 'AL', label: t('settings.profileSettings.personalInfo.address.state.alabama') },\n    { value: 'AK', label: t('settings.profileSettings.personalInfo.address.state.alaska') },\n    { value: 'AZ', label: t('settings.profileSettings.personalInfo.address.state.arizona') },\n    { value: 'AR', label: t('settings.profileSettings.personalInfo.address.state.arkansas') },\n    { value: 'CA', label: t('settings.profileSettings.personalInfo.address.state.california') },\n    { value: 'CO', label: t('settings.profileSettings.personalInfo.address.state.colorado') },\n    { value: 'CT', label: t('settings.profileSettings.personalInfo.address.state.connecticut') },\n    { value: 'DE', label: t('settings.profileSettings.personalInfo.address.state.delaware') },\n    { value: 'FL', label: t('settings.profileSettings.personalInfo.address.state.florida') },\n    { value: 'GA', label: t('settings.profileSettings.personalInfo.address.state.georgia') },\n    // Add more states as needed\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Profile Header */}\n      <Card className=\"p-6\">\n        <div className=\"flex items-center gap-6\">\n          <div className=\"relative\">\n            <Avatar\n              src={(user as any)?.avatar}\n              alt={`${user?.firstName || ''} ${user?.lastName || ''}`}\n              size=\"xl\"\n              fallback={`${user?.firstName?.[0] || ''}${user?.lastName?.[0] || ''}`}\n            />\n            <label className={`absolute bottom-0 right-0 bg-blue-600 text-white rounded-full p-2 transition-all duration-300 shadow-lg transform ${uploadingImage || loading ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer hover:bg-blue-700 hover:shadow-xl hover:scale-110 active:scale-95'}`}>\n              {uploadingImage ? (\n                <svg className=\"w-4 h-4 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n              ) : (\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z\" />\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 13a3 3 0 11-6 0 3 3 0 016 0z\" />\n                </svg>\n              )}\n              <input\n                type=\"file\"\n                accept=\"image/jpeg,image/jpg,image/png,image/gif\"\n                onChange={handleAvatarChange}\n                className=\"hidden\"\n                disabled={uploadingImage || loading}\n              />\n            </label>\n          </div>\n          <div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">\n              {user?.firstName} {user?.lastName}\n            </h2>\n            <p className=\"text-gray-600\">{user?.email}</p>\n            <p className=\"text-sm text-gray-500 capitalize\">{user?.role}</p>\n          </div>\n        </div>\n      </Card>\n\n      {/* Profile Form */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-6\">{t('settings.profileSettings.personalInfo.title')}</h3>\n        \n        {message && (\n          <Alert\n            variant={message.type}\n            className=\"mb-6\"\n            dismissible\n          >\n            {message.text}\n          </Alert>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Basic Information */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <Input\n                label={t('settings.profileSettings.personalInfo.firstName')}\n                value={formData.firstName}\n                onChange={(e) => handleInputChange('firstName', e.target.value)}\n                required\n              />\n              {validationErrors.firstName && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.firstName}</p>\n              )}\n            </div>\n            <div>\n              <Input\n                label={t('settings.profileSettings.personalInfo.lastName')}\n                value={formData.lastName}\n                onChange={(e) => handleInputChange('lastName', e.target.value)}\n                required\n              />\n              {validationErrors.lastName && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.lastName}</p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <Input\n                label={t('settings.profileSettings.personalInfo.email')}\n                type=\"email\"\n                value={formData.email}\n                onChange={(e) => handleInputChange('email', e.target.value)}\n                required\n              />\n              {validationErrors.email && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.email}</p>\n              )}\n            </div>\n            <div>\n              <Input\n                label={t('settings.profileSettings.personalInfo.phone')}\n                type=\"tel\"\n                value={formData.phone}\n                onChange={(e) => handleInputChange('phone', e.target.value)}\n              />\n              {validationErrors.phone && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.phone}</p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <Input\n                label={t('settings.profileSettings.personalInfo.dob')}\n                type=\"date\"\n                value={formData.dateOfBirth}\n                onChange={(e) => handleInputChange('dateOfBirth', e.target.value)}\n              />\n              {validationErrors.dateOfBirth && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.dateOfBirth}</p>\n              )}\n            </div>\n            <Select\n              label={t('settings.profileSettings.personalInfo.gender.label')}\n              options={genderOptions}\n              value={formData.gender}\n              onChange={(e) => handleInputChange('gender', e.target.value)}\n            />\n          </div>\n\n          {/* Address */}\n          <div className=\"border-t border-gray-200 pt-6\">\n                          <h4 className=\"text-md font-medium text-gray-900 mb-4\">{t('settings.profileSettings.personalInfo.address.title')}</h4>\n            <div className=\"space-y-4\">\n              <Input\n                                  label={t('settings.profileSettings.personalInfo.address.street')}\n                value={formData.address.street}\n                onChange={(e) => handleInputChange('address.street', e.target.value)}\n              />\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <Input\n                  label={t('settings.profileSettings.personalInfo.address.city')}\n                  value={formData.address.city}\n                  onChange={(e) => handleInputChange('address.city', e.target.value)}\n                />\n                <Select\n                  label={t('settings.profileSettings.personalInfo.address.state.label')}\n                  options={stateOptions}\n                  value={formData.address.state}\n                  onChange={(e) => handleInputChange('address.state', e.target.value)}\n                />\n                <div>\n                  <Input\n                    label={t('settings.profileSettings.personalInfo.address.zip')}\n                    value={formData.address.zipCode}\n                    onChange={(e) => handleInputChange('address.zipCode', e.target.value)}\n                  />\n                  {validationErrors['address.zipCode'] && (\n                    <p className=\"mt-1 text-sm text-red-600\">{validationErrors['address.zipCode']}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Professional Information (for dentists) */}\n          {user?.role === 'dentist' && (\n            <div className=\"border-t border-gray-200 pt-6\">\n              <h4 className=\"text-md font-medium text-gray-900 mb-4\">{t('settings.profileSettings.professionalInfo.title')}</h4>\n              <div className=\"space-y-4\">\n                <Input\n                                      label={t('settings.profileSettings.professionalInfo.specialization')}\n                  value={formData.specialization}\n                  onChange={(e) => handleInputChange('specialization', e.target.value)}\n                                      placeholder={t('settings.profileSettings.professionalInfo.specializationPlaceholder')}\n                />\n                <Input\n                                      label={t('settings.profileSettings.professionalInfo.licenseNumber')}\n                  value={formData.licenseNumber}\n                  onChange={(e) => handleInputChange('licenseNumber', e.target.value)}\n                />\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    {t('settings.profileSettings.professionalInfo.bio')}\n                  </label>\n                  <textarea\n                    rows={4}\n                    value={formData.bio}\n                    onChange={(e) => handleInputChange('bio', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n                    placeholder={t('settings.profileSettings.professionalInfo.bioPlaceholder')}\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Submit Button */}\n          <div className=\"flex justify-end pt-6 border-t border-gray-200\">\n            <Button\n              type=\"submit\"\n              isLoading={loading}\n              disabled={loading || uploadingImage}\n            >\n              {loading ? 'Saving...' : t('settings.profile.saveChanges')}\n            </Button>\n          </div>\n        </form>\n      </Card>\n    </div>\n  );\n};\n\nexport default ProfileSettings;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\SecuritySettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\Settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\settings\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\pages\\treatments\\Treatments.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\__tests__\\clinicBranchService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\__tests__\\dentistService.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":395,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":395,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11086,11089],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11086,11089],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Tests for dentist service API error scenarios\r\n * Covers 404 errors, network failures, and malformed data handling\r\n */\r\n\r\nimport axios from 'axios';\r\nimport { dentistService } from '../dentistService';\r\n\r\n// Mock axios\r\njest.mock('axios');\r\nconst mockedAxios = axios as jest.Mocked<typeof axios>;\r\n\r\n// Mock console methods\r\nconst consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();\r\nconst consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n\r\ndescribe('dentistService API Error Scenarios', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    consoleErrorSpy.mockClear();\r\n    consoleWarnSpy.mockClear();\r\n  });\r\n\r\n  afterAll(() => {\r\n    consoleErrorSpy.mockRestore();\r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n\r\n  describe('getDentistById', () => {\r\n    it('should handle 404 errors gracefully', async () => {\r\n      const error404 = {\r\n        response: {\r\n          status: 404,\r\n          data: { message: 'Dentist not found' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(error404);\r\n\r\n      await expect(dentistService.getDentistById('nonexistent-id')).rejects.toThrow();\r\n    });\r\n\r\n    it('should handle network errors', async () => {\r\n      const networkError = {\r\n        code: 'ERR_NETWORK',\r\n        message: 'Network Error'\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(networkError);\r\n\r\n      await expect(dentistService.getDentistById('test-id')).rejects.toThrow();\r\n    });\r\n\r\n    it('should handle malformed response data', async () => {\r\n      const malformedResponse = {\r\n        status: 200,\r\n        data: {\r\n          // Missing 'data' property\r\n          message: 'Success'\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(malformedResponse);\r\n\r\n      // Should handle malformed data gracefully\r\n      const result = await dentistService.getDentistById('test-id').catch(e => e);\r\n      expect(result).toBeInstanceOf(Error);\r\n    });\r\n\r\n    it('should handle response with null data', async () => {\r\n      const nullDataResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: null\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(nullDataResponse);\r\n\r\n      const result = await dentistService.getDentistById('test-id').catch(e => e);\r\n      expect(result).toBeInstanceOf(Error);\r\n    });\r\n\r\n    it('should handle response with invalid data structure', async () => {\r\n      const invalidDataResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: 'invalid-string-instead-of-object'\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(invalidDataResponse);\r\n\r\n      const result = await dentistService.getDentistById('test-id').catch(e => e);\r\n      expect(result).toBeInstanceOf(Error);\r\n    });\r\n  });\r\n\r\n  describe('updateDentist', () => {\r\n    const updateData = {\r\n      firstName: 'John',\r\n      lastName: 'Doe'\r\n    };\r\n\r\n    it('should handle 422 validation errors', async () => {\r\n      const validationError = {\r\n        response: {\r\n          status: 422,\r\n          data: { message: 'Invalid data provided' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.put.mockRejectedValueOnce(validationError);\r\n\r\n      await expect(dentistService.updateDentist('test-id', updateData)).rejects.toThrow();\r\n    });\r\n\r\n    it('should handle server errors during update', async () => {\r\n      const serverError = {\r\n        response: {\r\n          status: 500,\r\n          data: { message: 'Internal server error' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.put.mockRejectedValueOnce(serverError);\r\n\r\n      await expect(dentistService.updateDentist('test-id', updateData)).rejects.toThrow();\r\n    });\r\n\r\n    it('should handle malformed update response', async () => {\r\n      const malformedResponse = {\r\n        status: 200,\r\n        data: {\r\n          // Missing updated data\r\n          message: 'Updated successfully'\r\n        }\r\n      };\r\n\r\n      mockedAxios.put.mockResolvedValueOnce(malformedResponse);\r\n\r\n      const result = await dentistService.updateDentist('test-id', updateData).catch(e => e);\r\n      expect(result).toBeInstanceOf(Error);\r\n    });\r\n  });\r\n\r\n  describe('getDentistClinics', () => {\r\n    it('should handle 404 errors and return empty array', async () => {\r\n      const error404 = {\r\n        response: {\r\n          status: 404,\r\n          data: { message: 'Clinics not found' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(error404);\r\n\r\n      const result = await dentistService.getDentistClinics('test-id');\r\n\r\n      expect(Array.isArray(result)).toBe(true);\r\n      expect(result.length).toBe(0);\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('404 error when fetching dentist clinics'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle network errors gracefully', async () => {\r\n      const networkError = {\r\n        code: 'ERR_NETWORK',\r\n        message: 'Network Error'\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(networkError);\r\n\r\n      await expect(dentistService.getDentistClinics('test-id')).rejects.toThrow();\r\n    });\r\n\r\n    it('should handle malformed clinics data', async () => {\r\n      const malformedResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: 'not-an-array'\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(malformedResponse);\r\n\r\n      const result = await dentistService.getDentistClinics('test-id');\r\n\r\n      expect(Array.isArray(result)).toBe(true);\r\n      expect(result.length).toBe(0);\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('Invalid clinics data format'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle null clinics data', async () => {\r\n      const nullDataResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: null\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(nullDataResponse);\r\n\r\n      const result = await dentistService.getDentistClinics('test-id');\r\n\r\n      expect(Array.isArray(result)).toBe(true);\r\n      expect(result.length).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('getDentistAppointments', () => {\r\n    it('should handle 404 errors and return empty result', async () => {\r\n      const error404 = {\r\n        response: {\r\n          status: 404,\r\n          data: { message: 'Appointments not found' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(error404);\r\n\r\n      const result = await getDentistAppointments('test-id');\r\n\r\n      expect(result).toEqual({\r\n        data: [],\r\n        total: 0,\r\n        page: 1,\r\n        limit: 10,\r\n        totalPages: 0\r\n      });\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('404 error when fetching dentist appointments'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle malformed appointments data', async () => {\r\n      const malformedResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: 'invalid-data'\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(malformedResponse);\r\n\r\n      const result = await getDentistAppointments('test-id');\r\n\r\n      expect(result).toEqual({\r\n        data: [],\r\n        total: 0,\r\n        page: 1,\r\n        limit: 10,\r\n        totalPages: 0\r\n      });\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('Invalid appointments data format'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle missing response data', async () => {\r\n      const emptyResponse = {\r\n        status: 200,\r\n        data: null\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(emptyResponse);\r\n\r\n      const result = await getDentistAppointments('test-id');\r\n\r\n      expect(result).toEqual({\r\n        data: [],\r\n        total: 0,\r\n        page: 1,\r\n        limit: 10,\r\n        totalPages: 0\r\n      });\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('No response data received for appointments'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle appointments data that is not an array', async () => {\r\n      const invalidArrayResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: { appointments: 'not-an-array' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(invalidArrayResponse);\r\n\r\n      const result = await getDentistAppointments('test-id');\r\n\r\n      expect(result).toEqual({\r\n        data: [],\r\n        total: 0,\r\n        page: 1,\r\n        limit: 10,\r\n        totalPages: 0\r\n      });\r\n    });\r\n\r\n    it('should handle timeout errors', async () => {\r\n      const timeoutError = {\r\n        code: 'ETIMEDOUT',\r\n        message: 'Request timed out'\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(timeoutError);\r\n\r\n      await expect(getDentistAppointments('test-id')).rejects.toThrow();\r\n    });\r\n  });\r\n\r\n  describe('getDentistAvailability', () => {\r\n    it('should handle 404 errors and return empty array', async () => {\r\n      const error404 = {\r\n        response: {\r\n          status: 404,\r\n          data: { message: 'Availability not found' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(error404);\r\n\r\n      const result = await getDentistAvailability('test-id');\r\n\r\n      expect(result).toEqual([]);\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('404 error when fetching dentist availability'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle malformed availability data', async () => {\r\n      const malformedResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: 'not-an-array'\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(malformedResponse);\r\n\r\n      const result = await getDentistAvailability('test-id');\r\n\r\n      expect(result).toEqual([]);\r\n      expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n        expect.stringContaining('Invalid availability data format'),\r\n        expect.any(Object)\r\n      );\r\n    });\r\n\r\n    it('should handle server errors', async () => {\r\n      const serverError = {\r\n        response: {\r\n          status: 500,\r\n          data: { message: 'Server error' }\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockRejectedValueOnce(serverError);\r\n\r\n      await expect(getDentistAvailability('test-id')).rejects.toThrow();\r\n    });\r\n  });\r\n\r\n  describe('Edge cases and boundary conditions', () => {\r\n    it('should handle extremely large response data', async () => {\r\n      const largeArray = new Array(10000).fill(0).map((_, i) => ({ id: i, name: `Item ${i}` }));\r\n      const largeResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: largeArray\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(largeResponse);\r\n\r\n      const result = await getDentistClinics('test-id');\r\n\r\n      expect(result.data).toHaveLength(10000);\r\n      expect(result.total).toBe(10000);\r\n    });\r\n\r\n    it('should handle response with circular references', async () => {\r\n      const circularData: any = { id: 1, name: 'Test' };\r\n      circularData.self = circularData;\r\n\r\n      const circularResponse = {\r\n        status: 200,\r\n        data: {\r\n          data: [circularData]\r\n        }\r\n      };\r\n\r\n      mockedAxios.get.mockResolvedValueOnce(circularResponse);\r\n\r\n      // Should not throw an error due to circular reference\r\n      const result = await getDentistClinics('test-id');\r\n\r\n      expect(result.data).toHaveLength(1);\r\n      expect(result.data[0].id).toBe(1);\r\n    });\r\n\r\n    it('should handle concurrent API calls with mixed success/failure', async () => {\r\n      // Mock different responses for concurrent calls\r\n      mockedAxios.get\r\n        .mockResolvedValueOnce({ status: 200, data: { data: { id: 1, name: 'Test' } } })\r\n        .mockRejectedValueOnce({ response: { status: 404 } })\r\n        .mockResolvedValueOnce({ status: 200, data: { data: [] } });\r\n\r\n      const [profileResult, clinicsResult, availabilityResult] = await Promise.allSettled([\r\n        getDentistProfile('test-id'),\r\n        getDentistClinics('test-id'),\r\n        getDentistAvailability('test-id')\r\n      ]);\r\n\r\n      expect(profileResult.status).toBe('fulfilled');\r\n      expect(clinicsResult.status).toBe('fulfilled');\r\n      expect(availabilityResult.status).toBe('fulfilled');\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\adminService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":196,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":196,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5194,5197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5194,5197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":204,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5437,5440],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5437,5440],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":286,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":286,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7553,7556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7553,7556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":302,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":302,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8200,8203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8200,8203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":316,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":316,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8688,8691],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8688,8691],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":322,"column":128,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":322,"endColumn":131,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8886,8889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8886,8889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":331,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9379,9382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9379,9382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":336,"column":135,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":336,"endColumn":138,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9633,9636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9633,9636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":341,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":341,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9828,9831],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9828,9831],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":346,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":346,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10018,10021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10018,10021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":351,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":351,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10213,10216],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10213,10216],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":356,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10409,10412],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10409,10412],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":361,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":361,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10623,10626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10623,10626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10832,10835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10832,10835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":371,"column":151,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":371,"endColumn":154,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11108,11111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11108,11111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":376,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":376,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11314,11317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11314,11317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":381,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":381,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11531,11534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11531,11534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { api } from './index';\r\n\r\nexport interface MultiClinicDashboardData {\r\n  overallStats: {\r\n    totalPatients: number;\r\n    newPatients: number;\r\n    totalAppointments: number;\r\n    totalRevenue: number;\r\n    totalSchedules: number;\r\n  };\r\n  clinics: Array<{\r\n    clinic: {\r\n      id: string;\r\n      name: string;\r\n      email: string;\r\n      phone: string;\r\n      address: string;\r\n      isActive: boolean;\r\n      staffCount: number;\r\n    };\r\n    metrics: {\r\n      patients: {\r\n        total: number;\r\n        new: number;\r\n        demographics: Array<{ _id: string; count: number }>;\r\n      };\r\n      appointments: {\r\n        total: number;\r\n        statusBreakdown: Array<{ _id: string; count: number }>;\r\n        dailyTrend: Array<{ _id: { year: number; month: number; day: number }; count: number }>;\r\n      };\r\n      billing: {\r\n        totalRevenue: number;\r\n        revenueByStatus: Array<{ _id: string; amount: number; count: number }>;\r\n        dailyRevenue: Array<{ _id: { year: number; month: number; day: number }; revenue: number }>;\r\n      };\r\n      staffSchedules: {\r\n        total: number;\r\n        statusBreakdown: Array<{ _id: string; count: number }>;\r\n        shiftTypeBreakdown: Array<{ _id: string; count: number }>;\r\n        staffUtilization: Array<{\r\n          _id: string;\r\n          staffName: string;\r\n          role: string;\r\n          scheduledHours: number;\r\n          scheduleCount: number;\r\n        }>;\r\n      };\r\n    };\r\n  }>;\r\n  period: string;\r\n  dateRange: {\r\n    start: string;\r\n    end: string;\r\n  };\r\n}\r\n\r\nexport interface ClinicPerformanceMetrics {\r\n  clinicId: string;\r\n  clinicName: string;\r\n  efficiency: {\r\n    appointmentCompletionRate: number;\r\n    appointmentCancellationRate: number;\r\n    appointmentNoShowRate: number;\r\n  };\r\n  patientSatisfaction: {\r\n    averageRating: number;\r\n    totalReviews: number;\r\n  };\r\n  revenue: {\r\n    totalRevenue: number;\r\n    averageRevenuePerAppointment: number;\r\n    collectionRate: number;\r\n  };\r\n  staffProductivity: {\r\n    scheduleCompletionRate: number;\r\n    totalHours: number;\r\n    averageHoursPerSchedule: number;\r\n  };\r\n}\r\n\r\nexport interface MultiClinicDashboardParams {\r\n  period?: '7d' | '30d' | '90d' | '1y';\r\n  clinicIds?: string[];\r\n}\r\n\r\nexport interface ClinicPerformanceParams {\r\n  period?: '7d' | '30d' | '90d' | '1y';\r\n  metrics?: string[];\r\n}\r\n\r\n/**\r\n * Get multi-clinic dashboard data\r\n */\r\nexport const getMultiClinicDashboard = async (params?: MultiClinicDashboardParams): Promise<MultiClinicDashboardData> => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  if (params?.period) {\r\n    queryParams.append('period', params.period);\r\n  }\r\n  \r\n  if (params?.clinicIds && params.clinicIds.length > 0) {\r\n    params.clinicIds.forEach(id => queryParams.append('clinicIds', id));\r\n  }\r\n  \r\n  const response = await api.get(`/admin/multi-clinic/dashboard?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get clinic performance metrics\r\n */\r\nexport const getClinicPerformanceMetrics = async (params?: ClinicPerformanceParams): Promise<ClinicPerformanceMetrics[]> => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  if (params?.period) {\r\n    queryParams.append('period', params.period);\r\n  }\r\n  \r\n  if (params?.metrics && params.metrics.length > 0) {\r\n    params.metrics.forEach(metric => queryParams.append('metrics', metric));\r\n  }\r\n  \r\n  const response = await api.get(`/admin/clinics/performance?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get staff schedule analytics\r\n */\r\nexport const getStaffScheduleAnalytics = async (clinicId?: string, period?: string) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  if (clinicId) {\r\n    queryParams.append('clinicId', clinicId);\r\n  }\r\n  \r\n  if (period) {\r\n    queryParams.append('period', period);\r\n  }\r\n  \r\n  const response = await api.get(`/staff-schedules/analytics?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get staff schedules with filtering\r\n */\r\nexport const getStaffSchedules = async (params?: {\r\n  clinicId?: string;\r\n  staffId?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  status?: string;\r\n  page?: number;\r\n  limit?: number;\r\n}) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  if (params) {\r\n    Object.entries(params).forEach(([key, value]) => {\r\n      if (value !== undefined && value !== null) {\r\n        queryParams.append(key, value.toString());\r\n      }\r\n    });\r\n  }\r\n  \r\n  const response = await api.get(`/staff-schedules?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Check staff availability\r\n */\r\nexport const checkStaffAvailability = async (params: {\r\n  staffId: string;\r\n  date: string;\r\n  startTime?: string;\r\n  endTime?: string;\r\n}) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  Object.entries(params).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null) {\r\n      queryParams.append(key, value.toString());\r\n    }\r\n  });\r\n  \r\n  const response = await api.get(`/staff-schedules/availability?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Create a new staff schedule\r\n */\r\nexport const createStaffSchedule = async (scheduleData: any) => {\r\n  const response = await api.post('/api/v1/staff-schedules', scheduleData);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Update an existing staff schedule\r\n */\r\nexport const updateStaffSchedule = async (scheduleId: string, scheduleData: any) => {\r\n  const response = await api.put(`/staff-schedules/${scheduleId}`, scheduleData);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Delete a staff schedule\r\n */\r\nexport const deleteStaffSchedule = async (scheduleId: string) => {\r\n  const response = await api.delete(`/staff-schedules/${scheduleId}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get staff schedule by ID\r\n */\r\nexport const getStaffScheduleById = async (scheduleId: string) => {\r\n  const response = await api.get(`/staff-schedules/${scheduleId}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get all clinics (admin)\r\n */\r\nexport const getAdminClinics = async () => {\r\n  const response = await api.get('/api/v1/admin/clinics');\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get staff members by clinic\r\n */\r\nexport const getStaffByClinic = async (clinicId: string) => {\r\n  const response = await api.get(`/admin/clinics/${clinicId}/staff`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Detect schedule conflicts\r\n */\r\nexport const detectScheduleConflicts = async (params: {\r\n  clinicId: string;\r\n  staffId?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n}) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  Object.entries(params).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null) {\r\n      queryParams.append(key, value.toString());\r\n    }\r\n  });\r\n  \r\n  const response = await api.get(`/staff-schedules/conflicts?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get calendar view of schedules\r\n */\r\nexport const getScheduleCalendarView = async (params: {\r\n  clinicId: string;\r\n  startDate: string;\r\n  endDate: string;\r\n  staffId?: string;\r\n}) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  Object.entries(params).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null) {\r\n      queryParams.append(key, value.toString());\r\n    }\r\n  });\r\n  \r\n  const response = await api.get(`/staff-schedules/calendar?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get admin clinic overview with comprehensive data\r\n */\r\nexport const getAdminClinicOverview = async (params?: any) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  if (params?.page) queryParams.append('page', params.page.toString());\r\n  if (params?.limit) queryParams.append('limit', params.limit.toString());\r\n  if (params?.search) queryParams.append('search', params.search);\r\n  if (params?.status) queryParams.append('status', params.status);\r\n  if (params?.sortBy) queryParams.append('sortBy', params.sortBy);\r\n  \r\n  const response = await api.get(`/admin/clinics/overview?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\n/**\r\n * Get detailed clinic data\r\n */\r\nexport const getClinicDetailedData = async (clinicId: string, params?: any) => {\r\n  const queryParams = new URLSearchParams();\r\n  \r\n  if (params?.startDate) queryParams.append('startDate', params.startDate);\r\n  if (params?.endDate) queryParams.append('endDate', params.endDate);\r\n  \r\n  const response = await api.get(`/admin/clinics/${clinicId}/detailed?${queryParams.toString()}`);\r\n  return response.data;\r\n};\r\n\r\nexport interface HomepageContentPayload {\r\n  title: string;\r\n  sectionKey: string;\r\n  type: 'text' | 'image' | 'video';\r\n  data: Record<string, any>;\r\n  order?: number;\r\n  visible?: boolean;\r\n  note?: string;\r\n}\r\n\r\nexport const getHomepageContentBlocks = async (params?: { status?: string; sectionKey?: string; visible?: boolean; }): Promise<any> => {\r\n  const query = new URLSearchParams();\r\n  if (params?.status) query.append('status', params.status);\r\n  if (params?.sectionKey) query.append('sectionKey', params.sectionKey);\r\n  if (typeof params?.visible !== 'undefined') query.append('visible', String(params.visible));\r\n  const response = await api.get(`/api/v1/admin/homepage/blocks?${query.toString()}`);\r\n  return response.data;\r\n};\r\n\r\nexport const createHomepageContentBlock = async (payload: HomepageContentPayload): Promise<any> => {\r\n  const response = await api.post('/api/v1/admin/homepage/blocks', payload);\r\n  return response.data;\r\n};\r\n\r\nexport const updateHomepageContentBlock = async (id: string, payload: Partial<HomepageContentPayload & { status?: string }>): Promise<any> => {\r\n  const response = await api.put(`/api/v1/admin/homepage/blocks/${id}`, payload);\r\n  return response.data;\r\n};\r\n\r\nexport const deleteHomepageContentBlock = async (id: string): Promise<any> => {\r\n  const response = await api.delete(`/api/v1/admin/homepage/blocks/${id}`);\r\n  return response.data;\r\n};\r\n\r\nexport const publishHomepageContentBlock = async (id: string): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage/blocks/${id}/publish`);\r\n  return response.data;\r\n};\r\n\r\nexport const submitHomepageContentBlock = async (id: string): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage-content/${id}/submit`);\r\n  return response.data;\r\n};\r\n\r\nexport const approveHomepageContentBlock = async (id: string): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage-content/${id}/approve`);\r\n  return response.data;\r\n};\r\n\r\nexport const rejectHomepageContentBlock = async (id: string, comment?: string): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage-content/${id}/reject`, { comment });\r\n  return response.data;\r\n};\r\n\r\nexport const publishHomepageContentBlock = async (id: string): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage-content/${id}/publish`);\r\n  return response.data;\r\n};\r\n\r\nexport const scheduleHomepageContentBlock = async (id: string, payload: { scheduledFor?: string; scheduledTo?: string; timezone?: string; }): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage-content/${id}/schedule`, payload);\r\n  return response.data;\r\n};\r\n\r\nexport const getHomepageContentVersions = async (id: string): Promise<any> => {\r\n  const response = await api.get(`/api/v1/admin/homepage-content/${id}/versions`);\r\n  return response.data;\r\n};\r\n\r\nexport const revertHomepageContentVersion = async (id: string, versionId: string): Promise<any> => {\r\n  const response = await api.post(`/api/v1/admin/homepage-content/${id}/versions/${versionId}/revert`);\r\n  return response.data;\r\n};\r\n\r\nexport default {\r\n  getMultiClinicDashboard,\r\n  getClinicPerformanceMetrics,\r\n  getStaffScheduleAnalytics,\r\n  getStaffSchedules,\r\n  checkStaffAvailability,\r\n  createStaffSchedule,\r\n  updateStaffSchedule,\r\n  deleteStaffSchedule,\r\n  getStaffScheduleById,\r\n  getAdminClinics,\r\n  getStaffByClinic,\r\n  detectScheduleConflicts,\r\n  getScheduleCalendarView,\r\n  getAdminClinicOverview,\r\n  getClinicDetailedData,\r\n  getHomepageContentBlocks,\r\n  createHomepageContentBlock,\r\n  updateHomepageContentBlock,\r\n  deleteHomepageContentBlock,\r\n  submitHomepageContentBlock,\r\n  approveHomepageContentBlock,\r\n  rejectHomepageContentBlock,\r\n  publishHomepageContentBlock,\r\n  scheduleHomepageContentBlock,\r\n  getHomepageContentVersions,\r\n  revertHomepageContentVersion\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\api.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2839,2842],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2839,2842],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3015,3018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3015,3018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3036,3039],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3036,3039],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3277,3280],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3277,3280],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3830,3833],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3830,3833],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3894,3897],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3894,3897],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4488,4491],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4488,4491],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":144,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5606,5609],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5606,5609],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5822,5825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5822,5825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":182,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6608,6611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6608,6611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":208,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7364,7367],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7364,7367],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7793,7796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7793,7796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":250,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8444,8447],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8444,8447],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axios from 'axios';\r\nimport type { AxiosInstance, AxiosResponse, AxiosError } from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\n// API Configuration\r\nconst API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\r\n\r\n// Create axios instance\r\nconst api: AxiosInstance = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 30000, // Increased to 30 seconds\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  // Add retry configuration\r\n  maxRedirects: 3,\r\n  validateStatus: (status) => {\r\n    return status >= 200 && status < 300; // Only accept 2xx status codes\r\n  },\r\n});\r\n\r\n// Request interceptor for adding auth token and debugging\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    \r\n    // Debug logging for clinic-related requests (only in development)\r\n    if (import.meta.env.DEV && config.params && config.params.clinicId) {\r\n      console.log(' API Request:', {\r\n        url: config.url,\r\n        method: config.method?.toUpperCase(),\r\n        clinicId: config.params.clinicId,\r\n        clinicIdType: typeof config.params.clinicId\r\n      });\r\n      \r\n      // Check if clinicId is an object (which would cause the 400 error)\r\n      if (typeof config.params.clinicId === 'object') {\r\n        console.error(' FOUND OBJECT CLINIC ID - FIXING:', config.params.clinicId);\r\n        // Try to extract the ID if it's an object\r\n        if (config.params.clinicId && config.params.clinicId.id) {\r\n          config.params.clinicId = config.params.clinicId.id;\r\n          console.log(' Fixed clinic ID:', config.params.clinicId);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor for handling errors\r\napi.interceptors.response.use(\r\n  (response: AxiosResponse) => {\r\n    return response;\r\n  },\r\n  (error: AxiosError) => {\r\n    if (error.response) {\r\n      const { status, data } = error.response;\r\n      \r\n      switch (status) {\r\n        case 401:\r\n          // Unauthorized - redirect to login\r\n          localStorage.removeItem('token');\r\n          localStorage.removeItem('refreshToken');\r\n          // Don't redirect during API calls to prevent navigation loops\r\n          // window.location.href = '/login';\r\n          toast.error('Session expired. Please login again.');\r\n          break;\r\n        case 403:\r\n          toast.error('Access denied. You don\\'t have permission for this action.');\r\n          break;\r\n        case 404:\r\n          // Provide more context for 404 errors\r\n          if (data && typeof data === 'object' && 'message' in data) {\r\n            // Check if the error is specifically about /appointments endpoint\r\n            if ((data as any).message.includes('/appointments')) {\r\n              toast.error(\"Resource not found. The appointment service is currently unavailable.\");\r\n            } else if ((data as any).url && (data as any).url.includes('/appointments/available-slots')) {\r\n              toast.error(\"Error fetching time slots: The time slot service is currently unavailable.\");\r\n            } else {\r\n              toast.error(`Resource not found: ${(data as any).message}`);\r\n            }\r\n          } else if (error.config && error.config.url && error.config.url.includes('/appointments/available-slots')) {\r\n            toast.error(\"Error fetching time slots: The time slot service is currently unavailable.\");\r\n          } else {\r\n            toast.error('Resource not found. The requested endpoint may not exist.');\r\n          }\r\n          break;\r\n        case 422:\r\n          // Validation errors\r\n          if (data && typeof data === 'object' && 'errors' in data) {\r\n            const errors = (data as any).errors;\r\n            Object.values(errors).forEach((error: any) => {\r\n              toast.error(error);\r\n            });\r\n          } else {\r\n            toast.error('Validation failed. Please check your input.');\r\n          }\r\n          break;\r\n        case 500:\r\n          toast.error('Server error. Please try again later.');\r\n          break;\r\n        default:\r\n          toast.error('An error occurred. Please try again.');\r\n      }\r\n    } else if (error.request) {\r\n      // Network error - no response received\r\n      console.error('Network error details:', {\r\n        message: error.message,\r\n        code: error.code,\r\n        errno: (error as any).errno\r\n      });\r\n      \r\n      // Handle ERR_ABORTED errors silently without showing toast messages\r\n      if (error.code === 'ERR_ABORTED') {\r\n        console.warn('Request was aborted:', error.message);\r\n        // Return a resolved promise to prevent error propagation for aborted requests\r\n        return Promise.resolve({ data: null, status: 'aborted' });\r\n      } else if (error.code === 'ERR_CONNECTION_RESET') {\r\n        toast.error('Connection was reset. Please check your internet connection and try again.');\r\n      } else if (error.code === 'ECONNREFUSED') {\r\n        toast.error('Cannot connect to server. Please ensure the backend server is running.');\r\n      } else if (error.code === 'ETIMEDOUT') {\r\n        toast.error('Request timed out. Please try again.');\r\n      } else {\r\n        toast.error('Network error. Please check your connection.');\r\n      }\r\n    } else {\r\n      console.error('Unexpected error:', error);\r\n      toast.error('An unexpected error occurred.');\r\n    }\r\n    \r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Generic API response type\r\nexport interface ApiResponse<T = any> {\r\n  success: boolean;\r\n  data?: T;\r\n  message?: string;\r\n  errors?: Record<string, string[]>;\r\n}\r\n\r\n// Generic API methods\r\nexport const apiService = {\r\n  // GET request\r\n  get: async <T>(url: string, params?: any): Promise<ApiResponse<T>> => {\r\n    try {\r\n      const response = await api.get(url, { params });\r\n      \r\n      // Handle nested data structure from backend\r\n      // Backend returns { status: \"success\", data: { ... } }\r\n      if (response.data && response.data.status === 'success') {\r\n        return {\r\n          success: true,\r\n          data: response.data.data, // Extract the nested data\r\n          message: response.data.message\r\n        };\r\n      }\r\n      \r\n      // Fallback for other response formats\r\n      return {\r\n        success: true,\r\n        data: response.data,\r\n      };\r\n    } catch (_error) {\r\n      return {\r\n        success: false,\r\n        message: 'Failed to fetch data',\r\n      };\r\n    }\r\n  },\r\n\r\n  // POST request\r\n  post: async <T>(url: string, data?: any): Promise<ApiResponse<T>> => {\r\n    try {\r\n      console.log('Making POST request to:', url);\r\n      console.log('Request data:', data);\r\n      \r\n      const response = await api.post(url, data);\r\n      \r\n      console.log('POST response received:', {\r\n        status: response.status,\r\n        statusText: response.statusText,\r\n        hasData: !!response.data\r\n      });\r\n      \r\n      // Handle nested data structure from backend\r\n      if (response.data && response.data.status === 'success') {\r\n        return {\r\n          success: true,\r\n          data: response.data.data,\r\n          message: response.data.message\r\n        };\r\n      }\r\n      \r\n      return {\r\n        success: true,\r\n        data: response.data,\r\n      };\r\n    } catch (error: any) {\r\n      console.error('POST request failed:', {\r\n        url,\r\n        error: error.message,\r\n        code: error.code,\r\n        status: error.response?.status,\r\n        statusText: error.response?.statusText,\r\n        data: error.response?.data\r\n      });\r\n      \r\n      // Re-throw the error to be handled by the calling function\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // PUT request\r\n  put: async <T>(url: string, data?: any): Promise<ApiResponse<T>> => {\r\n    try {\r\n      const response = await api.put(url, data);\r\n      \r\n      // Handle nested data structure from backend\r\n      if (response.data && response.data.status === 'success') {\r\n        return {\r\n          success: true,\r\n          data: response.data.data,\r\n          message: response.data.message\r\n        };\r\n      }\r\n      \r\n      return {\r\n        success: true,\r\n        data: response.data,\r\n      };\r\n    } catch (_error) {\r\n      return {\r\n        success: false,\r\n        message: 'Failed to update resource',\r\n      };\r\n    }\r\n  },\r\n\r\n  // PATCH request\r\n  patch: async <T>(url: string, data?: any): Promise<ApiResponse<T>> => {\r\n    try {\r\n      const response = await api.patch(url, data);\r\n      \r\n      // Handle nested data structure from backend\r\n      if (response.data && response.data.status === 'success') {\r\n        return {\r\n          success: true,\r\n          data: response.data.data,\r\n          message: response.data.message\r\n        };\r\n      }\r\n      \r\n      return {\r\n        success: true,\r\n        data: response.data,\r\n      };\r\n    } catch (_error) {\r\n      return {\r\n        success: false,\r\n        message: 'Failed to update resource',\r\n      };\r\n    }\r\n  },\r\n\r\n  // DELETE request\r\n  delete: async <T>(url: string): Promise<ApiResponse<T>> => {\r\n    try {\r\n      const response = await api.delete(url);\r\n      \r\n      // Handle nested data structure from backend\r\n      if (response.data && response.data.status === 'success') {\r\n        return {\r\n          success: true,\r\n          data: response.data.data,\r\n          message: response.data.message\r\n        };\r\n      }\r\n      \r\n      return {\r\n        success: true,\r\n        data: response.data,\r\n      };\r\n    } catch (_error) {\r\n      return {\r\n        success: false,\r\n        message: 'Failed to delete resource',\r\n      };\r\n    }\r\n  },\r\n\r\n  // File upload\r\n  upload: async <T>(url: string, file: File, onProgress?: (progress: number) => void): Promise<ApiResponse<T>> => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n\r\n      const response = await api.post(url, formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n        },\r\n        onUploadProgress: (progressEvent) => {\r\n          if (onProgress && progressEvent.total) {\r\n            const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n            onProgress(progress);\r\n          }\r\n        },\r\n      });\r\n\r\n      // Handle nested data structure from backend\r\n      if (response.data && response.data.status === 'success') {\r\n        return {\r\n          success: true,\r\n          data: response.data.data,\r\n          message: response.data.message\r\n        };\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        data: response.data,\r\n      };\r\n    } catch (_error) {\r\n      return {\r\n        success: false,\r\n        message: 'Failed to upload file',\r\n      };\r\n    }\r\n  },\r\n};\r\n\r\n// Specific API endpoints\r\nexport const endpoints = {\r\n  // Auth endpoints\r\n  auth: {\r\n    login: '/api/v1/auth/login',\r\n    register: '/api/v1/auth/register',\r\n    logout: '/api/v1/auth/logout',\r\n    refresh: '/api/v1/auth/refresh',\r\n    forgotPassword: '/api/v1/auth/forgot-password',\r\n    resetPassword: '/api/v1/auth/reset-password',\r\n    verifyEmail: '/api/v1/auth/verify-email',\r\n  },\r\n\r\n  // User endpoints\r\n  users: {\r\n    profile: '/api/v1/users/profile',\r\n    update: '/api/v1/users/profile',\r\n    changePassword: '/api/v1/users/change-password',\r\n    uploadAvatar: '/api/v1/users/avatar',\r\n  },\r\n\r\n  // Appointment endpoints\r\n  appointments: {\r\n    list: '/api/v1/appointments',\r\n    create: '/api/v1/appointments',\r\n    get: (id: string) => `/api/v1/appointments/${id}`,\r\n    update: (id: string) => `/api/v1/appointments/${id}`,\r\n    delete: (id: string) => `/api/v1/appointments/${id}`,\r\n    cancel: (id: string) => `/api/v1/appointments/${id}/cancel`,\r\n    reschedule: (id: string) => `/api/v1/appointments/${id}/reschedule`,\r\n    availableSlots: '/api/v1/appointments/available-slots',\r\n  },\r\n\r\n  // Patient endpoints\r\n  patients: {\r\n    list: '/api/v1/patients',\r\n    create: '/api/v1/patients',\r\n    get: (id: string) => `/api/v1/patients/${id}`,\r\n    update: (id: string) => `/api/v1/patients/${id}`,\r\n    delete: (id: string) => `/api/v1/patients/${id}`,\r\n    medicalHistory: (id: string) => `/api/v1/patients/${id}/medical-history`,\r\n  },\r\n\r\n  // Clinic endpoints\r\n  clinics: {\r\n    list: '/api/v1/clinics',\r\n    create: '/api/v1/clinics',\r\n    get: (id: string) => `/api/v1/clinics/${id}`,\r\n    update: (id: string) => `/api/v1/clinics/${id}`,\r\n    delete: (id: string) => `/api/v1/clinics/${id}`,\r\n    staff: (id: string) => `/api/v1/clinics/${id}/staff`,\r\n    schedule: (id: string) => `/api/v1/clinics/${id}/schedule`,\r\n  },\r\n\r\n  // Service endpoints\r\n  services: {\r\n    list: '/api/v1/services',\r\n    create: '/api/v1/services',\r\n    get: (id: string) => `/api/v1/services/${id}`,\r\n    update: (id: string) => `/api/v1/services/${id}`,\r\n    delete: (id: string) => `/api/v1/services/${id}`,\r\n  },\r\n\r\n  // Blog endpoints\r\n  blog: {\r\n    posts: '/api/v1/blog/posts',\r\n    create: '/api/v1/blog/posts',\r\n    get: (id: string) => `/api/v1/blog/posts/${id}`,\r\n    update: (id: string) => `/api/v1/blog/posts/${id}`,\r\n    delete: (id: string) => `/api/v1/blog/posts/${id}`,\r\n    categories: '/api/v1/blog/categories',\r\n    comments: (postId: string) => `/api/v1/blog/posts/${postId}/comments`,\r\n  },\r\n\r\n  // Notification endpoints\r\n  notifications: {\r\n    list: '/api/v1/notifications',\r\n    markRead: (id: string) => `/api/v1/notifications/${id}/read`,\r\n    markAllRead: '/api/v1/notifications/mark-all-read',\r\n    settings: '/api/v1/notifications/settings',\r\n  },\r\n\r\n  // Dashboard endpoints\r\n  dashboard: {\r\n    stats: '/api/v1/dashboard/stats',\r\n    recentAppointments: '/api/v1/dashboard/recent-appointments',\r\n    upcomingAppointments: '/api/v1/dashboard/upcoming-appointments',\r\n    patientStats: '/api/v1/dashboard/patient-stats',\r\n    revenueStats: '/api/v1/dashboard/revenue-stats',\r\n  },\r\n\r\n  // Search endpoint\r\n  search: '/api/v1/search',\r\n};\r\n\r\nexport default api;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\appointmentService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3008,3011],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3008,3011],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":146,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":146,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4190,4193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4190,4193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4868,4871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4868,4871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":363,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12293,12296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12293,12296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":479,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":479,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16187,16190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16187,16190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":535,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":535,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18416,18419],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18416,18419],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":587,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":587,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20339,20342],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20339,20342],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":602,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":602,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20761,20764],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20761,20764],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport type { Appointment } from '../types';\nexport interface TimeSlot {\n  time: string;\n  available: boolean;\n  dentistId?: string;\n  isPeak?: boolean;\n  startTime?: string;\n  endTime?: string;\n}\nexport interface CreateAppointmentDto {\n  patientId: string;\n  dentistId?: string;\n  clinicId?: string;\n  service: string;\n  date: string;\n  timeSlot: string;\n  notes?: string;\n  emergency?: boolean;\n}\nexport interface UpdateAppointmentDto {\n  patientId?: string;\n  dentistId?: string;\n  clinicId?: string;\n  service?: string;\n  date?: string;\n  timeSlot?: string;\n  notes?: string;\n  emergency?: boolean;\n  status?: string;\n}\nexport interface TimeSlotRequest {\n  dentistId?: string; // Made optional - can get slots for all dentists in clinic\n  clinicId: string; // Required parameter\n  date: string;     // Required parameter\n  duration?: number; // Optional parameter with default value in backend\n}\nexport interface ConflictCheckRequest {\n  date: string;\n  timeSlot: string;\n  clinicId: string;\n  dentistId?: string;\n  excludeAppointmentId?: string;\n}\nclass AppointmentService {\n  async getAppointments(params?: Record<string, unknown>): Promise<unknown> {\n    try {\n      const response = await api.get('/api/v1/appointments', { params });\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching appointments:', error);\n      throw error;\n    }\n  }\n  \n  // Get user's appointment history for smart defaults\n  async getUserAppointmentHistory(patientId: string, limit: number = 5): Promise<unknown> {\n    try {\n      const params = {\n        patientId,\n        limit,\n        sort: 'createdAt',\n        order: 'desc'\n      };\n      const response = await api.get('/api/v1/appointments', { params });\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching user appointment history:', error);\n      return { data: [] }; // Return empty data instead of throwing\n    }\n  }\n  async getAppointment(id: string): Promise<Appointment> {\n    try {\n      const response = await api.get(`/api/v1/appointments/${id}`);\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching appointment:', error);\n      throw error;\n    }\n  }\n  async createAppointment(data: CreateAppointmentDto): Promise<Appointment> {\n    try {\n      // Debug authentication status\n      const token = localStorage.getItem('token');\n      console.log(' Authentication Debug:', {\n        hasToken: !!token,\n        tokenLength: token?.length || 0,\n        tokenStart: token?.substring(0, 20) + '...',\n        requestData: data\n      });\n      \n      console.log(' Starting appointment creation request...');\n      const startTime = Date.now();\n      \n      const response = await api.post('/api/v1/appointments', data);\n      \n      const endTime = Date.now();\n      const duration = endTime - startTime;\n      console.log(` Appointment creation completed in ${duration}ms`);\n      \n      return response.data;\n    } catch (error: any) {\n      // Log error with more details\n      console.error('Error creating appointment:', {\n        message: error.message,\n        code: error.code,\n        status: error.response?.status,\n        data: error.response?.data\n      });\n      \n      // Handle 404 errors specifically\n      if (error.response?.status === 404) {\n        console.error('Appointment endpoint not found. The appointment service might be unavailable.');\n      }\n      \n      throw error;\n    }\n  }\n\n  async autoBookFirstAvailable(data: {\n    patientId: string;\n    clinicId: string;\n    serviceType: string;\n    date: string;\n    duration?: number;\n    notes?: string;\n    emergency?: boolean;\n  }): Promise<{\n    success: boolean;\n    appointment?: Appointment;\n    bookedSlot?: {\n      time: string;\n      dentistName: string;\n      dentistSpecialization?: string;\n    };\n    message: string;\n  }> {\n    try {\n      const response = await api.post('/api/v1/appointments/auto-book', data);\n      return {\n        success: true,\n        appointment: response.data.data.appointment,\n        bookedSlot: response.data.data.bookedSlot,\n        message: response.data.message\n      };\n    } catch (error: any) {\n      console.error('Error auto-booking appointment:', {\n        message: error.message,\n        code: error.code,\n        status: error.response?.status,\n        data: error.response?.data\n      });\n      \n      // Return structured error response\n      return {\n        success: false,\n        message: error.response?.data?.message || 'Failed to auto-book appointment'\n      };\n    }\n  }\n  async updateAppointment(id: string, data: UpdateAppointmentDto): Promise<Appointment> {\n    try {\n      console.log('Updating appointment:', { id, data });\n      const response = await api.put(`/api/v1/appointments/${id}`, data);\n      return response.data;\n    } catch (error: any) {\n      // Log error with more details\n      console.error('Error updating appointment:', {\n        appointmentId: id,\n        updateData: data,\n        message: error.message,\n        code: error.code,\n        status: error.response?.status,\n        responseData: error.response?.data,\n        responseText: error.response?.statusText\n      });\n      \n      // Handle specific error statuses\n      if (error.response?.status === 404) {\n        console.error(`Appointment with ID ${id} not found. It may have been deleted or never existed.`);\n      } else if (error.response?.status === 500) {\n        console.error('Server error occurred during appointment update. This may be a backend validation or processing issue.');\n        if (error.response?.data?.message) {\n          console.error('Server error message:', error.response.data.message);\n        }\n      }\n      \n      throw error;\n    }\n  }\n  async deleteAppointment(id: string): Promise<void> {\n    try {\n      await api.delete(`/api/v1/appointments/${id}`);\n    } catch (error) {\n      console.error('Error deleting appointment:', error);\n      throw error;\n    }\n  }\n  // Add to appointmentService.ts\n  \n  // Cache for time slots to reduce API calls\n  private timeSlotCache: Record<string, { slots: TimeSlot[], timestamp: number }> = {};\n  private pendingRequests: Record<string, Promise<TimeSlot[]>> = {};\n  \n  // Debounced time slot fetching to prevent excessive API calls\n  private debounceTimers: Record<string, NodeJS.Timeout> = {};\n  \n  // Enhanced getAvailableTimeSlots with caching, debouncing and improved error handling\n  async getAvailableTimeSlots(params: TimeSlotRequest, debounceMs: number = 300): Promise<TimeSlot[]> {\n    try {\n      // Validate required parameters - dentistId is optional, will be auto-assigned by backend\n      if (!params.clinicId || !params.date) {\n        console.error('Missing required parameters for time slots:', params);\n        // Return empty array instead of throwing error to prevent blocking UI\n        return [];\n      }\n      \n      // Validate date format\n      if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(params.date)) {\n        console.error('Invalid date format:', params.date);\n        // Return empty array instead of throwing error\n        return [];\n      }\n      \n      // Create cache key from parameters\n      const cacheKey = `${params.date}-${params.dentistId || 'any'}-${params.clinicId}-${params.duration || 30}`;\n      \n      // Check if we have cached data less than 3 minutes old\n      const cachedData = this.timeSlotCache[cacheKey];\n      const cacheExpiry = 3 * 60 * 1000; // 3 minutes\n      \n      if (cachedData && (Date.now() - cachedData.timestamp) < cacheExpiry) {\n        console.log('Using cached time slots for:', cacheKey);\n        return cachedData.slots;\n      }\n      \n      // Check if there's already a pending request for this key\n      if (Object.prototype.hasOwnProperty.call(this.pendingRequests, cacheKey)) {\n        console.log('Waiting for pending request:', cacheKey);\n        return this.pendingRequests[cacheKey];\n      }\n      \n      // Implement debouncing\n      if (debounceMs > 0) {\n        return new Promise((resolve, reject) => {\n          // Clear existing timer\n          if (this.debounceTimers[cacheKey]) {\n            clearTimeout(this.debounceTimers[cacheKey]);\n          }\n          \n          // Set new timer\n          this.debounceTimers[cacheKey] = setTimeout(async () => {\n            try {\n              const result = await this._fetchTimeSlots(params, cacheKey);\n              resolve(result);\n            } catch (error) {\n              reject(error);\n            } finally {\n              delete this.debounceTimers[cacheKey];\n            }\n          }, debounceMs);\n        });\n      }\n      \n      // No debouncing, fetch immediately\n      return await this._fetchTimeSlots(params, cacheKey);\n    } catch (error) {\n      console.error('Error in getAvailableTimeSlots:', error);\n      return [];\n    }\n  }\n  \n  // Private method to handle the actual fetching logic\n  private async _fetchTimeSlots(params: TimeSlotRequest, cacheKey: string): Promise<TimeSlot[]> {\n    try {\n      \n      // Add this request to pending requests to prevent duplicates\n      const pendingPromise = this._performTimeslotFetch(params, cacheKey);\n      this.pendingRequests[cacheKey] = pendingPromise;\n      \n      try {\n        const result = await pendingPromise;\n        return result;\n      } finally {\n        // Clean up pending request\n        delete this.pendingRequests[cacheKey];\n      }\n    } catch (error) {\n      console.error('Error in _fetchTimeSlots:', error);\n      \n      // Return cached data if available as fallback\n      const cachedData = this.timeSlotCache[cacheKey];\n      if (cachedData) {\n        console.warn('Using cached data as fallback due to fetch error');\n        return cachedData.slots;\n      }\n      \n      return [];\n    }\n  }\n  \n  // Performs the actual API request\n  private async _performTimeslotFetch(params: TimeSlotRequest, cacheKey: string): Promise<TimeSlot[]> {\n    // Set timeout for API request\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 8000); // 8 second timeout\n    \n    try {\n      // Fetch from API\n        const response = await api.get('/api/v1/appointments/available-slots', { \n          params,\n          signal: controller.signal\n        });\n        \n        clearTimeout(timeoutId);\n        \n        let availableSlots: TimeSlot[] = [];\n        if (response.data?.data?.availableSlots) {\n          availableSlots = response.data.data.availableSlots;\n        } else if (Array.isArray(response.data)) {\n          availableSlots = response.data;\n        } else if (response.data?.availableSlots) {\n          availableSlots = response.data.availableSlots;\n        }\n      \n      // Check for specific messages about no dentists\n      const responseMessage = response.data?.message || response.data?.data?.message || '';\n      if (availableSlots.length === 0) {\n        console.warn('No time slots returned from API:', {\n          cacheKey,\n          responseMessage,\n          clinicId: params.clinicId,\n          date: params.date\n        });\n        \n        // Don't cache empty results if it's due to no dentists\n        if (responseMessage.includes('dentist') || responseMessage.includes('No dentists')) {\n          console.warn('Empty slots due to no dentists - not caching result');\n          throw new Error('No dentists available for this clinic. Please contact administration to assign dentists or select a different clinic.');\n        }\n      }\n        \n        // Ensure all slots have the isPeak property defined\n        availableSlots = availableSlots.map(slot => ({\n          ...slot,\n          isPeak: slot.isPeak !== undefined ? slot.isPeak : false\n        }));\n        \n      // Only cache non-empty results or when we have a valid reason for empty results\n      if (availableSlots.length > 0 || !responseMessage.includes('dentist')) {\n        this.timeSlotCache[cacheKey] = {\n          slots: availableSlots,\n          timestamp: Date.now()\n        };\n      }\n        \n      console.log('Successfully fetched time slots:', { \n        cacheKey, \n        slotsCount: availableSlots.length,\n        cached: availableSlots.length > 0 || !responseMessage.includes('dentist')\n      });\n        return availableSlots;\n    } catch (fetchError: any) {\n        clearTimeout(timeoutId);\n        \n      if (fetchError instanceof Error && fetchError.name === 'AbortError') {\n        console.warn('Time slot request timed out');\n        throw new Error('Request timed out. Please try again.');\n      }\n      \n      console.error('API request failed:', fetchError);\n      throw fetchError;\n    }\n  }\n  \n  // Enhanced method to clear cache when appointments are created/updated\n  clearTimeSlotCache(date?: string, clinicId?: string): void {\n    if (date && clinicId) {\n      // Clear only cache entries for this date and clinic\n      Object.keys(this.timeSlotCache).forEach(key => {\n        if (key.startsWith(`${date}-`) && key.includes(`-${clinicId}-`)) {\n          console.log('Clearing specific cache for date and clinic:', key);\n          delete this.timeSlotCache[key];\n        }\n      });\n      \n      // Also clear pending requests and timers for this date and clinic\n      Object.keys(this.pendingRequests).forEach(key => {\n        if (key.startsWith(`${date}-`) && key.includes(`-${clinicId}-`)) {\n          delete this.pendingRequests[key];\n        }\n      });\n      \n      Object.keys(this.debounceTimers).forEach(key => {\n        if (key.startsWith(`${date}-`) && key.includes(`-${clinicId}-`)) {\n          clearTimeout(this.debounceTimers[key]);\n          delete this.debounceTimers[key];\n        }\n      });\n    } else if (date) {\n      // Clear only cache entries for this date\n      Object.keys(this.timeSlotCache).forEach(key => {\n        if (key.startsWith(`${date}-`)) {\n          console.log('Clearing cache for date:', key);\n          delete this.timeSlotCache[key];\n        }\n      });\n      \n      // Also clear pending requests and timers for this date\n      Object.keys(this.pendingRequests).forEach(key => {\n        if (key.startsWith(`${date}-`)) {\n          delete this.pendingRequests[key];\n        }\n      });\n      \n      Object.keys(this.debounceTimers).forEach(key => {\n        if (key.startsWith(`${date}-`)) {\n          clearTimeout(this.debounceTimers[key]);\n          delete this.debounceTimers[key];\n        }\n      });\n    } else {\n      // Clear all cache, pending requests, and timers\n      console.log('Clearing all time slot cache and pending operations');\n      this.timeSlotCache = {};\n      this.pendingRequests = {};\n      \n      // Clear all debounce timers\n      Object.values(this.debounceTimers).forEach(timer => clearTimeout(timer));\n      this.debounceTimers = {};\n    }\n  }\n  \n  // Method to cancel pending operations for cleanup\n  cancelPendingOperations(): void {\n    console.log('Cancelling all pending time slot operations');\n    \n    // Clear all pending requests\n    this.pendingRequests = {};\n    \n    // Clear all debounce timers\n    Object.values(this.debounceTimers).forEach(timer => clearTimeout(timer));\n    this.debounceTimers = {};\n  }\n  \n  \n  async getNextSlotAfterLastBooking(params: {\n    date: string;\n    clinicId: string;\n    duration?: number;\n  }): Promise<TimeSlot | null> {\n    try {\n      // Validate required parameters\n      if (!params.date || !params.clinicId) {\n        console.error('Missing required parameters for next slot request:', params);\n        return null;\n      }\n      \n      // Validate date format\n      if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(params.date)) {\n        console.error('Invalid date format:', params.date);\n        return null;\n      }\n      \n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), 8000); // 8 second timeout\n      \n      try {\n        const response = await api.get('/api/v1/appointments/next-slot-after-last', { \n          params,\n          signal: controller.signal\n        });\n        \n        clearTimeout(timeoutId);\n        \n        console.log('Next slot response:', response.data);\n        \n        return response.data.data.nextSlot;\n      } catch (fetchError: any) {\n        clearTimeout(timeoutId);\n        \n        if (fetchError instanceof Error && fetchError.name === 'AbortError') {\n          console.warn('Next slot request timed out');\n          return null;\n        }\n        \n        console.error('API request for next slot failed:', fetchError);\n        return null;\n      }\n    } catch (error) {\n      console.error('Error getting next slot after last booking:', error);\n      return null;\n    }\n  }\n  \n  async checkTimeSlotConflict(params: ConflictCheckRequest): Promise<boolean> {\n    try {\n      // Validate required parameters\n      if (!params.date || !params.timeSlot || !params.clinicId) {\n        console.error('Missing required parameters for conflict check:', params);\n        throw new Error('Missing required parameters for conflict check');\n      }\n      \n      // Validate date format (YYYY-MM-DD)\n      if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(params.date)) {\n        console.error('Invalid date format:', params.date);\n        throw new Error('Invalid date format. Expected YYYY-MM-DD');\n      }\n      \n      // Validate time slot format (HH:mm)\n      if (!/^\\d{2}:\\d{2}$/.test(params.timeSlot)) {\n        console.error('Invalid time slot format:', params.timeSlot);\n        throw new Error('Invalid time slot format. Expected HH:mm');\n      }\n      \n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), 8000); // 8 second timeout\n      \n      try {\n        const response = await api.get('/api/v1/appointments/check-conflict', { \n          params,\n          signal: controller.signal\n        });\n        console.log('Conflict check response:', response.data);\n        clearTimeout(timeoutId);\n        \n        // Handle specific case where no dentists are available\n        const responseMessage = response.data?.message || '';\n        if (responseMessage.includes('No dentists in clinic')) {\n          console.warn('Conflict check: No dentists available in clinic');\n          throw new Error('No dentists available for this clinic. Please contact administration to assign dentists or select a different clinic.');\n        }\n        \n        return response.data.hasConflict || false;\n      } catch (fetchError: any) {\n        clearTimeout(timeoutId);\n        \n        if (fetchError instanceof Error && fetchError.name === 'AbortError') {\n          console.warn('Conflict check request timed out');\n          throw new Error('Time slot conflict check timed out. Please try again.');\n        }\n        \n        if (fetchError.response && fetchError.response.status === 403) {\n          console.error('Permission denied for conflict check - stopping booking process');\n          throw new Error('You do not have permission to check availability. Please log in.');\n        }\n        \n        if (fetchError.response && fetchError.response.status === 401) {\n          console.error('Authentication failed for conflict check');\n          throw new Error('Authentication failed. Please log in again.');\n        }\n        \n        throw fetchError;\n      }\n    } catch (error) {\n      console.error('Error checking time slot conflict:', error);\n      // Re-throw the error instead of returning false to stop the booking process\n      throw error;\n    }\n  }\n\n  /**\n   * Get booked time slots for a specific date and clinic/doctor\n   * @param date - Date in YYYY-MM-DD format\n   * @param clinicId - Clinic ID\n   * @param doctorId - Optional doctor ID for filtering\n   * @returns Array of booked time slots in HH:MM format\n   */\n  async getBookedSlots(date: string, clinicId: string, doctorId?: string): Promise<string[]> {\n    try {\n      // Validate parameters\n      if (!date || !clinicId) {\n        console.error('Missing required parameters for booked slots:', { date, clinicId });\n        return [];\n      }\n\n      // Validate date format\n      if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(date)) {\n        console.error('Invalid date format:', date);\n        return [];\n      }\n\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), 8000); // 8 second timeout\n\n      try {\n        const params: any = { date, clinicId };\n        if (doctorId) {\n          params.doctorId = doctorId;\n        }\n\n        const response = await api.get('/api/v1/appointments/booked-slots', {\n          params,\n          signal: controller.signal\n        });\n\n        clearTimeout(timeoutId);\n\n        console.log('Booked slots response:', response.data);\n\n        return response.data.data?.bookedSlots || [];\n      } catch (fetchError: any) {\n        clearTimeout(timeoutId);\n\n        if (fetchError instanceof Error && fetchError.name === 'AbortError') {\n          console.warn('Booked slots request timed out');\n          return [];\n        }\n\n        console.error('API request for booked slots failed:', fetchError);\n        return [];\n      }\n    } catch (error) {\n      console.error('Error getting booked slots:', error);\n      return [];\n    }\n  }\n}\n\nexport const appointmentService = new AppointmentService();","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\authService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2044,2047],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2044,2047],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2813,2816],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2813,2816],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":115,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3531,3534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3531,3534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":125,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3883,3886],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3883,3886],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":135,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4266,4269],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4266,4269],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4676,4679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4676,4679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6403,6406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6403,6406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axios from 'axios';\nimport type { AuthUser } from '../types';\nimport type { LoginCredentials, RegisterData } from '../types';\nimport { API_URL } from '../config/constants';\n\n// Create axios instance with base URL\nconst api = axios.create({\n  baseURL: API_URL,\n});\n\n// Add request interceptor to include auth token\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\n// Response interceptor to handle errors and token refresh\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n    \n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      \n      // Try to refresh token\n      const refreshResult = await refreshToken();\n      if (refreshResult?.token) {\n        // Update the authorization header and retry the request\n        originalRequest.headers.Authorization = `Bearer ${refreshResult.token}`;\n        return api(originalRequest);\n      } else {\n        // Refresh failed, redirect to login\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        window.location.href = '/login';\n      }\n    }\n    \n    return Promise.reject(error);\n  }\n);\n\n// Login user\nexport const loginUser = async (credentials: LoginCredentials): Promise<AuthUser> => {\n  try {\n    const response = await api.post('/api/v1/auth/login', credentials);\n    \n    const { user, token, refreshToken } = response.data.data;\n    \n    if (token) {\n      // Store token in localStorage and set default header\n      localStorage.setItem('token', token);\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      \n      if (refreshToken) {\n        localStorage.setItem('refreshToken', refreshToken);\n      }\n    }\n    \n    const result = { ...user, token };\n    return result;\n      } catch (_error: any) {\n      console.error('Full error:', _error.response?.data, _error.stack);\n      const errorMessage = _error.response?.data?.message || _error.message || 'Login failed';\n    throw new Error(errorMessage);\n  }\n};\n\n// Register user\nexport const registerUser = async (data: RegisterData): Promise<AuthUser> => {\n  try {\n    const response = await api.post('/api/v1/auth/register', data);\n    const { token, refreshToken: refreshTokenValue, user } = response.data.data; // Extract from nested data structure\n    \n    // Store tokens in localStorage\n    if (token) {\n      localStorage.setItem('token', token);\n    }\n    if (refreshTokenValue) {\n      localStorage.setItem('refreshToken', refreshTokenValue);\n    }\n    \n    return { ...user, token };\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Registration failed';\n    throw new Error(errorMessage);\n  }\n};\n\n// Logout user\nexport const logoutUser = async (): Promise<void> => {\n  try {\n    await api.post('/api/v1/auth/logout');\n  } catch (_error: unknown) {\n    console.error('Logout error:', _error);\n  } finally {\n    // Always remove token\n    localStorage.removeItem('token');\n    localStorage.removeItem('refreshToken');\n  }\n};\n\n// Get current user\nexport const getCurrentUser = async (): Promise<AuthUser> => {\n  try {\n    const response = await api.get('/api/v1/auth/me');\n    return response.data.data.user; // Fix: Extract from nested data structure\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to get user data';\n    throw new Error(errorMessage);\n  }\n};\n\n// Reset password request\nexport const requestPasswordReset = async (email: string): Promise<void> => {\n  try {\n    await api.post('/api/v1/auth/request-password-reset', { email });\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to request password reset';\n    throw new Error(errorMessage);\n  }\n};\n\n// Reset password with token\nexport const resetPassword = async (token: string, newPassword: string): Promise<void> => {\n  try {\n    await api.post('/api/v1/auth/reset-password', { token, newPassword });\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to reset password';\n    throw new Error(errorMessage);\n  }\n};\n\n// Change password for authenticated user\nexport const changePassword = async (currentPassword: string, newPassword: string): Promise<void> => {\n  try {\n    await api.post('/api/v1/auth/change-password', { currentPassword, newPassword });\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to change password';\n    throw new Error(errorMessage);\n  }\n};\n\n// Validate token (lightweight check with client-side expiration check)\nexport const validateToken = async (): Promise<boolean> => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) return false;\n    \n    // First check token expiration client-side to avoid unnecessary API calls\n    try {\n      const tokenPayload = JSON.parse(atob(token.split('.')[1]));\n      const currentTime = Math.floor(Date.now() / 1000);\n      \n      // If token is expired, don't make API call\n      if (tokenPayload.exp < currentTime) {\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        return false;\n      }\n      \n      // If token expires in the next 5 minutes, consider it as requiring refresh\n      const fiveMinutesFromNow = currentTime + (5 * 60);\n      if (tokenPayload.exp < fiveMinutesFromNow) {\n        // Try to refresh token proactively\n        const refreshResult = await refreshToken();\n        return !!refreshResult?.token;\n      }\n      \n    } catch (_decodeError) {\n      // If token is malformed, remove it and make API call to be sure\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      return false;\n    }\n    \n    // Use the lightweight validate endpoint for server-side validation\n    await api.get('/api/v1/auth/validate');\n    return true;\n  } catch (_error) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('refreshToken');\n    return false;\n  }\n};\n\n// Refresh token\nexport const refreshToken = async (): Promise<{ token: string; user: any } | null> => {\n  try {\n    const storedRefreshToken = localStorage.getItem('refreshToken');\n    if (!storedRefreshToken) {\n      return null;\n    }\n    \n    const response = await api.post('/api/v1/auth/refresh-token', {\n      refreshToken: storedRefreshToken\n    });\n    const { token, refreshToken: newRefreshToken, user } = response.data.data;\n    \n    if (token) {\n      localStorage.setItem('token', token);\n    }\n    if (newRefreshToken) {\n      localStorage.setItem('refreshToken', newRefreshToken);\n    }\n    \n    return { token, user };\n  } catch (_error) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('refreshToken');\n    return null;\n  }\n};\n\nexport default api;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\billingService.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"An interface declaring no members is equivalent to its supertype.","line":101,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":101,"endColumn":35,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1890,1955],"text":"type UpdateBillingData = Partial<CreateBillingData>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\n\nexport interface BillingRecord {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone?: string;\n    address?: {\n      street: string;\n      city: string;\n      state: string;\n      zipCode: string;\n    };\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n    type: string;\n  };\n  treatmentRecord?: {\n    _id: string;\n    treatment: string;\n  };\n  clinic: {\n    _id: string;\n    name: string;\n    address?: {\n      street: string;\n      city: string;\n      state: string;\n      zipCode: string;\n    };\n    phone?: string;\n    email?: string;\n  };\n  dentist: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  invoiceNumber: string;\n  items: Array<{\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    total: number;\n  }>;\n  subtotal: number;\n  taxAmount: number;\n  discountAmount: number;\n  totalAmount: number;\n  paidAmount: number;\n  balanceAmount: number;\n  paymentMethod?: string;\n  paymentStatus: 'pending' | 'partial' | 'paid' | 'overdue';\n  paymentHistory?: Array<{\n    amount: number;\n    method: string;\n    date: string;\n    reference?: string;\n  }>;\n  insuranceInfo?: {\n    provider: string;\n    policyNumber: string;\n    coverageAmount: number;\n  };\n  dueDate: string;\n  paidDate?: string;\n  notes?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CreateBillingData {\n  patient: string;\n  appointment?: string;\n  treatmentRecord?: string;\n  items: Array<{\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    total: number;\n  }>;\n  subtotal: number;\n  taxAmount: number;\n  discountAmount: number;\n  totalAmount: number;\n  paymentMethod?: string;\n  insuranceInfo?: {\n    provider: string;\n    policyNumber: string;\n    coverageAmount: number;\n  };\n  dueDate: string;\n  notes?: string;\n}\n\nexport interface UpdateBillingData extends Partial<CreateBillingData> {}\n\nexport interface PaymentData {\n  amount: number;\n  method: string;\n  reference?: string;\n  notes?: string;\n  paymentDate: string;\n}\n\nexport interface BillingFilters {\n  page?: number;\n  limit?: number;\n  search?: string;\n  paymentStatus?: string;\n  patient?: string;\n  dentist?: string;\n  clinic?: string;\n  startDate?: string;\n  endDate?: string;\n  minAmount?: number;\n  maxAmount?: number;\n}\n\nexport interface BillingResponse {\n  billingRecords: BillingRecord[];\n  totalRecords: number;\n  totalPages: number;\n  currentPage: number;\n}\n\nexport interface RevenueStats {\n  totalRevenue: number;\n  paidAmount: number;\n  pendingAmount: number;\n  overdueAmount: number;\n  monthlyRevenue: Array<{\n    month: string;\n    revenue: number;\n    invoices: number;\n  }>;\n  paymentMethodBreakdown: Array<{\n    method: string;\n    amount: number;\n    count: number;\n  }>;\n}\n\nexport interface BillingSummary {\n  totalInvoices: number;\n  totalAmount: number;\n  paidAmount: number;\n  pendingAmount: number;\n  overdueAmount: number;\n  averageInvoiceAmount: number;\n  paymentRate: number;\n}\n\nclass BillingService {\n  private baseURL = '/billing';\n\n  // Get all billing records with filters\n  async getBillingRecords(filters: BillingFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}?${params.toString()}`);\n    return response;\n  }\n\n  // Get billing record by ID\n  async getBillingRecord(id: string) {\n    const response = await api.get(`${this.baseURL}/${id}`);\n    return response;\n  }\n\n  // Create new billing record\n  async createBillingRecord(data: CreateBillingData) {\n    const response = await api.post(this.baseURL, data);\n    return response;\n  }\n\n  // Update billing record\n  async updateBillingRecord(id: string, data: UpdateBillingData) {\n    const response = await api.put(`${this.baseURL}/${id}`, data);\n    return response;\n  }\n\n  // Delete billing record (soft delete)\n  async deleteBillingRecord(id: string) {\n    const response = await api.delete(`${this.baseURL}/${id}`);\n    return response;\n  }\n\n  // Get billing records by patient\n  async getBillingByPatient(patientId: string, filters: BillingFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/patient/${patientId}?${params.toString()}`);\n    return response;\n  }\n\n  // Get overdue billing records\n  async getOverdueBilling(filters: BillingFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/overdue?${params.toString()}`);\n    return response;\n  }\n\n  // Add payment to billing record\n  async addPayment(billingId: string, paymentData: PaymentData) {\n    const response = await api.post(`${this.baseURL}/${billingId}/payment`, paymentData);\n    return response;\n  }\n\n  // Get revenue statistics\n  async getRevenueStats(filters: {\n    startDate?: string;\n    endDate?: string;\n    dentist?: string;\n    clinic?: string;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/stats/revenue?${params.toString()}`);\n    return response;\n  }\n\n  // Get billing summary\n  async getBillingSummary(filters: {\n    startDate?: string;\n    endDate?: string;\n    dentist?: string;\n    clinic?: string;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/summary?${params.toString()}`);\n    return response;\n  }\n\n  // Export billing data\n  async exportBillingData(filters: BillingFilters = {}, format: 'csv' | 'pdf' = 'csv') {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n    \n    params.append('format', format);\n\n    const response = await api.get(`${this.baseURL}/export?${params.toString()}`, {\n      responseType: 'blob'\n    });\n    return response;\n  }\n\n  // Send invoice email\n  async sendInvoiceEmail(billingId: string, emailData: {\n    to?: string;\n    subject?: string;\n    message?: string;\n  } = {}) {\n    const response = await api.post(`${this.baseURL}/${billingId}/send-email`, emailData);\n    return response;\n  }\n\n  // Generate invoice PDF\n  async generateInvoicePDF(billingId: string) {\n    const response = await api.get(`${this.baseURL}/${billingId}/pdf`, {\n      responseType: 'blob'\n    });\n    return response;\n  }\n\n  // Bulk operations\n  async bulkUpdateStatus(billingIds: string[], status: string) {\n    const response = await api.put(`${this.baseURL}/bulk/status`, {\n      billingIds,\n      status\n    });\n    return response;\n  }\n\n  async bulkDelete(billingIds: string[]) {\n    const response = await api.delete(`${this.baseURL}/bulk`, {\n      data: { billingIds }\n    });\n    return response;\n  }\n\n  // Search billing records\n  async searchBillingRecords(query: string, filters: BillingFilters = {}) {\n    const params = new URLSearchParams();\n    params.append('q', query);\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/search?${params.toString()}`);\n    return response;\n  }\n\n  // Get payment history for a billing record\n  async getPaymentHistory(billingId: string) {\n    const response = await api.get(`${this.baseURL}/${billingId}/payments`);\n    return response;\n  }\n\n  // Update payment\n  async updatePayment(billingId: string, paymentId: string, paymentData: Partial<PaymentData>) {\n    const response = await api.put(`${this.baseURL}/${billingId}/payment/${paymentId}`, paymentData);\n    return response;\n  }\n\n  // Delete payment\n  async deletePayment(billingId: string, paymentId: string) {\n    const response = await api.delete(`${this.baseURL}/${billingId}/payment/${paymentId}`);\n    return response;\n  }\n\n  // Get billing analytics\n  async getBillingAnalytics(filters: {\n    startDate?: string;\n    endDate?: string;\n    groupBy?: 'day' | 'week' | 'month' | 'year';\n    dentist?: string;\n    clinic?: string;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/analytics?${params.toString()}`);\n    return response;\n  }\n\n  // Get top patients by billing amount\n  async getTopPatients(filters: {\n    startDate?: string;\n    endDate?: string;\n    limit?: number;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/top-patients?${params.toString()}`);\n    return response;\n  }\n\n  // Get billing trends\n  async getBillingTrends(filters: {\n    startDate?: string;\n    endDate?: string;\n    period?: 'daily' | 'weekly' | 'monthly';\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/trends?${params.toString()}`);\n    return response;\n  }\n}\n\nexport const billingService = new BillingService();","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\clinicBranchService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":360,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11831,11834],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11831,11834],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":365,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":365,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12061,12064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12061,12064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":411,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":411,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13680,13683],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13680,13683],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":455,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":455,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14854,14857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14854,14857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":584,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":584,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18656,18659],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18656,18659],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":681,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":681,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21715,21718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21715,21718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Removed unused import\r\nimport { getAllClinics } from './clinicService';\r\nimport type { \r\n  ClinicBranch, \r\n  ClinicStats, \r\n  ClinicStatus, \r\n  ServiceHighlight, \r\n  AccessibilityFeature,\r\n  ContactMethod,\r\n  EnhancedOperatingHours,\r\n  ClinicBranchFilters,\r\n  ClinicRecommendation\r\n} from '../types/clinicBranch';\r\nimport type { Clinic, OperatingHours } from '../types/clinic';\r\nimport type { ApiResponse } from '../types/common';\r\nimport { logInfo, logError, logWarn } from '../utils/logger';\r\n\r\n/**\r\n * Transform base clinic data to enhanced clinic branch data\r\n * Adds display information, statistics, and interactive features\r\n */\r\nconst transformToClinicBranch = (clinic: Clinic): ClinicBranch => {\r\n  // Generate display name based on branch\r\n  const displayName = clinic.branchName \r\n    ? `Clear Dental - ${clinic.branchName}` \r\n    : clinic.name;\r\n\r\n  // Generate taglines based on branch\r\n  const taglines: Record<string, string> = {\r\n    'Fayoum': 'Your Premier Dental Care Destination',\r\n    'Atesa': 'Advanced Dental Solutions in Atesa',\r\n    'Minya': 'Comprehensive Dental Care in Minya'\r\n  };\r\n\r\n  // Generate unique features based on branch\r\n  const uniqueFeatures: Record<string, string[]> = {\r\n    'Fayoum': [\r\n      'Open 7 days a week',\r\n      'Extended hours until 11 PM',\r\n      'Full-service dental center',\r\n      'Emergency dental care',\r\n      'Digital X-ray technology'\r\n    ],\r\n    'Atesa': [\r\n      'Specialized orthodontic services',\r\n      'Modern dental equipment',\r\n      'Comfortable waiting area',\r\n      'Flexible scheduling',\r\n      'Insurance accepted'\r\n    ],\r\n    'Minya': [\r\n      'Cosmetic dentistry specialists',\r\n      'Pain-free procedures',\r\n      'Family-friendly environment',\r\n      'Latest dental technology',\r\n      'Multilingual staff'\r\n    ]\r\n  };\r\n\r\n  // Generate service highlights based on branch\r\n  const serviceHighlights: Record<string, ServiceHighlight[]> = {\r\n    'Fayoum': [\r\n      {\r\n        id: 'general-checkup',\r\n        name: 'General Checkup',\r\n        icon: 'stethoscope',\r\n        description: 'Comprehensive dental examination and cleaning',\r\n        isPopular: true,\r\n        estimatedDuration: '45-60 minutes',\r\n        startingPrice: 'Starting from 200 EGP'\r\n      },\r\n      {\r\n        id: 'teeth-whitening',\r\n        name: 'Teeth Whitening',\r\n        icon: 'sparkles',\r\n        description: 'Professional teeth whitening treatment',\r\n        isPopular: true,\r\n        estimatedDuration: '60-90 minutes',\r\n        startingPrice: 'Starting from 800 EGP'\r\n      },\r\n      {\r\n        id: 'root-canal',\r\n        name: 'Root Canal Treatment',\r\n        icon: 'medical-bag',\r\n        description: 'Advanced endodontic treatment',\r\n        estimatedDuration: '90-120 minutes',\r\n        startingPrice: 'Starting from 1500 EGP'\r\n      }\r\n    ],\r\n    'Atesa': [\r\n      {\r\n        id: 'orthodontics',\r\n        name: 'Orthodontic Treatment',\r\n        icon: 'adjustments',\r\n        description: 'Braces and teeth alignment solutions',\r\n        isPopular: true,\r\n        estimatedDuration: 'Multiple visits',\r\n        startingPrice: 'Starting from 5000 EGP'\r\n      },\r\n      {\r\n        id: 'dental-implants',\r\n        name: 'Dental Implants',\r\n        icon: 'cog',\r\n        description: 'Permanent tooth replacement solution',\r\n        estimatedDuration: '2-3 hours',\r\n        startingPrice: 'Starting from 8000 EGP'\r\n      },\r\n      {\r\n        id: 'preventive-care',\r\n        name: 'Preventive Care',\r\n        icon: 'shield-check',\r\n        description: 'Regular maintenance and prevention',\r\n        isPopular: true,\r\n        estimatedDuration: '30-45 minutes',\r\n        startingPrice: 'Starting from 150 EGP'\r\n      }\r\n    ],\r\n    'Minya': [\r\n      {\r\n        id: 'cosmetic-dentistry',\r\n        name: 'Cosmetic Dentistry',\r\n        icon: 'star',\r\n        description: 'Smile makeover and aesthetic treatments',\r\n        isPopular: true,\r\n        estimatedDuration: '60-120 minutes',\r\n        startingPrice: 'Starting from 1000 EGP'\r\n      },\r\n      {\r\n        id: 'pediatric-dentistry',\r\n        name: 'Pediatric Dentistry',\r\n        icon: 'heart',\r\n        description: 'Specialized care for children',\r\n        isPopular: true,\r\n        estimatedDuration: '30-60 minutes',\r\n        startingPrice: 'Starting from 250 EGP'\r\n      },\r\n      {\r\n        id: 'emergency-care',\r\n        name: 'Emergency Care',\r\n        icon: 'exclamation-triangle',\r\n        description: '24/7 emergency dental services',\r\n        estimatedDuration: 'As needed',\r\n        startingPrice: 'Starting from 300 EGP'\r\n      }\r\n    ]\r\n  };\r\n\r\n  // Generate mock statistics (in real app, these would come from backend)\r\n  const stats: ClinicStats = {\r\n    patientsServed: clinic.branchName === 'Fayoum' ? 5000 : \r\n                   clinic.branchName === 'Atesa' ? 3500 : 2800,\r\n    yearsOfService: clinic.branchName === 'Fayoum' ? 8 : \r\n                   clinic.branchName === 'Atesa' ? 5 : 4,\r\n    rating: 4.8,\r\n    reviewCount: clinic.branchName === 'Fayoum' ? 450 : \r\n                clinic.branchName === 'Atesa' ? 280 : 220,\r\n    successfulTreatments: clinic.branchName === 'Fayoum' ? 12000 : \r\n                         clinic.branchName === 'Atesa' ? 8500 : 6800,\r\n    doctorsCount: clinic.branchName === 'Fayoum' ? 3 : \r\n                 clinic.branchName === 'Atesa' ? 1 : 2\r\n  };\r\n\r\n  // Generate current status\r\n  const currentStatus = generateClinicStatus(clinic.operatingHours);\r\n\r\n  // Generate accessibility features\r\n  const accessibility: AccessibilityFeature[] = [\r\n    {\r\n      id: 'wheelchair-access',\r\n      name: 'Wheelchair Accessible',\r\n      icon: 'wheelchair',\r\n      description: 'Full wheelchair accessibility throughout the facility',\r\n      available: true\r\n    },\r\n    {\r\n      id: 'parking',\r\n      name: 'Free Parking',\r\n      icon: 'car',\r\n      description: 'Complimentary parking available',\r\n      available: true\r\n    },\r\n    {\r\n      id: 'elevator',\r\n      name: 'Elevator Access',\r\n      icon: 'arrow-up',\r\n      description: 'Elevator access to all floors',\r\n      available: clinic.branchName === 'Fayoum' // Only Fayoum has multiple floors\r\n    },\r\n    {\r\n      id: 'hearing-loop',\r\n      name: 'Hearing Loop',\r\n      icon: 'volume-up',\r\n      description: 'Assistive hearing technology available',\r\n      available: clinic.branchName !== 'Atesa' // Available in Fayoum and Minya\r\n    }\r\n  ];\r\n\r\n  // Generate amenities\r\n  const amenities = [\r\n    'Free WiFi',\r\n    'Comfortable Waiting Area',\r\n    'Refreshments Available',\r\n    'Children\\'s Play Area',\r\n    'Private Consultation Rooms',\r\n    'Digital Entertainment System'\r\n  ];\r\n\r\n  // Generate WhatsApp number (format: +20 + clinic phone without +20)\r\n  const whatsappNumber = clinic.phone.startsWith('+20') \r\n    ? clinic.phone \r\n    : `+20${clinic.phone.replace(/^\\+?20?/, '')}`;\r\n\r\n  // Generate map URLs\r\n  const mapUrl = generateMapUrl(clinic.address);\r\n  const directionsUrl = generateDirectionsUrl(clinic.address);\r\n\r\n  return {\r\n    ...clinic,\r\n    displayName,\r\n    tagline: taglines[clinic.branchName || ''] || 'Quality Dental Care',\r\n    heroImage: `/images/clinics/${clinic.branchName?.toLowerCase() || 'default'}-hero.jpg`,\r\n    galleryImages: [\r\n      `/images/clinics/${clinic.branchName?.toLowerCase() || 'default'}-1.jpg`,\r\n      `/images/clinics/${clinic.branchName?.toLowerCase() || 'default'}-2.jpg`,\r\n      `/images/clinics/${clinic.branchName?.toLowerCase() || 'default'}-3.jpg`\r\n    ],\r\n    mapUrl,\r\n    whatsappNumber,\r\n    directionsUrl,\r\n    uniqueFeatures: uniqueFeatures[clinic.branchName || ''] || [],\r\n    serviceHighlights: serviceHighlights[clinic.branchName || ''] || [],\r\n    stats,\r\n    bookingUrl: `/appointments/book?clinic=${clinic.id}`,\r\n    virtualTourUrl: `/virtual-tour/${clinic.branchName?.toLowerCase() || 'default'}`,\r\n    currentStatus,\r\n    nextAvailableSlot: generateNextAvailableSlot(clinic.operatingHours),\r\n    accessibility,\r\n    amenities\r\n  };\r\n};\r\n\r\n/**\r\n * Generate current clinic status based on operating hours\r\n */\r\nconst generateClinicStatus = (operatingHours: OperatingHours[]): ClinicStatus => {\r\n  const now = new Date();\r\n  const currentTime = now.getHours() * 100 + now.getMinutes(); // HHMM format\r\n\r\n  // Find today's hours\r\n  const todayHours = operatingHours.find(hours => \r\n    hours.day.toLowerCase() === getDayName(now.getDay()).toLowerCase()\r\n  );\r\n\r\n  if (!todayHours || todayHours.closed) {\r\n    // Find next open day\r\n    const nextOpenDay = findNextOpenDay(operatingHours, now);\r\n    return {\r\n      isOpen: false,\r\n      statusText: nextOpenDay \r\n        ? `Closed - Opens ${nextOpenDay.day} at ${formatTime(nextOpenDay.open)}`\r\n        : 'Closed',\r\n      nextOpenTime: nextOpenDay?.open\r\n    };\r\n  }\r\n\r\n  // Parse open and close times\r\n  const openTime = parseTime(todayHours.open);\r\n  const closeTime = parseTime(todayHours.close);\r\n\r\n  const isCurrentlyOpen = currentTime >= openTime && currentTime < closeTime;\r\n\r\n  if (isCurrentlyOpen) {\r\n    const closingTime = formatTime(todayHours.close);\r\n    return {\r\n      isOpen: true,\r\n      statusText: `Open now - Closes at ${closingTime}`,\r\n      busyLevel: getBusyLevel(currentTime, openTime, closeTime)\r\n    };\r\n  } else if (currentTime < openTime) {\r\n    return {\r\n      isOpen: false,\r\n      statusText: `Opens today at ${formatTime(todayHours.open)}`,\r\n      nextOpenTime: todayHours.open\r\n    };\r\n  } else {\r\n    // After closing time, find next open day\r\n    const nextOpenDay = findNextOpenDay(operatingHours, now);\r\n    return {\r\n      isOpen: false,\r\n      statusText: nextOpenDay \r\n        ? `Closed - Opens ${nextOpenDay.day} at ${formatTime(nextOpenDay.open)}`\r\n        : 'Closed',\r\n      nextOpenTime: nextOpenDay?.open\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Helper functions for time and status calculations\r\n */\r\nconst getDayName = (dayIndex: number): string => {\r\n  const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];\r\n  return days[dayIndex];\r\n};\r\n\r\nconst parseTime = (timeString: string): number => {\r\n  const [hours, minutes] = timeString.split(':').map(Number);\r\n  return hours * 100 + minutes;\r\n};\r\n\r\nconst formatTime = (timeString: string): string => {\r\n  const [hours, minutes] = timeString.split(':').map(Number);\r\n  const period = hours >= 12 ? 'PM' : 'AM';\r\n  const displayHours = hours > 12 ? hours - 12 : hours === 0 ? 12 : hours;\r\n  return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\r\n};\r\n\r\nconst findNextOpenDay = (operatingHours: OperatingHours[], fromDate: Date) => {\r\n  for (let i = 1; i <= 7; i++) {\r\n    const nextDate = new Date(fromDate);\r\n    nextDate.setDate(nextDate.getDate() + i);\r\n    const dayName = getDayName(nextDate.getDay());\r\n    \r\n    const dayHours = operatingHours.find(hours => \r\n      hours.day.toLowerCase() === dayName.toLowerCase()\r\n    );\r\n    \r\n    if (dayHours && !dayHours.closed) {\r\n      return {\r\n        day: i === 1 ? 'tomorrow' : dayName,\r\n        open: dayHours.open\r\n      };\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\nconst getBusyLevel = (currentTime: number, openTime: number, closeTime: number): 'low' | 'medium' | 'high' => {\r\n  const totalMinutes = closeTime - openTime;\r\n  const elapsedMinutes = currentTime - openTime;\r\n  const progress = elapsedMinutes / totalMinutes;\r\n\r\n  // Peak hours are typically mid-day and early evening\r\n  if (progress > 0.3 && progress < 0.7) {\r\n    return 'high';\r\n  } else if (progress > 0.1 && progress < 0.9) {\r\n    return 'medium';\r\n  } else {\r\n    return 'low';\r\n  }\r\n};\r\n\r\nconst generateNextAvailableSlot = (_operatingHours: OperatingHours[]): string => {\r\n  // Mock implementation - in real app, this would check actual appointment availability\r\n  const now = new Date();\r\n  now.setHours(now.getHours() + 2); // Next available in 2 hours\r\n  return now.toISOString();\r\n};\r\n\r\nconst generateMapUrl = (address: any): string => {\r\n  const query = encodeURIComponent(`${address.street}, ${address.city}, ${address.country}`);\r\n  return `https://www.google.com/maps/search/?api=1&query=${query}`;\r\n};\r\n\r\nconst generateDirectionsUrl = (address: any): string => {\r\n  const destination = encodeURIComponent(`${address.street}, ${address.city}, ${address.country}`);\r\n  return `https://www.google.com/maps/dir/?api=1&destination=${destination}`;\r\n};\r\n\r\n/**\r\n * Get all clinic branches with enhanced data\r\n * Fetches base clinic data and transforms it for homepage showcase\r\n */\r\nexport const getClinicBranches = async (): Promise<ApiResponse<ClinicBranch[]>> => {\r\n  try {\r\n    logInfo('Fetching clinic branches for homepage showcase');\r\n\r\n    // Get base clinic data\r\n    const clinicsResponse = await getAllClinics();\r\n    \r\n    if (!clinicsResponse.success || !clinicsResponse.data) {\r\n      logWarn('Failed to fetch base clinic data', { response: clinicsResponse });\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        message: clinicsResponse.message || 'Failed to fetch clinic data'\r\n      };\r\n    }\r\n\r\n    // Transform to enhanced clinic branch data\r\n    const clinicBranches = clinicsResponse.data.map(transformToClinicBranch);\r\n    \r\n    // Sort by branch name for consistent ordering\r\n    clinicBranches.sort((a, b) => {\r\n      const order = ['Fayoum', 'Atesa', 'Minya'];\r\n      const aIndex = order.indexOf(a.branchName || '');\r\n      const bIndex = order.indexOf(b.branchName || '');\r\n      return aIndex - bIndex;\r\n    });\r\n\r\n    logInfo('Successfully transformed clinic branches', { \r\n      count: clinicBranches.length,\r\n      branches: clinicBranches.map(b => b.branchName)\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      data: clinicBranches,\r\n      message: 'Clinic branches retrieved successfully'\r\n    };\r\n  } catch (error: any) {\r\n    logError('Failed to fetch clinic branches', error);\r\n    return {\r\n      success: false,\r\n      data: [],\r\n      message: error.message || 'Failed to fetch clinic branches'\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get specific clinic branch by branch name\r\n */\r\nexport const getClinicBranchByName = async (branchName: string): Promise<ApiResponse<ClinicBranch | null>> => {\r\n  try {\r\n    logInfo('Fetching specific clinic branch', { branchName });\r\n\r\n    const branchesResponse = await getClinicBranches();\r\n    \r\n    if (!branchesResponse.success || !branchesResponse.data) {\r\n      return {\r\n        success: false,\r\n        data: null,\r\n        message: branchesResponse.message || 'Failed to fetch clinic branches'\r\n      };\r\n    }\r\n\r\n    const branch = branchesResponse.data.find(\r\n      branch => branch.branchName?.toLowerCase() === branchName.toLowerCase()\r\n    );\r\n\r\n    if (!branch) {\r\n      return {\r\n        success: false,\r\n        data: null,\r\n        message: `Clinic branch '${branchName}' not found`\r\n      };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      data: branch,\r\n      message: 'Clinic branch retrieved successfully'\r\n    };\r\n  } catch (error: any) {\r\n    logError('Failed to fetch clinic branch by name', error, { branchName });\r\n    return {\r\n      success: false,\r\n      data: null,\r\n      message: error.message || 'Failed to fetch clinic branch'\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get contact methods for a clinic branch\r\n */\r\nexport const getClinicContactMethods = (branch: ClinicBranch): ContactMethod[] => {\r\n  return [\r\n    {\r\n      type: 'phone',\r\n      label: 'Call Now',\r\n      value: branch.phone,\r\n      icon: 'phone',\r\n      primary: true\r\n    },\r\n    {\r\n      type: 'whatsapp',\r\n      label: 'WhatsApp',\r\n      value: `https://wa.me/${branch.whatsappNumber.replace(/\\D/g, '')}`,\r\n      icon: 'chat'\r\n    },\r\n    {\r\n      type: 'directions',\r\n      label: 'Get Directions',\r\n      value: branch.directionsUrl || branch.mapUrl,\r\n      icon: 'map'\r\n    },\r\n    {\r\n      type: 'booking',\r\n      label: 'Book Appointment',\r\n      value: branch.bookingUrl || '/appointments/book',\r\n      icon: 'calendar',\r\n      primary: true\r\n    }\r\n  ];\r\n};\r\n\r\n/**\r\n * Get enhanced operating hours with display formatting\r\n */\r\nexport const getEnhancedOperatingHours = (branch: ClinicBranch): EnhancedOperatingHours[] => {\r\n  const today = getDayName(new Date().getDay());\r\n  \r\n  return branch.operatingHours.map(hours => ({\r\n    ...hours,\r\n    displayText: hours.closed \r\n      ? 'Closed' \r\n      : `${formatTime(hours.open)} - ${formatTime(hours.close)}`,\r\n    isToday: hours.day.toLowerCase() === today.toLowerCase(),\r\n    isCurrentlyOpen: hours.day.toLowerCase() === today.toLowerCase() && \r\n                    branch.currentStatus.isOpen\r\n  }));\r\n};\r\n\r\n/**\r\n * Filter clinic branches based on criteria\r\n */\r\nexport const filterClinicBranches = async (\r\n  filters: ClinicBranchFilters\r\n): Promise<ApiResponse<ClinicBranch[]>> => {\r\n  try {\r\n    const branchesResponse = await getClinicBranches();\r\n    \r\n    if (!branchesResponse.success || !branchesResponse.data) {\r\n      return branchesResponse;\r\n    }\r\n\r\n    let filteredBranches = branchesResponse.data;\r\n\r\n    // Filter by services\r\n    if (filters.services && filters.services.length > 0) {\r\n      filteredBranches = filteredBranches.filter(branch =>\r\n        filters.services!.some(service =>\r\n          branch.serviceHighlights.some(highlight =>\r\n            highlight.name.toLowerCase().includes(service.toLowerCase())\r\n          )\r\n        )\r\n      );\r\n    }\r\n\r\n    // Filter by location\r\n    if (filters.location) {\r\n      filteredBranches = filteredBranches.filter(branch =>\r\n        branch.address.city.toLowerCase().includes(filters.location!.toLowerCase()) ||\r\n        branch.branchName?.toLowerCase().includes(filters.location!.toLowerCase())\r\n      );\r\n    }\r\n\r\n    // Filter by availability\r\n    if (filters.availability) {\r\n      filteredBranches = filteredBranches.filter(branch => {\r\n        switch (filters.availability) {\r\n          case 'now':\r\n            return branch.currentStatus.isOpen;\r\n          case 'today':\r\n            return !branch.operatingHours.find(h => \r\n              h.day.toLowerCase() === getDayName(new Date().getDay()).toLowerCase()\r\n            )?.closed;\r\n          case 'week':\r\n            return branch.operatingHours.some(h => !h.closed);\r\n          default:\r\n            return true;\r\n        }\r\n      });\r\n    }\r\n\r\n    // Filter by features\r\n    if (filters.features && filters.features.length > 0) {\r\n      filteredBranches = filteredBranches.filter(branch =>\r\n        filters.features!.some(feature =>\r\n          branch.uniqueFeatures.some(branchFeature =>\r\n            branchFeature.toLowerCase().includes(feature.toLowerCase())\r\n          )\r\n        )\r\n      );\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      data: filteredBranches,\r\n      message: `Found ${filteredBranches.length} matching clinic branches`\r\n    };\r\n  } catch (error: any) {\r\n    logError('Failed to filter clinic branches', error, { filters });\r\n    return {\r\n      success: false,\r\n      data: [],\r\n      message: error.message || 'Failed to filter clinic branches'\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get clinic branch recommendations based on user preferences\r\n */\r\nexport const getClinicRecommendations = async (\r\n  preferences: {\r\n    location?: string;\r\n    services?: string[];\r\n    availability?: string;\r\n    maxDistance?: number;\r\n  }\r\n): Promise<ApiResponse<ClinicRecommendation[]>> => {\r\n  try {\r\n    const branchesResponse = await getClinicBranches();\r\n    \r\n    if (!branchesResponse.success || !branchesResponse.data) {\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        message: branchesResponse.message || 'Failed to fetch clinic branches'\r\n      };\r\n    }\r\n\r\n    const recommendations: ClinicRecommendation[] = branchesResponse.data.map(branch => {\r\n      let score = 0;\r\n      const reasons: string[] = [];\r\n      const matchedCriteria: string[] = [];\r\n\r\n      // Location scoring\r\n      if (preferences.location) {\r\n        if (branch.address.city.toLowerCase().includes(preferences.location.toLowerCase()) ||\r\n            branch.branchName?.toLowerCase().includes(preferences.location.toLowerCase())) {\r\n          score += 30;\r\n          reasons.push(`Located in ${preferences.location}`);\r\n          matchedCriteria.push('location');\r\n        }\r\n      }\r\n\r\n      // Service scoring\r\n      if (preferences.services && preferences.services.length > 0) {\r\n        const matchedServices = preferences.services.filter(service =>\r\n          branch.serviceHighlights.some(highlight =>\r\n            highlight.name.toLowerCase().includes(service.toLowerCase())\r\n          )\r\n        );\r\n        \r\n        if (matchedServices.length > 0) {\r\n          score += (matchedServices.length / preferences.services.length) * 25;\r\n          reasons.push(`Offers ${matchedServices.join(', ')}`);\r\n          matchedCriteria.push('services');\r\n        }\r\n      }\r\n\r\n      // Availability scoring\r\n      if (preferences.availability === 'now' && branch.currentStatus.isOpen) {\r\n        score += 20;\r\n        reasons.push('Currently open');\r\n        matchedCriteria.push('availability');\r\n      }\r\n\r\n      // Rating and review scoring\r\n      score += (branch.stats.rating / 5) * 15;\r\n      if (branch.stats.rating >= 4.5) {\r\n        reasons.push(`Highly rated (${branch.stats.rating}/5)`);\r\n      }\r\n\r\n      // Experience scoring\r\n      score += Math.min(branch.stats.yearsOfService / 10, 1) * 10;\r\n      if (branch.stats.yearsOfService >= 5) {\r\n        reasons.push(`${branch.stats.yearsOfService} years of experience`);\r\n      }\r\n\r\n      return {\r\n        branch,\r\n        score: Math.round(score),\r\n        reasons,\r\n        matchedCriteria\r\n      };\r\n    });\r\n\r\n    // Sort by score (highest first)\r\n    recommendations.sort((a, b) => b.score - a.score);\r\n\r\n    return {\r\n      success: true,\r\n      data: recommendations,\r\n      message: 'Clinic recommendations generated successfully'\r\n    };\r\n  } catch (error: any) {\r\n    logError('Failed to generate clinic recommendations', error, { preferences });\r\n    return {\r\n      success: false,\r\n      data: [],\r\n      message: error.message || 'Failed to generate recommendations'\r\n    };\r\n  }\r\n};\r\n\r\n// Export service functions\r\nexport const clinicBranchService = {\r\n  getClinicBranches,\r\n  getClinicBranchByName,\r\n  getClinicContactMethods,\r\n  getEnhancedOperatingHours,\r\n  filterClinicBranches,\r\n  getClinicRecommendations\r\n};\r\n\r\nexport default clinicBranchService;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\clinicService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":5,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[168,171],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[168,171],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1820,1823],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1820,1823],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2602,2605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2602,2605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4099,4102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4099,4102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4967,4970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4967,4970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":192,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":192,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5660,5663],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5660,5663],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport type { Clinic, ApiResponse } from '../types';\n\n// Helper function to transform backend clinic data\nconst transformClinicData = (clinic: any): Clinic => {\n  return {\n    id: clinic.id,\n    name: clinic.name,\n    branchName: clinic.branchName,\n    address: clinic.address,\n    phone: clinic.phone,\n    email: clinic.email,\n    website: clinic.website,\n    operatingHours: clinic.operatingHours,\n    services: clinic.services || [],\n    staff: clinic.staff || [],\n    isActive: clinic.isActive,\n    createdAt: new Date(clinic.createdAt),\n    updatedAt: new Date(clinic.updatedAt)\n  };\n};\n\n// Use the actual clinic ID from the database (Dr. Gamal Abdel Nasser Center)\n// const SINGLE_CLINIC_ID = '687468107e70478314c346b6';\n\n// Get all clinics\nexport const getAllClinics = async (): Promise<ApiResponse<Clinic[]>> => {\n  try {\n    // console.log(' getAllClinics: Fetching from /api/v1/clinics/public...');\n    const response = await api.get('/api/v1/clinics/public');\n    // console.log(' getAllClinics: Raw response:', response.data);\n    \n    // API returns double-nested structure: response.data.data.data\n    const clinicsData = response.data?.data?.data;\n    \n    if (clinicsData && Array.isArray(clinicsData)) {\n      console.log(' getAllClinics: Found data array, transforming...');\n      const clinics = clinicsData.map(transformClinicData);\n      console.log(' getAllClinics: Transformed', clinics.length, 'clinics:', clinics);\n      return {\n        success: true,\n        data: clinics,\n        message: 'Clinics retrieved successfully'\n      };\n    } else {\n      console.warn(' getAllClinics: No data array found. Structure:', response.data);\n      return {\n        success: false,\n        data: [],\n        message: 'No clinics found'\n      };\n    }\n  } catch (error: any) {\n    console.error(' getAllClinics: Error:', error);\n    return {\n      success: false,\n      data: [],\n      message: error.response?.data?.message || error.message || 'Failed to retrieve clinics'\n    };\n  }\n};\n\n// Get single clinic data (backward compatibility)\nexport const getClinic = async (): Promise<ApiResponse<Clinic | null>> => {\n  try {\n    const clinicsResponse = await getAllClinics();\n    \n    if (clinicsResponse.success && clinicsResponse.data && clinicsResponse.data.length > 0) {\n      return {\n        success: true,\n        data: clinicsResponse.data[0],\n        message: 'Clinic retrieved successfully'\n      };\n    } else {\n      return {\n        success: false,\n        data: null,\n        message: 'No clinics found'\n      };\n    }\n  } catch (error: any) {\n    return {\n      success: false,\n      data: null,\n      message: error.message || 'Failed to retrieve clinic'\n    };\n  }\n};\n\n// Get all unique branch names\nexport const getBranches = async (): Promise<ApiResponse<string[]>> => {\n  try {\n    console.log(' getBranches: Starting...');\n    const clinicsResponse = await getAllClinics();\n    console.log(' getBranches: Clinics response:', clinicsResponse);\n    \n    if (clinicsResponse.success && clinicsResponse.data) {\n      console.log(' getBranches: Total clinics:', clinicsResponse.data.length);\n      \n      const branches = [...new Set(\n        clinicsResponse.data\n          .map(clinic => {\n            console.log(' Clinic:', clinic.name, 'Branch:', clinic.branchName);\n            return clinic.branchName;\n          })\n          .filter((branch): branch is string => !!branch)\n      )];\n      \n      console.log(' getBranches: Extracted branches:', branches);\n      \n      if (branches.length === 0) {\n        return {\n          success: false,\n          data: [],\n          message: 'No branches found in clinics'\n        };\n      }\n      \n      return {\n        success: true,\n        data: branches.sort(),\n        message: 'Branches retrieved successfully'\n      };\n    } else {\n      console.error(' getBranches: Clinics response failed:', clinicsResponse);\n      return {\n        success: false,\n        data: [],\n        message: clinicsResponse.message || 'No branches found'\n      };\n    }\n  } catch (error: any) {\n    console.error(' getBranches: Error:', error);\n    return {\n      success: false,\n      data: [],\n      message: error.message || 'Failed to retrieve branches'\n    };\n  }\n};\n\n// Get clinics by branch name\nexport const getClinicsByBranch = async (branchName: string): Promise<ApiResponse<Clinic[]>> => {\n  try {\n    const clinicsResponse = await getAllClinics();\n    \n    if (clinicsResponse.success && clinicsResponse.data) {\n      const branchClinics = clinicsResponse.data.filter(\n        clinic => clinic.branchName === branchName\n      );\n      \n      return {\n        success: true,\n        data: branchClinics,\n        message: `Clinics for ${branchName} branch retrieved successfully`\n      };\n    } else {\n      return {\n        success: false,\n        data: [],\n        message: 'No clinics found for this branch'\n      };\n    }\n  } catch (error: any) {\n    return {\n      success: false,\n      data: [],\n      message: error.message || 'Failed to retrieve clinics for branch'\n    };\n  }\n};\n\n// Get clinic by ID\nexport const getClinicById = async (clinicId: string): Promise<ApiResponse<Clinic | null>> => {\n  try {\n    const response = await api.get(`/api/v1/clinics/${clinicId}`);\n    \n    if (response.data?.data) {\n      const clinic = transformClinicData(response.data.data);\n      return {\n        success: true,\n        data: clinic,\n        message: 'Clinic retrieved successfully'\n      };\n    } else {\n      return {\n        success: false,\n        data: null,\n        message: 'Clinic not found'\n      };\n    }\n  } catch (error: any) {\n    return {\n      success: false,\n      data: null,\n      message: error.response?.data?.message || error.message || 'Failed to retrieve clinic'\n    };\n  }\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\dashboardService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[801,804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[801,804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[828,831],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[828,831],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[861,864],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[861,864],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3058,3061],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3058,3061],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8040,8043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8040,8043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":251,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":251,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9732,9735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9732,9735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":265,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10307,10310],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10307,10310],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":292,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11310,11313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11310,11313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":333,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":333,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13024,13027],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13024,13027],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":347,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13593,13596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13593,13596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14218,14221],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14218,14221],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":377,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":377,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14584,14587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14584,14587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":382,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":382,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14772,14775],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14772,14775],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":393,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":393,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15130,15133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15130,15133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":398,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":398,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15320,15323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15320,15323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport type { ApiResponse } from '../types';\nimport { createSafeApiParams } from '../utils/clinicUtils';\n\n// Dashboard data types\nexport interface DashboardStats {\n  appointments: {\n    total: number;\n    today: number;\n    upcoming: number;\n    completed: number;\n    cancelled: number;\n    noShow: number;\n  };\n  patients: {\n    total: number;\n    new: number;\n    active: number;\n    byGender: {\n      male: number;\n      female: number;\n      other: number;\n    };\n    byAgeGroup: {\n      '0-18': number;\n      '19-35': number;\n      '36-50': number;\n      '51-65': number;\n      '65+': number;\n    };\n  };\n  revenue: {\n    total: number;\n    thisMonth: number;\n    lastMonth: number;\n    pending: number;\n    overdue: number;\n  };\n  activities: {\n    recentAppointments: any[];\n    recentPatients: any[];\n    upcomingAppointments: any[];\n  };\n}\n\nexport interface RecentActivity {\n  id: string;\n  type: 'appointment' | 'patient' | 'treatment' | 'billing';\n  title: string;\n  description: string;\n  timestamp: string;\n  status?: string;\n}\n\n// Get dashboard statistics\nexport const getDashboardStats = async (clinicId?: string): Promise<ApiResponse<DashboardStats>> => {\n  try {\n    // If no clinicId is provided, get overall statistics for admin users\n    if (!clinicId) {\n      try {\n        const overallStats = await api.get('/api/v1/clinics/statistics/overall');\n        \n        const dashboardData: DashboardStats = {\n          appointments: {\n            total: overallStats.data.data?.appointments?.total || 0,\n            today: overallStats.data.data?.appointments?.today || 0,\n            upcoming: overallStats.data.data?.appointments?.upcoming || 0,\n            completed: overallStats.data.data?.appointments?.completed || 0,\n            cancelled: overallStats.data.data?.appointments?.cancelled || 0,\n            noShow: 0 // Not included in overall stats yet\n          },\n          patients: {\n            total: overallStats.data.data?.patients?.total || 0,\n            new: overallStats.data.data?.patients?.newThisMonth || 0,\n            active: overallStats.data.data?.patients?.total || 0,\n            byGender: {\n              male: 0,\n              female: 0,\n              other: 0\n            },\n            byAgeGroup: {\n              '0-18': 0,\n              '19-35': 0,\n              '36-50': 0,\n              '51-65': 0,\n              '65+': 0\n            }\n          },\n          revenue: {\n            total: overallStats.data.data?.revenue?.thisMonth || 0,\n            thisMonth: overallStats.data.data?.revenue?.thisMonth || 0,\n            lastMonth: overallStats.data.data?.revenue?.lastMonth || 0,\n            pending: 0,\n            overdue: 0\n          },\n          activities: {\n            recentAppointments: [],\n            recentPatients: [],\n            upcomingAppointments: []\n          }\n        };\n\n        return {\n          success: true,\n          data: dashboardData,\n          message: 'Overall dashboard statistics retrieved successfully'\n        };\n      } catch (authError: any) {\n        // If authentication fails, return empty data with appropriate message\n        console.warn('Failed to fetch overall statistics, likely due to authentication:', authError.response?.status);\n        \n        const emptyDashboardData: DashboardStats = {\n          appointments: { total: 0, today: 0, upcoming: 0, completed: 0, cancelled: 0, noShow: 0 },\n          patients: { \n            total: 0, new: 0, active: 0, \n            byGender: { male: 0, female: 0, other: 0 },\n            byAgeGroup: { '0-18': 0, '19-35': 0, '36-50': 0, '51-65': 0, '65+': 0 }\n          },\n          revenue: { total: 0, thisMonth: 0, lastMonth: 0, pending: 0, overdue: 0 },\n          activities: { recentAppointments: [], recentPatients: [], upcomingAppointments: [] }\n        };\n\n        return {\n          success: true,\n          data: emptyDashboardData,\n          message: 'Please log in as an admin to view overall statistics'\n        };\n      }\n    }\n    \n    const params = createSafeApiParams(clinicId);\n    \n    // Log the parameters being sent for debugging (development only)\n    if (import.meta.env.DEV) {\n      console.log(' getDashboardStats params:', params, 'original clinicId:', clinicId);\n    }\n    \n    // Fetch data from multiple endpoints in parallel with error handling\n    const results = await Promise.allSettled([\n      api.get('/api/v1/appointments/statistics', { params }),\n      api.get('/api/v1/patients/statistics', { params }),\n      api.get('/api/v1/billing/stats/revenue', { params }),\n      api.get('/api/v1/appointments/today', { params }),\n      api.get('/api/v1/appointments/upcoming', { params: { ...params, days: 7 } }),\n      api.get('/api/v1/patients/recent', { params: { ...params, limit: 5 } })\n    ]);\n    \n    // Extract successful responses or provide empty defaults with better error handling\n    const appointmentStats = results[0].status === 'fulfilled' ? results[0].value : { data: { data: {} } };\n    const patientStats = results[1].status === 'fulfilled' ? results[1].value : { data: { data: {} } };\n    const revenueStats = results[2].status === 'fulfilled' ? results[2].value : { data: { data: {} } };\n    const todayAppointments = results[3].status === 'fulfilled' ? results[3].value : { data: { data: [] } };\n    const upcomingAppointments = results[4].status === 'fulfilled' ? results[4].value : { data: { data: [] } };\n    const recentPatients = results[5].status === 'fulfilled' ? results[5].value : { data: { data: [] } };\n\n    // Log failed requests for debugging\n    results.forEach((result, index) => {\n      if (result.status === 'rejected') {\n        const endpoints = ['appointments/statistics', 'patients/statistics', 'billing/stats/revenue', 'appointments/today', 'appointments/upcoming', 'patients/recent'];\n        console.warn(`Failed to fetch ${endpoints[index]}:`, result.reason?.response?.status, result.reason?.response?.data);\n      }\n    });\n\n    // Combine all the data\n    const dashboardData: DashboardStats = {\n      appointments: {\n        total: appointmentStats.data.data?.total || 0,\n        today: todayAppointments.data.data?.length || 0,\n        upcoming: upcomingAppointments.data.data?.length || 0,\n        completed: appointmentStats.data.data?.completed || 0,\n        cancelled: appointmentStats.data.data?.cancelled || 0,\n        noShow: appointmentStats.data.data?.noShow || 0\n      },\n      patients: {\n        total: patientStats.data.data?.total || 0,\n        new: patientStats.data.data?.newThisMonth || 0,\n        active: patientStats.data.data?.active || 0,\n        byGender: {\n          male: patientStats.data.data?.byGender?.male || 0,\n          female: patientStats.data.data?.byGender?.female || 0,\n          other: patientStats.data.data?.byGender?.other || 0\n        },\n        byAgeGroup: {\n          '0-18': patientStats.data.data?.byAgeGroup?.['0-18'] || 0,\n          '19-35': patientStats.data.data?.byAgeGroup?.['19-35'] || 0,\n          '36-50': patientStats.data.data?.byAgeGroup?.['36-50'] || 0,\n          '51-65': patientStats.data.data?.byAgeGroup?.['51-65'] || 0,\n          '65+': patientStats.data.data?.byAgeGroup?.['65+'] || 0\n        }\n      },\n      revenue: {\n        total: revenueStats.data.data?.total || 0,\n        thisMonth: revenueStats.data.data?.thisMonth || 0,\n        lastMonth: revenueStats.data.data?.lastMonth || 0,\n        pending: revenueStats.data.data?.pending || 0,\n        overdue: revenueStats.data.data?.overdue || 0\n      },\n      activities: {\n        recentAppointments: Array.isArray(todayAppointments.data.data) ? todayAppointments.data.data : [],\n        recentPatients: Array.isArray(recentPatients.data.data) ? recentPatients.data.data : [],\n        upcomingAppointments: Array.isArray(upcomingAppointments.data.data) ? upcomingAppointments.data.data.slice(0, 5) : []\n      }\n    };\n\n    return {\n      success: true,\n      data: dashboardData,\n      message: 'Dashboard statistics retrieved successfully'\n    };\n  } catch (error: any) {\n    console.error('Error fetching dashboard stats:', error);\n    return {\n      success: false,\n      message: error.response?.data?.message || 'Failed to fetch dashboard statistics',\n      error: error.response?.data?.error || error.message\n    };\n  }\n};\n\n// Get recent activities\nexport const getRecentActivities = async (limit: number = 10, clinicId?: string): Promise<ApiResponse<RecentActivity[]>> => {\n  try {\n    // If no clinicId is provided, get overall activities for admin users\n    if (!clinicId) {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        return {\n          success: true,\n          data: [],\n          message: 'Please log in to view activities'\n        };\n      }\n      try {\n        const userResponse = await api.get('/api/v1/auth/me');\n        const userRole = userResponse.data?.role;\n        if (userRole === 'admin' || userRole === 'dentist') {\n          // Use Promise.allSettled to handle partial failures\n          const results = await Promise.allSettled([\n            api.get('/api/v1/appointments/recent/overall', { params: { limit } }),\n            api.get('/api/v1/patients/recent/overall', { params: { limit } })\n          ]);\n          \n          // Extract successful responses\n          const recentAppointments = results[0].status === 'fulfilled' ? results[0].value : { data: { data: [] } };\n          const recentPatients = results[1].status === 'fulfilled' ? results[1].value : { data: { data: [] } };\n          \n          const activities: RecentActivity[] = [];\n\n          // Add recent appointments\n          if (recentAppointments.data.data) {\n            recentAppointments.data.data.forEach((appointment: any) => {\n              activities.push({\n                id: appointment._id,\n                type: 'appointment',\n                title: `Appointment with ${appointment.patient?.firstName} ${appointment.patient?.lastName}`,\n                description: `${appointment.treatmentType} - ${appointment.status}`,\n                timestamp: appointment.createdAt,\n                status: appointment.status\n              });\n            });\n          }\n\n        // Add recent patients\n        if (recentPatients.data.data) {\n          recentPatients.data.data.forEach((patient: any) => {\n            activities.push({\n              id: patient._id,\n              type: 'patient',\n              title: `New Patient: ${patient.firstName} ${patient.lastName}`,\n              description: `Registered on ${new Date(patient.createdAt).toLocaleDateString()}`,\n              timestamp: patient.createdAt\n            });\n          });\n        }\n\n          // Sort by timestamp (most recent first)\n          activities.sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n\n          return {\n            success: true,\n            data: activities.slice(0, limit),\n            message: 'Overall recent activities retrieved successfully'\n          };\n        } else {\n          // Return empty activities for non-admin/non-dentist users\n          return {\n            success: true,\n            data: [],\n            message: 'Access restricted: Overall activities are only available for admin or dentist roles'\n          };\n        }\n      } catch (authError: any) {\n        // If authentication fails, return empty activities with appropriate message\n        console.warn('Failed to fetch overall activities, likely due to authentication:', authError.response?.status);\n        \n        return {\n          success: true,\n          data: [],\n          message: 'Please log in as an admin to view overall activities'\n        };\n      }\n    }\n    \n    const params = createSafeApiParams(clinicId, { limit });\n    \n    // Log the parameters being sent for debugging (development only)\n    if (import.meta.env.DEV) {\n      console.log(' getRecentActivities params:', params);\n    }\n    \n    // Fetch recent data from multiple endpoints with error handling\n    const results = await Promise.allSettled([\n      api.get('/api/v1/appointments/recent', { params }),\n      api.get('/api/v1/patients/recent', { params })\n    ]);\n    \n    // Log failed requests for debugging\n    results.forEach((result, index) => {\n      if (result.status === 'rejected') {\n        const endpoints = ['appointments/recent', 'patients/recent'];\n        console.warn(`Failed to fetch recent ${endpoints[index]}:`, result.reason?.response?.status, result.reason?.response?.data);\n      }\n    });\n    \n    // Extract successful responses\n    const recentAppointments = results[0].status === 'fulfilled' ? results[0].value : { data: { data: [] } };\n    const recentPatients = results[1].status === 'fulfilled' ? results[1].value : { data: { data: [] } };\n\n    const activities: RecentActivity[] = [];\n\n    // Add recent appointments\n    if (recentAppointments.data && recentAppointments.data.data && Array.isArray(recentAppointments.data.data)) {\n      recentAppointments.data.data.forEach((appointment: any) => {\n        activities.push({\n          id: appointment._id,\n          type: 'appointment',\n          title: `Appointment with ${appointment.patient?.firstName} ${appointment.patient?.lastName}`,\n          description: `${appointment.treatmentType} - ${appointment.status}`,\n          timestamp: appointment.createdAt,\n          status: appointment.status\n        });\n      });\n    }\n\n    // Add recent patients\n    if (recentPatients.data && recentPatients.data.data && Array.isArray(recentPatients.data.data)) {\n      recentPatients.data.data.forEach((patient: any) => {\n        activities.push({\n          id: patient._id,\n          type: 'patient',\n          title: `New Patient: ${patient.firstName} ${patient.lastName}`,\n          description: `Registered on ${new Date(patient.createdAt).toLocaleDateString()}`,\n          timestamp: patient.createdAt\n        });\n      });\n    }\n\n    // Sort by timestamp (most recent first)\n    activities.sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n\n    return {\n      success: true,\n      data: activities.slice(0, limit),\n      message: 'Recent activities retrieved successfully'\n    };\n  } catch (error: any) {\n    console.error('Error fetching recent activities:', error);\n    return {\n      success: false,\n      message: error.response?.data?.message || 'Failed to fetch recent activities',\n      error: error.response?.data?.error || error.message\n    };\n  }\n};\n\n// Get billing summary\nexport const getBillingSummary = async (clinicId?: string): Promise<ApiResponse<any>> => {\n  try {\n    const params = createSafeApiParams(clinicId);\n    const response = await api.get('/api/v1/billing/summary', { params });\n    return response.data;\n  } catch (error: any) {\n    console.error('Error fetching billing summary:', error);\n    return {\n      success: false,\n      message: error.response?.data?.message || 'Failed to fetch billing summary',\n      error: error.response?.data?.error || error.message\n    };\n  }\n};\n\n// Get overdue bills\nexport const getOverdueBills = async (clinicId?: string): Promise<ApiResponse<any[]>> => {\n  try {\n    const params = createSafeApiParams(clinicId);\n    const response = await api.get('/api/v1/billing/overdue', { params });\n    return response.data;\n  } catch (error: any) {\n    console.error('Error fetching overdue bills:', error);\n    return {\n      success: false,\n      message: error.response?.data?.message || 'Failed to fetch overdue bills',\n      error: error.response?.data?.error || error.message\n    };\n  }\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\dentistService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1255,1258],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1255,1258],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":74,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2193,2196],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2193,2196],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4109,4112],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4109,4112],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5250,5253],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5250,5253],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6400,6403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6400,6403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":216,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7533,7536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7533,7536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":305,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10490,10493],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10490,10493],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":361,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":361,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12621,12624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12621,12624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":430,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":430,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14832,14835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14832,14835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":462,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":462,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15921,15924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15921,15924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":512,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":512,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17623,17626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17623,17626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":562,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":562,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19270,19273],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19270,19273],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":632,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":632,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21439,21442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21439,21442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\r\nimport { profileCache } from '../utils/cacheManager';\r\nimport { \r\n  safeAccess, \r\n  safeArrayMap, \r\n  isValidArray, \r\n  validateResponseStructure,\r\n  exists \r\n} from '../utils/safeAccess';\r\nimport { \r\n  handleApiError, \r\n  handleSuccess\r\n} from '../utils/errorHandler';\r\nimport type { ErrorHandlerOptions } from '../utils/errorHandler';\r\nimport { logError, logWarn, logInfo, logApiCall } from '../utils/logger';\r\nimport type {\r\n  ApiResponse,\r\n  PaginatedResponse,\r\n  Appointment,\r\n  Dentist,\r\n  DentistClinicAssociation,\r\n  UpdateDentistProfileRequest,\r\n  ClinicAvailability\r\n} from '../types';\r\n\r\n// Dentist appointments query params\r\nexport interface DentistAppointmentsParams {\r\n  status?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n// Re-export types for backward compatibility\r\nexport type { Dentist, UpdateDentistProfileRequest as UpdateDentistRequest };\r\nexport type DentistClinic = DentistClinicAssociation;\r\n\r\n// Dentist availability schedule (service-specific format)\r\nexport interface DentistAvailability {\r\n  clinicId: string;\r\n  clinicName?: string;\r\n  schedule: ClinicAvailability;\r\n}\r\n\r\n// Transform backend dentist data\r\nconst transformDentistData = (dentist: any): Dentist => {\r\n  return {\r\n    id: dentist.id || dentist._id,\r\n    firstName: dentist.firstName,\r\n    lastName: dentist.lastName,\r\n    email: dentist.email,\r\n    phone: dentist.phone,\r\n    role: 'dentist',\r\n    specialization: dentist.specialization || '',\r\n    licenseNumber: dentist.licenseNumber || '',\r\n    bio: dentist.bio,\r\n    yearsOfExperience: dentist.yearsOfExperience,\r\n    education: dentist.education || [],\r\n    certifications: dentist.certifications || [],\r\n    profileImage: dentist.profileImage,\r\n    rating: dentist.rating,\r\n    reviewCount: dentist.reviewCount,\r\n    isActive: dentist.isActive !== undefined ? dentist.isActive : true,\r\n    dateOfBirth: dentist.dateOfBirth,\r\n    gender: dentist.gender,\r\n    address: dentist.address,\r\n    createdAt: new Date(dentist.createdAt),\r\n    updatedAt: new Date(dentist.updatedAt)\r\n  };\r\n};\r\n\r\n// Transform appointment data\r\nconst transformAppointmentData = (appointment: any): Appointment => {\r\n  return {\r\n    id: appointment.id || appointment._id,\r\n    patientId: appointment.patientId || appointment.patient?.id,\r\n    dentistId: appointment.dentistId || appointment.dentist?.id,\r\n    clinicId: appointment.clinicId || appointment.clinic?.id,\r\n    clinicName: appointment.clinicName || appointment.clinic?.name,\r\n    dentistName: appointment.dentistName ||\r\n      (appointment.dentist ? `${appointment.dentist.firstName} ${appointment.dentist.lastName}` : undefined),\r\n    patientName: appointment.patientName ||\r\n      (appointment.patient ? `${appointment.patient.firstName} ${appointment.patient.lastName}` : undefined),\r\n    serviceType: appointment.serviceType || appointment.service?.name || '',\r\n    date: appointment.date,\r\n    timeSlot: appointment.timeSlot || appointment.time,\r\n    duration: appointment.duration || 30,\r\n    status: appointment.status || 'scheduled',\r\n    notes: appointment.notes,\r\n    createdAt: new Date(appointment.createdAt),\r\n    updatedAt: new Date(appointment.updatedAt)\r\n  };\r\n};\r\n\r\n/**\r\n * Get dentist by ID\r\n * Fetches complete dentist profile data including professional information\r\n * Uses caching to improve performance\r\n * @param id - Dentist user ID\r\n * @param useCache - Whether to use cached data (default: true)\r\n * @returns Promise<Dentist> - Complete dentist profile\r\n * @throws Error if fetch fails\r\n */\r\nexport const getDentistById = async (id: string, useCache: boolean = true): Promise<Dentist> => {\r\n  const startTime = Date.now();\r\n  \r\n  try {\r\n    logInfo('Fetching dentist profile', { dentistId: id, useCache });\r\n\r\n    // Check cache first if enabled\r\n    if (useCache) {\r\n      const cached = profileCache.getDentistProfile(id);\r\n      if (cached) {\r\n        logInfo('Dentist profile loaded from cache', { dentistId: id });\r\n        return cached as Dentist;\r\n      }\r\n    }\r\n\r\n    const response = await api.get<ApiResponse<any>>(`/api/v1/users/${id}`);\r\n    const duration = Date.now() - startTime;\r\n    \r\n    logApiCall('GET', `/api/v1/users/${id}`, response.status, duration);\r\n\r\n    // Validate response structure\r\n    if (!validateResponseStructure(response.data, { data: 'object' })) {\r\n      const error = new Error('Invalid response structure from server');\r\n      logError('Invalid dentist profile response structure', error, { \r\n        dentistId: id, \r\n        responseKeys: Object.keys(response.data || {}) \r\n      });\r\n      throw error;\r\n    }\r\n\r\n    const rawData = safeAccess(response.data, 'data');\r\n    if (!exists(rawData)) {\r\n      const error = new Error('Dentist profile not found');\r\n      logError('No dentist data in response', error, { dentistId: id });\r\n      throw error;\r\n    }\r\n\r\n    const dentistData = transformDentistData(rawData);\r\n\r\n    // Cache the result\r\n    if (useCache) {\r\n      profileCache.setDentistProfile(id, dentistData);\r\n      logInfo('Dentist profile cached', { dentistId: id });\r\n    }\r\n\r\n    logInfo('Dentist profile loaded successfully', { dentistId: id, duration });\r\n    return dentistData;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    logError('Failed to fetch dentist profile', error, { dentistId: id, duration });\r\n    \r\n    const errorOptions: ErrorHandlerOptions = {\r\n      customMessage: 'Unable to load dentist profile. Please try again.',\r\n      showToast: true,\r\n      logError: false // Already logged above\r\n    };\r\n    \r\n    const errorDetails = handleApiError(error, errorOptions);\r\n    throw new Error(errorDetails.message);\r\n  }\r\n};\r\n\r\n/**\r\n * Update dentist profile\r\n * Updates dentist profile information including personal and professional details\r\n * Invalidates cache after successful update\r\n * @param id - Dentist user ID\r\n * @param dentistData - Partial dentist data to update\r\n * @returns Promise<Dentist> - Updated dentist profile\r\n * @throws Error if update fails\r\n */\r\nexport const updateDentist = async (id: string, dentistData: UpdateDentistProfileRequest): Promise<Dentist> => {\r\n  const startTime = Date.now();\r\n  \r\n  try {\r\n    logInfo('Updating dentist profile', { \r\n      dentistId: id, \r\n      updateFields: Object.keys(dentistData) \r\n    });\r\n\r\n    const response = await api.put<ApiResponse<any>>(`/api/v1/users/${id}`, dentistData);\r\n    const duration = Date.now() - startTime;\r\n    \r\n    logApiCall('PUT', `/api/v1/users/${id}`, response.status, duration);\r\n\r\n    // Validate response structure\r\n    if (!validateResponseStructure(response.data, { data: 'object' })) {\r\n      const error = new Error('Invalid response structure from server');\r\n      logError('Invalid update response structure', error, { \r\n        dentistId: id, \r\n        responseKeys: Object.keys(response.data || {}) \r\n      });\r\n      throw error;\r\n    }\r\n\r\n    const rawData = safeAccess(response.data, 'data');\r\n    if (!exists(rawData)) {\r\n      const error = new Error('No updated data returned from server');\r\n      logError('No data in update response', error, { dentistId: id });\r\n      throw error;\r\n    }\r\n\r\n    const updatedData = transformDentistData(rawData);\r\n\r\n    // Update cache with new data\r\n    profileCache.setDentistProfile(id, updatedData);\r\n    \r\n    logInfo('Dentist profile updated successfully', { dentistId: id, duration });\r\n    handleSuccess('Profile updated successfully');\r\n\r\n    return updatedData;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    logError('Failed to update dentist profile', error, { dentistId: id, duration });\r\n    \r\n    const errorOptions: ErrorHandlerOptions = {\r\n      customMessage: 'Unable to update profile. Please check your information and try again.',\r\n      showToast: true,\r\n      logError: false // Already logged above\r\n    };\r\n    \r\n    const errorDetails = handleApiError(error, errorOptions);\r\n    throw new Error(errorDetails.message);\r\n  }\r\n};\r\n\r\n/**\r\n * Upload dentist profile image\r\n * Uploads and updates dentist profile picture\r\n * @param id - Dentist user ID\r\n * @param file - Image file to upload (jpg, png, gif, max 5MB)\r\n * @returns Promise<string> - URL of uploaded image\r\n * @throws Error if upload fails or file validation fails\r\n */\r\nexport const uploadDentistImage = async (id: string, file: File): Promise<string> => {\r\n  const startTime = Date.now();\r\n  \r\n  try {\r\n    logInfo('Starting profile image upload', { \r\n      dentistId: id, \r\n      fileName: file.name,\r\n      fileSize: file.size,\r\n      fileType: file.type\r\n    });\r\n\r\n    // Validate file type\r\n    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];\r\n    if (!allowedTypes.includes(file.type)) {\r\n      const error = new Error('Please select a valid image file (JPG, PNG, or GIF)');\r\n      logWarn('Invalid file type for image upload', { \r\n        dentistId: id, \r\n        fileType: file.type, \r\n        allowedTypes \r\n      });\r\n      throw error;\r\n    }\r\n\r\n    // Validate file size (5MB max)\r\n    const maxSize = 5 * 1024 * 1024; // 5MB in bytes\r\n    if (file.size > maxSize) {\r\n      const error = new Error('Image file is too large. Please select a file smaller than 5MB');\r\n      logWarn('File size exceeds limit for image upload', { \r\n        dentistId: id, \r\n        fileSize: file.size, \r\n        maxSize \r\n      });\r\n      throw error;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n\r\n    const response = await api.post<ApiResponse<{ fileUrl: string }>>(`/api/v1/users/${id}/upload-image`, formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n\r\n    const duration = Date.now() - startTime;\r\n    logApiCall('POST', `/api/v1/users/${id}/upload-image`, response.status, duration);\r\n\r\n    // Validate response structure\r\n    const fileUrl = safeAccess(response.data, 'data.fileUrl');\r\n    if (!exists(fileUrl) || typeof fileUrl !== 'string') {\r\n      const error = new Error('Upload completed but no image URL was returned');\r\n      logError('Invalid upload response structure', error, { \r\n        dentistId: id, \r\n        responseData: response.data \r\n      });\r\n      throw error;\r\n    }\r\n\r\n    logInfo('Profile image uploaded successfully', { \r\n      dentistId: id, \r\n      fileUrl, \r\n      duration \r\n    });\r\n    \r\n    handleSuccess('Profile image updated successfully');\r\n    return fileUrl;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    logError('Failed to upload profile image', error, { dentistId: id, duration });\r\n    \r\n    // Don't show toast for validation errors as they're user-friendly already\r\n    const isValidationError = error.message?.includes('Please select') || \r\n                             error.message?.includes('too large');\r\n    \r\n    const errorOptions: ErrorHandlerOptions = {\r\n      customMessage: isValidationError ? error.message : 'Unable to upload image. Please try again.',\r\n      showToast: !isValidationError, // Don't show toast for validation errors\r\n      logError: false // Already logged above\r\n    };\r\n    \r\n    const errorDetails = handleApiError(error, errorOptions);\r\n    throw new Error(errorDetails.message);\r\n  }\r\n};\r\n\r\n/**\r\n * Get dentist's associated clinics\r\n * Fetches all clinics where the dentist is affiliated\r\n * @param dentistId - Dentist user ID\r\n * @returns Promise<DentistClinicAssociation[]> - Array of associated clinics\r\n * @throws Never throws - returns empty array for all error cases to prevent crashes\r\n */\r\nexport const getDentistClinics = async (dentistId: string): Promise<DentistClinicAssociation[]> => {\r\n  const startTime = Date.now();\r\n  \r\n  try {\r\n    logInfo('Fetching dentist clinics', { dentistId });\r\n\r\n    const response = await api.get<ApiResponse<DentistClinicAssociation[]>>(`/api/v1/users/${dentistId}/clinics`);\r\n    const duration = Date.now() - startTime;\r\n    \r\n    logApiCall('GET', `/api/v1/users/${dentistId}/clinics`, response.status, duration);\r\n\r\n    // Validate response structure using safe access\r\n    const clinicsData = safeAccess(response.data, 'data');\r\n    \r\n    if (!isValidArray(clinicsData)) {\r\n      logWarn('Invalid clinics response structure - expected array', { \r\n        dentistId, \r\n        responseKeys: Object.keys(response.data || {}),\r\n        dataType: typeof clinicsData\r\n      });\r\n      return [];\r\n    }\r\n\r\n    logInfo('Dentist clinics loaded successfully', { \r\n      dentistId, \r\n      clinicCount: clinicsData.length, \r\n      duration \r\n    });\r\n\r\n    return clinicsData;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    \r\n    // Handle 404 errors gracefully - endpoint might not exist yet\r\n    if (error.response?.status === 404) {\r\n      logWarn('Clinics API endpoint not found - feature may not be implemented yet', { \r\n        dentistId, \r\n        duration \r\n      });\r\n      return [];\r\n    }\r\n\r\n    // Log other errors but don't show user notifications for this non-critical feature\r\n    logWarn('Failed to fetch dentist clinics', { \r\n      dentistId, \r\n      error: error.message,\r\n      status: error.response?.status,\r\n      duration\r\n    });\r\n\r\n    // Always return empty array to prevent application crashes\r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Get dentist's appointments\r\n * Fetches appointments for a specific dentist with optional filtering\r\n * Uses caching for better performance\r\n * @param dentistId - Dentist user ID\r\n * @param params - Optional query parameters for filtering\r\n * @param useCache - Whether to use cached data (default: true)\r\n * @returns Promise<PaginatedResponse<Appointment>> - Paginated list of appointments\r\n * @throws Never throws - returns empty result for all error cases to prevent crashes\r\n */\r\nexport const getDentistAppointments = async (\r\n  dentistId: string,\r\n  params?: DentistAppointmentsParams,\r\n  useCache: boolean = true\r\n): Promise<PaginatedResponse<Appointment>> => {\r\n  const startTime = Date.now();\r\n  const defaultResult = {\r\n    data: [],\r\n    total: 0,\r\n    totalPages: 0,\r\n    page: 1,\r\n    limit: params?.limit || 10,\r\n    success: false\r\n  };\r\n\r\n  try {\r\n    logInfo('Fetching dentist appointments', { \r\n      dentistId, \r\n      params: params || {},\r\n      useCache \r\n    });\r\n\r\n    // Create cache key based on params\r\n    const cacheKey = `${dentistId}_${JSON.stringify(params || {})}`;\r\n\r\n    // Check cache first if enabled and no specific filters\r\n    if (useCache && (!params || Object.keys(params).length === 0)) {\r\n      const cached = profileCache.getAppointments(cacheKey);\r\n      if (cached) {\r\n        logInfo('Appointments loaded from cache', { dentistId, cacheKey });\r\n        return cached as PaginatedResponse<Appointment>;\r\n      }\r\n    }\r\n\r\n    const response = await api.get<PaginatedResponse<any>>('/api/v1/appointments', {\r\n      params: {\r\n        dentistId,\r\n        ...params\r\n      }\r\n    });\r\n\r\n    const duration = Date.now() - startTime;\r\n    logApiCall('GET', '/api/v1/appointments', response.status, duration, { dentistId });\r\n\r\n    // Validate response structure using safe access\r\n    if (!exists(response) || !exists(response.data)) {\r\n      logWarn('No response data received for appointments', { dentistId, duration });\r\n      return defaultResult;\r\n    }\r\n\r\n    // Validate that response.data.data exists and is an array\r\n    const appointmentsData = safeAccess(response.data, 'data');\r\n    \r\n    if (!isValidArray(appointmentsData)) {\r\n      logWarn('Invalid appointments response structure - expected array', { \r\n        dentistId, \r\n        responseKeys: Object.keys(response.data),\r\n        dataType: typeof appointmentsData,\r\n        duration\r\n      });\r\n      return defaultResult;\r\n    }\r\n\r\n    // Safe array mapping with individual error handling for each appointment\r\n    const transformedData = safeArrayMap(\r\n      appointmentsData,\r\n      (appointment: any, index: number) => {\r\n        if (!exists(appointment) || typeof appointment !== 'object') {\r\n          logWarn('Invalid appointment data at index', { \r\n            dentistId, \r\n            index, \r\n            appointmentType: typeof appointment \r\n          });\r\n          return null;\r\n        }\r\n        \r\n        try {\r\n          return transformAppointmentData(appointment);\r\n        } catch (transformError) {\r\n          logWarn('Failed to transform appointment data', { \r\n            dentistId, \r\n            index, \r\n            error: transformError \r\n          });\r\n          return null;\r\n        }\r\n      }\r\n    ).filter(appointment => appointment !== null) as Appointment[];\r\n\r\n    // Safely extract pagination data\r\n    const total = safeAccess(response.data, 'total', { fallback: 0 });\r\n    const page = safeAccess(response.data, 'page', { fallback: 1 });\r\n    const limit = safeAccess(response.data, 'limit', { fallback: params?.limit || 10 });\r\n\r\n    const result = {\r\n      data: transformedData,\r\n      total: typeof total === 'number' ? total : 0,\r\n      totalPages: Math.ceil((typeof total === 'number' ? total : 0) / limit),\r\n      page: typeof page === 'number' ? page : 1,\r\n      limit: typeof limit === 'number' ? limit : (params?.limit || 10),\r\n      success: true\r\n    };\r\n\r\n    // Cache the result if no specific filters\r\n    if (useCache && (!params || Object.keys(params).length === 0)) {\r\n      profileCache.setAppointments(cacheKey, result);\r\n    }\r\n\r\n    logInfo('Appointments loaded successfully', { \r\n      dentistId, \r\n      appointmentCount: transformedData.length,\r\n      total: result.total,\r\n      duration \r\n    });\r\n\r\n    return result;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    \r\n    logWarn('Failed to fetch dentist appointments', { \r\n      dentistId, \r\n      error: error.message,\r\n      status: error.response?.status,\r\n      duration\r\n    });\r\n\r\n    // Always return empty result instead of throwing to prevent crashes\r\n    return defaultResult;\r\n  }\r\n};\r\n\r\n/**\r\n * Get dentist's availability schedule\r\n * Fetches working hours and availability for all associated clinics\r\n * @param dentistId - Dentist user ID\r\n * @returns Promise<DentistAvailability[]> - Array of availability schedules per clinic\r\n * @throws Error if fetch fails (returns empty array if endpoint not available)\r\n */\r\nexport const getDentistAvailability = async (dentistId: string): Promise<DentistAvailability[]> => {\r\n  const startTime = Date.now();\r\n  \r\n  try {\r\n    logInfo('Fetching dentist availability', { dentistId });\r\n\r\n    const response = await api.get<ApiResponse<DentistAvailability[]>>(`/api/v1/users/${dentistId}/availability`);\r\n    const duration = Date.now() - startTime;\r\n    \r\n    logApiCall('GET', `/api/v1/users/${dentistId}/availability`, response.status, duration);\r\n\r\n    const availabilityData = safeAccess(response.data, 'data', { fallback: [] });\r\n    \r\n    if (!isValidArray(availabilityData)) {\r\n      logWarn('Invalid availability response structure', { \r\n        dentistId, \r\n        dataType: typeof availabilityData \r\n      });\r\n      return [];\r\n    }\r\n\r\n    logInfo('Dentist availability loaded successfully', { \r\n      dentistId, \r\n      scheduleCount: availabilityData.length, \r\n      duration \r\n    });\r\n\r\n    return availabilityData;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    \r\n    // If endpoint doesn't exist yet, return empty array gracefully\r\n    if (error.response?.status === 404) {\r\n      logWarn('Availability API endpoint not found - feature may not be implemented yet', { \r\n        dentistId, \r\n        duration \r\n      });\r\n    } else {\r\n      logWarn('Failed to fetch dentist availability', { \r\n        dentistId, \r\n        error: error.message,\r\n        status: error.response?.status,\r\n        duration\r\n      });\r\n    }\r\n    \r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Update dentist's availability schedule\r\n * Updates working hours and availability for associated clinics\r\n * @param dentistId - Dentist user ID\r\n * @param availability - Array of availability schedules to update\r\n * @returns Promise<DentistAvailability[]> - Updated availability schedules\r\n * @throws Error if update fails\r\n */\r\nexport const updateDentistAvailability = async (\r\n  dentistId: string,\r\n  availability: DentistAvailability[]\r\n): Promise<DentistAvailability[]> => {\r\n  const startTime = Date.now();\r\n  \r\n  try {\r\n    logInfo('Updating dentist availability', { \r\n      dentistId, \r\n      scheduleCount: availability.length \r\n    });\r\n\r\n    const response = await api.put<ApiResponse<DentistAvailability[]>>(\r\n      `/api/v1/users/${dentistId}/availability`,\r\n      { availability }\r\n    );\r\n\r\n    const duration = Date.now() - startTime;\r\n    logApiCall('PUT', `/api/v1/users/${dentistId}/availability`, response.status, duration);\r\n\r\n    // Validate response structure\r\n    const updatedData = safeAccess(response.data, 'data');\r\n    \r\n    if (!isValidArray(updatedData)) {\r\n      const error = new Error('Invalid response structure from server');\r\n      logError('Invalid availability update response', error, { \r\n        dentistId, \r\n        responseKeys: Object.keys(response.data || {}) \r\n      });\r\n      throw error;\r\n    }\r\n\r\n    logInfo('Dentist availability updated successfully', { \r\n      dentistId, \r\n      scheduleCount: updatedData.length, \r\n      duration \r\n    });\r\n    \r\n    handleSuccess('Availability schedule updated successfully');\r\n    return updatedData;\r\n  } catch (error: any) {\r\n    const duration = Date.now() - startTime;\r\n    logError('Failed to update dentist availability', error, { dentistId, duration });\r\n    \r\n    const errorOptions: ErrorHandlerOptions = {\r\n      customMessage: 'Unable to update availability schedule. Please try again.',\r\n      showToast: true,\r\n      logError: false // Already logged above\r\n    };\r\n    \r\n    const errorDetails = handleApiError(error, errorOptions);\r\n    throw new Error(errorDetails.message);\r\n  }\r\n};\r\n\r\n// Create service instance\r\nconst dentistService = {\r\n  getDentistById,\r\n  updateDentist,\r\n  uploadDentistImage,\r\n  getDentistClinics,\r\n  getDentistAppointments,\r\n  getDentistAvailability,\r\n  updateDentistAvailability\r\n};\r\n\r\nexport { dentistService };\r\nexport default dentistService;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\doctorScheduleService.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"An interface declaring no members is equivalent to its supertype.","line":53,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":53,"endColumn":36,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1056,1123],"text":"type UpdateScheduleData = Partial<CreateScheduleData>"},"desc":"Replace empty interface with a type alias."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":221,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":221,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6476,6479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6476,6479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\n\nexport interface DoctorSchedule {\n  _id: string;\n  doctorId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    specialization?: string;\n  };\n  clinicId: {\n    _id: string;\n    name: string;\n    branchName?: string;\n  };\n  dayOfWeek: number; // 0 = Sunday, 1 = Monday, ..., 6 = Saturday\n  startTime: string; // HH:MM format\n  endTime: string; // HH:MM format\n  slotDuration: number; // in minutes\n  isActive: boolean;\n  effectiveFrom: string;\n  effectiveUntil?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface AvailableDoctor {\n  doctorId: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    specialization?: string;\n  };\n  startTime: string;\n  endTime: string;\n  slotDuration: number;\n}\n\nexport interface CreateScheduleData {\n  doctorId: string;\n  clinicId: string;\n  dayOfWeek: number;\n  startTime: string;\n  endTime: string;\n  slotDuration: number;\n  isActive?: boolean;\n  effectiveFrom?: string;\n  effectiveUntil?: string;\n}\n\nexport interface UpdateScheduleData extends Partial<CreateScheduleData> {}\n\nclass DoctorScheduleService {\n  /**\n   * Get all doctor schedules with optional filters\n   */\n  async getAllSchedules(filters?: {\n    doctorId?: string;\n    clinicId?: string;\n    dayOfWeek?: number;\n    isActive?: boolean;\n  }): Promise<{ data: DoctorSchedule[]; count: number }> {\n    const params = new URLSearchParams();\n    if (filters?.doctorId) params.append('doctorId', filters.doctorId);\n    if (filters?.clinicId) params.append('clinicId', filters.clinicId);\n    if (filters?.dayOfWeek !== undefined) params.append('dayOfWeek', filters.dayOfWeek.toString());\n    if (filters?.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n\n    const response = await api.get(`/schedules?${params.toString()}`);\n    return response.data;\n  }\n\n  /**\n   * Get a single schedule by ID\n   */\n  async getScheduleById(id: string): Promise<DoctorSchedule> {\n    const response = await api.get(`/schedules/${id}`);\n    return response.data.data;\n  }\n\n  /**\n   * Get all schedules for a specific doctor\n   */\n  async getSchedulesByDoctor(doctorId: string): Promise<DoctorSchedule[]> {\n    const response = await api.get(`/schedules/doctor/${doctorId}`);\n    return response.data.data;\n  }\n\n  /**\n   * Get all schedules for a specific clinic\n   */\n  async getSchedulesByClinic(clinicId: string): Promise<DoctorSchedule[]> {\n    const response = await api.get(`/schedules/clinic/${clinicId}`);\n    return response.data.data;\n  }\n\n  /**\n   * Get available doctors for a specific clinic and day of week\n   */\n  async getAvailableDoctors(clinicId: string, dayOfWeek: number): Promise<AvailableDoctor[]> {\n    const response = await api.get(`/schedules/available`, {\n      params: { clinicId, dayOfWeek }\n    });\n    return response.data.data;\n  }\n\n  /**\n   * Get available doctors for a specific clinic and date\n   * This converts the date to day of week and calls the API\n   */\n  async getAvailableDoctorsForDate(clinicId: string, date: Date): Promise<AvailableDoctor[]> {\n    const dayOfWeek = date.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday\n    return this.getAvailableDoctors(clinicId, dayOfWeek);\n  }\n\n  /**\n   * Create a new doctor schedule\n   */\n  async createSchedule(data: CreateScheduleData): Promise<DoctorSchedule> {\n    const response = await api.post('/schedules', data);\n    return response.data.data;\n  }\n\n  /**\n   * Bulk create doctor schedules\n   */\n  async bulkCreateSchedules(schedules: CreateScheduleData[]): Promise<DoctorSchedule[]> {\n    const response = await api.post('/schedules/bulk', schedules);\n    return response.data.data;\n  }\n\n  /**\n   * Update a doctor schedule\n   */\n  async updateSchedule(id: string, data: UpdateScheduleData): Promise<DoctorSchedule> {\n    const response = await api.put(`/schedules/${id}`, data);\n    return response.data.data;\n  }\n\n  /**\n   * Delete a doctor schedule\n   */\n  async deleteSchedule(id: string): Promise<void> {\n    await api.delete(`/schedules/${id}`);\n  }\n\n  /**\n   * Helper: Get day name from day number\n   */\n  getDayName(dayOfWeek: number): string {\n    const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n    return days[dayOfWeek] || 'Unknown';\n  }\n\n  /**\n   * Helper: Get day number from date\n   */\n  getDayOfWeekFromDate(date: Date | string): number {\n    const dateObj = typeof date === 'string' ? new Date(date) : date;\n    return dateObj.getDay();\n  }\n\n  /**\n   * Helper: Format time slots for display\n   */\n  formatTimeSlot(time: string): string {\n    // Convert 24-hour format to 12-hour format with AM/PM\n    const [hours, minutes] = time.split(':').map(Number);\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const displayHours = hours % 12 || 12;\n    return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n  }\n\n  /**\n   * Helper: Generate time slots between start and end time\n   */\n  generateTimeSlots(startTime: string, endTime: string, slotDuration: number): string[] {\n    const slots: string[] = [];\n    const [startHour, startMinute] = startTime.split(':').map(Number);\n    const [endHour, endMinute] = endTime.split(':').map(Number);\n\n    const startInMinutes = startHour * 60 + startMinute;\n    const endInMinutes = endHour * 60 + endMinute;\n\n    for (let time = startInMinutes; time + slotDuration <= endInMinutes; time += slotDuration) {\n      const hour = Math.floor(time / 60);\n      const minute = time % 60;\n      const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n      slots.push(timeString);\n    }\n\n    return slots;\n  }\n}\n\nexport const doctorScheduleService = new DoctorScheduleService();\nexport default doctorScheduleService;\n\n/**\n * Helper function to get available doctors for a specific day\n * Returns the schedules as DoctorSchedule[] for compatibility\n */\nexport const getAvailableDoctorsForDay = async (\n  clinicId: string,\n  date: Date\n): Promise<{ success: boolean; data: DoctorSchedule[]; message: string }> => {\n  try {\n    const dayOfWeek = date.getDay();\n    const response = await api.get(`/api/v1/schedules/available`, {\n      params: { clinicId, dayOfWeek }\n    });\n    \n    // The backend returns a data array with the schedule information\n    return {\n      success: true,\n      data: response.data.data || [],\n      message: 'Available doctors retrieved successfully'\n    };\n  } catch (error: any) {\n    console.error('Error getting available doctors:', error);\n    return {\n      success: false,\n      data: [],\n      message: error.response?.data?.message || 'Failed to get available doctors'\n    };\n  }\n};\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\inventoryService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6686,6689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6686,6689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\n\nexport interface InventoryItem {\n  id: string;\n  name: string;\n  description?: string;\n  category: 'supplies' | 'materials' | 'equipment' | 'medications' | 'instruments' | 'other';\n  subcategory?: string;\n  sku: string;\n  barcode?: string;\n  clinic: {\n    id: string;\n    name: string;\n  };\n  currentStock: number;\n  minimumStock: number;\n  maximumStock?: number;\n  unit: string;\n  costPrice: number;\n  sellingPrice?: number;\n  supplier?: {\n    id: string;\n    name: string;\n    contactPerson?: string;\n  };\n  supplierItemCode?: string;\n  location?: string;\n  expiryDate?: string;\n  batchNumber?: string;\n  isActive: boolean;\n  isLowStock: boolean;\n  lastRestocked?: string;\n  lastUsed?: string;\n  stockStatus: 'out_of_stock' | 'low_stock' | 'in_stock' | 'overstock';\n  daysUntilExpiry?: number;\n  createdBy: {\n    id: string;\n    firstName: string;\n    lastName: string;\n  };\n  updatedBy?: {\n    id: string;\n    firstName: string;\n    lastName: string;\n  };\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface StockMovement {\n  id: string;\n  inventoryItem: {\n    id: string;\n    name: string;\n    sku: string;\n    category: string;\n  };\n  clinic: {\n    id: string;\n    name: string;\n  };\n  type: 'in' | 'out' | 'adjustment';\n  quantity: number;\n  previousStock: number;\n  newStock: number;\n  reason: 'purchase' | 'usage' | 'adjustment' | 'expired' | 'damaged' | 'transfer' | 'return' | 'other';\n  description?: string;\n  reference?: string;\n  unitCost?: number;\n  totalCost?: number;\n  relatedDocument?: {\n    type: 'purchase_order' | 'treatment' | 'prescription' | 'adjustment';\n    id: string;\n  };\n  batchNumber?: string;\n  expiryDate?: string;\n  performedBy: {\n    id: string;\n    firstName: string;\n    lastName: string;\n  };\n  performedAt: string;\n  notes?: string;\n  direction: 'incoming' | 'outgoing' | 'adjustment';\n  stockChange: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface InventoryDashboard {\n  stockSummary: Array<{\n    _id: string;\n    totalItems: number;\n    totalValue: number;\n    lowStockItems: number;\n    outOfStockItems: number;\n  }>;\n  lowStockItems: {\n    items: InventoryItem[];\n    count: number;\n  };\n  expiringItems: {\n    items: InventoryItem[];\n    count: number;\n  };\n  recentMovements: StockMovement[];\n  totalValue: number;\n  totalItems: number;\n}\n\nexport interface CreateInventoryItemData {\n  name: string;\n  description?: string;\n  category: string;\n  subcategory?: string;\n  sku: string;\n  barcode?: string;\n  clinic: string;\n  currentStock: number;\n  minimumStock: number;\n  maximumStock?: number;\n  unit: string;\n  costPrice: number;\n  sellingPrice?: number;\n  supplier?: string;\n  supplierItemCode?: string;\n  location?: string;\n  expiryDate?: string;\n  batchNumber?: string;\n}\n\nexport interface UpdateStockData {\n  type: 'in' | 'out' | 'adjustment';\n  quantity: number;\n  reason: 'purchase' | 'usage' | 'adjustment' | 'expired' | 'damaged' | 'transfer' | 'return' | 'other';\n  description?: string;\n  reference?: string;\n  unitCost?: number;\n  batchNumber?: string;\n  expiryDate?: string;\n  notes?: string;\n}\n\nexport interface ApiResponse<T> {\n  success: boolean;\n  message: string;\n  data: T;\n  pagination?: {\n    page: number;\n    limit: number;\n    totalPages: number;\n    totalItems: number;\n  };\n}\n\nclass InventoryService {\n  private baseURL = '/api/v1/inventory';\n\n  // Get all inventory items with filtering and pagination\n  async getInventoryItems(params: {\n    page?: number;\n    limit?: number;\n    category?: string;\n    isLowStock?: boolean;\n    isActive?: boolean;\n    search?: string;\n    clinic?: string;\n    sortBy?: string;\n    sortOrder?: 'asc' | 'desc';\n  } = {}): Promise<ApiResponse<{ items: InventoryItem[] }>> {\n    const response = await api.get(this.baseURL, { params });\n    return response.data;\n  }\n\n  // Get single inventory item with recent movements\n  async getInventoryItem(id: string): Promise<ApiResponse<{ \n    item: InventoryItem; \n    recentMovements: StockMovement[] \n  }>> {\n    const response = await api.get(`${this.baseURL}/${id}`);\n    return response.data;\n  }\n\n  // Create new inventory item\n  async createInventoryItem(data: CreateInventoryItemData): Promise<ApiResponse<{ item: InventoryItem }>> {\n    const response = await api.post(this.baseURL, data);\n    return response.data;\n  }\n\n  // Update inventory item\n  async updateInventoryItem(id: string, data: Partial<CreateInventoryItemData>): Promise<ApiResponse<{ item: InventoryItem }>> {\n    const response = await api.put(`${this.baseURL}/${id}`, data);\n    return response.data;\n  }\n\n  // Delete inventory item\n  async deleteInventoryItem(id: string): Promise<ApiResponse<void>> {\n    const response = await api.delete(`${this.baseURL}/${id}`);\n    return response.data;\n  }\n\n  // Update stock (add, remove, or adjust)\n  async updateStock(id: string, data: UpdateStockData): Promise<ApiResponse<{ \n    item: InventoryItem; \n    movement: {\n      type: string;\n      quantity: number;\n      previousStock: number;\n      newStock: number;\n    }\n  }>> {\n    const response = await api.post(`${this.baseURL}/${id}/stock`, data);\n    return response.data;\n  }\n\n  // Get stock movements with filtering and pagination\n  async getStockMovements(params: {\n    page?: number;\n    limit?: number;\n    itemId?: string;\n    clinic?: string;\n    type?: 'in' | 'out' | 'adjustment';\n    reason?: string;\n    startDate?: string;\n    endDate?: string;\n    performedBy?: string;\n  } = {}): Promise<ApiResponse<{ movements: StockMovement[] }>> {\n    const response = await api.get(`${this.baseURL}/movements`, { params });\n    return response.data;\n  }\n\n  // Get low stock items\n  async getLowStockItems(clinic?: string): Promise<ApiResponse<{ items: InventoryItem[] }>> {\n    const response = await api.get(`${this.baseURL}/low-stock`, {\n      params: clinic ? { clinic } : {}\n    });\n    return response.data;\n  }\n\n  // Get expiring items\n  async getExpiringItems(days: number = 30, clinic?: string): Promise<ApiResponse<{ items: InventoryItem[] }>> {\n    const response = await api.get(`${this.baseURL}/expiring`, {\n      params: { days, ...(clinic && { clinic }) }\n    });\n    return response.data;\n  }\n\n  // Get inventory dashboard data\n  async getInventoryDashboard(clinic?: string): Promise<ApiResponse<InventoryDashboard>> {\n    const response = await api.get(`${this.baseURL}/dashboard`, {\n      params: clinic ? { clinic } : {}\n    });\n    return response.data;\n  }\n\n  // Generate inventory report\n  async generateInventoryReport(params: {\n    startDate?: string;\n    endDate?: string;\n    clinic?: string;\n    category?: string;\n    format?: 'json' | 'csv';\n  } = {}): Promise<ApiResponse<any>> {\n    const response = await api.get(`${this.baseURL}/report`, { params });\n    return response.data;\n  }\n\n  // Get inventory categories for filters\n  getCategories(): Array<{ value: string; label: string }> {\n    return [\n      { value: 'supplies', label: 'Supplies' },\n      { value: 'materials', label: 'Materials' },\n      { value: 'equipment', label: 'Equipment' },\n      { value: 'medications', label: 'Medications' },\n      { value: 'instruments', label: 'Instruments' },\n      { value: 'other', label: 'Other' }\n    ];\n  }\n\n  // Get stock movement reasons for filters\n  getMovementReasons(): Array<{ value: string; label: string }> {\n    return [\n      { value: 'purchase', label: 'Purchase' },\n      { value: 'usage', label: 'Usage' },\n      { value: 'adjustment', label: 'Adjustment' },\n      { value: 'expired', label: 'Expired' },\n      { value: 'damaged', label: 'Damaged' },\n      { value: 'transfer', label: 'Transfer' },\n      { value: 'return', label: 'Return' },\n      { value: 'other', label: 'Other' }\n    ];\n  }\n\n  // Get stock status color class\n  getStockStatusColor(status: string): string {\n    switch (status) {\n      case 'out_of_stock':\n        return 'bg-red-100 text-red-800';\n      case 'low_stock':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'in_stock':\n        return 'bg-green-100 text-green-800';\n      case 'overstock':\n        return 'bg-blue-100 text-blue-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  }\n\n  // Get movement type color class\n  getMovementTypeColor(type: string): string {\n    switch (type) {\n      case 'in':\n        return 'bg-green-100 text-green-800';\n      case 'out':\n        return 'bg-red-100 text-red-800';\n      case 'adjustment':\n        return 'bg-blue-100 text-blue-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  }\n}\n\nexport const inventoryService = new InventoryService();\nexport default inventoryService;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\medicationService.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"An interface declaring no members is equivalent to its supertype.","line":29,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":29,"endColumn":38,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[711,782],"text":"type UpdateMedicationData = Partial<CreateMedicationData>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\n\nexport interface Medication {\n  _id: string;\n  name: string;\n  dosage: string;\n  frequency: string;\n  duration?: string;\n  category: 'antibiotic' | 'painkiller' | 'anti-inflammatory' | 'anesthetic' | 'antiseptic' | 'other';\n  instructions?: string;\n  sideEffects?: string[];\n  contraindications?: string[];\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CreateMedicationData {\n  name: string;\n  dosage: string;\n  frequency: string;\n  duration?: string;\n  category: 'antibiotic' | 'painkiller' | 'anti-inflammatory' | 'anesthetic' | 'antiseptic' | 'other';\n  instructions?: string;\n  sideEffects?: string[];\n  contraindications?: string[];\n}\n\nexport interface UpdateMedicationData extends Partial<CreateMedicationData> {}\n\nexport interface MedicationFilters {\n  page?: number;\n  limit?: number;\n  search?: string;\n  category?: string;\n  isActive?: boolean;\n  patientId?: string;\n}\n\nexport interface MedicationResponse {\n  medications: Medication[];\n  totalRecords: number;\n  totalPages: number;\n  currentPage: number;\n}\n\nclass MedicationService {\n  private baseURL = 'api/v1/medications';\n\n  // Get all medications with filters\n  async getMedications(filters: MedicationFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}?${params.toString()}`);\n    return response;\n  }\n\n  // Get medication by ID\n  async getMedication(id: string) {\n    const response = await api.get(`${this.baseURL}/${id}`);\n    return response;\n  }\n\n  // Create new medication\n  async createMedication(data: CreateMedicationData) {\n    const response = await api.post(this.baseURL, data);\n    return response;\n  }\n\n  // Update medication\n  async updateMedication(id: string, data: UpdateMedicationData) {\n    const response = await api.put(`${this.baseURL}/${id}`, data);\n    return response;\n  }\n\n  // Delete medication (soft delete)\n  async deleteMedication(id: string) {\n    const response = await api.delete(`${this.baseURL}/${id}`);\n    return response;\n  }\n\n  // Search medications\n  async searchMedications(query: string, filters: MedicationFilters = {}) {\n    const params = new URLSearchParams();\n    params.append('q', query);\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/search?${params.toString()}`);\n    return response;\n  }\n\n  // Get medications by category\n  async getMedicationsByCategory(category: string, filters: MedicationFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/category/${category}?${params.toString()}`);\n    return response;\n  }\n\n  // Get medication categories\n  async getMedicationCategories() {\n    const response = await api.get(`${this.baseURL}/categories`);\n    return response;\n  }\n\n  // Bulk operations\n  async bulkUpdateStatus(medicationIds: string[], isActive: boolean) {\n    const response = await api.put(`${this.baseURL}/bulk/status`, {\n      medicationIds,\n      isActive\n    });\n    return response;\n  }\n\n  async bulkDelete(medicationIds: string[]) {\n    const response = await api.delete(`${this.baseURL}/bulk`, {\n      data: { medicationIds }\n    });\n    return response;\n  }\n\n  // Export medications\n  async exportMedications(filters: MedicationFilters = {}, format: 'csv' | 'pdf' = 'csv') {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n    \n    params.append('format', format);\n\n    const response = await api.get(`${this.baseURL}/export?${params.toString()}`, {\n      responseType: 'blob'\n    });\n    return response;\n  }\n\n  // Get medication statistics\n  async getMedicationStats() {\n    const response = await api.get(`${this.baseURL}/stats`);\n    return response;\n  }\n\n  // Get popular medications\n  async getPopularMedications(limit: number = 10) {\n    const response = await api.get(`${this.baseURL}/popular?limit=${limit}`);\n    return response;\n  }\n\n  // Check medication interactions\n  async checkInteractions(medicationIds: string[]) {\n    const response = await api.post(`${this.baseURL}/interactions`, {\n      medicationIds\n    });\n    return response;\n  }\n\n  // Get medication suggestions based on symptoms or conditions\n  async getMedicationSuggestions(query: string) {\n    const response = await api.get(`${this.baseURL}/suggestions?q=${encodeURIComponent(query)}`);\n    return response;\n  }\n\n  // Validate medication data\n  async validateMedication(data: CreateMedicationData | UpdateMedicationData) {\n    const response = await api.post(`${this.baseURL}/validate`, data);\n    return response;\n  }\n\n  // Get medication usage analytics\n  async getMedicationAnalytics(filters: {\n    startDate?: string;\n    endDate?: string;\n    category?: string;\n    groupBy?: 'day' | 'week' | 'month';\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/analytics?${params.toString()}`);\n    return response;\n  }\n\n  // Get patient medications (prescribed medications for a specific patient)\n  async getPatientMedications(patientId: string, filters: MedicationFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/patient/${patientId}?${params.toString()}`);\n    return response;\n  }\n}\n\nexport const medicationService = new MedicationService();","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\notificationService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1025,1028],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1025,1028],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\r\n\r\nexport interface Notification {\r\n  _id: string;\r\n  userId: string;\r\n  title: string;\r\n  message: string;\r\n  type: 'general' | 'appointment_reminder' | 'appointment_confirmation' | 'appointment_cancellation' | 'system';\r\n  link?: string;\r\n  isRead: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface NotificationStatistics {\r\n  totalNotifications: number;\r\n  unreadCount: number;\r\n  readCount: number;\r\n  typeDistribution: Record<string, { total: number; unread: number }>;\r\n}\r\n\r\nexport interface PaginatedNotifications {\r\n  notifications: Notification[];\r\n  pagination: {\r\n    currentPage: number;\r\n    totalPages: number;\r\n    totalItems: number;\r\n    itemsPerPage: number;\r\n    hasNextPage: boolean;\r\n    hasPrevPage: boolean;\r\n  };\r\n}\r\n\r\nclass NotificationService {\r\n  // Check if notification API is available\r\n  async isApiAvailable(): Promise<boolean> {\r\n    try {\r\n      await api.get('/api/v1/notifications/unread/count');\r\n      return true;\r\n    } catch (error: any) {\r\n      if (error.response?.status === 404) {\r\n        return false;\r\n      }\r\n      // Other errors might be temporary, so we assume API is available\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // Get user notifications with pagination\r\n  async getUserNotifications(params?: {\r\n    page?: number;\r\n    limit?: number;\r\n    isRead?: boolean;\r\n    type?: string;\r\n  }) {\r\n    const response = await api.get('/api/v1/notifications', { params });\r\n    return response.data;\r\n  }\r\n\r\n  // Get unread notifications count\r\n  async getUnreadCount(): Promise<{ success: boolean; data: { count: number } }> {\r\n    const response = await api.get('/api/v1/notifications/unread/count');\r\n    return response.data;\r\n  }\r\n\r\n  // Get unread notifications\r\n  async getUnreadNotifications(limit = 10): Promise<{ success: boolean; data: { notifications: Notification[] } }> {\r\n    const response = await api.get('/api/v1/notifications/unread', { params: { limit } });\r\n    return response.data;\r\n  }\r\n\r\n  // Get recent notifications\r\n  async getRecentNotifications(limit = 5): Promise<{ success: boolean; data: { notifications: Notification[] } }> {\r\n    const response = await api.get('/api/v1/notifications/recent', { params: { limit } });\r\n    return response.data;\r\n  }\r\n\r\n  // Get notification statistics\r\n  async getStatistics(): Promise<{ success: boolean; data: NotificationStatistics }> {\r\n    const response = await api.get('/api/v1/notifications/statistics');\r\n    return response.data;\r\n  }\r\n\r\n  // Get notifications by type\r\n  async getNotificationsByType(type: string, params?: { page?: number; limit?: number }) {\r\n    const response = await api.get(`/api/v1/notifications/type/${type}`, { params });\r\n    return response.data;\r\n  }\r\n\r\n  // Get notification by ID\r\n  async getNotificationById(id: string): Promise<{ success: boolean; data: { notification: Notification } }> {\r\n    const response = await api.get(`/api/v1/notifications/${id}`);\r\n    return response.data;\r\n  }\r\n\r\n  // Mark notification as read\r\n  async markAsRead(id: string): Promise<{ success: boolean; message: string; data: { notification: Notification } }> {\r\n    const response = await api.patch(`/api/v1/notifications/${id}/read`);\r\n    return response.data;\r\n  }\r\n\r\n  // Mark notification as unread\r\n  async markAsUnread(id: string): Promise<{ success: boolean; message: string; data: { notification: Notification } }> {\r\n    const response = await api.patch(`/api/v1/notifications/${id}/unread`);\r\n    return response.data;\r\n  }\r\n\r\n  // Mark all notifications as read\r\n  async markAllAsRead(): Promise<{ success: boolean; message: string }> {\r\n    const response = await api.put('/api/v1/notifications/mark-all-read');\r\n    return response.data;\r\n  }\r\n\r\n  // Delete notification\r\n  async deleteNotification(id: string): Promise<{ success: boolean; message: string }> {\r\n    const response = await api.delete(`/api/v1/notifications/${id}`);\r\n    return response.data;\r\n  }\r\n\r\n  // Delete all notifications\r\n  async deleteAllNotifications(): Promise<{ success: boolean; message: string }> {\r\n    const response = await api.delete('/api/v1/notifications/delete-all');\r\n    return response.data;\r\n  }\r\n\r\n  // Update notification\r\n  async updateNotification(id: string, data: { title?: string; message?: string; link?: string }): Promise<{ success: boolean; message: string; data: { notification: Notification } }> {\r\n    const response = await api.put(`/api/v1/notifications/${id}`, data);\r\n    return response.data;\r\n  }\r\n\r\n  // Admin functions\r\n  async createNotification(data: {\r\n    userId: string;\r\n    title: string;\r\n    message: string;\r\n    type?: string;\r\n    link?: string;\r\n  }): Promise<{ success: boolean; message: string; data: { notification: Notification } }> {\r\n    const response = await api.post('/api/v1/notifications', data);\r\n    return response.data;\r\n  }\r\n\r\n  async createBulkNotifications(data: {\r\n    userIds: string[];\r\n    title: string;\r\n    message: string;\r\n    type?: string;\r\n    link?: string;\r\n  }): Promise<{ success: boolean; message: string; data: { count: number } }> {\r\n    const response = await api.post('/api/v1/notifications/bulk', data);\r\n    return response.data;\r\n  }\r\n\r\n  async cleanupOldNotifications(days = 30): Promise<{ success: boolean; message: string }> {\r\n    const response = await api.delete('/api/v1/notifications/cleanup', { params: { days } });\r\n    return response.data;\r\n  }\r\n}\r\n\r\nexport const notificationService = new NotificationService();","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\patientService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[266,269],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[266,269],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1672,1675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1672,1675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1927,1930],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1927,1930],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2228,2231],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2228,2231],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2332,2335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2332,2335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2685,2688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2685,2688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2796,2799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2796,2799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3174,3177],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3174,3177],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":93,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3318,3321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3318,3321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3664,3667],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3664,3667],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":118,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4324,4327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4324,4327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4925,4928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4925,4928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":146,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":146,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5491,5494],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5491,5494],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5835,5838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5835,5838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":171,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6366,6369],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6366,6369],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6936,6939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6936,6939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport type { Patient, PatientReport, ApiResponse, PaginatedResponse } from '../types';\nimport { createSafeApiParams } from '../utils/clinicUtils';\n\n// Helper function to transform backend patient data\nconst transformPatientData = (patient: any): Patient => {\n\n  \n  return {\n    id: patient.id || patient._id, // Use patient.id if available, fallback to _id\n    firstName: patient.firstName,\n    lastName: patient.lastName,\n    email: patient.email,\n    phone: patient.phone,\n    dateOfBirth: new Date(patient.dateOfBirth),\n    gender: patient.gender || 'male',\n    address: patient.address,\n    medicalHistory: patient.medicalHistory || {\n      allergies: [],\n      medications: [],\n      conditions: [],\n      notes: ''\n    },\n    treatmentRecords: patient.treatmentRecords || [],\n    preferredClinicId: patient.preferredClinicId || patient.preferredClinic,\n    emergencyContact: patient.emergencyContact,\n    isActive: patient.isActive !== undefined ? patient.isActive : true,\n    userId: patient.userId, // Link to user account\n    createdAt: new Date(patient.createdAt),\n    updatedAt: new Date(patient.updatedAt)\n  };\n};\n\n// Get all patients (role-based filtering applied on backend)\nexport const getPatients = async (params?: {\n  search?: string;\n  clinicId?: string;\n  page?: number;\n  limit?: number;\n  patientId?: string; // For patient role - only their own data\n}): Promise<PaginatedResponse<Patient>> => {\n  try {\n    // Ensure clinic ID is properly formatted\n    const safeParams = params ? {\n      ...params,\n      ...createSafeApiParams(params.clinicId)\n    } : undefined;\n    \n    const response = await api.get<PaginatedResponse<any>>('/api/v1/patients', { params: safeParams });\n    \n\n    \n    return {\n      ...response.data,\n      data: response.data.data.map(transformPatientData),\n      totalPages: Math.ceil(response.data.total / (params?.limit || 10))\n    };\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to fetch patients';\n    throw new Error(errorMessage);\n  }\n};\n\n// Get patient by ID\nexport const getPatientById = async (id: string): Promise<Patient> => {\n  try {\n    const response = await api.get<ApiResponse<any>>(`/api/v1/patients/${id}`);\n    return transformPatientData(response.data.data);\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to fetch patient';\n    throw new Error(errorMessage);\n  }\n};\n\n// Create a new patient\nexport const createPatient = async (patientData: Omit<Patient, 'id' | 'createdAt' | 'updatedAt'>): Promise<Patient> => {\n  try {\n    const response = await api.post<ApiResponse<any>>('/api/v1/patients', patientData);\n    return transformPatientData(response.data.data);\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to create patient';\n    throw new Error(errorMessage);\n  }\n};\n\n// Update an existing patient\nexport const updatePatient = async (id: string, patientData: Partial<Patient>): Promise<Patient> => {\n  try {\n    console.log(\"DONE\", patientData);\n    const response = await api.put<ApiResponse<any>>(`/api/v1/patients/${id}`, patientData);\n    console.log(response);\n    return transformPatientData(response.data.data);\n  } catch (error: any) {\n    console.log('Here we go');\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to update patient';\n    throw new Error(errorMessage);\n  }\n};\n\n// Delete a patient\nexport const deletePatient = async (id: string): Promise<void> => {\n  try {\n    await api.delete(`/api/v1/patients/${id}`);\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to delete patient';\n    throw new Error(errorMessage);\n  }\n};\n\n// Get patient reports (role-based access control)\nexport const getPatientReports = async (patientId?: string): Promise<PatientReport[]> => {\n  try {\n    // If no patientId provided, backend will return reports based on user role\n    console.log('patientId', patientId);\n    const endpoint = patientId ? `/api/v1/patients/${patientId}/reports` : '/api/v1/reports/my-reports';\n    const response = await api.get<ApiResponse<PatientReport[]>>(endpoint);\n    return response.data.data || [];\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to fetch patient reports';\n    throw new Error(errorMessage);\n  }\n};\n\n// Create patient report\nexport const createPatientReport = async (reportData: Omit<PatientReport, 'id' | 'createdAt' | 'updatedAt'>): Promise<PatientReport> => {\n  try {\n    const response = await api.post<ApiResponse<PatientReport>>(`/api/v1/patients/${reportData.patientId}/reports`, reportData);\n    if (!response.data.data) {\n      throw new Error('No data returned from server');\n    }\n    return response.data.data;\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to create patient report';\n    throw new Error(errorMessage);\n  }\n};\n\n// Update patient report\nexport const updatePatientReport = async (reportId: string, reportData: Partial<PatientReport>): Promise<PatientReport> => {\n  try {\n    const response = await api.put<ApiResponse<PatientReport>>(`/api/v1/reports/${reportId}`, reportData);\n    if (!response.data.data) {\n      throw new Error('No data returned from server');\n    }\n    return response.data.data;\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to update patient report';\n    throw new Error(errorMessage);\n  }\n};\n\n// Delete patient report\nexport const deletePatientReport = async (reportId: string): Promise<void> => {\n  try {\n    await api.delete(`/api/v1/reports/${reportId}`);\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to delete patient report';\n    throw new Error(errorMessage);\n  }\n};\n\n// Get patients by user ID (for linking user accounts to patient records)\nexport const getPatientsByUserId = async (userId: string, params?: {\n  page?: number;\n  limit?: number;\n}): Promise<PaginatedResponse<Patient>> => {\n  try {\n    // Using a more reliable endpoint or adding fallback logic\n    let response;\n    try {\n      response = await api.get<PaginatedResponse<any>>(`/api/v1/patients/user/${userId}`, { params });\n    } catch (innerError) {\n      // Fallback to alternative endpoint if the first one fails\n      console.warn(`Error getting patient ID: ${innerError}`);\n      // Return empty response instead of throwing error\n      return {\n        success: true,\n        data: [],\n        total: 0,\n        page: params?.page || 1,\n        limit: params?.limit || 10,\n        totalPages: 0\n      };\n    }\n    \n    return {\n      ...response.data,\n      data: response.data.data.map(transformPatientData)\n    };\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to fetch patients for user';\n    throw new Error(errorMessage);\n  }\n};\n\n// Create service instance\nconst patientService = {\n  getPatients,\n  getPatientById,\n  createPatient,\n  updatePatient,\n  deletePatient,\n  getPatientReports,\n  createPatientReport,\n  updatePatientReport,\n  deletePatientReport,\n  getPatientsByUserId\n};\n\nexport { patientService };\nexport default patientService;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\prescriptionService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3000,3003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3000,3003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4568,4571],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4568,4571],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":395,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":395,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10652,10655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10652,10655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\n\nexport interface Prescription {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone?: string;\n  };\n  dentist: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  clinic: {\n    _id: string;\n    name: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n    type: string;\n  };\n  medications: Array<{\n    medication: {\n      _id: string;\n      name: string;\n      category: string;\n    };\n    dosage: string;\n    frequency: string;\n    duration: string;\n    instructions?: string;\n  }>;\n  diagnosis?: string;\n  notes?: string;\n  status: 'active' | 'completed' | 'cancelled' | 'expired';\n  prescribedDate: string;\n  expiryDate: string;\n  maxRefills: number;\n  currentRefills: number;\n  refillHistory: Array<{\n    date: string;\n    dispensedBy?: string;\n    notes?: string;\n  }>;\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CreatePrescriptionData {\n  patientId: string;\n  clinicId: string;\n  appointmentId?: string;\n  medications: Array<{\n    medicationId: string;\n    dosage: string;\n    frequency: string;\n    duration: string;\n    instructions?: string;\n    startDate: string;\n    endDate?: string;\n  }>;\n  diagnosis: string;\n  notes?: string;\n  expiryDate: string;\n  refillsAllowed: number;\n}\n\nexport interface UpdatePrescriptionData extends Partial<CreatePrescriptionData> {\n  status?: 'active' | 'completed' | 'cancelled' | 'expired';\n}\n\nexport interface RefillData {\n  dispensedBy?: string;\n  notes?: string;\n  refillDate?: string;\n}\n\nexport interface PrescriptionFilters {\n  page?: number;\n  limit?: number;\n  search?: string;\n  status?: string;\n  patient?: string;\n  dentist?: string;\n  clinic?: string;\n  medication?: string;\n  startDate?: string;\n  endDate?: string;\n  isActive?: boolean;\n  isExpiring?: boolean;\n  daysToExpiry?: number;\n}\n\nexport interface PrescriptionResponse {\n  prescriptions: Prescription[];\n  totalRecords: number;\n  totalPages: number;\n  currentPage: number;\n}\n\nexport interface PrescriptionStats {\n  totalPrescriptions: number;\n  activePrescriptions: number;\n  expiredPrescriptions: number;\n  expiringPrescriptions: number;\n  completedPrescriptions: number;\n  cancelledPrescriptions: number;\n  averageRefills: number;\n  topMedications: Array<{\n    medication: string;\n    count: number;\n  }>;\n  monthlyTrends: Array<{\n    month: string;\n    count: number;\n  }>;\n}\n\nclass PrescriptionService {\n  private baseURL = '/api/v1/prescriptions';\n\n  // Get all prescriptions with filters\n  async getPrescriptions(filters: PrescriptionFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    try {\n      const response = await api.get(`${this.baseURL}?${params.toString()}`);\n      return response;\n    } catch (error: any) {\n      if (error.response && error.response.status === 403) {\n        return {\n          data: {\n            prescriptions: [],\n            totalRecords: 0,\n            totalPages: 0,\n            currentPage: 1\n          },\n          message: 'Access to prescriptions is restricted. Please contact an administrator for assistance.'\n        };\n      }\n      throw error;\n    }\n  }\n\n  // Get prescription by ID\n  async getPrescription(id: string) {\n    const response = await api.get(`${this.baseURL}/${id}`);\n    return response;\n  }\n\n  // Create new prescription\n  async createPrescription(data: CreatePrescriptionData) {\n    const response = await api.post(this.baseURL, data);\n    return response;\n  }\n\n  // Update prescription\n  async updatePrescription(id: string, data: UpdatePrescriptionData) {\n    const response = await api.put(`${this.baseURL}/${id}`, data);\n    return response;\n  }\n\n  // Delete prescription (soft delete)\n  async deletePrescription(id: string) {\n    const response = await api.delete(`${this.baseURL}/${id}`);\n    return response;\n  }\n\n  // Get current user's prescriptions (for patients)\n  async getMyPrescriptions(filters: PrescriptionFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    try {\n      const response = await api.get(`${this.baseURL}/my-prescriptions?${params.toString()}`);\n      return response;\n    } catch (error: any) {\n      if (error.response && error.response.status === 403) {\n        return {\n          data: {\n            prescriptions: [],\n            totalRecords: 0,\n            totalPages: 0,\n            currentPage: 1\n          },\n          message: 'Access to prescriptions is restricted. Please contact an administrator for assistance.'\n        };\n      }\n      throw error;\n    }\n  }\n\n  // Get prescriptions by patient\n  async getPrescriptionsByPatient(patientId: string, filters: PrescriptionFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/patient/${patientId}?${params.toString()}`);\n    return response;\n  }\n\n  // Get active prescriptions\n  async getActivePrescriptions(filters: PrescriptionFilters = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/active?${params.toString()}`);\n    return response;\n  }\n\n  // Get expiring prescriptions\n  async getExpiringPrescriptions(daysToExpiry: number = 30, filters: PrescriptionFilters = {}) {\n    const params = new URLSearchParams();\n    params.append('daysToExpiry', daysToExpiry.toString());\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/expiring?${params.toString()}`);\n    return response;\n  }\n\n  // Add refill to prescription\n  async addRefill(prescriptionId: string, refillData: RefillData = {}) {\n    const response = await api.post(`${this.baseURL}/${prescriptionId}/refill`, refillData);\n    return response;\n  }\n\n  // Get refill history\n  async getRefillHistory(prescriptionId: string) {\n    const response = await api.get(`${this.baseURL}/${prescriptionId}/refills`);\n    return response;\n  }\n\n  // Update refill\n  async updateRefill(prescriptionId: string, refillId: string, refillData: Partial<RefillData>) {\n    const response = await api.put(`${this.baseURL}/${prescriptionId}/refill/${refillId}`, refillData);\n    return response;\n  }\n\n  // Delete refill\n  async deleteRefill(prescriptionId: string, refillId: string) {\n    const response = await api.delete(`${this.baseURL}/${prescriptionId}/refill/${refillId}`);\n    return response;\n  }\n\n  // Search prescriptions\n  async searchPrescriptions(query: string, filters: PrescriptionFilters = {}) {\n    const params = new URLSearchParams();\n    params.append('q', query);\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/search?${params.toString()}`);\n    return response;\n  }\n\n  // Get prescription statistics\n  async getPrescriptionStats(filters: {\n    startDate?: string;\n    endDate?: string;\n    dentist?: string;\n    clinic?: string;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/stats?${params.toString()}`);\n    return response;\n  }\n\n  // Bulk operations\n  async bulkUpdateStatus(prescriptionIds: string[], status: string) {\n    const response = await api.put(`${this.baseURL}/bulk/status`, {\n      prescriptionIds,\n      status\n    });\n    return response;\n  }\n\n  async bulkDelete(prescriptionIds: string[]) {\n    const response = await api.delete(`${this.baseURL}/bulk`, {\n      data: { prescriptionIds }\n    });\n    return response;\n  }\n\n  // Export prescriptions\n  async exportPrescriptions(filters: PrescriptionFilters = {}, format: 'csv' | 'pdf' = 'csv') {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n    \n    params.append('format', format);\n\n    const response = await api.get(`${this.baseURL}/export?${params.toString()}`, {\n      responseType: 'blob'\n    });\n    return response;\n  }\n\n  // Generate prescription PDF\n  async generatePrescriptionPDF(prescriptionId: string) {\n    const response = await api.get(`${this.baseURL}/${prescriptionId}/pdf`, {\n      responseType: 'blob'\n    });\n    return response;\n  }\n\n  // Send prescription email\n  async sendPrescriptionEmail(prescriptionId: string, emailData: {\n    to?: string;\n    subject?: string;\n    message?: string;\n  } = {}) {\n    const response = await api.post(`${this.baseURL}/${prescriptionId}/send-email`, emailData);\n    return response;\n  }\n\n  // Check drug interactions\n  async checkDrugInteractions(medicationIds: string[]) {\n    const response = await api.post(`${this.baseURL}/check-interactions`, {\n      medicationIds\n    });\n    return response;\n  }\n\n  // Get prescription templates\n  async getPrescriptionTemplates() {\n    const response = await api.get(`${this.baseURL}/templates`);\n    return response;\n  }\n\n  // Create prescription template\n  async createPrescriptionTemplate(templateData: {\n    name: string;\n    description?: string;\n    medications: Array<{\n      medication: string;\n      dosage: string;\n      frequency: string;\n      duration: string;\n      instructions?: string;\n    }>;\n    diagnosis?: string;\n    notes?: string;\n  }) {\n    const response = await api.post(`${this.baseURL}/templates`, templateData);\n    return response;\n  }\n\n  // Update prescription template\n  async updatePrescriptionTemplate(templateId: string, templateData: any) {\n    const response = await api.put(`${this.baseURL}/templates/${templateId}`, templateData);\n    return response;\n  }\n\n  // Delete prescription template\n  async deletePrescriptionTemplate(templateId: string) {\n    const response = await api.delete(`${this.baseURL}/templates/${templateId}`);\n    return response;\n  }\n\n  // Get prescription analytics\n  async getPrescriptionAnalytics(filters: {\n    startDate?: string;\n    endDate?: string;\n    groupBy?: 'day' | 'week' | 'month' | 'year';\n    dentist?: string;\n    clinic?: string;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/analytics?${params.toString()}`);\n    return response;\n  }\n\n  // Get medication usage trends\n  async getMedicationTrends(filters: {\n    startDate?: string;\n    endDate?: string;\n    medication?: string;\n    category?: string;\n  } = {}) {\n    const params = new URLSearchParams();\n    \n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        params.append(key, value.toString());\n      }\n    });\n\n    const response = await api.get(`${this.baseURL}/medication-trends?${params.toString()}`);\n    return response;\n  }\n\n  // Validate prescription\n  async validatePrescription(prescriptionData: CreatePrescriptionData | UpdatePrescriptionData) {\n    const response = await api.post(`${this.baseURL}/validate`, prescriptionData);\n    return response;\n  }\n\n  // Get prescription recommendations\n  async getPrescriptionRecommendations(patientId: string, symptoms?: string[]) {\n    const response = await api.post(`${this.baseURL}/recommendations`, {\n      patientId,\n      symptoms\n    });\n    return response;\n  }\n}\n\nexport const prescriptionService = new PrescriptionService();","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\reportsService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\searchService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\servicesService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\supplierService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":194,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":194,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4704,4707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4704,4707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\n\nexport interface Supplier {\n  id: string;\n  name: string;\n  contactPerson?: string;\n  email?: string;\n  phone?: string;\n  address?: {\n    street?: string;\n    city?: string;\n    state?: string;\n    zipCode?: string;\n    country?: string;\n  };\n  taxId?: string;\n  website?: string;\n  notes?: string;\n  paymentTerms?: string;\n  creditLimit?: number;\n  isActive: boolean;\n  rating?: number;\n  totalOrders?: number;\n  totalSpent?: number;\n  fullAddress?: string;\n  createdBy: {\n    id: string;\n    firstName: string;\n    lastName: string;\n  };\n  updatedBy?: {\n    id: string;\n    firstName: string;\n    lastName: string;\n  };\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface SupplierPerformance {\n  name: string;\n  totalOrders: number;\n  totalSpent: number;\n  rating?: number;\n  averageOrderValue: number;\n}\n\nexport interface SupplierDashboard {\n  totalSuppliers: number;\n  topSuppliers: SupplierPerformance[];\n  inactiveSuppliers: {\n    suppliers: Array<{\n      id: string;\n      name: string;\n      contactPerson?: string;\n      email?: string;\n      totalOrders: number;\n    }>;\n    count: number;\n  };\n  ratings: {\n    average: number;\n    totalRated: number;\n  };\n  performance: SupplierPerformance[];\n}\n\nexport interface CreateSupplierData {\n  name: string;\n  contactPerson?: string;\n  email?: string;\n  phone?: string;\n  address?: {\n    street?: string;\n    city?: string;\n    state?: string;\n    zipCode?: string;\n    country?: string;\n  };\n  taxId?: string;\n  website?: string;\n  notes?: string;\n  paymentTerms?: string;\n  creditLimit?: number;\n  rating?: number;\n}\n\nexport interface ApiResponse<T> {\n  success: boolean;\n  message: string;\n  data: T;\n  pagination?: {\n    page: number;\n    limit: number;\n    totalPages: number;\n    totalItems: number;\n  };\n}\n\nclass SupplierService {\n  private baseURL = '/api/v1/suppliers';\n\n  // Get all suppliers with filtering and pagination\n  async getSuppliers(params: {\n    page?: number;\n    limit?: number;\n    isActive?: boolean;\n    search?: string;\n    sortBy?: string;\n    sortOrder?: 'asc' | 'desc';\n  } = {}): Promise<ApiResponse<{ suppliers: Supplier[] }>> {\n    const response = await api.get(this.baseURL, { params });\n    return response.data;\n  }\n\n  // Get single supplier with supplied items\n  async getSupplier(id: string): Promise<ApiResponse<{\n    supplier: Supplier;\n    suppliedItems: {\n      items: Array<{\n        id: string;\n        name: string;\n        sku: string;\n        category: string;\n        currentStock: number;\n        minimumStock: number;\n        costPrice: number;\n      }>;\n      count: number;\n      totalValue: number;\n    };\n  }>> {\n    const response = await api.get(`${this.baseURL}/${id}`);\n    return response.data;\n  }\n\n  // Create new supplier\n  async createSupplier(data: CreateSupplierData): Promise<ApiResponse<{ supplier: Supplier }>> {\n    const response = await api.post(this.baseURL, data);\n    return response.data;\n  }\n\n  // Update supplier\n  async updateSupplier(id: string, data: Partial<CreateSupplierData>): Promise<ApiResponse<{ supplier: Supplier }>> {\n    const response = await api.put(`${this.baseURL}/${id}`, data);\n    return response.data;\n  }\n\n  // Delete supplier\n  async deleteSupplier(id: string): Promise<ApiResponse<void>> {\n    const response = await api.delete(`${this.baseURL}/${id}`);\n    return response.data;\n  }\n\n  // Get active suppliers (for dropdowns)\n  async getActiveSuppliers(): Promise<ApiResponse<{ suppliers: Supplier[] }>> {\n    const response = await api.get(`${this.baseURL}/active`);\n    return response.data;\n  }\n\n  // Get supplier performance data\n  async getSupplierPerformance(supplierId?: string): Promise<ApiResponse<{\n    performance: SupplierPerformance[];\n    recentItems: Array<{\n      id: string;\n      name: string;\n      sku: string;\n      category: string;\n      lastRestocked?: string;\n      supplier: {\n        id: string;\n        name: string;\n      };\n    }>;\n  }>> {\n    const url = supplierId ? `${this.baseURL}/${supplierId}/performance` : `${this.baseURL}/performance`;\n    const response = await api.get(url);\n    return response.data;\n  }\n\n  // Update supplier rating\n  async updateSupplierRating(id: string, rating: number, notes?: string): Promise<ApiResponse<{ supplier: Supplier }>> {\n    const response = await api.put(`${this.baseURL}/${id}/rating`, { rating, notes });\n    return response.data;\n  }\n\n  // Get suppliers dashboard data\n  async getSuppliersDashboard(): Promise<ApiResponse<SupplierDashboard>> {\n    const response = await api.get(`${this.baseURL}/dashboard`);\n    return response.data;\n  }\n\n  // Import suppliers from CSV\n  async importSuppliers(file: File): Promise<ApiResponse<any>> {\n    const formData = new FormData();\n    formData.append('file', file);\n    \n    const response = await api.post(`${this.baseURL}/import`, formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    return response.data;\n  }\n\n  // Export suppliers to CSV\n  async exportSuppliers(): Promise<void> {\n    const response = await api.get(`${this.baseURL}/export`, {\n      responseType: 'blob'\n    });\n    \n    // Create download link\n    const url = window.URL.createObjectURL(new Blob([response.data]));\n    const link = document.createElement('a');\n    link.href = url;\n    link.setAttribute('download', `suppliers-${new Date().toISOString().split('T')[0]}.csv`);\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n    window.URL.revokeObjectURL(url);\n  }\n\n  // Get rating color class\n  getRatingColor(rating?: number): string {\n    if (!rating) return 'bg-gray-100 text-gray-800';\n    \n    if (rating >= 4.5) return 'bg-green-100 text-green-800';\n    if (rating >= 3.5) return 'bg-blue-100 text-blue-800';\n    if (rating >= 2.5) return 'bg-yellow-100 text-yellow-800';\n    return 'bg-red-100 text-red-800';\n  }\n\n  // Format rating display\n  formatRating(rating?: number): string {\n    if (!rating) return 'No rating';\n    return `${rating.toFixed(1)} `;\n  }\n\n  // Format currency\n  formatCurrency(amount: number): string {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    }).format(amount);\n  }\n\n  // Format address\n  formatAddress(address?: Supplier['address']): string {\n    if (!address) return '';\n    \n    const parts = [\n      address.street,\n      address.city,\n      address.state,\n      address.zipCode,\n      address.country\n    ].filter(Boolean);\n    \n    return parts.join(', ');\n  }\n\n  // Get supplier status color\n  getStatusColor(isActive: boolean): string {\n    return isActive \n      ? 'bg-green-100 text-green-800' \n      : 'bg-gray-100 text-gray-800';\n  }\n\n  // Validate email format\n  isValidEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n  }\n\n  // Validate website URL format\n  isValidWebsite(website: string): boolean {\n    try {\n      new URL(website);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n}\n\nexport const supplierService = new SupplierService();\nexport default supplierService;\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\treatmentService.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":1,"message":"An interface declaring no members is equivalent to its supertype.","line":61,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":61,"endColumn":37,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1182,1251],"text":"type UpdateTreatmentData = Partial<CreateTreatmentData>"},"desc":"Replace empty interface with a type alias."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1726,1729],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1726,1729],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3328,3331],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3328,3331],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":158,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4056,4059],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4056,4059],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport type { ApiResponse } from '../types';\n\nexport interface TreatmentRecord {\n  _id: string;\n  patient: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  dentist: {\n    _id: string;\n    firstName: string;\n    lastName: string;\n  };\n  clinic: {\n    _id: string;\n    name: string;\n  };\n  appointment?: {\n    _id: string;\n    date: string;\n    type: string;\n  };\n  treatment: string;\n  procedure: string;\n  diagnosis: string;\n  notes?: string;\n  status: 'planned' | 'in_progress' | 'completed' | 'cancelled';\n  startDate: string;\n  endDate?: string;\n  duration?: number; // in minutes\n  cost?: number;\n  attachments?: Array<{\n    id: string;\n    fileName: string;\n    fileType: string;\n    fileUrl: string;\n    uploadedAt: string;\n  }>;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CreateTreatmentData {\n  patient: string;\n  dentist: string;\n  clinic: string;\n  appointment?: string;\n  treatment: string;\n  procedure: string;\n  diagnosis: string;\n  notes?: string;\n  status: 'planned' | 'in_progress' | 'completed' | 'cancelled';\n  startDate: string;\n  endDate?: string;\n  duration?: number;\n  cost?: number;\n}\n\nexport interface UpdateTreatmentData extends Partial<CreateTreatmentData> {}\n\nexport interface TreatmentFilters {\n  page?: number;\n  limit?: number;\n  search?: string;\n  patient?: string;\n  dentist?: string;\n  clinic?: string;\n  status?: string;\n  startDate?: string;\n  endDate?: string;\n  treatment?: string;\n}\n\nexport interface TreatmentResponse {\n  treatmentRecords: TreatmentRecord[];\n  totalRecords: number;\n  totalPages: number;\n  currentPage: number;\n}\n\n// Helper function to transform treatment data\nconst transformTreatmentData = (treatment: any): TreatmentRecord => {\n  return {\n    _id: treatment._id,\n    patient: treatment.patient,\n    dentist: treatment.dentist,\n    clinic: treatment.clinic,\n    appointment: treatment.appointment,\n    treatment: treatment.treatment,\n    procedure: treatment.procedure,\n    diagnosis: treatment.diagnosis,\n    notes: treatment.notes,\n    status: treatment.status,\n    startDate: treatment.startDate,\n    endDate: treatment.endDate,\n    duration: treatment.duration,\n    cost: treatment.cost,\n    attachments: treatment.attachments,\n    createdAt: treatment.createdAt,\n    updatedAt: treatment.updatedAt\n  };\n};\n\nclass TreatmentService {\n  private baseURL = '/treatments';\n\n  // Get all treatment records with filters\n  async getTreatmentRecords(filters: TreatmentFilters = {}): Promise<ApiResponse<TreatmentResponse>> {\n    try {\n      const params = new URLSearchParams();\n      \n      Object.entries(filters).forEach(([key, value]) => {\n        if (value !== undefined && value !== null && value !== '') {\n          params.append(key, value.toString());\n        }\n      });\n\n      const response = await api.get(`${this.baseURL}?${params.toString()}`);\n      const treatmentRecords = response.data.data.treatmentRecords.map(transformTreatmentData);\n      \n      return {\n        success: true,\n        data: {\n          treatmentRecords,\n          totalRecords: response.data.data.totalRecords,\n          totalPages: response.data.data.totalPages,\n          currentPage: response.data.data.currentPage\n        },\n        message: 'Treatment records retrieved successfully'\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        data: {\n          treatmentRecords: [],\n          totalRecords: 0,\n          totalPages: 0,\n          currentPage: 0\n        },\n        message: error.response?.data?.message || error.message || 'Failed to fetch treatment records'\n      };\n    }\n  }\n\n  // Get treatment record by ID\n  async getTreatmentRecord(id: string): Promise<ApiResponse<TreatmentRecord>> {\n    try {\n      const response = await api.get(`${this.baseURL}/${id}`);\n      const treatmentRecord = transformTreatmentData(response.data.data);\n      \n      return {\n        success: true,\n        data: treatmentRecord,\n        message: 'Treatment record retrieved successfully'\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        data: {} as TreatmentRecord,\n        message: error.response?.data?.message || error.message || 'Failed to fetch treatment record'\n      };\n    }\n  }\n\n  // Create new treatment record\n  async createTreatmentRecord(data: CreateTreatmentData) {\n    try {\n      const response = await api.post(this.baseURL, data);\n      return response;\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to create treatment record';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Update treatment record\n  async updateTreatmentRecord(id: string, data: UpdateTreatmentData) {\n    try {\n      const response = await api.put(`${this.baseURL}/${id}`, data);\n      return response;\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to update treatment record';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Delete treatment record\n  async deleteTreatmentRecord(id: string) {\n    try {\n      const response = await api.delete(`${this.baseURL}/${id}`);\n      return response;\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to delete treatment record';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Get treatment statistics\n  async getTreatmentStats(filters: { startDate?: string; endDate?: string; dentist?: string; clinic?: string } = {}) {\n    try {\n      const params = new URLSearchParams();\n      \n      Object.entries(filters).forEach(([key, value]) => {\n        if (value !== undefined && value !== null && value !== '') {\n          params.append(key, value.toString());\n        }\n      });\n\n      const response = await api.get(`${this.baseURL}/stats?${params.toString()}`);\n      return response;\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to fetch treatment statistics';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Export treatment records\n  async exportTreatmentRecords(params: {\n    search?: string;\n    status?: string;\n    treatmentType?: string;\n    patient?: string;\n    dentist?: string;\n    startDate?: string;\n    endDate?: string;\n    format: 'csv' | 'pdf';\n  }): Promise<Blob> {\n    try {\n      const queryParams = new URLSearchParams();\n      Object.entries(params).forEach(([key, value]) => {\n        if (value !== undefined && value !== null && value !== '') {\n          queryParams.append(key, value.toString());\n        }\n      });\n\n      const response = await api.get(`${this.baseURL}/export?${queryParams.toString()}`, {\n        responseType: 'blob'\n      });\n      return response.data;\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to export treatment records';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Get treatment analytics for reports\n  async getTreatmentAnalytics(params: {\n    startDate?: string;\n    endDate?: string;\n    dentist?: string;\n    clinic?: string;\n    groupBy?: 'day' | 'week' | 'month';\n  } = {}) {\n    try {\n      const queryParams = new URLSearchParams();\n      Object.entries(params).forEach(([key, value]) => {\n        if (value !== undefined && value !== null && value !== '') {\n          queryParams.append(key, value.toString());\n        }\n      });\n\n      const response = await api.get(`${this.baseURL}/analytics?${queryParams.toString()}`);\n      return response.data;\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to fetch treatment analytics';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Upload treatment attachment\n  async uploadAttachment(treatmentId: string, file: File): Promise<ApiResponse<{ url: string; fileName: string }>> {\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      const response = await api.post(`${this.baseURL}/${treatmentId}/attachments`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      return {\n        success: true,\n        data: response.data,\n        message: 'Attachment uploaded successfully'\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to upload attachment';\n      throw new Error(errorMessage);\n    }\n  }\n\n  // Delete treatment attachment\n  async deleteAttachment(treatmentId: string, attachmentId: string): Promise<ApiResponse<void>> {\n    try {\n      const response = await api.delete(`${this.baseURL}/${treatmentId}/attachments/${attachmentId}`);\n      return {\n        success: true,\n        data: response.data,\n        message: 'Attachment deleted successfully'\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to delete attachment';\n      throw new Error(errorMessage);\n    }\n  }\n}\n\n// Create and export service instance\nconst treatmentService = new TreatmentService();\n\n// Export individual functions\nexport const getTreatmentRecords = treatmentService.getTreatmentRecords.bind(treatmentService);\nexport const getTreatmentRecord = treatmentService.getTreatmentRecord.bind(treatmentService);\nexport const createTreatmentRecord = treatmentService.createTreatmentRecord.bind(treatmentService);\nexport const updateTreatmentRecord = treatmentService.updateTreatmentRecord.bind(treatmentService);\nexport const deleteTreatmentRecord = treatmentService.deleteTreatmentRecord.bind(treatmentService);\nexport const getTreatmentStats = treatmentService.getTreatmentStats.bind(treatmentService);\nexport const exportTreatmentRecords = treatmentService.exportTreatmentRecords.bind(treatmentService);\nexport const getTreatmentAnalytics = treatmentService.getTreatmentAnalytics.bind(treatmentService);\nexport const uploadAttachment = treatmentService.uploadAttachment.bind(treatmentService);\nexport const deleteAttachment = treatmentService.deleteAttachment.bind(treatmentService);\n\n// Export service instance as both named and default export\nexport { treatmentService };\nexport default treatmentService;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\userService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1830,1833],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1830,1833],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3320,3323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3320,3323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5133,5136],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5133,5136],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":225,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7112,7115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7112,7115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\nimport type { User, ApiResponse, PaginatedResponse } from '../types';\nimport { createSafeApiParams } from '../utils/clinicUtils';\n\nexport interface UpdateProfileData {\n  firstName?: string;\n  lastName?: string;\n  phone?: string;\n  dateOfBirth?: string;\n  gender?: string;\n  address?: {\n    street?: string;\n    city?: string;\n    state?: string;\n    zipCode?: string;\n    country?: string;\n  };\n  specialization?: string;\n  licenseNumber?: string;\n  bio?: string;\n}\n\n\nexport interface TokenValidationResult {\n  isValid: boolean;\n  isExpired: boolean;\n  expiresAt?: Date;\n  user?: User;\n}\n\n// Token validation and user permissions\nexport const validateUserToken = async (): Promise<TokenValidationResult> => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      return { isValid: false, isExpired: false };\n    }\n\n    // Check token expiration by decoding JWT (basic check)\n    try {\n      const tokenPayload = JSON.parse(atob(token.split('.')[1]));\n      const currentTime = Math.floor(Date.now() / 1000);\n      const isExpired = tokenPayload.exp < currentTime;\n      \n      if (isExpired) {\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        return { isValid: false, isExpired: true };\n      }\n\n      // Additional server-side validation\n      const response = await api.get('/api/v1/auth/validate');\n      const user = response.data?.data?.user;\n      \n      return {\n        isValid: true,\n        isExpired: false,\n        expiresAt: new Date(tokenPayload.exp * 1000),\n        user\n      };\n    } catch (_decodeError) {\n      // If token is malformed, remove it\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      return { isValid: false, isExpired: false };\n    }\n  } catch (error: any) {\n    console.error('Token validation error:', error);\n    \n    // Handle specific error cases\n    if (error.response?.status === 401) {\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      return { isValid: false, isExpired: true };\n    }\n    \n    return { isValid: false, isExpired: false };\n  }\n};\n\n// Check user permissions for specific actions\nexport const checkUserPermission = (user: User | null, requiredRole?: string, requiredPermissions?: string[]): boolean => {\n  if (!user) return false;\n  \n  // Check if user is active\n  if (!user.isActive) return false;\n  \n  // Check role if specified\n  if (requiredRole && user.role !== requiredRole) {\n    // Admin can access any role\n    if (requiredRole !== 'admin' && user.role === 'admin') {\n      return true;\n    }\n    return false;\n  }\n  \n  // Check specific permissions if provided\n  if (requiredPermissions && requiredPermissions.length > 0) {\n    const userPermissions = user.permissions || [];\n    return requiredPermissions.every(permission => userPermissions.includes(permission));\n  }\n  \n  return true;\n};\n\n// Update user profile\nexport const updateProfile = async (profileData: UpdateProfileData): Promise<User> => {\n  try {\n    const response = await api.put<ApiResponse<{ user: User }>>('/api/v1/auth/profile', profileData);\n    if (!response.data?.data?.user) {\n      throw new Error('Invalid response from server');\n    }\n    return response.data.data.user;\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to update profile';\n    throw new Error(errorMessage);\n  }\n};\n\n// Upload profile image with optimization\nexport const uploadProfileImage = async (file: File): Promise<{ profileImage: string }> => {\n  try {\n    // Import image optimization utilities dynamically to avoid bundle bloat\n    const { optimizeProfileImage, validateImageFile } = await import('../utils/imageOptimization');\n    \n    // Validate the image file\n    const validation = validateImageFile(file, {\n      maxSizeMB: 5,\n      allowedTypes: ['image/jpeg', 'image/jpg', 'image/png', 'image/gif']\n    });\n    \n    if (!validation.isValid) {\n      throw new Error(validation.error);\n    }\n    \n    // Optimize the image for better performance\n    let optimizedFile = file;\n    try {\n      const profileImageSet = await optimizeProfileImage(file);\n      // Use the medium size for upload (good balance of quality and size)\n      optimizedFile = profileImageSet.medium.file;\n      \n      console.log(`Image optimized: ${file.size} bytes  ${optimizedFile.size} bytes (${profileImageSet.medium.compressionRatio.toFixed(1)}% reduction)`);\n    } catch (optimizationError) {\n      console.warn('Image optimization failed, using original:', optimizationError);\n      // Continue with original file if optimization fails\n    }\n    \n    const formData = new FormData();\n    formData.append('profileImage', optimizedFile);\n    \n    const response = await api.post<ApiResponse<{ profileImage: string }>>('/api/v1/users/profile-image', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n    if (!response.data?.data) {\n      throw new Error('Invalid response from server');\n    }\n    return response.data.data;\n  } catch (error: any) {\n    const errorMessage = error.response?.data?.message || error.message || 'Failed to upload profile image';\n    throw new Error(errorMessage);\n  }\n};\n\n// Get users by role with enhanced error handling\nexport const getUsersByRole = async (role: string, params?: {\n  clinicId?: string;\n  page?: number;\n  limit?: number;\n}): Promise<PaginatedResponse<User>> => {\n  try {\n    console.log(`Fetching users with role: ${role}`, { params });\n    \n    if (role === 'dentist') {\n      // Use dedicated dentists endpoint\n      const safeParams = createSafeApiParams(params?.clinicId);\n      const response = await api.get('/api/v1/users/dentists', {\n        params: safeParams\n      });\n      \n      console.log('Dentist API response:', {\n        status: response.status,\n        hasData: !!response.data,\n        dataStructure: response.data ? Object.keys(response.data) : [],\n        dentistsCount: response.data?.data?.dentists?.length || 0\n      });\n      \n      // Transform the response to match PaginatedResponse format\n      const dentists = response.data?.data?.dentists || [];\n      \n      // Handle case where no dentists are found\n      if (dentists.length === 0) {\n        console.warn(`No dentists found for clinic: ${params?.clinicId}`);\n        return {\n          success: true,\n          data: [],\n          message: `No dentists available for this clinic. Please contact administration to assign dentists.`,\n          page: 1,\n          limit: 0,\n          total: 0,\n          totalPages: 1\n        };\n      }\n      \n      return {\n        success: true,\n        data: dentists,\n        page: 1,\n        limit: dentists.length,\n        total: dentists.length,\n        totalPages: 1\n      };\n    } else {\n      // Use general users endpoint for other roles\n      const response = await api.get<PaginatedResponse<User>>('/api/v1/users', {\n        params: {\n          role,\n          ...params\n        }\n      });\n      return response.data;\n    }\n  } catch (error: any) {\n    console.error(`Error fetching ${role}s:`, {\n      status: error.response?.status,\n      statusText: error.response?.statusText,\n      message: error.response?.data?.message,\n      url: error.config?.url,\n      params: error.config?.params\n    });\n    \n    // Handle specific error cases\n    if (error.response?.status === 401) {\n      // Check if it's due to no dentists in clinic vs authentication issue\n      const errorMsg = error.response?.data?.message || '';\n      if (errorMsg.includes('dentist') || errorMsg.includes('clinic')) {\n        return {\n          success: false,\n          data: [],\n          message: `No ${role}s available for this clinic. Please contact administration.`,\n          page: 1,\n          limit: 0,\n          total: 0,\n          totalPages: 1\n        };\n      } else {\n        throw new Error('Authentication failed. Please log in again.');\n      }\n    } else if (error.response?.status === 404) {\n      return {\n        success: true,\n        data: [],\n        message: `No ${role}s found.`,\n        page: 1,\n        limit: 0,\n        total: 0,\n        totalPages: 1\n      };\n    }\n    \n    const errorMessage = error.response?.data?.message || error.message || `Failed to fetch ${role}s`;\n    throw new Error(errorMessage);\n  }\n};\n\nexport const userService = {\n  updateProfile,\n  uploadProfileImage,\n  getUsersByRole,\n  validateUserToken,\n  checkUserPermission\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\services\\websocketService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1669,1672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1669,1672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1905,1908],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1905,1908],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2002,2005],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2002,2005],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { io, Socket } from 'socket.io-client';\n\nconst SOCKET_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n\nclass WebSocketService {\n  private socket: Socket | null = null;\n  private retryCount = 0;\n  private maxRetries = 5;\n\n  connect() {\n    try {\n      if (this.socket?.connected) {\n        console.log(' WebSocket already connected');\n        return;\n      }\n\n      console.log(' Connecting to WebSocket...', SOCKET_URL);\n      \n      this.socket = io(SOCKET_URL, {\n        transports: ['polling', 'websocket'],\n        reconnectionAttempts: this.maxRetries,\n        reconnectionDelay: 1000,\n        timeout: 10000,\n        withCredentials: true,\n        forceNew: true,\n        path: '/socket.io',\n        auth: {\n          token: (typeof window !== 'undefined' ? (localStorage.getItem('token') || '') : '')\n        }\n      });\n\n      this.socket.on('connect', () => {\n        console.log(' WebSocket connected successfully');\n        this.retryCount = 0;\n      });\n\n      this.socket.on('connect_error', (error) => {\n        console.error(' WebSocket connection error:', error);\n        this.retryCount++;\n        \n        if (this.retryCount >= this.maxRetries) {\n          console.error(' Max reconnection attempts reached');\n          this.socket?.close();\n        }\n      });\n\n      this.socket.on('disconnect', (reason) => {\n        console.log(' WebSocket disconnected:', reason);\n      });\n\n    } catch (error) {\n      console.error(' WebSocket initialization error:', error);\n    }\n  }\n\n  disconnect() {\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n    }\n  }\n\n  emit(event: string, data: any) {\n    if (!this.socket?.connected) {\n      console.warn(' Socket not connected. Attempting to reconnect...');\n      this.connect();\n      return;\n    }\n    this.socket.emit(event, data);\n  }\n\n  on(event: string, callback: (data: any) => void) {\n    this.socket?.on(event, callback);\n  }\n\n  off(event: string, callback: (data: any) => void) {\n    this.socket?.off(event, callback);\n  }\n}\n\nexport default new WebSocketService();\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\setupTests.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1131,1134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1131,1134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import '@testing-library/jest-dom';\n\n// Mock import.meta for Vite environment variables\nObject.defineProperty(globalThis, 'import', {\n  value: {\n    meta: {\n      env: {\n        VITE_API_URL: 'http://localhost:3000/api'\n      }\n    }\n  },\n  writable: true\n});\n\n// Alternative approach - mock the constants module directly\njest.mock('./config/constants', () => ({\n  API_URL: 'http://localhost:3000/api'\n}));\n\n// Mock window.matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(), // deprecated\n    removeListener: jest.fn(), // deprecated\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// Mock IntersectionObserver\nglobal.IntersectionObserver = class IntersectionObserver {\n  root = null;\n  rootMargin = '';\n  thresholds = [];\n  \n  constructor() {}\n  \n  observe() {\n    return null;\n  }\n  \n  disconnect() {\n    return null;\n  }\n  \n  unobserve() {\n    return null;\n  }\n  \n  takeRecords() {\n    return [];\n  }\n} as any;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\appointment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\clinic.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\clinicBranch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\common.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":5,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[95,98],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[95,98],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface ApiResponse<T> {\n  data?: T;\n  message: string;\n  success: boolean;\n  error?: any;\n}\n\nexport interface PaginatedResponse<T> {\n  data: T[];\n  total: number;\n  page: number;\n  limit: number;\n  totalPages: number;\n  message?: string;\n  success: boolean;\n}\n\nexport interface ApiError {\n  message: string;\n  status: number;\n  errors?: Record<string, string[]>;\n}\n\nexport interface SelectOption {\n  value: string;\n  label: string;\n}\n\nexport interface Notification {\n  id: string;\n  userId: string;\n  title: string;\n  message: string;\n  type: NotificationType;\n  isRead: boolean;\n  link?: string;\n  createdAt: Date;\n}\n\nexport type NotificationType = 'appointment' | 'reminder' | 'system' | 'message';\n\nexport interface FileUploadResponse {\n  fileName: string;\n  fileUrl: string;\n  fileType: string;\n  fileSize: number;\n  uploadedAt: Date;\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\dentist.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\patient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\types\\user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\__tests__\\errorHandler.simple.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\__tests__\\errorHandler.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[708,711],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[708,711],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[760,763],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[760,763],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Tests for error handler utilities\r\n * Covers API error handling, validation errors, and error classification\r\n */\r\n\r\nimport toast from 'react-hot-toast';\r\nimport {\r\n  getErrorMessage,\r\n  getErrorDetails,\r\n  handleApiError,\r\n  handleValidationError,\r\n  handleSuccess,\r\n  withErrorHandling,\r\n  isNetworkError,\r\n  isAuthError,\r\n  isValidationError\r\n} from '../errorHandler';\r\n\r\n// Mock react-hot-toast\r\njest.mock('react-hot-toast', () => ({\r\n  error: jest.fn(),\r\n  success: jest.fn()\r\n}));\r\n\r\n// Mock window.location\r\nconst mockLocation = {\r\n  href: ''\r\n};\r\n\r\n// Store original location\r\nconst originalLocation = window.location;\r\n\r\n// Mock location before tests\r\nbeforeAll(() => {\r\n  delete (window as any).location;\r\n  window.location = mockLocation as any;\r\n});\r\n\r\n// Restore location after tests\r\nafterAll(() => {\r\n  window.location = originalLocation;\r\n});\r\n\r\ndescribe('getErrorMessage', () => {\r\n  it('should extract message from response error', () => {\r\n    const error = {\r\n      response: {\r\n        data: {\r\n          message: 'API error message'\r\n        }\r\n      }\r\n    };\r\n    \r\n    expect(getErrorMessage(error)).toBe('API error message');\r\n  });\r\n\r\n  it('should extract message from error object', () => {\r\n    const error = new Error('Direct error message');\r\n    expect(getErrorMessage(error)).toBe('Direct error message');\r\n  });\r\n\r\n  it('should handle string errors', () => {\r\n    expect(getErrorMessage('String error')).toBe('String error');\r\n  });\r\n\r\n  it('should return default message for unknown errors', () => {\r\n    expect(getErrorMessage(null)).toBe('An error occurred');\r\n    expect(getErrorMessage(undefined)).toBe('An error occurred');\r\n    expect(getErrorMessage({})).toBe('An error occurred');\r\n    expect(getErrorMessage(null, 'Custom default')).toBe('Custom default');\r\n  });\r\n});\r\n\r\ndescribe('getErrorDetails', () => {\r\n  it('should extract complete error details', () => {\r\n    const error = {\r\n      response: {\r\n        status: 404,\r\n        data: {\r\n          message: 'Not found',\r\n          code: 'RESOURCE_NOT_FOUND'\r\n        }\r\n      },\r\n      code: 'ERR_NETWORK'\r\n    };\r\n    \r\n    const details = getErrorDetails(error);\r\n    expect(details).toEqual({\r\n      message: 'Not found',\r\n      status: 404,\r\n      code: 'ERR_NETWORK',\r\n      shouldRedirect: false\r\n    });\r\n  });\r\n\r\n  it('should identify auth errors that require redirect', () => {\r\n    const error401 = { response: { status: 401 } };\r\n    const error403 = { response: { status: 403 } };\r\n    \r\n    expect(getErrorDetails(error401).shouldRedirect).toBe(true);\r\n    expect(getErrorDetails(error403).shouldRedirect).toBe(true);\r\n  });\r\n\r\n  it('should handle errors without response', () => {\r\n    const error = new Error('Network error');\r\n    const details = getErrorDetails(error);\r\n    \r\n    expect(details.message).toBe('Network error');\r\n    expect(details.status).toBeUndefined();\r\n    expect(details.shouldRedirect).toBe(false);\r\n  });\r\n});\r\n\r\ndescribe('handleApiError', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockLocation.href = '';\r\n  });\r\n\r\n  it('should handle 401 authentication errors', () => {\r\n    const error = { response: { status: 401 } };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('Your session has expired. Please log in again.');\r\n    expect(toast.error).toHaveBeenCalledWith('Your session has expired. Please log in again.');\r\n    \r\n    // Check redirect after timeout\r\n    setTimeout(() => {\r\n      expect(mockLocation.href).toBe('/login');\r\n    }, 2100);\r\n  });\r\n\r\n  it('should handle 403 permission errors', () => {\r\n    const error = { response: { status: 403 } };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('You do not have permission to perform this action.');\r\n    expect(toast.error).toHaveBeenCalledWith('You do not have permission to perform this action.');\r\n  });\r\n\r\n  it('should handle 404 not found errors', () => {\r\n    const error = { response: { status: 404 } };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('The requested resource was not found.');\r\n    expect(toast.error).toHaveBeenCalledWith('The requested resource was not found.');\r\n  });\r\n\r\n  it('should handle 422 validation errors', () => {\r\n    const error = { response: { status: 422 } };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('Invalid data provided. Please check your inputs.');\r\n    expect(toast.error).toHaveBeenCalledWith('Invalid data provided. Please check your inputs.');\r\n  });\r\n\r\n  it('should handle 413 file size errors', () => {\r\n    const error = { response: { status: 413 } };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('The file is too large. Please upload a smaller file.');\r\n    expect(toast.error).toHaveBeenCalledWith('The file is too large. Please upload a smaller file.');\r\n  });\r\n\r\n  it('should handle 500 server errors', () => {\r\n    const error = { response: { status: 500 } };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('Server error. Please try again later.');\r\n    expect(toast.error).toHaveBeenCalledWith('Server error. Please try again later.');\r\n  });\r\n\r\n  it('should handle network errors', () => {\r\n    const error = { code: 'ERR_NETWORK' };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('Network error. Please check your internet connection.');\r\n    expect(toast.error).toHaveBeenCalledWith('Network error. Please check your internet connection.');\r\n  });\r\n\r\n  it('should handle connection refused errors', () => {\r\n    const error = { code: 'ECONNREFUSED' };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('Cannot connect to server. Please try again later.');\r\n    expect(toast.error).toHaveBeenCalledWith('Cannot connect to server. Please try again later.');\r\n  });\r\n\r\n  it('should handle timeout errors', () => {\r\n    const error = { code: 'ETIMEDOUT' };\r\n    \r\n    const result = handleApiError(error);\r\n    \r\n    expect(result.message).toBe('Request timed out. Please try again.');\r\n    expect(toast.error).toHaveBeenCalledWith('Request timed out. Please try again.');\r\n  });\r\n\r\n  it('should use custom error messages when provided', () => {\r\n    const error = { response: { status: 404 } };\r\n    \r\n    const result = handleApiError(error, { customMessage: 'Custom not found message' });\r\n    \r\n    expect(result.message).toBe('Custom not found message');\r\n    expect(toast.error).toHaveBeenCalledWith('Custom not found message');\r\n  });\r\n\r\n  it('should respect showToast option', () => {\r\n    const error = { response: { status: 500 } };\r\n    \r\n    handleApiError(error, { showToast: false });\r\n    \r\n    expect(toast.error).not.toHaveBeenCalled();\r\n  });\r\n\r\n  it('should respect logError option', () => {\r\n    const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();\r\n    const error = { response: { status: 500 } };\r\n    \r\n    handleApiError(error, { logError: false });\r\n    \r\n    expect(consoleErrorSpy).not.toHaveBeenCalled();\r\n    \r\n    handleApiError(error, { logError: true });\r\n    \r\n    expect(consoleErrorSpy).toHaveBeenCalled();\r\n    \r\n    consoleErrorSpy.mockRestore();\r\n  });\r\n\r\n  it('should respect redirectOnAuth option', () => {\r\n    const error = { response: { status: 401 } };\r\n    \r\n    handleApiError(error, { redirectOnAuth: false });\r\n    \r\n    // Should not set timeout for redirect\r\n    setTimeout(() => {\r\n      expect(mockLocation.href).toBe('');\r\n    }, 2100);\r\n  });\r\n});\r\n\r\ndescribe('handleValidationError', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  it('should show validation error toast', () => {\r\n    handleValidationError('Validation failed');\r\n    \r\n    expect(toast.error).toHaveBeenCalledWith('Validation failed');\r\n  });\r\n\r\n  it('should log validation errors when enabled', () => {\r\n    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n    \r\n    handleValidationError('Validation failed', { logError: true });\r\n    \r\n    expect(consoleWarnSpy).toHaveBeenCalledWith('Validation Error:', 'Validation failed');\r\n    \r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n\r\n  it('should respect showToast option', () => {\r\n    handleValidationError('Validation failed', { showToast: false });\r\n    \r\n    expect(toast.error).not.toHaveBeenCalled();\r\n  });\r\n});\r\n\r\ndescribe('handleSuccess', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  it('should show success toast', () => {\r\n    handleSuccess('Operation successful');\r\n    \r\n    expect(toast.success).toHaveBeenCalledWith('Operation successful');\r\n  });\r\n\r\n  it('should log success when enabled', () => {\r\n    const consoleLogSpy = jest.spyOn(console, 'log').mockImplementation();\r\n    \r\n    handleSuccess('Operation successful', { logSuccess: true });\r\n    \r\n    expect(consoleLogSpy).toHaveBeenCalledWith('Success:', 'Operation successful');\r\n    \r\n    consoleLogSpy.mockRestore();\r\n  });\r\n\r\n  it('should respect showToast option', () => {\r\n    handleSuccess('Operation successful', { showToast: false });\r\n    \r\n    expect(toast.success).not.toHaveBeenCalled();\r\n  });\r\n});\r\n\r\ndescribe('withErrorHandling', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  it('should return data on successful operation', async () => {\r\n    const operation = jest.fn().mockResolvedValue('success data');\r\n    \r\n    const result = await withErrorHandling(operation);\r\n    \r\n    expect(result).toEqual({ data: 'success data' });\r\n    expect(operation).toHaveBeenCalled();\r\n  });\r\n\r\n  it('should return error details on failed operation', async () => {\r\n    const error = { response: { status: 500 } };\r\n    const operation = jest.fn().mockRejectedValue(error);\r\n    \r\n    const result = await withErrorHandling(operation);\r\n    \r\n    expect(result.data).toBeUndefined();\r\n    expect(result.error).toBeDefined();\r\n    expect(result.error?.message).toBe('Server error. Please try again later.');\r\n  });\r\n\r\n  it('should pass options to error handler', async () => {\r\n    const error = { response: { status: 500 } };\r\n    const operation = jest.fn().mockRejectedValue(error);\r\n    \r\n    await withErrorHandling(operation, { showToast: false });\r\n    \r\n    expect(toast.error).not.toHaveBeenCalled();\r\n  });\r\n});\r\n\r\ndescribe('error classification functions', () => {\r\n  describe('isNetworkError', () => {\r\n    it('should identify network errors', () => {\r\n      expect(isNetworkError({ code: 'ERR_NETWORK' })).toBe(true);\r\n      expect(isNetworkError({ code: 'ECONNREFUSED' })).toBe(true);\r\n      expect(isNetworkError({ code: 'ETIMEDOUT' })).toBe(true);\r\n      expect(isNetworkError({ message: 'Network Error' })).toBe(true);\r\n    });\r\n\r\n    it('should not identify non-network errors', () => {\r\n      expect(isNetworkError({ response: { status: 500 } })).toBe(false);\r\n      expect(isNetworkError({ code: 'OTHER_ERROR' })).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('isAuthError', () => {\r\n    it('should identify authentication errors', () => {\r\n      expect(isAuthError({ response: { status: 401 } })).toBe(true);\r\n      expect(isAuthError({ response: { status: 403 } })).toBe(true);\r\n    });\r\n\r\n    it('should not identify non-auth errors', () => {\r\n      expect(isAuthError({ response: { status: 404 } })).toBe(false);\r\n      expect(isAuthError({ response: { status: 500 } })).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('isValidationError', () => {\r\n    it('should identify validation errors', () => {\r\n      expect(isValidationError({ response: { status: 422 } })).toBe(true);\r\n    });\r\n\r\n    it('should not identify non-validation errors', () => {\r\n      expect(isValidationError({ response: { status: 400 } })).toBe(false);\r\n      expect(isValidationError({ response: { status: 500 } })).toBe(false);\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\__tests__\\safeAccess.simple.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\__tests__\\safeAccess.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3030,3033],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3030,3033],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":253,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":253,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8693,8696],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8693,8696],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":257,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":257,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8890,8893],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8890,8893],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":345,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11706,11709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11706,11709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":381,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":381,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12902,12905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12902,12905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Tests for safe access utilities\r\n * Covers all safe property access and array validation helpers\r\n */\r\n\r\nimport {\r\n  safeAccess,\r\n  safeGet,\r\n  isValidArray,\r\n  safeArrayAccess,\r\n  safeArrayLength,\r\n  safeArrayMap,\r\n  safeArrayFilter,\r\n  safeArrayFind,\r\n  validateResponseStructure,\r\n  safeJsonParse,\r\n  safeJsonStringify,\r\n  exists,\r\n  getDefaultValue\r\n} from '../safeAccess';\r\n\r\ndescribe('safeAccess', () => {\r\n  const testObject = {\r\n    user: {\r\n      profile: {\r\n        name: 'John Doe',\r\n        age: 30,\r\n        settings: {\r\n          theme: 'dark'\r\n        }\r\n      },\r\n      contacts: ['email@test.com', 'phone@test.com']\r\n    },\r\n    items: [\r\n      { id: 1, name: 'Item 1' },\r\n      { id: 2, name: 'Item 2' }\r\n    ]\r\n  };\r\n\r\n  describe('basic property access', () => {\r\n    it('should access nested properties with string path', () => {\r\n      expect(safeAccess(testObject, 'user.profile.name')).toBe('John Doe');\r\n      expect(safeAccess(testObject, 'user.profile.age')).toBe(30);\r\n      expect(safeAccess(testObject, 'user.profile.settings.theme')).toBe('dark');\r\n    });\r\n\r\n    it('should access nested properties with array path', () => {\r\n      expect(safeAccess(testObject, ['user', 'profile', 'name'])).toBe('John Doe');\r\n      expect(safeAccess(testObject, ['user', 'profile', 'settings', 'theme'])).toBe('dark');\r\n    });\r\n\r\n    it('should return fallback for non-existent paths', () => {\r\n      expect(safeAccess(testObject, 'user.profile.nonexistent')).toBeUndefined();\r\n      expect(safeAccess(testObject, 'user.profile.nonexistent', { fallback: 'default' })).toBe('default');\r\n      expect(safeAccess(testObject, 'nonexistent.path', { fallback: null })).toBe(null);\r\n    });\r\n\r\n    it('should handle null/undefined objects', () => {\r\n      expect(safeAccess(null, 'user.name')).toBeUndefined();\r\n      expect(safeAccess(undefined, 'user.name')).toBeUndefined();\r\n      expect(safeAccess(null, 'user.name', { fallback: 'default' })).toBe('default');\r\n    });\r\n\r\n    it('should handle invalid object types', () => {\r\n      expect(safeAccess('string', 'property')).toBeUndefined();\r\n      expect(safeAccess(123, 'property')).toBeUndefined();\r\n      expect(safeAccess(true, 'property')).toBeUndefined();\r\n    });\r\n\r\n    it('should log errors when logError is true', () => {\r\n      const consoleSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n      \r\n      safeAccess(null, 'user.name', { logError: true });\r\n      expect(consoleSpy).toHaveBeenCalledWith(\r\n        'safeAccess: Invalid object provided',\r\n        { obj: null, path: 'user.name' }\r\n      );\r\n      \r\n      safeAccess(testObject, 'user.nonexistent.deep', { logError: true });\r\n      expect(consoleSpy).toHaveBeenCalledWith(\r\n        'safeAccess: Path not found',\r\n        expect.objectContaining({ path: 'user.nonexistent.deep' })\r\n      );\r\n      \r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n\r\n  describe('error handling', () => {\r\n    it('should handle circular references gracefully', () => {\r\n      const circularObj: any = { name: 'test' };\r\n      circularObj.self = circularObj;\r\n      \r\n      // This should not throw an error\r\n      expect(() => safeAccess(circularObj, 'name')).not.toThrow();\r\n      expect(safeAccess(circularObj, 'name')).toBe('test');\r\n    });\r\n\r\n    it('should handle getter properties that throw errors', () => {\r\n      const errorObj = {\r\n        get throwingProperty() {\r\n          throw new Error('Property access error');\r\n        }\r\n      };\r\n      \r\n      const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();\r\n      \r\n      expect(safeAccess(errorObj, 'throwingProperty')).toBeUndefined();\r\n      expect(safeAccess(errorObj, 'throwingProperty', { fallback: 'safe' })).toBe('safe');\r\n      \r\n      consoleErrorSpy.mockRestore();\r\n    });\r\n  });\r\n});\r\n\r\ndescribe('safeGet', () => {\r\n  const testObject = {\r\n    user: {\r\n      name: 'John',\r\n      profile: null\r\n    }\r\n  };\r\n\r\n  it('should safely access properties using accessor function', () => {\r\n    expect(safeGet(testObject, obj => obj.user.name)).toBe('John');\r\n    expect(safeGet(testObject, obj => obj.user.profile?.settings, 'default')).toBe('default');\r\n  });\r\n\r\n  it('should handle null/undefined objects', () => {\r\n    expect(safeGet(null, obj => obj.user.name)).toBeUndefined();\r\n    expect(safeGet(null, obj => obj.user.name, 'fallback')).toBe('fallback');\r\n  });\r\n\r\n  it('should handle accessor function errors', () => {\r\n    expect(safeGet(testObject, obj => obj.nonexistent.property)).toBeUndefined();\r\n    expect(safeGet(testObject, obj => obj.nonexistent.property, 'safe')).toBe('safe');\r\n  });\r\n});\r\n\r\ndescribe('isValidArray', () => {\r\n  it('should return true for valid arrays', () => {\r\n    expect(isValidArray([])).toBe(true);\r\n    expect(isValidArray([1, 2, 3])).toBe(true);\r\n    expect(isValidArray(['a', 'b'])).toBe(true);\r\n  });\r\n\r\n  it('should return false for invalid arrays', () => {\r\n    expect(isValidArray(null)).toBe(false);\r\n    expect(isValidArray(undefined)).toBe(false);\r\n    expect(isValidArray('string')).toBe(false);\r\n    expect(isValidArray(123)).toBe(false);\r\n    expect(isValidArray({})).toBe(false);\r\n  });\r\n});\r\n\r\ndescribe('safeArrayAccess', () => {\r\n  const testArray = ['a', 'b', 'c'];\r\n\r\n  it('should access valid array indices', () => {\r\n    expect(safeArrayAccess(testArray, 0)).toBe('a');\r\n    expect(safeArrayAccess(testArray, 1)).toBe('b');\r\n    expect(safeArrayAccess(testArray, 2)).toBe('c');\r\n  });\r\n\r\n  it('should return fallback for invalid indices', () => {\r\n    expect(safeArrayAccess(testArray, -1)).toBeUndefined();\r\n    expect(safeArrayAccess(testArray, 5)).toBeUndefined();\r\n    expect(safeArrayAccess(testArray, -1, 'fallback')).toBe('fallback');\r\n  });\r\n\r\n  it('should handle invalid arrays', () => {\r\n    expect(safeArrayAccess(null, 0)).toBeUndefined();\r\n    expect(safeArrayAccess('string', 0)).toBeUndefined();\r\n    expect(safeArrayAccess(null, 0, 'fallback')).toBe('fallback');\r\n  });\r\n});\r\n\r\ndescribe('safeArrayLength', () => {\r\n  it('should return correct length for valid arrays', () => {\r\n    expect(safeArrayLength([])).toBe(0);\r\n    expect(safeArrayLength([1, 2, 3])).toBe(3);\r\n    expect(safeArrayLength(['a'])).toBe(1);\r\n  });\r\n\r\n  it('should return fallback for invalid arrays', () => {\r\n    expect(safeArrayLength(null)).toBe(0);\r\n    expect(safeArrayLength(undefined)).toBe(0);\r\n    expect(safeArrayLength('string')).toBe(0);\r\n    expect(safeArrayLength(null, 5)).toBe(5);\r\n  });\r\n});\r\n\r\ndescribe('safeArrayMap', () => {\r\n  const testArray = [1, 2, 3];\r\n  const mapper = (x: number) => x * 2;\r\n\r\n  it('should map valid arrays', () => {\r\n    expect(safeArrayMap(testArray, mapper)).toEqual([2, 4, 6]);\r\n    expect(safeArrayMap(['a', 'b'], (x: string) => x.toUpperCase())).toEqual(['A', 'B']);\r\n  });\r\n\r\n  it('should return fallback for invalid arrays', () => {\r\n    expect(safeArrayMap(null, mapper)).toEqual([]);\r\n    expect(safeArrayMap(undefined, mapper)).toEqual([]);\r\n    expect(safeArrayMap(null, mapper, [99])).toEqual([99]);\r\n  });\r\n\r\n  it('should handle mapper function errors', () => {\r\n    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n    const errorMapper = () => { throw new Error('Mapper error'); };\r\n    \r\n    expect(safeArrayMap(testArray, errorMapper)).toEqual([]);\r\n    expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n      'safeArrayMap: Error during mapping',\r\n      expect.any(Error)\r\n    );\r\n    \r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n});\r\n\r\ndescribe('safeArrayFilter', () => {\r\n  const testArray = [1, 2, 3, 4, 5];\r\n  const predicate = (x: number) => x > 3;\r\n\r\n  it('should filter valid arrays', () => {\r\n    expect(safeArrayFilter(testArray, predicate)).toEqual([4, 5]);\r\n    expect(safeArrayFilter(['a', 'bb', 'ccc'], (x: string) => x.length > 1)).toEqual(['bb', 'ccc']);\r\n  });\r\n\r\n  it('should return fallback for invalid arrays', () => {\r\n    expect(safeArrayFilter(null, predicate)).toEqual([]);\r\n    expect(safeArrayFilter(undefined, predicate)).toEqual([]);\r\n    expect(safeArrayFilter(null, predicate, [99])).toEqual([99]);\r\n  });\r\n\r\n  it('should handle predicate function errors', () => {\r\n    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n    const errorPredicate = () => { throw new Error('Predicate error'); };\r\n    \r\n    expect(safeArrayFilter(testArray, errorPredicate)).toEqual([]);\r\n    expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n      'safeArrayFilter: Error during filtering',\r\n      expect.any(Error)\r\n    );\r\n    \r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n});\r\n\r\ndescribe('safeArrayFind', () => {\r\n  const testArray = [{ id: 1, name: 'a' }, { id: 2, name: 'b' }];\r\n  const predicate = (x: any) => x.id === 2;\r\n\r\n  it('should find elements in valid arrays', () => {\r\n    expect(safeArrayFind(testArray, predicate)).toEqual({ id: 2, name: 'b' });\r\n    expect(safeArrayFind(testArray, (x: any) => x.id === 99)).toBeUndefined();\r\n  });\r\n\r\n  it('should return fallback for invalid arrays', () => {\r\n    expect(safeArrayFind(null, predicate)).toBeUndefined();\r\n    expect(safeArrayFind(null, predicate, 'fallback')).toBe('fallback');\r\n  });\r\n\r\n  it('should handle predicate function errors', () => {\r\n    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n    const errorPredicate = () => { throw new Error('Find error'); };\r\n    \r\n    expect(safeArrayFind(testArray, errorPredicate)).toBeUndefined();\r\n    expect(consoleWarnSpy).toHaveBeenCalledWith(\r\n      'safeArrayFind: Error during search',\r\n      expect.any(Error)\r\n    );\r\n    \r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n});\r\n\r\ndescribe('validateResponseStructure', () => {\r\n  it('should validate correct response structures', () => {\r\n    const response = {\r\n      data: [1, 2, 3],\r\n      message: 'success',\r\n      count: 3\r\n    };\r\n    \r\n    const structure = {\r\n      data: 'array',\r\n      message: 'string',\r\n      count: 'number'\r\n    };\r\n    \r\n    expect(validateResponseStructure(response, structure)).toBe(true);\r\n  });\r\n\r\n  it('should reject invalid response structures', () => {\r\n    const response = {\r\n      data: 'not an array',\r\n      message: 123,\r\n      count: 'not a number'\r\n    };\r\n    \r\n    const structure = {\r\n      data: 'array',\r\n      message: 'string',\r\n      count: 'number'\r\n    };\r\n    \r\n    expect(validateResponseStructure(response, structure)).toBe(false);\r\n  });\r\n\r\n  it('should handle null/undefined responses', () => {\r\n    expect(validateResponseStructure(null, { data: 'array' })).toBe(false);\r\n    expect(validateResponseStructure(undefined, { data: 'array' })).toBe(false);\r\n  });\r\n});\r\n\r\ndescribe('safeJsonParse', () => {\r\n  it('should parse valid JSON strings', () => {\r\n    expect(safeJsonParse('{\"name\": \"test\"}')).toEqual({ name: 'test' });\r\n    expect(safeJsonParse('[1, 2, 3]')).toEqual([1, 2, 3]);\r\n    expect(safeJsonParse('null')).toBe(null);\r\n  });\r\n\r\n  it('should return fallback for invalid JSON', () => {\r\n    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n    \r\n    expect(safeJsonParse('invalid json')).toBeUndefined();\r\n    expect(safeJsonParse('invalid json', 'default')).toBe('default');\r\n    expect(consoleWarnSpy).toHaveBeenCalled();\r\n    \r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n});\r\n\r\ndescribe('safeJsonStringify', () => {\r\n  it('should stringify valid objects', () => {\r\n    expect(safeJsonStringify({ name: 'test' })).toBe('{\"name\":\"test\"}');\r\n    expect(safeJsonStringify([1, 2, 3])).toBe('[1,2,3]');\r\n    expect(safeJsonStringify(null)).toBe('null');\r\n  });\r\n\r\n  it('should return fallback for unstringifiable objects', () => {\r\n    const consoleWarnSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n    const circularObj: any = {};\r\n    circularObj.self = circularObj;\r\n    \r\n    expect(safeJsonStringify(circularObj)).toBe('{}');\r\n    expect(safeJsonStringify(circularObj, '{\"error\": true}')).toBe('{\"error\": true}');\r\n    expect(consoleWarnSpy).toHaveBeenCalled();\r\n    \r\n    consoleWarnSpy.mockRestore();\r\n  });\r\n});\r\n\r\ndescribe('exists', () => {\r\n  it('should return true for existing values', () => {\r\n    expect(exists('string')).toBe(true);\r\n    expect(exists(0)).toBe(true);\r\n    expect(exists(false)).toBe(true);\r\n    expect(exists([])).toBe(true);\r\n    expect(exists({})).toBe(true);\r\n  });\r\n\r\n  it('should return false for null/undefined', () => {\r\n    expect(exists(null)).toBe(false);\r\n    expect(exists(undefined)).toBe(false);\r\n  });\r\n});\r\n\r\ndescribe('getDefaultValue', () => {\r\n  it('should return correct default values for each type', () => {\r\n    expect(getDefaultValue('string')).toBe('');\r\n    expect(getDefaultValue('number')).toBe(0);\r\n    expect(getDefaultValue('boolean')).toBe(false);\r\n    expect(getDefaultValue('array')).toEqual([]);\r\n    expect(getDefaultValue('object')).toEqual({});\r\n  });\r\n\r\n  it('should return null for unknown types', () => {\r\n    expect(getDefaultValue('unknown' as any)).toBe(null);\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\analytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":3,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[59,62],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[59,62],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[151,154],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[151,154],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"declare global {\n  interface Window {\n    gtag?: (...args: any[]) => void;\n  }\n}\n\nexport function trackEvent(eventName: string, params: Record<string, any> = {}) {\n  try {\n    if (typeof window !== 'undefined' && typeof window.gtag === 'function') {\n      window.gtag('event', eventName, params);\n    } else if (import.meta && import.meta.env && import.meta.env.DEV) {\n      console.log('[analytics]', eventName, params);\n    }\n  } catch (error) {\n    if (import.meta && import.meta.env && import.meta.env.DEV) {\n      console.warn('[analytics] trackEvent error:', error);\n    }\n  }\n}\n\nexport function trackTiming(name: string, value: number, category?: string) {\n  try {\n    if (typeof window !== 'undefined' && typeof window.gtag === 'function') {\n      window.gtag('event', 'timing_complete', {\n        name,\n        value,\n        event_category: category,\n      });\n    } else if (import.meta && import.meta.env && import.meta.env.DEV) {\n      console.log('[timing]', { name, value, category });\n    }\n  } catch (error) {\n    if (import.meta && import.meta.env && import.meta.env.DEV) {\n      console.warn('[analytics] trackTiming error:', error);\n    }\n  }\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\animations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\appointmentValidationUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2608,2611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2608,2611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// No validation utilities needed for appointment validation\r\nimport type { TFunction } from 'i18next';\r\n\r\nexport interface AppointmentFormData {\r\n  patientId: string;\r\n  service: string;\r\n  date: string;\r\n  timeSlot: string;\r\n  notes: string;\r\n  emergency: boolean;\r\n  patientSearch?: string;\r\n  clinicId?: string;\r\n}\r\n\r\nexport interface ValidationResult {\r\n  isValid: boolean;\r\n  errors: Record<string, string>;\r\n}\r\n\r\n/**\r\n * Validates appointment form data with detailed error messages\r\n * @param data The appointment form data to validate\r\n * @param t Translation function\r\n * @param currentStep Current form step (optional)\r\n * @returns Validation result with isValid flag and error messages\r\n */\r\nexport const validateAppointmentForm = (\r\n  data: AppointmentFormData,\r\n  t: TFunction,\r\n  currentStep?: string\r\n): ValidationResult => {\r\n  const errors: Record<string, string> = {};\r\n  \r\n  // Validate based on current step or validate all fields if no step provided\r\n  if (!currentStep || currentStep === 'patient') {\r\n    if (!data.patientId) {\r\n      errors.patientId = t('appointmentForm.error_selectPatient');\r\n    }\r\n  }\r\n  \r\n  if (!currentStep || currentStep === 'service') {\r\n    if (!data.service) {\r\n      errors.service = t('appointmentForm.error_selectService');\r\n    }\r\n    // Validate clinic selection for multi-branch system\r\n    if (!data.clinicId) {\r\n      errors.clinicId = t('appointmentForm.error_clinicRequired') || 'Please select a clinic';\r\n    }\r\n  }\r\n  \r\n  if (!currentStep || currentStep === 'datetime') {\r\n    if (!data.date) {\r\n      errors.date = t('appointmentForm.error_selectDate');\r\n    } else {\r\n      // Check if date is in the past\r\n      const today = new Date().toISOString().split('T')[0];\r\n      if (data.date < today) {\r\n        errors.date = t('appointmentForm.error_pastDate');\r\n      }\r\n    }\r\n    \r\n    if (!data.timeSlot) {\r\n      errors.timeSlot = t('appointmentForm.error_selectTime');\r\n    }\r\n  }\r\n  \r\n  // Notes validation is optional\r\n  if (data.notes && data.notes.length > 500) {\r\n    errors.notes = t('appointmentForm.error_notesTooLong');\r\n  }\r\n  \r\n  return {\r\n    isValid: Object.keys(errors).length === 0,\r\n    errors\r\n  };\r\n};\r\n\r\n/**\r\n * Validates time slot availability with the server\r\n * @param appointmentService The appointment service instance\r\n * @param data The appointment data to validate\r\n * @param clinicId The clinic ID\r\n * @param appointmentId Optional appointment ID to exclude from conflict check\r\n * @returns Promise resolving to validation result\r\n */\r\nexport const validateTimeSlotAvailability = async (\r\n  appointmentService: any,\r\n  data: { date: string; timeSlot: string; dentistId?: string },\r\n  clinicId: string,\r\n  appointmentId?: string,\r\n  fallbackDentistId?: string\r\n): Promise<ValidationResult> => {\r\n  try {\r\n    // Validate required parameters before making the API call\r\n    if (!data.date || !data.timeSlot || !clinicId) {\r\n      return {\r\n        isValid: false,\r\n        errors: { timeSlot: 'Missing required information for availability check' }\r\n      };\r\n    }\r\n    \r\n    // Use dentistId from data, or fallback dentistId if provided\r\n    const dentistId = data.dentistId || fallbackDentistId;\r\n    \r\n    // The improved checkTimeSlotConflict now returns a boolean\r\n    const hasConflict = await appointmentService.checkTimeSlotConflict({\r\n      date: data.date,\r\n      timeSlot: data.timeSlot,\r\n      clinicId: clinicId,\r\n      dentistId: dentistId, // Include dentistId to prevent 400 error\r\n      excludeAppointmentId: appointmentId\r\n    });\r\n\r\n    if (hasConflict) {\r\n      return {\r\n        isValid: false,\r\n        errors: { timeSlot: 'This time slot is no longer available' }\r\n      };\r\n    }\r\n    \r\n    return { isValid: true, errors: {} };\r\n  } catch (error) {\r\n    console.error('Error validating time slot:', error);\r\n    return {\r\n      isValid: false,\r\n      errors: { timeSlot: 'Error checking time slot availability' }\r\n    };\r\n  }\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\cacheManager.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[160,163],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[160,163],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6396,6399],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6396,6399],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":252,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":252,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6979,6982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6979,6982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":273,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":273,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7553,7556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7553,7556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":294,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8153,8156],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8153,8156],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Cache Manager for profile data and API responses\r\n * Implements memory and localStorage caching with TTL support\r\n */\r\n\r\nexport interface CacheItem<T = any> {\r\n  data: T;\r\n  timestamp: number;\r\n  ttl: number; // Time to live in milliseconds\r\n  key: string;\r\n}\r\n\r\nexport interface CacheOptions {\r\n  ttl?: number; // Time to live in milliseconds (default: 5 minutes)\r\n  storage?: 'memory' | 'localStorage' | 'both';\r\n  maxSize?: number; // Maximum number of items in memory cache\r\n}\r\n\r\nclass CacheManager {\r\n  private memoryCache = new Map<string, CacheItem>();\r\n  private readonly defaultTTL = 5 * 60 * 1000; // 5 minutes\r\n  private readonly maxMemorySize = 100;\r\n\r\n  /**\r\n   * Set an item in cache\r\n   * @param key - Cache key\r\n   * @param data - Data to cache\r\n   * @param options - Cache options\r\n   */\r\n  set<T>(key: string, data: T, options: CacheOptions = {}): void {\r\n    const {\r\n      ttl = this.defaultTTL,\r\n      storage = 'both',\r\n      maxSize = this.maxMemorySize\r\n    } = options;\r\n\r\n    const cacheItem: CacheItem<T> = {\r\n      data,\r\n      timestamp: Date.now(),\r\n      ttl,\r\n      key\r\n    };\r\n\r\n    // Store in memory cache\r\n    if (storage === 'memory' || storage === 'both') {\r\n      // Remove oldest items if cache is full\r\n      if (this.memoryCache.size >= maxSize) {\r\n        const oldestKey = this.memoryCache.keys().next().value;\r\n        if (oldestKey) {\r\n          this.memoryCache.delete(oldestKey);\r\n        }\r\n      }\r\n      this.memoryCache.set(key, cacheItem);\r\n    }\r\n\r\n    // Store in localStorage\r\n    if (storage === 'localStorage' || storage === 'both') {\r\n      try {\r\n        localStorage.setItem(`cache_${key}`, JSON.stringify(cacheItem));\r\n      } catch (error) {\r\n        console.warn('Failed to store in localStorage:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get an item from cache\r\n   * @param key - Cache key\r\n   * @param options - Cache options\r\n   * @returns Cached data or null if not found/expired\r\n   */\r\n  get<T>(key: string, options: CacheOptions = {}): T | null {\r\n    const { storage = 'both' } = options;\r\n\r\n    // Try memory cache first\r\n    if (storage === 'memory' || storage === 'both') {\r\n      const memoryItem = this.memoryCache.get(key);\r\n      if (memoryItem && this.isValid(memoryItem)) {\r\n        return memoryItem.data as T;\r\n      }\r\n      if (memoryItem) {\r\n        this.memoryCache.delete(key); // Remove expired item\r\n      }\r\n    }\r\n\r\n    // Try localStorage\r\n    if (storage === 'localStorage' || storage === 'both') {\r\n      try {\r\n        const stored = localStorage.getItem(`cache_${key}`);\r\n        if (stored) {\r\n          const cacheItem: CacheItem<T> = JSON.parse(stored);\r\n          if (this.isValid(cacheItem)) {\r\n            // Restore to memory cache if using both\r\n            if (storage === 'both') {\r\n              this.memoryCache.set(key, cacheItem);\r\n            }\r\n            return cacheItem.data;\r\n          } else {\r\n            localStorage.removeItem(`cache_${key}`); // Remove expired item\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.warn('Failed to read from localStorage:', error);\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Check if a cache item is still valid\r\n   * @param item - Cache item to check\r\n   * @returns True if valid, false if expired\r\n   */\r\n  private isValid(item: CacheItem): boolean {\r\n    return Date.now() - item.timestamp < item.ttl;\r\n  }\r\n\r\n  /**\r\n   * Remove an item from cache\r\n   * @param key - Cache key to remove\r\n   */\r\n  remove(key: string): void {\r\n    this.memoryCache.delete(key);\r\n    try {\r\n      localStorage.removeItem(`cache_${key}`);\r\n    } catch (error) {\r\n      console.warn('Failed to remove from localStorage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all cache items\r\n   * @param storage - Which storage to clear\r\n   */\r\n  clear(storage: 'memory' | 'localStorage' | 'both' = 'both'): void {\r\n    if (storage === 'memory' || storage === 'both') {\r\n      this.memoryCache.clear();\r\n    }\r\n\r\n    if (storage === 'localStorage' || storage === 'both') {\r\n      try {\r\n        const keys = Object.keys(localStorage);\r\n        keys.forEach(key => {\r\n          if (key.startsWith('cache_')) {\r\n            localStorage.removeItem(key);\r\n          }\r\n        });\r\n      } catch (error) {\r\n        console.warn('Failed to clear localStorage:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get cache statistics\r\n   * @returns Object with cache statistics\r\n   */\r\n  getStats(): {\r\n    memorySize: number;\r\n    localStorageSize: number;\r\n    memoryKeys: string[];\r\n    localStorageKeys: string[];\r\n  } {\r\n    const localStorageKeys: string[] = [];\r\n    try {\r\n      const keys = Object.keys(localStorage);\r\n      keys.forEach(key => {\r\n        if (key.startsWith('cache_')) {\r\n          localStorageKeys.push(key.replace('cache_', ''));\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to get localStorage keys:', error);\r\n    }\r\n\r\n    return {\r\n      memorySize: this.memoryCache.size,\r\n      localStorageSize: localStorageKeys.length,\r\n      memoryKeys: Array.from(this.memoryCache.keys()),\r\n      localStorageKeys\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clean up expired items from both caches\r\n   */\r\n  cleanup(): void {\r\n    // Clean memory cache\r\n    for (const [key, item] of this.memoryCache.entries()) {\r\n      if (!this.isValid(item)) {\r\n        this.memoryCache.delete(key);\r\n      }\r\n    }\r\n\r\n    // Clean localStorage\r\n    try {\r\n      const keys = Object.keys(localStorage);\r\n      keys.forEach(key => {\r\n        if (key.startsWith('cache_')) {\r\n          try {\r\n            const stored = localStorage.getItem(key);\r\n            if (stored) {\r\n              const cacheItem: CacheItem = JSON.parse(stored);\r\n              if (!this.isValid(cacheItem)) {\r\n                localStorage.removeItem(key);\r\n              }\r\n            }\r\n          } catch (_error) {\r\n            // Remove corrupted items\r\n            localStorage.removeItem(key);\r\n          }\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to cleanup localStorage:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nconst cacheManager = new CacheManager();\r\n\r\n// Profile-specific cache utilities\r\nexport const profileCache = {\r\n  /**\r\n   * Cache dentist profile data\r\n   * @param dentistId - Dentist ID\r\n   * @param data - Profile data\r\n   */\r\n  setDentistProfile: (dentistId: string, data: any) => {\r\n    cacheManager.set(`dentist_profile_${dentistId}`, data, {\r\n      ttl: 10 * 60 * 1000, // 10 minutes for profile data\r\n      storage: 'both'\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Get cached dentist profile data\r\n   * @param dentistId - Dentist ID\r\n   * @returns Cached profile data or null\r\n   */\r\n  getDentistProfile: (dentistId: string) => {\r\n    return cacheManager.get(`dentist_profile_${dentistId}`);\r\n  },\r\n\r\n  /**\r\n   * Cache patient profile data\r\n   * @param patientId - Patient ID\r\n   * @param data - Profile data\r\n   */\r\n  setPatientProfile: (patientId: string, data: any) => {\r\n    cacheManager.set(`patient_profile_${patientId}`, data, {\r\n      ttl: 10 * 60 * 1000, // 10 minutes for profile data\r\n      storage: 'both'\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Get cached patient profile data\r\n   * @param patientId - Patient ID\r\n   * @returns Cached profile data or null\r\n   */\r\n  getPatientProfile: (patientId: string) => {\r\n    return cacheManager.get(`patient_profile_${patientId}`);\r\n  },\r\n\r\n  /**\r\n   * Cache appointments data\r\n   * @param userId - User ID\r\n   * @param data - Appointments data\r\n   */\r\n  setAppointments: (userId: string, data: any) => {\r\n    cacheManager.set(`appointments_${userId}`, data, {\r\n      ttl: 2 * 60 * 1000, // 2 minutes for appointments (more dynamic)\r\n      storage: 'memory' // Only memory for frequently changing data\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Get cached appointments data\r\n   * @param userId - User ID\r\n   * @returns Cached appointments data or null\r\n   */\r\n  getAppointments: (userId: string) => {\r\n    return cacheManager.get(`appointments_${userId}`);\r\n  },\r\n\r\n  /**\r\n   * Cache clinic data\r\n   * @param clinicId - Clinic ID\r\n   * @param data - Clinic data\r\n   */\r\n  setClinic: (clinicId: string, data: any) => {\r\n    cacheManager.set(`clinic_${clinicId}`, data, {\r\n      ttl: 30 * 60 * 1000, // 30 minutes for clinic data (relatively static)\r\n      storage: 'both'\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Get cached clinic data\r\n   * @param clinicId - Clinic ID\r\n   * @returns Cached clinic data or null\r\n   */\r\n  getClinic: (clinicId: string) => {\r\n    return cacheManager.get(`clinic_${clinicId}`);\r\n  },\r\n\r\n  /**\r\n   * Invalidate user-related caches\r\n   * @param userId - User ID\r\n   */\r\n  invalidateUserCaches: (userId: string) => {\r\n    cacheManager.remove(`dentist_profile_${userId}`);\r\n    cacheManager.remove(`patient_profile_${userId}`);\r\n    cacheManager.remove(`appointments_${userId}`);\r\n  },\r\n\r\n  /**\r\n   * Clear all profile caches\r\n   */\r\n  clearAll: () => {\r\n    cacheManager.clear();\r\n  }\r\n};\r\n\r\n// Auto cleanup every 5 minutes\r\nsetInterval(() => {\r\n  cacheManager.cleanup();\r\n}, 5 * 60 * 1000);\r\n\r\nexport default cacheManager;\r\nexport { cacheManager };","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\clinicBranchUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\clinicUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":12,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[361,364],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[361,364],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1127,1130],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1127,1130],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1168,1171],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1168,1171],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1196,1199],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1196,1199],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2267,2270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2267,2270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Utility functions for handling clinic data\n */\n\n/**\n * Safely extracts clinic ID from various input types\n * Handles cases where entire clinic objects are passed instead of just IDs\n * \n * @param clinicInput - Can be a string ID, clinic object, or null/undefined\n * @returns string clinic ID or undefined\n */\nexport const extractClinicId = (clinicInput: any): string | undefined => {\n  if (!clinicInput) {\n    return undefined;\n  }\n  \n  // If it's already a string, return it\n  if (typeof clinicInput === 'string') {\n    return clinicInput;\n  }\n  \n  // If it's an object, try to extract the ID\n  if (typeof clinicInput === 'object' && clinicInput !== null) {\n    // Try common ID field names\n    return clinicInput.id || clinicInput._id || clinicInput.clinicId;\n  }\n  \n  // Fallback: convert to string\n  return String(clinicInput);\n};\n\n/**\n * Creates safe API parameters with proper clinic ID\n * \n * @param clinicInput - Clinic ID or clinic object\n * @param additionalParams - Additional parameters to include\n * @returns Object with safe parameters for API calls\n */\nexport const createSafeApiParams = (\n  clinicInput: any, \n  additionalParams: Record<string, any> = {}\n): Record<string, any> => {\n  const clinicId = extractClinicId(clinicInput);\n  \n  // Debug logging to catch any issues (development only)\n  if (import.meta.env.DEV && clinicInput && typeof clinicInput === 'object' && clinicInput !== null) {\n    console.log(' createSafeApiParams received object:', {\n      input: clinicInput,\n      extractedId: clinicId,\n      inputType: typeof clinicInput,\n      hasId: 'id' in clinicInput,\n      hasClinicId: 'clinicId' in clinicInput,\n      has_id: '_id' in clinicInput\n    });\n  }\n  \n  const params = { ...additionalParams };\n  \n  if (clinicId) {\n    // Ensure the clinicId is a string and not an object\n    if (typeof clinicId === 'string') {\n      params.clinicId = clinicId;\n    } else {\n      console.warn(' Clinic ID is not a string:', clinicId, typeof clinicId);\n      params.clinicId = String(clinicId);\n    }\n  }\n  \n  return params;\n};\n\n/**\n * Validates that a clinic ID is a valid string\n * \n * @param clinicId - Clinic ID to validate\n * @returns boolean indicating if the clinic ID is valid\n */\nexport const isValidClinicId = (clinicId: any): boolean => {\n  return typeof clinicId === 'string' && clinicId.length > 0;\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\consoleUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[927,930],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[927,930],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1739,1742],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1739,1742],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2236,2239],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2236,2239],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2388,2391],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2388,2391],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2543,2546],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2543,2546],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2700,2703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2700,2703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2931,2934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2931,2934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":159,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3982,3985],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3982,3985],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Console utilities for better error handling and debugging\n */\n\n// Store original console methods\nconst originalConsole = {\n  error: console.error,\n  warn: console.warn,\n  log: console.log\n};\n\n// Known warnings to suppress in production\nconst SUPPRESS_WARNINGS = [\n  'Warning: React does not recognize the',\n  'Warning: Failed prop type',\n  'Warning: componentWillReceiveProps has been renamed',\n  'Warning: componentWillMount has been renamed',\n  'Warning: componentWillUpdate has been renamed',\n  'defaultProps will be removed',\n  'findDOMNode is deprecated',\n];\n\n// Known errors to handle gracefully\nconst KNOWN_ERRORS = [\n  'ChunkLoadError',\n  'Loading chunk',\n  'Loading CSS chunk',\n  'ResizeObserver loop limit exceeded',\n  'Non-Error promise rejection captured',\n];\n\n/**\n * Enhanced console error handler\n */\nexport const setupConsoleErrorHandling = () => {\n  // Override console.error\n  console.error = (...args: any[]) => {\n    const message = args.join(' ');\n    \n    // Check if it's a known error that we can handle gracefully\n    const isKnownError = KNOWN_ERRORS.some(knownError => \n      message.includes(knownError)\n    );\n    \n    if (isKnownError) {\n      // Handle known errors more gracefully\n      if (message.includes('ChunkLoadError') || message.includes('Loading chunk')) {\n        console.warn(' Chunk loading failed, this usually resolves on page refresh');\n        return;\n      }\n      \n      if (message.includes('ResizeObserver loop limit exceeded')) {\n        // This is a common browser warning that can be safely ignored\n        return;\n      }\n    }\n    \n    // Log the error normally for other cases\n    originalConsole.error(...args);\n  };\n\n  // Override console.warn\n  console.warn = (...args: any[]) => {\n    const message = args.join(' ');\n    \n    // Suppress known React warnings in production\n    if (import.meta.env.PROD) {\n      const shouldSuppress = SUPPRESS_WARNINGS.some(warning => \n        message.includes(warning)\n      );\n      \n      if (shouldSuppress) {\n        return;\n      }\n    }\n    \n    // Log the warning normally\n    originalConsole.warn(...args);\n  };\n};\n\n/**\n * Safe console logger that handles errors gracefully\n */\nexport const safeConsole = {\n  log: (...args: any[]) => {\n    try {\n      originalConsole.log(...args);\n    } catch (_error) {\n      // Fallback if console.log fails\n    }\n  },\n  \n  warn: (...args: any[]) => {\n    try {\n      originalConsole.warn(...args);\n    } catch (_error) {\n      // Fallback if console.warn fails\n    }\n  },\n  \n  error: (...args: any[]) => {\n    try {\n      originalConsole.error(...args);\n    } catch (_error) {\n      // Fallback if console.error fails\n    }\n  },\n  \n  debug: (...args: any[]) => {\n    if (import.meta.env.DEV) {\n      try {\n        originalConsole.log('', ...args);\n      } catch (_error) {\n        // Fallback if console.log fails\n      }\n    }\n  },\n  \n  api: (method: string, url: string, data?: any) => {\n    if (import.meta.env.DEV) {\n      try {\n        originalConsole.log(` API ${method.toUpperCase()}:`, url, data ? { data } : '');\n      } catch (_error) {\n        // Fallback if console.log fails\n      }\n    }\n  }\n};\n\n/**\n * Error reporter for production environments\n */\nexport const reportError = (error: Error, context?: string) => {\n  // In development, log to console\n  if (import.meta.env.DEV) {\n    safeConsole.error(`Error in ${context || 'Unknown'}:`, error);\n    return;\n  }\n  \n  // In production, you could send to error reporting service\n  // Example: Sentry, LogRocket, etc.\n  try {\n    // Replace with your error reporting service\n    // Sentry.captureException(error, { tags: { context } });\n    \n    // For now, just log silently\n    safeConsole.error('Production error:', error.message);\n  } catch (_reportingError) {\n    // Silently fail if error reporting fails\n  }\n};\n\n/**\n * Debounced console logger to prevent spam\n */\nconst logCache = new Map<string, number>();\n\nexport const debouncedLog = (key: string, message: any, delay: number = 1000) => {\n  const now = Date.now();\n  const lastLog = logCache.get(key) || 0;\n  \n  if (now - lastLog > delay) {\n    safeConsole.log(message);\n    logCache.set(key, now);\n  }\n};\n\n/**\n * Clean up console overrides (useful for testing)\n */\nexport const restoreConsole = () => {\n  console.error = originalConsole.error;\n  console.warn = originalConsole.warn;\n  console.log = originalConsole.log;\n};\n\nexport default {\n  setupConsoleErrorHandling,\n  safeConsole,\n  reportError,\n  debouncedLog,\n  restoreConsole\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\dateUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\errorHandler.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[533,536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[533,536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1092,1095],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1092,1095],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1567,1570],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1567,1570],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5899,5902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5899,5902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":248,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6190,6193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6190,6193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":255,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6384,6387],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6384,6387],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Centralized error handling utility\r\n * Provides consistent error handling across the application\r\n */\r\n\r\nimport toast from 'react-hot-toast';\r\n\r\nexport interface ErrorHandlerOptions {\r\n  showToast?: boolean;\r\n  logError?: boolean;\r\n  redirectOnAuth?: boolean;\r\n  customMessage?: string;\r\n}\r\n\r\nexport interface ErrorDetails {\r\n  message: string;\r\n  status?: number;\r\n  code?: string;\r\n  shouldRedirect?: boolean;\r\n}\r\n\r\n/**\r\n * Extract user-friendly error message from error object\r\n */\r\nexport const getErrorMessage = (error: any, defaultMessage: string = 'An error occurred'): string => {\r\n  if (!error) return defaultMessage;\r\n  \r\n  // Check for response error message\r\n  if (error.response?.data?.message) {\r\n    return error.response.data.message;\r\n  }\r\n  \r\n  // Check for error message\r\n  if (error.message) {\r\n    return error.message;\r\n  }\r\n  \r\n  // Check for string error\r\n  if (typeof error === 'string') {\r\n    return error;\r\n  }\r\n  \r\n  return defaultMessage;\r\n};\r\n\r\n/**\r\n * Get error details including status code and error code\r\n */\r\nexport const getErrorDetails = (error: any): ErrorDetails => {\r\n  const status = error.response?.status;\r\n  const code = error.code || error.response?.data?.code;\r\n  const message = getErrorMessage(error);\r\n  \r\n  // Determine if we should redirect based on error type\r\n  const shouldRedirect = status === 401 || status === 403;\r\n  \r\n  return {\r\n    message,\r\n    status,\r\n    code,\r\n    shouldRedirect\r\n  };\r\n};\r\n\r\n/**\r\n * Handle API errors with consistent behavior\r\n */\r\nexport const handleApiError = (\r\n  error: any,\r\n  options: ErrorHandlerOptions = {}\r\n): ErrorDetails => {\r\n  const {\r\n    showToast = true,\r\n    logError = true,\r\n    redirectOnAuth = true,\r\n    customMessage\r\n  } = options;\r\n  \r\n  const details = getErrorDetails(error);\r\n  const errorMessage = customMessage || details.message;\r\n  \r\n  // Log error for debugging\r\n  if (logError) {\r\n    console.error('API Error:', {\r\n      message: details.message,\r\n      status: details.status,\r\n      code: details.code,\r\n      error\r\n    });\r\n  }\r\n  \r\n  // Handle specific error cases\r\n  if (details.status === 401) {\r\n    const authMessage = 'Your session has expired. Please log in again.';\r\n    if (showToast) {\r\n      toast.error(authMessage);\r\n    }\r\n    \r\n    if (redirectOnAuth) {\r\n      setTimeout(() => {\r\n        window.location.href = '/login';\r\n      }, 2000);\r\n    }\r\n    \r\n    return { ...details, message: authMessage };\r\n  }\r\n  \r\n  if (details.status === 403) {\r\n    const permissionMessage = 'You do not have permission to perform this action.';\r\n    if (showToast) {\r\n      toast.error(permissionMessage);\r\n    }\r\n    return { ...details, message: permissionMessage };\r\n  }\r\n  \r\n  if (details.status === 404) {\r\n    const notFoundMessage = 'The requested resource was not found.';\r\n    if (showToast) {\r\n      toast.error(customMessage || notFoundMessage);\r\n    }\r\n    return { ...details, message: customMessage || notFoundMessage };\r\n  }\r\n  \r\n  if (details.status === 422) {\r\n    const validationMessage = 'Invalid data provided. Please check your inputs.';\r\n    if (showToast) {\r\n      toast.error(customMessage || validationMessage);\r\n    }\r\n    return { ...details, message: customMessage || validationMessage };\r\n  }\r\n  \r\n  if (details.status === 413) {\r\n    const sizeMessage = 'The file is too large. Please upload a smaller file.';\r\n    if (showToast) {\r\n      toast.error(sizeMessage);\r\n    }\r\n    return { ...details, message: sizeMessage };\r\n  }\r\n  \r\n  if (details.status === 500) {\r\n    const serverMessage = 'Server error. Please try again later.';\r\n    if (showToast) {\r\n      toast.error(serverMessage);\r\n    }\r\n    return { ...details, message: serverMessage };\r\n  }\r\n  \r\n  // Handle network errors\r\n  if (details.code === 'ERR_NETWORK' || errorMessage.includes('Network Error')) {\r\n    const networkMessage = 'Network error. Please check your internet connection.';\r\n    if (showToast) {\r\n      toast.error(networkMessage);\r\n    }\r\n    return { ...details, message: networkMessage };\r\n  }\r\n  \r\n  if (details.code === 'ECONNREFUSED') {\r\n    const connectionMessage = 'Cannot connect to server. Please try again later.';\r\n    if (showToast) {\r\n      toast.error(connectionMessage);\r\n    }\r\n    return { ...details, message: connectionMessage };\r\n  }\r\n  \r\n  if (details.code === 'ETIMEDOUT') {\r\n    const timeoutMessage = 'Request timed out. Please try again.';\r\n    if (showToast) {\r\n      toast.error(timeoutMessage);\r\n    }\r\n    return { ...details, message: timeoutMessage };\r\n  }\r\n  \r\n  // Default error handling\r\n  if (showToast) {\r\n    toast.error(errorMessage);\r\n  }\r\n  \r\n  return { ...details, message: errorMessage };\r\n};\r\n\r\n/**\r\n * Handle form validation errors\r\n */\r\nexport const handleValidationError = (\r\n  message: string,\r\n  options: ErrorHandlerOptions = {}\r\n): void => {\r\n  const { showToast = true, logError = true } = options;\r\n  \r\n  if (logError) {\r\n    console.warn('Validation Error:', message);\r\n  }\r\n  \r\n  if (showToast) {\r\n    toast.error(message);\r\n  }\r\n};\r\n\r\n/**\r\n * Handle success messages\r\n */\r\nexport const handleSuccess = (\r\n  message: string,\r\n  options: { showToast?: boolean; logSuccess?: boolean } = {}\r\n): void => {\r\n  const { showToast = true, logSuccess = false } = options;\r\n  \r\n  if (logSuccess) {\r\n    console.log('Success:', message);\r\n  }\r\n  \r\n  if (showToast) {\r\n    toast.success(message);\r\n  }\r\n};\r\n\r\n/**\r\n * Wrap async operations with error handling\r\n */\r\nexport const withErrorHandling = async <T>(\r\n  operation: () => Promise<T>,\r\n  options: ErrorHandlerOptions = {}\r\n): Promise<{ data?: T; error?: ErrorDetails }> => {\r\n  try {\r\n    const data = await operation();\r\n    return { data };\r\n  } catch (error) {\r\n    const errorDetails = handleApiError(error, options);\r\n    return { error: errorDetails };\r\n  }\r\n};\r\n\r\n/**\r\n * Check if error is a network error\r\n */\r\nexport const isNetworkError = (error: any): boolean => {\r\n  return (\r\n    error.code === 'ERR_NETWORK' ||\r\n    error.code === 'ECONNREFUSED' ||\r\n    error.code === 'ETIMEDOUT' ||\r\n    error.message?.includes('Network Error')\r\n  );\r\n};\r\n\r\n/**\r\n * Check if error is an authentication error\r\n */\r\nexport const isAuthError = (error: any): boolean => {\r\n  return error.response?.status === 401 || error.response?.status === 403;\r\n};\r\n\r\n/**\r\n * Check if error is a validation error\r\n */\r\nexport const isValidationError = (error: any): boolean => {\r\n  return error.response?.status === 422;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\formatUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\imageOptimization.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\logger.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":21,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[444,447],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[444,447],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2403,2406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2403,2406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":291,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":291,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6869,6872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6869,6872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Enhanced logging utilities with appropriate log levels\r\n * Provides structured logging for different environments\r\n */\r\n\r\nexport const LogLevel = {\r\n  ERROR: 0,\r\n  WARN: 1,\r\n  INFO: 2,\r\n  DEBUG: 3\r\n} as const;\r\n\r\nexport type LogLevel = typeof LogLevel[keyof typeof LogLevel];\r\n\r\nexport interface LogContext {\r\n  component?: string;\r\n  action?: string;\r\n  userId?: string;\r\n  sessionId?: string;\r\n  timestamp?: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface LogEntry {\r\n  level: LogLevel;\r\n  message: string;\r\n  context?: LogContext;\r\n  error?: Error;\r\n  stack?: string;\r\n}\r\n\r\nclass Logger {\r\n  private logLevel: LogLevel;\r\n  private isDevelopment: boolean;\r\n\r\n  constructor() {\r\n    this.isDevelopment = import.meta.env.DEV || process.env.NODE_ENV === 'development';\r\n    this.logLevel = this.isDevelopment ? LogLevel.DEBUG : LogLevel.WARN;\r\n  }\r\n\r\n  /**\r\n   * Set the current log level\r\n   */\r\n  setLogLevel(level: LogLevel): void {\r\n    this.logLevel = level;\r\n  }\r\n\r\n  /**\r\n   * Get the current log level\r\n   */\r\n  getLogLevel(): LogLevel {\r\n    return this.logLevel;\r\n  }\r\n\r\n  /**\r\n   * Check if a log level should be output\r\n   */\r\n  private shouldLog(level: LogLevel): boolean {\r\n    return level <= this.logLevel;\r\n  }\r\n\r\n  /**\r\n   * Format log entry for output\r\n   */\r\n  private formatLogEntry(entry: LogEntry): string {\r\n    const timestamp = new Date().toISOString();\r\n    const levelName = Object.keys(LogLevel).find(key => LogLevel[key as keyof typeof LogLevel] === entry.level) || 'UNKNOWN';\r\n    const context = entry.context ? JSON.stringify(entry.context) : '';\r\n    \r\n    return `[${timestamp}] ${levelName}: ${entry.message} ${context}`.trim();\r\n  }\r\n\r\n  /**\r\n   * Output log entry to console\r\n   */\r\n  private outputLog(entry: LogEntry): void {\r\n    const formattedMessage = this.formatLogEntry(entry);\r\n    \r\n    switch (entry.level) {\r\n      case LogLevel.ERROR:\r\n        console.error(formattedMessage, entry.error || '');\r\n        if (entry.stack) {\r\n          console.error(entry.stack);\r\n        }\r\n        break;\r\n      case LogLevel.WARN:\r\n        console.warn(formattedMessage);\r\n        break;\r\n      case LogLevel.INFO:\r\n        console.info(formattedMessage);\r\n        break;\r\n      case LogLevel.DEBUG:\r\n        console.log(formattedMessage);\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log an error message\r\n   */\r\n  error(message: string, error?: Error | any, context?: LogContext): void {\r\n    if (!this.shouldLog(LogLevel.ERROR)) return;\r\n\r\n    const logEntry: LogEntry = {\r\n      level: LogLevel.ERROR,\r\n      message,\r\n      context: {\r\n        ...context,\r\n        timestamp: new Date().toISOString()\r\n      }\r\n    };\r\n\r\n    if (error) {\r\n      if (error instanceof Error) {\r\n        logEntry.error = error;\r\n        logEntry.stack = error.stack;\r\n      } else {\r\n        logEntry.context = { ...logEntry.context, errorData: error };\r\n      }\r\n    }\r\n\r\n    this.outputLog(logEntry);\r\n\r\n    // In production, you might want to send errors to a logging service\r\n    if (!this.isDevelopment) {\r\n      this.sendToLoggingService(logEntry);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log a warning message\r\n   */\r\n  warn(message: string, context?: LogContext): void {\r\n    if (!this.shouldLog(LogLevel.WARN)) return;\r\n\r\n    const logEntry: LogEntry = {\r\n      level: LogLevel.WARN,\r\n      message,\r\n      context: {\r\n        ...context,\r\n        timestamp: new Date().toISOString()\r\n      }\r\n    };\r\n\r\n    this.outputLog(logEntry);\r\n  }\r\n\r\n  /**\r\n   * Log an info message\r\n   */\r\n  info(message: string, context?: LogContext): void {\r\n    if (!this.shouldLog(LogLevel.INFO)) return;\r\n\r\n    const logEntry: LogEntry = {\r\n      level: LogLevel.INFO,\r\n      message,\r\n      context: {\r\n        ...context,\r\n        timestamp: new Date().toISOString()\r\n      }\r\n    };\r\n\r\n    this.outputLog(logEntry);\r\n  }\r\n\r\n  /**\r\n   * Log a debug message\r\n   */\r\n  debug(message: string, context?: LogContext): void {\r\n    if (!this.shouldLog(LogLevel.DEBUG)) return;\r\n\r\n    const logEntry: LogEntry = {\r\n      level: LogLevel.DEBUG,\r\n      message,\r\n      context: {\r\n        ...context,\r\n        timestamp: new Date().toISOString()\r\n      }\r\n    };\r\n\r\n    this.outputLog(logEntry);\r\n  }\r\n\r\n  /**\r\n   * Log API call information\r\n   */\r\n  apiCall(method: string, url: string, status?: number, duration?: number, context?: LogContext): void {\r\n    const message = `API ${method.toUpperCase()} ${url}`;\r\n    const apiContext = {\r\n      ...context,\r\n      method,\r\n      url,\r\n      status,\r\n      duration,\r\n      type: 'api_call'\r\n    };\r\n\r\n    if (status && status >= 400) {\r\n      this.error(message, undefined, apiContext);\r\n    } else {\r\n      this.info(message, apiContext);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log user action\r\n   */\r\n  userAction(action: string, userId?: string, context?: LogContext): void {\r\n    this.info(`User action: ${action}`, {\r\n      ...context,\r\n      userId,\r\n      type: 'user_action',\r\n      action\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Log performance metrics\r\n   */\r\n  performance(operation: string, duration: number, context?: LogContext): void {\r\n    const message = `Performance: ${operation} took ${duration}ms`;\r\n    const perfContext = {\r\n      ...context,\r\n      operation,\r\n      duration,\r\n      type: 'performance'\r\n    };\r\n\r\n    if (duration > 1000) {\r\n      this.warn(message, perfContext);\r\n    } else {\r\n      this.debug(message, perfContext);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send logs to external logging service (placeholder)\r\n   */\r\n  private sendToLoggingService(entry: LogEntry): void {\r\n    // In a real application, you would send logs to a service like:\r\n    // - Sentry\r\n    // - LogRocket\r\n    // - DataDog\r\n    // - CloudWatch\r\n    // etc.\r\n    \r\n    // For now, we'll just store in localStorage for debugging\r\n    try {\r\n      const logs = JSON.parse(localStorage.getItem('app_logs') || '[]');\r\n      logs.push(entry);\r\n      \r\n      // Keep only last 100 log entries\r\n      if (logs.length > 100) {\r\n        logs.splice(0, logs.length - 100);\r\n      }\r\n      \r\n      localStorage.setItem('app_logs', JSON.stringify(logs));\r\n    } catch (error) {\r\n      console.error('Failed to store log entry:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get stored logs (for debugging)\r\n   */\r\n  getStoredLogs(): LogEntry[] {\r\n    try {\r\n      return JSON.parse(localStorage.getItem('app_logs') || '[]');\r\n    } catch (error) {\r\n      console.error('Failed to retrieve stored logs:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear stored logs\r\n   */\r\n  clearStoredLogs(): void {\r\n    try {\r\n      localStorage.removeItem('app_logs');\r\n    } catch (error) {\r\n      console.error('Failed to clear stored logs:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Create singleton logger instance\r\nexport const logger = new Logger();\r\n\r\n// Convenience functions for common logging patterns\r\nexport const logError = (message: string, error?: Error | any, context?: LogContext) => {\r\n  logger.error(message, error, context);\r\n};\r\n\r\nexport const logWarn = (message: string, context?: LogContext) => {\r\n  logger.warn(message, context);\r\n};\r\n\r\nexport const logInfo = (message: string, context?: LogContext) => {\r\n  logger.info(message, context);\r\n};\r\n\r\nexport const logDebug = (message: string, context?: LogContext) => {\r\n  logger.debug(message, context);\r\n};\r\n\r\nexport const logApiCall = (method: string, url: string, status?: number, duration?: number, context?: LogContext) => {\r\n  logger.apiCall(method, url, status, duration, context);\r\n};\r\n\r\nexport const logUserAction = (action: string, userId?: string, context?: LogContext) => {\r\n  logger.userAction(action, userId, context);\r\n};\r\n\r\nexport const logPerformance = (operation: string, duration: number, context?: LogContext) => {\r\n  logger.performance(operation, duration, context);\r\n};\r\n\r\n// Export logger class for advanced usage\r\nexport { Logger };\r\nexport default logger;","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\performanceMonitor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2067,2070],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2067,2070],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2431,2434],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2431,2434],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2489,2492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2489,2492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4370,4373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4370,4373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance monitoring utilities\r\n * Tracks page load times, component render times, and network performance\r\n */\r\n\r\nexport interface PerformanceMetrics {\r\n  pageLoadTime?: number;\r\n  domContentLoaded?: number;\r\n  firstContentfulPaint?: number;\r\n  largestContentfulPaint?: number;\r\n  firstInputDelay?: number;\r\n  cumulativeLayoutShift?: number;\r\n  networkSpeed?: 'slow' | 'medium' | 'fast';\r\n  memoryUsage?: {\r\n    used: number;\r\n    total: number;\r\n    percentage: number;\r\n  };\r\n}\r\n\r\nexport interface ComponentMetrics {\r\n  name: string;\r\n  renderTime: number;\r\n  mountTime: number;\r\n  updateCount: number;\r\n}\r\n\r\nclass PerformanceMonitor {\r\n  private metrics: PerformanceMetrics = {};\r\n  private componentMetrics = new Map<string, ComponentMetrics>();\r\n  private observers: PerformanceObserver[] = [];\r\n\r\n  constructor() {\r\n    this.initializeObservers();\r\n    this.measurePageLoad();\r\n  }\r\n\r\n  /**\r\n   * Initialize performance observers\r\n   */\r\n  private initializeObservers(): void {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    try {\r\n      // Observe paint metrics\r\n      const paintObserver = new PerformanceObserver((list) => {\r\n        for (const entry of list.getEntries()) {\r\n          if (entry.name === 'first-contentful-paint') {\r\n            this.metrics.firstContentfulPaint = entry.startTime;\r\n          }\r\n        }\r\n      });\r\n      paintObserver.observe({ entryTypes: ['paint'] });\r\n      this.observers.push(paintObserver);\r\n\r\n      // Observe largest contentful paint\r\n      const lcpObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        const lastEntry = entries[entries.length - 1];\r\n        this.metrics.largestContentfulPaint = lastEntry.startTime;\r\n      });\r\n      lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\r\n      this.observers.push(lcpObserver);\r\n\r\n      // Observe first input delay\r\n      const fidObserver = new PerformanceObserver((list) => {\r\n        for (const entry of list.getEntries()) {\r\n          this.metrics.firstInputDelay = (entry as any).processingStart - entry.startTime;\r\n        }\r\n      });\r\n      fidObserver.observe({ entryTypes: ['first-input'] });\r\n      this.observers.push(fidObserver);\r\n\r\n      // Observe layout shifts\r\n      const clsObserver = new PerformanceObserver((list) => {\r\n        let clsValue = 0;\r\n        for (const entry of list.getEntries()) {\r\n          if (!(entry as any).hadRecentInput) {\r\n            clsValue += (entry as any).value;\r\n          }\r\n        }\r\n        this.metrics.cumulativeLayoutShift = clsValue;\r\n      });\r\n      clsObserver.observe({ entryTypes: ['layout-shift'] });\r\n      this.observers.push(clsObserver);\r\n    } catch (error) {\r\n      console.warn('Performance observers not supported:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Measure page load performance\r\n   */\r\n  private measurePageLoad(): void {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    window.addEventListener('load', () => {\r\n      setTimeout(() => {\r\n        const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\r\n\r\n        if (navigation) {\r\n          this.metrics.pageLoadTime = navigation.loadEventEnd - navigation.fetchStart;\r\n          this.metrics.domContentLoaded = navigation.domContentLoadedEventEnd - navigation.fetchStart;\r\n        }\r\n\r\n        // Estimate network speed\r\n        this.estimateNetworkSpeed();\r\n\r\n        // Measure memory usage\r\n        this.measureMemoryUsage();\r\n      }, 0);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Estimate network speed based on resource loading times\r\n   */\r\n  private estimateNetworkSpeed(): void {\r\n    const resources = performance.getEntriesByType('resource') as PerformanceResourceTiming[];\r\n    if (resources.length === 0) return;\r\n\r\n    const totalTime = resources.reduce((sum, resource) => {\r\n      return sum + (resource.responseEnd - resource.fetchStart);\r\n    }, 0);\r\n\r\n    const averageTime = totalTime / resources.length;\r\n\r\n    if (averageTime < 100) {\r\n      this.metrics.networkSpeed = 'fast';\r\n    } else if (averageTime < 300) {\r\n      this.metrics.networkSpeed = 'medium';\r\n    } else {\r\n      this.metrics.networkSpeed = 'slow';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Measure memory usage if available\r\n   */\r\n  private measureMemoryUsage(): void {\r\n    if ('memory' in performance) {\r\n      const memory = (performance as any).memory;\r\n      this.metrics.memoryUsage = {\r\n        used: memory.usedJSHeapSize,\r\n        total: memory.totalJSHeapSize,\r\n        percentage: Math.round((memory.usedJSHeapSize / memory.totalJSHeapSize) * 100)\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start measuring component performance\r\n   * @param componentName - Name of the component\r\n   * @returns Function to end measurement\r\n   */\r\n  startComponentMeasure(componentName: string): () => void {\r\n    const startTime = performance.now();\r\n\r\n    return () => {\r\n      const endTime = performance.now();\r\n      const renderTime = endTime - startTime;\r\n\r\n      const existing = this.componentMetrics.get(componentName);\r\n      if (existing) {\r\n        existing.renderTime = renderTime;\r\n        existing.updateCount++;\r\n      } else {\r\n        this.componentMetrics.set(componentName, {\r\n          name: componentName,\r\n          renderTime,\r\n          mountTime: renderTime,\r\n          updateCount: 1\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Measure async operation performance\r\n   * @param operationName - Name of the operation\r\n   * @param operation - Async operation to measure\r\n   * @returns Promise with operation result and timing\r\n   */\r\n  async measureAsync<T>(\r\n    operationName: string,\r\n    operation: () => Promise<T>\r\n  ): Promise<{ result: T; duration: number }> {\r\n    const startTime = performance.now();\r\n\r\n    try {\r\n      const result = await operation();\r\n      const duration = performance.now() - startTime;\r\n\r\n      console.log(`${operationName} completed in ${duration.toFixed(2)}ms`);\r\n\r\n      return { result, duration };\r\n    } catch (error) {\r\n      const duration = performance.now() - startTime;\r\n      console.error(`${operationName} failed after ${duration.toFixed(2)}ms:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current performance metrics\r\n   * @returns Current performance metrics\r\n   */\r\n  getMetrics(): PerformanceMetrics {\r\n    return { ...this.metrics };\r\n  }\r\n\r\n  /**\r\n   * Get component performance metrics\r\n   * @returns Map of component metrics\r\n   */\r\n  getComponentMetrics(): Map<string, ComponentMetrics> {\r\n    return new Map(this.componentMetrics);\r\n  }\r\n\r\n  /**\r\n   * Get performance score (0-100)\r\n   * @returns Performance score based on Core Web Vitals\r\n   */\r\n  getPerformanceScore(): number {\r\n    let score = 100;\r\n\r\n    // Largest Contentful Paint (25% weight)\r\n    if (this.metrics.largestContentfulPaint) {\r\n      if (this.metrics.largestContentfulPaint > 4000) score -= 25;\r\n      else if (this.metrics.largestContentfulPaint > 2500) score -= 15;\r\n      else if (this.metrics.largestContentfulPaint > 1500) score -= 5;\r\n    }\r\n\r\n    // First Input Delay (25% weight)\r\n    if (this.metrics.firstInputDelay) {\r\n      if (this.metrics.firstInputDelay > 300) score -= 25;\r\n      else if (this.metrics.firstInputDelay > 100) score -= 15;\r\n      else if (this.metrics.firstInputDelay > 50) score -= 5;\r\n    }\r\n\r\n    // Cumulative Layout Shift (25% weight)\r\n    if (this.metrics.cumulativeLayoutShift) {\r\n      if (this.metrics.cumulativeLayoutShift > 0.25) score -= 25;\r\n      else if (this.metrics.cumulativeLayoutShift > 0.1) score -= 15;\r\n      else if (this.metrics.cumulativeLayoutShift > 0.05) score -= 5;\r\n    }\r\n\r\n    // Page Load Time (25% weight)\r\n    if (this.metrics.pageLoadTime) {\r\n      if (this.metrics.pageLoadTime > 5000) score -= 25;\r\n      else if (this.metrics.pageLoadTime > 3000) score -= 15;\r\n      else if (this.metrics.pageLoadTime > 2000) score -= 5;\r\n    }\r\n\r\n    return Math.max(0, score);\r\n  }\r\n\r\n  /**\r\n   * Log performance report to console\r\n   */\r\n  logReport(): void {\r\n    console.group(' Performance Report');\r\n\r\n    console.log(' Core Web Vitals:');\r\n    console.log(`  LCP: ${this.metrics.largestContentfulPaint?.toFixed(2) || 'N/A'}ms`);\r\n    console.log(`  FID: ${this.metrics.firstInputDelay?.toFixed(2) || 'N/A'}ms`);\r\n    console.log(`  CLS: ${this.metrics.cumulativeLayoutShift?.toFixed(3) || 'N/A'}`);\r\n\r\n    console.log(' Load Times:');\r\n    console.log(`  Page Load: ${this.metrics.pageLoadTime?.toFixed(2) || 'N/A'}ms`);\r\n    console.log(`  DOM Ready: ${this.metrics.domContentLoaded?.toFixed(2) || 'N/A'}ms`);\r\n    console.log(`  FCP: ${this.metrics.firstContentfulPaint?.toFixed(2) || 'N/A'}ms`);\r\n\r\n    console.log(' Network:');\r\n    console.log(`  Speed: ${this.metrics.networkSpeed || 'Unknown'}`);\r\n\r\n    if (this.metrics.memoryUsage) {\r\n      console.log(' Memory:');\r\n      console.log(`  Used: ${(this.metrics.memoryUsage.used / 1024 / 1024).toFixed(2)}MB`);\r\n      console.log(`  Total: ${(this.metrics.memoryUsage.total / 1024 / 1024).toFixed(2)}MB`);\r\n      console.log(`  Usage: ${this.metrics.memoryUsage.percentage}%`);\r\n    }\r\n\r\n    console.log(` Performance Score: ${this.getPerformanceScore()}/100`);\r\n\r\n    if (this.componentMetrics.size > 0) {\r\n      console.log(' Component Performance:');\r\n      this.componentMetrics.forEach((metrics, name) => {\r\n        console.log(`  ${name}: ${metrics.renderTime.toFixed(2)}ms (${metrics.updateCount} renders)`);\r\n      });\r\n    }\r\n\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * Clean up observers\r\n   */\r\n  cleanup(): void {\r\n    this.observers.forEach(observer => observer.disconnect());\r\n    this.observers = [];\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nconst performanceMonitor = new PerformanceMonitor();\r\n\r\n// Auto-log report in development mode\r\nif (import.meta.env.DEV) {\r\n  window.addEventListener('load', () => {\r\n    setTimeout(() => {\r\n      performanceMonitor.logReport();\r\n    }, 2000);\r\n  });\r\n}\r\n\r\nexport default performanceMonitor;\r\nexport { performanceMonitor };","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\performanceTesting.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\preloader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\reactUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":10,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[280,283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[280,283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1042,1045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1042,1045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1308,1311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1308,1311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1700,1703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1700,1703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * React utilities for better component handling and avoiding common warnings\n */\nimport React from 'react';\n\n/**\n * Generates a stable key for React list items\n * Helps avoid \"Each child in a list should have a unique key prop\" warnings\n */\nexport const generateKey = (item: any, index: number, prefix: string = 'item'): string => {\n  // Try to use a unique identifier from the item\n  if (item && typeof item === 'object') {\n    if (item.id) return `${prefix}-${item.id}`;\n    if (item._id) return `${prefix}-${item._id}`;\n    if (item.key) return `${prefix}-${item.key}`;\n    if (item.uuid) return `${prefix}-${item.uuid}`;\n  }\n  \n  // Fallback to index with prefix\n  return `${prefix}-${index}`;\n};\n\n/**\n * Safe key generator for arrays of primitives\n */\nexport const generatePrimitiveKey = (value: string | number, index: number, prefix: string = 'item'): string => {\n  return `${prefix}-${value}-${index}`;\n};\n\n/**\n * Memoized component wrapper to prevent unnecessary re-renders\n */\nexport const withMemo = <T extends Record<string, any>>(\n  Component: React.ComponentType<T>,\n  areEqual?: (prevProps: T, nextProps: T) => boolean\n) => {\n  return React.memo(Component, areEqual);\n};\n\n/**\n * Safe props spreader that filters out undefined values\n */\nexport const safeProps = <T extends Record<string, any>>(props: T): Partial<T> => {\n  const filtered = {} as Partial<T>;\n  \n  Object.keys(props).forEach(key => {\n    const value = props[key];\n    if (value !== undefined && value !== null) {\n      filtered[key as keyof T] = value;\n    }\n  });\n  \n  return filtered;\n};\n\n/**\n * Component display name helper for better debugging\n */\nexport const setDisplayName = (Component: React.ComponentType<any>, name: string) => {\n  Component.displayName = name;\n  return Component;\n};\n\n/**\n * Safe event handler that prevents default and stops propagation\n */\nexport const createSafeHandler = (\n  handler: (event?: React.SyntheticEvent) => void,\n  options: {\n    preventDefault?: boolean;\n    stopPropagation?: boolean;\n  } = {}\n) => {\n  return (event: React.SyntheticEvent) => {\n    if (options.preventDefault) {\n      event.preventDefault();\n    }\n    if (options.stopPropagation) {\n      event.stopPropagation();\n    }\n    \n    try {\n      handler(event);\n    } catch (error) {\n      console.error('Event handler error:', error);\n    }\n  };\n};\n\n/**\n * Debounced state setter to prevent excessive updates\n */\nexport const useDebouncedState = <T>(\n  initialValue: T,\n  delay: number = 300\n): [T, (value: T) => void, T] => {\n  const [value, setValue] = React.useState<T>(initialValue);\n  const [debouncedValue, setDebouncedValue] = React.useState<T>(initialValue);\n  \n  React.useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    \n    return () => {\n      clearTimeout(timer);\n    };\n  }, [value, delay]);\n  \n  return [value, setValue, debouncedValue];\n};\n\n/**\n * Safe array renderer that handles empty arrays and provides keys\n */\nexport const renderArray = <T>(\n  array: T[] | undefined | null,\n  renderItem: (item: T, index: number) => React.ReactNode,\n  options: {\n    keyPrefix?: string;\n    emptyMessage?: React.ReactNode;\n    keyExtractor?: (item: T, index: number) => string;\n  } = {}\n): React.ReactNode => {\n  if (!array || array.length === 0) {\n    return options.emptyMessage || null;\n  }\n  \n  return array.map((item, index) => {\n    const key = options.keyExtractor \n      ? options.keyExtractor(item, index)\n      : generateKey(item, index, options.keyPrefix);\n    \n    return React.createElement(\n      React.Fragment,\n      { key },\n      renderItem(item, index)\n    );\n  });\n};\n\n/**\n * Conditional class name helper\n */\nexport const cn = (...classes: (string | undefined | null | false)[]): string => {\n  return classes.filter(Boolean).join(' ');\n};\n\nexport default {\n  generateKey,\n  generatePrimitiveKey,\n  withMemo,\n  safeProps,\n  setDisplayName,\n  createSafeHandler,\n  useDebouncedState,\n  renderArray,\n  cn\n};\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\safeAccess.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[157,160],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[157,160],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[514,517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[514,517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":8,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":11,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[528,531],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[528,531],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1779,1782],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1779,1782],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":8,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":11,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1793,1796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1793,1796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1817,1820],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1817,1820],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2238,2241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2238,2241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2253,2256],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2253,2256],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":92,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2614,2617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2614,2617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":93,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2630,2633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2630,2633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3105,3108],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3105,3108],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3462,3465],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3462,3465],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4024,4027],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4024,4027],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4608,4611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4608,4611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5263,5266],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5263,5266],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":226,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5947,5950],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5947,5950],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6413,6416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6413,6416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":258,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":258,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6799,6802],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6799,6802],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7092,7095],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7092,7095],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Safe data access utilities\r\n * Provides safe property access and array validation helpers\r\n */\r\n\r\nexport interface SafeAccessOptions {\r\n  fallback?: any;\r\n  logError?: boolean;\r\n}\r\n\r\n/**\r\n * Safely access nested properties in an object\r\n * @param obj - The object to access\r\n * @param path - The property path (e.g., 'user.profile.name' or ['user', 'profile', 'name'])\r\n * @param options - Configuration options\r\n * @returns The value at the path or the fallback value\r\n */\r\nexport function safeAccess<T = any>(\r\n  obj: any,\r\n  path: string | string[],\r\n  options: SafeAccessOptions = {}\r\n): T | undefined {\r\n  const { fallback, logError = false } = options;\r\n  \r\n  if (!obj || (typeof obj !== 'object' && typeof obj !== 'function')) {\r\n    if (logError) {\r\n      console.warn('safeAccess: Invalid object provided', { obj, path });\r\n    }\r\n    return fallback;\r\n  }\r\n  \r\n  try {\r\n    const pathArray = Array.isArray(path) ? path : path.split('.');\r\n    let current = obj;\r\n    \r\n    for (const key of pathArray) {\r\n      if (current == null || typeof current !== 'object') {\r\n        if (logError) {\r\n          console.warn('safeAccess: Path not found', { path, key, current });\r\n        }\r\n        return fallback;\r\n      }\r\n      current = current[key];\r\n    }\r\n    \r\n    return current !== undefined ? current : fallback;\r\n  } catch (error) {\r\n    if (logError) {\r\n      console.error('safeAccess: Error accessing path', { path, error });\r\n    }\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Safely get a property with optional chaining fallback\r\n * @param obj - The object to access\r\n * @param accessor - Function that accesses the property\r\n * @param fallback - Fallback value if access fails\r\n * @returns The accessed value or fallback\r\n */\r\nexport function safeGet<T = any>(\r\n  obj: any,\r\n  accessor: (obj: any) => T,\r\n  fallback?: T\r\n): T | undefined {\r\n  try {\r\n    if (!obj) return fallback;\r\n    const result = accessor(obj);\r\n    return result !== undefined && result !== null ? result : fallback;\r\n  } catch (_error) {\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Check if a value is a valid array\r\n * @param value - The value to check\r\n * @returns True if the value is a valid array\r\n */\r\nexport function isValidArray(value: any): value is any[] {\r\n  return Array.isArray(value) && value !== null && value !== undefined;\r\n}\r\n\r\n/**\r\n * Safely access array elements with bounds checking\r\n * @param array - The array to access\r\n * @param index - The index to access\r\n * @param fallback - Fallback value if access fails\r\n * @returns The array element or fallback\r\n */\r\nexport function safeArrayAccess<T = any>(\r\n  array: any,\r\n  index: number,\r\n  fallback?: T\r\n): T | undefined {\r\n  if (!isValidArray(array)) {\r\n    return fallback;\r\n  }\r\n  \r\n  if (index < 0 || index >= array.length) {\r\n    return fallback;\r\n  }\r\n  \r\n  return array[index] !== undefined ? array[index] : fallback;\r\n}\r\n\r\n/**\r\n * Safely get array length\r\n * @param array - The array to check\r\n * @param fallback - Fallback length (default: 0)\r\n * @returns The array length or fallback\r\n */\r\nexport function safeArrayLength(array: any, fallback: number = 0): number {\r\n  return isValidArray(array) ? array.length : fallback;\r\n}\r\n\r\n/**\r\n * Safely map over an array\r\n * @param array - The array to map\r\n * @param mapper - The mapping function\r\n * @param fallback - Fallback array if input is invalid\r\n * @returns Mapped array or fallback\r\n */\r\nexport function safeArrayMap<T, R>(\r\n  array: any,\r\n  mapper: (item: T, index: number) => R,\r\n  fallback: R[] = []\r\n): R[] {\r\n  if (!isValidArray(array)) {\r\n    return fallback;\r\n  }\r\n  \r\n  try {\r\n    return array.map(mapper);\r\n  } catch (error) {\r\n    console.warn('safeArrayMap: Error during mapping', error);\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Safely filter an array\r\n * @param array - The array to filter\r\n * @param predicate - The filter predicate\r\n * @param fallback - Fallback array if input is invalid\r\n * @returns Filtered array or fallback\r\n */\r\nexport function safeArrayFilter<T>(\r\n  array: any,\r\n  predicate: (item: T, index: number) => boolean,\r\n  fallback: T[] = []\r\n): T[] {\r\n  if (!isValidArray(array)) {\r\n    return fallback;\r\n  }\r\n  \r\n  try {\r\n    return array.filter(predicate);\r\n  } catch (error) {\r\n    console.warn('safeArrayFilter: Error during filtering', error);\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Safely find an element in an array\r\n * @param array - The array to search\r\n * @param predicate - The search predicate\r\n * @param fallback - Fallback value if not found\r\n * @returns Found element or fallback\r\n */\r\nexport function safeArrayFind<T>(\r\n  array: any,\r\n  predicate: (item: T, index: number) => boolean,\r\n  fallback?: T\r\n): T | undefined {\r\n  if (!isValidArray(array)) {\r\n    return fallback;\r\n  }\r\n  \r\n  try {\r\n    const result = array.find(predicate);\r\n    return result !== undefined ? result : fallback;\r\n  } catch (error) {\r\n    console.warn('safeArrayFind: Error during search', error);\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Validate that a response has the expected structure\r\n * @param response - The response to validate\r\n * @param expectedStructure - Object describing expected structure\r\n * @returns True if structure is valid\r\n */\r\nexport function validateResponseStructure(\r\n  response: any,\r\n  expectedStructure: Record<string, string>\r\n): boolean {\r\n  if (!response || typeof response !== 'object') {\r\n    return false;\r\n  }\r\n  \r\n  for (const [key, type] of Object.entries(expectedStructure)) {\r\n    const value = safeAccess(response, key);\r\n    \r\n    if (type === 'array' && !isValidArray(value)) {\r\n      return false;\r\n    }\r\n    \r\n    if (type !== 'array' && typeof value !== type) {\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  return true;\r\n}\r\n\r\n/**\r\n * Safely parse JSON with fallback\r\n * @param jsonString - The JSON string to parse\r\n * @param fallback - Fallback value if parsing fails\r\n * @returns Parsed object or fallback\r\n */\r\nexport function safeJsonParse<T = any>(\r\n  jsonString: string,\r\n  fallback?: T\r\n): T | undefined {\r\n  try {\r\n    return JSON.parse(jsonString);\r\n  } catch (error) {\r\n    console.warn('safeJsonParse: Failed to parse JSON', { jsonString, error });\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Safely stringify an object\r\n * @param obj - The object to stringify\r\n * @param fallback - Fallback string if stringification fails\r\n * @returns JSON string or fallback\r\n */\r\nexport function safeJsonStringify(obj: any, fallback: string = '{}'): string {\r\n  try {\r\n    return JSON.stringify(obj);\r\n  } catch (error) {\r\n    console.warn('safeJsonStringify: Failed to stringify object', { obj, error });\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Check if a value exists and is not null/undefined\r\n * @param value - The value to check\r\n * @returns True if value exists\r\n */\r\nexport function exists(value: any): boolean {\r\n  return value !== null && value !== undefined;\r\n}\r\n\r\n/**\r\n * Get a safe default value based on type\r\n * @param type - The expected type\r\n * @returns Default value for the type\r\n */\r\nexport function getDefaultValue(type: 'string' | 'number' | 'boolean' | 'array' | 'object'): any {\r\n  switch (type) {\r\n    case 'string':\r\n      return '';\r\n    case 'number':\r\n      return 0;\r\n    case 'boolean':\r\n      return false;\r\n    case 'array':\r\n      return [];\r\n    case 'object':\r\n      return {};\r\n    default:\r\n      return null;\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\timeSlotUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":56,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1901,1904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1901,1904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":115,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4015,4018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4015,4018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Time Slot Utilities\n * Generates and manages appointment time slots based on doctor schedules\n */\n\nimport { type DoctorSchedule } from '../services/doctorScheduleService';\n\n// Add explicit types so TimeSlot and BookedSlot are defined for the module\nexport type TimeSlot = {\n  time: string;\n  available: boolean;\n  isPeak?: boolean;\n  // optional: identify which schedule produced the slot\n  scheduleId?: string;\n};\n\nexport type BookedSlot = string; // simple representation; can be expanded to { time: string; ... } if needed\n\n/**\n * Generate time slots from a doctor's schedule\n * @param schedule - Doctor's schedule for the day\n * @param bookedSlots - Array of already booked time slots (HH:MM format)\n * @returns Array of time slot objects with availability info\n */\nexport const generateTimeSlotsFromSchedule = (\n  schedule: DoctorSchedule,\n  bookedSlots: string[] = []\n): TimeSlot[] => {\n  const slots: TimeSlot[] = [];\n  \n  const { startTime, endTime, slotDuration } = schedule;\n  \n  // Convert HH:MM to minutes from midnight\n  const [startHour, startMinute] = startTime.split(':').map(Number);\n  const [endHour, endMinute] = endTime.split(':').map(Number);\n  \n  const startInMinutes = startHour * 60 + startMinute;\n  const endInMinutes = endHour * 60 + endMinute;\n  \n  // Generate slots\n  for (let time = startInMinutes; time + slotDuration <= endInMinutes; time += slotDuration) {\n    const hour = Math.floor(time / 60);\n    const minute = time % 60;\n    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n    \n    // Check if this slot is already booked\n    const isBooked = bookedSlots.includes(timeString);\n    \n    // Determine if this is a peak time (example: 5 PM - 9 PM)\n    const isPeak = hour >= 17 && hour < 21;\n    \n    slots.push({\n      time: timeString,\n      available: !isBooked,\n      isPeak,\n      scheduleId: (schedule as any).id // optional, harmless if id doesn't exist\n    });\n  }\n  \n  return slots;\n};\n\n/**\n * Generate time slots from multiple schedules (for when doctor has multiple blocks)\n * @param schedules - Array of doctor's schedules for the day\n * @param bookedSlots - Array of already booked time slots\n * @returns Combined array of time slots\n */\nexport const generateTimeSlotsFromMultipleSchedules = (\n  schedules: DoctorSchedule[],\n  bookedSlots: BookedSlot[] = []\n): TimeSlot[] => {\n  const timeSlots: TimeSlot[] = [];\n  const seen = new Set<string>();\n  \n  if (!schedules?.length) {\n    console.warn('No valid schedules provided to generateTimeSlotsFromMultipleSchedules');\n    return [];\n  }\n\n  schedules.forEach(schedule => {\n    console.log(' Processing schedule:', schedule);\n    if (!schedule?.startTime || !schedule?.endTime) {\n      console.warn('Invalid schedule found:', schedule);\n      return;\n    }\n    \n    // Set default slot duration if not provided (30 minutes)\n    const slotDuration = schedule.slotDuration || 30;\n    console.log(' Schedule details:', { startTime: schedule.startTime, endTime: schedule.endTime, slotDuration });\n    \n    const [startHour, startMinute] = schedule.startTime.split(':').map(Number);\n    const [endHour, endMinute] = schedule.endTime.split(':').map(Number);\n    \n    const startInMinutes = startHour * 60 + startMinute;\n    const endInMinutes = endHour * 60 + endMinute;\n    const duration = slotDuration;\n\n    for (let time = startInMinutes; time + duration <= endInMinutes; time += duration) {\n      const hour = Math.floor(time / 60);\n      const minute = time % 60;\n      const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n\n      if (seen.has(timeString)) continue;\n      seen.add(timeString);\n\n      const isBooked = bookedSlots.includes(timeString);\n      const isPeak = hour >= 17 && hour < 21;\n\n      timeSlots.push({\n        time: timeString,\n        available: !isBooked,\n        isPeak,\n        // dentistId is not a property of TimeSlot, so we remove it to fix the lint error\n        scheduleId: (schedule as any).id\n      });\n    }\n  });\n\n  // Sort by time ascending\n  timeSlots.sort((a, b) => a.time.localeCompare(b.time));\n\n  return timeSlots;\n};\n\n/**\n * Format time from 24-hour to 12-hour format\n * @param time - Time in HH:MM format\n * @returns Formatted time string (e.g., \"2:30 PM\")\n */\nexport const formatTime12Hour = (time: string): string => {\n  const [hours, minutes] = time.split(':').map(Number);\n  const period = hours >= 12 ? 'PM' : 'AM';\n  const displayHours = hours % 12 || 12;\n  return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n};\n\n/**\n * Format time slot for display with availability indicator\n * @param slot - Time slot object\n * @returns Formatted display string\n */\nexport const formatTimeSlotDisplay = (slot: { time: string; available: boolean; isPeak?: boolean }): string => {\n  const formatted = formatTime12Hour(slot.time);\n  if (!slot.available) {\n    return `${formatted} (Booked)`;\n  }\n  if (slot.isPeak) {\n    return `${formatted} `;\n  }\n  return formatted;\n};\n\n/**\n * Group time slots by morning, afternoon, evening\n * @param slots - Array of time slots\n * @returns Grouped time slots\n */\nexport const groupTimeSlotsByPeriod = (\n  slots: { time: string; available: boolean; isPeak?: boolean }[]\n): {\n  morning: typeof slots;\n  afternoon: typeof slots;\n  evening: typeof slots;\n} => {\n  const morning: typeof slots = [];\n  const afternoon: typeof slots = [];\n  const evening: typeof slots = [];\n  \n  slots.forEach(slot => {\n    const hour = parseInt(slot.time.split(':')[0]);\n    \n    if (hour < 12) {\n      morning.push(slot);\n    } else if (hour < 17) {\n      afternoon.push(slot);\n    } else {\n      evening.push(slot);\n    }\n  });\n  \n  return { morning, afternoon, evening };\n};\n\n/**\n * Get the first available time slot\n * @param slots - Array of time slots\n * @returns First available slot or null\n */\nexport const getFirstAvailableSlot = (\n  slots: { time: string; available: boolean }[]\n): { time: string; available: boolean } | null => {\n  return slots.find(slot => slot.available) || null;\n};\n\n/**\n * Get next N available slots\n * @param slots - Array of time slots\n * @param count - Number of slots to return\n * @returns Array of available slots\n */\nexport const getNextAvailableSlots = (\n  slots: { time: string; available: boolean }[],\n  count: number = 5\n): { time: string; available: boolean }[] => {\n  return slots.filter(slot => slot.available).slice(0, count);\n};\n\n/**\n * Check if a specific time is within a schedule's range\n * @param time - Time to check (HH:MM)\n * @param schedule - Doctor's schedule\n * @returns True if time is within schedule\n */\nexport const isTimeInSchedule = (time: string, schedule: DoctorSchedule): boolean => {\n  const [hour, minute] = time.split(':').map(Number);\n  const timeInMinutes = hour * 60 + minute;\n  \n  const [startHour, startMinute] = schedule.startTime.split(':').map(Number);\n  const [endHour, endMinute] = schedule.endTime.split(':').map(Number);\n  \n  const startInMinutes = startHour * 60 + startMinute;\n  const endInMinutes = endHour * 60 + endMinute;\n  \n  return timeInMinutes >= startInMinutes && timeInMinutes < endInMinutes;\n};\n\n/**\n * Calculate duration between two times\n * @param startTime - Start time (HH:MM)\n * @param endTime - End time (HH:MM)\n * @returns Duration in minutes\n */\nexport const calculateDuration = (startTime: string, endTime: string): number => {\n  const [startHour, startMinute] = startTime.split(':').map(Number);\n  const [endHour, endMinute] = endTime.split(':').map(Number);\n  \n  const startInMinutes = startHour * 60 + startMinute;\n  const endInMinutes = endHour * 60 + endMinute;\n  \n  return endInMinutes - startInMinutes;\n};\n\n/**\n * Add minutes to a time string\n * @param time - Time in HH:MM format\n * @param minutes - Minutes to add\n * @returns New time string\n */\nexport const addMinutesToTime = (time: string, minutes: number): string => {\n  const [hour, minute] = time.split(':').map(Number);\n  const totalMinutes = hour * 60 + minute + minutes;\n  \n  const newHour = Math.floor(totalMinutes / 60) % 24;\n  const newMinute = totalMinutes % 60;\n  \n  return `${newHour.toString().padStart(2, '0')}:${newMinute.toString().padStart(2, '0')}`;\n};\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\validation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\utils\\validationUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Web Project\\First Project\\Train\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]